---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Iteracja #5 — Tworzenie testów jednostkowych (C#) | Dokumentacja firmy Microsoft'
author: microsoft
description: W piątej iteracji ułatwiamy naszej aplikacji ułatwia konserwację i modyfikowanie, dodając testów jednostkowych. Firma Microsoft testowanie naszych zajęć modelu danych i tworzenie testów jednostkowych dla o...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: b2e96c996905bc73698d1c0b11df97d1dd366172
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/25/2019
ms.locfileid: "58422171"
---
<a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="d1edb-104">Iteracja #5 — Tworzenie testów jednostkowych (C#)</span><span class="sxs-lookup"><span data-stu-id="d1edb-104">Iteration #5 – Create unit tests (C#)</span></span>
====================
<span data-ttu-id="d1edb-105">przez [firmy Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="d1edb-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="d1edb-106">Pobierz program Code</span><span class="sxs-lookup"><span data-stu-id="d1edb-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="d1edb-107">W piątej iteracji ułatwiamy naszej aplikacji ułatwia konserwację i modyfikowanie, dodając testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d1edb-108">Firma Microsoft testowanie naszych zajęć modelu danych i tworzenie testów jednostkowych dla naszych kontrolery i logikę weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="d1edb-109">Tworzenie aplikacji zarządzania kontaktami platformy ASP.NET MVC (C#)</span><span class="sxs-lookup"><span data-stu-id="d1edb-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="d1edb-110">W tej serii samouczków wbudowujemy całej aplikacji zarządzania skontaktuj się z od początku do zakończenia.</span><span class="sxs-lookup"><span data-stu-id="d1edb-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="d1edb-111">Aplikacja Contact Manager umożliwia przechowywanie informacji kontaktowych — nazwy, numerów telefonów i adresów e-mail — lista osób.</span><span class="sxs-lookup"><span data-stu-id="d1edb-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="d1edb-112">Firma Microsoft tworzy aplikację za pośrednictwem wiele iteracji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="d1edb-113">Z każdą iteracją można stopniowo ulepszyć aplikację.</span><span class="sxs-lookup"><span data-stu-id="d1edb-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="d1edb-114">Celem tego wielu podejścia iteracji jest, aby umożliwić Ci zrozumienie przyczyn wprowadzenia poszczególnych zmian.</span><span class="sxs-lookup"><span data-stu-id="d1edb-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="d1edb-115">Iteracja #1 — Tworzenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="d1edb-116">W pierwszej iteracji utworzymy Contact Manager w najprostszym sposobem możliwe.</span><span class="sxs-lookup"><span data-stu-id="d1edb-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="d1edb-117">Dodano obsługę dla operacji podstawowej bazy danych: Tworzenia, odczytu, aktualizacji i usuwania (CRUD).</span><span class="sxs-lookup"><span data-stu-id="d1edb-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="d1edb-118">Iteracja 2 # — należy wyglądu nieuprzywilejowany aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="d1edb-119">W tej iteracji możemy poprawić wygląd aplikacji przez zmodyfikowanie domyślnych strony wzorcowej widoku platformy ASP.NET MVC i kaskadowych arkuszy stylów.</span><span class="sxs-lookup"><span data-stu-id="d1edb-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="d1edb-120">Iteracja #3 — Dodawanie weryfikacji formularza.</span><span class="sxs-lookup"><span data-stu-id="d1edb-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="d1edb-121">W trzecim iteracji dodamy weryfikacji formularza podstawowego.</span><span class="sxs-lookup"><span data-stu-id="d1edb-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="d1edb-122">Firma Microsoft ochronić przed przesłaniem formularza nie kończą działania wymaganych pól formularza.</span><span class="sxs-lookup"><span data-stu-id="d1edb-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="d1edb-123">Możemy zweryfikować adresy e-mail oraz numerów telefonów.</span><span class="sxs-lookup"><span data-stu-id="d1edb-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="d1edb-124">Iteracja 4 # — należy luźne sprzężenie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="d1edb-125">W tym czwarty iteracji możemy korzystać z kilku wzorców projektowych oprogramowania, aby ułatwić konserwację i modyfikowanie aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="d1edb-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="d1edb-126">Na przykład możemy refaktoryzować naszej aplikacji do korzystania z wzorca repozytorium i wzorzec iniekcji zależności.</span><span class="sxs-lookup"><span data-stu-id="d1edb-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="d1edb-127">Iteracja #5 — Tworzenie testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="d1edb-128">W piątej iteracji ułatwiamy naszej aplikacji ułatwia konserwację i modyfikowanie, dodając testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="d1edb-129">Firma Microsoft testowanie naszych zajęć modelu danych i tworzenie testów jednostkowych dla naszych kontrolery i logikę weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="d1edb-130">Iteracja #6 — korzystanie z projektowania opartego na testach.</span><span class="sxs-lookup"><span data-stu-id="d1edb-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="d1edb-131">W tym szóstego iteracji dodamy nowe funkcje do naszej aplikacji, najpierw pisanie testów jednostkowych i pisanie kodu dla testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="d1edb-132">W tym iteracji dodamy grup kontaktów.</span><span class="sxs-lookup"><span data-stu-id="d1edb-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="d1edb-133">Iteracja #7 — dodawanie funkcji Ajax.</span><span class="sxs-lookup"><span data-stu-id="d1edb-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="d1edb-134">W siódmej iteracji można ulepszyć czas odpowiedzi i wydajności naszych aplikacji przez dodanie obsługi technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="d1edb-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="this-iteration"></a><span data-ttu-id="d1edb-135">Tej iteracji</span><span class="sxs-lookup"><span data-stu-id="d1edb-135">This Iteration</span></span>

<span data-ttu-id="d1edb-136">W poprzedniej iteracji aplikacji Contact Manager zrefaktoryzowaliśmy aplikacji można bardziej luźno powiązane.</span><span class="sxs-lookup"><span data-stu-id="d1edb-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="d1edb-137">Firma Microsoft oddzielone aplikacji na różne kontrolera, usług i warstw repozytorium.</span><span class="sxs-lookup"><span data-stu-id="d1edb-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="d1edb-138">Każda warstwa wchodzi w interakcję z warstwą pod nim za pośrednictwem interfejsów.</span><span class="sxs-lookup"><span data-stu-id="d1edb-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="d1edb-139">Zrefaktoryzowaliśmy aplikacji ułatwia konserwację i modyfikowanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="d1edb-140">Na przykład jeśli musimy użyć nowej technologii dostępu do danych, firma Microsoft wystarczy zmienić warstwę repozytorium bez dotykania kontrolera lub warstwy usług.</span><span class="sxs-lookup"><span data-stu-id="d1edb-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="d1edb-141">Podejmując Contact Manager luźno powiązane, firma Microsoft ve wprowadzone aplikacji bardziej odporne na zmiany.</span><span class="sxs-lookup"><span data-stu-id="d1edb-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="d1edb-142">Ale co się stanie, gdy będziemy musieli dodanie nowej funkcji do aplikacji Contact Manager?</span><span class="sxs-lookup"><span data-stu-id="d1edb-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="d1edb-143">Lub, co się stanie, gdy firma Microsoft usterki?</span><span class="sxs-lookup"><span data-stu-id="d1edb-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="d1edb-144">Sad, ale również sprawdzonych prawdziwość pisania kodu jest zawsze wtedy, gdy touch kod, Utwórz ryzyka wprowadzenia nowych usterek.</span><span class="sxs-lookup"><span data-stu-id="d1edb-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="d1edb-145">Na przykład jednego dnia poprawnie, Menedżer może poprosić o dodanie nowej funkcji do menedżera kontaktu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="d1edb-146">Chce dodać obsługę skontaktuj się z grup.</span><span class="sxs-lookup"><span data-stu-id="d1edb-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="d1edb-147">Użytkownik chce, aby umożliwić użytkownikom umieszczaj kontaktów w grupach, takich jak znajomych, firm i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="d1edb-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="d1edb-148">Aby można było wdrożyć tę nową funkcję, należy zmodyfikować wszystkie trzy warstwy aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="d1edb-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="d1edb-149">Należy dodać nowe funkcje do kontrolerów, warstwy usług i repozytorium.</span><span class="sxs-lookup"><span data-stu-id="d1edb-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="d1edb-150">Zaraz po uruchomieniu modyfikowania kodu, istnieje ryzyko, istotne funkcje, które działało.</span><span class="sxs-lookup"><span data-stu-id="d1edb-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="d1edb-151">Refaktoryzacja naszej aplikacji do oddzielnych warstw, ile My mieliśmy w poprzedniej iteracji jest dobrym znakiem.</span><span class="sxs-lookup"><span data-stu-id="d1edb-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="d1edb-152">Ponieważ dzięki temu możemy wprowadzić zmiany do całego warstw bez ingerowania w pozostałe części aplikacji, była dobrym znakiem.</span><span class="sxs-lookup"><span data-stu-id="d1edb-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="d1edb-153">Jednak jeśli chcesz wprowadzić kod w obrębie warstwy ułatwia konserwację i modyfikowanie, należy utworzyć testów jednostkowych dla kodu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="d1edb-154">Możesz użyć jednostki testami jednostka kodu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="d1edb-155">Te jednostki kodu są mniejsze niż warstwy całej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="d1edb-156">Zazwyczaj używasz testu jednostkowego, aby sprawdzić, czy konkretną metodę w kodzie działa w oczekiwany sposób.</span><span class="sxs-lookup"><span data-stu-id="d1edb-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="d1edb-157">Na przykład możesz utworzyć test jednostkowy jako metodę CreateContact() udostępnianych przez klasy ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="d1edb-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="d1edb-158">Testy jednostkowe dla aplikacji po prostu działają, takich jak projektowi.</span><span class="sxs-lookup"><span data-stu-id="d1edb-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="d1edb-159">Przy każdej modyfikacji kodu w aplikacji, można uruchomić zestaw testów jednostkowych, aby sprawdzić, czy modyfikacja przerywa istniejących funkcji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="d1edb-160">Testy jednostkowe sprawić, że kod jest bezpieczny do zmodyfikowania.</span><span class="sxs-lookup"><span data-stu-id="d1edb-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="d1edb-161">Testy jednostkowe wprowadzić cały kod w Twojej aplikacji bardziej odporne na zmiany.</span><span class="sxs-lookup"><span data-stu-id="d1edb-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="d1edb-162">W tym iteracji możemy dodać testy jednostkowe do naszej aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="d1edb-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="d1edb-163">W ten sposób, w następnej iteracji, możemy dodać skontaktuj się z grupy do naszej aplikacji bez konieczności martwienia się o przełomowych istniejących funkcji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d1edb-164">Istnieją różne platformy, w tym NUnit i xUnit.net, MbUnit testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="d1edb-165">W tym samouczku używamy jednostki testowania framework zawartej z programem Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d1edb-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="d1edb-166">Jednak może równie łatwo użyć jednej z tych środowisk alternatywne.</span><span class="sxs-lookup"><span data-stu-id="d1edb-166">However, you could just as easily use one of these alternative frameworks.</span></span>


## <a name="what-gets-tested"></a><span data-ttu-id="d1edb-167">Co pobiera przetestowane</span><span class="sxs-lookup"><span data-stu-id="d1edb-167">What Gets Tested</span></span>

<span data-ttu-id="d1edb-168">W świecie doskonałego kodu byłyby objęte testy jednostek.</span><span class="sxs-lookup"><span data-stu-id="d1edb-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="d1edb-169">W świecie doskonałe trzeba doskonałe projektowi.</span><span class="sxs-lookup"><span data-stu-id="d1edb-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="d1edb-170">Można zmodyfikować w każdym wierszu kodu w aplikacji i natychmiast będzie znana, wykonując testy jednostkowe, czy zmiana Przerwano istniejących funkcji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="d1edb-171">Jednak firma Microsoft don t na żywo w idealnych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="d1edb-172">W praktyce podczas pisania testów jednostkowych można skoncentrować się na pisaniu testów dla logiki biznesowej (na przykład logikę weryfikacji).</span><span class="sxs-lookup"><span data-stu-id="d1edb-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="d1edb-173">W szczególności należy *nie* pisanie testów jednostkowych dla swoich danych dostęp logiki lub logice widoku.</span><span class="sxs-lookup"><span data-stu-id="d1edb-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="d1edb-174">Były przydatne, testy jednostkowe muszą wykonać bardzo szybko.</span><span class="sxs-lookup"><span data-stu-id="d1edb-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="d1edb-175">Możesz łatwo może wzrosnąć setek lub nawet tysięcy testów jednostkowych dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="d1edb-176">Jeśli testy jednostkowe zająć dużo czasu do uruchomienia, a następnie będzie można uniknąć ich wykonania.</span><span class="sxs-lookup"><span data-stu-id="d1edb-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="d1edb-177">Innymi słowy długo działające testy jednostkowe są bezużyteczne kodów dnia na dzień.</span><span class="sxs-lookup"><span data-stu-id="d1edb-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="d1edb-178">Z tego powodu zwykle nie pisania testów jednostkowych dla kodu, który współdziała z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="d1edb-179">Uruchamianiu setki testów jednostkowych na żywo bazy danych będzie zbyt wolno.</span><span class="sxs-lookup"><span data-stu-id="d1edb-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="d1edb-180">Zamiast tego należy testowanie bazy danych i napisać kod, który wchodzi w interakcję z makiety bazy danych (omówimy pozorowanie database poniżej).</span><span class="sxs-lookup"><span data-stu-id="d1edb-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="d1edb-181">Z podobnego powodu zwykle nie pisania testów jednostkowych dla widoków.</span><span class="sxs-lookup"><span data-stu-id="d1edb-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="d1edb-182">W celu przetestowania widoku, możesz zwiększać serwera sieci web.</span><span class="sxs-lookup"><span data-stu-id="d1edb-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="d1edb-183">Ponieważ uruchamiając serwera sieci web jest procesem powolnym stosunkowo, tworzenie testów jednostkowych dla widoków nie jest zalecane.</span><span class="sxs-lookup"><span data-stu-id="d1edb-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="d1edb-184">Jeśli widok zawiera skomplikowaną logikę, następnie należy rozważyć przeniesienie logikę do metody pomocnika.</span><span class="sxs-lookup"><span data-stu-id="d1edb-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="d1edb-185">Można pisać testy jednostkowe dla metody pomocnika, które są wykonywane bez konieczności uruchamiania serwera sieci web.</span><span class="sxs-lookup"><span data-stu-id="d1edb-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d1edb-186">Podczas pisania testów logiką dostępu do danych lub widoku logiki nie jest dobrze podczas pisania testów jednostkowych, te testy może być bardzo przydatne podczas tworzenia funkcjonalności lub integracji testy.</span><span class="sxs-lookup"><span data-stu-id="d1edb-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="d1edb-187">ASP.NET MVC jest aparat widoku w formularzach sieci Web.</span><span class="sxs-lookup"><span data-stu-id="d1edb-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="d1edb-188">Aparat widoku w formularzach sieci Web jest zależny od serwera sieci web, mogą być inne aparaty widoku.</span><span class="sxs-lookup"><span data-stu-id="d1edb-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>


## <a name="using-a-mock-object-framework"></a><span data-ttu-id="d1edb-189">Za pomocą platformy makiety obiektu</span><span class="sxs-lookup"><span data-stu-id="d1edb-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="d1edb-190">Podczas tworzenia testów jednostkowych, należy prawie zawsze korzystać z zalet framework testowanie obiektu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="d1edb-191">Framework obiektu pozorowanie umożliwia tworzenie mocks i klas zastępczych dla klas w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="d1edb-192">Na przykład można użyć framework testowanie obiektu do generowania wersję makiety obiektu klasy repozytorium.</span><span class="sxs-lookup"><span data-stu-id="d1edb-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="d1edb-193">W ten sposób służy klasa makiety repozytorium zamiast klasy rzeczywistych repozytorium do testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="d1edb-194">Przy użyciu repozytorium makiety pozwala na uniknięcie wykonywania kodu bazy danych, podczas wykonywania testu jednostkowego.</span><span class="sxs-lookup"><span data-stu-id="d1edb-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="d1edb-195">Program Visual Studio nie ma framework testowanie obiektu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="d1edb-196">Istnieją jednak wiele struktur testowanie obiektu komercyjnych typu open source dostępnych w programie .NET Framework:</span><span class="sxs-lookup"><span data-stu-id="d1edb-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="d1edb-197">Moq — ta struktura jest dostępna w ramach licencja BSD "open source".</span><span class="sxs-lookup"><span data-stu-id="d1edb-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d1edb-198">Możesz pobrać Moq z [ https://code.google.com/p/moq/ ](https://code.google.com/p/moq/).</span><span class="sxs-lookup"><span data-stu-id="d1edb-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="d1edb-199">Rhino Mocks — ta struktura jest dostępna w ramach licencja BSD "open source".</span><span class="sxs-lookup"><span data-stu-id="d1edb-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="d1edb-200">Możesz pobrać Rhino Mocks z [ http://ayende.com/projects/rhino-mocks.aspx ](http://ayende.com/projects/rhino-mocks.aspx).</span><span class="sxs-lookup"><span data-stu-id="d1edb-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="d1edb-201">Odłączenia Typemock — to struktura, komercyjnych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="d1edb-202">Możesz pobrać wersję próbną z [ http://www.typemock.com/ ](http://www.typemock.com/).</span><span class="sxs-lookup"><span data-stu-id="d1edb-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="d1edb-203">W tym samouczku, I chcę korzystać z Moq.</span><span class="sxs-lookup"><span data-stu-id="d1edb-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="d1edb-204">Jednak może równie łatwo używać Rhino Mocks lub odłączenia Typemock, aby utworzyć projekt obiektów dla aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="d1edb-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="d1edb-205">Zanim użyjesz Moq, należy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="d1edb-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="d1edb-206">.</span><span class="sxs-lookup"><span data-stu-id="d1edb-206">.</span></span>
2. <span data-ttu-id="d1edb-207">Zanim użytkownik Rozpakuj pliki do pobrania, upewnij się, kliknij prawym przyciskiem myszy plik, a następnie kliknij przycisk **odblokowanie** (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="d1edb-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="d1edb-208">Rozpakuj pliki do pobrania.</span><span class="sxs-lookup"><span data-stu-id="d1edb-208">Unzip the download.</span></span>
4. <span data-ttu-id="d1edb-209">Dodaj odwołanie do zestawu Moq, klikając prawym przyciskiem myszy folder odwołania w projekcie ContactManager.Tests i wybierając **Dodaj odwołanie**.</span><span class="sxs-lookup"><span data-stu-id="d1edb-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="d1edb-210">Na karcie przeglądania przejdź do folderu, w którym rozpakowano Moq i wybierz zestaw Moq.dll.</span><span class="sxs-lookup"><span data-stu-id="d1edb-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="d1edb-211">Kliknij przycisk **OK** przycisku.</span><span class="sxs-lookup"><span data-stu-id="d1edb-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="d1edb-212">Po wykonaniu tych kroków, folderze odwołania powinien wyglądać jak rysunek 2.</span><span class="sxs-lookup"><span data-stu-id="d1edb-212">After you complete these steps, your References folder should look like Figure 2.</span></span>


<span data-ttu-id="d1edb-213">[![Odblokowywanie Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d1edb-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="d1edb-214">**Rysunek 01**: Odblokowywanie Moq ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d1edb-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>


<span data-ttu-id="d1edb-215">[![Odwołania po dodaniu Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d1edb-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="d1edb-216">**Rysunek 02**: Odwołania po dodaniu Moq ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d1edb-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>


## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="d1edb-217">Tworzenie testów jednostkowych dla warstwy usług</span><span class="sxs-lookup"><span data-stu-id="d1edb-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="d1edb-218">Pozwól, s, Rozpocznij od utworzenia zestawu testów jednostkowych dla warstwy usług s naszych Contact Manager aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="d1edb-219">Użyjemy tych testów, aby zweryfikować nasze logikę weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="d1edb-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="d1edb-220">Utwórz nowy folder o nazwie modeli w projekcie ContactManager.Tests.</span><span class="sxs-lookup"><span data-stu-id="d1edb-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="d1edb-221">Następnie kliknij prawym przyciskiem myszy folderu modeli i wybierz **Dodaj, nowy Test**.</span><span class="sxs-lookup"><span data-stu-id="d1edb-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="d1edb-222">**Dodaj nowy Test** zostanie wyświetlone okno dialogowe pokazany na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="d1edb-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="d1edb-223">Wybierz **testów jednostkowych** szablonu i nazwy nowego testu ContactManagerServiceTest.cs.</span><span class="sxs-lookup"><span data-stu-id="d1edb-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="d1edb-224">Kliknij przycisk **OK** przycisk, aby dodać nowego testu do projektu testu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d1edb-225">Ogólnie rzecz biorąc ma strukturę folderu projektu testu w taki sposób, aby dopasować strukturę folderu projektu ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="d1edb-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="d1edb-226">Na przykład umieść kontrolera testów w folderze kontrolerów testów modelu w folderze modeli i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="d1edb-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>


<span data-ttu-id="d1edb-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d1edb-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="d1edb-228">**Rysunek 03**: Models\ContactManagerServiceTest.cs ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d1edb-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>


<span data-ttu-id="d1edb-229">Początkowo chcemy metoda CreateContact() udostępnianych przez klasy ContactManagerService testu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="d1edb-230">Utworzymy pięć testów poniżej:</span><span class="sxs-lookup"><span data-stu-id="d1edb-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="d1edb-231">CreateContact() — testy tego CreateContact() zwraca wartość true, gdy prawidłowy kontakt jest przekazywany do metody.</span><span class="sxs-lookup"><span data-stu-id="d1edb-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="d1edb-232">CreateContactRequiredFirstName() - testów, że komunikat o błędzie został dodany do stanu modelu, podczas kontaktu z Brak imię jest przekazywany do metody CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d1edb-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d1edb-233">CreateContactRequiredLastName() - testów, że komunikat o błędzie został dodany do stanu modelu, podczas kontaktu z Brak nazwisko jest przekazywany do metody CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d1edb-233">CreateContactRequiredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d1edb-234">CreateContactInvalidPhone() - testów, że komunikat o błędzie został dodany do stanu modelu, podczas kontaktu z nieprawidłowym numerem telefonu jest przekazywany do metody CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d1edb-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="d1edb-235">CreateContactInvalidEmail() - testów, że komunikat o błędzie został dodany do stanu modelu, podczas kontaktu z nieprawidłowy adres e-mail jest przekazywany do metody CreateContact()...</span><span class="sxs-lookup"><span data-stu-id="d1edb-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="d1edb-236">Pierwszy test sprawdza, prawidłowy kontakt nie generuje błąd sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="d1edb-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="d1edb-237">Pozostałe testy Sprawdź każdy z reguł sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="d1edb-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="d1edb-238">Kod dla tych testów znajduje się w ofercie 1.</span><span class="sxs-lookup"><span data-stu-id="d1edb-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="d1edb-239">**Wyświetlanie listy 1 - Models\ContactManagerServiceTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d1edb-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]


<span data-ttu-id="d1edb-240">Ponieważ używamy klasy skontaktuj się z listą 1 musimy dodać odwołanie do Microsoft Entity Framework do naszego projektu testu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="d1edb-241">Dodaj odwołanie do zestawu System.Data.Entity.</span><span class="sxs-lookup"><span data-stu-id="d1edb-241">Add a reference to the System.Data.Entity assembly.</span></span>


<span data-ttu-id="d1edb-242">Wyświetlanie listy 1 zawiera metodę o nazwie Initialize(), który zostanie nadany atrybut [TestInitialize].</span><span class="sxs-lookup"><span data-stu-id="d1edb-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="d1edb-243">Ta metoda jest wywoływana automatycznie, przed uruchomieniem każdego z testów jednostkowych (jest to 5 razy bezpośrednio przed każdym z testów jednostkowych).</span><span class="sxs-lookup"><span data-stu-id="d1edb-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="d1edb-244">Metoda Initialize() tworzy makiety repozytorium przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="d1edb-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="d1edb-245">Ten wiersz kodu używa Moq framework do wygenerowania makiety repozytorium z interfejsu IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="d1edb-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="d1edb-246">Zamiast rzeczywistego EntityContactManagerRepository makiety repozytorium jest używana w celu uniknięcia, uzyskiwanie dostępu do bazy danych, po uruchomieniu każdy test jednostkowy.</span><span class="sxs-lookup"><span data-stu-id="d1edb-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="d1edb-247">Repozytorium makiety implementuje metody interfejsu IContactManagerRepository, ale t don metody naprawdę nic nie robi.</span><span class="sxs-lookup"><span data-stu-id="d1edb-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="d1edb-248">Korzystając z Moq framework, jest rozróżnienie między \_mockRepository i \_mockRepository.Object.</span><span class="sxs-lookup"><span data-stu-id="d1edb-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="d1edb-249">Pierwsza odwołuje się do pozorny&lt;IContactManagerRepository&gt; klasę, która zawiera metody do określania zachowania makiety repozytorium.</span><span class="sxs-lookup"><span data-stu-id="d1edb-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="d1edb-250">Te ostatnie odnosi się do rzeczywistego makiety repozytorium, który implementuje interfejs IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="d1edb-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>


<span data-ttu-id="d1edb-251">Makiety repozytorium jest używana w przypadku metody Initialize() podczas tworzenia wystąpienia klasy ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="d1edb-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="d1edb-252">Wszystkie testy jednostkowe poszczególnych użycie tego wystąpienia klasy ContactManagerService.</span><span class="sxs-lookup"><span data-stu-id="d1edb-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="d1edb-253">Wyświetlanie listy 1 zawiera pięć metod, które odnoszą się do każdego z testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="d1edb-254">Każda z tych metod zostanie nadany atrybut [TestMethod].</span><span class="sxs-lookup"><span data-stu-id="d1edb-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="d1edb-255">Kiedy uruchamiasz testy jednostkowe, nosi nazwę dowolnej metody, która ma tego atrybutu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="d1edb-256">Innymi słowy dowolnej metody, która zostanie nadany atrybut [TestMethod] to test jednostkowy.</span><span class="sxs-lookup"><span data-stu-id="d1edb-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="d1edb-257">Pierwszy test jednostkowy, o nazwie CreateContact(), sprawdza, czy wywołanie CreateContact() zwraca wartość true, gdy prawidłowe wystąpienie klasy kontakt jest przekazywany do metody.</span><span class="sxs-lookup"><span data-stu-id="d1edb-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="d1edb-258">Test tworzy wystąpienie klasy, skontaktuj się z pomocą, wywołuje metodę CreateContact() i sprawdza, czy CreateContact() zwraca wartość true.</span><span class="sxs-lookup"><span data-stu-id="d1edb-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="d1edb-259">Pozostałe testy Sprawdź, czy gdy wywoływana jest metoda CreateContact(), z nieprawidłową kontaktu w następnie metoda zwraca wartość FAŁSZ i komunikat o błędzie weryfikacji oczekiwany jest dodawany do stanu modelu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="d1edb-260">Na przykład CreateContactRequiredFirstName() test tworzy wystąpienie klasy skontaktuj się z pustym ciągiem znaków dla jego właściwości imię.</span><span class="sxs-lookup"><span data-stu-id="d1edb-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="d1edb-261">Następnie metoda CreateContact() jest wywoływana z nieprawidłową kontaktu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="d1edb-262">Ponadto ten test sprawdza, czy CreateContact() zwraca wartość false, i że stanu modelu zawiera komunikat o błędzie weryfikacji oczekiwano "Imię jest wymagane."</span><span class="sxs-lookup"><span data-stu-id="d1edb-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="d1edb-263">Można uruchomić testy jednostkowe w ofercie 1, wybierając opcję menu **, przebieg testu, wszystkie testy w rozwiązaniu (CTRL + R, A)**.</span><span class="sxs-lookup"><span data-stu-id="d1edb-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="d1edb-264">Wyniki testów są wyświetlane w oknie wyników testu (zobacz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="d1edb-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>


<span data-ttu-id="d1edb-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d1edb-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="d1edb-266">**Rysunek 04**: Wyniki testu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d1edb-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>


## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="d1edb-267">Tworzenie testów jednostkowych dla kontrolerów</span><span class="sxs-lookup"><span data-stu-id="d1edb-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="d1edb-268">Aplikacja ASP.NETMVC sterowanie przepływem interakcji z użytkownikiem.</span><span class="sxs-lookup"><span data-stu-id="d1edb-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="d1edb-269">Podczas testowania z kontrolerem, należy sprawdzić, czy ten kontroler zwraca odpowiednie działania wynik i przeglądanie danych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="d1edb-270">Można również sprawdzić, czy kontroler wchodzi w interakcję z klasy modeli w oczekiwany sposób.</span><span class="sxs-lookup"><span data-stu-id="d1edb-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="d1edb-271">Na przykład lista 2 zawiera dwa testy jednostkowe dla kontrolera skontaktuj się z metody Create().</span><span class="sxs-lookup"><span data-stu-id="d1edb-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="d1edb-272">Pierwszy test jednostkowy sprawdza, czy podczas prawidłowy kontakt jest przekazywany do metody Create(), a następnie Metoda Create() przekierowuje do akcji indeksu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="d1edb-273">Innymi słowy Jeśli przekazano nieprawidłowy kontaktu, Metoda Create() powinna zwrócić RedirectToRouteResult, która reprezentuje akcję indeksu.</span><span class="sxs-lookup"><span data-stu-id="d1edb-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="d1edb-274">Firma Microsoft don t chcesz przetestować ContactManager warstwy usług, gdy testujemy warstwy kontrolera.</span><span class="sxs-lookup"><span data-stu-id="d1edb-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="d1edb-275">W związku z tym firma Microsoft testowanie warstwy usług, używając następującego kodu w metodzie inicjowania:</span><span class="sxs-lookup"><span data-stu-id="d1edb-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="d1edb-276">W CreateValidContact() Testy jednostkowe firma Microsoft testowanie zachowania podczas wywoływania warstwy usług CreateContact() metody za pomocą następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="d1edb-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="d1edb-277">Ten wiersz kodu powoduje, że makiety ContactManager usługa zwraca wartość true, jeśli zostanie wywołana jego metoda CreateContact().</span><span class="sxs-lookup"><span data-stu-id="d1edb-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="d1edb-278">Przez pozorowanie warstwy usług, firma Microsoft testowanie zachowania kontrolera, bez konieczności wykonywania żadnych kodu w warstwie usługi.</span><span class="sxs-lookup"><span data-stu-id="d1edb-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="d1edb-279">Drugi test jednostkowy sprawdza, czy akcja Create() błędny kontakt jest przekazywany do metody, zwraca widok Utwórz.</span><span class="sxs-lookup"><span data-stu-id="d1edb-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="d1edb-280">Możemy spowodować warstwy usług CreateContact() metoda zwraca wartość false, przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="d1edb-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="d1edb-281">Jeśli Metoda Create() zachowuje się jak oczekujemy, że następnie powinna zwrócić widok Tworzenie warstwy usług zwrócona wartość false.</span><span class="sxs-lookup"><span data-stu-id="d1edb-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="d1edb-282">W ten sposób kontroler można wyświetlić komunikaty o błędach weryfikacji w widoku Utwórz, a użytkownik ma szansę, aby poprawić ten nieprawidłowe właściwości skontaktuj się z pomocą.</span><span class="sxs-lookup"><span data-stu-id="d1edb-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>


<span data-ttu-id="d1edb-283">Jeśli planujesz tworzenie testów jednostkowych dla kontrolerów należy zwrócić nazwy widoków jawne z akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="d1edb-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="d1edb-284">Na przykład nie zwracają widoku następująco:</span><span class="sxs-lookup"><span data-stu-id="d1edb-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="d1edb-285">return View();</span><span class="sxs-lookup"><span data-stu-id="d1edb-285">return View();</span></span>

<span data-ttu-id="d1edb-286">Zamiast tego zwracają widoku następująco:</span><span class="sxs-lookup"><span data-stu-id="d1edb-286">Instead, return the view like this:</span></span>

<span data-ttu-id="d1edb-287">return View("Create");</span><span class="sxs-lookup"><span data-stu-id="d1edb-287">return View("Create");</span></span>

<span data-ttu-id="d1edb-288">Jeśli nie jesteś jawne gdy zwracany jest widokiem ViewResult.ViewName właściwość zwraca pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="d1edb-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>


<span data-ttu-id="d1edb-289">**Wyświetlanie listy 2 - Controllers\ContactControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="d1edb-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="d1edb-290">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="d1edb-290">Summary</span></span>

<span data-ttu-id="d1edb-291">W tej iteracji utworzyliśmy testów jednostkowych dla naszej aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="d1edb-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="d1edb-292">W dowolnym momencie, aby sprawdzić, czy naszej aplikacji nadal działa w sposób, że oczekujemy, że można uruchomić te testy jednostkowe.</span><span class="sxs-lookup"><span data-stu-id="d1edb-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="d1edb-293">Testy jednostkowe działają jako zabezpieczenie, aby nasza aplikacja pozwala nam bezpiecznie modyfikować naszej aplikacji w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="d1edb-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="d1edb-294">Utworzyliśmy dwa zestawy testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="d1edb-294">We created two sets of unit tests.</span></span> <span data-ttu-id="d1edb-295">Po pierwsze przetestowaliśmy naszych logikę weryfikacji przez utworzenie testów jednostkowych dla naszych warstwy usług.</span><span class="sxs-lookup"><span data-stu-id="d1edb-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="d1edb-296">Następnie możemy przetestowane naszych przepływu sterowania logiki przez utworzenie testów jednostkowych dla naszej warstwie kontrolera.</span><span class="sxs-lookup"><span data-stu-id="d1edb-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="d1edb-297">Podczas testowania naszych warstwy usług, firma Microsoft samodzielnie Nasze testy nasze warstwy usług z warstwy w naszym repozytorium przez pozorowanie nasze warstwy repozytorium.</span><span class="sxs-lookup"><span data-stu-id="d1edb-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="d1edb-298">Podczas testowania warstwy kontrolera, możemy samodzielnie Nasze testy dla naszych warstwy kontrolera, przez pozorowanie warstwy usług.</span><span class="sxs-lookup"><span data-stu-id="d1edb-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="d1edb-299">W następnej iteracji zmodyfikujemy aplikacji Contact Manager tak, aby go obsługuje skontaktuj się z grupy.</span><span class="sxs-lookup"><span data-stu-id="d1edb-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="d1edb-300">Dodamy tej nowej funkcji do naszej aplikacji przy użyciu procesu projektowania oprogramowania o nazwie programowania sterowanego testami.</span><span class="sxs-lookup"><span data-stu-id="d1edb-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d1edb-301">[Poprzednie](iteration-4-make-the-application-loosely-coupled-cs.md)
> [dalej](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d1edb-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
