---
uid: mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-vb
title: 'Iteracja #7 — Dodawanie funkcji AJAX (VB) | Microsoft Docs'
author: microsoft
description: W siódmej iteracji poprawimy czas reakcji i wydajność naszej aplikacji przez dodanie obsługi technologii AJAX.
ms.author: riande
ms.date: 02/20/2009
ms.assetid: f640e063-150e-453d-8cfc-7e54a6ce0f1e
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-vb
msc.type: authoredcontent
ms.openlocfilehash: cee2b6e7c7517a1e03ae26d5233fc438857a030c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78601655"
---
# <a name="iteration-7--add-ajax-functionality-vb"></a><span data-ttu-id="fa5c1-103">Iteracja #7 — Dodawanie funkcji AJAX (VB)</span><span class="sxs-lookup"><span data-stu-id="fa5c1-103">Iteration #7 – Add Ajax functionality (VB)</span></span>

<span data-ttu-id="fa5c1-104">przez [firmę Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="fa5c1-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="fa5c1-105">Pobierz kod</span><span class="sxs-lookup"><span data-stu-id="fa5c1-105">Download Code</span></span>](iteration-7-add-ajax-functionality-vb/_static/contactmanager_7_vb1.zip)

> <span data-ttu-id="fa5c1-106">W siódmej iteracji poprawimy czas reakcji i wydajność naszej aplikacji przez dodanie obsługi technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-106">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a><span data-ttu-id="fa5c1-107">Tworzenie aplikacji Contact Management ASP.NET MVC (VB)</span><span class="sxs-lookup"><span data-stu-id="fa5c1-107">Building a Contact Management ASP.NET MVC Application (VB)</span></span>

<span data-ttu-id="fa5c1-108">W tej serii samouczków tworzymy całą aplikację do zarządzania kontaktami od początku do końca.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-108">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="fa5c1-109">Aplikacja Contact Manager umożliwia przechowywanie informacji kontaktowych — nazw, numerów telefonów i adresów e-mail — w celu uzyskania listy osób.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-109">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="fa5c1-110">Aplikacja została utworzona przez wiele iteracji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-110">We build the application over multiple iterations.</span></span> <span data-ttu-id="fa5c1-111">W przypadku każdej iteracji stopniowo ulepszamy aplikację.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-111">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="fa5c1-112">Celem tej wielu iteracji jest umożliwienie zrozumienia przyczyny każdej zmiany.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-112">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="fa5c1-113">#1 iteracji — Utwórz aplikację.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-113">Iteration #1 - Create the application.</span></span> <span data-ttu-id="fa5c1-114">W pierwszej iteracji tworzymy Menedżera kontaktów w najprostszy sposób.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-114">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="fa5c1-115">Dodaliśmy obsługę podstawowych operacji bazy danych: Tworzenie, odczytywanie, aktualizowanie i usuwanie (CRUD).</span><span class="sxs-lookup"><span data-stu-id="fa5c1-115">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="fa5c1-116">Iteracja #2 — Zwiększ wygląd aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-116">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="fa5c1-117">W tej iteracji ulepszamy wygląd aplikacji, modyfikując domyślną stronę wzorcową widoku MVC ASP.NET i kaskadowy arkusz stylów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-117">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="fa5c1-118">Iteracja #3 — Dodawanie walidacji formularza.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-118">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="fa5c1-119">W trzeciej iteracji zostanie dodana podstawowa Walidacja formularza.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-119">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="fa5c1-120">Uniemożliwiamy użytkownikom przesyłanie formularza bez wykonywania wymaganych pól formularza.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-120">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="fa5c1-121">Sprawdzamy również adresy e-mail i numery telefonów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-121">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="fa5c1-122">Iteracja #4 — możliwość swobodnego łączenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-122">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="fa5c1-123">W tej czwartej iteracji wykorzystujemy kilka wzorców projektowych oprogramowania, aby ułatwić konserwację i modyfikowanie aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-123">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="fa5c1-124">Na przykład Refaktoryzacja naszej aplikacji używa wzorca repozytorium i wzorca iniekcji zależności.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-124">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="fa5c1-125">#5 iteracji — Utwórz testy jednostkowe.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-125">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="fa5c1-126">W piątej iteracji upraszczamy obsługę i modyfikację naszej aplikacji przez dodanie testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-126">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="fa5c1-127">Tworzymy klasy modelu danych i kompilujemy testy jednostkowe dla naszych kontrolerów i logiki walidacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-127">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="fa5c1-128">Iteracja #6 — Użyj programowania opartego na testach.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-128">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="fa5c1-129">W tej szóstej iteracji Dodaliśmy nowe funkcje do naszej aplikacji, pisząc testy jednostkowe jako pierwsze i pisząc kod na testach jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-129">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="fa5c1-130">W tej iteracji dodamy grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-130">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="fa5c1-131">Iteracja #7 — Dodawanie funkcji AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-131">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="fa5c1-132">W siódmej iteracji poprawimy czas reakcji i wydajność naszej aplikacji przez dodanie obsługi technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-132">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="fa5c1-133">Ta iteracja</span><span class="sxs-lookup"><span data-stu-id="fa5c1-133">This Iteration</span></span>

<span data-ttu-id="fa5c1-134">W tej iteracji aplikacji Contact Manager Refaktoryzacja naszej aplikacji korzysta z technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-134">In this iteration of the Contact Manager application, we refactor our application to make use of Ajax.</span></span> <span data-ttu-id="fa5c1-135">Dzięki wykorzystaniu technologii AJAX Nasza aplikacja nie odpowiada.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-135">By taking advantage of Ajax, we make our application more responsive.</span></span> <span data-ttu-id="fa5c1-136">Możemy uniknąć renderowania całej strony, gdy będziemy musieli zaktualizować tylko określony region na stronie.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-136">We can avoid rendering an entire page when we need to update only a certain region in a page.</span></span>

<span data-ttu-id="fa5c1-137">Będziemy reprezentować nasz widok indeksu, aby nie musieli ponownie wyświetlać całej strony, gdy ktoś wybierze nową grupę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-137">We'll refactor our Index view so that we don t need to redisplay the entire page whenever someone selects a new contact group.</span></span> <span data-ttu-id="fa5c1-138">Zamiast tego, gdy ktoś kliknie grupę kontaktów, wystarczy zaktualizować listę kontaktów i pozostawić resztę samej strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-138">Instead, when someone clicks a contact group, we'll just update the list of contacts and leave the rest of the page alone.</span></span>

<span data-ttu-id="fa5c1-139">Zmienimy również sposób działania naszego linku usuwania.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-139">We'll also change the way our delete link works.</span></span> <span data-ttu-id="fa5c1-140">Zamiast wyświetlania oddzielnej strony potwierdzenia zostanie wyświetlone okno dialogowe potwierdzenia języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-140">Instead of displaying a separate confirmation page, we'll display a JavaScript confirmation dialog.</span></span> <span data-ttu-id="fa5c1-141">Jeśli potwierdzisz, że chcesz usunąć kontakt, operacja usuwania HTTP zostanie przeprowadzona na serwerze w celu usunięcia rekordu kontaktu z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-141">If you confirm that you want to delete a contact, an HTTP DELETE operation is performed against the server to delete the contact record from the database.</span></span>

<span data-ttu-id="fa5c1-142">Ponadto będziemy korzystać z technologii jQuery do dodawania efektów animacji do naszego widoku indeksu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-142">Furthermore, we will take advantage of jQuery to add animation effects to our Index view.</span></span> <span data-ttu-id="fa5c1-143">Pokażemy animację, gdy nowa lista kontaktów zostanie pobrana z serwera.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-143">We'll display an animation when the new list of contacts is being fetched from the server.</span></span>

<span data-ttu-id="fa5c1-144">Na koniec będziemy korzystać z obsługi ASP.NET AJAX Framework na potrzeby zarządzania historią przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-144">Finally, we'll take advantage of the ASP.NET AJAX framework support for managing browser history.</span></span> <span data-ttu-id="fa5c1-145">Utworzymy punkty historii za każdym razem, gdy wykonamy wywołanie AJAX w celu zaktualizowania listy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-145">We'll create history points whenever we perform an Ajax call to update the contact list.</span></span> <span data-ttu-id="fa5c1-146">Dzięki temu przyciski przeglądarki do tyłu i do przodu będą działały.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-146">That way, the browser backward and forward buttons will work.</span></span>

## <a name="why-use-ajax"></a><span data-ttu-id="fa5c1-147">Dlaczego warto używać technologii AJAX?</span><span class="sxs-lookup"><span data-stu-id="fa5c1-147">Why use Ajax?</span></span>

<span data-ttu-id="fa5c1-148">Korzystanie z technologii AJAX ma wiele korzyści.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-148">Using Ajax has many benefits.</span></span> <span data-ttu-id="fa5c1-149">Po pierwsze dodanie funkcji AJAX do aplikacji skutkuje lepszym interfejsem użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-149">First, adding Ajax functionality to an application results in a better user experience.</span></span> <span data-ttu-id="fa5c1-150">W normalnej aplikacji sieci Web cała strona musi być ogłaszana z powrotem na serwerze i za każdym razem, gdy użytkownik wykonuje akcję.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-150">In a normal web application, the entire page must be posted back to the server each and every time a user performs an action.</span></span> <span data-ttu-id="fa5c1-151">Za każdym razem, gdy wykonujesz akcję, blokada i użytkownik muszą czekać, aż cała strona zostanie pobrana i ponownie wyświetlona.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-151">Whenever you perform an action, the browser locks and the user must wait until the entire page is fetched and redisplayed.</span></span>

<span data-ttu-id="fa5c1-152">Jest to nieakceptowalne środowisko w przypadku aplikacji klasycznych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-152">This would be an unacceptable experience in the case of a desktop application.</span></span> <span data-ttu-id="fa5c1-153">Jednak tradycyjnie jesteśmy w trakcie tego nieprawidłowego środowiska użytkownika w przypadku aplikacji sieci Web, ponieważ nie wiemy, że możemy to poprawić.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-153">But, traditionally, we lived with this bad user experience in the case of a web application because we did not know that we could do any better.</span></span> <span data-ttu-id="fa5c1-154">Uważamy, że było to ograniczenie aplikacji sieci Web, gdy, w rzeczywistości, było to tylko ograniczenie naszych Imaginations.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-154">We thought it was a limitation of web applications when, in actuality, it was just a limitation of our imaginations.</span></span>

<span data-ttu-id="fa5c1-155">W aplikacji AJAX nie trzeba wprowadzać środowiska użytkownika w celu zatrzymania tylko w celu zaktualizowania strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-155">In an Ajax application, you don t need to bring the user experience to a halt just to update a page.</span></span> <span data-ttu-id="fa5c1-156">Zamiast tego można wykonać asynchroniczne żądanie w tle w celu zaktualizowania strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-156">Instead, you can perform an asynchronous request in the background to update the page.</span></span> <span data-ttu-id="fa5c1-157">Nie Wymuś, aby użytkownik czekał na aktualizację części strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-157">You don t force the user to wait while part of the page gets updated.</span></span>

<span data-ttu-id="fa5c1-158">Wykorzystując zalety technologii AJAX, możesz również zwiększyć wydajność aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-158">By taking advantage of Ajax, you also can improve the performance of your application.</span></span> <span data-ttu-id="fa5c1-159">Zastanów się, jak aplikacja Contact Manager działa teraz bez funkcji AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-159">Consider how the Contact Manager application works right now without Ajax functionality.</span></span> <span data-ttu-id="fa5c1-160">Po kliknięciu grupy kontaktów należy ponownie wyświetlić cały widok indeksu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-160">When you click a contact group, the entire Index view must be redisplayed.</span></span> <span data-ttu-id="fa5c1-161">Lista kontaktów i list grup kontaktów musi być pobierana z serwera bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-161">The list of contacts and list of contact groups must be retrieved from the database server.</span></span> <span data-ttu-id="fa5c1-162">Wszystkie te dane muszą być przesyłane przez sieć z serwera sieci Web do przeglądarki sieci Web.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-162">All of this data must be passed across the wire from web server to web browser.</span></span>

<span data-ttu-id="fa5c1-163">Po dodaniu funkcji AJAX do aplikacji można jednak uniknąć wyświetlania całej strony, gdy użytkownik kliknie grupę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-163">After we add Ajax functionality to our application, however, we can avoid redisplaying the entire page when a user clicks a contact group.</span></span> <span data-ttu-id="fa5c1-164">Nie potrzebujemy już grup kontaktów z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-164">We no longer need to grab the contact groups from the database.</span></span> <span data-ttu-id="fa5c1-165">Nie trzeba również wypchnąć całego widoku indeksu w sieci.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-165">We also don t need to push the entire Index view across the wire.</span></span> <span data-ttu-id="fa5c1-166">Dzięki wykorzystaniu technologii AJAX zmniejszamy ilość pracy, jaką musi wykonać serwer bazy danych, i zmniejszamy ilość ruchu sieciowego wymaganego przez naszą aplikację.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-166">By taking advantage of Ajax, we reduce the amount of work that our database server must perform and we reduce the amount of network traffic required by our application.</span></span>

## <a name="don-t-be-afraid-of-ajax"></a><span data-ttu-id="fa5c1-167">Nie boisz AJAX</span><span class="sxs-lookup"><span data-stu-id="fa5c1-167">Don t be Afraid of Ajax</span></span>

<span data-ttu-id="fa5c1-168">Niektórzy deweloperzy unikają korzystania ze AJAX, ponieważ obawiają się one o przeglądarki niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-168">Some developers avoid using Ajax because they worry about downlevel browsers.</span></span> <span data-ttu-id="fa5c1-169">Chcą mieć pewność, że aplikacje sieci Web będą nadal działały w przypadku uzyskania dostępu do przeglądarki, która nie obsługuje języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-169">They want to make sure that their web applications will still work when accessed by a browser that does not support JavaScript.</span></span> <span data-ttu-id="fa5c1-170">Ponieważ AJAX jest zależna od języka JavaScript, niektórzy deweloperzy nie mogą korzystać z technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-170">Because Ajax depends on JavaScript, some developers avoid using Ajax.</span></span>

<span data-ttu-id="fa5c1-171">Jednak w przypadku starannego zaimplementowania technologii AJAX można tworzyć aplikacje, które współpracują z przeglądarkami międzypoziomowymi i niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-171">However, if you are careful about how you implement Ajax then you can build applications that work with both uplevel and downlevel browsers.</span></span> <span data-ttu-id="fa5c1-172">Nasza aplikacja z Menedżerem kontaktów będzie współpracować z przeglądarkami obsługującymi język JavaScript i przeglądarki, które nie.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-172">Our Contact Manager application will work with browsers that support JavaScript and browsers that do not.</span></span>

<span data-ttu-id="fa5c1-173">Jeśli używasz aplikacji Contact Manager z przeglądarką obsługującą język JavaScript, będziesz mieć lepszy interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-173">If you use the Contact Manager application with a browser that supports JavaScript then you will have a better user experience.</span></span> <span data-ttu-id="fa5c1-174">Na przykład po kliknięciu grupy kontaktów zostanie zaktualizowany tylko region strony z wyświetlonymi kontaktami.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-174">For example, when you click a contact group, only the region of the page that displays contacts will be updated.</span></span>

<span data-ttu-id="fa5c1-175">Jeśli z drugiej strony, używasz aplikacji Contact Manager z przeglądarką, która nie obsługuje języka JavaScript (lub ma wyłączony kod JavaScript), będziesz mieć nieco mniej pożądane środowisko użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-175">If, on the other hand, you use the Contact Manager application with a browser that does not support JavaScript (or that has JavaScript disabled) then you will have a slightly less desirable user experience.</span></span> <span data-ttu-id="fa5c1-176">Na przykład po kliknięciu grupy kontaktów cały widok indeksu musi zostać opublikowany z powrotem do przeglądarki, aby wyświetlić pasującą listę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-176">For example, when you click a contact group, the entire Index view must be posted back to the browser in order to display the matching list of contacts.</span></span>

## <a name="adding-the-required-javascript-files"></a><span data-ttu-id="fa5c1-177">Dodawanie wymaganych plików JavaScript</span><span class="sxs-lookup"><span data-stu-id="fa5c1-177">Adding the Required JavaScript Files</span></span>

<span data-ttu-id="fa5c1-178">Będziemy musieli używać trzech plików JavaScript do dodawania funkcji AJAX do naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-178">We'll need to use three JavaScript files to add Ajax functionality to our application.</span></span> <span data-ttu-id="fa5c1-179">Wszystkie trzy z tych plików są dołączone do folderu Scripts nowej aplikacji ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-179">All three of these files are included in the Scripts folder of a new ASP.NET MVC application.</span></span>

<span data-ttu-id="fa5c1-180">Jeśli planujesz używanie technologii AJAX na wielu stronach w aplikacji, warto uwzględnić wymagane pliki JavaScript na stronie wzorcowej widoku aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-180">If you plan to use Ajax in multiple pages in your application then it makes sense to include the required JavaScript files in your application s view master page.</span></span> <span data-ttu-id="fa5c1-181">Dzięki temu pliki JavaScript zostaną dołączone do wszystkich stron w aplikacji automatycznie.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-181">That way, the JavaScript files will be included in all of the pages in your application automatically.</span></span>

<span data-ttu-id="fa5c1-182">Dodaj następujący kod JavaScript w tagu &lt;głównego&gt; strony wzorcowej widoku:</span><span class="sxs-lookup"><span data-stu-id="fa5c1-182">Add the following JavaScript includes inside the &lt;head&gt; tag of your view master page:</span></span>

[!code-html[Main](iteration-7-add-ajax-functionality-vb/samples/sample1.html)]

## <a name="refactoring-the-index-view-to-use-ajax"></a><span data-ttu-id="fa5c1-183">Refaktoryzacja widoku indeksu w celu użycia technologii AJAX</span><span class="sxs-lookup"><span data-stu-id="fa5c1-183">Refactoring the Index View to use Ajax</span></span>

<span data-ttu-id="fa5c1-184">Niech Rozpocznij, modyfikując nasz widok indeksu, aby kliknięcie grupy kontaktów tylko zaktualizuje region widoku, w którym są wyświetlane kontakty.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-184">Let s start by modifying our Index view so that clicking a contact group only updates the region of the view that displays contacts.</span></span> <span data-ttu-id="fa5c1-185">Czerwona rubryka na rysunku 1 zawiera region, który chcemy zaktualizować.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-185">The red box in Figure 1 contains the region that we want to update.</span></span>

<span data-ttu-id="fa5c1-186">[![aktualizowanie tylko kontaktów](iteration-7-add-ajax-functionality-vb/_static/image1.jpg)](iteration-7-add-ajax-functionality-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fa5c1-186">[![Updating only contacts](iteration-7-add-ajax-functionality-vb/_static/image1.jpg)](iteration-7-add-ajax-functionality-vb/_static/image1.png)</span></span>

<span data-ttu-id="fa5c1-187">**Ilustracja 01**. aktualizowanie tylko kontaktów ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](iteration-7-add-ajax-functionality-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="fa5c1-187">**Figure 01**: Updating only contacts([Click to view full-size image](iteration-7-add-ajax-functionality-vb/_static/image2.png))</span></span>

<span data-ttu-id="fa5c1-188">Pierwszym krokiem jest oddzielenie części widoku, który chcemy zaktualizować asynchronicznie do oddzielnej częściowej (Wyświetl kontrolkę użytkownika).</span><span class="sxs-lookup"><span data-stu-id="fa5c1-188">The first step is to separate the part of the view that we want to update asynchronously into a separate partial (view user control).</span></span> <span data-ttu-id="fa5c1-189">Sekcja widoku indeks, w którym jest wyświetlana tabela kontaktów, została przeniesiona do części listy 1.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-189">The section of the Index view that displays the table of contacts has been moved into the partial in Listing 1.</span></span>

<span data-ttu-id="fa5c1-190">**Lista 1 — Views\Contact\ContactList.ascx**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-190">**Listing 1 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample2.aspx)]

<span data-ttu-id="fa5c1-191">Zwróć uwagę, że część z listy 1 ma inny model niż widok indeksu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-191">Notice that the partial in Listing 1 has a different model than the Index view.</span></span> <span data-ttu-id="fa5c1-192">Atrybut *Inherits* w dyrektywie &lt;% @ Page%&gt; określa, że częściowo dziedziczy z klasy ViewUserControl&lt;Group&gt;.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-192">The *Inherits* attribute in the &lt;%@ Page %&gt; directive specifies that the partial inherits from the ViewUserControl&lt;Group&gt; class.</span></span>

<span data-ttu-id="fa5c1-193">Zaktualizowany widok indeksu znajduje się na liście 2.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-193">The updated Index view is contained in Listing 2.</span></span>

<span data-ttu-id="fa5c1-194">**Lista 2 — Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-194">**Listing 2 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample3.aspx)]

<span data-ttu-id="fa5c1-195">Istnieją dwie rzeczy, na które należy zauważyć zaktualizowany widok na liście 2.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-195">There are two things that you should notice about the updated view in Listing 2.</span></span> <span data-ttu-id="fa5c1-196">Najpierw należy zauważyć, że cała zawartość przeniesiona do częściowej jest zastępowana wywołaniem html. RenderPartial ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-196">First, notice that all of the content moved into the partial is replaced with a call to Html.RenderPartial().</span></span> <span data-ttu-id="fa5c1-197">Metoda html. RenderPartial () jest wywoływana podczas pierwszego żądania widoku indeksu w celu wyświetlenia początkowego zestawu kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-197">The Html.RenderPartial() method is called when the Index view is first requested in order to display the initial set of contacts.</span></span>

<span data-ttu-id="fa5c1-198">Następnie Zwróć uwagę, że plik HTML. ActionLink () używany do wyświetlania grup kontaktów został zastąpiony przez AJAX. ActionLink ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-198">Second, notice that the Html.ActionLink() used to display contact groups has been replaced with an Ajax.ActionLink().</span></span> <span data-ttu-id="fa5c1-199">Wartość AJAX. ActionLink () jest wywoływana z następującymi parametrami:</span><span class="sxs-lookup"><span data-stu-id="fa5c1-199">The Ajax.ActionLink() is called with the following parameters:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample4.aspx)]

<span data-ttu-id="fa5c1-200">Pierwszy parametr reprezentuje tekst, który ma być wyświetlany dla łącza, drugi parametr reprezentuje wartości trasy, a trzeci parametr reprezentuje opcje AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-200">The first parameter represents the text to display for the link, the second parameter represents the route values, and the third parameter represents the Ajax options.</span></span> <span data-ttu-id="fa5c1-201">W takim przypadku użyjemy opcji UpdateTargetId AJAX, aby wskazać znacznik div&gt; HTML &lt;, który chcemy zaktualizować po zakończeniu żądania AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-201">In this case, we use the UpdateTargetId Ajax option to point to the HTML &lt;div&gt; tag that we want to update after the Ajax request completes.</span></span> <span data-ttu-id="fa5c1-202">Chcemy zaktualizować tag &lt;DIV&gt; z nową listą kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-202">We want to update the &lt;div&gt; tag with the new list of contacts.</span></span>

<span data-ttu-id="fa5c1-203">Zaktualizowana Metoda index () kontrolera Contact znajduje się na liście 3.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-203">The updated Index() method of the Contact controller is contained in Listing 3.</span></span>

<span data-ttu-id="fa5c1-204">**Lista 3-Controllers\ContactController.vb (Metoda index)**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-204">**Listing 3 - Controllers\ContactController.vb (Index method)**</span></span>

[!code-vb[Main](iteration-7-add-ajax-functionality-vb/samples/sample5.vb)]

<span data-ttu-id="fa5c1-205">Zaktualizowana akcja index () warunkowo zwraca jedną z dwóch rzeczy.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-205">The updated Index() action conditionally returns one of two things.</span></span> <span data-ttu-id="fa5c1-206">Jeśli akcja index () jest wywoływana przez żądanie AJAX, kontroler zwraca częściowy.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-206">If the Index() action is invoked by an Ajax request then the controller returns a partial.</span></span> <span data-ttu-id="fa5c1-207">W przeciwnym razie akcja index () zwraca cały widok.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-207">Otherwise, the Index() action returns an entire view.</span></span>

<span data-ttu-id="fa5c1-208">Zwróć uwagę, że akcja index () nie musi zwracać ilości danych, gdy są wywoływane przez żądanie AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-208">Notice that the Index() action does not need to return as much data when invoked by an Ajax request.</span></span> <span data-ttu-id="fa5c1-209">W kontekście normalnego żądania akcja indeksu zwraca listę wszystkich grup kontaktów i wybranej grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-209">In the context of a normal request, the Index action returns a list of all of the contact groups and the selected contact group.</span></span> <span data-ttu-id="fa5c1-210">W kontekście żądania AJAX akcja index () zwróci tylko wybraną grupę.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-210">In the context of an Ajax request, the Index() action returns only the selected group.</span></span> <span data-ttu-id="fa5c1-211">Technologia AJAX oznacza mniejszą ilość pracy na serwerze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-211">Ajax means less work on your database server.</span></span>

<span data-ttu-id="fa5c1-212">Nasz zmodyfikowany widok indeksu działa w przypadku przeglądarek międzypoziomowych i niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-212">Our modified Index view works in the case of both uplevel and downlevel browsers.</span></span> <span data-ttu-id="fa5c1-213">Jeśli klikniesz grupę kontaktów, a przeglądarka obsługuje kod JavaScript, zostanie zaktualizowany tylko region widoku zawierający listę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-213">If you click a contact group, and your browser supports JavaScript, then only the region of the view that contains the list of contacts is updated.</span></span> <span data-ttu-id="fa5c1-214">Jeśli z drugiej strony przeglądarka nie obsługuje języka JavaScript, cały widok zostanie zaktualizowany.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-214">If, on the other hand, your browser does not support JavaScript, then the entire view is updated.</span></span>

<span data-ttu-id="fa5c1-215">Nasz zaktualizowany widok indeksu ma jeden problem.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-215">Our updated Index view has one problem.</span></span> <span data-ttu-id="fa5c1-216">Po kliknięciu grupy kontaktów wybrana grupa nie zostanie wyróżniona.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-216">When you click a contact group, the selected group is not highlighted.</span></span> <span data-ttu-id="fa5c1-217">Ponieważ lista grup jest wyświetlana poza regionem, który jest aktualizowany w trakcie żądania AJAX, po prawej stronie nie zostanie wyróżniona.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-217">Because the list of groups is displayed outside of the region that is updated during an Ajax request, the right group does not get highlighted.</span></span> <span data-ttu-id="fa5c1-218">Naprawimy ten problem w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-218">We'll fix this issue in the next section.</span></span>

## <a name="adding-jquery-animation-effects"></a><span data-ttu-id="fa5c1-219">Dodawanie efektów animacji jQuery</span><span class="sxs-lookup"><span data-stu-id="fa5c1-219">Adding jQuery Animation Effects</span></span>

<span data-ttu-id="fa5c1-220">Zwykle po kliknięciu linku na stronie sieci Web można użyć paska postępu przeglądarki do wykrycia, czy przeglądarka aktywnie pobiera zaktualizowaną zawartość.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-220">Normally, when you click a link in a web page, you can use the browser progress bar to detect whether or not the browser is actively fetching the updated content.</span></span> <span data-ttu-id="fa5c1-221">Podczas wykonywania żądania AJAX, z drugiej strony, pasek postępu przeglądarki nie pokazuje żadnego postępu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-221">When performing an Ajax request, on the other hand, the browser progress bar does not show any progress.</span></span> <span data-ttu-id="fa5c1-222">Może to spowodować, że użytkownicy są nerw.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-222">This can make users nervous.</span></span> <span data-ttu-id="fa5c1-223">Skąd wiadomo, czy przeglądarka została zamrożona?</span><span class="sxs-lookup"><span data-stu-id="fa5c1-223">How do you know whether the browser has frozen?</span></span>

<span data-ttu-id="fa5c1-224">Istnieje kilka sposobów, które można wskazać użytkownikowi, który jest wykonywany podczas wykonywania żądania AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-224">There are several ways that you can indicate to a user that work is being performed while performing an Ajax request.</span></span> <span data-ttu-id="fa5c1-225">Jednym z metod jest wyświetlenie prostej animacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-225">One approach is to display a simple animation.</span></span> <span data-ttu-id="fa5c1-226">Na przykład można wyciszyć region, gdy żądanie AJAX zacznie się i zanika w regionie po zakończeniu żądania.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-226">For example, you can fade out a region when an Ajax request begins and fade in the region when the request completes.</span></span>

<span data-ttu-id="fa5c1-227">Użyjemy biblioteki jQuery, która jest dołączona do Microsoft ASP.NET platformy MVC, aby utworzyć efekty animacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-227">We'll use the jQuery library which is included with the Microsoft ASP.NET MVC framework, to create the animation effects.</span></span> <span data-ttu-id="fa5c1-228">Zaktualizowany widok indeksu znajduje się na liście 4.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-228">The updated Index view is contained in Listing 4.</span></span>

<span data-ttu-id="fa5c1-229">**Lista 4 — Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-229">**Listing 4 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample6.aspx)]

<span data-ttu-id="fa5c1-230">Należy zauważyć, że zaktualizowany widok indeksu zawiera trzy nowe funkcje języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-230">Notice that the updated Index view contains three new JavaScript functions.</span></span> <span data-ttu-id="fa5c1-231">Pierwsze dwie funkcje używają platformy jQuery do zanikania i zanikania na liście kontaktów po kliknięciu nowej grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-231">The first two functions use jQuery to fade out and fade in the list of contacts when you click a new contact group.</span></span> <span data-ttu-id="fa5c1-232">Trzecia funkcja wyświetla komunikat o błędzie, gdy żądanie AJAX powoduje błąd (na przykład limit czasu sieci).</span><span class="sxs-lookup"><span data-stu-id="fa5c1-232">The third function displays an error message when an Ajax request results in an error (for example, network timeout).</span></span>

<span data-ttu-id="fa5c1-233">Pierwsza funkcja wymaga również wyróżniania wybranej grupy.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-233">The first function also takes care of highlighting the selected group.</span></span> <span data-ttu-id="fa5c1-234">Klasa = wybrany atrybut jest dodawany do elementu nadrzędnego (element LI) klikniętego elementu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-234">A class= selected attribute is added to the parent element (the LI element) of the element clicked.</span></span> <span data-ttu-id="fa5c1-235">Ponownie program jQuery ułatwia wybranie odpowiedniego elementu i dodanie klasy CSS.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-235">Again, jQuery makes it easy to select the right element and add the CSS class.</span></span>

<span data-ttu-id="fa5c1-236">Te skrypty są powiązane z łączami do grup z pomocą parametru AjaxOptions AJAX. ActionLink ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-236">These scripts are tied to the group links with the help of the Ajax.ActionLink() AjaxOptions parameter.</span></span> <span data-ttu-id="fa5c1-237">Zaktualizowane wywołanie metody AJAX. ActionLink () wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="fa5c1-237">The updated Ajax.ActionLink() method call looks like this:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample7.aspx)]

## <a name="adding-browser-history-support"></a><span data-ttu-id="fa5c1-238">Dodawanie obsługi historii przeglądarki</span><span class="sxs-lookup"><span data-stu-id="fa5c1-238">Adding Browser History Support</span></span>

<span data-ttu-id="fa5c1-239">Zwykle po kliknięciu linku w celu zaktualizowania strony Historia przeglądarki zostanie zaktualizowana.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-239">Normally, when you click a link to update a page, your browser history is updated.</span></span> <span data-ttu-id="fa5c1-240">W ten sposób można kliknąć przycisk Wstecz przeglądarki, aby wrócić do poprzedniego stanu strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-240">That way, you can click the browser Back button to move back in time to the previous state of the page.</span></span> <span data-ttu-id="fa5c1-241">Jeśli na przykład klikniesz grupę kontaktowa znajomych, a następnie klikniesz grupę kontaktów służbowych, możesz kliknąć przycisk Wstecz przeglądarki, aby przejść z powrotem do stanu strony, gdy została wybrana grupa kontaktowa znajomych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-241">For example, if you click the Friends contact group and then click the Business contact group, you can click the browser Back button to navigate back to the state of the page when the Friends contact group was selected.</span></span>

<span data-ttu-id="fa5c1-242">Niestety, wykonanie żądania AJAX nie aktualizuje automatycznie historii przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-242">Unfortunately, performing an Ajax request does not update browser history automatically.</span></span> <span data-ttu-id="fa5c1-243">Jeśli klikniesz grupę kontaktów, a lista pasujących kontaktów zostanie pobrana z żądaniem AJAX, Historia przeglądarki nie zostanie zaktualizowana.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-243">If you click a contact group, and the list of matching contacts is retrieved with an Ajax request, then the browser history is not updated.</span></span> <span data-ttu-id="fa5c1-244">Nie można użyć przycisku Wstecz przeglądarki, aby przejść z powrotem do grupy kontaktów po wybraniu nowej grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-244">You cannot use the browser Back button to navigate back to a contact group after selecting a new contact group.</span></span>

<span data-ttu-id="fa5c1-245">Jeśli chcesz, aby użytkownicy mogli korzystać z przycisku Wstecz w przeglądarce po przeprowadzeniu żądań AJAX, musisz wykonać nieco więcej pracy.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-245">If you want users to be able to use the browser Back button after performing Ajax requests then you need to perform a little more work.</span></span> <span data-ttu-id="fa5c1-246">Musisz skorzystać z funkcji zarządzania historią przeglądarki wbudowanej w architekturę ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-246">You need to take advantage of the browser history management functionality built in the ASP.NET AJAX Framework.</span></span>

<span data-ttu-id="fa5c1-247">Historia ASP.NET AJAX Browser, należy wykonać trzy czynności:</span><span class="sxs-lookup"><span data-stu-id="fa5c1-247">ASP.NET AJAX browser history, you need to do three things:</span></span>

1. <span data-ttu-id="fa5c1-248">Włącz historię przeglądarki, ustawiając właściwość enableBrowserHistory na wartość true.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-248">Enable Browser History by setting the enableBrowserHistory property to true.</span></span>
2. <span data-ttu-id="fa5c1-249">Zapisuj punkty historii, gdy stan widoku zmienia się, wywołując metodę addHistoryPoint ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-249">Save history points when the state of a view changes by calling the addHistoryPoint() method.</span></span>
3. <span data-ttu-id="fa5c1-250">Rekonstrukcja stanu widoku po wywołaniu zdarzenia nawigacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-250">Reconstruct the state of the view when the navigate event is raised.</span></span>

<span data-ttu-id="fa5c1-251">Zaktualizowany widok indeksu znajduje się na liście 5.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-251">The updated Index view is contained in Listing 5.</span></span>

<span data-ttu-id="fa5c1-252">**Lista 5 — Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-252">**Listing 5 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample8.aspx)]

<span data-ttu-id="fa5c1-253">W liście 5 jest włączona Historia przeglądarki w funkcji pageInit ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-253">In Listing 5, Browser History is enabled in the pageInit() function.</span></span> <span data-ttu-id="fa5c1-254">Funkcja pageInit () służy również do konfigurowania programu obsługi zdarzeń dla zdarzenia nawigacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-254">The pageInit() function is also used to set up the event handler for the navigate event.</span></span> <span data-ttu-id="fa5c1-255">Zdarzenie nawigacji jest wywoływane za każdym razem, gdy przycisk przeglądarki do przodu lub wstecz powoduje zmianę stanu strony.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-255">The navigate event is raised whenever the browser Forward or Back button causes the state of the page to change.</span></span>

<span data-ttu-id="fa5c1-256">Metoda beginContactList () jest wywoływana po kliknięciu grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-256">The beginContactList() method is called when you click a contact group.</span></span> <span data-ttu-id="fa5c1-257">Ta metoda tworzy nowy punkt historyczny przez wywołanie metody addHistoryPoint ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-257">This method creates a new history point by calling the addHistoryPoint() method.</span></span> <span data-ttu-id="fa5c1-258">Identyfikator klikniętej grupy kontaktów został dodany do historii.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-258">The id of the contact group clicked is added to history.</span></span>

<span data-ttu-id="fa5c1-259">Identyfikator grupy jest pobierany z atrybutu expando w łączu grupy kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-259">The group id is retrieved from an expando attribute on the contact group link.</span></span> <span data-ttu-id="fa5c1-260">Link jest renderowany przy użyciu następującego wywołania AJAX. ActionLink ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-260">The link is rendered with the following call to Ajax.ActionLink().</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample9.aspx)]

<span data-ttu-id="fa5c1-261">Ostatni parametr przesłany do AJAX. ActionLink () dodaje atrybut expand o nazwie GroupID do linku (małe litery dla zgodności XHTML).</span><span class="sxs-lookup"><span data-stu-id="fa5c1-261">The last parameter passed to the Ajax.ActionLink() adds an expando attribute named groupid to the link (lowercase for XHTML compatibility).</span></span>

<span data-ttu-id="fa5c1-262">Gdy użytkownik trafi przycisk przeglądarki do tyłu lub do przodu, zdarzenie nawigacji jest wywoływane i wywoływana jest metoda nawigowania ().</span><span class="sxs-lookup"><span data-stu-id="fa5c1-262">When a user hits the browser Back or Forward button, the navigate event is raised and the navigate() method is called.</span></span> <span data-ttu-id="fa5c1-263">Ta metoda aktualizuje kontakty wyświetlane na stronie w celu dopasowania jej do stanu strony odpowiadającej punktowi historii przeglądarki przekazaniu do metody nawigacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-263">This method updates the contacts displayed in the page to match the state of the page that corresponds to the browser history point passed to the navigate method.</span></span>

## <a name="performing-ajax-deletes"></a><span data-ttu-id="fa5c1-264">Wykonywanie operacji usuwania AJAX</span><span class="sxs-lookup"><span data-stu-id="fa5c1-264">Performing Ajax Deletes</span></span>

<span data-ttu-id="fa5c1-265">Obecnie w celu usunięcia kontaktu należy kliknąć łącze Usuń, a następnie kliknąć przycisk Usuń wyświetlany na stronie potwierdzenia usunięcia (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="fa5c1-265">Currently, in order to delete a contact, you need to click on the Delete link and then click the Delete button displayed in the delete confirmation page (see Figure 2).</span></span> <span data-ttu-id="fa5c1-266">Wydaje się to na przykład wiele żądań stron, które ułatwiają wykonywanie czegoś prostego, takiego jak usuwanie rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-266">This seems like a lot of page requests to do something simple like deleting a database record.</span></span>

<span data-ttu-id="fa5c1-267">[![strony potwierdzenia usunięcia](iteration-7-add-ajax-functionality-vb/_static/image2.jpg)](iteration-7-add-ajax-functionality-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="fa5c1-267">[![The delete confirmation page](iteration-7-add-ajax-functionality-vb/_static/image2.jpg)](iteration-7-add-ajax-functionality-vb/_static/image3.png)</span></span>

<span data-ttu-id="fa5c1-268">**Ilustracja 02**. strona potwierdzenia usunięcia ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](iteration-7-add-ajax-functionality-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="fa5c1-268">**Figure 02**: The delete confirmation page([Click to view full-size image](iteration-7-add-ajax-functionality-vb/_static/image4.png))</span></span>

<span data-ttu-id="fa5c1-269">Zachęcamy do pomijania strony potwierdzenia usunięcia i usunięcia kontaktu bezpośrednio z widoku indeksu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-269">It is tempting to skip the delete confirmation page and delete a contact directly from the Index view.</span></span> <span data-ttu-id="fa5c1-270">Należy unikać tego Temptation, ponieważ to podejście spowoduje otwarcie aplikacji pod kątem luk w zabezpieczeniach.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-270">You should avoid this temptation because taking this approach opens your application to security holes.</span></span> <span data-ttu-id="fa5c1-271">Ogólnie rzecz biorąc, nie chcesz wykonywać operacji HTTP GET podczas wywoływania akcji, która modyfikuje stan aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-271">In general, you don t want to perform an HTTP GET operation when invoking an action that modifies the state of your web application.</span></span> <span data-ttu-id="fa5c1-272">W przypadku usuwania, należy wykonać operację usuwania http lub jeszcze lepszy.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-272">When performing a delete, you want to perform an HTTP POST, or better yet, an HTTP DELETE operation.</span></span>

<span data-ttu-id="fa5c1-273">Link usuwania znajduje się w częściowej ContactList.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-273">The Delete link is contained in the ContactList partial.</span></span> <span data-ttu-id="fa5c1-274">Zaktualizowana wersja ContactList częściowej jest zawarta w aukcji 6.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-274">An updated version of the ContactList partial is contained in Listing 6.</span></span>

<span data-ttu-id="fa5c1-275">**Lista 6 — Views\Contact\ContactList.ascx**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-275">**Listing 6 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample10.aspx)]

<span data-ttu-id="fa5c1-276">Link usuwania jest renderowany przy użyciu następującego wywołania metody AJAX. ImageActionLink ():</span><span class="sxs-lookup"><span data-stu-id="fa5c1-276">The Delete link is rendered with the following call to the Ajax.ImageActionLink() method:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-vb/samples/sample11.aspx)]

> [!NOTE] 
> 
> <span data-ttu-id="fa5c1-277">AJAX. ImageActionLink () nie jest standardową częścią struktury ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-277">The Ajax.ImageActionLink() is not a standard part of the ASP.NET MVC framework.</span></span> <span data-ttu-id="fa5c1-278">AJAX. ImageActionLink () jest niestandardowymi metodami pomocniczymi zawartymi w projekcie programu Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-278">The Ajax.ImageActionLink() is a custom helper methods included in the Contact Manager project.</span></span>

<span data-ttu-id="fa5c1-279">Parametr AjaxOptions ma dwie właściwości.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-279">The AjaxOptions parameter has two properties.</span></span> <span data-ttu-id="fa5c1-280">Najpierw Właściwość Confirm służy do wyświetlania okna dialogowego potwierdzenia języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-280">First, the Confirm property is used to display a popup JavaScript confirmation dialog.</span></span> <span data-ttu-id="fa5c1-281">Po drugie, właściwość HttpMethod służy do wykonywania operacji usuwania HTTP.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-281">Second, the HttpMethod property is used to perform an HTTP DELETE operation.</span></span>

<span data-ttu-id="fa5c1-282">Lista 7 zawiera nową akcję AjaxDelete (), która została dodana do kontrolera Contact.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-282">Listing 7 contains a new AjaxDelete() action that has been added to the Contact controller.</span></span>

<span data-ttu-id="fa5c1-283">**Lista 7-Controllers\ContactController.vb (AjaxDelete)**</span><span class="sxs-lookup"><span data-stu-id="fa5c1-283">**Listing 7 - Controllers\ContactController.vb (AjaxDelete)**</span></span>   

[!code-vb[Main](iteration-7-add-ajax-functionality-vb/samples/sample12.vb)]

<span data-ttu-id="fa5c1-284">Akcja AjaxDelete () jest dekoracyjna z atrybutem AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-284">The AjaxDelete() action is decorated with an AcceptVerbs attribute.</span></span> <span data-ttu-id="fa5c1-285">Ten atrybut uniemożliwia Wywoływanie akcji poza operacją HTTP inną niż operacja usuwania HTTP.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-285">This attribute prevents the action from being invoked except by any HTTP operation other than an HTTP DELETE operation.</span></span> <span data-ttu-id="fa5c1-286">W szczególności nie można wywołać tej akcji przy użyciu protokołu HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-286">In particular, you cannot invoke this action with an HTTP GET.</span></span>

<span data-ttu-id="fa5c1-287">Po usunięciu rekordu bazy danych należy wyświetlić zaktualizowaną listę kontaktów, które nie zawierają usuniętego rekordu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-287">After you delete database record, you need to display the updated list of contacts that does not contain the deleted record.</span></span> <span data-ttu-id="fa5c1-288">Metoda AjaxDelete () zwraca częściową ContactList i zaktualizowaną listę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-288">The AjaxDelete() method returns the ContactList partial and the updated list of contacts.</span></span>

## <a name="summary"></a><span data-ttu-id="fa5c1-289">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="fa5c1-289">Summary</span></span>

<span data-ttu-id="fa5c1-290">W tej iteracji dodaliśmy funkcję AJAX do naszej aplikacji Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-290">In this iteration, we added Ajax functionality to our Contact Manager application.</span></span> <span data-ttu-id="fa5c1-291">Używamy technologii AJAX, aby zwiększyć czas odpowiedzi i wydajność naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-291">We used Ajax to improve the responsiveness and performance of our application.</span></span>

<span data-ttu-id="fa5c1-292">Po pierwsze, Refaktoryzacja widoku indeksu, tak aby kliknięcie grupy kontaktów nie aktualizuje całego widoku.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-292">First, we refactored the Index view so that clicking a contact group does not update the entire view.</span></span> <span data-ttu-id="fa5c1-293">Zamiast tego kliknięcie grupy kontaktów aktualizuje tylko listę kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-293">Instead, clicking a contact group only updates the list of contacts.</span></span>

<span data-ttu-id="fa5c1-294">Następnie używamy efektów animacji jQuery do zanikania i zanikania na liście kontaktów.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-294">Next, we used jQuery animation effects to fade out and fade in the list of contacts.</span></span> <span data-ttu-id="fa5c1-295">Dodawanie animacji do aplikacji Ajax może służyć do udostępnienia użytkownikom aplikacji równorzędnym paskiem postępu przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-295">Adding animation to an Ajax application can be used to provide users of the application with the equivalent of a browser progress bar.</span></span>

<span data-ttu-id="fa5c1-296">Dodaliśmy również obsługę historii przeglądarki do naszej aplikacji AJAX.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-296">We also added browser history support to our Ajax application.</span></span> <span data-ttu-id="fa5c1-297">Wszyscy użytkownicy włączyli przyciski przeglądarki Wstecz i dalej, aby zmienić stan widoku indeksu.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-297">We enabled users to click the browser Back and Forward buttons to change the state of the Index view.</span></span>

<span data-ttu-id="fa5c1-298">Na koniec utworzyliśmy link usuwania obsługujący operacje usuwania HTTP.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-298">Finally, we created a delete link that supports HTTP DELETE operations.</span></span> <span data-ttu-id="fa5c1-299">Po przeprowadzeniu usuwania AJAX użytkownicy umożliwiają użytkownikom usuwanie rekordów bazy danych bez konieczności żądania dodatkowej strony potwierdzenia usunięcia przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fa5c1-299">By performing Ajax deletes, we enable users to delete database records without requiring the user to request an additional delete confirmation page.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="fa5c1-300">Wstecz</span><span class="sxs-lookup"><span data-stu-id="fa5c1-300">Previous</span></span>](iteration-6-use-test-driven-development-vb.md)
