---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Tworzenie klas modelu za pomocą Entity Framework (C#) | Microsoft Docs
author: microsoft
description: W ramach tego samouczka nauczysz się używać ASP.NET MVC z Entity Framework Microsoft. Dowiesz się, jak za pomocą Kreatora jednostki utworzyć jednostkę ADO.NET...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 2e0e365c287fc455015d237ea466301335805d14
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78581166"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="b69d3-104">Tworzenie klas modeli za pomocą programu Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="b69d3-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="b69d3-105">przez [firmę Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="b69d3-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="b69d3-106">W ramach tego samouczka nauczysz się używać ASP.NET MVC z Entity Framework Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b69d3-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="b69d3-107">Dowiesz się, jak za pomocą Kreatora jednostki utworzyć Entity Data Model ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="b69d3-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="b69d3-108">W ramach tego samouczka utworzymy aplikację sieci Web, która ilustruje sposób wybierania, wstawiania, aktualizowania i usuwania danych bazy danych przy użyciu Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="b69d3-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="b69d3-109">Celem tego samouczka jest wyjaśnienie, jak można tworzyć klasy dostępu do danych za pomocą Entity Framework firmy Microsoft podczas kompilowania aplikacji ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="b69d3-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="b69d3-110">W tym samouczku nie założono żadnej wcześniejszej znajomości Entity Framework firmy Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b69d3-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="b69d3-111">Na końcu tego samouczka dowiesz się, jak używać Entity Framework do wybierania, wstawiania, aktualizowania i usuwania rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="b69d3-112">Microsoft Entity Framework to narzędzie do mapowania relacyjnego obiektów (O/RM), które umożliwia automatyczne generowanie warstwy dostępu do danych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="b69d3-113">Entity Framework pozwala uniknąć żmudnym pracy nad tworzeniem klas dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="b69d3-114">Aby zilustrować, jak można użyć Entity Framework firmy Microsoft z ASP.NET MVC, utworzymy prostą przykładową aplikację.</span><span class="sxs-lookup"><span data-stu-id="b69d3-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="b69d3-115">Utworzymy aplikację bazy danych filmów, która umożliwia wyświetlanie i edytowanie rekordów bazy danych filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="b69d3-116">W tym samouczku założono, że masz program Visual Studio 2008 lub Visual Web Developer 2008 z dodatkiem Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="b69d3-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="b69d3-117">Aby można było użyć Entity Framework, wymagany jest dodatek Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="b69d3-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="b69d3-118">Program Visual Studio 2008 Service Pack 1 lub Visual Web Developer z dodatkiem Service Pack 1 można pobrać z następującego adresu:</span><span class="sxs-lookup"><span data-stu-id="b69d3-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

> [!NOTE] 
> 
> <span data-ttu-id="b69d3-119">Nie istnieje podstawowe połączenie między ASP.NET MVC a Entity Framework Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b69d3-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="b69d3-120">Istnieje kilka alternatyw dla Entity Framework, których można użyć z ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="b69d3-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="b69d3-121">Na przykład można skompilować klasy modelu MVC przy użyciu innych narzędzi O/RM, takich jak Microsoft LINQ to SQL, NHibernate lub Subsonic.</span><span class="sxs-lookup"><span data-stu-id="b69d3-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="b69d3-122">Tworzenie przykładowej bazy danych filmu</span><span class="sxs-lookup"><span data-stu-id="b69d3-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="b69d3-123">Aplikacja do odtwarzania filmów korzysta z tabeli bazy danych o nazwie filmy, która zawiera następujące kolumny:</span><span class="sxs-lookup"><span data-stu-id="b69d3-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="b69d3-124">Nazwa kolumny</span><span class="sxs-lookup"><span data-stu-id="b69d3-124">Column Name</span></span> | <span data-ttu-id="b69d3-125">Typ danych</span><span class="sxs-lookup"><span data-stu-id="b69d3-125">Data Type</span></span> | <span data-ttu-id="b69d3-126">Zezwolić na wartości null?</span><span class="sxs-lookup"><span data-stu-id="b69d3-126">Allow Nulls?</span></span> | <span data-ttu-id="b69d3-127">Czy jest kluczem podstawowym?</span><span class="sxs-lookup"><span data-stu-id="b69d3-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="b69d3-128">Identyfikator</span><span class="sxs-lookup"><span data-stu-id="b69d3-128">Id</span></span> | <span data-ttu-id="b69d3-129">int</span><span class="sxs-lookup"><span data-stu-id="b69d3-129">int</span></span> | <span data-ttu-id="b69d3-130">Fałsz</span><span class="sxs-lookup"><span data-stu-id="b69d3-130">False</span></span> | <span data-ttu-id="b69d3-131">True</span><span class="sxs-lookup"><span data-stu-id="b69d3-131">True</span></span> |
| <span data-ttu-id="b69d3-132">Tytuł</span><span class="sxs-lookup"><span data-stu-id="b69d3-132">Title</span></span> | <span data-ttu-id="b69d3-133">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="b69d3-133">nvarchar(100)</span></span> | <span data-ttu-id="b69d3-134">Fałsz</span><span class="sxs-lookup"><span data-stu-id="b69d3-134">False</span></span> | <span data-ttu-id="b69d3-135">Fałsz</span><span class="sxs-lookup"><span data-stu-id="b69d3-135">False</span></span> |
| <span data-ttu-id="b69d3-136">Dyrektor ds.</span><span class="sxs-lookup"><span data-stu-id="b69d3-136">Director</span></span> | <span data-ttu-id="b69d3-137">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="b69d3-137">nvarchar(100)</span></span> | <span data-ttu-id="b69d3-138">Fałsz</span><span class="sxs-lookup"><span data-stu-id="b69d3-138">False</span></span> | <span data-ttu-id="b69d3-139">Fałsz</span><span class="sxs-lookup"><span data-stu-id="b69d3-139">False</span></span> |

<span data-ttu-id="b69d3-140">Tabelę można dodać do projektu ASP.NET MVC, wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="b69d3-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="b69d3-141">Kliknij prawym przyciskiem myszy folder\_danych aplikacji w oknie Eksplorator rozwiązań i wybierz opcję menu **Dodaj, nowy element.**</span><span class="sxs-lookup"><span data-stu-id="b69d3-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="b69d3-142">W oknie dialogowym **Dodaj nowy element** wybierz pozycję **baza danych SQL Server**, nadaj bazie danych nazwę MoviesDB. mdf, a następnie kliknij przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="b69d3-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="b69d3-143">Kliknij dwukrotnie plik MoviesDB. mdf, aby otworzyć okno Eksplorator serwera/Eksplorator bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="b69d3-144">Rozwiń połączenie z bazą danych MoviesDB. mdf, kliknij prawym przyciskiem myszy folder Tables i wybierz opcję menu **Dodaj nową tabelę**.</span><span class="sxs-lookup"><span data-stu-id="b69d3-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="b69d3-145">W Projektancie tabel Dodaj identyfikatory, tytuły i kolumny dyrektora.</span><span class="sxs-lookup"><span data-stu-id="b69d3-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="b69d3-146">Kliknij przycisk **Zapisz** (ma ikonę dyskietki), aby zapisać nową tabelę z nazwami filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="b69d3-147">Po utworzeniu tabeli bazy danych filmów należy dodać do niej przykładowe dane.</span><span class="sxs-lookup"><span data-stu-id="b69d3-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="b69d3-148">Kliknij prawym przyciskiem myszy tabelę filmy i wybierz opcję menu **Pokaż dane tabeli**.</span><span class="sxs-lookup"><span data-stu-id="b69d3-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="b69d3-149">Możesz wprowadzić fałszywe dane filmu do wyświetlonej siatki.</span><span class="sxs-lookup"><span data-stu-id="b69d3-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="b69d3-150">Tworzenie Entity Data Model ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b69d3-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="b69d3-151">Aby można było użyć Entity Framework, należy utworzyć Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="b69d3-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="b69d3-152">Aby automatycznie wygenerować Entity Data Model z bazy danych, można skorzystać z *kreatora Entity Data Model* programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b69d3-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="b69d3-153">Wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="b69d3-153">Follow these steps:</span></span>

1. <span data-ttu-id="b69d3-154">Kliknij prawym przyciskiem myszy folder modele w oknie Eksplorator rozwiązań i wybierz opcję menu **Dodaj, nowy element**.</span><span class="sxs-lookup"><span data-stu-id="b69d3-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="b69d3-155">W oknie dialogowym **Dodaj nowy element** wybierz kategorię dane (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="b69d3-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="b69d3-156">Wybierz szablon **Entity Data Model ADO.NET** , nadaj Entity Data Model nazwę MoviesDBModel. edmx, a następnie kliknij przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="b69d3-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="b69d3-157">Kliknięcie przycisku **Dodaj** powoduje uruchomienie Kreatora modelu danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="b69d3-158">W kroku **Wybierz zawartość modelu** wybierz opcję **Generuj z bazy danych** , a następnie kliknij przycisk **dalej** (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="b69d3-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="b69d3-159">W kroku **Wybierz połączenie danych** wybierz połączenie z bazą danych MoviesDB. mdf, wprowadź nazwę ustawienia połączenia jednostki MoviesDBEntities, a następnie kliknij przycisk **dalej** (zobacz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="b69d3-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="b69d3-160">W kroku **Wybierz obiekty bazy danych** wybierz tabelę programu Movie Database i kliknij przycisk **Zakończ** (zobacz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="b69d3-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="b69d3-161">Po wykonaniu tych kroków zostanie otwarty program ADO.NET Entity Data Model Designer (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="b69d3-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="b69d3-162">**Rysunek 1 — Tworzenie nowego Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="b69d3-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="b69d3-164">**Rysunek 2 — Wybieranie etapu zawartości modelu**</span><span class="sxs-lookup"><span data-stu-id="b69d3-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="b69d3-166">**Rysunek 3 — Wybieranie połączenia danych**</span><span class="sxs-lookup"><span data-stu-id="b69d3-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="b69d3-168">**Rysunek 4 — Wybieranie obiektów bazy danych**</span><span class="sxs-lookup"><span data-stu-id="b69d3-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="b69d3-170">Modyfikowanie Entity Data Model ADO.NET</span><span class="sxs-lookup"><span data-stu-id="b69d3-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="b69d3-171">Po utworzeniu Entity Data Model można zmodyfikować model, korzystając z Entity Designer (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="b69d3-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="b69d3-172">Entity Designer można otworzyć w dowolnym momencie, klikając dwukrotnie plik MoviesDBModel. edmx znajdujący się w folderze models w oknie Eksplorator rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="b69d3-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="b69d3-173">**Rysunek 5 — Projektant Entity Data Model ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="b69d3-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="b69d3-175">Na przykład można użyć Entity Designer, aby zmienić nazwy klas generowanych przez kreatora danych modelu jednostki.</span><span class="sxs-lookup"><span data-stu-id="b69d3-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="b69d3-176">Kreator utworzył nową klasę dostępu do danych o nazwie filmy.</span><span class="sxs-lookup"><span data-stu-id="b69d3-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="b69d3-177">Innymi słowy, Kreator wydał klasę o takiej samej nazwie jak tabela bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="b69d3-178">Ponieważ ta klasa zostanie użyta do reprezentowania określonego wystąpienia filmu, należy zmienić nazwę klasy z filmów na film.</span><span class="sxs-lookup"><span data-stu-id="b69d3-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="b69d3-179">Jeśli chcesz zmienić nazwę klasy jednostki, możesz kliknąć dwukrotnie nazwę klasy w Entity Designer i wprowadzić nową nazwę (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="b69d3-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="b69d3-180">Alternatywnie można zmienić nazwę jednostki w okno Właściwości po wybraniu jednostki w Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="b69d3-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="b69d3-181">**Rysunek 6 — Zmiana nazwy jednostki**</span><span class="sxs-lookup"><span data-stu-id="b69d3-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="b69d3-183">Pamiętaj, aby zapisać Entity Data Model po wprowadzeniu modyfikacji, klikając przycisk Zapisz (ikonę dyskietki).</span><span class="sxs-lookup"><span data-stu-id="b69d3-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="b69d3-184">W tle Entity Designer generuje zestaw C# klas.</span><span class="sxs-lookup"><span data-stu-id="b69d3-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="b69d3-185">Można wyświetlić te klasy, otwierając plik MoviesDBModel.Designer.cs z okna Eksplorator rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="b69d3-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>

<span data-ttu-id="b69d3-186">Nie należy modyfikować kodu w pliku Designer.cs, ponieważ zmiany zostaną nadpisywane przy następnym użyciu Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="b69d3-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="b69d3-187">Jeśli chcesz zwiększyć funkcjonalność klas jednostek zdefiniowanych w pliku Designer.cs, możesz utworzyć *klasy częściowe* w oddzielnych plikach.</span><span class="sxs-lookup"><span data-stu-id="b69d3-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="b69d3-188">Wybieranie rekordów bazy danych z Entity Framework</span><span class="sxs-lookup"><span data-stu-id="b69d3-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="b69d3-189">Rozpocznijmy Tworzenie aplikacji bazy danych filmów, tworząc stronę, która wyświetla listę rekordów filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="b69d3-190">Kontroler Home na liście 1 uwidacznia akcję o nazwie index ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="b69d3-191">Akcja index () zwraca wszystkie rekordy filmu z tabeli bazy danych filmów, wykorzystując Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="b69d3-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="b69d3-192">**Lista 1 – Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="b69d3-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="b69d3-193">Należy zauważyć, że kontroler z listą 1 zawiera konstruktora.</span><span class="sxs-lookup"><span data-stu-id="b69d3-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="b69d3-194">Konstruktor inicjuje pole na poziomie klasy o nazwie \_DB.</span><span class="sxs-lookup"><span data-stu-id="b69d3-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="b69d3-195">Pole \_DB reprezentuje jednostki bazy danych wygenerowane przez Entity Framework Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b69d3-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="b69d3-196">Pole \_DB jest wystąpieniem klasy MoviesDBEntities, która została wygenerowana przez Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="b69d3-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="b69d3-197">Aby można było użyć klasy theMoviesDBEntities w kontrolerze głównym, należy zaimportować przestrzeń nazw MovieEntityApp. models (*MVCProjectName*. Modele).</span><span class="sxs-lookup"><span data-stu-id="b69d3-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>

<span data-ttu-id="b69d3-198">Pole \_DB jest używane w ramach akcji index () do pobierania rekordów z tabeli bazy danych filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="b69d3-199">Wyrażenie \_DB. MovieSet reprezentuje wszystkie rekordy z tabeli bazy danych filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="b69d3-200">Metoda ToList — () służy do konwertowania zestawu filmów na ogólną kolekcję obiektów filmów (lista&lt;filmu&gt;).</span><span class="sxs-lookup"><span data-stu-id="b69d3-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="b69d3-201">Rekordy filmów są pobierane z pomocą LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="b69d3-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="b69d3-202">W akcji index () na liście 1 użyto *składni metody* LINQ do pobrania zestawu rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="b69d3-203">Jeśli wolisz, możesz zamiast tego użyć *składni zapytania* LINQ.</span><span class="sxs-lookup"><span data-stu-id="b69d3-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="b69d3-204">Poniższe dwie instrukcje wykonują takie same czynności:</span><span class="sxs-lookup"><span data-stu-id="b69d3-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="b69d3-205">Używaj niezależnej składni LINQ — składni metody lub składni zapytania — jest to najbardziej intuicyjne.</span><span class="sxs-lookup"><span data-stu-id="b69d3-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="b69d3-206">Nie ma różnicy w wydajności między dwoma podejściami — jedyną różnicą jest styl.</span><span class="sxs-lookup"><span data-stu-id="b69d3-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="b69d3-207">Widok w liście 2 służy do wyświetlania rekordów filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="b69d3-208">**Lista 2 — Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="b69d3-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="b69d3-209">Widok w liście 2 zawiera pętlę **foreach** , która iteruje przez każdy rekord filmu i wyświetla wartości tytułu i właściwości tego rekordu filmu.</span><span class="sxs-lookup"><span data-stu-id="b69d3-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="b69d3-210">Zwróć uwagę, że obok każdego rekordu jest wyświetlany link Edytuj i Usuń.</span><span class="sxs-lookup"><span data-stu-id="b69d3-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="b69d3-211">Ponadto w dolnej części widoku pojawi się link Dodaj film (patrz rysunek 7).</span><span class="sxs-lookup"><span data-stu-id="b69d3-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="b69d3-212">**Rysunek 7 — Widok indeksu**</span><span class="sxs-lookup"><span data-stu-id="b69d3-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="b69d3-214">Widok indeksu jest widokiem o *określonym typie*.</span><span class="sxs-lookup"><span data-stu-id="b69d3-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="b69d3-215">Widok indeksu zawiera &lt;% @ Page%&gt; z atrybutem *Inherits* , który rzutuje właściwość modelu na kolekcję listy ogólnej o jednoznacznie określonym typie obiektów filmów (lista&lt;film).</span><span class="sxs-lookup"><span data-stu-id="b69d3-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="b69d3-216">Wstawianie rekordów bazy danych z Entity Framework</span><span class="sxs-lookup"><span data-stu-id="b69d3-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="b69d3-217">Za pomocą Entity Framework można ułatwić wstawianie nowych rekordów do tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="b69d3-218">Lista 3 zawiera dwie nowe akcje dodane do klasy kontrolera macierzystego, za pomocą których można wstawiać nowe rekordy do tabeli bazy danych filmów.</span><span class="sxs-lookup"><span data-stu-id="b69d3-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="b69d3-219">**Lista 3 – Controllers\HomeController.cs (dodawanie metod)**</span><span class="sxs-lookup"><span data-stu-id="b69d3-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="b69d3-220">Pierwsza akcja Dodaj () po prostu zwraca widok.</span><span class="sxs-lookup"><span data-stu-id="b69d3-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="b69d3-221">Widok zawiera formularz służący do dodawania nowego rekordu bazy danych filmów (patrz rysunek 8).</span><span class="sxs-lookup"><span data-stu-id="b69d3-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="b69d3-222">Po przesłaniu formularza zostaje wywołana druga akcja Dodaj ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="b69d3-223">Zwróć uwagę, że druga akcja Dodaj () ma atrybut AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="b69d3-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="b69d3-224">Tę akcję można wywołać tylko w przypadku wykonywania operacji POST protokołu HTTP.</span><span class="sxs-lookup"><span data-stu-id="b69d3-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="b69d3-225">Innymi słowy, ta akcja może być wywoływana tylko w przypadku ogłaszania formularza HTML.</span><span class="sxs-lookup"><span data-stu-id="b69d3-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="b69d3-226">Druga akcja Add () tworzy nowe wystąpienie klasy filmu Entity Framework z pomocą metody ASP.NET MVC TryUpdateModel ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="b69d3-227">Metoda TryUpdateModel () przyjmuje pola w Postacicollection przekazaną do metody Add () i przypisuje wartości tych pól formularza HTML do klasy Movie.</span><span class="sxs-lookup"><span data-stu-id="b69d3-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="b69d3-228">W przypadku korzystania z Entity Framework należy podać "białą listę" właściwości przy użyciu metod TryUpdateModel lub UpdateModel do aktualizowania właściwości klasy jednostki.</span><span class="sxs-lookup"><span data-stu-id="b69d3-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="b69d3-229">Następnie akcja Dodaj () wykonuje kilka prostych walidacji formularza.</span><span class="sxs-lookup"><span data-stu-id="b69d3-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="b69d3-230">Akcja weryfikuje, czy zarówno tytuł, jak i właściwości dyrektora mają wartości.</span><span class="sxs-lookup"><span data-stu-id="b69d3-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="b69d3-231">Jeśli wystąpi błąd walidacji, zostanie dodany komunikat o błędzie weryfikacji do ModelState.</span><span class="sxs-lookup"><span data-stu-id="b69d3-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="b69d3-232">Jeśli nie występują błędy walidacji, do tabeli bazy danych filmów zostanie dodany nowy rekord filmu z pomocą Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="b69d3-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="b69d3-233">Nowy rekord zostanie dodany do bazy danych z następującymi dwoma wierszami kodu:</span><span class="sxs-lookup"><span data-stu-id="b69d3-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="b69d3-234">Pierwszy wiersz kodu dodaje nową jednostkę filmu do zestawu filmów śledzonych przez Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="b69d3-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="b69d3-235">Drugi wiersz kodu zapisuje wszelkie zmiany w filmach śledzonych z powrotem do podstawowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="b69d3-236">**Rysunek 8 — widok dodawania**</span><span class="sxs-lookup"><span data-stu-id="b69d3-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="b69d3-238">Aktualizowanie rekordów bazy danych za pomocą Entity Framework</span><span class="sxs-lookup"><span data-stu-id="b69d3-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="b69d3-239">Można przestrzegać niemal tego samego podejścia do edytowania rekordu bazy danych przy użyciu Entity Framework jako podejścia, które właśnie zastosowano do wstawienia nowego rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="b69d3-240">Lista 4 zawiera dwie nowe akcje kontrolera o nazwie Edit ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="b69d3-241">Pierwsza akcja Edytuj () zwraca formularz HTML służący do edytowania rekordu filmu.</span><span class="sxs-lookup"><span data-stu-id="b69d3-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="b69d3-242">Druga akcja Edytuj () podejmuje próbę zaktualizowania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="b69d3-243">**Lista 4 – Controllers\HomeController.cs (edycja metod)**</span><span class="sxs-lookup"><span data-stu-id="b69d3-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="b69d3-244">Druga akcja Edit () zaczyna się od pobrania rekordu filmu z bazy danych, która pasuje do identyfikatora edytowanego filmu.</span><span class="sxs-lookup"><span data-stu-id="b69d3-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="b69d3-245">Poniższa instrukcja LINQ to Entities umożliwia pobranie pierwszego rekordu bazy danych zgodnego z określonym identyfikatorem:</span><span class="sxs-lookup"><span data-stu-id="b69d3-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="b69d3-246">Następnie Metoda TryUpdateModel () służy do przypisywania wartości pól formularza HTML do właściwości jednostki filmu.</span><span class="sxs-lookup"><span data-stu-id="b69d3-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="b69d3-247">Zwróć uwagę, że podano białą listę, aby określić dokładne właściwości do zaktualizowania.</span><span class="sxs-lookup"><span data-stu-id="b69d3-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="b69d3-248">Kolejne proste sprawdzanie poprawności jest wykonywane w celu sprawdzenia, czy zarówno tytuł filmu, jak i właściwości dyrektora mają wartości.</span><span class="sxs-lookup"><span data-stu-id="b69d3-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="b69d3-249">Jeśli żadna właściwość nie zawiera wartości, do ModelState i ModelState. IsValid zwraca wartość false.</span><span class="sxs-lookup"><span data-stu-id="b69d3-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="b69d3-250">Na koniec, jeśli nie występują błędy walidacji, źródłowa tabela bazy danych filmów jest aktualizowana o wszelkie zmiany przez wywołanie metody metody SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="b69d3-251">Podczas edytowania rekordów bazy danych należy przekazać identyfikator edytowanego rekordu do akcji kontrolera, która wykonuje aktualizację bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="b69d3-252">W przeciwnym razie akcja kontrolera nie będzie wiedzieć, który rekord należy zaktualizować w źródłowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="b69d3-253">Widok edycji zawarty w liście 5 zawiera ukryte pole formularza, które reprezentuje identyfikator edytowanego rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="b69d3-254">**Lista 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="b69d3-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="b69d3-255">Usuwanie rekordów bazy danych za pomocą Entity Framework</span><span class="sxs-lookup"><span data-stu-id="b69d3-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="b69d3-256">Końcową operacją bazy danych, którą musimy wykonać w tym samouczku, jest usunięcie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="b69d3-257">W celu usunięcia określonego rekordu bazy danych można użyć akcji kontrolera w temacie 6.</span><span class="sxs-lookup"><span data-stu-id="b69d3-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="b69d3-258">**Lista 6--\Controllers\HomeController.cs (Akcja usuwania)**</span><span class="sxs-lookup"><span data-stu-id="b69d3-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="b69d3-259">Akcja Usuń () najpierw pobiera jednostkę filmu, która pasuje do identyfikatora przesłanego do akcji.</span><span class="sxs-lookup"><span data-stu-id="b69d3-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="b69d3-260">Następnie film zostanie usunięty z bazy danych przez wywołanie metody DeleteObject (), po której następuje Metoda metody SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="b69d3-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="b69d3-261">Na koniec użytkownik zostanie przekierowany z powrotem do widoku indeksu.</span><span class="sxs-lookup"><span data-stu-id="b69d3-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="b69d3-262">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b69d3-262">Summary</span></span>

<span data-ttu-id="b69d3-263">W tym samouczku przedstawiono sposób tworzenia aplikacji sieci Web opartych na bazie danych dzięki wykorzystaniu ASP.NET MVC i Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="b69d3-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="b69d3-264">Wiesz już, jak utworzyć aplikację, która umożliwia wybieranie, wstawianie, aktualizowanie i usuwanie rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="b69d3-265">Najpierw omówiono, jak za pomocą Kreatora Entity Data Model wygenerować Entity Data Model z poziomu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b69d3-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="b69d3-266">Następnie dowiesz się, jak za pomocą LINQ to Entities pobrać zestaw rekordów bazy danych z tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="b69d3-267">Na koniec użyto Entity Framework do wstawiania, aktualizowania i usuwania rekordów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b69d3-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="b69d3-268">Dalej</span><span class="sxs-lookup"><span data-stu-id="b69d3-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)
