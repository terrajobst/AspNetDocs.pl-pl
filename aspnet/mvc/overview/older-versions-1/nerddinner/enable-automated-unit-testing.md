---
uid: mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
title: Włączanie automatycznych testów jednostkowych | Dokumentacja firmy Microsoft
author: microsoft
description: Krok 12 pokazuje, jak tworzyć pakiet testów automatycznych jednostkowych, Sprawdź nasze funkcje NerdDinner, a które zapewniło zaufania, aby wprowadzić zmiany...
ms.author: riande
ms.date: 07/27/2010
ms.assetid: a19ff2ce-3f7e-4358-9a51-a1403da9c63e
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
msc.type: authoredcontent
ms.openlocfilehash: b0c9cd7ab36a8414e0d7d50a68b05bb09a5f24f1
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59387909"
---
# <a name="enable-automated-unit-testing"></a><span data-ttu-id="fb900-103">Włączanie automatycznych testów jednostkowych</span><span class="sxs-lookup"><span data-stu-id="fb900-103">Enable Automated Unit Testing</span></span>

<span data-ttu-id="fb900-104">przez [firmy Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="fb900-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="fb900-105">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="fb900-105">Download PDF</span></span>](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> <span data-ttu-id="fb900-106">Jest to krok 12 bezpłatnych [samouczek aplikacji "NerdDinner"](introducing-the-nerddinner-tutorial.md) , przeszukiwania — szczegółowe instrukcje dotyczące tworzenia małych, ale ukończyć, aplikacji sieci web przy użyciu platformy ASP.NET MVC 1.</span><span class="sxs-lookup"><span data-stu-id="fb900-106">This is step 12 of a free ["NerdDinner" application tutorial](introducing-the-nerddinner-tutorial.md) that walks-through how to build a small, but complete, web application using ASP.NET MVC 1.</span></span>
> 
> <span data-ttu-id="fb900-107">Kroku 12 pokazuje, jak opracować pakiet testów automatycznych jednostkowych, Sprawdź nasze funkcje NerdDinner, a które zapewniło zaufania do wprowadzania zmian i usprawnień do aplikacji w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="fb900-107">Step 12 shows how to develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>
> 
> <span data-ttu-id="fb900-108">Jeśli używasz programu ASP.NET MVC 3, zaleca się wykonać [Rozpoczynanie pracy z MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) lub [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) samouczków.</span><span class="sxs-lookup"><span data-stu-id="fb900-108">If you are using ASP.NET MVC 3, we recommend you follow the [Getting Started With MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) or [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) tutorials.</span></span>


## <a name="nerddinner-step-12-unit-testing"></a><span data-ttu-id="fb900-109">NerdDinner krok 12: Testowanie jednostkowe</span><span class="sxs-lookup"><span data-stu-id="fb900-109">NerdDinner Step 12: Unit Testing</span></span>

<span data-ttu-id="fb900-110">Możemy tworzyć pakiet testów automatycznych jednostkowych, Sprawdź nasze funkcje NerdDinner, a które zapewniło zaufania do wprowadzania zmian i usprawnień do aplikacji w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="fb900-110">Let's develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>

### <a name="why-unit-test"></a><span data-ttu-id="fb900-111">Dlaczego Test jednostkowy?</span><span class="sxs-lookup"><span data-stu-id="fb900-111">Why Unit Test?</span></span>

<span data-ttu-id="fb900-112">Na dysku do pracy jednym rano masz nagłe flash programu o aplikacji, którą pracujesz.</span><span class="sxs-lookup"><span data-stu-id="fb900-112">On the drive into work one morning you have a sudden flash of inspiration about an application you are working on.</span></span> <span data-ttu-id="fb900-113">Zorientujesz się, że w przypadku zmiany, które można zaimplementować, aby ułatwić aplikacji znacznie lepiej.</span><span class="sxs-lookup"><span data-stu-id="fb900-113">You realize there is a change you can implement that will make the application dramatically better.</span></span> <span data-ttu-id="fb900-114">Może to być refaktoryzacji, która czyści kod, dodaje nową funkcję lub naprawia błąd.</span><span class="sxs-lookup"><span data-stu-id="fb900-114">It might be a refactoring that cleans up the code, adds a new feature, or fixes a bug.</span></span>

<span data-ttu-id="fb900-115">To pytanie, na które confronts, po przyjeździe do komputera — "jak bezpieczne jest zapewnienie to ulepszenie?"</span><span class="sxs-lookup"><span data-stu-id="fb900-115">The question that confronts you when you arrive at your computer is – "how safe is it to make this improvement?"</span></span> <span data-ttu-id="fb900-116">Co w przypadku wprowadzania zmian ma efekty uboczne lub przerywa coś?</span><span class="sxs-lookup"><span data-stu-id="fb900-116">What if making the change has side effects or breaks something?</span></span> <span data-ttu-id="fb900-117">Zmiany mogą być proste i trwać tylko kilka minut, aby zaimplementować, ale co zrobić, jeśli zajmuje godzin, aby ręcznie przetestować wszystkie scenariusze aplikacji?</span><span class="sxs-lookup"><span data-stu-id="fb900-117">The change might be simple and only take a few minutes to implement, but what if it takes hours to manually test out all of the application scenarios?</span></span> <span data-ttu-id="fb900-118">Co zrobić, Jeśli zapomnisz obejmuje scenariusz i niedziałająca aplikacja przechodzi w środowisku produkcyjnym?</span><span class="sxs-lookup"><span data-stu-id="fb900-118">What if you forget to cover a scenario and a broken application goes into production?</span></span> <span data-ttu-id="fb900-119">Sprawia to ulepszenie naprawdę warto wszystkich wysiłków?</span><span class="sxs-lookup"><span data-stu-id="fb900-119">Is making this improvement really worth all the effort?</span></span>

<span data-ttu-id="fb900-120">Automatyczne testy jednostkowe można podać projektowi, która pozwala na stale udoskonalaj swoje aplikacje i uniknąć obawiasz się kod, którą pracujesz.</span><span class="sxs-lookup"><span data-stu-id="fb900-120">Automated unit tests can provide a safety net that enables you to continually enhance your applications, and avoid being afraid of the code you are working on.</span></span> <span data-ttu-id="fb900-121">Posiadanie testy automatyczne, które szybko sprawdzić, czy funkcje umożliwiają pomogła Ci w celu ulepszenia, użytkownik może w przeciwnym razie nie mają uznało, doświadczenia i kodu bez obaw — wykonywanie.</span><span class="sxs-lookup"><span data-stu-id="fb900-121">Having automated tests that quickly verify functionality enables you to code with confidence – and empower you to make improvements you might otherwise not have felt comfortable doing.</span></span> <span data-ttu-id="fb900-122">Ułatwiają również tworzenie rozwiązania, które będzie łatwiejszy w utrzymaniu i dłuższy okres istnienia — które potencjalnych klientów, aby znacznie wyższa zwrotu z inwestycji.</span><span class="sxs-lookup"><span data-stu-id="fb900-122">They also help create solutions that are more maintainable and have a longer lifetime - which leads to a much higher return on investment.</span></span>

<span data-ttu-id="fb900-123">Platforma ASP.NET MVC ułatwia naturalna funkcji aplikacji testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="fb900-123">The ASP.NET MVC Framework makes it easy and natural to unit test application functionality.</span></span> <span data-ttu-id="fb900-124">Umożliwia ona także testów opartych na rozwój (TDD) przepływu pracy, który umożliwia oparte na rozwoju pierwszego badania.</span><span class="sxs-lookup"><span data-stu-id="fb900-124">It also enables a Test Driven Development (TDD) workflow that enables test-first based development.</span></span>

### <a name="nerddinnertests-project"></a><span data-ttu-id="fb900-125">NerdDinner.Tests Project</span><span class="sxs-lookup"><span data-stu-id="fb900-125">NerdDinner.Tests Project</span></span>

<span data-ttu-id="fb900-126">Wtedy stworzyliśmy naszej aplikacji NerdDinner na początku tego samouczka będziemy pojawiał się monit z pytaniem, czy Chcieliśmy, aby utworzyć projekt testu jednostkowego nikogo projekt aplikacji do okna dialogowego:</span><span class="sxs-lookup"><span data-stu-id="fb900-126">When we created our NerdDinner application at the beginning of this tutorial, we were prompted with a dialog asking whether we wanted to create a unit test project to go along with the application project:</span></span>

![](enable-automated-unit-testing/_static/image1.png)

<span data-ttu-id="fb900-127">Firma Microsoft przechowywane "Tak, Utwórz projekt testu jednostkowego" zaznaczony przycisk radiowy — co spowodowało w projekcie "NerdDinner.Tests" dodawany do naszego rozwiązania:</span><span class="sxs-lookup"><span data-stu-id="fb900-127">We kept the "Yes, create a unit test project" radio button selected – which resulted in a "NerdDinner.Tests" project being added to our solution:</span></span>

![](enable-automated-unit-testing/_static/image2.png)

<span data-ttu-id="fb900-128">Projekt NerdDinner.Tests odwołuje się do zestawu projektów aplikacji NerdDinner i pozwala na łatwe dodawanie testów automatycznych, aby sprawdzić działanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fb900-128">The NerdDinner.Tests project references the NerdDinner application project assembly, and enables us to easily add automated tests to it that verify the application functionality.</span></span>

### <a name="creating-unit-tests-for-our-dinner-model-class"></a><span data-ttu-id="fb900-129">Tworzenie testów jednostkowych dla naszych obiad klasy modelu</span><span class="sxs-lookup"><span data-stu-id="fb900-129">Creating Unit Tests for our Dinner Model Class</span></span>

<span data-ttu-id="fb900-130">Dodajmy niektóre testy do naszego projektu NerdDinner.Tests, który zweryfikować obiad klasy, którą utworzyliśmy, gdy opracowaliśmy nasze warstwy modelu.</span><span class="sxs-lookup"><span data-stu-id="fb900-130">Let's add some tests to our NerdDinner.Tests project that verify the Dinner class we created when we built our model layer.</span></span>

<span data-ttu-id="fb900-131">Zaczniemy, tworząc nowy folder w projekcie testu o nazwie "Modele", gdzie będzie umieszczać Nasze testy związane z modelu.</span><span class="sxs-lookup"><span data-stu-id="fb900-131">We'll start by creating a new folder within our test project called "Models" where we'll place our model-related tests.</span></span> <span data-ttu-id="fb900-132">Następnie utworzymy kliknij prawym przyciskiem myszy w folderze i wybierz **Add -&gt;nowy Test** polecenia menu.</span><span class="sxs-lookup"><span data-stu-id="fb900-132">We'll then right-click on the folder and choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="fb900-133">Zostanie wyświetlone okno dialogowe "Dodaj nowy Test".</span><span class="sxs-lookup"><span data-stu-id="fb900-133">This will bring up the "Add New Test" dialog.</span></span>

<span data-ttu-id="fb900-134">Wybraliśmy tworzenie "Testu jednostkowego" i nadaj mu nazwę "DinnerTest.cs":</span><span class="sxs-lookup"><span data-stu-id="fb900-134">We'll choose to create a "Unit Test" and name it "DinnerTest.cs":</span></span>

![](enable-automated-unit-testing/_static/image3.png)

<span data-ttu-id="fb900-135">Po kliknięciu przycisku "ok" Visual Studio Dodaj (i otworzyć) DinnerTest.cs plik do projektu:</span><span class="sxs-lookup"><span data-stu-id="fb900-135">When we click the "ok" button Visual Studio will add (and open) a DinnerTest.cs file to the project:</span></span>

![](enable-automated-unit-testing/_static/image4.png)

<span data-ttu-id="fb900-136">Domyślny szablon testu jednostki programu Visual Studio zawiera bunch kodu kocioł tablicy znajdujący się w nim, który można znaleźć nieco nieuporządkowane.</span><span class="sxs-lookup"><span data-stu-id="fb900-136">The default Visual Studio unit test template has a bunch of boiler-plate code within it that I find a little messy.</span></span> <span data-ttu-id="fb900-137">Teraz oczyścić je tylko zawierać poniższy kod:</span><span class="sxs-lookup"><span data-stu-id="fb900-137">Let's clean it up to just contain the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample1.cs)]

<span data-ttu-id="fb900-138">Atrybut [TestClass] w klasie DinnerTest powyżej identyfikuje je jako klasę, która będzie zawierać testów, oraz opcjonalne badanie inicjowania i kod wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="fb900-138">The [TestClass] attribute on the DinnerTest class above identifies it as a class that will contain tests, as well as optional test initialization and teardown code.</span></span> <span data-ttu-id="fb900-139">Firma Microsoft może zdefiniować testy w nim, przez dodanie metody publiczne, których atrybut [TestMethod].</span><span class="sxs-lookup"><span data-stu-id="fb900-139">We can define tests within it by adding public methods that have a [TestMethod] attribute on them.</span></span>

<span data-ttu-id="fb900-140">Poniżej przedstawiono to pierwsza z dwóch testów, które dodamy, które korzystają z naszych klasy firmy Dinner.</span><span class="sxs-lookup"><span data-stu-id="fb900-140">Below are the first of two tests we'll add that exercise our Dinner class.</span></span> <span data-ttu-id="fb900-141">Pierwszy test sprawdza, nasze obiad jest nieprawidłowy, jeśli nowe obiad została utworzona bez wszystkich właściwości prawidłowo ustawione.</span><span class="sxs-lookup"><span data-stu-id="fb900-141">The first test verifies that our Dinner is invalid if a new Dinner is created without all properties being set correctly.</span></span> <span data-ttu-id="fb900-142">Drugi test sprawdza, czy naszych obiad prawidłowe po obiad ma wszystkie właściwości ustaw prawidłowymi wartościami:</span><span class="sxs-lookup"><span data-stu-id="fb900-142">The second test verifies that our Dinner is valid when a Dinner has all properties set with valid values:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample2.cs)]

<span data-ttu-id="fb900-143">Powyżej zauważysz, że nasze nazwy testu są bardzo jawne (i nieco pełne).</span><span class="sxs-lookup"><span data-stu-id="fb900-143">You'll notice above that our test names are very explicit (and somewhat verbose).</span></span> <span data-ttu-id="fb900-144">Robimy to, ponieważ firma Microsoft może się to zakończyć tworzenie setek lub tysięcy testów małych i chcemy ułatwić szybko określić przeznaczenie i zachowanie każdego z nich (szczególnie w przypadku czekamy na liście błędów w programie test runner).</span><span class="sxs-lookup"><span data-stu-id="fb900-144">We are doing this because we might end up creating hundreds or thousands of small tests, and we want to make it easy to quickly determine the intent and behavior of each of them (especially when we are looking through a list of failures in a test runner).</span></span> <span data-ttu-id="fb900-145">Powinien zostać nazwany nazwy testów po funkcje, które poddawanego testom.</span><span class="sxs-lookup"><span data-stu-id="fb900-145">The test names should be named after the functionality they are testing.</span></span> <span data-ttu-id="fb900-146">Powyżej użyto "rzeczownik\_powinien\_czasownik" wzorca nazewnictwa.</span><span class="sxs-lookup"><span data-stu-id="fb900-146">Above we are using a "Noun\_Should\_Verb" naming pattern.</span></span>

<span data-ttu-id="fb900-147">Firma Microsoft struktury testów za pomocą testowania wzorca — co znaczyło "Rozmieść, Act, Asercja" "AAA":</span><span class="sxs-lookup"><span data-stu-id="fb900-147">We are structuring the tests using the "AAA" testing pattern – which stands for "Arrange, Act, Assert":</span></span>

- <span data-ttu-id="fb900-148">Rozmieść: Konfigurowanie jednostki poddawana testom</span><span class="sxs-lookup"><span data-stu-id="fb900-148">Arrange: Setup the unit being tested</span></span>
- <span data-ttu-id="fb900-149">Działanie: Wykonuje jednostki w ramach testu i przechwytywania wyników</span><span class="sxs-lookup"><span data-stu-id="fb900-149">Act: Exercise the unit under test and capture results</span></span>
- <span data-ttu-id="fb900-150">Assert: Sprawdź działanie</span><span class="sxs-lookup"><span data-stu-id="fb900-150">Assert: Verify the behavior</span></span>

<span data-ttu-id="fb900-151">Podczas pisania testów, które chcemy, aby uniknąć indywidualnych testów są zbyt dużo.</span><span class="sxs-lookup"><span data-stu-id="fb900-151">When we write tests we want to avoid having the individual tests do too much.</span></span> <span data-ttu-id="fb900-152">Zamiast tego każdy test powinien sprawdzić tylko jednego koncepcja (co spowoduje, że jej znacznie łatwiejsze w określeniu przyczyny awarii).</span><span class="sxs-lookup"><span data-stu-id="fb900-152">Instead each test should verify only a single concept (which will make it much easier to pinpoint the cause of failures).</span></span> <span data-ttu-id="fb900-153">Dobrą praktyką jest spróbuj i może zawierać tylko jeden assert instrukcji dla każdego testu.</span><span class="sxs-lookup"><span data-stu-id="fb900-153">A good guideline is to try and only have a single assert statement for each test.</span></span> <span data-ttu-id="fb900-154">Jeśli masz więcej niż jedną asercję instrukcji w metodzie testowej, upewnij się, że są one wszystkie używane do testowania tego samego pojęcia.</span><span class="sxs-lookup"><span data-stu-id="fb900-154">If you have more than one assert statement in a test method, make sure they are all being used to test the same concept.</span></span> <span data-ttu-id="fb900-155">W razie wątpliwości należy innego testu.</span><span class="sxs-lookup"><span data-stu-id="fb900-155">When in doubt, make another test.</span></span>

### <a name="running-tests"></a><span data-ttu-id="fb900-156">Uruchamianie testów</span><span class="sxs-lookup"><span data-stu-id="fb900-156">Running Tests</span></span>

<span data-ttu-id="fb900-157">Visual Studio 2008 Professional (i nowsze wersje) zawiera wbudowane uruchamiający, który może służyć do uruchamiania jednostki Test programu Visual Studio projektów związanych z poziomu środowiska IDE.</span><span class="sxs-lookup"><span data-stu-id="fb900-157">Visual Studio 2008 Professional (and higher editions) includes a built-in test runner that can be used to run Visual Studio Unit Test projects within the IDE.</span></span> <span data-ttu-id="fb900-158">Można wybrać **Test -&gt;Uruchom -&gt;wszystkie testy w rozwiązaniu** polecenia menu (lub typu Ctrl R, A) należy uruchomić wszystkie nasze testy jednostkowe.</span><span class="sxs-lookup"><span data-stu-id="fb900-158">We can select the **Test-&gt;Run-&gt;All Tests in Solution** menu command (or type Ctrl R, A) to run all of our unit tests.</span></span> <span data-ttu-id="fb900-159">Lub też firma Microsoft Ustaw naszych kursor wewnątrz metody klasy lub test testów określonych i użyj **Test -&gt;Uruchom -&gt;testy z bieżącego kontekstu** polecenia menu (lub typu Ctrl R, T) do uruchamiania podzestaw testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="fb900-159">Or alternatively we can position our cursor within a specific test class or test method and use the **Test-&gt;Run-&gt;Tests in Current Context** menu command (or type Ctrl R, T) to run a subset of the unit tests.</span></span>

<span data-ttu-id="fb900-160">Umożliwia umieszczanie naszych kursora w obrębie klasy DinnerTest i wpisz "Ctrl R, T", aby testy wykonywania dwóch, które właśnie zdefiniowane.</span><span class="sxs-lookup"><span data-stu-id="fb900-160">Let's position our cursor within the DinnerTest class and type "Ctrl R, T" to run the two tests we just defined.</span></span> <span data-ttu-id="fb900-161">Gdy odbywa się to okno "Wyniki testu" będą wyświetlane w programie Visual Studio, a zobaczymy wyników naszego testu wymienionych w nim:</span><span class="sxs-lookup"><span data-stu-id="fb900-161">When we do this a "Test Results" window will appear within Visual Studio and we'll see the results of our test run listed within it:</span></span>

![](enable-automated-unit-testing/_static/image5.png)

<span data-ttu-id="fb900-162">*Uwaga: Okno wyników testów programu VS nie są wyświetlane w kolumnie Nazwa klasy domyślnie. Możesz dodać dziennik, kliknij prawym przyciskiem myszy w oknie wyników badań i za pomocą polecenia menu Dodaj/Usuń kolumny.*</span><span class="sxs-lookup"><span data-stu-id="fb900-162">*Note: The VS test results window does not show the Class Name column by default. You can add this by right-clicking within the Test Results window and using the Add/Remove Columns menu command.*</span></span>

<span data-ttu-id="fb900-163">Nasze dwa testy trwały za ułamek chwilę, aby uruchomić — i jak można znaleźć zarówno przekazywały.</span><span class="sxs-lookup"><span data-stu-id="fb900-163">Our two tests took only a fraction of a second to run – and as you can see they both passed.</span></span> <span data-ttu-id="fb900-164">Firma Microsoft jest teraz przejść na i rozszerzać je, tworząc dodatkowe testy, które sprawdzić poprawności określonej reguły, a także obejmują dwie metody pomocnika - IsUserHost() i IsUserRegistered() — dodaną do klasy firmy Dinner.</span><span class="sxs-lookup"><span data-stu-id="fb900-164">We can now go on and augment them by creating additional tests that verify specific rule validations, as well as cover the two helper methods - IsUserHost() and IsUserRegistered() – that we added to the Dinner class.</span></span> <span data-ttu-id="fb900-165">Posiadanie tych testów w miejscu dla klasy firmy Dinner, spowoduje to znacznie łatwiejsze i bezpieczniejsze dodać nowe reguły biznesowe i sprawdzania poprawności do niego w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="fb900-165">Having all these tests in place for the Dinner class will make it much easier and safer to add new business rules and validations to it in the future.</span></span> <span data-ttu-id="fb900-166">Firma Microsoft Dodaj naszej nowej logiki reguły do obiad, a następnie w ciągu kilku sekund Sprawdź, czy go nie zostało przerwane żadnego z naszych poprzedniej funkcji logic.</span><span class="sxs-lookup"><span data-stu-id="fb900-166">We can add our new rule logic to Dinner, and then within seconds verify that it hasn't broken any of our previous logic functionality.</span></span>

<span data-ttu-id="fb900-167">Zwróć uwagę, jak przy użyciu nazwy, opisu testu można łatwo szybko zrozumieć, co sprawdza każdy test.</span><span class="sxs-lookup"><span data-stu-id="fb900-167">Notice how using a descriptive test name makes it easy to quickly understand what each test is verifying.</span></span> <span data-ttu-id="fb900-168">Zaleca się **narzędzia -&gt;opcje** polecenia menu, otwierając Test Tools —&gt;ekran konfiguracji wykonywania testów i sprawdzanie, czy "dwukrotne kliknięcie wyniku testu jednostkowego nie powiodło się lub niejednoznaczny Wyświetla pole wyboru punktu awarii w teście".</span><span class="sxs-lookup"><span data-stu-id="fb900-168">I recommend using the **Tools-&gt;Options** menu command, opening the Test Tools-&gt;Test Execution configuration screen, and checking the "Double-clicking a failed or inconclusive unit test result displays the point of failure in the test" checkbox.</span></span> <span data-ttu-id="fb900-169">Pozwoli to kliknij dwukrotnie błąd w oknie wyników testu i przejść od razu z niepowodzeniem asercji.</span><span class="sxs-lookup"><span data-stu-id="fb900-169">This will allow you to double-click on a failure in the test results window and jump immediately to the assert failure.</span></span>

### <a name="creating-dinnerscontroller-unit-tests"></a><span data-ttu-id="fb900-170">Tworzenie testów jednostkowych DinnersController</span><span class="sxs-lookup"><span data-stu-id="fb900-170">Creating DinnersController Unit Tests</span></span>

<span data-ttu-id="fb900-171">Utwórzmy teraz niektóre testy jednostkowe, które Sprawdź nasze funkcje DinnersController.</span><span class="sxs-lookup"><span data-stu-id="fb900-171">Let's now create some unit tests that verify our DinnersController functionality.</span></span> <span data-ttu-id="fb900-172">Firma Microsoft będzie uruchomić, klikając prawym przyciskiem myszy w folderze "Kontrolerów" w projekcie testów, a następnie kliknij **Add -&gt;nowy Test** polecenia menu.</span><span class="sxs-lookup"><span data-stu-id="fb900-172">We'll start by right-clicking on the "Controllers" folder within our Test project and then choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="fb900-173">Utworzymy "Unit Test" i nadaj mu nazwę "DinnersControllerTest.cs".</span><span class="sxs-lookup"><span data-stu-id="fb900-173">We'll create a "Unit Test" and name it "DinnersControllerTest.cs".</span></span>

<span data-ttu-id="fb900-174">Utworzymy dwie metody testowe, weryfikujące metody akcji Details() na DinnersController.</span><span class="sxs-lookup"><span data-stu-id="fb900-174">We'll create two test methods that verify the Details() action method on the DinnersController.</span></span> <span data-ttu-id="fb900-175">Pierwszy sprawdzi, czy widok jest zwracany zleconą obiad z istniejących.</span><span class="sxs-lookup"><span data-stu-id="fb900-175">The first will verify that a View is returned when an existing Dinner is requested.</span></span> <span data-ttu-id="fb900-176">Drugi sprawdzi, czy widok "NotFound" jest zwracany, gdy zażądano obiad nieistniejącej:</span><span class="sxs-lookup"><span data-stu-id="fb900-176">The second will verify that a "NotFound" view is returned when a non-existent Dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample3.cs)]

<span data-ttu-id="fb900-177">Powyższy kod kompiluje się czyszczenie.</span><span class="sxs-lookup"><span data-stu-id="fb900-177">The above code compiles clean.</span></span> <span data-ttu-id="fb900-178">Uruchamiania testów, jednak także zakończyć się niepowodzeniem:</span><span class="sxs-lookup"><span data-stu-id="fb900-178">When we run the tests, though, they both fail:</span></span>

![](enable-automated-unit-testing/_static/image6.png)

<span data-ttu-id="fb900-179">Jeśli przyjrzymy się komunikaty o błędach, zobaczymy, że został powodu testy nie powiodło się, ponieważ klasy Nasze DinnersRepository nie nawiązał połączenia z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="fb900-179">If we look at the error messages, we'll see that the reason the tests failed was because our DinnersRepository class was unable to connect to a database.</span></span> <span data-ttu-id="fb900-180">Nasza aplikacja NerdDinner używa parametrów połączenia do lokalnego pliku programu SQL Server Express, który znajduje się w obszarze \App\_danych katalogu projektu aplikacji NerdDinner.</span><span class="sxs-lookup"><span data-stu-id="fb900-180">Our NerdDinner application is using a connection-string to a local SQL Server Express file which lives under the \App\_Data directory of the NerdDinner application project.</span></span> <span data-ttu-id="fb900-181">Ponieważ projekcie NerdDinner.Tests kompiluje i uruchamia w innym katalogu następnie projekt aplikacji, lokalizację ścieżki względnej nasze parametry połączenia jest niepoprawny.</span><span class="sxs-lookup"><span data-stu-id="fb900-181">Because our NerdDinner.Tests project compiles and runs in a different directory then the application project, the relative path location of our connection-string is incorrect.</span></span>

<span data-ttu-id="fb900-182">Firma Microsoft *można* rozwiązać ten problem przez skopiowanie pliku bazy danych programu SQL Express do naszego projektu testu, a następnie dodać do niego parametry połączenia usługi odpowiednich testów w pliku App.config projektu testu w naszym.</span><span class="sxs-lookup"><span data-stu-id="fb900-182">We *could* fix this by copying the SQL Express database file to our test project, and then add an appropriate test connection-string to it in the App.config of our test project.</span></span> <span data-ttu-id="fb900-183">To otrzymamy powyższych testów zostało odblokowane i uruchomione.</span><span class="sxs-lookup"><span data-stu-id="fb900-183">This would get the above tests unblocked and running.</span></span>

<span data-ttu-id="fb900-184">Testy jednostkowe kodu przy użyciu rzeczywistego bazy danych, jednak wnosi wiele wyzwań.</span><span class="sxs-lookup"><span data-stu-id="fb900-184">Unit testing code using a real database, though, brings with it a number of challenges.</span></span> <span data-ttu-id="fb900-185">W szczególności:</span><span class="sxs-lookup"><span data-stu-id="fb900-185">Specifically:</span></span>

- <span data-ttu-id="fb900-186">Znacznie zmniejsza czas wykonania testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="fb900-186">It significantly slows down the execution time of unit tests.</span></span> <span data-ttu-id="fb900-187">Tym dłużej trwa do uruchomienia testów, mniej prawdopodobne, zostaną wykonane za pomocą często.</span><span class="sxs-lookup"><span data-stu-id="fb900-187">The longer it takes to run tests, the less likely you are to execute them frequently.</span></span> <span data-ttu-id="fb900-188">Najlepiej ma testy jednostkowe, aby można było można uruchomić w ciągu kilku sekund — i być coś, co możesz zrobić, naturalny sposób jako kompilowania projektu.</span><span class="sxs-lookup"><span data-stu-id="fb900-188">Ideally you want your unit tests to be able to be run in seconds – and have it be something you do as naturally as compiling the project.</span></span>
- <span data-ttu-id="fb900-189">Utrudnia to logiki instalacyjne i czyszczące w ramach testów.</span><span class="sxs-lookup"><span data-stu-id="fb900-189">It complicates the setup and cleanup logic within tests.</span></span> <span data-ttu-id="fb900-190">Chcesz, aby każdy test jednostkowy być izolowane, niezależnie od innych (z nie efektów ubocznych lub zależności).</span><span class="sxs-lookup"><span data-stu-id="fb900-190">You want each unit test to be isolated and independent of others (with no side effects or dependencies).</span></span> <span data-ttu-id="fb900-191">Podczas pracy w bazie danych rzeczywistych należy zachować ostrożność, stanu i zresetowanie jej między testami.</span><span class="sxs-lookup"><span data-stu-id="fb900-191">When working against a real database you have to be mindful of state and reset it between tests.</span></span>

<span data-ttu-id="fb900-192">Przyjrzyjmy się wzorca projektowego o nazwie "wstrzykiwanie zależności", które mogą pomóc nam obejścia tych problemów i uniknąć konieczności rzeczywistego bazy danych za pomocą naszych testach.</span><span class="sxs-lookup"><span data-stu-id="fb900-192">Let's look at a design pattern called "dependency injection" that can help us work around these issues and avoid the need to use a real database with our tests.</span></span>

### <a name="dependency-injection"></a><span data-ttu-id="fb900-193">Wstrzykiwanie zależności</span><span class="sxs-lookup"><span data-stu-id="fb900-193">Dependency Injection</span></span>

<span data-ttu-id="fb900-194">Teraz DinnersController jest "ściśle" do klasy DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="fb900-194">Right now DinnersController is tightly "coupled" to the DinnerRepository class.</span></span> <span data-ttu-id="fb900-195">"Sprzężenia" odwołuje się do sytuacji, w których klasa jawnie opiera się na innej klasy do działania:</span><span class="sxs-lookup"><span data-stu-id="fb900-195">"Coupling" refers to a situation where a class explicitly relies on another class in order to work:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample4.cs)]

<span data-ttu-id="fb900-196">Ponieważ klasa DinnerRepository wymaga dostępu do bazy danych, ściśle sprzężonych zależności DinnersController klasa ma na końcach DinnerRepository się konieczności byliśmy bazy danych w kolejności dla metody akcji DinnersController, który ma zostać przetestowana.</span><span class="sxs-lookup"><span data-stu-id="fb900-196">Because the DinnerRepository class requires access to a database, the tightly coupled dependency the DinnersController class has on the DinnerRepository ends up requiring us to have a database in order for the DinnersController action methods to be tested.</span></span>

<span data-ttu-id="fb900-197">Firma Microsoft można uzyskać wokół tego zatrudniająca wzorca projektowego o nazwie "wstrzykiwanie zależności" — czyli podejścia, gdzie (na przykład klasy repozytorium, które zapewniają dostęp do danych) nie jest już niejawnie tworzenia zależności w obrębie klasy, które z nich korzystają.</span><span class="sxs-lookup"><span data-stu-id="fb900-197">We can get around this by employing a design pattern called "dependency injection" – which is an approach where dependencies (like repository classes that provide data access) are no longer implicitly created within classes that use them.</span></span> <span data-ttu-id="fb900-198">Zamiast tego zależności mogą być jawnie przekazywane do klasy, która korzysta z nich przy użyciu argumentów konstruktora.</span><span class="sxs-lookup"><span data-stu-id="fb900-198">Instead, dependencies can be explicitly passed to the class that uses them using constructor arguments.</span></span> <span data-ttu-id="fb900-199">Jeśli zależności są zdefiniowane przy użyciu interfejsów, następnie mamy elastyczność, aby przekazać zależności "fałszywych" implementacje dla scenariuszy testowania jednostek.</span><span class="sxs-lookup"><span data-stu-id="fb900-199">If the dependencies are defined using interfaces, we then have the flexibility to pass in "fake" dependency implementations for unit test scenarios.</span></span> <span data-ttu-id="fb900-200">Pozwala to nam do utworzenia implementacji specyficznych dla testu zależności, które faktycznie nie wymagają dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fb900-200">This enables us to create test-specific dependency implementations that do not actually require access to a database.</span></span>

<span data-ttu-id="fb900-201">Aby to zobaczyć w działaniu, umożliwia Implementowanie wstrzykiwanie zależności za pomocą naszych DinnersController.</span><span class="sxs-lookup"><span data-stu-id="fb900-201">To see this in action, let's implement dependency injection with our DinnersController.</span></span>

#### <a name="extracting-an-idinnerrepository-interface"></a><span data-ttu-id="fb900-202">Wyodrębnianie interfejsu IDinnerRepository</span><span class="sxs-lookup"><span data-stu-id="fb900-202">Extracting an IDinnerRepository interface</span></span>

<span data-ttu-id="fb900-203">Naszym pierwszym krokiem będzie utworzenie nowego interfejsu IDinnerRepository, który hermetyzuje kontrakt repozytorium, który naszym kontrolery wymagają pobierania i aktualizowania kolacji.</span><span class="sxs-lookup"><span data-stu-id="fb900-203">Our first step will be to create a new IDinnerRepository interface that encapsulates the repository contract our controllers require to retrieve and update Dinners.</span></span>

<span data-ttu-id="fb900-204">Firma Microsoft można zdefiniować ten kontrakt interfejsu ręcznie, klikając prawym przyciskiem myszy w folderze \Models, a następnie wybierając **Add -&gt;nowy element** polecenia menu i tworzenie nowego interfejsu o nazwie IDinnerRepository.cs.</span><span class="sxs-lookup"><span data-stu-id="fb900-204">We can define this interface contract manually by right-clicking on the \Models folder, and then choosing the **Add-&gt;New Item** menu command and creating a new interface named IDinnerRepository.cs.</span></span>

<span data-ttu-id="fb900-205">Możemy również extract refaktoryzację narzędzia wbudowana w program Visual Studio Professional (i nowsze wersje) automatycznie używać i tworzenia interfejsu dla nas z naszej istniejącej klasy DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="fb900-205">Alternatively we can use the refactoring tools built-into Visual Studio Professional (and higher editions) to automatically extract and create an interface for us from our existing DinnerRepository class.</span></span> <span data-ttu-id="fb900-206">Aby wyodrębnić ten interfejs, za pomocą programu VS, po prostu umieść kursor w edytorze tekstów w klasie DinnerRepository, a następnie kliknij prawym przyciskiem myszy i wybierz **Zrefaktoryzuj -&gt;Wyodrębnij interfejs** polecenia menu:</span><span class="sxs-lookup"><span data-stu-id="fb900-206">To extract this interface using VS, simply position the cursor in the text editor on the DinnerRepository class, and then right-click and choose the **Refactor-&gt;Extract Interface** menu command:</span></span>

![](enable-automated-unit-testing/_static/image7.png)

<span data-ttu-id="fb900-207">To spowoduje uruchomienie okna dialogowego "Wyodrębnij interfejs" i Monituj nas o nazwa interfejsu, aby utworzyć.</span><span class="sxs-lookup"><span data-stu-id="fb900-207">This will launch the "Extract Interface" dialog and prompt us for the name of the interface to create.</span></span> <span data-ttu-id="fb900-208">Zostanie domyślnie IDinnerRepository i automatycznie wybiera wszystkich metod publicznych w istniejącej klasie DinnerRepository do dodania do interfejsu:</span><span class="sxs-lookup"><span data-stu-id="fb900-208">It will default to IDinnerRepository and automatically select all public methods on the existing DinnerRepository class to add to the interface:</span></span>

![](enable-automated-unit-testing/_static/image8.png)

<span data-ttu-id="fb900-209">Kliknięcie przycisku "ok", programu Visual Studio doda nowy interfejs IDinnerRepository do naszej aplikacji:</span><span class="sxs-lookup"><span data-stu-id="fb900-209">When we click the "ok" button, Visual Studio will add a new IDinnerRepository interface to our application:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample5.cs)]

<span data-ttu-id="fb900-210">I naszej istniejącej klasy DinnerRepository zostanie zaktualizowana tak, aby go implementuje interfejs:</span><span class="sxs-lookup"><span data-stu-id="fb900-210">And our existing DinnerRepository class will be updated so that it implements the interface:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample6.cs)]

#### <a name="updating-dinnerscontroller-to-support-constructor-injection"></a><span data-ttu-id="fb900-211">Aktualizowanie DinnersController w celu obsługi iniekcji konstruktora</span><span class="sxs-lookup"><span data-stu-id="fb900-211">Updating DinnersController to support constructor injection</span></span>

<span data-ttu-id="fb900-212">Teraz zaktualizujemy klasy DinnersController, aby korzystać z nowego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="fb900-212">We'll now update the DinnersController class to use the new interface.</span></span>

<span data-ttu-id="fb900-213">Obecnie DinnersController zostało zakodowane taki sposób, że jego pole "dinnerRepository" jest zawsze klasy DinnerRepository:</span><span class="sxs-lookup"><span data-stu-id="fb900-213">Currently DinnersController is hard-coded such that its "dinnerRepository" field is always a DinnerRepository class:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample7.cs)]

<span data-ttu-id="fb900-214">Zmienimy je, tak aby pole "dinnerRepository" jest typu IDinnerRepository zamiast DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="fb900-214">We'll change it so that the "dinnerRepository" field is of type IDinnerRepository instead of DinnerRepository.</span></span> <span data-ttu-id="fb900-215">Następnie dodamy dwa publiczne konstruktory DinnersController.</span><span class="sxs-lookup"><span data-stu-id="fb900-215">We'll then add two public DinnersController constructors.</span></span> <span data-ttu-id="fb900-216">Jednym z konstruktorów umożliwia IDinnerRepository został przekazany jako argument.</span><span class="sxs-lookup"><span data-stu-id="fb900-216">One of the constructors allows an IDinnerRepository to be passed as an argument.</span></span> <span data-ttu-id="fb900-217">Domyślny konstruktor używający naszej istniejącej implementacji DinnerRepository drugi to:</span><span class="sxs-lookup"><span data-stu-id="fb900-217">The other is a default constructor that uses our existing DinnerRepository implementation:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample8.cs)]

<span data-ttu-id="fb900-218">Ponieważ platformy ASP.NET MVC, domyślnie tworzy klasy kontrolera przy użyciu domyślnych konstruktorów, nasze DinnersController w czasie wykonywania będzie korzystanie z klasy DinnerRepository przeprowadzić dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="fb900-218">Because ASP.NET MVC by default creates controller classes using default constructors, our DinnersController at runtime will continue to use the DinnerRepository class to perform data access.</span></span>

<span data-ttu-id="fb900-219">Możemy teraz zaktualizować Nasze testy jednostkowe, jednak do przekazania w implementacji repozytorium obiad z "fałszywą" za pomocą konstruktora parametru.</span><span class="sxs-lookup"><span data-stu-id="fb900-219">We can now update our unit tests, though, to pass in a "fake" dinner repository implementation using the parameter constructor.</span></span> <span data-ttu-id="fb900-220">To repozytorium obiad z "fałszywą" nie będzie wymagać dostępu do rzeczywistego bazy danych, a zamiast tego użyje danych przykładowych w pamięci.</span><span class="sxs-lookup"><span data-stu-id="fb900-220">This "fake" dinner repository will not require access to a real database, and instead will use in-memory sample data.</span></span>

#### <a name="creating-the-fakedinnerrepository-class"></a><span data-ttu-id="fb900-221">Tworzenie klasy FakeDinnerRepository</span><span class="sxs-lookup"><span data-stu-id="fb900-221">Creating the FakeDinnerRepository class</span></span>

<span data-ttu-id="fb900-222">Utwórz klasę FakeDinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="fb900-222">Let's create a FakeDinnerRepository class.</span></span>

<span data-ttu-id="fb900-223">Firma Microsoft będzie Rozpocznij od utworzenia katalogu "Substytuty" w projekcie NerdDinner.Tests, a następnie dodaj nową klasę FakeDinnerRepository do niego (kliknij prawym przyciskiem myszy w folderze, a następnie wybierz **Add -&gt;nową klasę**):</span><span class="sxs-lookup"><span data-stu-id="fb900-223">We'll begin by creating a "Fakes" directory within our NerdDinner.Tests project and then add a new FakeDinnerRepository class to it (right-click on the folder and choose **Add-&gt;New Class**):</span></span>

![](enable-automated-unit-testing/_static/image9.png)

<span data-ttu-id="fb900-224">Tak, aby klasa FakeDinnerRepository implementuje interfejs IDinnerRepository kodu zostaną zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="fb900-224">We'll update the code so that the FakeDinnerRepository class implements the IDinnerRepository interface.</span></span> <span data-ttu-id="fb900-225">Firma Microsoft następnie kliknij prawym przyciskiem myszy na nim i wybierz polecenie "Implementuj interfejs IDinnerRepository" z menu kontekstowego:</span><span class="sxs-lookup"><span data-stu-id="fb900-225">We can then right-click on it and choose the "Implement interface IDinnerRepository" context menu command:</span></span>

![](enable-automated-unit-testing/_static/image10.png)

<span data-ttu-id="fb900-226">To spowoduje, że Visual Studio, aby automatycznie dodać wszyscy członkowie interfejsu IDinnerRepository klasy Nasze FakeDinnerRepository przy użyciu domyślnej implementacji "namiastki":</span><span class="sxs-lookup"><span data-stu-id="fb900-226">This will cause Visual Studio to automatically add all of the IDinnerRepository interface members to our FakeDinnerRepository class with default "stub out" implementations:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample9.cs)]

<span data-ttu-id="fb900-227">Firma Microsoft może uaktualnić wdrożenia FakeDinnerRepository pracę zniżki w stosunku do listy w pamięci&lt;obiad&gt; kolekcji przekazany jako argument konstruktora:</span><span class="sxs-lookup"><span data-stu-id="fb900-227">We can then update the FakeDinnerRepository implementation to work off of an in-memory List&lt;Dinner&gt; collection passed to it as a constructor argument:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample10.cs)]

<span data-ttu-id="fb900-228">W efekcie powstał fałszywych implementację IDinnerRepository, która nie wymaga bazy danych, a zamiast tego mogą pracować poza w pamięci listę obiektów obiad.</span><span class="sxs-lookup"><span data-stu-id="fb900-228">We now have a fake IDinnerRepository implementation that does not require a database, and can instead work off an in-memory list of Dinner objects.</span></span>

#### <a name="using-the-fakedinnerrepository-with-unit-tests"></a><span data-ttu-id="fb900-229">Za pomocą FakeDinnerRepository przy użyciu testów jednostkowych</span><span class="sxs-lookup"><span data-stu-id="fb900-229">Using the FakeDinnerRepository with Unit Tests</span></span>

<span data-ttu-id="fb900-230">Powrócimy do testów jednostkowych DinnersController, które nie powiodły się wcześniej, ponieważ baza danych nie była dostępna.</span><span class="sxs-lookup"><span data-stu-id="fb900-230">Let's return to the DinnersController unit tests that failed earlier because the database wasn't available.</span></span> <span data-ttu-id="fb900-231">Aktualizujemy metody testowe, aby użyć FakeDinnerRepository wypełniona przykładowymi danymi o obiad w pamięci do DinnersController przy użyciu poniższego kodu:</span><span class="sxs-lookup"><span data-stu-id="fb900-231">We can update the test methods to use a FakeDinnerRepository populated with sample in-memory Dinner data to the DinnersController using the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample11.cs)]

<span data-ttu-id="fb900-232">A teraz możemy uruchamiania tych testów zarówno przekazują:</span><span class="sxs-lookup"><span data-stu-id="fb900-232">And now when we run these tests they both pass:</span></span>

![](enable-automated-unit-testing/_static/image11.png)

<span data-ttu-id="fb900-233">Przede wszystkim mogą zająć jedynie ułamek sekund do uruchomienia i nie wymagają wszelka logika skomplikowane instalacji/czyszczenia.</span><span class="sxs-lookup"><span data-stu-id="fb900-233">Best of all, they take only a fraction of a second to run, and do not require any complicated setup/cleanup logic.</span></span> <span data-ttu-id="fb900-234">Możemy teraz testów jednostkowych wszystkich naszych DinnersController akcji kodu metody (takie jak listy, stronicowanie i uzyskać szczegółowe informacje, tworzenie, aktualizowanie i usuwanie) bez połączenia z prawdziwą bazą danych.</span><span class="sxs-lookup"><span data-stu-id="fb900-234">We can now unit test all of our DinnersController action method code (including listing, paging, details, create, update and delete) without ever needing to connect to a real database.</span></span>

| <span data-ttu-id="fb900-235">**Temat po stronie: Struktury wstrzykiwania zależności**</span><span class="sxs-lookup"><span data-stu-id="fb900-235">**Side Topic: Dependency Injection Frameworks**</span></span> |
| --- |
| <span data-ttu-id="fb900-236">Wykonywanie wstrzykiwanie zależności ręczne (np. Firma Microsoft znajdują się powyżej) działa poprawnie, ale stać się trudniejsze do utrzymania jako liczba zależności i zwiększa składników w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fb900-236">Performing manual dependency injection (like we are above) works fine, but does become harder to maintain as the number of dependencies and components in an application increases.</span></span> <span data-ttu-id="fb900-237">Istnieje kilka środowisk iniekcji zależności dla platformy .NET, która pomaga zapewnić jeszcze większą elastyczność zarządzania zależności.</span><span class="sxs-lookup"><span data-stu-id="fb900-237">Several dependency injection frameworks exist for .NET that can help provide even more dependency management flexibility.</span></span> <span data-ttu-id="fb900-238">Te struktury, czasami nazywane "Inwersja kontroli" (IoC) kontenerów, zapewniają mechanizmy, umożliwiających dodatkowy poziom obsługi konfiguracji dotyczące określania i przekazanie zależności do obiektów w czasie wykonywania (w większości przypadków przy użyciu iniekcji konstruktora ).</span><span class="sxs-lookup"><span data-stu-id="fb900-238">These frameworks, also sometimes called "Inversion of Control" (IoC) containers, provide mechanisms that enable an additional level of configuration support for specifying and passing dependencies to objects at runtime (most often using constructor injection).</span></span> <span data-ttu-id="fb900-239">Niektóre z najpopularniejszych wstrzykiwanie zależności OSS / include IOC platform na platformie .NET: AutoFac Ninject, Spring.NET, StructureMap i Windsor.</span><span class="sxs-lookup"><span data-stu-id="fb900-239">Some of the more popular OSS Dependency Injection / IOC frameworks in .NET include: AutoFac, Ninject, Spring.NET, StructureMap, and Windsor.</span></span> <span data-ttu-id="fb900-240">ASP.NET MVC udostępnia rozszerzalności interfejsów API, które deweloperzy mogą uczestniczyć w rozdzielczości i tworzenia wystąpień kontrolerów i umożliwiająca wstrzykiwanie zależności / platform IoC powinny zostać prawidłowo włączone w ramach tego procesu.</span><span class="sxs-lookup"><span data-stu-id="fb900-240">ASP.NET MVC exposes extensibility APIs that enable developers to participate in the resolution and instantiation of controllers, and which enables Dependency Injection / IoC frameworks to be cleanly integrated within this process.</span></span> <span data-ttu-id="fb900-241">Za pomocą platformy DI/IOC będzie również pozwalają nam można usunąć domyślnego konstruktora z naszych DinnersController — która całkowicie usunąć sprzężenia między nim a DinnerRepository.</span><span class="sxs-lookup"><span data-stu-id="fb900-241">Using a DI/IOC framework would also enable us to remove the default constructor from our DinnersController – which would completely remove the coupling between it and the DinnerRepository.</span></span> <span data-ttu-id="fb900-242">Firma Microsoft nie będzie można za pomocą iniekcji zależności / framework IOC z naszej aplikacji NerdDinner.</span><span class="sxs-lookup"><span data-stu-id="fb900-242">We won't be using a dependency injection / IOC framework with our NerdDinner application.</span></span> <span data-ttu-id="fb900-243">Ale to coś, które firma Microsoft może wziąć pod uwagę na przyszłość Jeśli zwiększył bazy kodu NerdDinner i możliwości.</span><span class="sxs-lookup"><span data-stu-id="fb900-243">But it is something we could consider for the future if the NerdDinner code-base and capabilities grew.</span></span> |

### <a name="creating-edit-action-unit-tests"></a><span data-ttu-id="fb900-244">Tworzenie testów jednostkowych akcji edycji</span><span class="sxs-lookup"><span data-stu-id="fb900-244">Creating Edit Action Unit Tests</span></span>

<span data-ttu-id="fb900-245">Utwórzmy teraz niektóre testy jednostkowe, które sprawdzają funkcje edycji DinnersController.</span><span class="sxs-lookup"><span data-stu-id="fb900-245">Let's now create some unit tests that verify the Edit functionality of the DinnersController.</span></span> <span data-ttu-id="fb900-246">Zaczniemy od testowania wersji HTTP GET naszej akcji edycji:</span><span class="sxs-lookup"><span data-stu-id="fb900-246">We'll start by testing the HTTP-GET version of our Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample12.cs)]

<span data-ttu-id="fb900-247">Utworzymy test, który sprawdza renderowania widoku, wspierane przez obiekt DinnerFormViewModel ponownie w przypadku, gdy wymagane jest prawidłowe obiad:</span><span class="sxs-lookup"><span data-stu-id="fb900-247">We'll create a test that verifies that a View backed by a DinnerFormViewModel object is rendered back when a valid dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample13.cs)]

<span data-ttu-id="fb900-248">Uruchomienie testu, jednak firma Microsoft znajdują się to niemożliwe, ponieważ wyjątek odwołania o wartości null jest zgłaszany, gdy właściwość User.Identity.Name sprawdzania Dinner.IsHostedBy() uzyskuje dostęp do funkcji edycji.</span><span class="sxs-lookup"><span data-stu-id="fb900-248">When we run the test, though, we'll find that it fails because a null reference exception is thrown when the Edit method accesses the User.Identity.Name property to perform the Dinner.IsHostedBy() check.</span></span>

<span data-ttu-id="fb900-249">Obiekt użytkownika w klasie bazowej kontrolera hermetyzuje szczegóły dotyczące zalogowanego użytkownika i jest wypełniana przez platformę ASP.NET MVC, podczas tworzenia kontrolera w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="fb900-249">The User object on the Controller base class encapsulates details about the logged-in user, and is populated by ASP.NET MVC when it creates the controller at runtime.</span></span> <span data-ttu-id="fb900-250">Ponieważ testujemy DinnersController poza środowiskiem serwera sieci web, obiekt użytkownika nie jest ustawiony (dlatego wyjątek pustej referencji).</span><span class="sxs-lookup"><span data-stu-id="fb900-250">Because we are testing the DinnersController outside of a web-server environment, the User object isn't set (hence the null reference exception).</span></span>

### <a name="mocking-the-useridentityname-property"></a><span data-ttu-id="fb900-251">Pozorowanie właściwość User.Identity.Name</span><span class="sxs-lookup"><span data-stu-id="fb900-251">Mocking the User.Identity.Name property</span></span>

<span data-ttu-id="fb900-252">Struktury pozorowania ułatwić, testowanie, dzięki czemu możemy umożliwia dynamiczne tworzenie fałszywych wersje obiektów zależnych, które obsługują Nasze testy.</span><span class="sxs-lookup"><span data-stu-id="fb900-252">Mocking frameworks make testing easier by enabling us to dynamically create fake versions of dependent objects that support our tests.</span></span> <span data-ttu-id="fb900-253">Na przykład możemy użyć pozorowania framework w naszym teście akcji edycji umożliwia dynamiczne tworzenie obiektu użytkownika, używanego przez naszych DinnersController do wyszukiwania symulowane nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fb900-253">For example, we can use a mocking framework in our Edit action test to dynamically create a User object that our DinnersController can use to lookup a simulated username.</span></span> <span data-ttu-id="fb900-254">Zapobiegnie to odwołanie o wartości null z zgłaszane, gdy Uruchamiamy nasze badania.</span><span class="sxs-lookup"><span data-stu-id="fb900-254">This will avoid a null reference from being thrown when we run our test.</span></span>

<span data-ttu-id="fb900-255">Istnieje wiele .NET pozorowanie struktur, które mogą być używane z platformy ASP.NET MVC (zobaczysz listę je tutaj: [ http://www.mockframeworks.com/ ](http://www.mockframeworks.com/)).</span><span class="sxs-lookup"><span data-stu-id="fb900-255">There are many .NET mocking frameworks that can be used with ASP.NET MVC (you can see a list of them here: [http://www.mockframeworks.com/](http://www.mockframeworks.com/)).</span></span> <span data-ttu-id="fb900-256">Na potrzeby testowania naszych aplikacji NerdDinner, użyjemy pozorowanie o nazwie "Moq" open source, który można pobrać bezpłatnie z [ http://www.mockframeworks.com/moq ](http://www.mockframeworks.com/moq).</span><span class="sxs-lookup"><span data-stu-id="fb900-256">For testing our NerdDinner application we'll use an open source mocking framework called "Moq", which can be downloaded for free from [http://www.mockframeworks.com/moq](http://www.mockframeworks.com/moq).</span></span>

<span data-ttu-id="fb900-257">Po pobraniu, dodamy odwołanie w projekcie NerdDinner.Tests do zestawu Moq.dll:</span><span class="sxs-lookup"><span data-stu-id="fb900-257">Once downloaded, we'll add a reference in our NerdDinner.Tests project to the Moq.dll assembly:</span></span>

![](enable-automated-unit-testing/_static/image12.png)

<span data-ttu-id="fb900-258">Następnie dodamy metody pomocnika "CreateDinnersControllerAs(username)" nasze klasy testowej, który przyjmuje nazwę użytkownika jako parametr i które, a następnie "mocks" Właściwość User.Identity.Name wystąpieniu DinnersController:</span><span class="sxs-lookup"><span data-stu-id="fb900-258">We'll then add a "CreateDinnersControllerAs(username)" helper method to our test class that takes a username as a parameter, and which then "mocks" the User.Identity.Name property on the DinnersController instance:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample14.cs)]

<span data-ttu-id="fb900-259">Powyżej użyto Moq można utworzyć obiektu projekt, który elementów sztucznych obiekt kontekstem ControllerContext (czyli platformy ASP.NET MVC przekazuje do klas kontrolera do udostępnienia środowiska uruchomieniowego obiektów, takich jak użytkownik, żądania, odpowiedzi i sesji).</span><span class="sxs-lookup"><span data-stu-id="fb900-259">Above we are using Moq to create a Mock object that fakes a ControllerContext object (which is what ASP.NET MVC passes to Controller classes to expose runtime objects like User, Request, Response, and Session).</span></span> <span data-ttu-id="fb900-260">Wywołania metody "SetupGet" na projekt, aby wskazać, że właściwość HttpContext.User.Identity.Name kontekstem ControllerContext powinna zwrócić ciąg nazwy użytkownika, który możemy przekazać do metody pomocnika.</span><span class="sxs-lookup"><span data-stu-id="fb900-260">We are calling the "SetupGet" method on the Mock to indicate that the HttpContext.User.Identity.Name property on ControllerContext should return the username string we passed to the helper method.</span></span>

<span data-ttu-id="fb900-261">Firma Microsoft jest testowanie dowolną liczbę kontekstem ControllerContext właściwości i metody.</span><span class="sxs-lookup"><span data-stu-id="fb900-261">We can mock any number of ControllerContext properties and methods.</span></span> <span data-ttu-id="fb900-262">Aby zilustrować to ja dodałem również wywołanie SetupGet() dla właściwości Request.IsAuthenticated (który nie jest faktycznie potrzebny do testów poniżej — ale pozwalającemu pokazują, jak można testowanie właściwości żądania).</span><span class="sxs-lookup"><span data-stu-id="fb900-262">To illustrate this I've also added a SetupGet() call for the Request.IsAuthenticated property (which isn't actually needed for the tests below – but which helps illustrate how you can mock Request properties).</span></span> <span data-ttu-id="fb900-263">Gdy gotowe możemy przypisać wystąpienie pozorny kontekstem ControllerContext DinnersController zwraca naszych metody pomocnika.</span><span class="sxs-lookup"><span data-stu-id="fb900-263">When we are done we assign an instance of the ControllerContext mock to the DinnersController our helper method returns.</span></span>

<span data-ttu-id="fb900-264">Firma Microsoft jest teraz pisanie testów jednostkowych, korzystających z tej metody pomocnika do testowania scenariuszy edycji obejmujące różnych użytkowników:</span><span class="sxs-lookup"><span data-stu-id="fb900-264">We can now write unit tests that use this helper method to test Edit scenarios involving different users:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample15.cs)]

<span data-ttu-id="fb900-265">A teraz możemy uruchamiania testów przekazują:</span><span class="sxs-lookup"><span data-stu-id="fb900-265">And now when we run the tests they pass:</span></span>

![](enable-automated-unit-testing/_static/image13.png)

### <a name="testing-updatemodel-scenarios"></a><span data-ttu-id="fb900-266">UpdateModel() scenariuszy testowania</span><span class="sxs-lookup"><span data-stu-id="fb900-266">Testing UpdateModel() scenarios</span></span>

<span data-ttu-id="fb900-267">Utworzyliśmy testy, które obejmują HTTP GET wersję akcji edycji.</span><span class="sxs-lookup"><span data-stu-id="fb900-267">We've created tests that cover the HTTP-GET version of the Edit action.</span></span> <span data-ttu-id="fb900-268">Utwórzmy teraz niektóre testy weryfikujące wersji żądania HTTP POST akcji edycji:</span><span class="sxs-lookup"><span data-stu-id="fb900-268">Let's now create some tests that verify the HTTP-POST version of the Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample16.cs)]

<span data-ttu-id="fb900-269">Interesujące nowy scenariusz testowania w firmie Microsoft w celu obsługi przy użyciu tej metody akcji jest jej użycie metody pomocnika UpdateModel() w klasie bazowej kontrolera.</span><span class="sxs-lookup"><span data-stu-id="fb900-269">The interesting new testing scenario for us to support with this action method is its usage of the UpdateModel() helper method on the Controller base class.</span></span> <span data-ttu-id="fb900-270">Używamy tej metody pomocnika do powiązania wartości post formularza do naszych obiad wystąpienia obiektu.</span><span class="sxs-lookup"><span data-stu-id="fb900-270">We are using this helper method to bind form-post values to our Dinner object instance.</span></span>

<span data-ttu-id="fb900-271">Poniżej przedstawiono dwa testy, które pokazuje, jak firma Microsoft mogła dostarczyć opublikowane wartości metodę pomocnika używaną UpdateModel() do formularza.</span><span class="sxs-lookup"><span data-stu-id="fb900-271">Below are two tests that demonstrates how we can supply form posted values for the UpdateModel() helper method to use.</span></span> <span data-ttu-id="fb900-272">Firma Microsoft będzie to zrobić, tworzenie i wypełnianie obiektu FormCollection, a następnie przypisać ją do właściwości "ValueProvider" na kontrolerze.</span><span class="sxs-lookup"><span data-stu-id="fb900-272">We'll do this by creating and populating a FormCollection object, and then assign it to the "ValueProvider" property on the Controller.</span></span>

<span data-ttu-id="fb900-273">Pierwszy test sprawdza, czy na pomyślne Zapisz przeglądarka jest przekierowywana do akcji details.</span><span class="sxs-lookup"><span data-stu-id="fb900-273">The first test verifies that on a successful save the browser is redirected to the details action.</span></span> <span data-ttu-id="fb900-274">Drugi test sprawdza, czy po opublikowaniu nieprawidłowe dane wejściowe akcji zostanie ponownie widoku edycji, ponownie komunikatu o błędzie.</span><span class="sxs-lookup"><span data-stu-id="fb900-274">The second test verifies that when invalid input is posted the action redisplays the edit view again with an error message.</span></span>


[!code-csharp[Main](enable-automated-unit-testing/samples/sample17.cs)]

### <a name="testing-wrap-up"></a><span data-ttu-id="fb900-275">Testowanie Wrap-Up</span><span class="sxs-lookup"><span data-stu-id="fb900-275">Testing Wrap-Up</span></span>

<span data-ttu-id="fb900-276">Omówiliśmy podstawowe pojęcia związane z klas kontrolera testów jednostek.</span><span class="sxs-lookup"><span data-stu-id="fb900-276">We've covered the core concepts involved in unit testing controller classes.</span></span> <span data-ttu-id="fb900-277">Z łatwością tworzyć setki proste testy weryfikujące działanie naszej aplikacji możemy użyć tych metod.</span><span class="sxs-lookup"><span data-stu-id="fb900-277">We can use these techniques to easily create hundreds of simple tests that verify the behavior of our application.</span></span>

<span data-ttu-id="fb900-278">Ponieważ naszych kontrolera i testy modelu nie wymagają rzeczywista baza danych, są one bardzo szybkie i łatwe do uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="fb900-278">Because our controller and model tests do not require a real database, they are extremely fast and easy to run.</span></span> <span data-ttu-id="fb900-279">Firma Microsoft będzie można wykonać setki zautomatyzowanych testów w ciągu kilku sekund i natychmiast uzyskuj opinie dotyczące tego, czy zmiany, jakie wprowadziliśmy Przerwano coś.</span><span class="sxs-lookup"><span data-stu-id="fb900-279">We'll be able to execute hundreds of automated tests in seconds, and immediately get feedback as to whether a change we made broke something.</span></span> <span data-ttu-id="fb900-280">Ułatwi to przekazać nam zaufanie, stale poprawić, Refaktoryzacja, i dostosowywać naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fb900-280">This will help provide us the confidence to continually improve, refactor, and refine our application.</span></span>

<span data-ttu-id="fb900-281">Omówiono testowanie jako ostatni temat w tym rozdziale —, ale nie, ponieważ testowanie jest coś, co należy zrobić, na końcu procesu opracowywania!</span><span class="sxs-lookup"><span data-stu-id="fb900-281">We covered testing as the last topic in this chapter – but not because testing is something you should do at the end of a development process!</span></span> <span data-ttu-id="fb900-282">Przeciwnie należy wpisać zautomatyzowane testy możliwie najwcześniejszym etapie procesu rozwoju.</span><span class="sxs-lookup"><span data-stu-id="fb900-282">On the contrary, you should write automated tests as early as possible in your development process.</span></span> <span data-ttu-id="fb900-283">Takie działanie umożliwia więc natychmiast otrzymać opinię podczas opracowywania, pomaga odnoszącej zastanów się, scenariuszy przypadków użycia aplikacji i przeprowadzi Cię do projektowania aplikacji przy użyciu czystego, Układanie warstwowo i sprzęgania na uwadze.</span><span class="sxs-lookup"><span data-stu-id="fb900-283">Doing so enables you to get immediate feedback as you develop, helps you think thoughtfully about your application's use case scenarios, and guides you to design your application with clean layering and coupling in mind.</span></span>

<span data-ttu-id="fb900-284">Nowsze rozdziału w książce przedstawimy testów opartych na rozwój (TDD) i jak z niej korzystać ze wzorca ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="fb900-284">A later chapter in the book will discuss Test Driven Development (TDD), and how to use it with ASP.NET MVC.</span></span> <span data-ttu-id="fb900-285">Projektowanie oparte na testach jest iteracyjne kodowania najpierw pisze się testy, które będzie spełniać wynikowy kod.</span><span class="sxs-lookup"><span data-stu-id="fb900-285">TDD is an iterative coding practice where you first write the tests that your resulting code will satisfy.</span></span> <span data-ttu-id="fb900-286">Za pomocą TDD rozpoczęciem każdej funkcji, tworząc test, który weryfikuje funkcjonalność, którą chcesz wdrożyć.</span><span class="sxs-lookup"><span data-stu-id="fb900-286">With TDD you begin each feature by creating a test that verifies the functionality you are about to implement.</span></span> <span data-ttu-id="fb900-287">Zapisywanie jednostki testu najpierw pomaga upewnić się, że wyraźnie rozumiesz funkcja i jak powinien pracować.</span><span class="sxs-lookup"><span data-stu-id="fb900-287">Writing the unit test first helps ensure that you clearly understand the feature and how it is supposed to work.</span></span> <span data-ttu-id="fb900-288">Tylko wtedy, gdy test jest zapisywany (i upewnieniu się, że nie jest on) czy, a następnie zaimplementować rzeczywiste funkcje, które ten test sprawdza.</span><span class="sxs-lookup"><span data-stu-id="fb900-288">Only after the test is written (and you have verified that it fails) do you then implement the actual functionality the test verifies.</span></span> <span data-ttu-id="fb900-289">Ponieważ został już spędzony czas zastanawiać się, jak funkcja powinien działać przypadek użycia, trzeba będzie lepiej zrozumieć wymagania i jest to najlepszy sposób ich implementacji.</span><span class="sxs-lookup"><span data-stu-id="fb900-289">Because you've already spent time thinking about the use case of how the feature is supposed to work, you will have a better understanding of the requirements and how best to implement them.</span></span> <span data-ttu-id="fb900-290">Po zakończeniu wdrożenia można ponownie uruchomić test — i natychmiast otrzymać opinię w do tego, czy funkcja działa prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="fb900-290">When you are done with the implementation you can re-run the test – and get immediate feedback as to whether the feature works correctly.</span></span> <span data-ttu-id="fb900-291">Omówimy TDD więcej w rozdziale 10.</span><span class="sxs-lookup"><span data-stu-id="fb900-291">We'll cover TDD more in Chapter 10.</span></span>

### <a name="next-step"></a><span data-ttu-id="fb900-292">Następny krok</span><span class="sxs-lookup"><span data-stu-id="fb900-292">Next Step</span></span>

<span data-ttu-id="fb900-293">Niektóre końcowego zawijania komentarze.</span><span class="sxs-lookup"><span data-stu-id="fb900-293">Some final wrap up comments.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fb900-294">[Poprzednie](use-ajax-to-implement-mapping-scenarios.md)
> [dalej](nerddinner-wrap-up.md)</span><span class="sxs-lookup"><span data-stu-id="fb900-294">[Previous](use-ajax-to-implement-mapping-scenarios.md)
[Next](nerddinner-wrap-up.md)</span></span>
