---
uid: mvc/overview/older-versions-1/unit-testing/creating-unit-tests-for-asp-net-mvc-applications-cs
title: Tworzenie testów jednostkowych dla aplikacji ASP.NET MVCC#() | Microsoft Docs
author: StephenWalther
description: Dowiedz się, jak tworzyć testy jednostkowe dla akcji kontrolera. W tym samouczku Stephen Walther demonstruje, w jaki sposób sprawdzić, czy akcja kontrolera zwraca element Parti...
ms.author: riande
ms.date: 08/19/2008
ms.assetid: d3a270b9-d7b1-47f2-8775-fc3beb518b5c
msc.legacyurl: /mvc/overview/older-versions-1/unit-testing/creating-unit-tests-for-asp-net-mvc-applications-cs
msc.type: authoredcontent
ms.openlocfilehash: 35fd0d85c63e5bd196394ce11b851c822a6405d9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78623943"
---
# <a name="creating-unit-tests-for-aspnet-mvc-applications-c"></a><span data-ttu-id="b1177-104">Tworzenie testów jednostkowych dla aplikacji ASP.NET MVC (C#)</span><span class="sxs-lookup"><span data-stu-id="b1177-104">Creating Unit Tests for ASP.NET MVC Applications (C#)</span></span>

<span data-ttu-id="b1177-105">Autor [Stephen Walther](https://github.com/StephenWalther)</span><span class="sxs-lookup"><span data-stu-id="b1177-105">by [Stephen Walther](https://github.com/StephenWalther)</span></span>

[<span data-ttu-id="b1177-106">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="b1177-106">Download PDF</span></span>](https://download.microsoft.com/download/8/4/8/84843d8d-1575-426c-bcb5-9d0c42e51416/ASPNET_MVC_Tutorial_07_CS.pdf)

> <span data-ttu-id="b1177-107">Dowiedz się, jak tworzyć testy jednostkowe dla akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-107">Learn how to create unit tests for controller actions.</span></span> <span data-ttu-id="b1177-108">W tym samouczku Stephen Walther demonstruje, jak sprawdzić, czy akcja kontrolera zwraca określony widok, zwraca określony zestaw danych lub zwraca inny typ wyniku działania.</span><span class="sxs-lookup"><span data-stu-id="b1177-108">In this tutorial, Stephen Walther demonstrates how to test whether a controller action returns a particular view, returns a particular set of data, or returns a different type of action result.</span></span>

<span data-ttu-id="b1177-109">Celem tego samouczka jest przedstawienie, jak można napisać testy jednostkowe dla kontrolerów w aplikacjach ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="b1177-109">The goal of this tutorial is to demonstrate how you can write unit tests for the controllers in your ASP.NET MVC applications.</span></span> <span data-ttu-id="b1177-110">Omawiamy, jak utworzyć trzy różne typy testów jednostkowych.</span><span class="sxs-lookup"><span data-stu-id="b1177-110">We discuss how to build three different types of unit tests.</span></span> <span data-ttu-id="b1177-111">Dowiesz się, jak przetestować widok zwracany przez akcję kontrolera, jak przetestować dane widoku zwrócone przez akcję kontrolera i jak sprawdzić, czy jedna akcja kontrolera przekierowuje użytkownika do drugiej akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-111">You learn how to test the view returned by a controller action, how to test the View Data returned by a controller action, and how to test whether or not one controller action redirects you to a second controller action.</span></span>

## <a name="creating-the-controller-under-test"></a><span data-ttu-id="b1177-112">Tworzenie testowanego kontrolera</span><span class="sxs-lookup"><span data-stu-id="b1177-112">Creating the Controller under Test</span></span>

<span data-ttu-id="b1177-113">Zacznijmy od utworzenia kontrolera, który ma zostać przetestowany.</span><span class="sxs-lookup"><span data-stu-id="b1177-113">Let's start by creating the controller that we intend to test.</span></span> <span data-ttu-id="b1177-114">Kontroler o nazwie `ProductController`znajduje się na liście 1.</span><span class="sxs-lookup"><span data-stu-id="b1177-114">The controller, named the `ProductController`, is contained in Listing 1.</span></span>

<span data-ttu-id="b1177-115">**Lista 1 — `ProductController.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-115">**Listing 1 – `ProductController.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample1.cs)]

<span data-ttu-id="b1177-116">`ProductController` zawiera dwie metody akcji o nazwach `Index()` i `Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-116">The `ProductController` contains two action methods named `Index()` and `Details()`.</span></span> <span data-ttu-id="b1177-117">Obie metody akcji zwracają widok.</span><span class="sxs-lookup"><span data-stu-id="b1177-117">Both action methods return a view.</span></span> <span data-ttu-id="b1177-118">Zwróć uwagę, że akcja `Details()` akceptuje parametr o nazwie ID.</span><span class="sxs-lookup"><span data-stu-id="b1177-118">Notice that the `Details()` action accepts a parameter named Id.</span></span>

## <a name="testing-the-view-returned-by-a-controller"></a><span data-ttu-id="b1177-119">Testowanie widoku zwróconego przez kontroler</span><span class="sxs-lookup"><span data-stu-id="b1177-119">Testing the View returned by a Controller</span></span>

<span data-ttu-id="b1177-120">Załóżmy, że chcemy sprawdzić, czy `ProductController` zwraca odpowiedni widok.</span><span class="sxs-lookup"><span data-stu-id="b1177-120">Imagine that we want to test whether or not the `ProductController` returns the right view.</span></span> <span data-ttu-id="b1177-121">Chcemy upewnić się, że po wywołaniu akcji `ProductController.Details()` zostanie zwrócony widok szczegółów.</span><span class="sxs-lookup"><span data-stu-id="b1177-121">We want to make sure that when the `ProductController.Details()` action is invoked, the Details view is returned.</span></span> <span data-ttu-id="b1177-122">Klasa testowa na liście 2 zawiera test jednostkowy do testowania widoku zwróconego przez akcję `ProductController.Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-122">The test class in Listing 2 contains a unit test for testing the view returned by the `ProductController.Details()` action.</span></span>

<span data-ttu-id="b1177-123">**Lista 2 — `ProductControllerTest.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-123">**Listing 2 – `ProductControllerTest.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample2.cs)]

<span data-ttu-id="b1177-124">Klasa na liście 2 zawiera metodę testową o nazwie `TestDetailsView()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-124">The class in Listing 2 includes a test method named `TestDetailsView()`.</span></span> <span data-ttu-id="b1177-125">Ta metoda zawiera trzy wiersze kodu.</span><span class="sxs-lookup"><span data-stu-id="b1177-125">This method contains three lines of code.</span></span> <span data-ttu-id="b1177-126">Pierwszy wiersz kodu tworzy nowe wystąpienie klasy `ProductController`.</span><span class="sxs-lookup"><span data-stu-id="b1177-126">The first line of code creates a new instance of the `ProductController` class.</span></span> <span data-ttu-id="b1177-127">Drugi wiersz kodu wywołuje metodę akcji `Details()` kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-127">The second line of code invokes the controller's `Details()` action method.</span></span> <span data-ttu-id="b1177-128">Na koniec ostatni wiersz kodu sprawdza, czy widok zwrócony przez akcję `Details()` jest widokiem szczegółowym.</span><span class="sxs-lookup"><span data-stu-id="b1177-128">Finally, the last line of code checks whether or not the view returned by the `Details()` action is the Details view.</span></span>

<span data-ttu-id="b1177-129">Właściwość `ViewResult.ViewName` reprezentuje nazwę widoku zwróconego przez kontroler.</span><span class="sxs-lookup"><span data-stu-id="b1177-129">The `ViewResult.ViewName` property represents the name of the view returned by a controller.</span></span> <span data-ttu-id="b1177-130">Jedno duże ostrzeżenie dotyczące testowania tej właściwości.</span><span class="sxs-lookup"><span data-stu-id="b1177-130">One big warning about testing this property.</span></span> <span data-ttu-id="b1177-131">Istnieją dwa sposoby, aby kontroler mógł zwrócić widok.</span><span class="sxs-lookup"><span data-stu-id="b1177-131">There are two ways that a controller can return a view.</span></span> <span data-ttu-id="b1177-132">Kontroler może jawnie zwrócić widok podobny do tego:</span><span class="sxs-lookup"><span data-stu-id="b1177-132">A controller can explicitly return a view like this:</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample3.cs)]

<span data-ttu-id="b1177-133">Alternatywnie można wywnioskować nazwę widoku na podstawie nazwy akcji kontrolera podobnej do:</span><span class="sxs-lookup"><span data-stu-id="b1177-133">Alternatively, the name of the view can be inferred from the name of the controller action like this:</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample4.cs)]

<span data-ttu-id="b1177-134">Ta akcja kontrolera zwraca również widok o nazwie `Details`.</span><span class="sxs-lookup"><span data-stu-id="b1177-134">This controller action also returns a view named `Details`.</span></span> <span data-ttu-id="b1177-135">Jednak nazwa widoku jest wywnioskowana na podstawie nazwy akcji.</span><span class="sxs-lookup"><span data-stu-id="b1177-135">However, the name of the view is inferred from the action name.</span></span> <span data-ttu-id="b1177-136">Jeśli chcesz przetestować nazwę widoku, należy jawnie zwrócić nazwę widoku z akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-136">If you want to test the view name, then you must explicitly return the view name from the controller action.</span></span>

<span data-ttu-id="b1177-137">Test jednostkowy można uruchomić na liście 2, wprowadzając kombinację **klawiszy Ctrl-R, A** lub klikając przycisk **Uruchom wszystkie testy w rozwiązaniu** (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="b1177-137">You can run the unit test in Listing 2 by either entering the keyboard combination **Ctrl-R, A** or by clicking the **Run All Tests in Solution** button (see Figure 1).</span></span> <span data-ttu-id="b1177-138">Jeśli test zakończy się powodzeniem, zobaczysz okno Wyniki testów na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="b1177-138">If the test passes, you'll see the Test Results window in Figure 2.</span></span>

<span data-ttu-id="b1177-139">[![uruchomić wszystkie testy w rozwiązaniu](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image2.png)](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b1177-139">[![Run All Tests in Solution](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image2.png)](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image1.png)</span></span>

<span data-ttu-id="b1177-140">**Ilustracja 01**. uruchamianie wszystkich testów w rozwiązaniu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b1177-140">**Figure 01**: Run All Tests in Solution ([Click to view full-size image](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image3.png))</span></span>

<span data-ttu-id="b1177-141">[![powodzenie!](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image5.png)](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b1177-141">[![Success!](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image5.png)](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image4.png)</span></span>

<span data-ttu-id="b1177-142">**Ilustracja 02**: sukces!</span><span class="sxs-lookup"><span data-stu-id="b1177-142">**Figure 02**: Success!</span></span> <span data-ttu-id="b1177-143">([Kliknij, aby wyświetlić obraz o pełnym rozmiarze](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b1177-143">([Click to view full-size image](creating-unit-tests-for-asp-net-mvc-applications-cs/_static/image6.png))</span></span>

## <a name="testing-the-view-data-returned-by-a-controller"></a><span data-ttu-id="b1177-144">Testowanie danych widoku zwróconych przez kontroler</span><span class="sxs-lookup"><span data-stu-id="b1177-144">Testing the View Data returned by a Controller</span></span>

<span data-ttu-id="b1177-145">Kontroler MVC przekazuje dane do widoku przy użyciu czegoś o nazwie *`View Data`* .</span><span class="sxs-lookup"><span data-stu-id="b1177-145">An MVC controller passes data to a view by using something called *`View Data`*.</span></span> <span data-ttu-id="b1177-146">Załóżmy na przykład, że chcesz wyświetlić szczegóły dotyczące określonego produktu po wywołaniu akcji `ProductController Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-146">For example, imagine that you want to display the details for a particular product when you invoke the `ProductController Details()` action.</span></span> <span data-ttu-id="b1177-147">W takim przypadku można utworzyć wystąpienie klasy `Product` (zdefiniowane w modelu) i przekazać wystąpienie do widoku `Details`, wykorzystując zalety `View Data`.</span><span class="sxs-lookup"><span data-stu-id="b1177-147">In that case, you can create an instance of a `Product` class (defined in your model) and pass the instance to the `Details` view by taking advantage of `View Data`.</span></span>

<span data-ttu-id="b1177-148">Zmodyfikowane `ProductController` na liście 3 zawiera zaktualizowaną akcję `Details()`, która zwraca produkt.</span><span class="sxs-lookup"><span data-stu-id="b1177-148">The modified `ProductController` in Listing 3 includes an updated `Details()` action that returns a Product.</span></span>

<span data-ttu-id="b1177-149">**Lista 3 — `ProductController.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-149">**Listing 3 – `ProductController.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample5.cs)]

<span data-ttu-id="b1177-150">Najpierw akcja `Details()` tworzy nowe wystąpienie klasy `Product`, która reprezentuje komputer przenośny.</span><span class="sxs-lookup"><span data-stu-id="b1177-150">First, the `Details()` action creates a new instance of the `Product` class that represents a laptop computer.</span></span> <span data-ttu-id="b1177-151">Następnie wystąpienie klasy `Product` jest przesyłane jako drugi parametr do metody `View()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-151">Next, the instance of the `Product` class is passed as the second parameter to the `View()` method.</span></span>

<span data-ttu-id="b1177-152">Można napisać testy jednostkowe, aby sprawdzić, czy oczekiwane dane są zawarte w danych widoku.</span><span class="sxs-lookup"><span data-stu-id="b1177-152">You can write unit tests to test whether the expected data is contained in view data.</span></span> <span data-ttu-id="b1177-153">Test jednostkowy na liście 4 testuje, czy produkt reprezentujący komputer przenośny jest zwracany po wywołaniu metody akcji `ProductController Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-153">The unit test in Listing 4 tests whether or not a Product representing a laptop computer is returned when you call the `ProductController Details()` action method.</span></span>

<span data-ttu-id="b1177-154">**Lista 4 — `ProductControllerTest.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-154">**Listing 4 – `ProductControllerTest.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample6.cs)]

<span data-ttu-id="b1177-155">W przypadku listy 4 Metoda `TestDetailsView()` testuje dane widoku zwrócone przez wywołanie metody `Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-155">In Listing 4, the `TestDetailsView()` method tests the View Data returned by invoking the `Details()` method.</span></span> <span data-ttu-id="b1177-156">`ViewData` jest uwidoczniona jako właściwość na `ViewResult` zwrócone przez wywołanie metody `Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-156">The `ViewData` is exposed as a property on the `ViewResult` returned by invoking the `Details()` method.</span></span> <span data-ttu-id="b1177-157">Właściwość `ViewData.Model` zawiera produkt przesłany do widoku.</span><span class="sxs-lookup"><span data-stu-id="b1177-157">The `ViewData.Model` property contains the product passed to the view.</span></span> <span data-ttu-id="b1177-158">Test po prostu weryfikuje, czy produkt zawarty w danych widoku ma nazwę laptop.</span><span class="sxs-lookup"><span data-stu-id="b1177-158">The test simply verifies that the product contained in the View Data has the name Laptop.</span></span>

## <a name="testing-the-action-result-returned-by-a-controller"></a><span data-ttu-id="b1177-159">Testowanie wyniku działania zwróconego przez kontroler</span><span class="sxs-lookup"><span data-stu-id="b1177-159">Testing the Action Result returned by a Controller</span></span>

<span data-ttu-id="b1177-160">Bardziej złożona akcja kontrolera może zwracać różne typy wyników akcji w zależności od wartości parametrów przesyłanych do akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-160">A more complex controller action might return different types of action results depending on the values of the parameters passed to the controller action.</span></span> <span data-ttu-id="b1177-161">Akcja kontrolera może zwracać różne typy wyników akcji, w tym `ViewResult`, `RedirectToRouteResult`lub `JsonResult`.</span><span class="sxs-lookup"><span data-stu-id="b1177-161">A controller action can return a variety of types of action results including a `ViewResult`, `RedirectToRouteResult`, or `JsonResult`.</span></span>

<span data-ttu-id="b1177-162">Na przykład zmodyfikowana akcja `Details()` na liście 5 zwraca widok `Details`, gdy do akcji zostanie przekazany prawidłowy identyfikator produktu.</span><span class="sxs-lookup"><span data-stu-id="b1177-162">For example, the modified `Details()` action in Listing 5 returns the `Details` view when you pass a valid product Id to the action.</span></span> <span data-ttu-id="b1177-163">Jeśli przekażesz nieprawidłowy identyfikator produktu — identyfikator o wartości mniejszej niż 1, nastąpi przekierowanie do akcji `Index()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-163">If you pass an invalid product Id -- an Id with a value less than 1 -- then you are redirected to the `Index()` action.</span></span>

<span data-ttu-id="b1177-164">**Lista 5 — `ProductController.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-164">**Listing 5 – `ProductController.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample7.cs)]

<span data-ttu-id="b1177-165">Możesz przetestować zachowanie akcji `Details()` z testem jednostkowym na liście 6.</span><span class="sxs-lookup"><span data-stu-id="b1177-165">You can test the behavior of the `Details()` action with the unit test in Listing 6.</span></span> <span data-ttu-id="b1177-166">Test jednostkowy na liście 6 sprawdza, czy nastąpiło przekierowanie do widoku `Index`, gdy identyfikator o wartości-1 jest przesyłany do metody `Details()`.</span><span class="sxs-lookup"><span data-stu-id="b1177-166">The unit test in Listing 6 verifies that you are redirected to the `Index` view when an Id with the value -1 is passed to the `Details()` method.</span></span>

<span data-ttu-id="b1177-167">**Lista 6 — `ProductControllerTest.cs`**</span><span class="sxs-lookup"><span data-stu-id="b1177-167">**Listing 6 – `ProductControllerTest.cs`**</span></span>

[!code-csharp[Main](creating-unit-tests-for-asp-net-mvc-applications-cs/samples/sample8.cs)]

<span data-ttu-id="b1177-168">Po wywołaniu metody `RedirectToAction()` w akcji kontrolera akcja kontrolera zwraca `RedirectToRouteResult`.</span><span class="sxs-lookup"><span data-stu-id="b1177-168">When you call the `RedirectToAction()` method in a controller action, the controller action returns a `RedirectToRouteResult`.</span></span> <span data-ttu-id="b1177-169">Test sprawdza, czy `RedirectToRouteResult` przekieruje użytkownika do akcji kontrolera o nazwie `Index`.</span><span class="sxs-lookup"><span data-stu-id="b1177-169">The test checks whether the `RedirectToRouteResult` will redirect the user to a controller action named `Index`.</span></span>

## <a name="summary"></a><span data-ttu-id="b1177-170">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b1177-170">Summary</span></span>

<span data-ttu-id="b1177-171">W tym samouczku przedstawiono sposób kompilowania testów jednostkowych dla akcji kontrolera MVC.</span><span class="sxs-lookup"><span data-stu-id="b1177-171">In this tutorial, you learned how to build unit tests for MVC controller actions.</span></span> <span data-ttu-id="b1177-172">Po pierwsze przedstawiono sposób sprawdzania, czy prawy Widok jest zwracany przez akcję kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-172">First, you learned how to verify whether the right view is returned by a controller action.</span></span> <span data-ttu-id="b1177-173">Wiesz już, jak użyć właściwości `ViewResult.ViewName` do zweryfikowania nazwy widoku.</span><span class="sxs-lookup"><span data-stu-id="b1177-173">You learned how to use the `ViewResult.ViewName` property to verify the name of a view.</span></span>

<span data-ttu-id="b1177-174">Następnie zbadamy, jak można testować zawartość `View Data`.</span><span class="sxs-lookup"><span data-stu-id="b1177-174">Next, we examined how you can test the contents of `View Data`.</span></span> <span data-ttu-id="b1177-175">Wiesz już, jak sprawdzić, czy odpowiedni produkt został zwrócony w `View Data` po wywołaniu akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b1177-175">You learned how to check whether the right product was returned in `View Data` after calling a controller action.</span></span>

<span data-ttu-id="b1177-176">Wreszcie omówione zostało, jak można sprawdzić, czy w akcji kontrolera są zwracane różne typy wyników akcji.</span><span class="sxs-lookup"><span data-stu-id="b1177-176">Finally, we discussed how you can test whether different types of action results are returned from a controller action.</span></span> <span data-ttu-id="b1177-177">Wiesz już, jak sprawdzić, czy kontroler zwraca `ViewResult` lub `RedirectToRouteResult`.</span><span class="sxs-lookup"><span data-stu-id="b1177-177">You learned how to test whether a controller returns a `ViewResult` or a `RedirectToRouteResult`.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="b1177-178">Dalej</span><span class="sxs-lookup"><span data-stu-id="b1177-178">Next</span></span>](creating-unit-tests-for-asp-net-mvc-applications-vb.md)
