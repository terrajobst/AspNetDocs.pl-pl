---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Dodawanie widoku (VB) | Microsoft Docs
author: Rick-Anderson
description: Ten samouczek zawiera informacje na temat tworzenia aplikacji sieci Web ASP.NET MVC przy użyciu programu Microsoft Visual Web Developer 2010 Express z dodatkiem Service Pack 1, który jest...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: fa200935d83bb26c07b302449a6eba6fd67b5322
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78540426"
---
# <a name="adding-a-view-vb"></a><span data-ttu-id="b0134-103">Dodawanie widoku (VB)</span><span class="sxs-lookup"><span data-stu-id="b0134-103">Adding a View (VB)</span></span>

<span data-ttu-id="b0134-104">Autor [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="b0134-104">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="b0134-105">Ten samouczek zawiera informacje na temat tworzenia aplikacji sieci Web ASP.NET MVC przy użyciu programu Microsoft Visual Web Developer 2010 Express z dodatkiem Service Pack 1, który jest bezpłatną wersją Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b0134-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="b0134-106">Przed rozpoczęciem upewnij się, że zainstalowano wymagania wstępne wymienione poniżej.</span><span class="sxs-lookup"><span data-stu-id="b0134-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="b0134-107">Wszystkie z nich można zainstalować, klikając następujące łącze: [Instalator platformy sieci Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="b0134-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="b0134-108">Alternatywnie możesz zainstalować wstępnie wymagane składniki, korzystając z następujących linków:</span><span class="sxs-lookup"><span data-stu-id="b0134-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="b0134-109">Wymagania wstępne programu Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="b0134-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="b0134-110">Aktualizacja narzędzi ASP.NET MVC 3</span><span class="sxs-lookup"><span data-stu-id="b0134-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="b0134-111">[SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(obsługa środowiska uruchomieniowego + narzędzia)</span><span class="sxs-lookup"><span data-stu-id="b0134-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="b0134-112">Jeśli używasz programu Visual Studio 2010 zamiast programu Visual Web Developer 2010, Zainstaluj wymagania wstępne, klikając następujące łącze: [wymagania wstępne programu Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="b0134-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="b0134-113">Projekt Visual Web Developer z kodem źródłowym VB.NET jest dostępny do tego tematu.</span><span class="sxs-lookup"><span data-stu-id="b0134-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="b0134-114">[Pobierz wersję VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="b0134-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="b0134-115">Jeśli wolisz C#, przejdź do [ C# wersji](../cs/adding-a-view.md) tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="b0134-115">If you prefer C#, switch to the [C# version](../cs/adding-a-view.md) of this tutorial.</span></span>

<span data-ttu-id="b0134-116">W tej sekcji zamierzamy zmodyfikować klasę `HelloWorldController`, aby użyć pliku szablonu widoku do czystego hermetyzowania procesu generowania odpowiedzi HTML na klienta.</span><span class="sxs-lookup"><span data-stu-id="b0134-116">In this section we're going to modify the `HelloWorldController` class to use a view template file to cleanly encapsulate the process of generating HTML responses to a client.</span></span>

<span data-ttu-id="b0134-117">Zacznijmy od użycia szablonu widoku z metodą `Index` w klasie `HelloWorldController`.</span><span class="sxs-lookup"><span data-stu-id="b0134-117">Let's start by using a view template with the `Index` method in the `HelloWorldController` class.</span></span> <span data-ttu-id="b0134-118">Obecnie Metoda `Index` zwraca ciąg z komunikatem, który jest zakodowany w obrębie klasy kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b0134-118">Currently the `Index` method returns a string with a message that is hard-coded within the controller class.</span></span> <span data-ttu-id="b0134-119">Zmień metodę `Index`, aby zwracała obiekt `View`, jak pokazano na poniższej liście:</span><span class="sxs-lookup"><span data-stu-id="b0134-119">Change the `Index` method to return a `View` object, as shown in the following:</span></span>

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

<span data-ttu-id="b0134-120">Teraz dodamy szablon widoku do naszego projektu, który możemy wywołać za pomocą metody `Index`.</span><span class="sxs-lookup"><span data-stu-id="b0134-120">Let's now add a view template to our project that we can invoke with the `Index` method.</span></span> <span data-ttu-id="b0134-121">Aby to zrobić, kliknij prawym przyciskiem myszy wewnątrz metody `Index` i kliknij polecenie **Dodaj widok**.</span><span class="sxs-lookup"><span data-stu-id="b0134-121">To do this, right-click inside the `Index` method and click **Add View**.</span></span>

<span data-ttu-id="b0134-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span></span>

<span data-ttu-id="b0134-123">Pojawi się okno dialogowe **Dodaj widok** .</span><span class="sxs-lookup"><span data-stu-id="b0134-123">The **Add View** dialog box appears.</span></span> <span data-ttu-id="b0134-124">Pozostaw wpisy domyślne i kliknij przycisk **Dodaj** .</span><span class="sxs-lookup"><span data-stu-id="b0134-124">Leave the default entries and click the **Add** button.</span></span>

<span data-ttu-id="b0134-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span></span>

<span data-ttu-id="b0134-126">Zostanie utworzony folder *MvcMovie\Views\HelloWorld* i plik *MvcMovie\Views\HelloWorld\Index.vbhtml* .</span><span class="sxs-lookup"><span data-stu-id="b0134-126">The *MvcMovie\Views\HelloWorld* folder and the *MvcMovie\Views\HelloWorld\Index.vbhtml* file are created.</span></span> <span data-ttu-id="b0134-127">Można je zobaczyć w **Eksplorator rozwiązań**:</span><span class="sxs-lookup"><span data-stu-id="b0134-127">You can see them in **Solution Explorer**:</span></span>

<span data-ttu-id="b0134-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span></span>

<span data-ttu-id="b0134-129">Dodaj kod HTML pod tagiem `<h2>`.</span><span class="sxs-lookup"><span data-stu-id="b0134-129">Add some HTML under the `<h2>` tag.</span></span> <span data-ttu-id="b0134-130">Zmodyfikowany plik *MvcMovie\Views\HelloWorld\Index.vbhtml* jest przedstawiony poniżej.</span><span class="sxs-lookup"><span data-stu-id="b0134-130">The modified *MvcMovie\Views\HelloWorld\Index.vbhtml* file is shown below.</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

<span data-ttu-id="b0134-131">Uruchom aplikację i przejdź do kontrolera &quot;Hello World&quot; Controller (`http://localhost:xxxx/HelloWorld`).</span><span class="sxs-lookup"><span data-stu-id="b0134-131">Run the application and browse to the &quot;hello world&quot; controller (`http://localhost:xxxx/HelloWorld`).</span></span> <span data-ttu-id="b0134-132">Metoda `Index` w kontrolerze nie została znacznie zadziałała. po prostu uruchomiono instrukcję `return View()`, co oznacza, że chcemy użyć pliku szablonu widoku do renderowania odpowiedzi dla klienta.</span><span class="sxs-lookup"><span data-stu-id="b0134-132">The `Index` method in your controller didn't do much work; it simply ran the statement `return View()`, which indicated that we wanted to use a view template file to render a response to the client.</span></span> <span data-ttu-id="b0134-133">Ponieważ nie określono jawnie nazwy pliku szablonu widoku do użycia, ASP.NET MVC domyślnie używa pliku widoku *index. vbhtml* w folderze *\Views\HelloWorld* .</span><span class="sxs-lookup"><span data-stu-id="b0134-133">Because we did not explicitly specify the name of the view template file to use, ASP.NET MVC defaulted to using the *Index.vbhtml* view file within the *\Views\HelloWorld* folder.</span></span> <span data-ttu-id="b0134-134">Na poniższym obrazie przedstawiono zakodowany ciąg w widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-134">The image below shows the string hard-coded in the view.</span></span>

<span data-ttu-id="b0134-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span></span>

<span data-ttu-id="b0134-136">Wyglądają dość dobre.</span><span class="sxs-lookup"><span data-stu-id="b0134-136">Looks pretty good.</span></span> <span data-ttu-id="b0134-137">Należy jednak zauważyć, że na pasku tytułu przeglądarki widnieje &quot;indeks&quot; i duży tytuł na stronie jest wyświetlany &quot;mojej aplikacji MVC.&quot; zmienić te zmiany.</span><span class="sxs-lookup"><span data-stu-id="b0134-137">However, notice that the browser's title bar says &quot;Index&quot; and the big title on the page says &quot;My MVC Application.&quot; Let's change those.</span></span>

## <a name="changing-views-and-layout-pages"></a><span data-ttu-id="b0134-138">Zmienianie widoków i stron układu</span><span class="sxs-lookup"><span data-stu-id="b0134-138">Changing views and layout pages</span></span>

<span data-ttu-id="b0134-139">Najpierw Zmieńmy tekst &quot;aplikacji MVC.&quot;, że tekst jest udostępniony i pojawia się na każdej stronie.</span><span class="sxs-lookup"><span data-stu-id="b0134-139">First, let's change the text &quot;My MVC Application.&quot; That text is shared and appears on every page.</span></span> <span data-ttu-id="b0134-140">Faktycznie występuje tylko w jednym miejscu w naszym projekcie, nawet jeśli znajduje się na każdej stronie w naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b0134-140">It actually appears in only one place in our project, even though it's on every page in our application.</span></span> <span data-ttu-id="b0134-141">Przejdź do folderu */views/Shared* w **Eksplorator rozwiązań** i Otwórz plik *\_Layout. vbhtml* .</span><span class="sxs-lookup"><span data-stu-id="b0134-141">Go to the */Views/Shared* folder in **Solution Explorer** and open the *\_Layout.vbhtml* file.</span></span> <span data-ttu-id="b0134-142">Ten plik jest nazywany stroną układu i jest współdzieloną &quot;Shell&quot;, że wszystkie inne strony będą używane.</span><span class="sxs-lookup"><span data-stu-id="b0134-142">This file is called a layout page and it's the shared &quot;shell&quot; that all other pages use.</span></span>

<span data-ttu-id="b0134-143">Zanotuj `@RenderBody()` wiersz kodu w dolnej części pliku.</span><span class="sxs-lookup"><span data-stu-id="b0134-143">Note the `@RenderBody()` line of code near the bottom of the file.</span></span> <span data-ttu-id="b0134-144">`RenderBody` jest symbolem zastępczym, w którym wszystkie utworzone strony są wyświetlane, &quot;opakowane&quot; na stronie układ.</span><span class="sxs-lookup"><span data-stu-id="b0134-144">`RenderBody` is a placeholder where all the pages you create show up, &quot;wrapped&quot; in the layout page.</span></span> <span data-ttu-id="b0134-145">Zmień nagłówek `<h1>` z **&quot;** aplikacji MVC&quot; na &quot;aplikacji filmowej MVC&quot;.</span><span class="sxs-lookup"><span data-stu-id="b0134-145">Change the `<h1>` heading from **&quot;** My MVC Application&quot; to &quot;MVC Movie App&quot;.</span></span>

[!code-html[Main](adding-a-view/samples/sample3.html)]

<span data-ttu-id="b0134-146">Uruchom aplikację i zanotuj teraz komunikat &quot;&quot;aplikacji filmowej MVC.</span><span class="sxs-lookup"><span data-stu-id="b0134-146">Run the application and note it now says &quot;MVC Movie App&quot;.</span></span> <span data-ttu-id="b0134-147">Kliknij link **informacje** , a na tej stronie jest również wyświetlana &quot;aplikacja Movie&quot;MVC.</span><span class="sxs-lookup"><span data-stu-id="b0134-147">Click the **About** link, and that page shows &quot;MVC Movie App&quot;, too.</span></span>

<span data-ttu-id="b0134-148">Pełny plik *\_Layout. vbhtml* jest przedstawiony poniżej:</span><span class="sxs-lookup"><span data-stu-id="b0134-148">The complete *\_Layout.vbhtml* file is shown below:</span></span>

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

<span data-ttu-id="b0134-149">Teraz Zmieńmy tytuł strony indeksu (widok).</span><span class="sxs-lookup"><span data-stu-id="b0134-149">Now, let's change the title of the Index page (view).</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

<span data-ttu-id="b0134-150">Otwórz *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span><span class="sxs-lookup"><span data-stu-id="b0134-150">Open *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span></span> <span data-ttu-id="b0134-151">Istnieją dwa miejsca, w których należy wprowadzić zmianę: pierwszy, tekst wyświetlany w tytule przeglądarki, a następnie w pomocniczym nagłówku (`<h2>` elementu).</span><span class="sxs-lookup"><span data-stu-id="b0134-151">There are two places to make a change: first, the text that appears in the title of the browser, and then in the secondary header (the `<h2>` element).</span></span> <span data-ttu-id="b0134-152">Postanowimy nieco inaczej, aby zobaczyć, który bit kodu zmienia się w ramach aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b0134-152">We'll make them slightly different so you can see which bit of code changes which part of the app.</span></span>

<span data-ttu-id="b0134-153">Uruchom aplikację i przejdź do`http://localhost:xx/HelloWorld`.</span><span class="sxs-lookup"><span data-stu-id="b0134-153">Run the application and browse to`http://localhost:xx/HelloWorld`.</span></span> <span data-ttu-id="b0134-154">Zwróć uwagę, że tytuł przeglądarki, nagłówek podstawowy i pomocnicze nagłówki zostały zmienione.</span><span class="sxs-lookup"><span data-stu-id="b0134-154">Notice that the browser title, the primary heading, and the secondary headings have changed.</span></span> <span data-ttu-id="b0134-155">W aplikacji można łatwo wprowadzać duże zmiany, korzystając z małych zmian w widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-155">It's easy to make big changes in your application with small changes to a view.</span></span> <span data-ttu-id="b0134-156">(Jeśli w przeglądarce nie są widoczne zmiany, może być wyświetlana zawartość z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b0134-156">(If you don't see changes in the browser, you might be viewing cached content.</span></span> <span data-ttu-id="b0134-157">Naciśnij kombinację klawiszy CTRL + F5 w przeglądarce, aby wymusić załadowanie odpowiedzi z serwera.</span><span class="sxs-lookup"><span data-stu-id="b0134-157">Press Ctrl+F5 in your browser to force the response from the server to be loaded.)</span></span>

<span data-ttu-id="b0134-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span></span>

<span data-ttu-id="b0134-159">Nasz mały bit &quot;danych&quot; (w tym przypadku &quot;Hello world! komunikat&quot;) jest zakodowany na stałe.</span><span class="sxs-lookup"><span data-stu-id="b0134-159">Our little bit of &quot;data&quot; (in this case the &quot;Hello World!&quot; message) is hard-coded, though.</span></span> <span data-ttu-id="b0134-160">Nasza aplikacja MVC ma w wersji V (views), a mamy C (kontrolery), ale nie ma jeszcze M (model).</span><span class="sxs-lookup"><span data-stu-id="b0134-160">Our MVC application has V (views) and we've got C (controllers), but no M (model) yet.</span></span> <span data-ttu-id="b0134-161">Wkrótce przeprowadzimy Cię przez proces tworzenia bazy danych i pobierania z niej danych modelu.</span><span class="sxs-lookup"><span data-stu-id="b0134-161">Shortly, we'll walk through how create a database and retrieve model data from it.</span></span>

## <a name="passing-data-from-the-controller-to-the-view"></a><span data-ttu-id="b0134-162">Przekazywanie danych z kontrolera do widoku</span><span class="sxs-lookup"><span data-stu-id="b0134-162">Passing Data from the Controller to the View</span></span>

<span data-ttu-id="b0134-163">Zanim przejdziemy do bazy danych i porozmawiamy nad modelami, najpierw porozmawiamy o przekazywaniu informacji z kontrolera do widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-163">Before we go to a database and talk about models, though, let's first talk about passing information from the Controller to a View.</span></span> <span data-ttu-id="b0134-164">Chcemy przekazać szablon widoku, który jest wymagany w celu renderowania odpowiedzi HTML na klienta.</span><span class="sxs-lookup"><span data-stu-id="b0134-164">We want to pass what a view template requires in order to render an HTML response to a client.</span></span> <span data-ttu-id="b0134-165">Te obiekty są zwykle tworzone i przesyłane przez klasę kontrolera do szablonu widoku i powinny zawierać tylko te dane, których wymaga szablon widoku — i nie tylko.</span><span class="sxs-lookup"><span data-stu-id="b0134-165">These objects are typically created and passed by a controller class to a view template, and they should contain only the data that the view template requires — and no more.</span></span>

<span data-ttu-id="b0134-166">Wcześniej z klasą `HelloWorldController`, Metoda akcji `Welcome` wykonała `name` i `numTimes` parametr, a następnie wyprowadza wartości parametrów do przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="b0134-166">Previously with the `HelloWorldController` class, the `Welcome` action method took a `name` and a `numTimes` parameter and then output the parameter values to the browser.</span></span> <span data-ttu-id="b0134-167">Zamiast tego kontroler nie kontynuuje bezpośredniego renderowania tej odpowiedzi, zamiast tego umieścimy te dane w zbiorze dla widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-167">Rather than have the controller continue to render this response directly, let's instead we'll put that data in a bag for the View.</span></span> <span data-ttu-id="b0134-168">Kontrolery i widoki mogą używać obiektu `ViewBag` do przechowywania tych danych.</span><span class="sxs-lookup"><span data-stu-id="b0134-168">Controllers and Views can use a `ViewBag` object to hold that data.</span></span> <span data-ttu-id="b0134-169">Ta funkcja zostanie przeniesiona do szablonu widoku automatycznie i użyta do renderowania odpowiedzi HTML przy użyciu zawartości Work jako danych.</span><span class="sxs-lookup"><span data-stu-id="b0134-169">That will be passed over to a view template automatically, and used to render the HTML response using the contents of the bag as data.</span></span> <span data-ttu-id="b0134-170">Taki sposób, aby kontroler został objęty jednym elementem i szablonem widoku innym, umożliwiając nam zachowanie czystego &quot;separacji&quot; w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b0134-170">That way the controller is concerned with one thing and the view template with another — enabling us to maintain clean &quot;separation of concerns&quot; within the application.</span></span>

<span data-ttu-id="b0134-171">Alternatywnie możemy zdefiniować klasę niestandardową, a następnie utworzyć wystąpienie tego obiektu samodzielnie, wypełnić je danymi i przekazać je do widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-171">Alternatively, we could define a custom class, then create an instance of that object on our own, fill it with data and pass it to the View.</span></span> <span data-ttu-id="b0134-172">Jest to często nazywane ViewModel, ponieważ jest modelem niestandardowym dla widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-172">That is often called a ViewModel, because it's a custom Model for the View.</span></span> <span data-ttu-id="b0134-173">W przypadku małych ilości danych ViewBag działa doskonale.</span><span class="sxs-lookup"><span data-stu-id="b0134-173">For small amounts of data, however, the ViewBag works great.</span></span>

<span data-ttu-id="b0134-174">Wróć do pliku *HelloWorldController. vb* zmień metodę `Welcome` wewnątrz kontrolera, aby umieścić komunikat i NumTimes w ViewBag.</span><span class="sxs-lookup"><span data-stu-id="b0134-174">Return to the *HelloWorldController.vb* file change the `Welcome` method inside the controller to put the Message and NumTimes into the ViewBag.</span></span> <span data-ttu-id="b0134-175">ViewBag jest obiektem dynamicznym.</span><span class="sxs-lookup"><span data-stu-id="b0134-175">The ViewBag is a dynamic object.</span></span> <span data-ttu-id="b0134-176">Oznacza to, że możesz umieścić dowolne z nich.</span><span class="sxs-lookup"><span data-stu-id="b0134-176">That means you can put whatever you want in to it.</span></span> <span data-ttu-id="b0134-177">ViewBag nie ma zdefiniowanych właściwości, dopóki nie umieścisz w niej elementu.</span><span class="sxs-lookup"><span data-stu-id="b0134-177">The ViewBag has no defined properties until you put something inside it.</span></span>

<span data-ttu-id="b0134-178">Kompletny `HelloWorldController.vb` z nową klasą w tym samym pliku.</span><span class="sxs-lookup"><span data-stu-id="b0134-178">The complete `HelloWorldController.vb` with the new class in the same file.</span></span>

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

<span data-ttu-id="b0134-179">Teraz nasza ViewBag zawiera dane, które zostaną automatycznie przesłane do widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-179">Now our ViewBag contains data that will be passed over to the View automatically.</span></span> <span data-ttu-id="b0134-180">W przeciwnym razie możemy przekazywać swój własny obiekt podobny do tego, jeśli lubimy:</span><span class="sxs-lookup"><span data-stu-id="b0134-180">Again, alternatively we could have passed in our own object like this if we liked:</span></span>

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

<span data-ttu-id="b0134-181">Teraz potrzebujemy szablonu `WelcomeView`!</span><span class="sxs-lookup"><span data-stu-id="b0134-181">Now we need a `WelcomeView` template!</span></span> <span data-ttu-id="b0134-182">Uruchom aplikację, aby nowy kod został skompilowany.</span><span class="sxs-lookup"><span data-stu-id="b0134-182">Run the application so the new code is compiled.</span></span> <span data-ttu-id="b0134-183">Zamknij przeglądarkę, kliknij prawym przyciskiem myszy wewnątrz metody `Welcome`, a następnie kliknij polecenie **Dodaj widok**.</span><span class="sxs-lookup"><span data-stu-id="b0134-183">Close the browser, right-click inside the `Welcome` method, and then click **Add View**.</span></span>

<span data-ttu-id="b0134-184">Oto, jak wygląda okno dialogowe **Dodaj widok** .</span><span class="sxs-lookup"><span data-stu-id="b0134-184">Here's what your **Add View** dialog box looks like.</span></span>

<span data-ttu-id="b0134-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span></span>

<span data-ttu-id="b0134-186">Dodaj następujący kod do elementu `<h2>` w nowym <em>WITAMU.</em> plik VBHTML.</span><span class="sxs-lookup"><span data-stu-id="b0134-186">Add the following code under the `<h2>` element in the new <em>Welcome.</em>vbhtml file.</span></span> <span data-ttu-id="b0134-187">Utworzymy pętlę i powiedzmy, &quot;Hello&quot; tyle razy, ile jest to konieczne!</span><span class="sxs-lookup"><span data-stu-id="b0134-187">We'll make a loop and say &quot;Hello&quot; as many times as the user says we should!</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

<span data-ttu-id="b0134-188">Uruchom aplikację i przejdź do `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span><span class="sxs-lookup"><span data-stu-id="b0134-188">Run the application and browse to `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span></span>

<span data-ttu-id="b0134-189">Teraz dane są pobierane z adresu URL i automatycznie przesyłane do kontrolera.</span><span class="sxs-lookup"><span data-stu-id="b0134-189">Now data is taken from the URL and passed to the controller automatically.</span></span> <span data-ttu-id="b0134-190">Kontroler pakuje dane do obiektu `Model` i przekazuje ten obiekt do widoku.</span><span class="sxs-lookup"><span data-stu-id="b0134-190">The controller packages up the data into a `Model` object and passes that object to the view.</span></span> <span data-ttu-id="b0134-191">Widok niż wyświetla dane w formacie HTML dla użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b0134-191">The view than displays the data as HTML to the user.</span></span>

<span data-ttu-id="b0134-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b0134-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span></span>

<span data-ttu-id="b0134-193">Jest to również typ &quot;M&quot; dla modelu, ale nie do rodzaju bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b0134-193">Well, that was a kind of an &quot;M&quot; for model, but not the database kind.</span></span> <span data-ttu-id="b0134-194">Zapoznaj się z informacjami i Utwórz bazę danych dla filmów.</span><span class="sxs-lookup"><span data-stu-id="b0134-194">Let's take what we've learned and create a database of movies.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b0134-195">[Poprzednie](adding-a-controller.md)
> [dalej](adding-a-model.md)</span><span class="sxs-lookup"><span data-stu-id="b0134-195">[Previous](adding-a-controller.md)
[Next](adding-a-model.md)</span></span>
