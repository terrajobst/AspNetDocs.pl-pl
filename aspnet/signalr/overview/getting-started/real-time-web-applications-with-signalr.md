---
uid: signalr/overview/getting-started/real-time-web-applications-with-signalr
title: 'Ćwiczenia praktyczne: Aplikacje internetowe czasu rzeczywistego przy użyciu SignalR | Dokumentacja firmy Microsoft'
author: bradygaster
description: Możliwość Wypchnij zawartość do dołączonych klientów, jak to się dzieje, w czasie rzeczywistym po stronie serwera są wyposażone w aplikacji sieci Web w czasie rzeczywistym. Dla deweloperów platformy ASP.NET i ASP...
ms.author: bradyg
ms.date: 07/16/2014
ms.assetid: ba07958c-42e1-4da0-81db-ba6925ed6db0
msc.legacyurl: /signalr/overview/getting-started/real-time-web-applications-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: 9e39fd3f2fc9d4e791002450085215096c222fcd
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/06/2019
ms.locfileid: "65120001"
---
# <a name="hands-on-lab-real-time-web-applications-with-signalr"></a><span data-ttu-id="9695f-104">Ćwiczenia praktyczne: aplikacje internetowe czasu rzeczywistego z wykorzystaniem usługi SignalR</span><span class="sxs-lookup"><span data-stu-id="9695f-104">Hands On Lab: Real-Time Web Applications with SignalR</span></span>

<span data-ttu-id="9695f-105">Przez [Camp w sieci Web zespołu](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="9695f-105">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

[<span data-ttu-id="9695f-106">Pobierz Camp Web szkolenia zestawu, wersji z października 2015 r.</span><span class="sxs-lookup"><span data-stu-id="9695f-106">Download Web Camps Training Kit, October 2015 Release</span></span>](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b)

> <span data-ttu-id="9695f-107">Możliwość Wypchnij zawartość do dołączonych klientów, jak to się dzieje, w czasie rzeczywistym po stronie serwera są wyposażone w aplikacji sieci Web w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="9695f-107">Real-time Web applications feature the ability to push server-side content to the connected clients as it happens, in real-time.</span></span> <span data-ttu-id="9695f-108">Dla deweloperów platformy ASP.NET **ASP.NET SignalR** jest biblioteką, aby dodać funkcje sieci web w czasie rzeczywistym do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-108">For ASP.NET developers, **ASP.NET SignalR** is a library to add real-time web functionality to their applications.</span></span> <span data-ttu-id="9695f-109">Wykorzystuje ona transportów kilka automatyczne wybieranie najlepiej transportu dostępnych danego klienta i serwera najlepsze dostępne mechanizm transportu.</span><span class="sxs-lookup"><span data-stu-id="9695f-109">It takes advantage of several transports, automatically selecting the best available transport given the client and server's best available transport.</span></span> <span data-ttu-id="9695f-110">Wykorzystuje ona **WebSocket**, interfejs API języka HTML5, która umożliwia komunikację dwukierunkową między przeglądarką i serwerem.</span><span class="sxs-lookup"><span data-stu-id="9695f-110">It takes advantage of **WebSocket**, an HTML5 API that enables bi-directional communication between the browser and server.</span></span>
> 
> <span data-ttu-id="9695f-111">**SignalR** udostępnia także prosty i ogólny interfejs API ten serwer do klienta RPC (wywołują funkcje JavaScript w przeglądarkach klientów z kodu .NET po stronie serwera) w aplikacji ASP.NET, a także dodawanie przydatne punkty zaczepienia umożliwiający zarządzanie połączeniami takie jak łączenie/rozłączanie połączeń zdarzenia, grupowanie połączeń i autoryzację.</span><span class="sxs-lookup"><span data-stu-id="9695f-111">**SignalR** also provides a simple, high-level API for doing server to client RPC (call JavaScript functions in your clients' browsers from server-side .NET code) in your ASP.NET application, as well as adding useful hooks for connection management, such as connect/disconnect events, grouping connections, and authorization.</span></span>
> 
> <span data-ttu-id="9695f-112">**SignalR** jest warstwą abstrakcji nałożoną przez niektóre transportu, które są wymagane do pracy w czasie rzeczywistym między klientem i serwerem.</span><span class="sxs-lookup"><span data-stu-id="9695f-112">**SignalR** is an abstraction over some of the transports that are required to do real-time work between client and server.</span></span> <span data-ttu-id="9695f-113">A **SignalR** połączeniu rozpoczyna się jako HTTP, a następnie zostanie podwyższony do **WebSocket** połączenia, jeśli jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="9695f-113">A **SignalR** connection starts as HTTP, and is then promoted to a **WebSocket** connection if available.</span></span> <span data-ttu-id="9695f-114">**WebSocket** jest idealnym rozwiązaniem transport dla **SignalR**, ponieważ zapewnia najbardziej efektywne wykorzystanie pamięci serwera ma najniższe opóźnienie i ma większość podstawowych funkcji (takich jak komunikację pełnodupleksową między klientem i Server), ale ma również najbardziej rygorystyczne wymagania: **WebSocket** wymaga serwera, aby korzystać z **systemu Windows Server 2012** lub **systemu Windows 8**, wraz z **.NET Framework 4.5**.</span><span class="sxs-lookup"><span data-stu-id="9695f-114">**WebSocket** is the ideal transport for **SignalR**, since it makes the most efficient use of server memory, has the lowest latency, and has the most underlying features (such as full duplex communication between client and server), but it also has the most stringent requirements: **WebSocket** requires the server to be using **Windows Server 2012** or **Windows 8**, along with **.NET Framework 4.5**.</span></span> <span data-ttu-id="9695f-115">Jeśli te wymagania nie są spełnione, **SignalR** podejmie próbę użycia innego transportu się jego połączenia (takich jak *Ajax długim sondowaniem*).</span><span class="sxs-lookup"><span data-stu-id="9695f-115">If these requirements are not met, **SignalR** will attempt to use other transports to make its connections (like *Ajax long polling*).</span></span>
> 
> <span data-ttu-id="9695f-116">**SignalR** interfejs API zawiera dwa modele do komunikacji między klientami a serwerami: **Połączenia trwałe** i **koncentratory**.</span><span class="sxs-lookup"><span data-stu-id="9695f-116">The **SignalR** API contains two models for communicating between clients and servers: **Persistent Connections** and **Hubs**.</span></span> <span data-ttu-id="9695f-117">A **połączenia** reprezentuje punkt końcowy proste wysyłanie pojedynczego adresata pogrupowane lub wiadomości emisji.</span><span class="sxs-lookup"><span data-stu-id="9695f-117">A **Connection** represents a simple endpoint for sending single-recipient, grouped, or broadcast messages.</span></span> <span data-ttu-id="9695f-118">A **Centrum** jest bardziej ogólny potokiem utworzonych na podstawie interfejsu API połączenia, który umożliwia klienta i serwera, bezpośrednie wywoływanie metod na siebie nawzajem.</span><span class="sxs-lookup"><span data-stu-id="9695f-118">A **Hub** is a more high-level pipeline built upon the Connection API that allows your client and server to call methods on each other directly.</span></span>
> 
> ![Architektura SignalR](real-time-web-applications-with-signalr/_static/image1.png)
> 
> <span data-ttu-id="9695f-120">Wszystkie przykładowy kod i fragmenty kodu są uwzględniane w sieci Web zestaw szkoleniowy Camp, października 2015 wydania, dostępne pod adresem [ https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b ](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b).</span><span class="sxs-lookup"><span data-stu-id="9695f-120">All sample code and snippets are included in the Web Camps Training Kit, October 2015 Release, available at [https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b](https://github.com/Microsoft-Web/WebCampTrainingKit/releases/tag/v2015.10.13b).</span></span>  <span data-ttu-id="9695f-121">Należy pamiętać, że link Instalatora na tej stronie nie działa już; Użyj jednego z linków w sekcji zasobów.</span><span class="sxs-lookup"><span data-stu-id="9695f-121">Please note that the Installer link on that page no longer works; use one of the links under the Assets section instead.</span></span>

<a id="Overview"></a>
## <a name="overview"></a><span data-ttu-id="9695f-122">Omówienie</span><span class="sxs-lookup"><span data-stu-id="9695f-122">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="9695f-123">Cele</span><span class="sxs-lookup"><span data-stu-id="9695f-123">Objectives</span></span>

<span data-ttu-id="9695f-124">W tym praktyczne laboratorium dowiesz się jak:</span><span class="sxs-lookup"><span data-stu-id="9695f-124">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="9695f-125">Wysyłanie powiadomień z serwera do klienta przy użyciu SignalR.</span><span class="sxs-lookup"><span data-stu-id="9695f-125">Send notifications from server to client using SignalR.</span></span>
- <span data-ttu-id="9695f-126">Skalowanie w poziomie swojej SignalR aplikacji za pomocą **programu SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="9695f-126">Scale Out your SignalR application using **SQL Server**.</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="9695f-127">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="9695f-127">Prerequisites</span></span>

<span data-ttu-id="9695f-128">Do ukończenia tego laboratorium praktycznego niezbędne jest, następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="9695f-128">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="9695f-129">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span><span class="sxs-lookup"><span data-stu-id="9695f-129">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="9695f-130">Konfiguracja</span><span class="sxs-lookup"><span data-stu-id="9695f-130">Setup</span></span>

<span data-ttu-id="9695f-131">Aby można było uruchomić ćwiczeń opisanych w tym praktyczne laboratorium, należy najpierw skonfigurować swoje środowisko.</span><span class="sxs-lookup"><span data-stu-id="9695f-131">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="9695f-132">Otwórz okno Eksploratora Windows i przejdź do laboratorium **źródła** folderu.</span><span class="sxs-lookup"><span data-stu-id="9695f-132">Open a Windows Explorer window and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="9695f-133">Kliknij prawym przyciskiem myszy **plik Setup.cmd** i wybierz **Uruchom jako administrator** do uruchamiania procesu instalacji, który będzie skonfigurować środowisko i zainstalować fragmenty kodu programu Visual Studio, w tym środowisku laboratoryjnym.</span><span class="sxs-lookup"><span data-stu-id="9695f-133">Right-click **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="9695f-134">Jeśli zostanie wyświetlone okno dialogowe kontroli konta użytkownika, upewnij się, działania, aby kontynuować.</span><span class="sxs-lookup"><span data-stu-id="9695f-134">If the User Account Control dialog box is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="9695f-135">Upewnij się, że wszystkie zależności w tym środowisku laboratoryjnym sprawdzeniu przed uruchomieniem Instalatora.</span><span class="sxs-lookup"><span data-stu-id="9695f-135">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>

<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="9695f-136">Za pomocą fragmentów kodu</span><span class="sxs-lookup"><span data-stu-id="9695f-136">Using the Code Snippets</span></span>

<span data-ttu-id="9695f-137">W dokumencie laboratorium należy poinstruować można wstawiać bloki kodu.</span><span class="sxs-lookup"><span data-stu-id="9695f-137">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="9695f-138">Dla wygody większość ten kod jest dostarczany jako Visual Studio fragmenty kodu, które są dostępne w Visual Studio 2013, aby uniknąć konieczności Dodaj ją ręcznie.</span><span class="sxs-lookup"><span data-stu-id="9695f-138">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="9695f-139">Każdy wykonywania towarzyszy początkowy rozwiązanie znajduje się w **rozpocząć** folderu ćwiczeniu, która umożliwia wykonanie każdego wykonywania niezależnie od innych.</span><span class="sxs-lookup"><span data-stu-id="9695f-139">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="9695f-140">Należy pamiętać, że fragmenty kodu, które są dodawane podczas wykonywania brakuje te uruchamianie rozwiązań i może nie działać, dopóki nie zakończysz wykonywania.</span><span class="sxs-lookup"><span data-stu-id="9695f-140">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="9695f-141">Wewnątrz kodu źródłowego dla ćwiczenia, można również znaleźć **zakończenia** folderu zawierającego rozwiązania programu Visual Studio z kodem, który powstały na skutek wykonaniu kroków w odpowiedniej wykonywania.</span><span class="sxs-lookup"><span data-stu-id="9695f-141">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="9695f-142">Jeśli potrzebujesz dodatkowej pomocy, gdy pracujesz za pośrednictwem tego laboratorium praktycznego, można użyć jako wskazówki dotyczące tych rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="9695f-142">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>

---

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="9695f-143">Ćwiczenia</span><span class="sxs-lookup"><span data-stu-id="9695f-143">Exercises</span></span>

<span data-ttu-id="9695f-144">To ćwiczenie praktyczne obejmuje następujących czynnościach:</span><span class="sxs-lookup"><span data-stu-id="9695f-144">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="9695f-145">Praca z danymi w czasie rzeczywistym przy użyciu biblioteki SignalR</span><span class="sxs-lookup"><span data-stu-id="9695f-145">Working with Real-Time Data Using SignalR</span></span>](#Exercise1)
2. [<span data-ttu-id="9695f-146">Skalowanie w poziomie przy użyciu programu SQL Server</span><span class="sxs-lookup"><span data-stu-id="9695f-146">Scaling Out Using SQL Server</span></span>](#Exercise2)

<span data-ttu-id="9695f-147">Szacowany czas do ukończenia tego laboratorium: **60 minut**</span><span class="sxs-lookup"><span data-stu-id="9695f-147">Estimated time to complete this lab: **60 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="9695f-148">Przy pierwszym uruchomieniu programu Visual Studio, należy wybrać jedną z kolekcji wstępnie zdefiniowanych ustawień.</span><span class="sxs-lookup"><span data-stu-id="9695f-148">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="9695f-149">Każda kolekcja wstępnie zdefiniowanych służy do dopasowywania style rozwoju i określa układy okna, zachowanie edytora, fragmenty kodu IntelliSense i opcje w oknach dialogowych.</span><span class="sxs-lookup"><span data-stu-id="9695f-149">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="9695f-150">Procedury przedstawione w tym środowisku laboratoryjnym opisano czynności niezbędnych do wykonywania danego zadania w programie Visual Studio, korzystając z **ogólnych ustawieniach projektowych** kolekcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-150">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="9695f-151">Jeśli wybierzesz kolekcji różne ustawienia dla swojego środowiska programowania, może być różnice w krokach, które należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="9695f-151">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>

<a id="Exercise1"></a>
### <a name="exercise-1-working-with-real-time-data-using-signalr"></a><span data-ttu-id="9695f-152">Ćwiczenie 1: Praca z danymi w czasie rzeczywistym przy użyciu biblioteki SignalR</span><span class="sxs-lookup"><span data-stu-id="9695f-152">Exercise 1: Working with Real-Time Data Using SignalR</span></span>

<span data-ttu-id="9695f-153">Podczas rozmowy jest często używana jako przykład, można zrobić całości wiele więcej za pomocą funkcji sieci Web w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="9695f-153">While chat is often used as an example, you can do a whole lot more with real-time Web functionality.</span></span> <span data-ttu-id="9695f-154">Ilekroć użytkownika odświeża stronę sieci web, aby zobaczyć nowe dane lub implementuje strony Ajax długim sondowaniem pobrać nowe dane, możesz użyć SignalR.</span><span class="sxs-lookup"><span data-stu-id="9695f-154">Any time a user refreshes a web page to see new data or the page implements Ajax long polling to retrieve new data, you can use SignalR.</span></span>

<span data-ttu-id="9695f-155">Obsługuje SignalR **wypychania przez serwer** lub **emisji** funkcjonalności; obsługuje ona zarządzanie połączeniami automatycznie.</span><span class="sxs-lookup"><span data-stu-id="9695f-155">SignalR supports **server push** or **broadcasting** functionality; it handles connection management automatically.</span></span> <span data-ttu-id="9695f-156">W klasycznym połączeń HTTP dla komunikacji klient serwer, ponownym nawiązaniu połączenia dla każdego żądania, ale Biblioteka SignalR udostępnia trwałe połączenie między klientem i serwerem.</span><span class="sxs-lookup"><span data-stu-id="9695f-156">In classic HTTP connections for client-server communication, connection is re-established for each request, but SignalR provides persistent connection between the client and server.</span></span> <span data-ttu-id="9695f-157">W bibliotece SignalR, który wywołuje kod serwera dla kodu klienta, w przeglądarce, za pomocą zdalnego wywołania procedury (RPC) zamiast modelu odpowiedź na żądanie Wiemy już dziś.</span><span class="sxs-lookup"><span data-stu-id="9695f-157">In SignalR the server code calls out to a client code in the browser using Remote Procedure Calls (RPC), rather than the request-response model we know today.</span></span>

<span data-ttu-id="9695f-158">W tym ćwiczeniu skonfigurujesz **Quiz maniaków komputerowych** aplikacji na używanie biblioteki SignalR, aby wyświetlić pulpit nawigacyjny statystyki za pomocą zaktualizowanych metryk, bez konieczności odświeżenia całej strony.</span><span class="sxs-lookup"><span data-stu-id="9695f-158">In this exercise, you will configure the **Geek Quiz** application to use SignalR to display the Statistics dashboard with the updated metrics without the need to refresh the entire page.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--exploring-the-geek-quiz-statistics-page"></a><span data-ttu-id="9695f-159">Zadanie 1 — poznawanie strona statystyk Quiz maniaków komputerowych</span><span class="sxs-lookup"><span data-stu-id="9695f-159">Task 1 – Exploring the Geek Quiz Statistics Page</span></span>

<span data-ttu-id="9695f-160">W ramach tego zadania będzie przechodzą przez aplikację i sprawdzić, jak przedstawiono na stronie statystyki i jak można poprawić sposób informacje są aktualizowane.</span><span class="sxs-lookup"><span data-stu-id="9695f-160">In this task, you will go through the application and verify how the statistics page is shown and how you can improve the way the information is updated.</span></span>

1. <span data-ttu-id="9695f-161">Otwórz **Visual Studio Express 2013 for Web** , a następnie otwórz **GeekQuiz.sln** rozwiązanie znajduje się w **Source\Ex1 WorkingWithRealTimeData\Begin** folderu.</span><span class="sxs-lookup"><span data-stu-id="9695f-161">Open **Visual Studio Express 2013 for Web** and open the **GeekQuiz.sln** solution located in the **Source\Ex1-WorkingWithRealTimeData\Begin** folder.</span></span>
2. <span data-ttu-id="9695f-162">Naciśnij klawisz **F5** Aby uruchomić rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-162">Press **F5** to run the solution.</span></span> <span data-ttu-id="9695f-163">**Zaloguj** strony powinna zostać wyświetlona w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="9695f-163">The **Log in** page should appear in the browser.</span></span>

    <span data-ttu-id="9695f-164">![Uruchamianie rozwiązania](real-time-web-applications-with-signalr/_static/image2.png "uruchamianie rozwiązania")</span><span class="sxs-lookup"><span data-stu-id="9695f-164">![Running the solution](real-time-web-applications-with-signalr/_static/image2.png "Running the solution")</span></span>

    <span data-ttu-id="9695f-165">*Uruchamianie rozwiązania*</span><span class="sxs-lookup"><span data-stu-id="9695f-165">*Running the solution*</span></span>
3. <span data-ttu-id="9695f-166">Kliknij przycisk **zarejestrować** w prawym górnym rogu strony Aby utworzyć nowego użytkownika w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-166">Click **Register** in the upper-right corner of the page to create a new user in the application.</span></span>

    <span data-ttu-id="9695f-167">![Zarejestruj łącze](real-time-web-applications-with-signalr/_static/image3.png "link Zarejestruj")</span><span class="sxs-lookup"><span data-stu-id="9695f-167">![Register link](real-time-web-applications-with-signalr/_static/image3.png "Register link")</span></span>

    <span data-ttu-id="9695f-168">*Link Zarejestruj*</span><span class="sxs-lookup"><span data-stu-id="9695f-168">*Register link*</span></span>
4. <span data-ttu-id="9695f-169">W **zarejestrować** wpisz **nazwa_użytkownika** i **hasło**, a następnie kliknij przycisk **zarejestrować**.</span><span class="sxs-lookup"><span data-stu-id="9695f-169">In the **Register** page, enter a **User name** and **Password**, and then click **Register**.</span></span>

    <span data-ttu-id="9695f-170">![Rejestrowanie użytkownika](real-time-web-applications-with-signalr/_static/image4.png "użytkownika")</span><span class="sxs-lookup"><span data-stu-id="9695f-170">![Registering a user](real-time-web-applications-with-signalr/_static/image4.png "Registering a user")</span></span>

    <span data-ttu-id="9695f-171">*Rejestrowanie użytkownika*</span><span class="sxs-lookup"><span data-stu-id="9695f-171">*Registering a user*</span></span>
5. <span data-ttu-id="9695f-172">Aplikacja rejestruje nowego konta i użytkownik jest uwierzytelniony i przekierowanie z powrotem do strony głównej, przedstawiający na pierwsze pytanie quizu.</span><span class="sxs-lookup"><span data-stu-id="9695f-172">The application registers the new account and the user is authenticated and redirected back to the home page showing the first quiz question.</span></span>
6. <span data-ttu-id="9695f-173">Otwórz **statystyki** strony w nowym oknie, a następnie umieść **Home** strony i **statystyki** stronie side-by-side.</span><span class="sxs-lookup"><span data-stu-id="9695f-173">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side.</span></span>

    <span data-ttu-id="9695f-174">![Windows Side-by-side](real-time-web-applications-with-signalr/_static/image5.png "po stronie przez system windows po stronie")</span><span class="sxs-lookup"><span data-stu-id="9695f-174">![Side-by-side windows](real-time-web-applications-with-signalr/_static/image5.png "Side by side windows")</span></span>

    <span data-ttu-id="9695f-175">*Side-by-side systemu windows*</span><span class="sxs-lookup"><span data-stu-id="9695f-175">*Side-by-side windows*</span></span>
7. <span data-ttu-id="9695f-176">W **Home** strony, Odpowiedz na pytanie, klikając jedną z opcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-176">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="9695f-177">![Odpowiadanie na pytania](real-time-web-applications-with-signalr/_static/image6.png "odpowiadanie na pytania")</span><span class="sxs-lookup"><span data-stu-id="9695f-177">![Answering a question](real-time-web-applications-with-signalr/_static/image6.png "Answering a question")</span></span>

    <span data-ttu-id="9695f-178">*Odpowiadanie na pytania*</span><span class="sxs-lookup"><span data-stu-id="9695f-178">*Answering a question*</span></span>
8. <span data-ttu-id="9695f-179">Po kliknięciu jednego z przycisków, powinna zostać wyświetlona odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="9695f-179">After clicking one of the buttons, the answer should appear.</span></span>

    <span data-ttu-id="9695f-180">![Prawidłowe odpowiedzi na pytanie](real-time-web-applications-with-signalr/_static/image7.png "prawidłowe odpowiedzi na pytanie")</span><span class="sxs-lookup"><span data-stu-id="9695f-180">![Question answered correct](real-time-web-applications-with-signalr/_static/image7.png "Question answered correct")</span></span>

    <span data-ttu-id="9695f-181">*Prawidłowej odpowiedzi na pytania*</span><span class="sxs-lookup"><span data-stu-id="9695f-181">*Question answered correctly*</span></span>
9. <span data-ttu-id="9695f-182">Zwróć uwagę, czy informacje podane na stronie statystyki są nieaktualne.</span><span class="sxs-lookup"><span data-stu-id="9695f-182">Notice that the information provided in the Statistics page is outdated.</span></span> <span data-ttu-id="9695f-183">Odśwież stronę, aby wyświetlić zaktualizowane wyniki.</span><span class="sxs-lookup"><span data-stu-id="9695f-183">Refresh the page in order to see the updated results.</span></span>

    <span data-ttu-id="9695f-184">![Strona statystyk](real-time-web-applications-with-signalr/_static/image8.png "strona statystyk")</span><span class="sxs-lookup"><span data-stu-id="9695f-184">![Statistics page](real-time-web-applications-with-signalr/_static/image8.png "Statistics page")</span></span>

    <span data-ttu-id="9695f-185">*Strona statystyk*</span><span class="sxs-lookup"><span data-stu-id="9695f-185">*Statistics page*</span></span>
10. <span data-ttu-id="9695f-186">Wróć do programu Visual Studio i zatrzymać debugowanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-186">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex1Task2"></a>
#### <a name="task-2--adding-signalr-to-geek-quiz-to-show-online-charts"></a><span data-ttu-id="9695f-187">Zadanie 2 — Dodawanie SignalR do quizu maniaków komputerowych, aby wyświetlić wykresy Online</span><span class="sxs-lookup"><span data-stu-id="9695f-187">Task 2 – Adding SignalR to Geek Quiz to Show Online Charts</span></span>

<span data-ttu-id="9695f-188">W ramach tego zadania możesz dodać SignalR do rozwiązania i automatycznie Wyślij aktualizacje klientów, gdy nową odpowiedź jest wysyłana do serwera.</span><span class="sxs-lookup"><span data-stu-id="9695f-188">In this task, you will add SignalR to the solution and send updates to the clients automatically when a new answer is sent to the server.</span></span>

1. <span data-ttu-id="9695f-189">Z **narzędzia** menu w programie Visual Studio, wybierz **Menedżera pakietów NuGet**, a następnie kliknij przycisk **Konsola Menedżera pakietów**.</span><span class="sxs-lookup"><span data-stu-id="9695f-189">From the **Tools** menu in Visual Studio, select **NuGet Package Manager**, and then click **Package Manager Console**.</span></span>
2. <span data-ttu-id="9695f-190">W **Konsola Menedżera pakietów** okna, wykonaj następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="9695f-190">In the **Package Manager Console** window, execute the following command:</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample1.ps1)]

    <span data-ttu-id="9695f-191">![Instalacja pakietu SignalR](real-time-web-applications-with-signalr/_static/image9.png "instalacji pakietu SignalR")</span><span class="sxs-lookup"><span data-stu-id="9695f-191">![SignalR package installation](real-time-web-applications-with-signalr/_static/image9.png "SignalR package installation")</span></span>

    <span data-ttu-id="9695f-192">*Instalacja pakietu SignalR*</span><span class="sxs-lookup"><span data-stu-id="9695f-192">*SignalR package installation*</span></span>

   > [!NOTE]
   > <span data-ttu-id="9695f-193">Podczas instalowania **SignalR** wersji pakietów NuGet pkt 2.0.2 z zupełnie nowych aplikacji MVC 5, należy ręcznie zaktualizować **OWIN** pakiety do wersji 2.0.1 (lub nowszej) przed zainstalowaniem SignalR.</span><span class="sxs-lookup"><span data-stu-id="9695f-193">When installing **SignalR** NuGet packages version 2.0.2 from a brand new MVC 5 application, you will need to manually update **OWIN** packages to version 2.0.1 (or higher) before installing SignalR.</span></span> <span data-ttu-id="9695f-194">Aby to zrobić, można wykonać poniższy skrypt w **Konsola Menedżera pakietów**:</span><span class="sxs-lookup"><span data-stu-id="9695f-194">To do this, you can execute the following script in the **Package Manager Console**:</span></span>
   > 
   > [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample2.ps1)]
   > 
   > <span data-ttu-id="9695f-195">W przyszłej wersji biblioteki SignalR zależności OWIN zostaną automatycznie zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="9695f-195">In a future release of SignalR, OWIN dependencies will be automatically updated.</span></span>
3. <span data-ttu-id="9695f-196">W **Eksploratora rozwiązań**, rozwiń węzeł **skrypty** folderu i zwróć uwagę, że SignalR *js* pliki zostały dodane do rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="9695f-196">In **Solution Explorer**, expand the **Scripts** folder and notice that the SignalR *js* files were added to the solution.</span></span>

    <span data-ttu-id="9695f-197">![Odwołuje się do biblioteki SignalR JavaScript](real-time-web-applications-with-signalr/_static/image10.png "odwołuje się do biblioteki SignalR JavaScript")</span><span class="sxs-lookup"><span data-stu-id="9695f-197">![SignalR JavaScript references](real-time-web-applications-with-signalr/_static/image10.png "SignalR JavaScript references")</span></span>

    <span data-ttu-id="9695f-198">*Odwołania do biblioteki SignalR JavaScript*</span><span class="sxs-lookup"><span data-stu-id="9695f-198">*SignalR JavaScript references*</span></span>
4. <span data-ttu-id="9695f-199">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy **GeekQuiz** projektu, wybierz opcję **Dodaj** | **nowy Folder**i nadaj mu  **Koncentratory**.</span><span class="sxs-lookup"><span data-stu-id="9695f-199">In **Solution Explorer**, right-click the **GeekQuiz** project, select **Add** | **New Folder**, and name it **Hubs**.</span></span>
5. <span data-ttu-id="9695f-200">Kliknij prawym przyciskiem myszy **Hubs** i wybierz polecenie **Dodaj | Nowy element**.</span><span class="sxs-lookup"><span data-stu-id="9695f-200">Right-click the **Hubs** folder and select **Add | New Item**.</span></span>

    <span data-ttu-id="9695f-201">![Dodaj nowy element](real-time-web-applications-with-signalr/_static/image11.png "Dodaj nowy element")</span><span class="sxs-lookup"><span data-stu-id="9695f-201">![Add new item](real-time-web-applications-with-signalr/_static/image11.png "Add new item")</span></span>

    <span data-ttu-id="9695f-202">*Dodaj nowy element*</span><span class="sxs-lookup"><span data-stu-id="9695f-202">*Add new item*</span></span>
6. <span data-ttu-id="9695f-203">W **Dodaj nowy element** okno dialogowe, wybierz opcję **Visual C# | W sieci Web | SignalR** węzła w okienku po lewej stronie wybierz **klasa Centrum SignalR (v2)** w środkowym okienku, nadaj plikowi nazwę **StatisticsHub.cs** i kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="9695f-203">In the **Add New Item** dialog box, select the **Visual C# | Web | SignalR** node in the left pane, select **SignalR Hub Class (v2)** from the center pane, name the file **StatisticsHub.cs** and click **Add**.</span></span>

    <span data-ttu-id="9695f-204">![Okno dialogowe Dodaj nowy element](real-time-web-applications-with-signalr/_static/image12.png "okno dialogowe Dodaj nowy element")</span><span class="sxs-lookup"><span data-stu-id="9695f-204">![Add new item dialog box](real-time-web-applications-with-signalr/_static/image12.png "Add new item dialog box")</span></span>

    <span data-ttu-id="9695f-205">*Dodaj nowy element, okno dialogowe*</span><span class="sxs-lookup"><span data-stu-id="9695f-205">*Add new item dialog box*</span></span>
7. <span data-ttu-id="9695f-206">Zastąp kod w **StatisticsHub** klasy z następującym kodem.</span><span class="sxs-lookup"><span data-stu-id="9695f-206">Replace the code in the **StatisticsHub** class with the following code.</span></span>

    <span data-ttu-id="9695f-207">(Code Snippet — *StatisticsHubClass RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-207">(Code Snippet - *RealTimeSignalR - Ex1 - StatisticsHubClass*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample3.cs)]
8. <span data-ttu-id="9695f-208">Otwórz **Startup.cs** i Dodaj następujący wiersz na końcu **konfiguracji** metody.</span><span class="sxs-lookup"><span data-stu-id="9695f-208">Open **Startup.cs** and add the following line at the end of the **Configuration** method.</span></span>

    <span data-ttu-id="9695f-209">(Code Snippet — *MapSignalR RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-209">(Code Snippet - *RealTimeSignalR - Ex1 - MapSignalR*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample4.cs)]
9. <span data-ttu-id="9695f-210">Otwórz **StatisticsService.cs** stronie wewnątrz **usług** folderu i dodaj następujące dyrektywy using.</span><span class="sxs-lookup"><span data-stu-id="9695f-210">Open the **StatisticsService.cs** page inside the **Services** folder and add the following using directives.</span></span>

    <span data-ttu-id="9695f-211">(Code Snippet — *UsingDirectives RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-211">(Code Snippet - *RealTimeSignalR - Ex1 - UsingDirectives*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample5.cs)]
10. <span data-ttu-id="9695f-212">Aby powiadomić podłączonych klientów aktualizacji, należy najpierw pobrać **kontekstu** obiektu dla bieżącego połączenia.</span><span class="sxs-lookup"><span data-stu-id="9695f-212">To notify connected clients of updates, you first retrieve a **Context** object for the current connection.</span></span> <span data-ttu-id="9695f-213">**Centrum** obiekt zawiera metody służące do wysyłania komunikatów do pojedynczego klienta lub emisji do wszystkich połączonych klientów.</span><span class="sxs-lookup"><span data-stu-id="9695f-213">The **Hub** object contains methods to send messages to a single client or broadcast to all connected clients.</span></span> <span data-ttu-id="9695f-214">Dodaj następującą metodę do **StatisticsService** klasy wysyłać dane statystyk.</span><span class="sxs-lookup"><span data-stu-id="9695f-214">Add the following method to the **StatisticsService** class to broadcast the statistics data.</span></span>

    <span data-ttu-id="9695f-215">(Code Snippet — *NotifyUpdatesMethod RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-215">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesMethod*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample6.cs)]

    > [!NOTE]
    > <span data-ttu-id="9695f-216">W powyższym kodzie używane są nazwa dowolnego metody do wywołania funkcji na komputerze klienckim (czyli: *updateStatistics*).</span><span class="sxs-lookup"><span data-stu-id="9695f-216">In the code above, you are using an arbitrary method name to call a function on the client (i.e.: *updateStatistics*).</span></span> <span data-ttu-id="9695f-217">Nazwa metody, które określisz, jest interpretowany jako obiekt dynamiczny, co oznacza, że brak funkcji IntelliSense i weryfikacji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-217">The method name that you specify is interpreted as a dynamic object, which means there is no IntelliSense or compile-time validation for it.</span></span> <span data-ttu-id="9695f-218">Wyrażenie jest obliczane w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="9695f-218">The expression is evaluated at run time.</span></span> <span data-ttu-id="9695f-219">Podczas wywołania metody które wykonuje, SignalR wysyła nazwy metody i wartości parametrów do klienta.</span><span class="sxs-lookup"><span data-stu-id="9695f-219">When the method call executes, SignalR sends the method name and the parameter values to the client.</span></span> <span data-ttu-id="9695f-220">Jeśli klient ma metodę, która jest zgodna z nazwą, Metoda ta jest wywoływana, i wartości parametrów są przekazywane do niego.</span><span class="sxs-lookup"><span data-stu-id="9695f-220">If the client has a method that matches the name, that method is called and the parameter values are passed to it.</span></span> <span data-ttu-id="9695f-221">Jeśli odpowiadającej metody znajduje się na komputerze klienckim, zgłaszany jest błąd braku.</span><span class="sxs-lookup"><span data-stu-id="9695f-221">If no matching method is found on the client, no error is raised.</span></span> <span data-ttu-id="9695f-222">Aby uzyskać więcej informacji, zobacz [Podręcznik interfejsu API centrów SignalR platformy ASP.NET](../guide-to-the-api/hubs-api-guide-server.md).</span><span class="sxs-lookup"><span data-stu-id="9695f-222">For more information, refer to [ASP.NET SignalR Hubs API Guide](../guide-to-the-api/hubs-api-guide-server.md).</span></span>
11. <span data-ttu-id="9695f-223">Otwórz **TriviaController.cs** stronie wewnątrz **kontrolerów** folderu i dodaj następujące dyrektywy using.</span><span class="sxs-lookup"><span data-stu-id="9695f-223">Open the **TriviaController.cs** page inside the **Controllers** folder and add the following using directives.</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample7.cs)]
12. <span data-ttu-id="9695f-224">Dodaj następujący wyróżniony kod do **wpis** metody akcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-224">Add the following highlighted code to the **Post** action method.</span></span>

    <span data-ttu-id="9695f-225">(Code Snippet — *NotifyUpdatesCall RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-225">(Code Snippet - *RealTimeSignalR - Ex1 - NotifyUpdatesCall*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample8.cs)]
13. <span data-ttu-id="9695f-226">Otwórz **Statistics.cshtml** stronie wewnątrz **widoków | Strona główna** folderu.</span><span class="sxs-lookup"><span data-stu-id="9695f-226">Open the **Statistics.cshtml** page inside the **Views | Home** folder.</span></span> <span data-ttu-id="9695f-227">Znajdź **skrypty** sekcji i dodaj następujące odwołania do skryptu na początku sekcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-227">Locate the **Scripts** section and add the following script references at the beginning of the section.</span></span>

    <span data-ttu-id="9695f-228">(Code Snippet — *SignalRScriptReferences RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-228">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRScriptReferences*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample9.cshtml)]

    > [!NOTE]
    > <span data-ttu-id="9695f-229">Po dodaniu SignalR i inne biblioteki skryptu do projektu programu Visual Studio, Menedżera pakietów może zainstalować wersję pliku skryptu SignalR, która jest nowsza niż wersja przedstawione w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="9695f-229">When you add SignalR and other script libraries to your Visual Studio project, the Package Manager might install a version of the SignalR script file that is more recent than the version shown in this topic.</span></span> <span data-ttu-id="9695f-230">Upewnij się, że odwołanie do skryptu w kodzie zgodny z wersją biblioteki skryptów zainstalowana w twoim projekcie.</span><span class="sxs-lookup"><span data-stu-id="9695f-230">Make sure that the script reference in your code matches the version of the script library installed in your project.</span></span>
14. <span data-ttu-id="9695f-231">Dodaj następujący wyróżniony kod, aby nawiązać połączenie klienta do Centrum SignalR i zaktualizować dane statystyk, po odebraniu nowej wiadomości z Centrum.</span><span class="sxs-lookup"><span data-stu-id="9695f-231">Add the following highlighted code to connect the client to the SignalR hub and update the statistics data when a new message is received from the hub.</span></span>

    <span data-ttu-id="9695f-232">(Code Snippet — *SignalRClientCode RealTimeSignalR - Ex1 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-232">(Code Snippet - *RealTimeSignalR - Ex1 - SignalRClientCode*)</span></span>

    [!code-cshtml[Main](real-time-web-applications-with-signalr/samples/sample10.cshtml)]

    <span data-ttu-id="9695f-233">W tym kodzie są serwer Proxy koncentratora do tworzenia i rejestrowania programu obsługi zdarzeń, aby nasłuchiwać komunikatów wysłanych przez serwer.</span><span class="sxs-lookup"><span data-stu-id="9695f-233">In this code, you are creating a Hub Proxy and registering an event handler to listen for messages sent by the server.</span></span> <span data-ttu-id="9695f-234">W takim przypadku możesz nasłuchiwać komunikatów wysyłanych za pośrednictwem *updateStatistics* metody.</span><span class="sxs-lookup"><span data-stu-id="9695f-234">In this case, you listen for messages sent through the *updateStatistics* method.</span></span>

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a><span data-ttu-id="9695f-235">Zadanie 3 — uruchamianie rozwiązania</span><span class="sxs-lookup"><span data-stu-id="9695f-235">Task 3 – Running the Solution</span></span>

<span data-ttu-id="9695f-236">W tym zadaniu należy uruchomić rozwiązanie, aby sprawdzić, że widok statystyki jest aktualizowana automatycznie po udzieleniu odpowiedzi na nowe pytanie przy użyciu SignalR.</span><span class="sxs-lookup"><span data-stu-id="9695f-236">In this task, you will run the solution to verify that the statistics view is updated automatically using SignalR after answering a new question.</span></span>

1. <span data-ttu-id="9695f-237">Naciśnij klawisz **F5** Aby uruchomić rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-237">Press **F5** to run the solution.</span></span>

    > [!NOTE]
    > <span data-ttu-id="9695f-238">Jeśli jeszcze nie zalogował się do aplikacji, zaloguj się użytkownik, który został utworzony w zadaniu 1.</span><span class="sxs-lookup"><span data-stu-id="9695f-238">If not already logged in to the application, log in with the user you created in Task 1.</span></span>
2. <span data-ttu-id="9695f-239">Otwórz **statystyki** strony w nowym oknie, a następnie umieść **Home** strony i **statystyki** stronie side-by-side, tak jak w zadaniu 1.</span><span class="sxs-lookup"><span data-stu-id="9695f-239">Open the **Statistics** page in a new window and put the **Home** page and **Statistics** page side-by-side as you did in Task 1.</span></span>
3. <span data-ttu-id="9695f-240">W **Home** strony, Odpowiedz na pytanie, klikając jedną z opcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-240">In the **Home** page, answer the question by clicking one of the options.</span></span>

    <span data-ttu-id="9695f-241">![Odpowiadanie na następne pytanie](real-time-web-applications-with-signalr/_static/image13.png "odpowiadanie na następne pytanie")</span><span class="sxs-lookup"><span data-stu-id="9695f-241">![Answering another question](real-time-web-applications-with-signalr/_static/image13.png "Answering another question")</span></span>

    <span data-ttu-id="9695f-242">*Odpowiadanie na następne pytanie*</span><span class="sxs-lookup"><span data-stu-id="9695f-242">*Answering another question*</span></span>
4. <span data-ttu-id="9695f-243">Po kliknięciu jednego z przycisków, powinna zostać wyświetlona odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="9695f-243">After clicking one of the buttons, the answer should appear.</span></span> <span data-ttu-id="9695f-244">Należy zauważyć, że informacje statystyczne na stronie jest aktualizowane automatycznie po udzieleniu odpowiedzi na pytanie przy użyciu zaktualizowanych informacji bez konieczności odświeżenia całej strony.</span><span class="sxs-lookup"><span data-stu-id="9695f-244">Notice that the Statistics information on the page is updated automatically after answering the question with the updated information without the need to refresh the entire page.</span></span>

    <span data-ttu-id="9695f-245">![Strona statystyk odświeżone po odpowiedzi](real-time-web-applications-with-signalr/_static/image14.png "strona statystyk odświeżone po odpowiedzi")</span><span class="sxs-lookup"><span data-stu-id="9695f-245">![Statistics page refreshed after answer](real-time-web-applications-with-signalr/_static/image14.png "Statistics page refreshed after answer")</span></span>

    <span data-ttu-id="9695f-246">*Strona statystyk odświeżone po odpowiedzi*</span><span class="sxs-lookup"><span data-stu-id="9695f-246">*Statistics page refreshed after answer*</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-scaling-out-using-sql-server"></a><span data-ttu-id="9695f-247">Ćwiczenie 2: Skalowanie w poziomie przy użyciu programu SQL Server</span><span class="sxs-lookup"><span data-stu-id="9695f-247">Exercise 2: Scaling Out Using SQL Server</span></span>

<span data-ttu-id="9695f-248">Podczas skalowania aplikacji sieci web, zazwyczaj można wybrać między *skalowanie w górę* i *skalowanie w poziomie* opcje.</span><span class="sxs-lookup"><span data-stu-id="9695f-248">When scaling a web application, you can generally choose between *scaling up* and *scaling out* options.</span></span> <span data-ttu-id="9695f-249">*Skalowanie w górę* oznacza, że korzystasz z większych serwera więcej zasobów (procesor CPU, pamięci RAM, itp.), podczas *skalowanie w poziomie* oznacza dodawanie kolejnych serwerów w celu obsługi obciążenia.</span><span class="sxs-lookup"><span data-stu-id="9695f-249">*Scale up* means using a larger server, with more resources (CPU, RAM, etc.) while *scale out* means adding more servers to handle the load.</span></span> <span data-ttu-id="9695f-250">Problem z jego polega na tym, że klienci mogą uzyskać kierowane do różnych serwerów.</span><span class="sxs-lookup"><span data-stu-id="9695f-250">The problem with the latter is that the clients can get routed to different servers.</span></span> <span data-ttu-id="9695f-251">Klient, który jest podłączony do jednego serwera nie będą otrzymywać wiadomości wysłanych z innego serwera.</span><span class="sxs-lookup"><span data-stu-id="9695f-251">A client that is connected to one server will not receive messages sent from another server.</span></span>

<span data-ttu-id="9695f-252">Te problemy można rozwiązać za pomocą składnik o nazwie *płyty montażowej*w celu przekazywania komunikatów między serwerami.</span><span class="sxs-lookup"><span data-stu-id="9695f-252">You can solve these issues by using a component called *backplane*, to forward messages between servers.</span></span> <span data-ttu-id="9695f-253">Z płyty montażowej włączone każde wystąpienie aplikacji wysyła komunikaty do systemu backplane. Ponadto systemu backplane przekazuje je do innych wystąpień aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-253">With a backplane enabled, each application instance sends messages to the backplane, and the backplane forwards them to the other application instances.</span></span>

<span data-ttu-id="9695f-254">Obecnie istnieją trzy typy montażowych dla elementu SignalR:</span><span class="sxs-lookup"><span data-stu-id="9695f-254">There are currently three types of backplanes for SignalR:</span></span>

- <span data-ttu-id="9695f-255">**Windows Azure Service Bus**.</span><span class="sxs-lookup"><span data-stu-id="9695f-255">**Windows Azure Service Bus**.</span></span> <span data-ttu-id="9695f-256">Service Bus to infrastruktura obsługi komunikatów, umożliwiający składników do wysyłania wiadomości luźno powiązane.</span><span class="sxs-lookup"><span data-stu-id="9695f-256">Service Bus is a messaging infrastructure that allows components to send loosely coupled messages.</span></span>
- <span data-ttu-id="9695f-257">**SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="9695f-257">**SQL Server**.</span></span> <span data-ttu-id="9695f-258">Płyty montażowej programu SQL Server zapisuje komunikaty do tabel SQL.</span><span class="sxs-lookup"><span data-stu-id="9695f-258">The SQL Server backplane writes messages to SQL tables.</span></span> <span data-ttu-id="9695f-259">Systemu backplane używa brokera usług dla komunikatów wydajne.</span><span class="sxs-lookup"><span data-stu-id="9695f-259">The backplane uses Service Broker for efficient messaging.</span></span> <span data-ttu-id="9695f-260">Jednak działa Jeśli programu Service Broker nie jest włączona.</span><span class="sxs-lookup"><span data-stu-id="9695f-260">However, it also works if Service Broker is not enabled.</span></span>
- <span data-ttu-id="9695f-261">**Redis**.</span><span class="sxs-lookup"><span data-stu-id="9695f-261">**Redis**.</span></span> <span data-ttu-id="9695f-262">Redis jest przechowywanie par klucz wartość w pamięci.</span><span class="sxs-lookup"><span data-stu-id="9695f-262">Redis is an in-memory key-value store.</span></span> <span data-ttu-id="9695f-263">Usługa redis obsługuje wzorzec publikowania/subskrybowania ("pub/sub") do wysyłania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="9695f-263">Redis supports a publish/subscribe ("pub/sub") pattern for sending messages.</span></span>

<span data-ttu-id="9695f-264">Każdy komunikat jest wysyłany za pośrednictwem magistrali komunikatów.</span><span class="sxs-lookup"><span data-stu-id="9695f-264">Every message is sent through a message bus.</span></span> <span data-ttu-id="9695f-265">Implementuje w magistrali komunikatów [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interfejs, który udostępnia abstrakcji publikowania/subskrybowania.</span><span class="sxs-lookup"><span data-stu-id="9695f-265">A message bus implements the [IMessageBus](https://msdn.microsoft.com/library/microsoft.aspnet.signalr.messaging.imessagebus(v=vs.100).aspx) interface, which provides a publish/subscribe abstraction.</span></span> <span data-ttu-id="9695f-266">Montażowych pracy, zastępując domyślne **IMessageBus** z magistralą przeznaczone dla tego systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-266">The backplanes work by replacing the default **IMessageBus** with a bus designed for that backplane.</span></span>

<span data-ttu-id="9695f-267">Każde wystąpienie serwera łączy do systemu backplane za pośrednictwem magistrali.</span><span class="sxs-lookup"><span data-stu-id="9695f-267">Each server instance connects to the backplane through the bus.</span></span> <span data-ttu-id="9695f-268">Po wysłaniu komunikatu przejdzie do systemu backplane, a następnie wysyła je do każdego serwera systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-268">When a message is sent, it goes to the backplane, and the backplane sends it to every server.</span></span> <span data-ttu-id="9695f-269">Gdy serwer otrzymuje komunikat z systemu backplane, wiadomości są przechowywane w lokalnej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="9695f-269">When a server receives a message from the backplane, it stores the message in its local cache.</span></span> <span data-ttu-id="9695f-270">Serwer następnie dostarcza komunikaty do klientów z lokalnej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="9695f-270">The server then delivers messages to clients from its local cache.</span></span>

<span data-ttu-id="9695f-271">Aby uzyskać więcej informacji na temat sposobu płyty montażowej SignalR działania, przeczytaj ten artykuł [artykułu](../performance/scaleout-in-signalr.md).</span><span class="sxs-lookup"><span data-stu-id="9695f-271">For more information about how the SignalR backplane works, read this [article](../performance/scaleout-in-signalr.md).</span></span>

> [!NOTE]
> <span data-ttu-id="9695f-272">Istnieją sytuacje, w którym płyty montażowej może stać się wąskim gardłem.</span><span class="sxs-lookup"><span data-stu-id="9695f-272">There are some scenarios where a backplane can become a bottleneck.</span></span> <span data-ttu-id="9695f-273">Poniżej przedstawiono kilka typowych scenariuszy SignalR:</span><span class="sxs-lookup"><span data-stu-id="9695f-273">Here are some typical SignalR scenarios:</span></span>
> 
> - <span data-ttu-id="9695f-274">[Emisja serwera](tutorial-server-broadcast-with-signalr.md) (np. giełdowej): Montażowych działa dobrze sprawdza się w tym scenariuszu, ponieważ serwer kontroluje szybkość, z jaką komunikaty są wysyłane.</span><span class="sxs-lookup"><span data-stu-id="9695f-274">[Server broadcast](tutorial-server-broadcast-with-signalr.md) (e.g., stock ticker): Backplanes work well for this scenario, because the server controls the rate at which messages are sent.</span></span>
> - <span data-ttu-id="9695f-275">[Klient — klient](tutorial-getting-started-with-signalr.md) (np. chat): W tym scenariuszu systemu backplane może być "wąskie gardło", jeśli liczba komunikatów jest skalowana o liczbie klientów. oznacza to jeśli liczba komunikatów rośnie dołączyć proporcjonalnie, ponieważ coraz więcej klientów.</span><span class="sxs-lookup"><span data-stu-id="9695f-275">[Client-to-client](tutorial-getting-started-with-signalr.md) (e.g., chat): In this scenario, the backplane might be a bottleneck if the number of messages scales with the number of clients; that is, if the rate of messages grows proportionally as more clients join.</span></span>
> - <span data-ttu-id="9695f-276">[O wysokiej częstotliwości w czasie rzeczywistym](tutorial-high-frequency-realtime-with-signalr.md) (np. w czasie rzeczywistym gry): W tym scenariuszu nie zaleca się systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-276">[High-frequency realtime](tutorial-high-frequency-realtime-with-signalr.md) (e.g., real-time games): A backplane is not recommended for this scenario.</span></span>

<span data-ttu-id="9695f-277">W tym ćwiczeniu zostanie użyty **programu SQL Server** do dystrybucji wiadomości między **Quiz maniaków komputerowych** aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-277">In this exercise, you will use **SQL Server** to distribute messages across the **Geek Quiz** application.</span></span> <span data-ttu-id="9695f-278">Te zadania będą uruchamiane na maszynie jeden test dowiesz się, jak ustawić konfigurację, ale w celu uzyskania pełnego wpływu, konieczne będzie wdrożenie aplikacji SignalR do co najmniej dwóch serwerów.</span><span class="sxs-lookup"><span data-stu-id="9695f-278">You will run these tasks on a single test machine to learn how to set up the configuration, but in order to get the full effect, you will need to deploy the SignalR application to two or more servers.</span></span> <span data-ttu-id="9695f-279">SQL Server należy również zainstalować na jednym serwerze lub na oddzielnym serwerze dedykowanym.</span><span class="sxs-lookup"><span data-stu-id="9695f-279">You must also install SQL Server on one of the servers, or on a separate dedicated server.</span></span>

![Skalowanie w poziomie przy użyciu programu SQL Server diagramu](real-time-web-applications-with-signalr/_static/image15.png)

<a id="Ex2Task1"></a>
#### <a name="task-1---understanding-the-scenario"></a><span data-ttu-id="9695f-281">Zadanie 1 — Opis scenariusza</span><span class="sxs-lookup"><span data-stu-id="9695f-281">Task 1 - Understanding the Scenario</span></span>

<span data-ttu-id="9695f-282">W tym zadaniu zostanie uruchomiony 2 wystąpienia **Quiz maniaków komputerowych** symulowania IIS wielu wystąpień na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="9695f-282">In this task, you will run 2 instances of **Geek Quiz** simulating multiple IIS instances on your local machine.</span></span> <span data-ttu-id="9695f-283">W tym scenariuszu podczas odpowiadania na pytania elementy towarzyszące składni z jednej aplikacji nie zostaną powiadomieni aktualizacji, na stronie statystyki drugie wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="9695f-283">In this scenario, when answering trivia questions on one application, update won't be notified on the statistics page of the second instance.</span></span> <span data-ttu-id="9695f-284">Tej symulacji przypomina środowisko, w którym aplikacja jest wdrażana w wielu wystąpieniach i komunikować się z nimi przy użyciu modułu równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="9695f-284">This simulation resembles an environment where your application is deployed on multiple instances and using a load balancer to communicate with them.</span></span>

1. <span data-ttu-id="9695f-285">Otwórz **Begin.sln** rozwiązanie znajduje się w **/Ex2-ScalingOutWithSQLServer/początkowy w źródle** folderu.</span><span class="sxs-lookup"><span data-stu-id="9695f-285">Open the **Begin.sln** solution located in the **Source/Ex2-ScalingOutWithSQLServer/Begin** folder.</span></span> <span data-ttu-id="9695f-286">Po załadowaniu można zauważyć na **Eksploratora serwera** że rozwiązanie zawiera dwa projekty o identycznych struktur, ale o innej nazwy.</span><span class="sxs-lookup"><span data-stu-id="9695f-286">Once loaded, you will notice on the **Server Explorer** that the solution has two projects with identical structures but different names.</span></span> <span data-ttu-id="9695f-287">Spowoduje to zasymulować, uruchomione dwa wystąpienia tej samej aplikacji na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="9695f-287">This will simulate running two instances of the same application on your local machine.</span></span>

    <span data-ttu-id="9695f-288">![Rozpocznij rozwiązania, symulując 2 wystąpienia Quiz maniaków komputerowych](real-time-web-applications-with-signalr/_static/image16.png "rozpocząć rozwiązania, symulując 2 wystąpienia Quiz maniaków komputerowych")</span><span class="sxs-lookup"><span data-stu-id="9695f-288">![Begin Solution Simulating 2 Instances of Geek Quiz](real-time-web-applications-with-signalr/_static/image16.png "Begin Solution Simulating 2 Instances of Geek Quiz")</span></span>

    <span data-ttu-id="9695f-289">*Rozpocznij rozwiązania, symulując 2 wystąpienia Quiz maniaków komputerowych*</span><span class="sxs-lookup"><span data-stu-id="9695f-289">*Begin Solution Simulating 2 Instances of Geek Quiz*</span></span>
2. <span data-ttu-id="9695f-290">Otwórz stronę właściwości rozwiązania kliknij prawym przyciskiem myszy węzeł rozwiązania i wybierając **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="9695f-290">Open the properties page of the solution by right-clicking the solution node and selecting **Properties**.</span></span> <span data-ttu-id="9695f-291">W obszarze **projekt startowy**, wybierz opcję **wiele projektów startowych** i zmień **akcji** wartość dla obu projektów na *Start*.</span><span class="sxs-lookup"><span data-stu-id="9695f-291">Under **Startup Project**, select **Multiple startup projects** and change the **Action** value for both projects to *Start*.</span></span>

    <span data-ttu-id="9695f-292">![Uruchomienie wielu projektów](real-time-web-applications-with-signalr/_static/image17.png "uruchomienie wielu projektów")</span><span class="sxs-lookup"><span data-stu-id="9695f-292">![Starting Multiple Projects](real-time-web-applications-with-signalr/_static/image17.png "Starting Multiple Projects")</span></span>

    <span data-ttu-id="9695f-293">*Uruchomienie wielu projektów*</span><span class="sxs-lookup"><span data-stu-id="9695f-293">*Starting Multiple Projects*</span></span>
3. <span data-ttu-id="9695f-294">Naciśnij klawisz **F5** Aby uruchomić rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-294">Press **F5** to run the solution.</span></span> <span data-ttu-id="9695f-295">Aplikacja uruchomi dwa wystąpienia **Quiz maniaków komputerowych** w innych portów, symulując wielu wystąpień tej samej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-295">The application will launch two instances of **Geek Quiz** in different ports, simulating multiple instances of the same application.</span></span> <span data-ttu-id="9695f-296">Po lewej stronie oraz inne po prawej stronie ekranu, Przypina jeden z przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="9695f-296">Pin one of the browsers on left and the other on the right of your screen.</span></span> <span data-ttu-id="9695f-297">Zaloguj się przy użyciu poświadczeń lub rejestrowanie nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="9695f-297">Log in with your credentials or register a new user.</span></span> <span data-ttu-id="9695f-298">Po zalogowaniu nadal na stronie elementy towarzyszące składni po lewej stronie i przejdź do **statystyki** strony w przeglądarce po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="9695f-298">Once logged in, keep the Trivia page on the left and go to the **Statistics** page in the browser on the right.</span></span>

    ![Quiz maniaków komputerowych obok siebie](real-time-web-applications-with-signalr/_static/image18.png)

    <span data-ttu-id="9695f-300">*Quiz maniaków komputerowych obok siebie*</span><span class="sxs-lookup"><span data-stu-id="9695f-300">*Geek Quiz Side by Side*</span></span>

    ![Quiz maniaków komputerowych w różnych portów](real-time-web-applications-with-signalr/_static/image19.png)

    <span data-ttu-id="9695f-302">*Quiz maniaków komputerowych w różnych portów*</span><span class="sxs-lookup"><span data-stu-id="9695f-302">*Geek Quiz in Different Ports*</span></span>
4. <span data-ttu-id="9695f-303">Uruchom odpowiadanie na pytania w przeglądarce po lewej stronie i będzie można zauważyć, że **statystyki** strony w przeglądarce prawym nie jest aktualizowana.</span><span class="sxs-lookup"><span data-stu-id="9695f-303">Start answering questions in the left browser and you will notice that the **Statistics** page in the right browser is not being updated.</span></span> <span data-ttu-id="9695f-304">Jest to spowodowane **SignalR** używa lokalnej pamięci podręcznej dystrybuować komunikaty do swoich klientów i symuluje wiele wystąpień tego scenariusza, w związku z tym pamięci podręcznej nie jest udostępniana między nimi.</span><span class="sxs-lookup"><span data-stu-id="9695f-304">This is because **SignalR** uses a local cache to distribute messages across their clients and this scenario is simulating multiple instances, therefore the cache is not shared between them.</span></span> <span data-ttu-id="9695f-305">Sprawdź, czy **SignalR** działa przez testowanie te same czynności, ale przy użyciu pojedynczej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-305">You can verify that **SignalR** is working by testing the same steps but using a single app.</span></span> <span data-ttu-id="9695f-306">W następujących zadań, którą skonfigurujesz płyty montażowej do replikowania wiadomości między wystąpieniami.</span><span class="sxs-lookup"><span data-stu-id="9695f-306">In the following tasks you will configure a backplane to replicate the messages across instances.</span></span>
5. <span data-ttu-id="9695f-307">Wróć do programu Visual Studio i zatrzymać debugowanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-307">Go back to Visual Studio and stop debugging.</span></span>

<a id="Ex2Task2"></a>
#### <a name="task-2--creating-the-sql-server-backplane"></a><span data-ttu-id="9695f-308">Zadanie 2 — Tworzenie płyty montażowej serwera SQL</span><span class="sxs-lookup"><span data-stu-id="9695f-308">Task 2 – Creating the SQL Server Backplane</span></span>

<span data-ttu-id="9695f-309">W tym zadaniu utworzysz bazę danych, która będzie służyć jako płyty montażowej do **Quiz maniaków komputerowych** aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9695f-309">In this task, you will create a database that will serve as a backplane for the **Geek Quiz** application.</span></span> <span data-ttu-id="9695f-310">Użyjesz **Eksplorator obiektów SQL Server** przeglądania serwera i zainicjować bazy danych.</span><span class="sxs-lookup"><span data-stu-id="9695f-310">You will use **SQL Server Object Explorer** to browse your server and initialize the database.</span></span> <span data-ttu-id="9695f-311">Ponadto umożliwi **programu Service Broker**.</span><span class="sxs-lookup"><span data-stu-id="9695f-311">Additionally, you will enable the **Service Broker**.</span></span>

1. <span data-ttu-id="9695f-312">W **programu Visual Studio**, otwórz menu **widoku** i wybierz **Eksplorator obiektów SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="9695f-312">In **Visual Studio**, open menu **View** and select **SQL Server Object Explorer**.</span></span>
2. <span data-ttu-id="9695f-313">Nawiąż połączenie z wystąpieniem usługi LocalDB, klikając prawym przyciskiem myszy **programu SQL Server** węzła i wybierając polecenie **dodawania serwera SQL...**  opcji.</span><span class="sxs-lookup"><span data-stu-id="9695f-313">Connect to your LocalDB instance by right-clicking the **SQL Server** node and selecting **Add SQL Server...** option.</span></span>

    <span data-ttu-id="9695f-314">![Dodawanie wystąpienia programu SQL Server](real-time-web-applications-with-signalr/_static/image20.png "dodanie wystąpienia programu SQL Server")</span><span class="sxs-lookup"><span data-stu-id="9695f-314">![Adding a SQL Server Instance](real-time-web-applications-with-signalr/_static/image20.png "Adding a SQL Server Instance")</span></span>

    <span data-ttu-id="9695f-315">*Dodawanie wystąpienia programu SQL Server do Eksplorator obiektów SQL Server*</span><span class="sxs-lookup"><span data-stu-id="9695f-315">*Adding a SQL Server instance to SQL Server Object Explorer*</span></span>
3. <span data-ttu-id="9695f-316">Ustaw **nazwy serwera** do *(localdb) \v11.0* i pozostawić **uwierzytelniania Windows** z trybem uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="9695f-316">Set the **server name** to *(localdb)\v11.0* and leave **Windows Authentication** as your authentication mode.</span></span> <span data-ttu-id="9695f-317">Kliknij przycisk **Connect** aby kontynuować.</span><span class="sxs-lookup"><span data-stu-id="9695f-317">Click **Connect** to continue.</span></span>

    <span data-ttu-id="9695f-318">![Nawiązywanie połączenia z LocalDB](real-time-web-applications-with-signalr/_static/image21.png "nawiązywania połączenia z LocalDB")</span><span class="sxs-lookup"><span data-stu-id="9695f-318">![Connecting to LocalDB](real-time-web-applications-with-signalr/_static/image21.png "Connecting to LocalDB")</span></span>

    <span data-ttu-id="9695f-319">*Nawiązywanie połączenia z LocalDB*</span><span class="sxs-lookup"><span data-stu-id="9695f-319">*Connecting to LocalDB*</span></span>
4. <span data-ttu-id="9695f-320">Skoro masz połączenie z wystąpieniem LocalDB, należy utworzyć bazę danych, która będzie reprezentowała płyty montażowej programu SQL Server dla elementu SignalR.</span><span class="sxs-lookup"><span data-stu-id="9695f-320">Now that you are connected to your LocalDB instance, you will need to create a database that will represent the SQL Server backplane for SignalR.</span></span> <span data-ttu-id="9695f-321">Aby to zrobić, kliknij prawym przyciskiem myszy **baz danych** a następnie wybierz węzeł **Dodaj nową bazę danych**.</span><span class="sxs-lookup"><span data-stu-id="9695f-321">To do this, right-click the **Databases** node and select **Add New Database**.</span></span>

    <span data-ttu-id="9695f-322">![Dodawanie nowej bazy danych](real-time-web-applications-with-signalr/_static/image22.png "dodanie nowej bazy danych")</span><span class="sxs-lookup"><span data-stu-id="9695f-322">![Adding a new database](real-time-web-applications-with-signalr/_static/image22.png "Adding a new database")</span></span>

    <span data-ttu-id="9695f-323">*Dodawanie nowej bazy danych*</span><span class="sxs-lookup"><span data-stu-id="9695f-323">*Adding a new database*</span></span>
5. <span data-ttu-id="9695f-324">Ustaw nazwę bazy danych na *SignalR* i kliknij przycisk **OK** do jego utworzenia.</span><span class="sxs-lookup"><span data-stu-id="9695f-324">Set the database name to *SignalR* and click **OK** to create it.</span></span>

    <span data-ttu-id="9695f-325">![Tworzenie bazy danych SignalR](real-time-web-applications-with-signalr/_static/image23.png "tworzenie bazy danych biblioteki SignalR")</span><span class="sxs-lookup"><span data-stu-id="9695f-325">![Creating the SignalR database](real-time-web-applications-with-signalr/_static/image23.png "Creating the SignalR database")</span></span>

    <span data-ttu-id="9695f-326">*Tworzenie bazy danych biblioteki SignalR*</span><span class="sxs-lookup"><span data-stu-id="9695f-326">*Creating the SignalR database*</span></span>

    > [!NOTE]
    > <span data-ttu-id="9695f-327">Możesz wybrać dowolną nazwę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="9695f-327">You can choose any name for the database.</span></span>
6. <span data-ttu-id="9695f-328">Do systemu backplane wydajniej otrzymywać aktualizacje, zalecane jest aby włączyć brokera usługi dla bazy danych.</span><span class="sxs-lookup"><span data-stu-id="9695f-328">To receive updates more efficiently from the backplane, it is recommended to enable Service Broker for the database.</span></span> <span data-ttu-id="9695f-329">Usługa Service Broker zapewnia macierzystą obsługę komunikatów i kolejkowania w programie SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9695f-329">Service Broker provides native support for messaging and queuing in SQL Server.</span></span> <span data-ttu-id="9695f-330">Bez programu Service Broker działa również systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-330">The backplane also works without Service Broker.</span></span> <span data-ttu-id="9695f-331">Otwórz nowe zapytanie, klikając prawym przyciskiem myszy bazę danych i wybierz pozycję **nowe zapytanie**.</span><span class="sxs-lookup"><span data-stu-id="9695f-331">Open a new query by right-clicking the database and select **New Query**.</span></span>

    <span data-ttu-id="9695f-332">![Otwieranie nowej kwerendy](real-time-web-applications-with-signalr/_static/image24.png "Otwieranie nowej kwerendy")</span><span class="sxs-lookup"><span data-stu-id="9695f-332">![Opening a New Query](real-time-web-applications-with-signalr/_static/image24.png "Opening a New Query")</span></span>

    <span data-ttu-id="9695f-333">*Otwieranie nowej kwerendy*</span><span class="sxs-lookup"><span data-stu-id="9695f-333">*Opening a New Query*</span></span>
7. <span data-ttu-id="9695f-334">Aby sprawdzić, czy programu Service Broker jest włączona, należy zbadać **jest\_brokera\_włączone** kolumny w **sys.databases** widok katalogu.</span><span class="sxs-lookup"><span data-stu-id="9695f-334">To check whether Service Broker is enabled, query the **is\_broker\_enabled** column in the **sys.databases** catalog view.</span></span> <span data-ttu-id="9695f-335">Uruchom następujący skrypt w oknie zapytania ostatnio otwarte.</span><span class="sxs-lookup"><span data-stu-id="9695f-335">Execute the following script in the recently opened query window.</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample11.sql)]

    <span data-ttu-id="9695f-336">![Badanie stanu brokera usługi](real-time-web-applications-with-signalr/_static/image25.png "badanie stanu brokera usług")</span><span class="sxs-lookup"><span data-stu-id="9695f-336">![Querying the Service Broker Status](real-time-web-applications-with-signalr/_static/image25.png "Querying the Service Broker Status")</span></span>

    <span data-ttu-id="9695f-337">*Badanie stanu brokera usług*</span><span class="sxs-lookup"><span data-stu-id="9695f-337">*Querying the Service Broker Status*</span></span>
8. <span data-ttu-id="9695f-338">Jeśli wartość **jest\_brokera\_włączone** kolumna w bazie danych jest &quot;0&quot;, użyj następującego polecenia, aby go włączyć.</span><span class="sxs-lookup"><span data-stu-id="9695f-338">If the value of the **is\_broker\_enabled** column in your database is &quot;0&quot;, use the following command to enable it.</span></span> <span data-ttu-id="9695f-339">Zastąp **&lt;YOUR DATABASE&gt;** o nazwie jest ustawiany podczas tworzenia bazy danych (np.: SignalR).</span><span class="sxs-lookup"><span data-stu-id="9695f-339">Replace **&lt;YOUR-DATABASE&gt;** with the name you set when creating the database (e.g.: SignalR).</span></span>

    [!code-sql[Main](real-time-web-applications-with-signalr/samples/sample12.sql)]

    <span data-ttu-id="9695f-340">![Włączanie programu Service Broker](real-time-web-applications-with-signalr/_static/image26.png "włączenie brokera usług")</span><span class="sxs-lookup"><span data-stu-id="9695f-340">![Enabling Service Broker](real-time-web-applications-with-signalr/_static/image26.png "Enabling Service Broker")</span></span>

    <span data-ttu-id="9695f-341">*Włączanie programu Service Broker*</span><span class="sxs-lookup"><span data-stu-id="9695f-341">*Enabling Service Broker*</span></span>

    > [!NOTE]
    > <span data-ttu-id="9695f-342">Jeśli wydaje się zakleszczenie, upewnij się, to zapytanie nie istnieją żadne aplikacje połączone z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="9695f-342">If this query appears to deadlock, make sure there are no applications connected to the DB.</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--configuring-the-signalr-application"></a><span data-ttu-id="9695f-343">Zadanie 3 — Konfigurowanie aplikacji SignalR</span><span class="sxs-lookup"><span data-stu-id="9695f-343">Task 3 – Configuring the SignalR Application</span></span>

<span data-ttu-id="9695f-344">W tym zadaniu skonfigurujesz **Quiz maniaków komputerowych** połączyć się z płyty montażowej programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9695f-344">In this task, you will configure **Geek Quiz** to connect to the SQL Server backplane.</span></span> <span data-ttu-id="9695f-345">Należy najpierw dodać **SignalR.SqlServer** pakietu NuGet i zestawu połączenie ciąg do bazy danych systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-345">You will first add the **SignalR.SqlServer** NuGet package and set the connection string to your backplane database.</span></span>

1. <span data-ttu-id="9695f-346">Otwórz **Konsola Menedżera pakietów** z **narzędzia** > **Menedżera pakietów NuGet**.</span><span class="sxs-lookup"><span data-stu-id="9695f-346">Open the **Package Manager Console** from **Tools** > **NuGet Package Manager**.</span></span> <span data-ttu-id="9695f-347">Upewnij się, że **GeekQuiz** projekt jest wybrany w **projekt domyślny** listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="9695f-347">Make sure that **GeekQuiz** project is selected in the **Default project** drop-down list.</span></span> <span data-ttu-id="9695f-348">Wpisz następujące polecenie, aby zainstalować **Microsoft.AspNet.SignalR.SqlServer** pakietu NuGet.</span><span class="sxs-lookup"><span data-stu-id="9695f-348">Type the following command to install the **Microsoft.AspNet.SignalR.SqlServer** NuGet package.</span></span>

    [!code-powershell[Main](real-time-web-applications-with-signalr/samples/sample13.ps1)]
2. <span data-ttu-id="9695f-349">Powtórz poprzedni krok, ale tym razem dla projektu **GeekQuiz2**.</span><span class="sxs-lookup"><span data-stu-id="9695f-349">Repeat the previous step but this time for project **GeekQuiz2**.</span></span>
3. <span data-ttu-id="9695f-350">Aby skonfigurować płyty montażowej programu SQL Server, otwórz **Startup.cs** pliku **GeekQuiz** projektu, a następnie dodaj następujący kod do **Konfiguruj** metody.</span><span class="sxs-lookup"><span data-stu-id="9695f-350">To configure the SQL Server backplane, open the **Startup.cs** file of the **GeekQuiz** project and add the following code to the **Configure** method.</span></span> <span data-ttu-id="9695f-351">Zastąp **&lt;YOUR DATABASE&gt;** z Twoją nazwą bazy danych, którego użyto podczas tworzenia płyty montażowej programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="9695f-351">Replace **&lt;YOUR-DATABASE&gt;** with your database name you used when creating the SQL Server backplane.</span></span> <span data-ttu-id="9695f-352">Powtórz ten krok w przypadku **GeekQuiz2** projektu.</span><span class="sxs-lookup"><span data-stu-id="9695f-352">Repeat this step for the **GeekQuiz2** project.</span></span>

    <span data-ttu-id="9695f-353">(Code Snippet — *StartupConfiguration RealTimeSignalR - Ex2 -*)</span><span class="sxs-lookup"><span data-stu-id="9695f-353">(Code Snippet - *RealTimeSignalR - Ex2 - StartupConfiguration*)</span></span>

    [!code-csharp[Main](real-time-web-applications-with-signalr/samples/sample14.cs)]
4. <span data-ttu-id="9695f-354">Teraz, gdy oba projekty są skonfigurowane do korzystania z systemu backplane programu SQL Server, naciśnij klawisz **F5** do jednoczesnego uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="9695f-354">Now that both projects are configured to use the SQL Server backplane, press **F5** to run them simultaneously.</span></span>
5. <span data-ttu-id="9695f-355">Ponownie **programu Visual Studio** spowoduje uruchomienie dwa wystąpienia **Quiz maniaków komputerowych** w różnych portów.</span><span class="sxs-lookup"><span data-stu-id="9695f-355">Again, **Visual Studio** will launch two instances of **Geek Quiz** in different ports.</span></span> <span data-ttu-id="9695f-356">Przypina jeden z przeglądarki na po lewej stronie, a druga po prawej stronie ekranu, a następnie zaloguj się przy użyciu poświadczeń.</span><span class="sxs-lookup"><span data-stu-id="9695f-356">Pin one of the browsers on the left and the other on the right of your screen and log in with your credentials.</span></span> <span data-ttu-id="9695f-357">Zachowaj na stronie elementy towarzyszące składni po lewej stronie i przejdź do **statystyki** ładowania strony przeglądarki prawo.</span><span class="sxs-lookup"><span data-stu-id="9695f-357">Keep the Trivia page on the left and go to **Statistics** pagein the right browser.</span></span>
6. <span data-ttu-id="9695f-358">Rozpocznij, odpowiadanie na pytania w przeglądarce po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="9695f-358">Start answering questions in the left browser.</span></span> <span data-ttu-id="9695f-359">Tym razem **statystyki** strona zostanie zaktualizowana dzięki gotowej do systemu backplane.</span><span class="sxs-lookup"><span data-stu-id="9695f-359">This time, the **Statistics** page is updated thanks to the backplane.</span></span> <span data-ttu-id="9695f-360">Przełączanie się między aplikacjami (**statystyki** jest teraz, po lewej stronie, a **elementy towarzyszące składni** po prawej) i powtórz test, aby sprawdzić, czy działa ona dla obu wystąpień.</span><span class="sxs-lookup"><span data-stu-id="9695f-360">Switch between applications (**Statistics** is now on the left, and **Trivia** is on the right) and repeat the test to validate that it is working for both instances.</span></span> <span data-ttu-id="9695f-361">Systemu backplane służy jako *pamięć podręczna* wiadomości dla każdego połączonego serwera, a każdy serwer będzie przechowywać wiadomości w własnej lokalnej pamięci podręcznej do dystrybucji do połączonych klientów.</span><span class="sxs-lookup"><span data-stu-id="9695f-361">The backplane serves as a *shared cache* of messages for each connected server, and each server will store the messages in their own local cache to distribute to connected clients.</span></span>
7. <span data-ttu-id="9695f-362">Wróć do programu Visual Studio i zatrzymać debugowanie.</span><span class="sxs-lookup"><span data-stu-id="9695f-362">Go back to Visual Studio and stop debugging.</span></span>
8. <span data-ttu-id="9695f-363">Składnik systemu backplane programu SQL Server automatycznie generuje niezbędne tabele z określonej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="9695f-363">The SQL Server backplane component automatically generates the necessary tables on the specified database.</span></span> <span data-ttu-id="9695f-364">W **Eksplorator obiektów SQL Server** panelu, otwórz bazę danych utworzoną w ramach systemu backplane (np.: SignalR) i rozwiń jego tabel.</span><span class="sxs-lookup"><span data-stu-id="9695f-364">In the **SQL Server Object Explorer** panel, open the database you created for the backplane (e.g.: SignalR) and expand its tables.</span></span> <span data-ttu-id="9695f-365">Powinny zostać wyświetlone następujące tabele:</span><span class="sxs-lookup"><span data-stu-id="9695f-365">You should see the following tables:</span></span>

    ![Płyty montażowej generowane tabel](real-time-web-applications-with-signalr/_static/image27.png)

    <span data-ttu-id="9695f-367">*Płyty montażowej generowane tabel*</span><span class="sxs-lookup"><span data-stu-id="9695f-367">*Backplane Generated Tables*</span></span>
9. <span data-ttu-id="9695f-368">Kliknij prawym przyciskiem myszy **SignalR.Messages\_0** tabeli, a następnie wybierz pozycję **dane widoku**.</span><span class="sxs-lookup"><span data-stu-id="9695f-368">Right-click the **SignalR.Messages\_0** table and select **View Data**.</span></span>

    ![Tabela komunikatów SignalR płyty montażowej widoku](real-time-web-applications-with-signalr/_static/image28.png)

    <span data-ttu-id="9695f-370">*Tabela komunikatów SignalR płyty montażowej widoku*</span><span class="sxs-lookup"><span data-stu-id="9695f-370">*View SignalR Backplane Messages Table*</span></span>
10. <span data-ttu-id="9695f-371">Można zobaczyć różne komunikaty wysyłane do **Centrum** podczas odpowiadania na pytania elementy towarzyszące składni.</span><span class="sxs-lookup"><span data-stu-id="9695f-371">You can see the different messages sent to the **Hub** when answering the trivia questions.</span></span> <span data-ttu-id="9695f-372">Systemu backplane dystrybuuje te komunikaty do dowolnego wystąpienia połączonych.</span><span class="sxs-lookup"><span data-stu-id="9695f-372">The backplane distributes these messages to any connected instance.</span></span>

    ![Tabela komunikatów płyty montażowej](real-time-web-applications-with-signalr/_static/image29.png)

    <span data-ttu-id="9695f-374">*Tabela komunikatów płyty montażowej*</span><span class="sxs-lookup"><span data-stu-id="9695f-374">*Backplane Messages Table*</span></span>

---

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="9695f-375">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="9695f-375">Summary</span></span>

<span data-ttu-id="9695f-376">W tym praktyczne laboratorium ma pokazaliśmy, jak dodać **SignalR** do aplikacji i wysyłania powiadomień z serwera do połączonych klientów przy użyciu **koncentratory**.</span><span class="sxs-lookup"><span data-stu-id="9695f-376">In this hands-on lab, you have learned how to add **SignalR** to your application and send notifications from the server to your connected clients using **Hubs**.</span></span> <span data-ttu-id="9695f-377">Ponadto pokazano, jak skalować aplikację za pomocą *płyty montażowej* składnika, gdy aplikacja jest wdrażana w wielu wystąpieniach programu IIS.</span><span class="sxs-lookup"><span data-stu-id="9695f-377">Additionally, you learned how to scale out your application by using a *backplane* component when your application is deployed in multiple IIS instances.</span></span>
