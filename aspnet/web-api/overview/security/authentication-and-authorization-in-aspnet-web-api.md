---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Uwierzytelnianie i autoryzacja w interfejsie Web API platformy ASP.NET | Dokumentacja firmy Microsoft
author: MikeWasson
description: Zawiera ogólne omówienie uwierzytelniania i autoryzacji w interfejsie API sieci Web platformy ASP.NET.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: a78606a74b2149e68e3b01f4fe204f4a13edf4b5
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57070367"
---
<a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="7ade3-103">Uwierzytelnianie i autoryzacja w składniku ASP.NET Web API</span><span class="sxs-lookup"><span data-stu-id="7ade3-103">Authentication and Authorization in ASP.NET Web API</span></span>
====================
<span data-ttu-id="7ade3-104">przez [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="7ade3-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="7ade3-105">Internetowy interfejs API został utworzony, ale teraz chcesz kontrolować dostęp do niego.</span><span class="sxs-lookup"><span data-stu-id="7ade3-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="7ade3-106">W tej serii artykułów przyjrzymy niektóre opcje zabezpieczania internetowego interfejsu API przed nieautoryzowanymi użytkownikami.</span><span class="sxs-lookup"><span data-stu-id="7ade3-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="7ade3-107">W tej serii opisano zarówno uwierzytelniania i autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="7ade3-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="7ade3-108">*Uwierzytelnianie* jest wiedza, tożsamość użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ade3-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="7ade3-109">Na przykład Alicja zaloguje się za pomocą swojej nazwy użytkownika i hasła i hasło używane do uwierzytelniania Alicji.</span><span class="sxs-lookup"><span data-stu-id="7ade3-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="7ade3-110">*Autoryzacja* decyduje, czy użytkownik może wykonać akcję.</span><span class="sxs-lookup"><span data-stu-id="7ade3-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="7ade3-111">Na przykład gdy Alicja ma uprawnienia do pobieranie zasobu, ale nie tworzenie zasobu.</span><span class="sxs-lookup"><span data-stu-id="7ade3-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="7ade3-112">Pierwszy artykuł z serii zapewnia ogólne omówienie uwierzytelniania i autoryzacji w interfejsie API sieci Web platformy ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="7ade3-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="7ade3-113">Innych tematach opisano typowe scenariusze uwierzytelniania dla interfejsu API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="7ade3-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="7ade3-114">Dzięki gotowej do osób, które w tej serii przeglądu i udostępniane opinii: Rick Anderson Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span><span class="sxs-lookup"><span data-stu-id="7ade3-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>


## <a name="authentication"></a><span data-ttu-id="7ade3-115">Uwierzytelnianie</span><span class="sxs-lookup"><span data-stu-id="7ade3-115">Authentication</span></span>

<span data-ttu-id="7ade3-116">Interfejsu API sieci Web przyjęto założenie, że uwierzytelnianie odbywa się na hoście.</span><span class="sxs-lookup"><span data-stu-id="7ade3-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="7ade3-117">Dla hostingu w sieci web hosta jest usług IIS, które są używane moduły HTTP do uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="7ade3-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="7ade3-118">Można skonfigurować projekt do żadnych modułów uwierzytelniania wbudowanej w program IIS lub ASP.NET lub napisać własny moduł HTTP, aby wykonać niestandardowe uwierzytelnianie.</span><span class="sxs-lookup"><span data-stu-id="7ade3-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="7ade3-119">Gdy host uwierzytelnia użytkownika, tworzy *jednostki*, czyli [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) obiekt, który reprezentuje kontekstu zabezpieczeń, w którym kod działa.</span><span class="sxs-lookup"><span data-stu-id="7ade3-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="7ade3-120">Host dołącza podmiotu zabezpieczeń bieżącego wątku, ustawiając **SE vlastnost Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="7ade3-121">Podmiot zabezpieczeń zawiera skojarzoną **tożsamości** obiekt, który zawiera informacje o użytkowniku.</span><span class="sxs-lookup"><span data-stu-id="7ade3-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="7ade3-122">Jeśli użytkownik jest uwierzytelniony, **Identity.IsAuthenticated** właściwość zwraca **true**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="7ade3-123">W przypadku żądań anonimowych **właściwości** zwraca **false**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="7ade3-124">Aby uzyskać więcej informacji na temat jednostek, zobacz [opartej na rolach zabezpieczeń](https://msdn.microsoft.com/library/shz8h065.aspx).</span><span class="sxs-lookup"><span data-stu-id="7ade3-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="7ade3-125">Programy obsługi komunikatów HTTP na potrzeby uwierzytelniania</span><span class="sxs-lookup"><span data-stu-id="7ade3-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="7ade3-126">Zamiast używania hosta na potrzeby uwierzytelniania, mogą umieścić logiki uwierzytelniania do [program obsługi komunikatów HTTP](../advanced/http-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="7ade3-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="7ade3-127">W takim przypadku program obsługi komunikatów sprawdza żądania HTTP i ustawia podmiot zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="7ade3-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="7ade3-128">Kiedy należy używać obsługi komunikatów do uwierzytelniania?</span><span class="sxs-lookup"><span data-stu-id="7ade3-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="7ade3-129">Poniżej przedstawiono niektóre wady i zalety:</span><span class="sxs-lookup"><span data-stu-id="7ade3-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="7ade3-130">Moduł HTTP widzi wszystkie żądania, które przechodzą przez potoku ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="7ade3-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="7ade3-131">Program obsługi komunikatów widoczny jest tylko żądania kierowane do interfejsu API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="7ade3-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="7ade3-132">Można ustawić programy obsługi komunikatów dla trasy, które można stosować schematu uwierzytelniania do określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="7ade3-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="7ade3-133">Moduły HTTP są specyficzne dla usług IIS.</span><span class="sxs-lookup"><span data-stu-id="7ade3-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="7ade3-134">Programy obsługi komunikatów są pochodzącego od dowolnego hosta, więc można ich używać z hostingu w sieci web i własnym hostingu.</span><span class="sxs-lookup"><span data-stu-id="7ade3-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="7ade3-135">Moduły HTTP uczestniczyć w rejestrowania w usługach IIS, inspekcji i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="7ade3-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="7ade3-136">Uruchom moduły HTTP wcześniej w potoku.</span><span class="sxs-lookup"><span data-stu-id="7ade3-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="7ade3-137">Jeśli możesz obsługiwać uwierzytelnianie programu obsługi wiadomości, podmiot zabezpieczeń nie uzyskać ustawiony, dopóki program obsługi jest uruchamiany.</span><span class="sxs-lookup"><span data-stu-id="7ade3-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="7ade3-138">Ponadto główny powróci do poprzedniej nazwy głównej gdy odpowiedź pozostawia program obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="7ade3-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="7ade3-139">Ogólnie rzecz biorąc Jeśli nie potrzebujesz do obsługi hostingu samodzielnego modułu HTTP jest lepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="7ade3-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="7ade3-140">Jeśli potrzebujesz do obsługi hostingu samodzielnego, należy wziąć pod uwagę program obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="7ade3-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="7ade3-141">Ustawienie podmiotu zabezpieczeń</span><span class="sxs-lookup"><span data-stu-id="7ade3-141">Setting the Principal</span></span>

<span data-ttu-id="7ade3-142">Jeśli Twoja aplikacja działa wszelka logika uwierzytelniania niestandardowego, musisz ustawić podmiot zabezpieczeń w dwóch miejscach:</span><span class="sxs-lookup"><span data-stu-id="7ade3-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="7ade3-143">**SE vlastnost Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="7ade3-144">Ta właściwość jest standardowym sposobem, aby ustawić podmiot wątku na platformie .NET.</span><span class="sxs-lookup"><span data-stu-id="7ade3-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="7ade3-145">**HttpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="7ade3-146">Ta właściwość jest specyficzne dla platformy ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="7ade3-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="7ade3-147">Poniższy kod przedstawia sposób ustawić podmiot:</span><span class="sxs-lookup"><span data-stu-id="7ade3-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="7ade3-148">Hosting sieci web należy ustawić podmiot zabezpieczeń w obu miejscach; w przeciwnym razie kontekstu zabezpieczeń może stać się niespójna.</span><span class="sxs-lookup"><span data-stu-id="7ade3-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="7ade3-149">Dla hostingu samodzielnego, jednak **HttpContext.Current** ma wartość null.</span><span class="sxs-lookup"><span data-stu-id="7ade3-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="7ade3-150">Aby upewnić się, Twój kod jest niezależny od hosta, w związku z tym, sprawdzaj wartość null przed przypisaniem do **HttpContext.Current**, jak pokazano.</span><span class="sxs-lookup"><span data-stu-id="7ade3-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="7ade3-151">Autoryzacja</span><span class="sxs-lookup"><span data-stu-id="7ade3-151">Authorization</span></span>

<span data-ttu-id="7ade3-152">Autoryzacja odbywa się później w potoku, bliżej kontrolera.</span><span class="sxs-lookup"><span data-stu-id="7ade3-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="7ade3-153">Który umożliwia podejmowanie bardziej szczegółowego wyborów, gdy udzielisz jej dostępu do zasobów.</span><span class="sxs-lookup"><span data-stu-id="7ade3-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="7ade3-154">*Filtry autoryzacji* uruchamiane przed akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="7ade3-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="7ade3-155">Jeśli żądanie nie jest autoryzowane, filtr zwraca odpowiedź na błąd i akcja nie jest wywoływany.</span><span class="sxs-lookup"><span data-stu-id="7ade3-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="7ade3-156">W ramach akcji kontrolera, można uzyskać bieżący podmiot zabezpieczeń z **ApiController.User** właściwości.</span><span class="sxs-lookup"><span data-stu-id="7ade3-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="7ade3-157">Na przykład można filtrować listę zasobów, w oparciu o nazwę użytkownika, zwracanie tylko tych zasobów, które należą do tego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ade3-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="7ade3-158">Przy użyciu [autoryzować] atrybutu</span><span class="sxs-lookup"><span data-stu-id="7ade3-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="7ade3-159">Interfejs API sieci Web zawiera filtr autoryzacji wbudowanych [klasy AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="7ade3-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="7ade3-160">Ten filtr sprawdza, czy użytkownik jest uwierzytelniony.</span><span class="sxs-lookup"><span data-stu-id="7ade3-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="7ade3-161">W przeciwnym razie zwraca kod stanu HTTP 401 (bez autoryzacji) bez wywoływania akcji.</span><span class="sxs-lookup"><span data-stu-id="7ade3-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="7ade3-162">Można zastosować filtr, na całym świecie, na poziomie kontrolera lub na poziomie poszczególnych działań.</span><span class="sxs-lookup"><span data-stu-id="7ade3-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="7ade3-163">**Globalnie**: Aby ograniczyć dostęp dla każdego kontrolera interfejsu API sieci Web, należy dodać **klasy AuthorizeAttribute** filtr do listy filtrów globalnych:</span><span class="sxs-lookup"><span data-stu-id="7ade3-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="7ade3-164">**Kontroler**: Aby ograniczyć dostęp dla określonego kontrolera, należy dodać filtr jako atrybut do kontrolera:</span><span class="sxs-lookup"><span data-stu-id="7ade3-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="7ade3-165">**Akcja**: Aby ograniczyć dostęp dla określonych akcji, Dodaj atrybut do metody akcji:</span><span class="sxs-lookup"><span data-stu-id="7ade3-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="7ade3-166">Alternatywnie, można ograniczyć kontrolera i następnie zezwolić na dostęp anonimowy do określonych akcji za pomocą `[AllowAnonymous]` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="7ade3-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="7ade3-167">W poniższym przykładzie `Post` metodą jest ograniczona, ale `Get` metoda zezwala na dostęp anonimowy.</span><span class="sxs-lookup"><span data-stu-id="7ade3-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="7ade3-168">W poprzednich przykładach filtr zezwala każdemu uwierzytelnionemu użytkownikowi na dostęp do metod ograniczone; tylko użytkownicy anonimowi są przechowywane w. Można również ograniczyć dostęp do określonych użytkowników lub dla użytkowników w określonych ról:</span><span class="sxs-lookup"><span data-stu-id="7ade3-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="7ade3-169">**Klasy AuthorizeAttribute** filtr dla kontrolerów internetowych interfejsów API znajduje się w **System.Web.Http** przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="7ade3-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="7ade3-170">Ma podobnych filtru dla kontrolerów MVC w **System.Web.Mvc** przestrzeń nazw, która nie jest zgodny z kontrolerów internetowych interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="7ade3-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>


### <a name="custom-authorization-filters"></a><span data-ttu-id="7ade3-171">Filtry autoryzacji niestandardowej</span><span class="sxs-lookup"><span data-stu-id="7ade3-171">Custom Authorization Filters</span></span>

<span data-ttu-id="7ade3-172">Aby zapisać filtr autoryzacja niestandardowa, pochodzi z jednego z następujących typów:</span><span class="sxs-lookup"><span data-stu-id="7ade3-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="7ade3-173">**Klasy AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="7ade3-174">Rozszerzenia tej klasy w celu wykonania logiki autoryzacji na podstawie bieżącego użytkownika i ról użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ade3-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="7ade3-175">**AuthorizationFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="7ade3-176">Rozszerzenia tej klasy w celu wykonania logiki synchroniczne autoryzacji, który nie zawsze jest oparty na bieżący użytkownik lub rola.</span><span class="sxs-lookup"><span data-stu-id="7ade3-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="7ade3-177">**IAuthorizationFilter**.</span><span class="sxs-lookup"><span data-stu-id="7ade3-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="7ade3-178">Implementować ten interfejs w celu wykonania logiki asynchronicznego autoryzacji; na przykład, jeśli logika autoryzacji sprawia, że wywołania asynchroniczne operacje We/Wy lub sieci.</span><span class="sxs-lookup"><span data-stu-id="7ade3-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="7ade3-179">(Jeśli logika autoryzacji jest zależne od Procesora CPU, jest łatwiejsze w dziedziczyć **AuthorizationFilterAttribute**, ponieważ wówczas nie trzeba napisać metodę asynchroniczną.)</span><span class="sxs-lookup"><span data-stu-id="7ade3-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="7ade3-180">Poniższy diagram przedstawia hierarchii klas dla **klasy AuthorizeAttribute** klasy.</span><span class="sxs-lookup"><span data-stu-id="7ade3-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="7ade3-181">Autoryzacja wewnątrz akcji kontrolera</span><span class="sxs-lookup"><span data-stu-id="7ade3-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="7ade3-182">W niektórych przypadkach może być Zezwalaj na żądanie, aby kontynuować, ale zmienia zachowanie w zależności od podmiotu zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="7ade3-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="7ade3-183">Na przykład można zwrócić informacje mogą ulec zmianie w zależności od roli użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7ade3-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="7ade3-184">Wewnątrz metody kontrolera, można uzyskać bieżący podmiot zabezpieczeń z **ApiController.User** właściwości.</span><span class="sxs-lookup"><span data-stu-id="7ade3-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
