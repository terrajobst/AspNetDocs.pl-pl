---
uid: web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
title: Dostosowywanie zachowania dla całej witryny dla ASP.NET Web Pages (Razor) witryn | Dokumentacja firmy Microsoft
author: Rick-Anderson
description: W tym rozdziale wyjaśniono, jak wprowadzić ustawienia całej witryny sieci Web lub cały folder, a nie tylko strony.
ms.author: riande
ms.date: 02/17/2014
ms.assetid: e158bed7-226f-4275-b02e-7553bd58c669
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
msc.type: authoredcontent
ms.openlocfilehash: ca7c241d6e4d1e4baa581faf2bda4ed275b4e785
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57067898"
---
<a name="customizing-site-wide-behavior-for-aspnet-web-pages-razor-sites"></a><span data-ttu-id="0481d-103">Dostosowywanie zachowania dla całej witryny dla witrynach ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="0481d-103">Customizing Site-Wide Behavior for ASP.NET Web Pages (Razor) Sites</span></span>
====================
<span data-ttu-id="0481d-104">przez [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="0481d-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="0481d-105">W tym artykule wyjaśniono, jak określić ustawienia lokacji po stronie dla stron w witrynie internetowej ASP.NET Web Pages (Razor).</span><span class="sxs-lookup"><span data-stu-id="0481d-105">This article explains how to make site-side settings for pages in an ASP.NET Web Pages (Razor) website.</span></span>
> 
> <span data-ttu-id="0481d-106">Zawartość:</span><span class="sxs-lookup"><span data-stu-id="0481d-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="0481d-107">Jak uruchomić kod umożliwiający zestaw wartości (wartości globalnych lub ustawienia pomocnika) dla wszystkich stron w witrynie.</span><span class="sxs-lookup"><span data-stu-id="0481d-107">How to run code that lets you set values (global values or helper settings) for all pages in a site.</span></span>
> - <span data-ttu-id="0481d-108">Jak uruchomić kod, który umożliwia ustawienie wartości na wszystkich stronach w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-108">How to run code that lets you set values for all pages in a folder.</span></span>
> - <span data-ttu-id="0481d-109">Jak uruchomić kod przed i po stronie ładuje.</span><span class="sxs-lookup"><span data-stu-id="0481d-109">How to run code before and after a page loads.</span></span>
> - <span data-ttu-id="0481d-110">Jak wysłać błędy do strony błędu centralnej.</span><span class="sxs-lookup"><span data-stu-id="0481d-110">How to send errors to a central error page.</span></span>
> - <span data-ttu-id="0481d-111">Jak dodać uwierzytelnianie do wszystkich stron w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-111">How to add authentication to all pages in a folder.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="0481d-112">Wersje oprogramowania używanego w tym samouczku</span><span class="sxs-lookup"><span data-stu-id="0481d-112">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="0481d-113">ASP.NET Web Pages (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="0481d-113">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="0481d-114">Program WebMatrix 3</span><span class="sxs-lookup"><span data-stu-id="0481d-114">WebMatrix 3</span></span>
> - <span data-ttu-id="0481d-115">Biblioteka pomocników sieci Web platformy ASP.NET (pakiet NuGet)</span><span class="sxs-lookup"><span data-stu-id="0481d-115">ASP.NET Web Helpers Library (NuGet package)</span></span>
>   
> 
> <span data-ttu-id="0481d-116">W tym samouczku współpracuje również z 3 stron sieci Web platformy ASP.NET i programu Visual Studio 2013 (lub Visual Studio Express 2013 for Web), chyba że użytkownik nie można użyć bibliotekę pomocników platformy ASP.NET sieci Web.</span><span class="sxs-lookup"><span data-stu-id="0481d-116">This tutorial also works with ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web), except you cannot use the ASP.NET Web Helpers Library.</span></span>


<a id="Adding_Website_Startup_Code"></a>
## <a name="adding-website-startup-code-for-aspnet-web-pages"></a><span data-ttu-id="0481d-117">Dodawanie kodu do uruchomienia witryny sieci Web dla stron sieci Web platformy ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0481d-117">Adding Website Startup Code for ASP.NET Web Pages</span></span>

<span data-ttu-id="0481d-118">Przez większość kodu napisanego w języku ASP.NET Web Pages pojedynczej strony może zawierać kod, który jest wymagany dla tej strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-118">For much of the code that you write in ASP.NET Web Pages, an individual page can contain all the code that's required for that page.</span></span> <span data-ttu-id="0481d-119">Na przykład jeśli strona wysyła wiadomość e-mail, istnieje możliwość umieść cały kod dla tej operacji na jednej stronie.</span><span class="sxs-lookup"><span data-stu-id="0481d-119">For example, if a page sends an email message, it's possible to put all the code for that operation in a single page.</span></span> <span data-ttu-id="0481d-120">Może to obejmować kod do zainicjowania ustawienia wysyłania poczty e-mail (oznacza to, że dla serwera SMTP) i wysyłania wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="0481d-120">This can include the code to initialize the settings for sending email (that is, for the SMTP server) and for sending the email message.</span></span>

<span data-ttu-id="0481d-121">W niektórych sytuacjach może być do uruchomienia kodu przed uruchomieniem dowolnej stronie w witrynie.</span><span class="sxs-lookup"><span data-stu-id="0481d-121">However, in some situations, you might want to run some code before any page on the site runs.</span></span> <span data-ttu-id="0481d-122">Jest to przydatne do ustawiania wartości, które mogą być używane w dowolnym miejscu w witrynie (nazywane *wartości globalnych*.) Na przykład niektóre pomocników wymagają Podaj wartości, takich jak ustawienia poczty e-mail lub kluczy konta.</span><span class="sxs-lookup"><span data-stu-id="0481d-122">This is useful for setting values that can be used anywhere in the site (referred to as *global values*.) For example, some helpers require you to provide values like email settings or account keys.</span></span> <span data-ttu-id="0481d-123">Może być przydatna, aby zachować te ustawienia globalne wartości.</span><span class="sxs-lookup"><span data-stu-id="0481d-123">It can be handy to keep these settings in global values.</span></span>

<span data-ttu-id="0481d-124">Można to zrobić przez utworzenie strony o nazwie  *\_AppStart.cshtml* w katalogu głównym witryny.</span><span class="sxs-lookup"><span data-stu-id="0481d-124">You can do this by creating a page named *\_AppStart.cshtml* in the root of the site.</span></span> <span data-ttu-id="0481d-125">Jeśli ta strona istnieje, jest uruchamiany przy pierwszym żądaniu dowolnej strony w witrynie.</span><span class="sxs-lookup"><span data-stu-id="0481d-125">If this page exists, it runs the first time any page in the site is requested.</span></span> <span data-ttu-id="0481d-126">Dlatego jest dobrym miejscem do uruchomienia kodu, aby ustawić wartości globalnych.</span><span class="sxs-lookup"><span data-stu-id="0481d-126">Therefore, it's a good place to run code to set global values.</span></span> <span data-ttu-id="0481d-127">(Ponieważ  *\_AppStart.cshtml* ma prefiks podkreślenia ASP.NET nie będzie wysyłać strony w przeglądarce, nawet jeśli użytkownicy zażądają go bezpośrednio.)</span><span class="sxs-lookup"><span data-stu-id="0481d-127">(Because *\_AppStart.cshtml* has an underscore prefix, ASP.NET won't send the page to a browser even if users request it directly.)</span></span>

<span data-ttu-id="0481d-128">Na poniższym diagramie przedstawiono sposób, w jaki  *\_AppStart.cshtml* stronie działa.</span><span class="sxs-lookup"><span data-stu-id="0481d-128">The following diagram shows how the *\_AppStart.cshtml* page works.</span></span> <span data-ttu-id="0481d-129">Gdy nadejdzie żądanie dla strony i jeśli jest to pierwsze żądanie dla każdej strony w witrynie ASP.NET najpierw sprawdza, czy czy  *\_AppStart.cshtml* strona istnieje.</span><span class="sxs-lookup"><span data-stu-id="0481d-129">When a request comes in for a page, and if this is the first request for any page in the site, ASP.NET first checks whether a *\_AppStart.cshtml* page exists.</span></span> <span data-ttu-id="0481d-130">Jeśli tak, dowolny kod w  *\_AppStart.cshtml* strony uruchomienia, a następnie uruchamia żądanej strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-130">If so, any code in the *\_AppStart.cshtml* page runs, and then the requested page runs.</span></span>

![[image]](18-customizing-site-wide-behavior/_static/image1.jpg)

## <a name="setting-global-values-for-your-website"></a><span data-ttu-id="0481d-132">Ustawienie wartości globalnych dla witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="0481d-132">Setting Global Values for Your Website</span></span>

1. <span data-ttu-id="0481d-133">W folderze głównym witryny sieci Web programu WebMatrix, Utwórz plik o nazwie  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-133">In the root folder of a WebMatrix website, create a file named *\_AppStart.cshtml*.</span></span> <span data-ttu-id="0481d-134">Plik musi być w katalogu głównym witryny.</span><span class="sxs-lookup"><span data-stu-id="0481d-134">The file must be in the root of the site.</span></span>
2. <span data-ttu-id="0481d-135">Zastąp istniejącą zawartość następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="0481d-135">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample1.cshtml)]

    <span data-ttu-id="0481d-136">Ten kod przechowuje wartość w `AppState` słownik, który jest automatycznie dostępny dla wszystkich stron w witrynie.</span><span class="sxs-lookup"><span data-stu-id="0481d-136">This code stores a value in the `AppState` dictionary, which is automatically available to all pages in the site.</span></span> <span data-ttu-id="0481d-137">Należy zauważyć, że  *\_AppStart.cshtml* plik nie ma żadnych znaczników w nim.</span><span class="sxs-lookup"><span data-stu-id="0481d-137">Notice that the *\_AppStart.cshtml* file does not have any markup in it.</span></span> <span data-ttu-id="0481d-138">Strona będzie uruchomić kod i Przekierowanie do strony, która pierwotnie żądaną.</span><span class="sxs-lookup"><span data-stu-id="0481d-138">The page will run the code and then redirect to the page that was originally requested.</span></span>

    > [!NOTE]
    > <span data-ttu-id="0481d-139">Należy zachować ostrożność w umieść kod  *\_AppStart.cshtml* pliku.</span><span class="sxs-lookup"><span data-stu-id="0481d-139">Be careful when you put code in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="0481d-140">Jeśli wystąpią błędy w kodzie w  *\_AppStart.cshtml* pliku, witryny sieci Web nie będą naliczane.</span><span class="sxs-lookup"><span data-stu-id="0481d-140">If any errors occur in code in the *\_AppStart.cshtml* file, the website won't start.</span></span>
3. <span data-ttu-id="0481d-141">W folderze głównym, Utwórz nową stronę o nazwie *AppName.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-141">In the root folder, create a new page named *AppName.cshtml*.</span></span>
4. <span data-ttu-id="0481d-142">Zastąp domyślną znaczników i kodu następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="0481d-142">Replace the default markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample2.html)]

    <span data-ttu-id="0481d-143">Ten kod wyodrębnianie wartości z `AppState` obiektu, który zostało ustawiony w  *\_AppStart.cshtml* strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-143">This code extracts the value from the `AppState` object that you set in the *\_AppStart.cshtml* page.</span></span>
5. <span data-ttu-id="0481d-144">Uruchom *AppName.cshtml* strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-144">Run the *AppName.cshtml* page in a browser.</span></span> <span data-ttu-id="0481d-145">(Upewnij się, że strona jest zaznaczona w **pliki** obszaru roboczego przed jej uruchomieniem.) Strony wyświetli wartości globalnej.</span><span class="sxs-lookup"><span data-stu-id="0481d-145">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays the global value.</span></span> 

    ![[image]](18-customizing-site-wide-behavior/_static/image2.jpg)

<a id="Setting_Values_For_Helpers"></a>
## <a name="setting-values-for-helpers"></a><span data-ttu-id="0481d-147">Ustawianie wartości dla wątków</span><span class="sxs-lookup"><span data-stu-id="0481d-147">Setting Values for Helpers</span></span>

<span data-ttu-id="0481d-148">Dobrze Wykorzystaj dla  *\_AppStart.cshtml* plik jest do ustawiania wartości dla wątków, które są używane w serwisie i które mają zostać zainicjowany.</span><span class="sxs-lookup"><span data-stu-id="0481d-148">A good use for the *\_AppStart.cshtml* file is to set values for helpers that you use in your site and that have to be initialized.</span></span> <span data-ttu-id="0481d-149">Typowym przykładem są ustawienia poczty e-mail dla `WebMail` pomocnika i klucze prywatne i publiczne `ReCaptcha` pomocnika.</span><span class="sxs-lookup"><span data-stu-id="0481d-149">Typical examples are email settings for the `WebMail` helper and the private and public keys for the `ReCaptcha` helper.</span></span> <span data-ttu-id="0481d-150">W takich przypadkach można ustawić wartości jeden raz w  *\_AppStart.cshtml* i następnie są już ustawione dla wszystkich stron w Twojej lokacji.</span><span class="sxs-lookup"><span data-stu-id="0481d-150">In cases like these, you can set the values once in the *\_AppStart.cshtml* and then they're already set for all the pages in your site.</span></span>

<span data-ttu-id="0481d-151">Tej procedury przedstawiono sposób ustawiania `WebMail` ustawienia globalnie.</span><span class="sxs-lookup"><span data-stu-id="0481d-151">This procedure shows you how to set `WebMail` settings globally.</span></span> <span data-ttu-id="0481d-152">(Aby uzyskać więcej informacji o korzystaniu z `WebMail` pomocnika, zobacz [dodawanie do poczty E-mail witrynie ASP.NET Web Pages](../getting-started/11-adding-email-to-your-web-site.md).)</span><span class="sxs-lookup"><span data-stu-id="0481d-152">(For more information about using the `WebMail` helper, see [Adding Email to an ASP.NET Web Pages Site](../getting-started/11-adding-email-to-your-web-site.md).)</span></span>

1. <span data-ttu-id="0481d-153">Dodaj bibliotekę pomocników platformy ASP.NET sieci Web do witryny sieci Web, zgodnie z opisem w [instalowanie obiekty pomocnicze w witrynie ASP.NET Web Pages](https://go.microsoft.com/fwlink/?LinkId=252372), jeśli jeszcze nie został dodany.</span><span class="sxs-lookup"><span data-stu-id="0481d-153">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already added it.</span></span>
2. <span data-ttu-id="0481d-154">Jeśli nie masz jeszcze  *\_AppStart.cshtml* plików, w folderze głównym witryny sieci Web Utwórz plik o nazwie  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-154">If you don't already have a *\_AppStart.cshtml* file, in the root folder of a website create a file named *\_AppStart.cshtml*.</span></span>
3. <span data-ttu-id="0481d-155">Dodaj następujący kod `WebMail` ustawienia  *\_AppStart.cshtml* pliku:</span><span class="sxs-lookup"><span data-stu-id="0481d-155">Add the following `WebMail` settings to the *\_AppStart.cshtml* file:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample3.cshtml?highlight=2-7)]

    <span data-ttu-id="0481d-156">Zmodyfikuj następujące e-mail powiązane ustawienia w kodzie:</span><span class="sxs-lookup"><span data-stu-id="0481d-156">Modify the following email related settings in the code:</span></span>

   - <span data-ttu-id="0481d-157">Ustaw `your-SMTP-host` na nazwę serwera SMTP, który ma dostęp do.</span><span class="sxs-lookup"><span data-stu-id="0481d-157">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
   - <span data-ttu-id="0481d-158">Ustaw `your-user-name-here` nazwę użytkownika dla konta serwera SMTP.</span><span class="sxs-lookup"><span data-stu-id="0481d-158">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
   - <span data-ttu-id="0481d-159">Ustaw `your-account-password` hasło dla konta serwera SMTP.</span><span class="sxs-lookup"><span data-stu-id="0481d-159">Set `your-account-password` to the password for your SMTP server account.</span></span>
   - <span data-ttu-id="0481d-160">Ustaw `your-email-address-here` na adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="0481d-160">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="0481d-161">To jest adres e-mail, który komunikat jest wysyłany z.</span><span class="sxs-lookup"><span data-stu-id="0481d-161">This is the email address that the message is sent from.</span></span> <span data-ttu-id="0481d-162">(Niektórzy dostawcy poczty e-mail nie pozwalają określić inną `From` adresem, a następnie użyje nazwy użytkownika jako `From` adresu.)</span><span class="sxs-lookup"><span data-stu-id="0481d-162">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

     <span data-ttu-id="0481d-163">Aby uzyskać więcej informacji na temat ustawień protokołu SMTP, zobacz [konfigurowania ustawień poczty E-mail](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) w artykule [wysyłania wiadomości E-mail z witryny ASP.NET Web Pages (Razor)](https://go.microsoft.com/fwlink/?LinkID=202899) i [problemy związane z wysłaniem wiadomości E-mail](https://go.microsoft.com/fwlink/?LinkId=253001#email)w [ASP.NET Web Pages (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span><span class="sxs-lookup"><span data-stu-id="0481d-163">For more information about SMTP settings, see [Configuring Email Settings](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) in the article [Sending Email from an ASP.NET Web Pages (Razor) Site](https://go.microsoft.com/fwlink/?LinkID=202899) and [Issues with Sending Email](https://go.microsoft.com/fwlink/?LinkId=253001#email) in the [ASP.NET Web Pages (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span></span>
4. <span data-ttu-id="0481d-164">Zapisz  *\_AppStart.cshtml* plik i zamknij go.</span><span class="sxs-lookup"><span data-stu-id="0481d-164">Save the *\_AppStart.cshtml* file and close it.</span></span>
5. <span data-ttu-id="0481d-165">W folderze głównym witryny sieci Web, należy utworzyć nową stronę o nazwie *TestEmail.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-165">In the root folder of a website, create new page named *TestEmail.cshtml*.</span></span>
6. <span data-ttu-id="0481d-166">Zastąp istniejącą zawartość następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="0481d-166">Replace the existing content with the following:</span></span> 

     [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample4.cshtml)]
7. <span data-ttu-id="0481d-167">Uruchom *TestEmail.cshtml* strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-167">Run the *TestEmail.cshtml* page in a browser.</span></span>
8. <span data-ttu-id="0481d-168">Wypełnij pola, aby wysłać do siebie wiadomość e-mail, a następnie kliknij przycisk **wysyłania**.</span><span class="sxs-lookup"><span data-stu-id="0481d-168">Fill in the fields to send yourself an email message and then click **Send**.</span></span>
9. <span data-ttu-id="0481d-169">Sprawdź pocztę e-mail, aby upewnić się, że trafiła do Ciebie wiadomość.</span><span class="sxs-lookup"><span data-stu-id="0481d-169">Check your email to make sure you've gotten the message.</span></span>

<span data-ttu-id="0481d-170">Ważną częścią w tym przykładzie jest to, że ustawienia, które zwykle nie została zmieniona — takie jak nazwa serwera SMTP i poświadczenia wiadomości e-mail — są ustawiane w  *\_AppStart.cshtml* pliku.</span><span class="sxs-lookup"><span data-stu-id="0481d-170">The important part of this example is that the settings that you don't usually change — like the name of your SMTP server and your email credentials — are set in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="0481d-171">Dzięki temu nie trzeba ich ustawiać ponownie na każdej stronie gdzie wysłać wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="0481d-171">That way you don't need to set them again in each page where you send email.</span></span> <span data-ttu-id="0481d-172">(Chociaż Jeśli z jakiegoś powodu, musisz zmienić te ustawienia, można ustawić je oddzielnie na stronie.) Na stronie można ustawić tylko wartości, które zazwyczaj zmienia się za każdym razem, takie jak odbiorcy oraz treść wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="0481d-172">(Although if for some reason you need to change those settings, you can set them individually in a page.) In the page, you only set the values that typically change each time, like the recipient and the body of the email message.</span></span>

<a id="Running_Code_Before_and_After"></a>
## <a name="running-code-before-and-after-files-in-a-folder"></a><span data-ttu-id="0481d-173">Uruchamianie kodu przed i po nim pliki w folderze</span><span class="sxs-lookup"><span data-stu-id="0481d-173">Running Code Before and After Files in a Folder</span></span>

<span data-ttu-id="0481d-174">Podobnie można użyć  *\_AppStart.cshtml* przed uruchomieniem stron witryny, należy napisać kod, można napisać kod, który jest uruchamiany przed (i po nim) dowolnej strony w określonym folderze Uruchom.</span><span class="sxs-lookup"><span data-stu-id="0481d-174">Just like you can use *\_AppStart.cshtml* to write code before pages in the site run, you can write code that runs before (and after) any page in a particular folder run.</span></span> <span data-ttu-id="0481d-175">Jest to przydatne w przypadku elementów, np. ustawienie tej samej strony układu dla wszystkich stron w folderze lub Sprawdzanie, który użytkownik jest zalogowany przed uruchomieniem strony w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-175">This is useful for things like setting the same layout page for all the pages in a folder, or for checking that a user is logged in before running a page in the folder.</span></span>

<span data-ttu-id="0481d-176">W przypadku stron w szczególności folderów, możesz utworzyć kod w pliku o nazwie  *\_PageStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-176">For pages in particular folders, you can create code in a file named *\_PageStart.cshtml*.</span></span> <span data-ttu-id="0481d-177">Na poniższym diagramie przedstawiono sposób, w jaki  *\_PageStart.cshtml* stronie działa.</span><span class="sxs-lookup"><span data-stu-id="0481d-177">The following diagram shows how the *\_PageStart.cshtml* page works.</span></span> <span data-ttu-id="0481d-178">Gdy nadejdzie żądanie dla strony, ASP.NET najpierw sprawdza  *\_AppStart.cshtml* strony i że uruchomieniu.</span><span class="sxs-lookup"><span data-stu-id="0481d-178">When a request comes in for a page, ASP.NET first checks for a *\_AppStart.cshtml* page and runs that.</span></span> <span data-ttu-id="0481d-179">Następnie aplikacja ASP.NET sprawdza, czy istnieje  *\_PageStart.cshtml* strony, a jeśli tak, który uruchamia.</span><span class="sxs-lookup"><span data-stu-id="0481d-179">Then ASP.NET checks whether there's a *\_PageStart.cshtml* page, and if so, runs that.</span></span> <span data-ttu-id="0481d-180">Następnie działa żądanej strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-180">It then runs the requested page.</span></span>

<span data-ttu-id="0481d-181">Wewnątrz  *\_PageStart.cshtml* strony, można określić miejsce podczas przetwarzania żądanej strony do uruchomienia, umieszczając `RunPage` metody.</span><span class="sxs-lookup"><span data-stu-id="0481d-181">Inside the *\_PageStart.cshtml* page, you can specify where during processing you want the requested page to run by including a `RunPage` method.</span></span> <span data-ttu-id="0481d-182">Dzięki temu można uruchomić kod przed uruchomieniem żądanej strony i następnie ponownie po nim.</span><span class="sxs-lookup"><span data-stu-id="0481d-182">This lets you run code before the requested page runs and then again after it.</span></span> <span data-ttu-id="0481d-183">Jeśli nie podasz `RunPage`, cały kod w  *\_PageStart.cshtml* przebiegów i Żądana strona jest uruchamiana automatycznie.</span><span class="sxs-lookup"><span data-stu-id="0481d-183">If you don't include `RunPage`, all the code in *\_PageStart.cshtml* runs, and then the requested page runs automatically.</span></span>

![[image]](18-customizing-site-wide-behavior/_static/image3.jpg)

<span data-ttu-id="0481d-185">Program ASP.NET pozwala utworzyć hierarchię  *\_PageStart.cshtml* plików.</span><span class="sxs-lookup"><span data-stu-id="0481d-185">ASP.NET lets you create a hierarchy of *\_PageStart.cshtml* files.</span></span> <span data-ttu-id="0481d-186">Możesz umieścić  *\_PageStart.cshtml* pliku w katalogu głównym witryny i dowolnego podfolderu.</span><span class="sxs-lookup"><span data-stu-id="0481d-186">You can put a *\_PageStart.cshtml* file in the root of the site and in any subfolder.</span></span> <span data-ttu-id="0481d-187">Po żądaniu strony  *\_PageStart.cshtml* pliku działa najważniejsze poziomu (najbardziej zbliżona katalogu głównego witryny), a następnie  *\_PageStart.cshtml* pliku w ciągu następnych podfolder, i tak dalej na dół struktury podfolderów, dopóki żądanie dociera folder, który zawiera żądanej strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-187">When a page is requested, the *\_PageStart.cshtml* file at the top-most level (nearest to the site root) runs, followed by the *\_PageStart.cshtml* file in the next subfolder, and so on down the subfolder structure until the request reaches the folder that contains the requested page.</span></span> <span data-ttu-id="0481d-188">Po wszystkich odpowiednich  *\_PageStart.cshtml* pliki zostały uruchomione, jest uruchamiane w żądanej strony.</span><span class="sxs-lookup"><span data-stu-id="0481d-188">After all the applicable *\_PageStart.cshtml* files have run, the requested page runs.</span></span>

<span data-ttu-id="0481d-189">Na przykład może zawierać następujących kombinacji  *\_PageStart.cshtml* plików i *Default.cshtml* pliku:</span><span class="sxs-lookup"><span data-stu-id="0481d-189">For example, you might have the following combination of *\_PageStart.cshtml* files and *Default.cshtml* file:</span></span>

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample5.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample6.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample7.cshtml)]

<span data-ttu-id="0481d-190">Po uruchomieniu */myfolder/default.cshtml*, zostaną wyświetlone następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="0481d-190">When you run */myfolder/default.cshtml*, you'll see the following:</span></span>

[!code-console[Main](18-customizing-site-wide-behavior/samples/sample8.cmd)]

## <a name="running-initialization-code-for-all-pages-in-a-folder"></a><span data-ttu-id="0481d-191">Uruchamianie kodu inicjowania dla wszystkich stron w folderze</span><span class="sxs-lookup"><span data-stu-id="0481d-191">Running Initialization Code for All Pages in a Folder</span></span>

<span data-ttu-id="0481d-192">Dobrze Wykorzystaj dla  *\_PageStart.cshtml* pliki, które jest zainicjowanie tej samej strony układu dla wszystkich plików w jednym folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-192">A good use for *\_PageStart.cshtml* files is to initialize the same layout page for all files in a single folder.</span></span>

1. <span data-ttu-id="0481d-193">W folderze głównym, Utwórz nowy folder o nazwie *InitPages*.</span><span class="sxs-lookup"><span data-stu-id="0481d-193">In the root folder, create a new folder named *InitPages*.</span></span>
2. <span data-ttu-id="0481d-194">W *InitPages* folderu witryny sieci Web, Utwórz plik o nazwie  *\_PageStart.cshtml* i zastąp go następującym domyślne znaczników i kodu:</span><span class="sxs-lookup"><span data-stu-id="0481d-194">In the *InitPages* folder of your website, create a file named *\_PageStart.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample9.cshtml)]
3. <span data-ttu-id="0481d-195">W katalogu głównym witryny sieci Web utwórz folder o nazwie *Shared*.</span><span class="sxs-lookup"><span data-stu-id="0481d-195">In the root of the website, create a folder named *Shared*.</span></span>
4. <span data-ttu-id="0481d-196">W *Shared* folderze utwórz plik o nazwie  *\_Layout1.cshtml* i zastąp go następującym domyślne znaczników i kodu:</span><span class="sxs-lookup"><span data-stu-id="0481d-196">In the *Shared* folder, create a file named *\_Layout1.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample10.cshtml)]
5. <span data-ttu-id="0481d-197">W *InitPages* folderze utwórz plik o nazwie *Content1.cshtml* i Zastąp istniejącą zawartość następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-197">In the *InitPages* folder, create a file named *Content1.cshtml* and replace the existing content with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample11.html)]
6. <span data-ttu-id="0481d-198">W *InitPages* folderze utwórz plik o nazwie *Content2.cshtml* i Zastąp znaczniki domyślne następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-198">In the *InitPages* folder, create another file named *Content2.cshtml* and replace the default markup with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample12.html)]
7. <span data-ttu-id="0481d-199">Uruchom *Content1.cshtml* w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-199">Run *Content1.cshtml* in a browser.</span></span> 

    ![[image]](18-customizing-site-wide-behavior/_static/image4.jpg)

    <span data-ttu-id="0481d-201">Gdy *Content1.cshtml* stronie przebiegów,  *\_PageStart.cshtml* plików zestawów `Layout` , a także ustawia `PageData["MyBackground"]` na kolor.</span><span class="sxs-lookup"><span data-stu-id="0481d-201">When the *Content1.cshtml* page runs, the *\_PageStart.cshtml* file sets `Layout` and also sets `PageData["MyBackground"]` to a color.</span></span> <span data-ttu-id="0481d-202">W *Content1.cshtml*, układ i kolory są stosowane.</span><span class="sxs-lookup"><span data-stu-id="0481d-202">In *Content1.cshtml*, the layout and color are applied.</span></span>
8. <span data-ttu-id="0481d-203">Wyświetlanie *Content2.cshtml* w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-203">Display *Content2.cshtml* in a browser.</span></span> 

    <span data-ttu-id="0481d-204">Układ jest taki sam, ponieważ obie strony używają tej samej strony układu i kolorów, jak zainicjować w  *\_PageStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-204">The layout is the same, because both pages use the same layout page and color as initialized in *\_PageStart.cshtml*.</span></span>

## <a name="using-pagestartcshtml-to-handle-errors"></a><span data-ttu-id="0481d-205">Za pomocą \_PageStart.cshtml do obsługi błędów</span><span class="sxs-lookup"><span data-stu-id="0481d-205">Using \_PageStart.cshtml to Handle Errors</span></span>

<span data-ttu-id="0481d-206">Dobre innym na użytek  *\_PageStart.cshtml* pliku polega na utworzeniu sposób obsługi błędy programowania (wyjątki), które mogą występować w dowolnym *.cshtml* strony w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-206">Another good use for the *\_PageStart.cshtml* file is to create a way to handle programming errors (exceptions) that might occur in any *.cshtml* page in a folder.</span></span> <span data-ttu-id="0481d-207">W tym przykładzie przedstawiono jeden ze sposobów.</span><span class="sxs-lookup"><span data-stu-id="0481d-207">This example shows you one way to do this.</span></span>

1. <span data-ttu-id="0481d-208">W folderze głównym Utwórz folder o nazwie *InitCatch*.</span><span class="sxs-lookup"><span data-stu-id="0481d-208">In the root folder, create a folder named *InitCatch*.</span></span>
2. <span data-ttu-id="0481d-209">W *InitCatch* folderu witryny sieci Web, Utwórz plik o nazwie  *\_PageStart.cshtml* i Zastąp istniejące znaczników i kodu poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-209">In the *InitCatch* folder of your website, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample13.cshtml)]

    <span data-ttu-id="0481d-210">W tym kodzie spróbujesz jawnie uruchomiony żądanej strony, wywołując `RunPage` metody w ramach `try` bloku.</span><span class="sxs-lookup"><span data-stu-id="0481d-210">In this code, you try running the requested page explicitly by calling the `RunPage` method inside a `try` block.</span></span> <span data-ttu-id="0481d-211">Jeśli wystąpią błędy programowania w żądanej strony, kod wewnątrz `catch` block przebiegów.</span><span class="sxs-lookup"><span data-stu-id="0481d-211">If any programming errors occur in the requested page, the code inside the `catch` block runs.</span></span> <span data-ttu-id="0481d-212">W tym przypadku kod wykonuje przekierowanie do strony (*Error.cshtml*) i przekazuje nazwę pliku, w którym wystąpił błąd jako część adresu URL.</span><span class="sxs-lookup"><span data-stu-id="0481d-212">In this case, the code redirects to a page (*Error.cshtml*) and passes the name of the file that experienced the error as part of the URL.</span></span> <span data-ttu-id="0481d-213">(Utworzysz stronę wkrótce.)</span><span class="sxs-lookup"><span data-stu-id="0481d-213">(You'll create the page shortly.)</span></span>
3. <span data-ttu-id="0481d-214">W *InitCatch* folderu witryny sieci Web, Utwórz plik o nazwie *Exception.cshtml* i Zastąp istniejące znaczników i kodu poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-214">In the *InitCatch* folder of your website, create a file named *Exception.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample14.cshtml)]

    <span data-ttu-id="0481d-215">Do celów tego przykładu wykonujesz na tej stronie celowo tworzy błąd, spróbuj ponownie otworzyć plik bazy danych, który nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="0481d-215">For purposes of this example, what you're doing in this page is deliberately creating an error by trying to open a database file that doesn't exist.</span></span>
4. <span data-ttu-id="0481d-216">W folderze głównym, Utwórz plik o nazwie *Error.cshtml* i Zastąp istniejące znaczników i kodu poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-216">In the root folder, create a file named *Error.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample15.html)]

    <span data-ttu-id="0481d-217">Na tej stronie wyrażenia `@Request["source"]` pobiera wartość z adresu URL i wyświetla je.</span><span class="sxs-lookup"><span data-stu-id="0481d-217">In this page, the expression `@Request["source"]` gets the value out of the URL and displays it.</span></span>
5. <span data-ttu-id="0481d-218">Na pasku narzędzi kliknij **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="0481d-218">In the toolbar, click **Save**.</span></span>
6. <span data-ttu-id="0481d-219">Uruchom *Exception.cshtml* w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-219">Run *Exception.cshtml* in a browser.</span></span> 

    ![[image]](18-customizing-site-wide-behavior/_static/image5.jpg)

    <span data-ttu-id="0481d-221">Ponieważ wystąpienia błędu w *Exception.cshtml*,  *\_PageStart.cshtml* strona przekierowuje do *Error.cshtml* pliku, który wyświetla komunikat.</span><span class="sxs-lookup"><span data-stu-id="0481d-221">Because an error occurs in *Exception.cshtml*, the *\_PageStart.cshtml* page redirects to the *Error.cshtml* file, which displays the message.</span></span>

    <span data-ttu-id="0481d-222">Aby uzyskać więcej informacji na temat wyjątków, zobacz [wprowadzenie do platformy ASP.NET Web Pages programowania z użyciem składni Razor](https://go.microsoft.com/fwlink/?LinkID=251587).</span><span class="sxs-lookup"><span data-stu-id="0481d-222">For more information about exceptions, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587).</span></span>

<a id="Using__PageStart.cshtml_to_Restrict_Folder_Access"></a>
## <a name="using-pagestartcshtml-to-restrict-folder-access"></a><span data-ttu-id="0481d-223">Za pomocą \_PageStart.cshtml, aby ograniczyć dostęp do folderów</span><span class="sxs-lookup"><span data-stu-id="0481d-223">Using \_PageStart.cshtml to Restrict Folder Access</span></span>

<span data-ttu-id="0481d-224">Można również użyć  *\_PageStart.cshtml* plik, aby ograniczyć dostęp do wszystkich plików w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-224">You can also use the *\_PageStart.cshtml* file to restrict access to all the files in a folder.</span></span>

1. <span data-ttu-id="0481d-225">W programie WebMatrix, utworzyć nową witrynę sieci Web, używając **lokacji za pomocą szablonu** opcji.</span><span class="sxs-lookup"><span data-stu-id="0481d-225">In WebMatrix, create a new website using the **Site From Template** option.</span></span>
2. <span data-ttu-id="0481d-226">Wybierz z dostępnych szablonów **witryny początkowej**.</span><span class="sxs-lookup"><span data-stu-id="0481d-226">From the available templates, select **Starter Site**.</span></span>
3. <span data-ttu-id="0481d-227">W folderze głównym Utwórz folder o nazwie *AuthenticatedContent*.</span><span class="sxs-lookup"><span data-stu-id="0481d-227">In the root folder, create a folder named *AuthenticatedContent*.</span></span>
4. <span data-ttu-id="0481d-228">W *AuthenticatedContent* folderze utwórz plik o nazwie  *\_PageStart.cshtml* i Zastąp istniejące znaczników i kodu poniższym kodem:</span><span class="sxs-lookup"><span data-stu-id="0481d-228">In the *AuthenticatedContent* folder, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample16.cshtml)]

    <span data-ttu-id="0481d-229">Zaczyna się kod, uniemożliwiając wszystkie pliki w folderze pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0481d-229">The code starts by preventing all files in the folder from being cached.</span></span> <span data-ttu-id="0481d-230">(Jest to wymagane dla scenariuszy, takich jak komputery publiczne, których nie chcesz buforowanych stron jednego użytkownika mają być dostępne dla następnego użytkownika.) Następnie kod określa, czy użytkownik zalogował się na lokacji zanim można wyświetlić dowolnej strony w folderze.</span><span class="sxs-lookup"><span data-stu-id="0481d-230">(This is required for scenarios like public computers, where you don't want one user's cached pages to be available to the next user.) Next, the code determines whether the user has signed in to the site before they can view any of the pages in the folder.</span></span> <span data-ttu-id="0481d-231">Jeśli użytkownik nie jest zalogowany, kod wykonuje przekierowanie do strony logowania.</span><span class="sxs-lookup"><span data-stu-id="0481d-231">If the user is not signed in, the code redirects to the login page.</span></span> <span data-ttu-id="0481d-232">Na stronie logowania może zwrócić użytkownika do strony, która pierwotnie żądaną Jeśli dołączysz wartość ciągu kwerendy o nazwie `ReturnUrl`.</span><span class="sxs-lookup"><span data-stu-id="0481d-232">The login page can return the user to the page that was originally requested if you include a query string value named `ReturnUrl`.</span></span>
5. <span data-ttu-id="0481d-233">Utwórz nową stronę w *AuthenticatedContent* folder o nazwie *Page.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="0481d-233">Create a new page in the *AuthenticatedContent* folder named *Page.cshtml*.</span></span>
6. <span data-ttu-id="0481d-234">Zastąp następujące znaczniki domyślne:</span><span class="sxs-lookup"><span data-stu-id="0481d-234">Replace the default markup with the following:</span></span>  

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample17.cshtml)]
7. <span data-ttu-id="0481d-235">Uruchom *Page.cshtml* w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0481d-235">Run *Page.cshtml* in a browser.</span></span> <span data-ttu-id="0481d-236">Kod wykonuje przekierowanie do strony logowania.</span><span class="sxs-lookup"><span data-stu-id="0481d-236">The code redirects you to a login page.</span></span> <span data-ttu-id="0481d-237">Musisz się zarejestrować, przed zalogowaniem się.</span><span class="sxs-lookup"><span data-stu-id="0481d-237">You must register before logging in.</span></span> <span data-ttu-id="0481d-238">Po został zarejestrowany i zalogować, można przejść do strony i wyświetlić jego zawartość.</span><span class="sxs-lookup"><span data-stu-id="0481d-238">After you've registered and logged in, you can navigate to the page and view its contents.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="0481d-239">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="0481d-239">Additional Resources</span></span>

[<span data-ttu-id="0481d-240">Wprowadzenie do programowania z użyciem składni Razor strony sieci Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0481d-240">Introduction to ASP.NET Web Pages Programming Using the Razor Syntax</span></span>](https://go.microsoft.com/fwlink/?LinkID=251587)
