---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Członkostwo i administracja | Microsoft Docs
author: Erikre
description: Ta seria samouczków zawiera informacje na temat tworzenia aplikacji ASP.NET Web Forms przy użyciu ASP.NET 4,5 i Microsoft Visual Studio Express 2013...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: ab00bc90bfc767d06e747be6dfb973245b5aae88
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78546740"
---
# <a name="membership-and-administration"></a><span data-ttu-id="57c8d-103">Członkostwo i administracja</span><span class="sxs-lookup"><span data-stu-id="57c8d-103">Membership and Administration</span></span>

<span data-ttu-id="57c8d-104">Autor [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="57c8d-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="57c8d-105">[Pobierz program Wingtip zabawki (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) lub [Pobierz książkę elektroniczną (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="57c8d-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="57c8d-106">Ta seria samouczków zawiera informacje na temat tworzenia aplikacji ASP.NET Web Forms przy użyciu ASP.NET 4,5 i Microsoft Visual Studio Express 2013 dla sieci Web.</span><span class="sxs-lookup"><span data-stu-id="57c8d-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="57c8d-107">Projekt Visual Studio 2013 [z C# kodem źródłowym](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) jest dostępny do tej serii samouczków.</span><span class="sxs-lookup"><span data-stu-id="57c8d-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="57c8d-108">W tym samouczku pokazano, jak zaktualizować przykładową aplikację Wingtip zabawki, aby dodać rolę niestandardową i użyć ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="57c8d-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="57c8d-109">Przedstawiono w nim również sposób implementacji strony administracyjnej, z której użytkownik mający rolę niestandardową może dodawać i usuwać produkty z witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="57c8d-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="57c8d-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) to system członkostwa używany do kompilowania aplikacji sieci Web ASP.NET i jest dostępny w ASP.NET 4,5.</span><span class="sxs-lookup"><span data-stu-id="57c8d-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="57c8d-111">ASP.NET Identity jest używany w szablonie projektu Visual Studio 2013 Web Forms, a także szablony dla [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md)i [ASP.NET aplikacji jednostronicowej](../../../../single-page-application/index.md).</span><span class="sxs-lookup"><span data-stu-id="57c8d-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="57c8d-112">Możesz również zainstalować system ASP.NET Identity przy użyciu narzędzia NuGet, gdy zaczniesz od pustej aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="57c8d-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="57c8d-113">Jednak w tej serii samouczków używasz ProjectTemplate **formularzy sieci Web**, który zawiera system ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="57c8d-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="57c8d-114">ASP.NET Identity ułatwia integrację danych profilu specyficznych dla użytkownika z danymi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="57c8d-115">Ponadto ASP.NET Identity umożliwia wybranie modelu trwałości dla profilów użytkowników w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="57c8d-116">Dane można przechowywać w bazie danych SQL Server lub w innym magazynie danych, w tym z magazynami danych *NoSQL* , takimi jak tabele magazynu systemu Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="57c8d-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="57c8d-117">Ten samouczek jest oparty na poprzednim samouczku zatytułowanym "Wyewidencjonowywanie i płatność w systemie PayPal" w serii samouczków Wingtip.</span><span class="sxs-lookup"><span data-stu-id="57c8d-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="57c8d-118">Zawartość:</span><span class="sxs-lookup"><span data-stu-id="57c8d-118">What you'll learn:</span></span>

- <span data-ttu-id="57c8d-119">Jak dodać rolę niestandardową i użytkownika do aplikacji przy użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="57c8d-120">Jak ograniczyć dostęp do folderu administracyjnego i strony.</span><span class="sxs-lookup"><span data-stu-id="57c8d-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="57c8d-121">Jak zapewnić nawigację dla użytkownika należącego do roli niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="57c8d-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="57c8d-122">Jak użyć powiązania modelu, aby wypełnić formant [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) z kategoriami produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="57c8d-123">Jak przekazać plik do aplikacji sieci Web za pomocą formantu [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="57c8d-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="57c8d-124">Jak zaimplementować sprawdzanie poprawności danych wejściowych przy użyciu kontrolek walidacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="57c8d-125">Jak dodawać i usuwać produkty z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="57c8d-126">Te funkcje są zawarte w samouczku:</span><span class="sxs-lookup"><span data-stu-id="57c8d-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="57c8d-127">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="57c8d-127">ASP.NET Identity</span></span>
- <span data-ttu-id="57c8d-128">Konfiguracja i autoryzacja</span><span class="sxs-lookup"><span data-stu-id="57c8d-128">Configuration and Authorization</span></span>
- <span data-ttu-id="57c8d-129">Powiązanie modelu</span><span class="sxs-lookup"><span data-stu-id="57c8d-129">Model Binding</span></span>
- <span data-ttu-id="57c8d-130">Niezauważalna weryfikacja</span><span class="sxs-lookup"><span data-stu-id="57c8d-130">Unobtrusive Validation</span></span>

<span data-ttu-id="57c8d-131">ASP.NET Web Forms zapewnia możliwość członkostwa.</span><span class="sxs-lookup"><span data-stu-id="57c8d-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="57c8d-132">Przy użyciu szablonu domyślnego masz wbudowaną funkcję członkostwa, która może być używana natychmiast po uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="57c8d-133">W tym samouczku pokazano, jak za pomocą ASP.NET Identity dodawać rolę niestandardową i przypisywać użytkownika do tej roli.</span><span class="sxs-lookup"><span data-stu-id="57c8d-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="57c8d-134">Dowiesz się, jak ograniczyć dostęp do folderu administracyjnego.</span><span class="sxs-lookup"><span data-stu-id="57c8d-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="57c8d-135">Dodasz stronę do folderu Administracja, która umożliwia użytkownikowi z rolą niestandardową Dodawanie i usuwanie produktów oraz wyświetlanie podglądu produktu po jego dodaniu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="57c8d-136">Dodawanie roli niestandardowej</span><span class="sxs-lookup"><span data-stu-id="57c8d-136">Adding a Custom Role</span></span>

<span data-ttu-id="57c8d-137">Za pomocą ASP.NET Identity można dodać rolę niestandardową i przypisać użytkownika do tej roli przy użyciu kodu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="57c8d-138">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy folder *logiki* i Utwórz nową klasę.</span><span class="sxs-lookup"><span data-stu-id="57c8d-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="57c8d-139">Nadaj nowej klasie nazwę *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="57c8d-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="57c8d-140">Zmodyfikuj kod, tak aby pojawił się w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="57c8d-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="57c8d-141">W **Eksplorator rozwiązań**otwórz plik *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="57c8d-142">Zmodyfikuj plik *Global.asax.cs* , dodając kod wyróżniony kolorem żółtym, aby pojawił się w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="57c8d-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="57c8d-143">Zwróć uwagę, że `AddUserAndRole` jest podkreślony na czerwono.</span><span class="sxs-lookup"><span data-stu-id="57c8d-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="57c8d-144">Kliknij dwukrotnie kod AddUserAndRole.</span><span class="sxs-lookup"><span data-stu-id="57c8d-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="57c8d-145">Litera "A" na początku wyróżnionej metody zostanie podkreślona.</span><span class="sxs-lookup"><span data-stu-id="57c8d-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="57c8d-146">Umieść kursor nad literą "A" i kliknij interfejs użytkownika, który umożliwia wygenerowanie klasy zastępczej metody `AddUserAndRole`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![Członkostwo i administracja — generowanie zastępcze metody](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="57c8d-148">Kliknij opcję zatytułowaną:</span><span class="sxs-lookup"><span data-stu-id="57c8d-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="57c8d-149">Otwórz plik *RoleActions.cs* z folderu *Logic* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="57c8d-150">Metoda `AddUserAndRole` została dodana do pliku klasy.</span><span class="sxs-lookup"><span data-stu-id="57c8d-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="57c8d-151">Zmodyfikuj plik *RoleActions.cs* , usuwając `NotImplementedException` i dodając kod wyróżniony kolorem żółtym, tak aby pojawił się w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="57c8d-151">Modify the *RoleActions.cs* file by removing the `NotImplementedException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="57c8d-152">Powyższy kod najpierw ustanawia kontekst bazy danych dla bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="57c8d-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="57c8d-153">Baza danych członkostwa jest również przechowywana jako plik *MDF* w folderze *danych\_aplikacji* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="57c8d-154">Będzie można wyświetlić tę bazę danych, gdy pierwszy użytkownik zaloguje się do tej aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="57c8d-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="57c8d-155">Jeśli chcesz przechowywać dane członkostwa wraz z danymi produktu, możesz rozważyć użycie tego samego **DbContext** , który został użyty do przechowywania danych produktu w powyższym kodzie.</span><span class="sxs-lookup"><span data-stu-id="57c8d-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>

 <span data-ttu-id="57c8d-156">Słowo kluczowe *Internal* jest modyfikatorem dostępu dla typów (takich jak klasy) i składowych typu (takich jak metody lub właściwości).</span><span class="sxs-lookup"><span data-stu-id="57c8d-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="57c8d-157">Typy wewnętrzne lub składowe są dostępne tylko w plikach znajdujących się w tym samym zestawie *(pliku DLL* ).</span><span class="sxs-lookup"><span data-stu-id="57c8d-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="57c8d-158">Podczas kompilowania aplikacji tworzony jest plik zestawu *(. dll*) zawierający kod, który jest wykonywany podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="57c8d-159">Obiekt `RoleStore`, który zapewnia zarządzanie rolami, jest tworzony na podstawie kontekstu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="57c8d-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="57c8d-160">Należy zauważyć, że po utworzeniu obiektu `RoleStore` używa typu ogólnego `IdentityRole`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="57c8d-161">Oznacza to, że `RoleStore` może zawierać tylko obiekty `IdentityRole`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="57c8d-162">Również w przypadku używania typów ogólnych zasoby w pamięci są obsługiwane lepiej.</span><span class="sxs-lookup"><span data-stu-id="57c8d-162">Also by using Generics, resources in memory are handled better.</span></span>

<span data-ttu-id="57c8d-163">Następnie obiekt `RoleManager` jest tworzony na podstawie obiektu `RoleStore`, który właśnie został utworzony.</span><span class="sxs-lookup"><span data-stu-id="57c8d-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="57c8d-164">Obiekt `RoleManager` uwidacznia interfejs API związany z rolą, który może służyć do automatycznego zapisywania zmian w `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="57c8d-165">`RoleManager` może zawierać tylko obiekty `IdentityRole`, ponieważ kod używa typu ogólnego `<IdentityRole>`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="57c8d-166">Należy wywołać metodę `RoleExists`, aby określić, czy w bazie danych członkostwa występuje rola "Anuluj edycję".</span><span class="sxs-lookup"><span data-stu-id="57c8d-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="57c8d-167">Jeśli tak nie jest, tworzysz rolę.</span><span class="sxs-lookup"><span data-stu-id="57c8d-167">If it is not, you create the role.</span></span>

<span data-ttu-id="57c8d-168">Tworzenie obiektu `UserManager` wydaje się bardziej skomplikowane niż kontrolka `RoleManager`, ale jest to niemal takie samo.</span><span class="sxs-lookup"><span data-stu-id="57c8d-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="57c8d-169">Jest on właśnie zakodowany w jednym wierszu, a nie na kilku.</span><span class="sxs-lookup"><span data-stu-id="57c8d-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="57c8d-170">W tym miejscu parametr, który przekazujesz, jest skonkretyzowany jako nowy obiekt zawarty w nawiasie.</span><span class="sxs-lookup"><span data-stu-id="57c8d-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="57c8d-171">Następnie utworzysz użytkownika "canEditUser", tworząc nowy obiekt `ApplicationUser`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="57c8d-172">Następnie w przypadku pomyślnego utworzenia użytkownika należy dodać użytkownika do nowej roli.</span><span class="sxs-lookup"><span data-stu-id="57c8d-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="57c8d-173">Obsługa błędów zostanie zaktualizowana w samouczku "Obsługa błędów ASP.NET" w dalszej części tej serii samouczków.</span><span class="sxs-lookup"><span data-stu-id="57c8d-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>

<span data-ttu-id="57c8d-174">Przy następnym uruchomieniu aplikacji użytkownik o nazwie "canEditUser" zostanie dodany jako rola o nazwie "Red Edit" (Edytuj) aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="57c8d-175">W dalszej części tego samouczka zalogujesz się jako użytkownik "canEditUser", aby wyświetlić dodatkowe funkcje, które zostaną dodane w ramach tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="57c8d-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="57c8d-176">Aby uzyskać szczegółowe informacje dotyczące interfejsu API ASP.NET Identity, zobacz [przestrzeń nazw Microsoft. ASPNET. Identity](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="57c8d-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="57c8d-177">Aby uzyskać dodatkowe informacje na temat inicjowania systemu ASP.NET Identity, zobacz [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="57c8d-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="57c8d-178">Ograniczanie dostępu do strony administracyjnej</span><span class="sxs-lookup"><span data-stu-id="57c8d-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="57c8d-179">Przykładowa aplikacja Wingtip zabawki umożliwia zarówno anonimowym użytkownikom, jak i zalogowanym użytkownikom wyświetlanie i kupowanie produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="57c8d-180">Jednak zalogowany użytkownik, który ma niestandardową rolę "Edytuj", może uzyskać dostęp do strony z ograniczeniami w celu dodawania i usuwania produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="57c8d-181">Dodawanie folderu administracyjnego i strony</span><span class="sxs-lookup"><span data-stu-id="57c8d-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="57c8d-182">Następnie utworzysz folder o nazwie *admin* dla użytkownika "canEditUser" należącego do niestandardowej roli aplikacji przykładowej programu Wingtip zabawki.</span><span class="sxs-lookup"><span data-stu-id="57c8d-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="57c8d-183">Kliknij prawym przyciskiem myszy nazwę projektu (**zabawki Wingtip**) w **Eksplorator rozwiązań** a następnie wybierz pozycję **Dodaj** -&gt; **Nowy folder**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="57c8d-184">Nadaj nowemu folderowi nazwę *administrator*.</span><span class="sxs-lookup"><span data-stu-id="57c8d-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="57c8d-185">Kliknij prawym przyciskiem myszy folder *administrator* , a następnie wybierz pozycję **Dodaj** -&gt; **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="57c8d-186">Zostanie wyświetlone okno dialogowe **Dodaj nowy element** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="57c8d-187">Wybierz grupę szablonów <strong>sieci Web</strong> <strong>Visual C#</strong> -&gt; po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="57c8d-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="57c8d-188">Z listy środkowej wybierz pozycję <strong>formularz sieci Web ze stroną wzorcową</strong>, nadaj jej nazwę <em>AdminPage. aspx</em><strong>,</strong> a następnie wybierz pozycję <strong>Dodaj</strong>.</span><span class="sxs-lookup"><span data-stu-id="57c8d-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="57c8d-189">Wybierz plik *site. Master* jako stronę wzorcową, a następnie wybierz przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="57c8d-190">Dodaj plik Web. config</span><span class="sxs-lookup"><span data-stu-id="57c8d-190">Add a Web.config File</span></span>

<span data-ttu-id="57c8d-191">Dodając plik *Web. config* do folderu *admin* , możesz ograniczyć dostęp do strony zawartej w folderze.</span><span class="sxs-lookup"><span data-stu-id="57c8d-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="57c8d-192">Kliknij prawym przyciskiem myszy folder *administrator* i wybierz polecenie **Dodaj** -&gt; **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="57c8d-193">Zostanie wyświetlone okno dialogowe **Dodaj nowy element** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="57c8d-194">Z C# listy Visual Webtemplates wybierz pozycję <strong>plik konfiguracji sieci Web</strong>z listy środkowej, zaakceptuj domyślną nazwę pliku <em>Web. config</em><strong>,</strong> a następnie wybierz pozycję <strong>Dodaj</strong>.</span><span class="sxs-lookup"><span data-stu-id="57c8d-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="57c8d-195">Zastąp istniejącą zawartość XML w pliku *Web. config* następującym:</span><span class="sxs-lookup"><span data-stu-id="57c8d-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="57c8d-196">Zapisz plik *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-196">Save the *Web.config* file.</span></span> <span data-ttu-id="57c8d-197">Plik *Web. config* określa, że tylko użytkownik należący do roli "po edycji" aplikacji może uzyskać dostęp do strony zawartej w folderze *administratora* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="57c8d-198">Dołączenie do nawigacji roli niestandardowej</span><span class="sxs-lookup"><span data-stu-id="57c8d-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="57c8d-199">Aby włączyć użytkownika niestandardowej roli "Edytuj" w celu przejścia do sekcji Administracja aplikacji, należy dodać łącze do strony *site. Master* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="57c8d-200">Tylko użytkownicy należący do roli "Edytuj" będą mogli zobaczyć link **administratora** i uzyskać dostęp do sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="57c8d-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="57c8d-201">W Eksplorator rozwiązań Znajdź i Otwórz stronę *site. Master* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="57c8d-202">Aby utworzyć łącze dla użytkownika roli "Edytuj", należy dodać znaczniki wyróżnione kolorem żółtym do poniższej listy nieuporządkowanej `<ul>` elementu, aby lista pojawiła się w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="57c8d-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="57c8d-203">Otwórz plik *site.Master.cs* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="57c8d-204">Ustaw łącze **administratora** jako widoczne tylko dla użytkownika "canEditUser", dodając kod wyróżniony kolorem żółtym do procedury obsługi `Page_Load`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="57c8d-205">Procedura obsługi `Page_Load` zostanie wyświetlona w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="57c8d-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="57c8d-206">Po załadowaniu strony kod sprawdza, czy zalogowany użytkownik ma rolę "Edytuj".</span><span class="sxs-lookup"><span data-stu-id="57c8d-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="57c8d-207">Jeśli użytkownik należy do roli "Edytuj", element span zawierający link do strony *AdminPage. aspx* (i w związku z tym link wewnątrz zakresu) jest widoczny.</span><span class="sxs-lookup"><span data-stu-id="57c8d-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="57c8d-208">Włączanie administrowania produktem</span><span class="sxs-lookup"><span data-stu-id="57c8d-208">Enabling Product Administration</span></span>

<span data-ttu-id="57c8d-209">Do tej pory utworzono rolę "Red Edit" i dodano użytkownika "canEditUser", folder administracyjny i stronę administracyjną.</span><span class="sxs-lookup"><span data-stu-id="57c8d-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="57c8d-210">Użytkownik ustawił prawa dostępu do folderu administracyjnego i strony i dodał link nawigacji dla użytkownika roli "Edytuj" do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="57c8d-211">Następnie dodasz znaczniki do strony *AdminPage. aspx* i kodu do pliku *AdminPage.aspx.cs* z kodem, który umożliwi użytkownikowi z rolą "Edytuj", Dodawanie i usuwanie produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="57c8d-212">W **Eksplorator rozwiązań**Otwórz plik *AdminPage. aspx* z folderu *admin* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="57c8d-213">Zastąp istniejący znacznik następującym:</span><span class="sxs-lookup"><span data-stu-id="57c8d-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="57c8d-214">Następnie otwórz plik związany z kodem *AdminPage.aspx.cs* , klikając prawym przyciskiem myszy *AdminPage. aspx* i klikając polecenie **Wyświetl kod**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="57c8d-215">Zastąp istniejący kod w pliku z kodem *AdminPage.aspx.cs* następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="57c8d-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="57c8d-216">W kodzie, który został wprowadzony dla pliku z kodem *AdminPage.aspx.cs* , Klasa o nazwie `AddProducts` wykonuje rzeczywistą służbę dodawania produktów do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="57c8d-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="57c8d-217">Ta klasa jeszcze nie istnieje, więc utworzysz ją teraz.</span><span class="sxs-lookup"><span data-stu-id="57c8d-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="57c8d-218">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy folder *logiki* , a następnie wybierz pozycję **Dodaj** -&gt; **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="57c8d-219">Zostanie wyświetlone okno dialogowe **Dodaj nowy element** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="57c8d-220">Wybierz grupę **Visual C#**  \*\* -&gt; szablon\*\* szablony po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="57c8d-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="57c8d-221">Następnie wybierz pozycję **Klasa**z listy Środkowej i nadaj jej nazwę *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="57c8d-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="57c8d-222">Zostanie wyświetlony nowy plik klasy.</span><span class="sxs-lookup"><span data-stu-id="57c8d-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="57c8d-223">Zastąp istniejący kod następującym:</span><span class="sxs-lookup"><span data-stu-id="57c8d-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="57c8d-224">Strona *AdminPage. aspx* zezwala użytkownikowi należącemu do roli "Edytuj" w celu dodawania i usuwania produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="57c8d-225">Po dodaniu nowego produktu szczegóły dotyczące produktu są sprawdzane, a następnie wprowadzane do bazy danych programu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="57c8d-226">Nowy produkt jest natychmiast dostępny dla wszystkich użytkowników aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="57c8d-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="57c8d-227">Niezauważalna weryfikacja</span><span class="sxs-lookup"><span data-stu-id="57c8d-227">Unobtrusive Validation</span></span>

<span data-ttu-id="57c8d-228">Szczegóły produktu udostępniane przez użytkownika na stronie *AdminPage. aspx* są weryfikowane przy użyciu kontrolek weryfikacji (`RequiredFieldValidator` i `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="57c8d-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="57c8d-229">Te kontrolki automatycznie używają niezauważalnej weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="57c8d-230">Niedyskretna Walidacja umożliwia kontrolom walidacji używanie języka JavaScript dla logiki walidacji po stronie klienta, co oznacza, że strona nie będzie wymagała sprawdzenia poprawności na serwerze.</span><span class="sxs-lookup"><span data-stu-id="57c8d-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="57c8d-231">Domyślnie niedyskretna weryfikacja jest zawarta w pliku *Web. config* na podstawie następującego ustawienia konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="57c8d-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="57c8d-232">Wyrażenia regularne</span><span class="sxs-lookup"><span data-stu-id="57c8d-232">Regular Expressions</span></span>

<span data-ttu-id="57c8d-233">Cena produktu na stronie *AdminPage. aspx* jest weryfikowana przy użyciu kontrolki **RegularExpressionValidator** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="57c8d-234">Ta kontrolka sprawdza, czy wartość skojarzonej kontrolki wejściowej (pole tekstowe "AddProductPrice") pasuje do wzorca określonego przez wyrażenie regularne.</span><span class="sxs-lookup"><span data-stu-id="57c8d-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="57c8d-235">Wyrażenie regularne jest notacją zgodną z wzorcem, która umożliwia szybkie znajdowanie i dopasowywanie określonych wzorców znaków.</span><span class="sxs-lookup"><span data-stu-id="57c8d-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="57c8d-236">Formant **RegularExpressionValidator** zawiera właściwość o nazwie `ValidationExpression`, która zawiera wyrażenie regularne używane do walidacji danych wejściowych ceny, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="57c8d-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="57c8d-237">FileUpload — formant</span><span class="sxs-lookup"><span data-stu-id="57c8d-237">FileUpload Control</span></span>

<span data-ttu-id="57c8d-238">Oprócz formantów wejściowych i walidacji dodano formant **FileUpload** do strony *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="57c8d-239">Ta kontrolka zapewnia możliwość przekazywania plików.</span><span class="sxs-lookup"><span data-stu-id="57c8d-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="57c8d-240">W takim przypadku zezwalasz tylko na przekazywanie plików obrazów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="57c8d-241">W pliku związanym z kodem (*AdminPage.aspx.cs*), gdy kliknięto `AddProductButton`, kod sprawdza Właściwość `HasFile` kontrolki **FileUpload** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="57c8d-242">Jeśli kontrolka zawiera plik i jeśli typ pliku (na podstawie rozszerzenia pliku) jest dozwolony, obraz jest zapisywany w folderze *obrazy* i folderze *obrazy/kciuki* aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="57c8d-243">Powiązanie modelu</span><span class="sxs-lookup"><span data-stu-id="57c8d-243">Model Binding</span></span>

<span data-ttu-id="57c8d-244">Wcześniej w tej serii samouczków użyto powiązania modelu do wypełnienia kontrolki **ListView** , kontrolki **FormsView** , kontrolki **GridView** i kontrolki **kontrolką detailview** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="57c8d-245">W tym samouczku użyjesz powiązania modelu, aby wypełnić formant **DropDownList** z listą kategorii produktów.</span><span class="sxs-lookup"><span data-stu-id="57c8d-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="57c8d-246">Znacznik dodany do pliku *AdminPage. aspx* zawiera kontrolkę **DropDownList** o nazwie `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="57c8d-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="57c8d-247">Aby wypełnić to **DropDownList** , należy użyć powiązania modelu, ustawiając atrybut `ItemType` i atrybut `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="57c8d-248">Atrybut `ItemType` określa, że należy użyć typu `WingtipToys.Models.Category` podczas wypełniania formantu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="57c8d-249">Ten typ został zdefiniowany na początku tej serii samouczków przez utworzenie klasy `Category` (pokazanej poniżej).</span><span class="sxs-lookup"><span data-stu-id="57c8d-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="57c8d-250">Klasa `Category` znajduje się w folderze *models* wewnątrz pliku *Category.cs* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="57c8d-251">Atrybut `SelectMethod` formantu **DropDownList** określa, że należy użyć metody `GetCategories` (pokazanej poniżej), która jest uwzględniona w pliku związanym z kodem (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="57c8d-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="57c8d-252">Ta metoda określa, że interfejs `IQueryable` służy do szacowania zapytania względem typu `Category`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="57c8d-253">Zwracana wartość jest używana do wypełniania **DropDownList** w znaczniku strony (*AdminPage. aspx*).</span><span class="sxs-lookup"><span data-stu-id="57c8d-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="57c8d-254">Tekst wyświetlany dla każdego elementu na liście jest określany przez ustawienie atrybutu `DataTextField`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="57c8d-255">Atrybut `DataTextField` używa `CategoryName` klasy `Category` (pokazany powyżej) do wyświetlania każdej kategorii w kontrolce **DropDownList** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="57c8d-256">Wartość rzeczywista, która jest przesyłana po wybraniu elementu w kontrolce **DropDownList** , jest oparta na atrybucie `DataValueField`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="57c8d-257">Atrybut `DataValueField` jest ustawiany na `CategoryID`, jak zdefiniowano w klasie `Category` (pokazany powyżej).</span><span class="sxs-lookup"><span data-stu-id="57c8d-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="57c8d-258">Jak działa aplikacja</span><span class="sxs-lookup"><span data-stu-id="57c8d-258">How the Application Will Work</span></span>

<span data-ttu-id="57c8d-259">Gdy użytkownik należący do roli "" Edytuj "nawiguje do strony po raz pierwszy, formant `DropDownAddCategory`**DropDownList** jest wypełniany zgodnie z powyższym opisem.</span><span class="sxs-lookup"><span data-stu-id="57c8d-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="57c8d-260">Formant **DropDownList** `DropDownRemoveProduct`jest również wypełniany produktami przy użyciu tego samego podejścia.</span><span class="sxs-lookup"><span data-stu-id="57c8d-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="57c8d-261">Użytkownik należący do roli "Edytuj" wybiera typ kategorii i dodaje szczegóły produktu (**Nazwa**, **Opis**, **Cena**i **plik obrazu**).</span><span class="sxs-lookup"><span data-stu-id="57c8d-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="57c8d-262">Gdy użytkownik należący do roli "edytujesz" kliknie przycisk **Dodaj produkt** , zostanie wyzwolona obsługa zdarzeń `AddProductButton_Click`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="57c8d-263">Program obsługi zdarzeń `AddProductButton_Click` znajdujący się w pliku związanym z kodem (*AdminPage.aspx.cs*) sprawdza plik obrazu, aby upewnić się, że jest zgodny z dozwolonymi typami plików *(GIF*, *PNG*, *JPEG*lub *jpg*).</span><span class="sxs-lookup"><span data-stu-id="57c8d-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="57c8d-264">Następnie plik obrazu jest zapisywany w folderze przykładowej aplikacji Wingtip zabawki.</span><span class="sxs-lookup"><span data-stu-id="57c8d-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="57c8d-265">Następnie nowy produkt zostanie dodany do bazy danych programu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="57c8d-266">Aby wykonać Dodawanie nowego produktu, tworzone jest nowe wystąpienie klasy `AddProducts` i nazwane produkty.</span><span class="sxs-lookup"><span data-stu-id="57c8d-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="57c8d-267">Klasa `AddProducts` ma metodę o nazwie `AddProduct`, a obiekt Products wywołuje tę metodę, aby dodać produkty do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="57c8d-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="57c8d-268">Jeśli kod pomyślnie dodaje nowy produkt do bazy danych, Strona zostanie ponownie załadowana przy użyciu wartości ciągu zapytania `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="57c8d-269">Po ponownym załadowaniu strony ciąg zapytania jest uwzględniany w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="57c8d-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="57c8d-270">Po ponownym załadowaniu strony użytkownik należący do roli "Edytuj" może natychmiast zobaczyć aktualizacje w kontrolkach **DropDownList** na stronie *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="57c8d-271">Ponadto, dołączając ciąg zapytania z adresem URL, na stronie może zostać wyświetlony komunikat o powodzeniu należący do roli "Edytuj".</span><span class="sxs-lookup"><span data-stu-id="57c8d-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="57c8d-272">Po ponownym załadowaniu strony *AdminPage. aspx* zostanie wywołane zdarzenie `Page_Load`.</span><span class="sxs-lookup"><span data-stu-id="57c8d-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="57c8d-273">Program obsługi zdarzeń `Page_Load` sprawdza wartość ciągu zapytania i określa, czy ma być pokazywany komunikat o powodzeniu.</span><span class="sxs-lookup"><span data-stu-id="57c8d-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="57c8d-274">Uruchamianie aplikacji</span><span class="sxs-lookup"><span data-stu-id="57c8d-274">Running the Application</span></span>

<span data-ttu-id="57c8d-275">Teraz możesz uruchomić aplikację, aby zobaczyć, jak można dodawać, usuwać i aktualizować elementy w koszyku.</span><span class="sxs-lookup"><span data-stu-id="57c8d-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="57c8d-276">Kwota koszyka zakupów będzie odzwierciedlać łączny koszt wszystkich elementów w koszyku.</span><span class="sxs-lookup"><span data-stu-id="57c8d-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="57c8d-277">W Eksplorator rozwiązań naciśnij klawisz **F5** , aby uruchomić przykładową aplikację z programem Wingtip.</span><span class="sxs-lookup"><span data-stu-id="57c8d-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="57c8d-278">Zostanie otwarta przeglądarka i zostanie wyświetlona strona *default. aspx* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="57c8d-279">Kliknij link **Zaloguj** się u góry strony.</span><span class="sxs-lookup"><span data-stu-id="57c8d-279">Click the **Log in** link at the top of the page.</span></span> 

    ![Członkostwo i administracja — link do logowania](membership-and-administration/_static/image2.png)

   <span data-ttu-id="57c8d-281">Zostanie wyświetlona strona *login. aspx* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="57c8d-282">Użyj następującej nazwy użytkownika i hasła:</span><span class="sxs-lookup"><span data-stu-id="57c8d-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="57c8d-283">Nazwa użytkownika: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="57c8d-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="57c8d-284">Hasło: PA $ $word 1</span><span class="sxs-lookup"><span data-stu-id="57c8d-284">Password: Pa$$word1</span></span> 

    ![Członkostwo i administracja — Strona logowania](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="57c8d-286">Kliknij przycisk **Zaloguj się w** dolnej części strony.</span><span class="sxs-lookup"><span data-stu-id="57c8d-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="57c8d-287">W górnej części następnej strony wybierz łącze **administratora** , aby przejść do strony *AdminPage. aspx* .</span><span class="sxs-lookup"><span data-stu-id="57c8d-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![Członkostwo i administracja — link administracyjny](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="57c8d-289">Aby przetestować sprawdzanie poprawności danych wejściowych, kliknij przycisk **Dodaj produkt** bez dodawania szczegółowych informacji o produkcie.</span><span class="sxs-lookup"><span data-stu-id="57c8d-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Członkostwo i administracja — Strona administracyjna](membership-and-administration/_static/image5.png)

   <span data-ttu-id="57c8d-291">Zauważ, że wyświetlane są wymagane komunikaty pól.</span><span class="sxs-lookup"><span data-stu-id="57c8d-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="57c8d-292">Dodaj szczegóły nowego produktu, a następnie kliknij przycisk **Dodaj produkt** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Członkostwo i administracja — Dodawanie produktu](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="57c8d-294">Wybierz pozycję **produkty** z górnego menu nawigacji, aby wyświetlić nowy produkt, który został dodany.</span><span class="sxs-lookup"><span data-stu-id="57c8d-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Członkostwo i administracja — Pokaż nowy produkt](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="57c8d-296">Kliknij link **administratora** , aby powrócić do strony Administracja.</span><span class="sxs-lookup"><span data-stu-id="57c8d-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="57c8d-297">W sekcji **Usuń produkt** na stronie wybierz nowy produkt, który został dodany do **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="57c8d-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="57c8d-298">Kliknij przycisk **Usuń produkt** , aby usunąć nowy produkt z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Członkostwo i administracja — usuwanie produktu](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="57c8d-300">Wybierz pozycję **produkty** z górnego menu nawigacji, aby potwierdzić, że produkt został usunięty.</span><span class="sxs-lookup"><span data-stu-id="57c8d-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="57c8d-301">Kliknij pozycję **Wyloguj** się, aby istnieć tryb administrowania.</span><span class="sxs-lookup"><span data-stu-id="57c8d-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="57c8d-302">Należy zauważyć, że Górne okienko nawigacji nie pokazuje już elementu menu **administratora** .</span><span class="sxs-lookup"><span data-stu-id="57c8d-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="57c8d-303">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="57c8d-303">Summary</span></span>

<span data-ttu-id="57c8d-304">W tym samouczku dodano rolę niestandardową i użytkownika należącego do roli niestandardowej, ograniczony dostęp do folderu i strony administracji oraz udostępnienie nawigacji dla użytkownika należącego do roli niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="57c8d-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="57c8d-305">Użyto powiązania modelu, aby wypełnić formant **DropDownList** danymi.</span><span class="sxs-lookup"><span data-stu-id="57c8d-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="57c8d-306">Zaimplementowano kontrolkę **FileUpload** i kontrolki walidacji.</span><span class="sxs-lookup"><span data-stu-id="57c8d-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="57c8d-307">Dowiesz się również, jak dodawać i usuwać produkty z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="57c8d-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="57c8d-308">W następnym samouczku dowiesz się, jak wdrożyć Routing ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="57c8d-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="57c8d-309">Dodatkowe materiały</span><span class="sxs-lookup"><span data-stu-id="57c8d-309">Additional Resources</span></span>

<span data-ttu-id="57c8d-310">[Web. config — element autoryzacji](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="57c8d-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="57c8d-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="57c8d-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="57c8d-312">Wdrażanie bezpiecznej aplikacji ASP.NET Web Forms z członkostwem, uwierzytelnianiem OAuth i SQL Database w witrynie sieci Web systemu Azure</span><span class="sxs-lookup"><span data-stu-id="57c8d-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="57c8d-313">Microsoft Azure — bezpłatna wersja próbna</span><span class="sxs-lookup"><span data-stu-id="57c8d-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="57c8d-314">[Poprzednie](checkout-and-payment-with-paypal.md)
> [dalej](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="57c8d-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
