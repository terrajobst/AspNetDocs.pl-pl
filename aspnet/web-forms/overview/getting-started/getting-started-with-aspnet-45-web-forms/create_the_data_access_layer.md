---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
title: Tworzenie warstwy dostępu do danych | Dokumentacja firmy Microsoft
author: Erikre
description: Tej serii samouczków obejmuje podstawy tworzenia aplikacji formularzy sieci Web ASP.NET przy użyciu platformy ASP.NET 4.5 i programu Microsoft Visual Studio Express 2013 for firma Microsoft...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 0bbf7a6e-d7eb-4091-91e4-fff892777f32
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
msc.type: authoredcontent
ms.openlocfilehash: bc91eba17938de15f03ecc1e745aac57c7eac7a1
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/09/2019
ms.locfileid: "59419499"
---
# <a name="create-the-data-access-layer"></a><span data-ttu-id="58b2f-103">Tworzenie warstwy dostępu do danych</span><span class="sxs-lookup"><span data-stu-id="58b2f-103">Create the Data Access Layer</span></span>

<span data-ttu-id="58b2f-104">przez [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="58b2f-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="58b2f-105">[Pobierz Wingtip Toys przykładowego projektu (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) lub [Pobierz książkę elektroniczną (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="58b2f-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="58b2f-106">W tej serii samouczków obejmuje podstawy tworzenia aplikacji formularzy sieci Web ASP.NET przy użyciu platformy ASP.NET 4.5 i programu Microsoft Visual Studio Express 2013 for Web.</span><span class="sxs-lookup"><span data-stu-id="58b2f-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="58b2f-107">Visual Studio 2013 [projektu za pomocą kodu źródłowego języka C#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) jest dostępny dla tej serii samouczków towarzyszą.</span><span class="sxs-lookup"><span data-stu-id="58b2f-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="58b2f-108">W tym samouczku opisano sposób tworzenia, dostęp i przeglądanie danych z bazy danych przy użyciu formularzy sieci Web ASP.NET i Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="58b2f-108">This tutorial describes how to create, access, and review data from a database using ASP.NET Web Forms and Entity Framework Code First.</span></span> <span data-ttu-id="58b2f-109">Ten samouczek opiera się na poprzednim samouczku "Tworzenie projektu" i jest częścią serii samouczków o nazwie Wingtip zabawki Store.</span><span class="sxs-lookup"><span data-stu-id="58b2f-109">This tutorial builds on the previous tutorial "Create the Project" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="58b2f-110">Po ukończeniu tego samouczka, dlatego zostanie utworzone grupy klas dostępu do danych, które znajdują się w *modeli* folderu projektu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-110">When you've completed this tutorial, you will have built a group of data-access classes that are in the *Models* folder of the project.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="58b2f-111">Zawartość:</span><span class="sxs-lookup"><span data-stu-id="58b2f-111">What you'll learn:</span></span>

- <span data-ttu-id="58b2f-112">Jak tworzyć modele danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-112">How to create the data models.</span></span>
- <span data-ttu-id="58b2f-113">Jak zainicjować i Inicjowanie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-113">How to initialize and seed the database.</span></span>
- <span data-ttu-id="58b2f-114">Jak zaktualizować i skonfigurować aplikację do obsługi bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-114">How to update and configure the application to support the database.</span></span>

### <a name="these-are-the-features-introduced-in-the-tutorial"></a><span data-ttu-id="58b2f-115">Poniżej przedstawiono funkcje wprowadzone w tym samouczku:</span><span class="sxs-lookup"><span data-stu-id="58b2f-115">These are the features introduced in the tutorial:</span></span>

- <span data-ttu-id="58b2f-116">Entity Framework Code pierwszy</span><span class="sxs-lookup"><span data-stu-id="58b2f-116">Entity Framework Code First</span></span>
- <span data-ttu-id="58b2f-117">LocalDB</span><span class="sxs-lookup"><span data-stu-id="58b2f-117">LocalDB</span></span>
- <span data-ttu-id="58b2f-118">Adnotacje danych</span><span class="sxs-lookup"><span data-stu-id="58b2f-118">Data Annotations</span></span>

## <a name="creating-the-data-models"></a><span data-ttu-id="58b2f-119">Tworzenie modeli danych</span><span class="sxs-lookup"><span data-stu-id="58b2f-119">Creating the Data Models</span></span>

<span data-ttu-id="58b2f-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) to struktura mapowania obiektowo relacyjny (ORM).</span><span class="sxs-lookup"><span data-stu-id="58b2f-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) is an object-relational mapping (ORM) framework.</span></span> <span data-ttu-id="58b2f-121">Dzięki temu można pracować z danymi relacyjnymi jako obiekty, eliminując większość kodu dostępu do danych, który będzie zazwyczaj należy napisać.</span><span class="sxs-lookup"><span data-stu-id="58b2f-121">It lets you work with relational data as objects, eliminating most of the data-access code that you'd usually need to write.</span></span> <span data-ttu-id="58b2f-122">Używający narzędzia Entity Framework, możesz wykonywać zapytania za pomocą [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), a następnie pobrać i manipulowanie danymi jako silnie typizowanych obiektów.</span><span class="sxs-lookup"><span data-stu-id="58b2f-122">Using Entity Framework, you can issue queries using [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), then retrieve and manipulate data as strongly typed objects.</span></span> <span data-ttu-id="58b2f-123">LINQ zapewnia wzorce wykonywania kwerend i aktualizowania danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-123">LINQ provides patterns for querying and updating data.</span></span> <span data-ttu-id="58b2f-124">Używający narzędzia Entity Framework pozwala skupić się na tworzeniu części aplikacji, zamiast koncentrowania się na dane podstawowe informacje dotyczące dostępu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-124">Using Entity Framework allows you to focus on creating the rest of your application, rather than focusing on the data access fundamentals.</span></span> <span data-ttu-id="58b2f-125">W dalszej części tej serii samouczków pokażemy sposób użycia danych do wypełnienia zapytań nawigacji i produktu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-125">Later in this tutorial series, we'll show you how to use the data to populate navigation and product queries.</span></span>

<span data-ttu-id="58b2f-126">Entity Framework obsługuje paradygmat programowania, o nazwie *Code First*.</span><span class="sxs-lookup"><span data-stu-id="58b2f-126">Entity Framework supports a development paradigm called *Code First*.</span></span> <span data-ttu-id="58b2f-127">Kod pozwala najpierw zdefiniować swoje modele danych przy użyciu klas.</span><span class="sxs-lookup"><span data-stu-id="58b2f-127">Code First lets you define your data models using classes.</span></span> <span data-ttu-id="58b2f-128">Klasa to konstrukcja, która pozwala na tworzenie własnych typach niestandardowych przez grupowanie zmienne innych typów, metod i zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="58b2f-128">A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events.</span></span> <span data-ttu-id="58b2f-129">Można mapowania klas istniejącą bazę danych lub ich używać, aby wygenerować bazę danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-129">You can map classes to an existing database or use them to generate a database.</span></span> <span data-ttu-id="58b2f-130">W tym samouczku utworzysz modele danych przez napisanie klasy modelu danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-130">In this tutorial, you'll create the data models by writing data model classes.</span></span> <span data-ttu-id="58b2f-131">Następnie będzie umożliwiają Entity Framework, utworzyć bazę danych na bieżąco z tych nowych klas.</span><span class="sxs-lookup"><span data-stu-id="58b2f-131">Then, you'll let Entity Framework create the database on the fly from these new classes.</span></span>

<span data-ttu-id="58b2f-132">Rozpocznie się przez utworzenie klas jednostek, które definiują modeli danych dla aplikacji formularzy sieci Web.</span><span class="sxs-lookup"><span data-stu-id="58b2f-132">You will begin by creating the entity classes that define the data models for the Web Forms application.</span></span> <span data-ttu-id="58b2f-133">Następnie utworzysz klasy kontekstu, który zarządza klas jednostek i zapewnia dostęp do danych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-133">Then you will create a context class that manages the entity classes and provides data access to the database.</span></span> <span data-ttu-id="58b2f-134">Zostanie również utworzony klasy inicjatora, który będzie używany do wypełniania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-134">You will also create an initializer class that you will use to populate the database.</span></span>

### <a name="entity-framework-and-references"></a><span data-ttu-id="58b2f-135">Entity Framework i odwołań</span><span class="sxs-lookup"><span data-stu-id="58b2f-135">Entity Framework and References</span></span>

<span data-ttu-id="58b2f-136">Domyślnie program Entity Framework jest dołączana w przypadku tworzenia nowego **aplikacji sieci Web ASP.NET** przy użyciu **formularzy sieci Web** szablonu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-136">By default, Entity Framework is included when you create a new **ASP.NET Web Application** using the **Web Forms** template.</span></span> <span data-ttu-id="58b2f-137">Entity Framework można zainstalowane, odinstalowane i zaktualizowane jako pakiet NuGet.</span><span class="sxs-lookup"><span data-stu-id="58b2f-137">Entity Framework can be installed, uninstalled, and updated as a NuGet package.</span></span>

<span data-ttu-id="58b2f-138">Ten pakiet NuGet obejmuje następujące elementy **środowiska uruchomieniowego** zespoły w obrębie projektu:</span><span class="sxs-lookup"><span data-stu-id="58b2f-138">This NuGet package includes the following **runtime** assemblies within your project:</span></span>

- <span data-ttu-id="58b2f-139">EntityFramework.dll — wszystkie wspólne środowisko uruchomieniowe kod używany przez program Entity Framework</span><span class="sxs-lookup"><span data-stu-id="58b2f-139">EntityFramework.dll – All the common runtime code used by Entity Framework</span></span>
- <span data-ttu-id="58b2f-140">EntityFramework.SqlServer.dll — dostawcy programu Microsoft SQL Server dla programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="58b2f-140">EntityFramework.SqlServer.dll – The Microsoft SQL Server provider for Entity Framework</span></span>

### <a name="entity-classes"></a><span data-ttu-id="58b2f-141">Klas jednostek</span><span class="sxs-lookup"><span data-stu-id="58b2f-141">Entity Classes</span></span>

<span data-ttu-id="58b2f-142">Klasy, Utwórz zdefiniować schemat danych są nazywane klasami jednostki.</span><span class="sxs-lookup"><span data-stu-id="58b2f-142">The classes you create to define the schema of the data are called entity classes.</span></span> <span data-ttu-id="58b2f-143">Jeśli jesteś nowym użytkownikiem projekt bazy danych, pomyśl o klas jednostek, jak definicje tabel bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-143">If you're new to database design, think of the entity classes as table definitions of a database.</span></span> <span data-ttu-id="58b2f-144">Każda właściwość klasy określa kolumnę w tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-144">Each property in the class specifies a column in the table of the database.</span></span> <span data-ttu-id="58b2f-145">Te klasy oferują lekki, obiektowo relacyjny interfejs między kodem zorientowane obiektowo i struktury tabeli relacyjnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-145">These classes provide a lightweight, object-relational interface between object-oriented code and the relational table structure of the database.</span></span>

<span data-ttu-id="58b2f-146">W tym samouczku będziesz rozpoczyna pracę przez dodanie klasy proste jednostki reprezentujące schematów i kategorii produktów.</span><span class="sxs-lookup"><span data-stu-id="58b2f-146">In this tutorial, you'll start out by adding simple entity classes representing the schemas for products and categories.</span></span> <span data-ttu-id="58b2f-147">Klasa produktów będzie zawierać definicje dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-147">The products class will contain definitions for each product.</span></span> <span data-ttu-id="58b2f-148">Nazwa każdego z elementów członkowskich klasy produktu będzie `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, i `Category`.</span><span class="sxs-lookup"><span data-stu-id="58b2f-148">The name of each of the members of the product class will be `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, and `Category`.</span></span> <span data-ttu-id="58b2f-149">Klasa kategorii będzie zawierać definicje dla każdej kategorii, który produkt może należeć do, takie jak samochód, łodzi lub płaszczyzny.</span><span class="sxs-lookup"><span data-stu-id="58b2f-149">The category class will contain definitions for each category that a product can belong to, such as Car, Boat, or Plane.</span></span> <span data-ttu-id="58b2f-150">Nazwa każdego z członków klasy kategorii będzie `CategoryID`, `CategoryName`, `Description`, i `Products`.</span><span class="sxs-lookup"><span data-stu-id="58b2f-150">The name of each of the members of the category class will be `CategoryID`, `CategoryName`, `Description`, and `Products`.</span></span> <span data-ttu-id="58b2f-151">Każdy produkt będzie należeć do jednej z kategorii.</span><span class="sxs-lookup"><span data-stu-id="58b2f-151">Each product will belong to one of the categories.</span></span> <span data-ttu-id="58b2f-152">W ramach tych zajęć jednostki zostanie dodany do istniejącego projektu *modeli* folderu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-152">These entity classes will be added to the project's existing *Models* folder.</span></span>

1. <span data-ttu-id="58b2f-153">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy *modeli* folder, a następnie wybierz **Dodaj**  - &gt; **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-153">In **Solution Explorer**, right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span> 

    ![Tworzenie warstwy dostępu do danych — nowy element Menu](create_the_data_access_layer/_static/image1.png)

   <span data-ttu-id="58b2f-155">**Dodaj nowy element** zostanie wyświetlone okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="58b2f-155">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="58b2f-156">W obszarze **Visual C#** z **zainstalowane** w okienku po lewej stronie, wybierz opcję **kodu**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-156">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span> 

    ![Tworzenie warstwy dostępu do danych — nowy element Menu](create_the_data_access_layer/_static/image2.png)
3. <span data-ttu-id="58b2f-158">Wybierz **klasy** ze środkowego okienka i nazwij ta nowa klasa *Product.cs*.</span><span class="sxs-lookup"><span data-stu-id="58b2f-158">Select **Class** from the middle pane and name this new class *Product.cs*.</span></span>
4. <span data-ttu-id="58b2f-159">Kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-159">Click **Add**.</span></span>  
   <span data-ttu-id="58b2f-160">Plik nowej klasy jest wyświetlany w edytorze.</span><span class="sxs-lookup"><span data-stu-id="58b2f-160">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="58b2f-161">Zastąp domyślny kod następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="58b2f-161">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample1.cs)]
6. <span data-ttu-id="58b2f-162">Tworzenie innej klasy, powtarzając kroki od 1 do 4, jednak nadaj nowej klasie *Category.cs* i zastąpić domyślny kod następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="58b2f-162">Create another class by repeating steps 1 through 4, however, name the new class *Category.cs* and replace the default code with the following code:</span></span>  

    [!code-csharp[Main](create_the_data_access_layer/samples/sample2.cs)]

<span data-ttu-id="58b2f-163">Jak wcześniej wspomniano, `Category` klasy reprezentuje typ produktu, która aplikacja jest przeznaczona do sprzedaży (takie jak <a id="a"> </a> &quot;samochodów&quot;, &quot;łodzi&quot;, &quot;Rakiet&quot;i tak dalej), a `Product` klasa reprezentuje poszczególnych produktów (zabawki) w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-163">As previously mentioned, the `Category` class represents the type of product that the application is designed to sell (such as <a id="a"></a>&quot;Cars&quot;, &quot;Boats&quot;, &quot;Rockets&quot;, and so on), and the `Product` class represents the individual products (toys) in the database.</span></span> <span data-ttu-id="58b2f-164">Każde wystąpienie `Product` obiektu odnoszą się do wiersza w tabeli relacyjnej bazy danych, a każda właściwość klasy produktu będzie zmapowana do kolumny w tabeli relacyjnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-164">Each instance of a `Product` object will correspond to a row within a relational database table, and each property of the Product class will map to a column in the relational database table.</span></span> <span data-ttu-id="58b2f-165">W dalszej części tego samouczka można przejrzeć dane produktu znajdujące się w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-165">Later in this tutorial, you'll review the product data contained in the database.</span></span>

### <a name="data-annotations"></a><span data-ttu-id="58b2f-166">Adnotacje danych</span><span class="sxs-lookup"><span data-stu-id="58b2f-166">Data Annotations</span></span>

<span data-ttu-id="58b2f-167">Być może zauważono, że określone składowe klasy mają atrybuty określające szczegóły dotyczące elementu członkowskiego, takie jak `[ScaffoldColumn(false)]`.</span><span class="sxs-lookup"><span data-stu-id="58b2f-167">You may have noticed that certain members of the classes have attributes specifying details about the member, such as `[ScaffoldColumn(false)]`.</span></span> <span data-ttu-id="58b2f-168">Są to *adnotacje danych*.</span><span class="sxs-lookup"><span data-stu-id="58b2f-168">These are *data annotations*.</span></span> <span data-ttu-id="58b2f-169">Atrybuty adnotacji danych opisujący sposób sprawdzania poprawności danych wejściowych użytkownika dla tego elementu członkowskiego, aby określić, formatowanie i określić, jak modelowane po utworzeniu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-169">The data annotation attributes can describe how to validate user input for that member, to specify formatting for it, and to specify how it is modeled when the database is created.</span></span>

### <a name="context-class"></a><span data-ttu-id="58b2f-170">Context — Klasa</span><span class="sxs-lookup"><span data-stu-id="58b2f-170">Context Class</span></span>

<span data-ttu-id="58b2f-171">Aby rozpocząć korzystanie z klas dostępu do danych, należy zdefiniować klasy kontekstu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-171">To start using the classes for data access, you must define a context class.</span></span> <span data-ttu-id="58b2f-172">Jak już wspomniano, klasy kontekstu zarządza klas obiektów (takich jak `Product` klasy i `Category` klasy) i zapewnia dostęp do danych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-172">As mentioned previously, the context class manages the entity classes (such as the `Product` class and the `Category` class) and provides data access to the database.</span></span>

<span data-ttu-id="58b2f-173">Ta procedura dodaje nowe klasy C# kontekstu do *modeli* folderu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-173">This procedure adds a new C# context class to the *Models* folder.</span></span>

1. <span data-ttu-id="58b2f-174">Kliknij prawym przyciskiem myszy *modeli* folder, a następnie wybierz **Dodaj**  - &gt; **nowy element**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-174">Right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="58b2f-175">**Dodaj nowy element** zostanie wyświetlone okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="58b2f-175">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="58b2f-176">Wybierz **klasy** ze środkowego okienka, nadaj jej nazwę *ProductContext.cs* i kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-176">Select **Class** from the middle pane, name it *ProductContext.cs* and click **Add**.</span></span>
3. <span data-ttu-id="58b2f-177">Zastąp domyślny kod zawarty w klasie, z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="58b2f-177">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample3.cs)]

<span data-ttu-id="58b2f-178">Ten kod dodaje `System.Data.Entity` przestrzeni nazw tak, aby mieć dostęp do wszystkich funkcji podstawowych programu Entity Framework, co obejmuje możliwość zapytania, wstawiania, aktualizowania i usuwania danych dzięki współpracy z silnie typizowanych obiektów.</span><span class="sxs-lookup"><span data-stu-id="58b2f-178">This code adds the `System.Data.Entity` namespace so that you have access to all the core functionality of Entity Framework, which includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span>

<span data-ttu-id="58b2f-179">`ProductContext` Klasa reprezentuje produktu kontekst bazy danych platformy Entity Framework, która obsługuje pobieranie, przechowywania i aktualizowania `Product` klasy wystąpień w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-179">The `ProductContext` class represents Entity Framework product database context, which handles fetching, storing, and updating `Product` class instances in the database.</span></span> <span data-ttu-id="58b2f-180">`ProductContext` Klasa pochodzi od `DbContext` dostarczane przez program Entity Framework klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="58b2f-180">The `ProductContext` class derives from the `DbContext` base class provided by Entity Framework.</span></span>

### <a name="initializer-class"></a><span data-ttu-id="58b2f-181">Klasa inicjatora</span><span class="sxs-lookup"><span data-stu-id="58b2f-181">Initializer Class</span></span>

<span data-ttu-id="58b2f-182">Konieczne będzie uruchomienie niestandardowej logiki biznesowej można zainicjować kontekstu jest używana podczas pierwszej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-182">You will need to run some custom logic to initialize the database the first time the context is used.</span></span> <span data-ttu-id="58b2f-183">Umożliwi to inicjatora dane mają zostać dodane do bazy danych, tak, aby natychmiast wyświetlić produktów i kategorii.</span><span class="sxs-lookup"><span data-stu-id="58b2f-183">This will allow seed data to be added to the database so that you can immediately display products and categories.</span></span>

<span data-ttu-id="58b2f-184">Ta procedura dodaje nowe klasy C# inicjator do *modeli* folderu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-184">This procedure adds a new C# initializer class to the *Models* folder.</span></span>

1. <span data-ttu-id="58b2f-185">Utworzyć kolejną `Class` w *modeli* folder i nadaj mu nazwę *ProductDatabaseInitializer.cs*.</span><span class="sxs-lookup"><span data-stu-id="58b2f-185">Create another `Class` in the *Models* folder and name it *ProductDatabaseInitializer.cs*.</span></span>
2. <span data-ttu-id="58b2f-186">Zastąp domyślny kod zawarty w klasie, z następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="58b2f-186">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample4.cs)]

<span data-ttu-id="58b2f-187">Jak widać w powyższym kodzie, jeśli baza danych jest tworzony i zainicjowany, `Seed` właściwość jest zastąpione i ustawić.</span><span class="sxs-lookup"><span data-stu-id="58b2f-187">As you can see from the above code, when the database is created and initialized, the `Seed` property is overridden and set.</span></span> <span data-ttu-id="58b2f-188">Gdy `Seed` właściwość jest ustawiona, wartości kategorii i produktów są używane do wypełniania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-188">When the `Seed` property is set, the values from the categories and products are used to populate the database.</span></span> <span data-ttu-id="58b2f-189">Jeśli użytkownik podejmie próbę aktualizacji danych inicjatora, modyfikując kod powyżej, po utworzeniu bazy danych, nie zobaczysz żadnych aktualizacji po uruchomieniu aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="58b2f-189">If you attempt to update the seed data by modifying the above code after the database has been created, you won't see any updates when you run the Web application.</span></span> <span data-ttu-id="58b2f-190">Przyczyną jest powyższy kod korzysta z implementacją `DropCreateDatabaseIfModelChanges` klasy, rozpoznawał, jeśli model (schemat) został zmieniony przed zresetowaniem danych inicjatora.</span><span class="sxs-lookup"><span data-stu-id="58b2f-190">The reason is the above code uses an implementation of the `DropCreateDatabaseIfModelChanges` class to recognize if the model (schema) has changed before resetting the seed data.</span></span> <span data-ttu-id="58b2f-191">Jeśli żadne zmiany nie zostaną wprowadzone do `Category` i `Product` klas jednostek, baza danych nie zostanie zainicjowana ponownie z danymi inicjatora.</span><span class="sxs-lookup"><span data-stu-id="58b2f-191">If no changes are made to the `Category` and `Product` entity classes, the database will not be reinitialized with the seed data.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="58b2f-192">Jeśli potrzebowała bazy danych, być odtwarzane przy każdym uruchomieniu aplikacji, można użyć `DropCreateDatabaseAlways` klasy zamiast `DropCreateDatabaseIfModelChanges` klasy.</span><span class="sxs-lookup"><span data-stu-id="58b2f-192">If you wanted the database to be recreated every time you ran the application, you could use the `DropCreateDatabaseAlways` class instead of the `DropCreateDatabaseIfModelChanges` class.</span></span> <span data-ttu-id="58b2f-193">Jednak w tej serii samouczków, należy użyć `DropCreateDatabaseIfModelChanges` klasy.</span><span class="sxs-lookup"><span data-stu-id="58b2f-193">However for this tutorial series, use the `DropCreateDatabaseIfModelChanges` class.</span></span>


<span data-ttu-id="58b2f-194">W tym momencie w tym samouczku trzeba będzie *modeli* folder o cztery nowe klasy i klasa jeden domyślny:</span><span class="sxs-lookup"><span data-stu-id="58b2f-194">At this point in this tutorial, you will have a *Models* folder with four new classes and one default class:</span></span>

![Tworzenie warstwy dostępu do danych — folderu modeli](create_the_data_access_layer/_static/image3.png)

### <a name="configuring-the-application-to-use-the-data-model"></a><span data-ttu-id="58b2f-196">Konfigurowanie aplikacji do korzystania z modelu danych</span><span class="sxs-lookup"><span data-stu-id="58b2f-196">Configuring the Application to Use the Data Model</span></span>

<span data-ttu-id="58b2f-197">Teraz, po utworzeniu klasy, które reprezentują dane, należy skonfigurować aplikację do korzystania z klasy.</span><span class="sxs-lookup"><span data-stu-id="58b2f-197">Now that you've created the classes that represent the data, you must configure the application to use the classes.</span></span> <span data-ttu-id="58b2f-198">W *Global.asax* pliku, możesz dodać kod, który inicjuje modelu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-198">In the *Global.asax* file, you add code that initializes the model.</span></span> <span data-ttu-id="58b2f-199">W *Web.config* pliku, możesz dodać informacje o tym aplikacji, co baza danych będzie używane do przechowywania danych, który jest reprezentowany przez nowe klasy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-199">In the *Web.config* file you add information that tells the application what database you'll use to store the data that's represented by the new data classes.</span></span> <span data-ttu-id="58b2f-200">*Global.asax* pliku może służyć do obsługi zdarzeń aplikacji lub metody.</span><span class="sxs-lookup"><span data-stu-id="58b2f-200">The *Global.asax* file can be used to handle application events or methods.</span></span> <span data-ttu-id="58b2f-201">*Web.config* plik pozwala modyfikować konfigurację aplikacji sieci web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="58b2f-201">The *Web.config* file allows you to control the configuration of your ASP.NET web application.</span></span>

#### <a name="updating-the-globalasax-file"></a><span data-ttu-id="58b2f-202">Aktualizowanie pliku Global.asax</span><span class="sxs-lookup"><span data-stu-id="58b2f-202">Updating the Global.asax file</span></span>

<span data-ttu-id="58b2f-203">Aby zainicjować modeli danych, podczas uruchamiania aplikacji, spowoduje zaktualizowanie `Application_Start` obsługi w *Global.asax.cs* pliku.</span><span class="sxs-lookup"><span data-stu-id="58b2f-203">To initialize the data models when the application starts, you will update the `Application_Start` handler in the *Global.asax.cs* file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="58b2f-204">W Eksploratorze rozwiązań, użytkownik może wybrać jedną *Global.asax* pliku lub *Global.asax.cs* plik do edycji *Global.asax.cs* pliku.</span><span class="sxs-lookup"><span data-stu-id="58b2f-204">In Solution Explorer, you can select either the *Global.asax* file or the *Global.asax.cs* file to edit the *Global.asax.cs* file.</span></span>


1. <span data-ttu-id="58b2f-205">Dodaj następujący kod wyróżniony na żółto do `Application_Start` method in Class metoda *Global.asax.cs* pliku.</span><span class="sxs-lookup"><span data-stu-id="58b2f-205">Add the following code highlighted in yellow to the `Application_Start` method in the *Global.asax.cs* file.</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample5.cs?highlight=9-10,22-23)]

> [!NOTE] 
> 
> <span data-ttu-id="58b2f-206">Przeglądarka musi obsługiwać HTML5, aby wyświetlić kod wyróżniony na żółto, oglądając tę serię samouczków w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="58b2f-206">Your browser must support HTML5 to view the code highlighted in yellow when viewing this tutorial series in a browser.</span></span>


<span data-ttu-id="58b2f-207">Jak pokazano w powyższym kodzie, podczas uruchamiania aplikacji, aplikacji określa, że inicjator, które będą uruchamiane podczas pierwszego danych jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="58b2f-207">As shown in the above code, when the application starts, the application specifies the initializer that will run during the first time the data is accessed.</span></span> <span data-ttu-id="58b2f-208">Dwa dodatkowe przestrzenie nazw są wymagane do dostępu `Database` obiektu i `ProductDatabaseInitializer` obiektu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-208">The two additional namespaces are required to access the `Database` object and the `ProductDatabaseInitializer` object.</span></span>

 <span data-ttu-id="58b2f-209">Modyfikowanie pliku Web.Config</span><span class="sxs-lookup"><span data-stu-id="58b2f-209">Modifying the Web.Config File</span></span> 

<span data-ttu-id="58b2f-210">Mimo że Entity Framework Code First wygeneruje bazy danych dla Ciebie w lokalizacji domyślnej, gdy baza danych jest wypełniana danymi inicjatora, dodawanie własnych informacji o połączeniu z aplikacją zapewnia kontrolę nad lokalizację bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-210">Although Entity Framework Code First will generate a database for you in a default location when the database is populated with seed data, adding your own connection information to your application gives you control of the database location.</span></span> <span data-ttu-id="58b2f-211">Określ tego połączenia z bazą danych przy użyciu parametrów połączenia w aplikacji *Web.config* pliku w folderze głównym projektu.</span><span class="sxs-lookup"><span data-stu-id="58b2f-211">You specify this database connection using a connection string in the application's *Web.config* file at the root of the project.</span></span> <span data-ttu-id="58b2f-212">Dodając nowe parametry połączenia, można kierować lokalizacji bazy danych (*wingtiptoys.mdf*) ma zostać utworzony w katalogu danych aplikacji (*aplikacji\_danych*), zamiast domyślnej Lokalizacja.</span><span class="sxs-lookup"><span data-stu-id="58b2f-212">By adding a new connection string, you can direct the location of the database (*wingtiptoys.mdf*) to be built in the application's data directory (*App\_Data*), rather than its default location.</span></span> <span data-ttu-id="58b2f-213">Wprowadzenie tej zmiany pozwoli na znalezienie i sprawdź plik bazy danych w dalszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="58b2f-213">Making this change will allow you to find and inspect the database file later in this tutorial.</span></span>

1. <span data-ttu-id="58b2f-214">W **Eksploratora rozwiązań**, znajdowanie i otwieranie *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="58b2f-214">In **Solution Explorer**, find and open the *Web.config* file.</span></span>
2. <span data-ttu-id="58b2f-215">Dodaj parametry połączenia, wyróżniony na żółto do `<connectionStrings>` części *Web.config* pliku w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="58b2f-215">Add the connection string highlighted in yellow to the `<connectionStrings>` section of the *Web.config* file as follows:</span></span>  

    [!code-xml[Main](create_the_data_access_layer/samples/sample6.xml?highlight=4-7)]

<span data-ttu-id="58b2f-216">Gdy aplikacja jest uruchamiana po raz pierwszy, zostanie utworzona baza danych w lokalizacji określonej przez ciąg połączenia.</span><span class="sxs-lookup"><span data-stu-id="58b2f-216">When the application is run for the first time, it will build the database at the location specified by the connection string.</span></span> <span data-ttu-id="58b2f-217">Jednak przed uruchomieniem aplikacji, utworzymy ją najpierw.</span><span class="sxs-lookup"><span data-stu-id="58b2f-217">But before running the application, let's build it first.</span></span>

## <a name="building-the-application"></a><span data-ttu-id="58b2f-218">Kompilowanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="58b2f-218">Building the Application</span></span>

<span data-ttu-id="58b2f-219">Aby upewnić się, czy działają wszystkie klasy i zmian w aplikacji sieci Web, należy skompilować aplikację.</span><span class="sxs-lookup"><span data-stu-id="58b2f-219">To make sure that all the classes and changes to your Web application work, you should build the application.</span></span>

1. <span data-ttu-id="58b2f-220">Z **debugowania** menu, wybierz opcję **kompilacji WingtipToys**.</span><span class="sxs-lookup"><span data-stu-id="58b2f-220">From the **Debug** menu, select **Build WingtipToys**.</span></span>  
 <span data-ttu-id="58b2f-221">**Dane wyjściowe** zostanie wyświetlone okno, a jeśli wszystko poszło dobrze, zobaczysz *zakończyło się pomyślnie* wiadomości.</span><span class="sxs-lookup"><span data-stu-id="58b2f-221">The **Output** window is displayed, and if all went well, you see a *succeeded* message.</span></span>  

    ![Tworzenie warstwy dostępu do danych — Windows danych wyjściowych](create_the_data_access_layer/_static/image4.png)

<span data-ttu-id="58b2f-223">Jeśli napotkasz błąd, ponownie sprawdź powyższe kroki.</span><span class="sxs-lookup"><span data-stu-id="58b2f-223">If you run into an error, re-check the above steps.</span></span> <span data-ttu-id="58b2f-224">Informacje przedstawione w **dane wyjściowe** okna będą wskazywać plik, który ma problem, gdzie w pliku zmian jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="58b2f-224">The information in the **Output** window will indicate which file has a problem and where in the file a change is required.</span></span> <span data-ttu-id="58b2f-225">Te informacje pozwoli określić, jaka część powyższej procedury muszą być przejrzane i stałej w projekcie.</span><span class="sxs-lookup"><span data-stu-id="58b2f-225">This information will enable you to determine what part of the above steps need to be reviewed and fixed in your project.</span></span>

## <a name="summary"></a><span data-ttu-id="58b2f-226">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="58b2f-226">Summary</span></span>

<span data-ttu-id="58b2f-227">W tym samouczku tej serii możesz mieć utworzony modelu danych, a także, dodać kod, który będzie używany do inicjowania i Inicjowanie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-227">In this tutorial of the series you have created the data model, as well as, added the code that will be used to initialize and seed the database.</span></span> <span data-ttu-id="58b2f-228">Skonfigurowano również aplikacji na używanie modeli danych, gdy aplikacja jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="58b2f-228">You have also configured the application to use the data models when the application is run.</span></span>

<span data-ttu-id="58b2f-229">W następnym samouczku dodasz aktualizacji interfejsu użytkownika, nawigacji i pobierać dane z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-229">In the next tutorial, you'll update the UI, add navigation, and retrieve data from the database.</span></span> <span data-ttu-id="58b2f-230">W rezultacie zostanie automatycznie tworzona w oparciu o klas jednostek, które utworzono w ramach tego samouczka bazy danych.</span><span class="sxs-lookup"><span data-stu-id="58b2f-230">This will result in the database being automatically created based on the entity classes that you created in this tutorial.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="58b2f-231">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="58b2f-231">Additional Resources</span></span>

[<span data-ttu-id="58b2f-232">Omówienie programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="58b2f-232">Entity Framework Overview</span></span>](https://msdn.microsoft.com/library/bb399567.aspx)   
[<span data-ttu-id="58b2f-233">Przewodnik dla początkujących programu ADO.NET Entity Framework</span><span class="sxs-lookup"><span data-stu-id="58b2f-233">Beginner's Guide to the ADO.NET Entity Framework</span></span>](https://msdn.microsoft.com/data/ee712907)   
<span data-ttu-id="58b2f-234">[Pierwszy programowania za pomocą platformy Entity Framework Code](http://www.msteched.com/2010/Europe/DEV212) (wideo)</span><span class="sxs-lookup"><span data-stu-id="58b2f-234">[Code First Development with Entity Framework](http://www.msteched.com/2010/Europe/DEV212) (video)</span></span>   
[<span data-ttu-id="58b2f-235">Kod pierwszego relacje Fluent interfejsu API</span><span class="sxs-lookup"><span data-stu-id="58b2f-235">Code First Relationships Fluent API</span></span>](https://msdn.microsoft.com/data/hh134698)   
[<span data-ttu-id="58b2f-236">Adnotacje danych na pierwszym kodu</span><span class="sxs-lookup"><span data-stu-id="58b2f-236">Code First Data Annotations</span></span>](https://msdn.microsoft.com/data/gg193958)  
[<span data-ttu-id="58b2f-237">Ulepszenia w zakresie produktywności dla programu Entity Framework</span><span class="sxs-lookup"><span data-stu-id="58b2f-237">Productivity Improvements for the Entity Framework</span></span>](https://blogs.msdn.com/b/efdesign/archive/2010/06/21/productivity-improvements-for-the-entity-framework.aspx?wa=wsignin1.0)

> [!div class="step-by-step"]
> <span data-ttu-id="58b2f-238">[Poprzednie](create-the-project.md)
> [dalej](ui_and_navigation.md)</span><span class="sxs-lookup"><span data-stu-id="58b2f-238">[Previous](create-the-project.md)
[Next](ui_and_navigation.md)</span></span>
