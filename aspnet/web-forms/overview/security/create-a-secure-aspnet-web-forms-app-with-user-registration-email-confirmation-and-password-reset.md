---
uid: web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
title: Tworzenie bezpiecznej aplikacji ASP.NET Web Forms z rejestracją użytkownika wiadomości e-mail z potwierdzeniem i resetowaniem hasła (C#) | Dokumentacja firmy Microsoft
author: Erikre
description: W tym samouczku przedstawiono sposób tworzenia aplikacji formularzy sieci Web ASP.NET za pomocą rejestracji użytkowników, potwierdzenie adresu e-mail i resetowania haseł za pomocą elementu członkowskiego produktu ASP.NET Identity...
ms.author: riande
ms.date: 10/02/2014
ms.assetid: 0a8d6044-5fab-4213-82d6-5618d5601358
msc.legacyurl: /web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
msc.type: authoredcontent
ms.openlocfilehash: 1bd90f0ceddee7d9e18c1cac2fadfb2c84841f19
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/25/2019
ms.locfileid: "58424641"
---
<a name="create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset-c"></a><span data-ttu-id="b74a5-103">Tworzenie bezpiecznej aplikacji ASP.NET Web Forms z rejestracją użytkownika, potwierdzeniem adresu e-mail i resetowaniem hasła (C#)</span><span class="sxs-lookup"><span data-stu-id="b74a5-103">Create a secure ASP.NET Web Forms app with user registration, email confirmation and password reset (C#)</span></span>
====================
<span data-ttu-id="b74a5-104">przez [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="b74a5-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

> <span data-ttu-id="b74a5-105">W tym samouczku przedstawiono sposób tworzenia aplikacji formularzy sieci Web ASP.NET za pomocą rejestracji użytkowników, potwierdzenie adresu e-mail i resetowania haseł za pomocą systemu członkostwa ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="b74a5-105">This tutorial shows you how to build an ASP.NET Web Forms app with user registration, email confirmation and password reset using the ASP.NET Identity membership system.</span></span> <span data-ttu-id="b74a5-106">W tym samouczku został oparty na Rick Anderson [samouczek MVC](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span><span class="sxs-lookup"><span data-stu-id="b74a5-106">This tutorial was based on Rick Anderson's [MVC tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span></span>


## <a name="introduction"></a><span data-ttu-id="b74a5-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="b74a5-107">Introduction</span></span>

<span data-ttu-id="b74a5-108">Ten samouczek przeprowadzi Cię przez kroki wymagane do tworzenia aplikacji formularzy sieci Web ASP.NET przy użyciu programu Visual Studio i platformy ASP.NET 4.5 tworzenie bezpiecznej aplikacji formularzy sieci Web z rejestracją użytkownika, wiadomości e-mail z potwierdzeniem i resetowaniem hasła.</span><span class="sxs-lookup"><span data-stu-id="b74a5-108">This tutorial guides you through the steps required to create an ASP.NET Web Forms application using Visual Studio and ASP.NET 4.5 to create a secure Web Forms app with user registration, email confirmation and password reset.</span></span>

### <a name="tutorial-tasks-and-information"></a><span data-ttu-id="b74a5-109">Samouczek zadania i informacji:</span><span class="sxs-lookup"><span data-stu-id="b74a5-109">Tutorial Tasks and Information:</span></span>

- [<span data-ttu-id="b74a5-110">Tworzenie internetowego interfejsu platformy ASP.NET aplikacja formularzy</span><span class="sxs-lookup"><span data-stu-id="b74a5-110">Create an ASP.NET Web Forms app</span></span>](#createWebForms)
- [<span data-ttu-id="b74a5-111">Podpinanie usługi SendGrid</span><span class="sxs-lookup"><span data-stu-id="b74a5-111">Hook Up SendGrid</span></span>](#SG)
- [<span data-ttu-id="b74a5-112">Wymaga potwierdzenia E-mail przed logowania</span><span class="sxs-lookup"><span data-stu-id="b74a5-112">Require Email Confirmation Before Log In</span></span>](#require)
- [<span data-ttu-id="b74a5-113">Hasło odzyskiwania i Reset</span><span class="sxs-lookup"><span data-stu-id="b74a5-113">Password Recovery and Reset</span></span>](#reset)
- [<span data-ttu-id="b74a5-114">Wyślij ponownie Link potwierdzenie adresu E-mail</span><span class="sxs-lookup"><span data-stu-id="b74a5-114">Resend Email Confirmation Link</span></span>](#rsend)
- [<span data-ttu-id="b74a5-115">Rozwiązywanie problemów z aplikacji</span><span class="sxs-lookup"><span data-stu-id="b74a5-115">Troubleshooting the App</span></span>](#dbg)
- [<span data-ttu-id="b74a5-116">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="b74a5-116">Additional Resources</span></span>](#addRes)

<a id="createWebForms"></a>
## <a name="create-an-aspnet-web-forms-app"></a><span data-ttu-id="b74a5-117">Tworzenie aplikacji formularzy sieci Web platformy ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b74a5-117">Create an ASP.NET Web Forms App</span></span>

<span data-ttu-id="b74a5-118">Rozpocznij od instalowania i uruchamiania [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) lub [programu Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="b74a5-118">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="b74a5-119">Zainstaluj [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) lub wyższej oraz.</span><span class="sxs-lookup"><span data-stu-id="b74a5-119">Install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher as well.</span></span>

> [!NOTE]
> <span data-ttu-id="b74a5-120">Ostrzeżenie: Należy zainstalować [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) lub nowszej, aby ukończyć ten samouczek.</span><span class="sxs-lookup"><span data-stu-id="b74a5-120">Warning: You must install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher to complete this tutorial.</span></span>


1. <span data-ttu-id="b74a5-121">Utwórz nowy projekt (**pliku**  - &gt; **nowy projekt**) i wybierz **aplikacji sieci Web ASP.NET** szablonu i najnowszej wersji .NET Framework wersja z **nowy projekt** okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="b74a5-121">Create a new project (**File** -&gt; **New Project**) and select the **ASP.NET Web Application** template and the latest .NET Framework version from the **New Project** dialog box.</span></span>
2. <span data-ttu-id="b74a5-122">Z **nowy projekt ASP.NET** okno dialogowe, wybierz opcję **formularzy sieci Web** szablonu.</span><span class="sxs-lookup"><span data-stu-id="b74a5-122">From the **New ASP.NET Project** dialog box, select the **Web Forms** template.</span></span> <span data-ttu-id="b74a5-123">Pozostaw domyślne uwierzytelnianie jako **indywidualne konta użytkowników**.</span><span class="sxs-lookup"><span data-stu-id="b74a5-123">Leave the default authentication as **Individual User Accounts**.</span></span> <span data-ttu-id="b74a5-124">Jeśli chcesz hostować aplikację na platformie Azure, należy pozostawić **Hostuj w chmurze** pole wyboru zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="b74a5-124">If you'd like to host the app in Azure, leave the **Host in the cloud** check box checked.</span></span>   
 <span data-ttu-id="b74a5-125">Następnie kliknij przycisk **OK** Aby utworzyć nowy projekt.</span><span class="sxs-lookup"><span data-stu-id="b74a5-125">Then, click **OK** to create the new project.</span></span>  
    <span data-ttu-id="b74a5-126">![Okno dialogowe Nowy projekt ASP.NET](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b74a5-126">![New ASP.NET Project dialog box](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span></span>
3. <span data-ttu-id="b74a5-127">Włączanie protokołu Secure Sockets Layer (SSL) dla projektu.</span><span class="sxs-lookup"><span data-stu-id="b74a5-127">Enable Secure Sockets Layer (SSL) for the project.</span></span> <span data-ttu-id="b74a5-128">Wykonaj kroki, które są dostępne w **Włącz SSL dla projektu** części [wprowadzenie do formularzy sieci Web serii samouczków](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span><span class="sxs-lookup"><span data-stu-id="b74a5-128">Follow the steps available in the **Enable SSL for the Project** section of the [Getting Started with Web Forms tutorial series](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span></span>
4. <span data-ttu-id="b74a5-129">Uruchom aplikację, kliknij przycisk **zarejestrować** link i rejestrowanie nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b74a5-129">Run the app, click the **Register** link and register a new user.</span></span> <span data-ttu-id="b74a5-130">W tym momencie tylko sprawdzanie poprawności w wiadomości e-mail opiera się na [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) atrybutu, aby upewnić się, adres e-mail jest poprawnie sformułowany.</span><span class="sxs-lookup"><span data-stu-id="b74a5-130">At this point, the only validation on the email is based on the [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) attribute to ensure the email address is well-formed.</span></span> <span data-ttu-id="b74a5-131">Zmodyfikujesz kod, aby dodać potwierdzenie adresu e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-131">You will modify the code to add email confirmation.</span></span> <span data-ttu-id="b74a5-132">Zamknij okno przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="b74a5-132">Close the browser window.</span></span>
5. <span data-ttu-id="b74a5-133">W **Eksploratora serwera** programu Visual Studio (**widoku**  - &gt; **Eksploratora serwera**), przejdź do **Connections\ danych DefaultConnection\Tables\AspNetUsers**, kliknij prawym przyciskiem myszy i wybierz **Otwórz definicję tabeli**.</span><span class="sxs-lookup"><span data-stu-id="b74a5-133">In **Server Explorer** of Visual Studio (**View** -&gt; **Server Explorer**), navigate to **Data Connections\DefaultConnection\Tables\AspNetUsers**, right click and select **Open table definition**.</span></span> 

    <span data-ttu-id="b74a5-134">Na poniższej ilustracji przedstawiono `AspNetUsers` schematu tabeli:</span><span class="sxs-lookup"><span data-stu-id="b74a5-134">The following image shows the `AspNetUsers` table schema:</span></span>

    ![AspNetUsers table schema](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image2.png)
6. <span data-ttu-id="b74a5-136">W **Eksploratora serwera**, kliknij prawym przyciskiem myszy **AspNetUsers** tabeli, a następnie wybierz pozycję **Pokaż dane tabeli**.</span><span class="sxs-lookup"><span data-stu-id="b74a5-136">In **Server Explorer**, right-click on the **AspNetUsers** table and select **Show Table Data**.</span></span>  
  
    ![AspNetUsers table data](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image3.png)  
 <span data-ttu-id="b74a5-138">W tym momencie nie został potwierdzony adres e-mail zarejestrowany użytkownik.</span><span class="sxs-lookup"><span data-stu-id="b74a5-138">At this point the email for the registered user has not been confirmed.</span></span>
7. <span data-ttu-id="b74a5-139">Kliknij wiersz i wybierz pozycję Usuń — Usuń użytkownika.</span><span class="sxs-lookup"><span data-stu-id="b74a5-139">Click on the row and select delete to delete the user.</span></span> <span data-ttu-id="b74a5-140">Dodasz tę wiadomość e-mail ponownie w następnym kroku i Wyślij komunikat potwierdzenia adresu e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-140">You'll add this email again in the next step and send a confirmation message to the email address.</span></span>

## <a name="email-confirmation"></a><span data-ttu-id="b74a5-141">Potwierdzenie adresu e-mail</span><span class="sxs-lookup"><span data-stu-id="b74a5-141">Email Confirmation</span></span>

<span data-ttu-id="b74a5-142">Jest najlepszym rozwiązaniem potwierdzenia adresu e-mail podczas rejestracji nowego użytkownika, aby sprawdzić ich nie podszyć się pod kogoś innego (oznacza to one nie zostały zarejestrowane przy użyciu adresu e-mail osoby).</span><span class="sxs-lookup"><span data-stu-id="b74a5-142">It's a best practice to confirm the email during the registration of a new user to verify they are not impersonating someone else (that is, they haven't registered with someone else's email).</span></span> <span data-ttu-id="b74a5-143">Załóżmy, że masz forum dyskusyjne, czy chcesz uniemożliwić `"bob@cpandl.com"` z rejestracją jako `"joe@contoso.com"`.</span><span class="sxs-lookup"><span data-stu-id="b74a5-143">Suppose you had a discussion forum, you would want to prevent `"bob@cpandl.com"` from registering as `"joe@contoso.com"`.</span></span> <span data-ttu-id="b74a5-144">Bez potwierdzenia e-mail `"joe@contoso.com"` można pobrać niechcianych wiadomości e-mail z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b74a5-144">Without email confirmation, `"joe@contoso.com"` could get unwanted email from your app.</span></span> <span data-ttu-id="b74a5-145">Załóżmy, że Bob przypadkowo zarejestrowany jako `"bib@cpandl.com"` i był wystąpieniem, użytkownik nie będzie mogła używać hasła odzyskiwania, ponieważ aplikacja nie ma jego prawidłowy adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-145">Suppose Bob accidentally registered as `"bib@cpandl.com"` and hadn't noticed it, he wouldn't be able to use password recovery because the app doesn't have his correct email.</span></span> <span data-ttu-id="b74a5-146">Potwierdzenie adresu e-mail zawiera tylko ograniczoną ochronę z botami i nie zapewnia ochrony z spamerów określone.</span><span class="sxs-lookup"><span data-stu-id="b74a5-146">Email confirmation provides only limited protection from bots and doesn't provide protection from determined spammers.</span></span>

<span data-ttu-id="b74a5-147">Zazwyczaj chcesz uniemożliwić nowym użytkownikom publikowanie żadnych danych do swojej witryny sieci Web, zanim zostały potwierdzone pocztą e-mail, wiadomość SMS lub innego mechanizmu.</span><span class="sxs-lookup"><span data-stu-id="b74a5-147">You generally want to prevent new users from posting any data to your website before they have been confirmed by either email, an SMS text message or another mechanism.</span></span> <span data-ttu-id="b74a5-148">W poniższych sekcjach możemy włączyć potwierdzenie adresu e-mail i zmodyfikować kod, aby uniemożliwić nowym użytkownikom logowanie do momentu swój adres e-mail został potwierdzony.</span><span class="sxs-lookup"><span data-stu-id="b74a5-148">In the sections below, we will enable email confirmation and modify the code to prevent newly registered users from logging in until their email has been confirmed.</span></span> <span data-ttu-id="b74a5-149">W tym samouczku użyjemy usługi e-mail SendGrid.</span><span class="sxs-lookup"><span data-stu-id="b74a5-149">You'll use the email service SendGrid in this tutorial.</span></span>

<a id="SG"></a>
## <a name="hook-up-sendgrid"></a><span data-ttu-id="b74a5-150">Podpinanie usługi SendGrid</span><span class="sxs-lookup"><span data-stu-id="b74a5-150">Hook up SendGrid</span></span>

<span data-ttu-id="b74a5-151">SendGrid została zmieniona jego interfejsu API, ponieważ w tym samouczku został napisany.</span><span class="sxs-lookup"><span data-stu-id="b74a5-151">SendGrid has changed it's API since this tutorial was written.</span></span> <span data-ttu-id="b74a5-152">Bieżący SendGrid instrukcje można znaleźć [SendGrid](http://sendgrid.com/) lub [włączyć odzyskiwanie potwierdzenia i hasło konta](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span><span class="sxs-lookup"><span data-stu-id="b74a5-152">For current SendGrid instructions, see [SendGrid](http://sendgrid.com/) or [Enable account confirmation and password recovery](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span></span>

<span data-ttu-id="b74a5-153">Chociaż ten samouczek przedstawia tylko sposób dodawania powiadomienie e-mail za pośrednictwem [SendGrid](http://sendgrid.com/), możesz wysłać wiadomość e-mail przy użyciu SMTP i inne mechanizmy (zobacz [dodatkowe zasoby](#addRes)).</span><span class="sxs-lookup"><span data-stu-id="b74a5-153">Although this tutorial only shows how to add email notification through [SendGrid](http://sendgrid.com/), you can send email using SMTP and other mechanisms (see [additional resources](#addRes)).</span></span>

1. <span data-ttu-id="b74a5-154">W programie Visual Studio, otwórz **Konsola Menedżera pakietów** (**narzędzia**  - &gt; **Menedżera pakietów NuGet**  - &gt; **Konsola Menedżera pakietów**), a następnie wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="b74a5-154">In Visual Studio, open the **Package Manager Console** (**Tools** -&gt; **NuGet Package Manger** -&gt; **Package Manager Console**), and enter the following command:</span></span>  
    `Install-Package SendGrid`
2. <span data-ttu-id="b74a5-155">Przejdź do [stronie tworzenia konta usługi SendGrid platformy Azure](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) i Zarejestruj się bezpłatnie konta SendGrid.</span><span class="sxs-lookup"><span data-stu-id="b74a5-155">Go to the [Azure SendGrid sign-up page](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) and register for free SendGrid account.</span></span> <span data-ttu-id="b74a5-156">Możesz również Załóż bezpłatne konto usługi SendGrid bezpośrednio na [witryny SendGrid](http://www.sendgrid.com).</span><span class="sxs-lookup"><span data-stu-id="b74a5-156">You can also sign-up for a free SendGrid account directly on [SendGrid's site](http://www.sendgrid.com).</span></span>
3. <span data-ttu-id="b74a5-157">Z **Eksploratora rozwiązań** Otwórz *IdentityConfig.cs* w pliku *aplikacji\_Start* folderze i Dodaj następujący kod wyróżniony na żółto do `EmailService` klasa umożliwiająca skonfigurowanie **SendGrid**:</span><span class="sxs-lookup"><span data-stu-id="b74a5-157">From **Solution Explorer** open the *IdentityConfig.cs* file in the *App\_Start* folder and add the following code highlighted in yellow to the `EmailService` class to configure **SendGrid**:</span></span>

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample1.cs?highlight=3,5,8-37)]
4. <span data-ttu-id="b74a5-158">Ponadto, Dodaj następujący kod `using` instrukcje do stanu sprzed *IdentityConfig.cs* pliku:</span><span class="sxs-lookup"><span data-stu-id="b74a5-158">Also, add the following `using` statements to the beginning of the *IdentityConfig.cs* file:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample2.cs?highlight=1-4)]
5. <span data-ttu-id="b74a5-159">W celu uproszczenia w tym przykładzie będzie przechowywać wartości konta usługi poczty e-mail w `appSettings` części *web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="b74a5-159">To keep this sample simple, you'll store the email service account values in the `appSettings` section of the *web.config* file.</span></span> <span data-ttu-id="b74a5-160">Dodaj następujący kod XML wyróżniony na żółto do *web.config* pliku w folderze głównym projektu:</span><span class="sxs-lookup"><span data-stu-id="b74a5-160">Add the following XML highlighted in yellow to the *web.config* file at the root of your project:</span></span>

    [!code-xml[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample3.xml?highlight=2-5)]

    > [!WARNING]
    > <span data-ttu-id="b74a5-161">Zabezpieczenia — nigdy nie przechowywania danych poufnych w kodzie źródłowym.</span><span class="sxs-lookup"><span data-stu-id="b74a5-161">Security - Never store sensitive data in your source code.</span></span> <span data-ttu-id="b74a5-162">W tym przykładzie konto i poświadczenia są przechowywane w **appSetting** części *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="b74a5-162">In this example, the account and credentials are stored in the **appSetting** section of the *Web.config* file.</span></span> <span data-ttu-id="b74a5-163">Na platformie Azure, możesz bezpiecznie przechowywać te wartości na **[Konfiguruj](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** kartę w witrynie Azure portal.</span><span class="sxs-lookup"><span data-stu-id="b74a5-163">On Azure, you can securely store these values on the **[Configure](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** tab in the Azure portal.</span></span> <span data-ttu-id="b74a5-164">Aby uzyskać powiązane informacje, zobacz Rick Anderson temacie [najlepsze rozwiązania dotyczące wdrażania haseł i innych danych poufnych na platformie ASP.NET i Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span><span class="sxs-lookup"><span data-stu-id="b74a5-164">For related information see Rick Anderson's topic titled [Best practices for deploying passwords and other sensitive data to ASP.NET and Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span></span>
6. <span data-ttu-id="b74a5-165">Dodaj wartości usługi poczty e-mail, aby odzwierciedlać wartości uwierzytelniania usługi SendGrid (nazwa użytkownika i hasło) aby można było pomyślnie wysłać wiadomość e-mail z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b74a5-165">Add the email service values to reflect your SendGrid authentication values (User Name and Password) so that you can successful send email from your app.</span></span> <span data-ttu-id="b74a5-166">Pamiętaj użyć swojej nazwy konta usługi SendGrid, a nie adres e-mail podany usługi SendGrid.</span><span class="sxs-lookup"><span data-stu-id="b74a5-166">Be sure to use your SendGrid account name rather than the email address you provided SendGrid.</span></span>

### <a name="enable-email-confirmation"></a><span data-ttu-id="b74a5-167">Włącz potwierdzenie adresu E-mail</span><span class="sxs-lookup"><span data-stu-id="b74a5-167">Enable Email Confirmation</span></span>

 <span data-ttu-id="b74a5-168">Aby włączyć e-mail z potwierdzeniem, zmodyfikujesz kod rejestracyjny, wykonując następujące kroki.</span><span class="sxs-lookup"><span data-stu-id="b74a5-168">To enable email confirmation, you'll modify the registration code using the following steps.</span></span>  
 

1. <span data-ttu-id="b74a5-169">W *konta* folder, otwórz *Register.aspx.cs* związanym z kodem i zaktualizuj `CreateUser_Click` metodę umożliwiającą włączenie wyróżnione następujące zmiany:</span><span class="sxs-lookup"><span data-stu-id="b74a5-169">In the *Account* folder, open the *Register.aspx.cs* code-behind and update the `CreateUser_Click` method to enable the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample4.cs?highlight=9-11)]
2. <span data-ttu-id="b74a5-170">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy *Default.aspx* i wybierz **Ustaw jako stronę startową**.</span><span class="sxs-lookup"><span data-stu-id="b74a5-170">In **Solution Explorer**, right-click *Default.aspx* and select **Set As Start Page**.</span></span>
3. <span data-ttu-id="b74a5-171">Uruchom aplikację, naciskając klawisz **F5.**</span><span class="sxs-lookup"><span data-stu-id="b74a5-171">Run the app by pressing **F5.**</span></span> <span data-ttu-id="b74a5-172">Po wyświetleniu strony kliknij **zarejestrować** łącze, aby wyświetlić stronę rejestru.</span><span class="sxs-lookup"><span data-stu-id="b74a5-172">After the page is displayed, click the **Register** link to display the Register page.</span></span>
4. <span data-ttu-id="b74a5-173">Wprowadź swój adres e-mail i hasło, a następnie kliknij przycisk **zarejestrować** przycisk, aby wysłać wiadomość e-mail za pośrednictwem usługi SendGrid.</span><span class="sxs-lookup"><span data-stu-id="b74a5-173">Enter your email and password, then click the **Register** button to send an email message via SendGrid.</span></span>  
   <span data-ttu-id="b74a5-174">Bieżący stan projektu i kodu pozwoli użytkownikowi na logowanie po ukończeniu formularz rejestracji wskazany nawet, jeśli one nie zostały potwierdzone swojego konta.</span><span class="sxs-lookup"><span data-stu-id="b74a5-174">The current state of your project and code will allow the user to log in once they complete the registration form, even though they haven't confirmed their account.</span></span>
5. <span data-ttu-id="b74a5-175">Sprawdź swoje konto e-mail, a następnie kliknij link, aby potwierdzić swój adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-175">Check your email account and click on the link to confirm your email.</span></span>  
   <span data-ttu-id="b74a5-176">Po przesłaniu formularza rejestracji będą rejestrowane w.</span><span class="sxs-lookup"><span data-stu-id="b74a5-176">Once you submit the registration form, you will be logged in.</span></span>  
    ![Przykładowej witryny sieci Web — zalogowany](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image4.png)

<a id="require"></a>
## <a name="require-email-confirmation-before-log-in"></a><span data-ttu-id="b74a5-178">Wymaga potwierdzenia E-mail przed logowania</span><span class="sxs-lookup"><span data-stu-id="b74a5-178">Require Email Confirmation Before Log In</span></span>

<span data-ttu-id="b74a5-179">Mimo że potwierdzenia konta e-mail, w tym momencie nie należałoby kliknąć link zawarty w wiadomości e-mail weryfikującej, aby w pełni zalogować się.</span><span class="sxs-lookup"><span data-stu-id="b74a5-179">Although you have confirmed the email account, at this point you would not need to click on the link contained in the verification email to be fully signed-in.</span></span> <span data-ttu-id="b74a5-180">W poniższej sekcji zmodyfikujesz kod, wymagające nowych użytkowników, aby miał potwierdzone pocztą e-mail, które są rejestrowane (uwierzytelnienie).</span><span class="sxs-lookup"><span data-stu-id="b74a5-180">In the following section, you will modify the code requiring new users to have a confirmed email before they are logged in (authenticated).</span></span>

1. <span data-ttu-id="b74a5-181">W **Eksploratora rozwiązań** programu Visual Studio, należy zaktualizować `CreateUser_Click` zdarzenia w *Register.aspx.cs* związanym z kodem zawarte w *kont* folder z następujące zmiany wyróżnione:</span><span class="sxs-lookup"><span data-stu-id="b74a5-181">In **Solution Explorer** of Visual Studio, update the `CreateUser_Click` event in the *Register.aspx.cs* code-behind contained in the *Accounts* folder with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample5.cs?highlight=13-14,17-21)]
2. <span data-ttu-id="b74a5-182">Aktualizacja `LogIn` method in Class metoda *Login.aspx.cs* związanym z kodem z następującymi zmianami wyróżnione:</span><span class="sxs-lookup"><span data-stu-id="b74a5-182">Update the `LogIn` method in the *Login.aspx.cs* code-behind with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample6.cs?highlight=9-19,45-46)]

### <a name="run-the-application"></a><span data-ttu-id="b74a5-183">Uruchamianie aplikacji</span><span class="sxs-lookup"><span data-stu-id="b74a5-183">Run the Application</span></span>

 <span data-ttu-id="b74a5-184">Teraz, że udało Ci się wdrożyć kod, aby sprawdzić, czy adres e-mail użytkownika został potwierdzony, można sprawdzić funkcjonalność zarówno **zarejestrować** i **logowania** stron.</span><span class="sxs-lookup"><span data-stu-id="b74a5-184">Now that you have implemented the code to check whether a user's email address has been confirmed, you can check the functionality on both the **Register** and **Login** pages.</span></span> 

1. <span data-ttu-id="b74a5-185">Usuwanie kont w **AspNetUsers** tabeli, która zawiera alias poczty e-mail, które chcesz przetestować.</span><span class="sxs-lookup"><span data-stu-id="b74a5-185">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
2. <span data-ttu-id="b74a5-186">Uruchom aplikację (**F5**) i sprawdź, nie można zarejestrować jako użytkownik, do momentu potwierdzenia adresu e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-186">Run the app (**F5**) and verify you cannot register as a user until you have confirmed your email address.</span></span>
3. <span data-ttu-id="b74a5-187">Przed potwierdzeniem nowego konta za pośrednictwem poczty e-mail, która właśnie została wysłana, spróbuj zalogować się przy użyciu nowego konta.</span><span class="sxs-lookup"><span data-stu-id="b74a5-187">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="b74a5-188">Nie można się zalogować i posiadanie konta e-mail potwierdzonych będą widoczne.</span><span class="sxs-lookup"><span data-stu-id="b74a5-188">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span>
4. <span data-ttu-id="b74a5-189">Po upewnieniu się, Twój adres e-mail, zaloguj się do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b74a5-189">Once you confirm your email address, log in to the app.</span></span>

<a id="reset"></a>
## <a name="password-recovery-and-reset"></a><span data-ttu-id="b74a5-190">Hasło odzyskiwania i Reset</span><span class="sxs-lookup"><span data-stu-id="b74a5-190">Password Recovery and Reset</span></span>

1. <span data-ttu-id="b74a5-191">W programie Visual Studio, należy usunąć znaki komentarza z `Forgot` method in Class metoda *Forgot.aspx.cs* związanym z kodem zawarte w *konta* folderu, tak aby metoda pojawia się jako następuje:</span><span class="sxs-lookup"><span data-stu-id="b74a5-191">In Visual Studio, remove the comment characters from the `Forgot` method in the *Forgot.aspx.cs* code-behind contained in the *Account* folder, so that the method appears as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample7.cs?highlight=16-18)]
2. <span data-ttu-id="b74a5-192">Otwórz *Login.aspx* strony.</span><span class="sxs-lookup"><span data-stu-id="b74a5-192">Open the *Login.aspx* page.</span></span> <span data-ttu-id="b74a5-193">Zastąp kod znaczników osiągnie koniec cyklu **loginForm** sekcji jak wyróżniono poniżej:</span><span class="sxs-lookup"><span data-stu-id="b74a5-193">Replace the markup near the end of the **loginForm** section as highlighted below:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample8.aspx?highlight=52-53)]
3. <span data-ttu-id="b74a5-194">Otwórz *Login.aspx.cs* związanym z kodem i usuń znaczniki komentarza następujący wiersz kodu wyróżniony na żółto z `Page_Load` program obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="b74a5-194">Open the *Login.aspx.cs* code-behind and uncomment the following line of code highlighted in yellow from the `Page_Load` event handler:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample9.cs?highlight=5)]
4. <span data-ttu-id="b74a5-195">Uruchom aplikację, naciskając klawisz **F5.**</span><span class="sxs-lookup"><span data-stu-id="b74a5-195">Run the app by pressing **F5.**</span></span> <span data-ttu-id="b74a5-196">Po wyświetleniu strony kliknij **Zaloguj** łącza.</span><span class="sxs-lookup"><span data-stu-id="b74a5-196">After the page is displayed, click the **Log in** link.</span></span>
5. <span data-ttu-id="b74a5-197">Kliknij przycisk **nie pamiętasz hasła?** łącze, aby wyświetlić **nie pamiętam hasła** strony.</span><span class="sxs-lookup"><span data-stu-id="b74a5-197">Click the **Forgot your password?** link to display the **Forgot Password** page.</span></span>
6. <span data-ttu-id="b74a5-198">Wprowadź swój adres e-mail, a następnie kliknij przycisk **przesyłania** przycisk, aby wysłać wiadomość e-mail na adres, który umożliwi Ci zresetować hasło.</span><span class="sxs-lookup"><span data-stu-id="b74a5-198">Enter your email address and click the **Submit** button to send an email to your address which will allow you to reset your password.</span></span>   
   <span data-ttu-id="b74a5-199">Sprawdź swoje konto poczty e-mail i kliknij łącze, aby wyświetlić **resetowania hasła** strony.</span><span class="sxs-lookup"><span data-stu-id="b74a5-199">Check your email account and click on the link to display the **Reset Password** page.</span></span>
7. <span data-ttu-id="b74a5-200">Na **resetowania hasła** wpisz swoje wiadomości e-mail, hasło i potwierdzenie hasła.</span><span class="sxs-lookup"><span data-stu-id="b74a5-200">On the **Reset Password** page, enter your email, password, and confirmed password.</span></span> <span data-ttu-id="b74a5-201">Naciśnij klawisz **resetowania** przycisku.</span><span class="sxs-lookup"><span data-stu-id="b74a5-201">Then, press the **Reset** button.</span></span>  
   <span data-ttu-id="b74a5-202">Po zresetowaniu hasła, **zmiany hasła** zostanie wyświetlona strona.</span><span class="sxs-lookup"><span data-stu-id="b74a5-202">When you successfully reset your password, the **Password Changed** page will be displayed.</span></span> <span data-ttu-id="b74a5-203">Teraz możesz zalogować się przy użyciu nowego hasła.</span><span class="sxs-lookup"><span data-stu-id="b74a5-203">Now you can log in with your new password.</span></span>

<a id="rsend"></a>
## <a name="resend-email-confirmation-link"></a><span data-ttu-id="b74a5-204">Wyślij ponownie Link potwierdzenie adresu E-mail</span><span class="sxs-lookup"><span data-stu-id="b74a5-204">Resend Email Confirmation Link</span></span>

<span data-ttu-id="b74a5-205">Gdy użytkownik tworzy nowe konto lokalne, są pocztą e-mail link do potwierdzenia, które są wymagane, aby korzystały mogą oni się zalogować.</span><span class="sxs-lookup"><span data-stu-id="b74a5-205">Once a user creates a new local account, they are emailed a confirmation link they are required to use before they can log on.</span></span> <span data-ttu-id="b74a5-206">Jeśli użytkownik przypadkowo usunął wiadomość e-mail z potwierdzeniem lub nigdy nie odebraniu wiadomości e-mail, należy ponownie wysyłane link do potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="b74a5-206">If the user accidentally deletes the confirmation email, or the email never arrives, they will need the confirmation link sent again.</span></span> <span data-ttu-id="b74a5-207">Następujących zmian w kodzie pokazują, jak włączyć tę opcję.</span><span class="sxs-lookup"><span data-stu-id="b74a5-207">The following code changes show how to enable this.</span></span>

1. <span data-ttu-id="b74a5-208">W programie Visual Studio, otwórz **Login.aspx.cs** związanym z kodem i dodaj następującą obsługę zdarzeń po `LogIn` program obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="b74a5-208">In Visual Studio, open the **Login.aspx.cs** code-behind and add the following event handler after the `LogIn` event handler:</span></span>   

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample10.cs)]
2. <span data-ttu-id="b74a5-209">Modyfikowanie `LogIn` programu obsługi zdarzeń w *Login.aspx.cs* związanym z kodem, zmieniając kod wyróżniony na żółto w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="b74a5-209">Modify the `LogIn` event handler in the *Login.aspx.cs* code-behind by changing the code highlighted in yellow as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample11.cs?highlight=15-17)]
3. <span data-ttu-id="b74a5-210">Aktualizacja *Login.aspx* strony, dodając kod wyróżniony na żółto w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="b74a5-210">Update the *Login.aspx* page by adding the code highlighted in yellow as follows:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample12.aspx?highlight=45-46)]
4. <span data-ttu-id="b74a5-211">Usuwanie kont w **AspNetUsers** tabeli, która zawiera alias poczty e-mail, które chcesz przetestować.</span><span class="sxs-lookup"><span data-stu-id="b74a5-211">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
5. <span data-ttu-id="b74a5-212">Uruchom aplikację (**F5**) i zarejestruj swój adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-212">Run the app (**F5**) and register your email address.</span></span>
6. <span data-ttu-id="b74a5-213">Przed potwierdzeniem nowego konta za pośrednictwem poczty e-mail, która właśnie została wysłana, spróbuj zalogować się przy użyciu nowego konta.</span><span class="sxs-lookup"><span data-stu-id="b74a5-213">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
   <span data-ttu-id="b74a5-214">Nie można się zalogować i posiadanie konta e-mail potwierdzonych będą widoczne.</span><span class="sxs-lookup"><span data-stu-id="b74a5-214">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span> <span data-ttu-id="b74a5-215">Ponadto możesz teraz ponownie wysłać komunikat z potwierdzeniem z tym kontem e-mail.</span><span class="sxs-lookup"><span data-stu-id="b74a5-215">In addition, you can now resend a confirmation message to your email account.</span></span>
7. <span data-ttu-id="b74a5-216">Wprowadź swój adres e-mail i hasła, naciśnij klawisz **ponowne wysyłanie potwierdzenia** przycisku.</span><span class="sxs-lookup"><span data-stu-id="b74a5-216">Enter your email address and password, then press the **Resend confirmation** button.</span></span>
8. <span data-ttu-id="b74a5-217">Po upewnieniu się, Twój adres e-mail, na podstawie wiadomości e-mail nowo przesłanych, zaloguj się do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b74a5-217">Once you confirm your email address based on the newly sent email message, log in to the app.</span></span>

<a id="dbg"></a>
## <a name="troubleshooting-the-app"></a><span data-ttu-id="b74a5-218">Rozwiązywanie problemów z aplikacji</span><span class="sxs-lookup"><span data-stu-id="b74a5-218">Troubleshooting the App</span></span>

<span data-ttu-id="b74a5-219">Jeśli nie otrzymasz wiadomość e-mail zawierającą łącze, aby zweryfikować swoje poświadczenia:</span><span class="sxs-lookup"><span data-stu-id="b74a5-219">If you don't receive an email containing the link to verify your credentials:</span></span>

- <span data-ttu-id="b74a5-220">Sprawdź folder wiadomości-śmieci lub spamu.</span><span class="sxs-lookup"><span data-stu-id="b74a5-220">Check your junk or spam folder.</span></span>
- <span data-ttu-id="b74a5-221">Zaloguj się do Twojego konta SendGrid i kliknij pozycję [działania pocztą E-mail link](https://sendgrid.com/logs/index).</span><span class="sxs-lookup"><span data-stu-id="b74a5-221">Log into your SendGrid account and click on the [Email Activity link](https://sendgrid.com/logs/index).</span></span>
- <span data-ttu-id="b74a5-222">Mieć pewność, używana jest nazwa konta użytkownika usługi SendGrid jako *Web.config* wartości, a nie adres e-mail konta SendGrid.</span><span class="sxs-lookup"><span data-stu-id="b74a5-222">Be certain you used your SendGrid user account name as a *Web.config* value rather than your SendGrid account email address.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="b74a5-223">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="b74a5-223">Additional Resources</span></span>

- [<span data-ttu-id="b74a5-224">Łącza do produktu ASP.NET Identity zalecane zasoby</span><span class="sxs-lookup"><span data-stu-id="b74a5-224">Links to ASP.NET Identity Recommended Resources</span></span>](../../../identity/overview/getting-started/aspnet-identity-recommended-resources.md)
- [<span data-ttu-id="b74a5-225">Potwierdzenie konta i odzyskiwanie hasła w produkcie ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="b74a5-225">Account Confirmation and Password Recovery with ASP.NET Identity</span></span>](../../../identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity.md)
- [<span data-ttu-id="b74a5-226">Seria samouczków formularzy sieci Web platformy ASP.NET — Dodaj dostawcę uwierzytelniania OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="b74a5-226">ASP.NET Web Forms tutorial series - Add an OAuth 2.0 Provider</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#OAuthWebForms)
- [<span data-ttu-id="b74a5-227">Wdrażanie aplikacji formularzy bezpiecznej sieci Web platformy ASP.NET z członkostwa, uwierzytelnianiem OAuth i bazą danych SQL w usłudze Azure App Service</span><span class="sxs-lookup"><span data-stu-id="b74a5-227">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)
- [<span data-ttu-id="b74a5-228">ASP.NET Web Forms serii samouczków - Włącz SSL dla projektu</span><span class="sxs-lookup"><span data-stu-id="b74a5-228">ASP.NET Web Forms tutorial series - Enable SSL for the Project</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)
