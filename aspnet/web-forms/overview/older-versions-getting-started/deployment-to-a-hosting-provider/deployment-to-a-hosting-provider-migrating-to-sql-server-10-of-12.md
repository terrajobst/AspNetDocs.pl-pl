---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12
title: 'Wdrażanie SQL Server Compact aplikacji sieci Web ASP.NET za pomocą programu Visual Studio lub Visual Web Developer: Migrowanie do SQL Server-10 z 12 | Microsoft Docs'
author: tdykstra
description: W tej serii samouczków pokazano, jak wdrożyć (opublikować) projekt aplikacji sieci Web ASP.NET, który zawiera bazę danych SQL Server Compact przy użyciu stu Visual...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: a89d6f32-b71b-4036-8ff7-5f8ac2a6eca8
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12
msc.type: authoredcontent
ms.openlocfilehash: c5281a42596d95e725b32e652c75785abe0fd64e
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74640553"
---
# <a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-migrating-to-sql-server---10-of-12"></a><span data-ttu-id="ad7e3-103">Wdrażanie SQL Server Compact aplikacji sieci Web ASP.NET za pomocą programu Visual Studio lub Visual Web Developer: Migrowanie do SQL Server-10 z 12</span><span class="sxs-lookup"><span data-stu-id="ad7e3-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Migrating to SQL Server - 10 of 12</span></span>

<span data-ttu-id="ad7e3-104">Autor [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="ad7e3-105">Pobierz projekt początkowy</span><span class="sxs-lookup"><span data-stu-id="ad7e3-105">Download Starter Project</span></span>](https://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="ad7e3-106">W tej serii samouczków pokazano, jak wdrożyć (opublikować) projekt aplikacji sieci Web ASP.NET, który zawiera bazę danych SQL Server Compact przy użyciu programu Visual Studio 2012 RC lub Visual Studio Express 2012 RC dla sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="ad7e3-107">Możesz również użyć programu Visual Studio 2010, jeśli zostanie zainstalowana aktualizacja publikacji w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="ad7e3-108">Aby zapoznać się z wprowadzeniem do serii, zobacz [pierwszy samouczek w serii](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="ad7e3-109">Aby zapoznać się z samouczkiem zawierającym funkcje wdrażania wprowadzone po wydaniu wersji RC programu Visual Studio 2012, przedstawiono sposób wdrażania wersji SQL Server innych niż SQL Server Compact i przedstawiono sposób wdrażania programu w Azure App Service Web Apps, zobacz [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="ad7e3-110">Omówienie</span><span class="sxs-lookup"><span data-stu-id="ad7e3-110">Overview</span></span>

<span data-ttu-id="ad7e3-111">W tym samouczku pokazano, jak przeprowadzić migrację z SQL Server Compact do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-111">This tutorial shows you how to migrate from SQL Server Compact to SQL Server.</span></span> <span data-ttu-id="ad7e3-112">Jednym z powodów, które warto wykonać, jest skorzystanie z funkcji SQL Server, które nie są obsługiwane przez SQL Server Compact, takich jak procedury składowane, wyzwalacze, widoki lub replikacja.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-112">One reason you might want to do that is to take advantage of SQL Server features that SQL Server Compact does not support, such as stored procedures, triggers, views, or replication.</span></span> <span data-ttu-id="ad7e3-113">Aby uzyskać więcej informacji o różnicach między SQL Server Compact i SQL Server, zobacz samouczek [wdrażania SQL Server Compact](deployment-to-a-hosting-provider-deploying-sql-server-compact-databases-2-of-12.md) .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-113">For more information about the differences between SQL Server Compact and SQL Server, see the [Deploying SQL Server Compact](deployment-to-a-hosting-provider-deploying-sql-server-compact-databases-2-of-12.md) tutorial.</span></span>

### <a name="sql-server-express-versus-full-sql-server-for-development"></a><span data-ttu-id="ad7e3-114">SQL Server Express a pełny SQL Server do programowania</span><span class="sxs-lookup"><span data-stu-id="ad7e3-114">SQL Server Express versus full SQL Server for Development</span></span>

<span data-ttu-id="ad7e3-115">Po podjęciu decyzji o przeprowadzeniu uaktualnienia do SQL Server warto użyć SQL Server lub SQL Server Express w środowiskach deweloperskich i testowych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-115">Once you've decided to upgrade to SQL Server, you might want to use SQL Server or SQL Server Express in your development and test environments.</span></span> <span data-ttu-id="ad7e3-116">Oprócz różnic w obsłudze narzędzi i funkcji aparatu bazy danych istnieją różnice w implementacji dostawców między SQL Server Compact i innymi wersjami SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-116">In addition to the differences in tool support and in database engine features, there are differences in provider implementations between SQL Server Compact and other versions of SQL Server.</span></span> <span data-ttu-id="ad7e3-117">Różnice te mogą spowodować, że ten sam kod generuje różne wyniki.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-117">These differences can cause the same code to generate different results.</span></span> <span data-ttu-id="ad7e3-118">W związku z tym, jeśli zdecydujesz się na zachowanie SQL Server Compact jako bazy danych programistycznych, należy dokładnie przetestować lokację w SQL Server lub SQL Server Express w środowisku testowym przed każdym wdrożeniem do produkcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-118">Therefore, if you decide to keep SQL Server Compact as your development database, you should thoroughly test your site in SQL Server or SQL Server Express in a test environment before each deployment to production.</span></span>

<span data-ttu-id="ad7e3-119">W przeciwieństwie do SQL Server Compact, SQL Server Express to ten sam aparat bazy danych i używa tego samego dostawcy platformy .NET jak pełnych SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-119">Unlike SQL Server Compact, SQL Server Express is essentially the same database engine and uses the same .NET provider as full SQL Server.</span></span> <span data-ttu-id="ad7e3-120">Podczas testowania za pomocą SQL Server Express można mieć pewność, że uzyskasz te same wyniki, co w przypadku SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-120">When you test with SQL Server Express, you can be confident of getting the same results as you will with SQL Server.</span></span> <span data-ttu-id="ad7e3-121">Większość z tych samych narzędzi bazy danych może być używana z SQL Server Express, których można używać z SQL Server (istotny wyjątek [SQL Server Profiler](https://msdn.microsoft.com/library/ms181091.aspx)) i obsługuje inne funkcje SQL Server, takie jak procedury składowane, widoki, wyzwalacze i replikacja.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-121">You can use most of the same database tools with SQL Server Express that you can use with SQL Server (a notable exception being [SQL Server Profiler](https://msdn.microsoft.com/library/ms181091.aspx)), and it supports other features of SQL Server like stored procedures, views, triggers, and replication.</span></span> <span data-ttu-id="ad7e3-122">(Zazwyczaj należy używać pełnych SQL Server w produkcyjnej witrynie sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-122">(You typically have to use full SQL Server in a production website, however.</span></span> <span data-ttu-id="ad7e3-123">SQL Server Express można uruchamiać w udostępnionym środowisku hostingu, ale nie została ona zaprojektowana dla tego programu, a wielu dostawców hostingu nie obsługuje tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-123">SQL Server Express can run in a shared hosting environment, but it was not designed for that, and many hosting providers do not support it.)</span></span>

<span data-ttu-id="ad7e3-124">W przypadku korzystania z programu Visual Studio 2012 zwykle wybiera się SQL Server Express LocalDB dla środowiska deweloperskiego, ponieważ jest to co jest instalowane domyślnie z programem Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-124">If you are using Visual Studio 2012, you typically choose SQL Server Express LocalDB for your development environment because that is what is installed by default with Visual Studio.</span></span> <span data-ttu-id="ad7e3-125">Jednak LocalDB nie działa w usługach IIS, dlatego dla środowiska testowego należy użyć SQL Server lub SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-125">However, LocalDB does not work in IIS, so for your test environment you have to use either SQL Server or SQL Server Express.</span></span>

### <a name="combining-databases-versus-keeping-them-separate"></a><span data-ttu-id="ad7e3-126">Łączenie baz danych w zależności od ich oddzielenia</span><span class="sxs-lookup"><span data-stu-id="ad7e3-126">Combining Databases versus Keeping Them Separate</span></span>

<span data-ttu-id="ad7e3-127">Aplikacja firmy Contoso University ma dwie SQL Server Compact bazy danych: bazę danych członkostwa (*ASPNET. sdf*) i bazę danych aplikacji (*szkoła. sdf*).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-127">The Contoso University application has two SQL Server Compact databases: the membership database (*aspnet.sdf*) and the application database (*School.sdf*).</span></span> <span data-ttu-id="ad7e3-128">Podczas migracji można migrować te bazy danych do dwóch oddzielnych baz danych lub do pojedynczej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-128">When you migrate, you can migrate these databases to two separate databases or to a single database.</span></span> <span data-ttu-id="ad7e3-129">Warto połączyć je w celu ułatwienia sprzężenia bazy danych między bazą danych aplikacji i bazą danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-129">You might want to combine them in order to facilitate database joins between your application database and your membership database.</span></span> <span data-ttu-id="ad7e3-130">Twój plan hostingu może również stanowić powód, aby połączyć się z nimi.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-130">Your hosting plan might also provide a reason to combine them.</span></span> <span data-ttu-id="ad7e3-131">Na przykład dostawca hostingu może obciążać więcej dla wielu baz danych lub nawet nie zezwalać na więcej niż jedną bazę danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-131">For example, the hosting provider might charge more for multiple databases or might not even allow more than one database.</span></span> <span data-ttu-id="ad7e3-132">Jest to przypadek z kontem hostingu usługi Cytanium w wersji Lite używanym w ramach tego samouczka, który umożliwia tylko jedną bazę danych SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-132">That's the case with the Cytanium Lite hosting account that's used for this tutorial, which allows only a single SQL Server database.</span></span>

<span data-ttu-id="ad7e3-133">W tym samouczku przeprowadzisz migrację dwóch baz danych w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-133">In this tutorial, you'll migrate your two databases this way:</span></span>

- <span data-ttu-id="ad7e3-134">Migruj do dwóch LocalDB baz danych w środowisku deweloperskim.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-134">Migrate to two LocalDB databases in the development environment.</span></span>
- <span data-ttu-id="ad7e3-135">Przeprowadź migrację do dwóch baz danych SQL Server Express w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-135">Migrate to two SQL Server Express databases in the test environment.</span></span>
- <span data-ttu-id="ad7e3-136">Przeprowadź migrację do jednej połączonej pełnej bazy danych SQL Server w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-136">Migrate to one combined full SQL Server database in the production environment.</span></span>

<span data-ttu-id="ad7e3-137">Przypomnienie: Jeśli zostanie wyświetlony komunikat o błędzie lub coś nie działa, gdy przejdziesz do samouczka, pamiętaj o sprawdzeniu [strony rozwiązywania problemów](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-137">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="installing-sql-server-express"></a><span data-ttu-id="ad7e3-138">Instalowanie SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="ad7e3-138">Installing SQL Server Express</span></span>

<span data-ttu-id="ad7e3-139">Program SQL Server Express jest automatycznie instalowany domyślnie z programem Visual Studio 2010, ale domyślnie nie jest instalowany z programem Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-139">SQL Server Express is automatically installed by default with Visual Studio 2010, but by default it is not installed with Visual Studio 2012.</span></span> <span data-ttu-id="ad7e3-140">Aby zainstalować SQL Server 2012 Express, kliknij poniższy link</span><span class="sxs-lookup"><span data-stu-id="ad7e3-140">To install SQL Server 2012 Express, click the following link</span></span>

- [<span data-ttu-id="ad7e3-141">SQL Server Express 2012</span><span class="sxs-lookup"><span data-stu-id="ad7e3-141">SQL Server Express 2012</span></span>](https://www.microsoft.com/download/details.aspx?id=29062)

<span data-ttu-id="ad7e3-142">Wybierz pozycję *plk/x64/sqlexpr\_x64\_plk. exe* lub *plk/x86/sqlexpr\_x86\_plk. exe*, a w Kreatorze instalacji zaakceptuj ustawienia domyślne.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-142">Choose *ENU/x64/SQLEXPR\_x64\_ENU.exe* or *ENU/x86/SQLEXPR\_x86\_ENU.exe*, and in the installation wizard accept the default settings.</span></span> <span data-ttu-id="ad7e3-143">Aby uzyskać więcej informacji na temat opcji instalacji, zobacz [instalowanie SQL Server 2012 w Kreatorze instalacji (Instalator)](https://msdn.microsoft.com/library/ms143219.aspx).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-143">For more information about installation options, see [Install SQL Server 2012 from the Installation Wizard (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span></span>

## <a name="creating-sql-server-express-databases-for-the-test-environment"></a><span data-ttu-id="ad7e3-144">Tworzenie SQL Server Express baz danych dla środowiska testowego</span><span class="sxs-lookup"><span data-stu-id="ad7e3-144">Creating SQL Server Express Databases for the Test Environment</span></span>

<span data-ttu-id="ad7e3-145">Następnym krokiem jest utworzenie bazy danych ASP.NET i szkoły.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-145">The next step is to create the ASP.NET membership and School databases.</span></span>

<span data-ttu-id="ad7e3-146">Z menu **Widok** wybierz pozycję **Eksplorator serwera** (**Eksplorator bazy danych** w Visual Web Developer), a następnie kliknij prawym przyciskiem myszy pozycję **połączenia danych** i wybierz polecenie **Utwórz nową SQL Server bazę danych**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-146">From the **View** menu select **Server Explorer** (**Database Explorer** in Visual Web Developer), and then right-click **Data Connections** and select **Create New SQL Server Database**.</span></span>

![Selecting_Create_New_SQL_Server_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image1.png)

<span data-ttu-id="ad7e3-148">W oknie dialogowym **Utwórz nową bazę danych SQL Server** wprowadź wartość ".\SQLEXPRESS" w polu **Nazwa serwera** i "ASPNET-test" w polu **Nazwa nowej bazy danych** , a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-148">In the **Create New SQL Server Database** dialog box, enter ".\SQLExpress" in the **Server name** box and "aspnet-Test" in the **New database name** box, then click **OK**.</span></span>

![Create_New_SQL_Server_Database_aspnet](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image2.png)

<span data-ttu-id="ad7e3-150">Postępuj zgodnie z tą samą procedurą, aby utworzyć nową bazę danych szkoły SQL Server Express o nazwie "Szkoła-test".</span><span class="sxs-lookup"><span data-stu-id="ad7e3-150">Follow the same procedure to create a new SQL Server Express School database named "School-Test".</span></span>

<span data-ttu-id="ad7e3-151">(Do tych nazw baz danych są dołączane "testy", ponieważ w przyszłości utworzysz dodatkowe wystąpienie każdej bazy danych dla środowiska programistycznego i musisz mieć możliwość odróżnienia dwóch zestawów baz danych).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-151">(You're appending "Test" to these database names because later you'll create an additional instance of each database for the development environment, and you need to be able to differentiate the two sets of databases.)</span></span>

<span data-ttu-id="ad7e3-152">**Eksplorator serwera** teraz pokazuje dwie nowe bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-152">**Server Explorer** now shows the two new databases.</span></span>

![New_databases_in_Server_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image3.png)

## <a name="creating-a-grant-script-for-the-new-databases"></a><span data-ttu-id="ad7e3-154">Tworzenie skryptu dotacji dla nowych baz danych</span><span class="sxs-lookup"><span data-stu-id="ad7e3-154">Creating a Grant Script for the New Databases</span></span>

<span data-ttu-id="ad7e3-155">Gdy aplikacja jest uruchamiana w usługach IIS na komputerze deweloperskim, aplikacja uzyskuje dostęp do bazy danych przy użyciu poświadczeń domyślnej puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-155">When the application runs in IIS on your development computer, the application accesses the database by using the default application pool's credentials.</span></span> <span data-ttu-id="ad7e3-156">Jednak domyślnie tożsamość puli aplikacji nie ma uprawnień do otwierania baz danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-156">However, by default, the application pool identity does not have permission to open the databases.</span></span> <span data-ttu-id="ad7e3-157">Aby udzielić tego uprawnienia, należy uruchomić skrypt.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-157">So you have to run a script to grant that permission.</span></span> <span data-ttu-id="ad7e3-158">W tej sekcji utworzysz skrypt, który zostanie uruchomiony później, aby upewnić się, że aplikacja może otworzyć bazy danych w programie IIS.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-158">In this section you create the script that you'll run later to make sure that the application can open the databases when it runs in IIS.</span></span>

<span data-ttu-id="ad7e3-159">W folderze *SolutionFiles* rozwiązania, który został utworzony w samouczku [wdrażanie do środowiska produkcyjnego](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) , Utwórz nowy plik SQL o nazwie *Grant. SQL*.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-159">In the solution's *SolutionFiles* folder that you created in the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, create a new SQL file named *Grant.sql*.</span></span> <span data-ttu-id="ad7e3-160">Skopiuj następujące polecenia SQL do pliku, a następnie Zapisz i zamknij plik:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-160">Copy the following SQL commands into the file, and then save and close the file:</span></span>

[!code-sql[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample1.sql)]

> [!NOTE]
> <span data-ttu-id="ad7e3-161">Ten skrypt jest przeznaczony do pracy z SQL Server 2008 i z ustawieniami usług IIS w systemie Windows 7, zgodnie z opisem w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-161">This script is designed to work with SQL Server 2008 and with the IIS settings in Windows 7 as they are specified in this tutorial.</span></span> <span data-ttu-id="ad7e3-162">Jeśli używasz innej wersji SQL Server lub systemu Windows lub jeśli program IIS zostanie skonfigurowany na komputerze inaczej, może być wymagane wprowadzenie zmian w tym skrypcie.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-162">If you're using a different version of SQL Server or of Windows, or if you set up IIS on your computer differently, changes to this script might be required.</span></span> <span data-ttu-id="ad7e3-163">Aby uzyskać więcej informacji na temat skryptów SQL Server, zobacz [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-163">For more information about SQL Server scripts, see [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ad7e3-164">**Uwaga dotycząca zabezpieczeń** Ten skrypt daje użytkownikowi\_uprawnienia właściciela bazy danych, który uzyskuje dostęp do tej samej bazie w czasie wykonywania, czyli w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-164">**Security Note** This script gives db\_owner permissions to the user that accesses the database at run time, which is what you'll have in the production environment.</span></span> <span data-ttu-id="ad7e3-165">W niektórych scenariuszach możesz określić użytkownika, który ma pełne uprawnienia do aktualizacji schematu bazy danych tylko do wdrożenia, i określić dla czasu wykonywania inny użytkownik, który ma uprawnienia tylko do odczytu i zapisu danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-165">In some scenarios you might want to specify a user that has full database schema update permissions only for deployment, and specify for run time a different user that has permissions only to read and write data.</span></span> <span data-ttu-id="ad7e3-166">Aby uzyskać więcej informacji, zobacz **przeglądanie automatycznych zmian w pliku Web. config dla migracje Code First** w [ramach wdrażania do usług IIS jako środowiska testowego](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-166">For more information, see **Reviewing the Automatic Web.config Changes for Code First Migrations** in [Deploying to IIS as a Test Environment](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md).</span></span>

## <a name="configuring-database-deployment-for-the-test-environment"></a><span data-ttu-id="ad7e3-167">Konfigurowanie wdrażania bazy danych dla środowiska testowego</span><span class="sxs-lookup"><span data-stu-id="ad7e3-167">Configuring Database Deployment for the Test Environment</span></span>

<span data-ttu-id="ad7e3-168">Następnie skonfigurujesz program Visual Studio tak, aby wykonał następujące zadania dla każdej bazy danych:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-168">Next, you'll configure Visual Studio so that it will do the following tasks for each database:</span></span>

- <span data-ttu-id="ad7e3-169">Wygeneruj skrypt SQL, który tworzy strukturę źródłowej bazy danych (tabele, kolumny, ograniczenia itp.) w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-169">Generate a SQL script that creates the source database's structure (tables, columns, constraints, etc.) in the destination database.</span></span>
- <span data-ttu-id="ad7e3-170">Wygeneruj skrypt SQL, który wstawia dane źródłowej bazy danych do tabel w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-170">Generate a SQL script that inserts the source database's data into the tables in the destination database.</span></span>
- <span data-ttu-id="ad7e3-171">Uruchom wygenerowane skrypty i utworzony skrypt przydzielenia w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-171">Run the generated scripts, and the Grant script that you created, in the destination database.</span></span>

<span data-ttu-id="ad7e3-172">Otwórz okno **właściwości projektu** i wybierz kartę **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-172">Open the **Project Properties** window and select the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="ad7e3-173">Upewnij się, że na liście rozwijanej **Konfiguracja** została wybrana wartość **Active (wersja)** lub **Zwolnij** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-173">Make sure that **Active (Release)** or **Release** is selected in the **Configuration** drop-down list.</span></span>

<span data-ttu-id="ad7e3-174">Kliknij pozycję **Włącz tę stronę**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-174">Click **Enable this Page**.</span></span>

![Package_Publish_SQL_tab_Enable_This_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image4.png)

<span data-ttu-id="ad7e3-176">Karta **pakiet/publikowanie SQL** jest zwykle wyłączona, ponieważ określa starszą metodę wdrażania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-176">The **Package/Publish SQL** tab is normally disabled because it specifies a legacy deployment method.</span></span> <span data-ttu-id="ad7e3-177">W przypadku większości scenariuszy należy skonfigurować wdrażanie bazy danych w kreatorze **publikowania w sieci Web** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-177">For most scenarios, you should configure database deployment in the **Publish Web** wizard.</span></span> <span data-ttu-id="ad7e3-178">Migracja z SQL Server Compact do SQL Server lub SQL Server Express jest szczególnym przypadkiem, dla którego ta metoda jest dobrym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-178">Migrating from SQL Server Compact to SQL Server or SQL Server Express is a special case for which this method is a good choice.</span></span>

<span data-ttu-id="ad7e3-179">Kliknij pozycję **Importuj z pliku Web. config**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-179">Click **Import from Web.config**.</span></span>

![Selecting_Import_from_Web. config](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image5.png)

<span data-ttu-id="ad7e3-181">Program Visual Studio szuka parametrów połączenia w pliku *Web. config* , znajduje jeden dla bazy danych członkostwa i jeden dla bazy danych szkoły i dodaje wiersz odpowiadający poszczególnym parametrom połączenia w tabeli **wpisów bazy danych** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-181">Visual Studio looks for connection strings in the *Web.config* file, finds one for the membership database and one for the School database, and adds a row corresponding to each connection string in the **Database Entries** table.</span></span> <span data-ttu-id="ad7e3-182">Znalezione parametry połączenia są dla istniejących SQL Server Compact baz danych, a następnym krokiem będzie skonfigurowanie sposobu i miejsca wdrożenia tych baz danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-182">The connection strings it finds are for the existing SQL Server Compact databases, and your next step will be to configure how and where to deploy these databases.</span></span>

<span data-ttu-id="ad7e3-183">W sekcji **szczegóły wpisu bazy** danych wprowadź ustawienia wdrażania bazy danych poniżej tabeli **wpisy** bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-183">You enter database deployment settings in the **Database Entry Details** section below the **Database Entries** table.</span></span> <span data-ttu-id="ad7e3-184">Ustawienia wyświetlane w sekcji **szczegóły wpisu bazy danych** dotyczą dowolnego wiersza w tabeli **wpisy bazy danych** , jak pokazano na poniższej ilustracji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-184">The settings shown in the **Database Entry Details** section pertain to whichever row in the **Database Entries** table is selected, as shown in the following illustration.</span></span>

![Database_Entry_Details_section_of_Package_Publish_SQL_tab](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image6.png)

### <a name="configuring-deployment-settings-for-the-membership-database"></a><span data-ttu-id="ad7e3-186">Konfigurowanie ustawień wdrożenia dla bazy danych członkostwa</span><span class="sxs-lookup"><span data-stu-id="ad7e3-186">Configuring Deployment Settings for the Membership Database</span></span>

<span data-ttu-id="ad7e3-187">Wybierz wiersz **DefaultConnection-Deployment** w tabeli **wpisy bazy danych** , aby skonfigurować ustawienia, które mają zastosowanie do bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-187">Select the **DefaultConnection-Deployment** row in the **Database Entries** table in order to configure settings that apply to the membership database.</span></span>

<span data-ttu-id="ad7e3-188">W polu **Parametry połączenia dla docelowej bazy danych**wprowadź parametry połączenia wskazujące nową bazę danych członkostwa SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-188">In **Connection string for destination database**, enter a connection string that points to the new SQL Server Express membership database.</span></span> <span data-ttu-id="ad7e3-189">Parametry połączenia, które są potrzebne, można uzyskać z **Eksplorator serwera**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-189">You can get the connection string you need from **Server Explorer**.</span></span> <span data-ttu-id="ad7e3-190">W **Eksplorator serwera**rozwiń węzeł **połączenia danych** i wybierz bazę danych **aspnetTest** , a następnie w oknie **Właściwości** skopiuj wartość **Parametry połączenia** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-190">In **Server Explorer**, expand **Data Connections** and select the **aspnetTest** database, then from the **Properties** window copy the **Connection String** value.</span></span>

![aspnet_connection_string_in_Server_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image7.png)

<span data-ttu-id="ad7e3-192">Te same parametry połączenia są odtwarzane tutaj:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-192">The same connection string is reproduced here:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample2.cmd)]

<span data-ttu-id="ad7e3-193">Skopiuj i wklej te parametry połączenia do **parametrów połączenia dla docelowej bazy danych** na karcie **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-193">Copy and paste this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="ad7e3-194">Upewnij się, że wybrano **dane i/lub schemat z istniejącej bazy danych** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-194">Make sure that **Pull data and/or schema from an existing database** is selected.</span></span> <span data-ttu-id="ad7e3-195">Powoduje to, że skrypty SQL mają być automatycznie generowane i uruchamiane w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-195">This is what causes SQL scripts to be automatically generated and run in the destination database.</span></span>

<span data-ttu-id="ad7e3-196">**Parametry połączenia dla wartości źródłowej bazy danych** są wyodrębniane z pliku *Web. config* i wskazują na bazę danych SQL Server Compact deweloperskich.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-196">The **Connection string for the source database** value is extracted from the *Web.config* file and points to the development SQL Server Compact database.</span></span> <span data-ttu-id="ad7e3-197">Jest to źródłowa baza danych, która zostanie użyta do wygenerowania skryptów, które będą uruchamiane później w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-197">This is the source database that will be used to generate the scripts that will run later in the destination database.</span></span> <span data-ttu-id="ad7e3-198">Ponieważ chcesz wdrożyć wersję produkcyjną bazy danych, Zmień wartość "aspnet-Dev. sdf" na "aspnet-Prod. sdf".</span><span class="sxs-lookup"><span data-stu-id="ad7e3-198">Since you want to deploy the production version of the database, change "aspnet-Dev.sdf" to "aspnet-Prod.sdf".</span></span>

<span data-ttu-id="ad7e3-199">Zmień **Opcje skryptów bazy danych** ze **schematu tylko** na **schemat i dane**, ponieważ chcesz skopiować dane (konta i role użytkowników), a także strukturę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-199">Change **Database scripting options** from **Schema Only** to **Schema and data**, since you want to copy your data (user accounts and roles) as well as the database structure.</span></span>

<span data-ttu-id="ad7e3-200">Aby skonfigurować wdrożenie do uruchamiania utworzonych wcześniej skryptów dotacji, należy dodać je do sekcji **skrypty bazy danych** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-200">To configure deployment to run the grant scripts that you created earlier, you have to add them to the **Database Scripts** section.</span></span> <span data-ttu-id="ad7e3-201">Kliknij przycisk **Dodaj skrypt**, a następnie w oknie dialogowym **Dodawanie skryptów SQL** przejdź do folderu, w którym zapisano skrypt Grant (jest to folder zawierający plik rozwiązania).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-201">Click **Add Script**, and in the **Add SQL Scripts** dialog box, navigate to the folder where you stored the grant script (this is the folder that contains your solution file).</span></span> <span data-ttu-id="ad7e3-202">Wybierz plik o nazwie *Grant. SQL*, a następnie kliknij przycisk **Otwórz**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-202">Select the file named *Grant.sql*, and click **Open**.</span></span>

<span data-ttu-id="ad7e3-203">[![Select_File_dialog_box_grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image9.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-203">[![Select_File_dialog_box_grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image9.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image8.png)</span></span>

<span data-ttu-id="ad7e3-204">Ustawienia wiersza **DefaultConnection-Deployment** w **wpisach bazy danych** wyglądają teraz tak, jak na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-204">The settings for the **DefaultConnection-Deployment** row in **Database Entries** now look like the following illustration:</span></span>

![Database_Entry_Details_for_DefaultConnection_Test](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image10.png)

### <a name="configuring-deployment-settings-for-the-school-database"></a><span data-ttu-id="ad7e3-206">Konfigurowanie ustawień wdrożenia dla bazy danych szkoły</span><span class="sxs-lookup"><span data-stu-id="ad7e3-206">Configuring Deployment Settings for the School Database</span></span>

<span data-ttu-id="ad7e3-207">Następnie wybierz wiersz **SchoolContext-Deployment** w tabeli **wpisy bazy danych** w celu skonfigurowania ustawień wdrożenia dla bazy danych szkoły.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-207">Next, select the **SchoolContext-Deployment** row in the **Database Entries** table in order to configure deployment settings for the School database.</span></span>

<span data-ttu-id="ad7e3-208">Możesz użyć tej samej metody, która została wcześniej użyta w celu uzyskania parametrów połączenia dla nowej bazy danych SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-208">You can use the same method you used earlier to get the connection string for the new SQL Server Express database.</span></span> <span data-ttu-id="ad7e3-209">Skopiuj te parametry połączenia do **parametrów połączenia dla docelowej bazy danych** na karcie **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-209">Copy this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample3.cmd)]

<span data-ttu-id="ad7e3-210">Upewnij się, że wybrano **dane i/lub schemat z istniejącej bazy danych** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-210">Make sure that **Pull data and/or schema from an existing database** is selected.</span></span>

<span data-ttu-id="ad7e3-211">**Parametry połączenia dla wartości źródłowej bazy danych** są wyodrębniane z pliku *Web. config* i wskazują na bazę danych SQL Server Compact deweloperskich.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-211">The **Connection string for the source database** value is extracted from the *Web.config* file and points to the development SQL Server Compact database.</span></span> <span data-ttu-id="ad7e3-212">Zmień wartość "School-Dev. sdf" na "School-Prod. sdf", aby wdrożyć wersję produkcyjną bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-212">Change "School-Dev.sdf" to "School-Prod.sdf" to deploy the production version of the database.</span></span> <span data-ttu-id="ad7e3-213">(Nigdy nie utworzono pliku School-Prod. sdf w folderze danych\_aplikacji, więc skopiujesz go ze środowiska testowego do folderu dane\_aplikacji w folderze projektu ContosoUniversity).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-213">(You never created a School-Prod.sdf file in the App\_Data folder, so you'll copy that file from the test environment to the App\_Data folder in the ContosoUniversity project folder later.)</span></span>

<span data-ttu-id="ad7e3-214">Zmień **Opcje obsługi skryptów bazy danych** na **schemat i dane**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-214">Change **Database scripting options** to **Schema and data**.</span></span>

<span data-ttu-id="ad7e3-215">Należy również uruchomić skrypt, aby przyznać uprawnienia do odczytu i zapisu dla tej bazy danych w tożsamości puli aplikacji, więc Dodaj plik skryptu *Grant. SQL* tak, jak w przypadku bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-215">You also want to run the script to grant read and write permission for this database to the application pool identity, so add the *Grant.sql* script file as you did for the membership database.</span></span>

<span data-ttu-id="ad7e3-216">Po zakończeniu ustawienia dla wiersza **SchoolContext-Deployment** w **pozycji bazy danych** wyglądają podobnie jak na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-216">When you're done, the settings for the **SchoolContext-Deployment** row in **Database Entries** look like the following illustration:</span></span>

![Database_Entry_Details_for_SchoolContext_Test](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image11.png)

<span data-ttu-id="ad7e3-218">Zapisz zmiany na karcie **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-218">Save the changes to the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="ad7e3-219">Skopiuj plik *School-prod. sdf* z folderu *danych c:\inetpub\wwwroot\ContosoUniversity\App\_* do folderu *\_danych aplikacji* w projekcie ContosoUniversity.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-219">Copy the *School-Prod.sdf* file from the *c:\inetpub\wwwroot\ContosoUniversity\App\_Data* folder to the *App\_Data* folder in the ContosoUniversity project.</span></span>

### <a name="specifying-transacted-mode-for-the-grant-script"></a><span data-ttu-id="ad7e3-220">Określanie trybu transakcyjnego dla skryptu dotacji</span><span class="sxs-lookup"><span data-stu-id="ad7e3-220">Specifying Transacted Mode for the Grant Script</span></span>

<span data-ttu-id="ad7e3-221">Proces wdrażania generuje skrypty, które wdrażają schemat bazy danych i dane.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-221">The deployment process generates scripts that deploy the database schema and data.</span></span> <span data-ttu-id="ad7e3-222">Domyślnie te skrypty są uruchamiane w transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-222">By default, these scripts run in a transaction.</span></span> <span data-ttu-id="ad7e3-223">Jednak skrypty niestandardowe (takie jak skrypty grantu) domyślnie nie są uruchamiane w transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-223">However, custom scripts (like the grant scripts) by default do not run in a transaction.</span></span> <span data-ttu-id="ad7e3-224">Jeśli proces wdrażania miesza tryby transakcji, może wystąpić błąd limitu czasu, gdy skrypty są uruchamiane podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-224">If the deployment process mixes transaction modes, you might get a timeout error when the scripts run during deployment.</span></span> <span data-ttu-id="ad7e3-225">W tej sekcji edytujesz plik projektu w celu skonfigurowania skryptów niestandardowych do uruchamiania w transakcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-225">In this section, you edit the project file in order to configure the custom scripts to run in a transaction.</span></span>

<span data-ttu-id="ad7e3-226">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy projekt **ContosoUniversity** i wybierz polecenie **Zwolnij projekt**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-226">In **Solution Explorer**, right-click the **ContosoUniversity** project and select **Unload Project**.</span></span>

![Unload_Project_in_Solution_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image12.png)

<span data-ttu-id="ad7e3-228">Następnie ponownie kliknij prawym przyciskiem myszy projekt i wybierz polecenie **Edytuj ContosoUniversity. csproj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-228">Then right-click the project again and select **Edit ContosoUniversity.csproj**.</span></span>

![Edit_Project_in_Solution_Explorer](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image13.png)

<span data-ttu-id="ad7e3-230">Edytor programu Visual Studio pokazuje zawartość XML pliku projektu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-230">The Visual Studio editor shows you the XML content of the project file.</span></span> <span data-ttu-id="ad7e3-231">Zwróć uwagę, że istnieje kilka `PropertyGroup` elementów.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-231">Notice that there are several `PropertyGroup` elements.</span></span> <span data-ttu-id="ad7e3-232">(W obrazie zawartość `PropertyGroup` elementów została pominięta.)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-232">(In the image, the contents of the `PropertyGroup` elements have been omitted.)</span></span>

![Okno edytora plików projektu](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image15.png)

<span data-ttu-id="ad7e3-234">Pierwszy, który nie ma `Condition` atrybutu, jest przeznaczony dla ustawień, które są stosowane niezależnie od konfiguracji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-234">The first one, which has no `Condition` attribute, is for settings that apply regardless of build configuration.</span></span> <span data-ttu-id="ad7e3-235">Jeden `PropertyGroup` element ma zastosowanie tylko do konfiguracji kompilacji debugowania (należy zauważyć, że atrybut `Condition`), jeden ma zastosowanie tylko do konfiguracji kompilacji wydania, a jeden ma zastosowanie tylko do konfiguracji kompilacji testowej.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-235">One `PropertyGroup` element applies only to the Debug build configuration (note the `Condition` attribute), one applies only to the Release build configuration, and one applies only to the Test build configuration.</span></span> <span data-ttu-id="ad7e3-236">W ramach elementu `PropertyGroup` w konfiguracji kompilacji wydania zostanie wyświetlony element `PublishDatabaseSettings`, który zawiera ustawienia wprowadzone na karcie **pakowanie/publikowanie SQL** . Istnieje element `Object`, który odpowiada każdemu z określonych skryptów grantu (należy zauważyć dwa wystąpienia "Grant. SQL").</span><span class="sxs-lookup"><span data-stu-id="ad7e3-236">Within the `PropertyGroup` element for the Release build configuration, you'll see a `PublishDatabaseSettings` element that contains the settings you entered on the **Package/Publish SQL** tab. There is an `Object` element that corresponds to each of the grant scripts you specified (notice the two instances of "Grant.sql").</span></span> <span data-ttu-id="ad7e3-237">Domyślnie atrybut `Transacted` elementu `Source` dla każdego skryptu przydzielenia jest `False`.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-237">By default, the `Transacted` attribute of the `Source` element for each grant script is `False`.</span></span>

![Transacted_false](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image16.png)

<span data-ttu-id="ad7e3-239">Zmień wartość atrybutu `Transacted` elementu `Source` na `True`.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-239">Change the value of the `Transacted` attribute of the `Source` element to `True`.</span></span>

![Transacted_true](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image17.png)

<span data-ttu-id="ad7e3-241">Zapisz i zamknij plik projektu, a następnie kliknij prawym przyciskiem myszy projekt w **Eksplorator rozwiązań** a następnie wybierz polecenie **Załaduj ponownie projekt**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-241">Save and close the project file, and then right-click the project in **Solution Explorer** and select **Reload Project**.</span></span>

![Reload_project](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image18.png)

## <a name="setting-up-webconfig-transformations-for-the-connection-strings"></a><span data-ttu-id="ad7e3-243">Konfigurowanie transformacji Web. config dla parametrów połączenia</span><span class="sxs-lookup"><span data-stu-id="ad7e3-243">Setting up Web.Config Transformations for the Connection Strings</span></span>

<span data-ttu-id="ad7e3-244">Parametry połączenia dla nowych baz danych SQL Express wprowadzonych na karcie **pakiet/publikowanie SQL** są używane przez Web Deploy tylko do aktualizowania docelowej bazy danych podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-244">The connection strings for the new SQL Express databases that you entered on the **Package/Publish SQL** tab are used by Web Deploy only for updating the destination database during deployment.</span></span> <span data-ttu-id="ad7e3-245">Nadal trzeba skonfigurować przekształcenia *Web. config* , tak aby parametry połączenia we wdrożonym pliku *Web. config* wskazywały nowe bazy danych SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-245">You still have to set up *Web.config* transformations so that the connection strings in the deployed *Web.config* file point to the new SQL Server Express databases.</span></span> <span data-ttu-id="ad7e3-246">(W przypadku używania karty **pakowanie/publikowanie SQL** nie można skonfigurować parametrów połączenia w profilu publikowania).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-246">(When you use the **Package/Publish SQL** tab, you can't configure connection strings in the publish profile.)</span></span>

<span data-ttu-id="ad7e3-247">Otwórz *plik Web. test. config* i Zastąp element `connectionStrings` elementem `connectionStrings` w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-247">Open *Web.Test.config* and replace the `connectionStrings` element with the `connectionStrings` element in the following example.</span></span> <span data-ttu-id="ad7e3-248">(Upewnij się, że kopiujesz tylko element connectionStrings, a nie otaczający kod, który jest wyświetlany w tym miejscu, aby zapewnić kontekst).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-248">(Make sure you only copy the connectionStrings element, not the surrounding code that is shown here to provide context.)</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample4.xml?highlight=2-11)]

<span data-ttu-id="ad7e3-249">Ten kod powoduje, że atrybuty `connectionString` i `providerName` każdego elementu `add` zostaną zastąpione we wdrożonym pliku *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-249">This code causes the `connectionString` and `providerName` attributes of each `add` element to be replaced in the deployed *Web.config* file.</span></span> <span data-ttu-id="ad7e3-250">Te parametry połączenia nie są identyczne z tymi, które zostały wprowadzone w zakładce **pakowanie/publikowanie SQL** . Ustawienie "MultipleActiveResultSets = true" zostało dodane do nich, ponieważ jest wymagane dla Entity Framework i dostawców uniwersalnych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-250">These connection strings are not identical to the ones you entered in the **Package/Publish SQL** tab. The setting "MultipleActiveResultSets=True" has been added to them because it's required for the Entity Framework and the Universal Providers.</span></span>

## <a name="installing-sql-server-compact"></a><span data-ttu-id="ad7e3-251">Instalowanie SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="ad7e3-251">Installing SQL Server Compact</span></span>

<span data-ttu-id="ad7e3-252">Pakiet NuGet SqlServerCompact zapewnia zestawy aparatów bazy danych SQL Server Compact dla aplikacji firmy Contoso University.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-252">The SqlServerCompact NuGet package provides the SQL Server Compact database engine assemblies for the Contoso University application.</span></span> <span data-ttu-id="ad7e3-253">Ale teraz nie jest to aplikacja, ale Web Deploy, która musi mieć możliwość odczytywania SQL Server Compact baz danych, aby można było uruchamiać skrypty w SQL Server bazach danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-253">But now it is not the application but Web Deploy that must be able to read the SQL Server Compact databases, in order to create scripts to run in the SQL Server databases.</span></span> <span data-ttu-id="ad7e3-254">Aby umożliwić Web Deploy odczytywanie SQL Server Compact baz danych, zainstaluj SQL Server Compact na komputerze deweloperskim, używając następującego linku: [Microsoft SQL Server Compact 4,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=15F7C9B3-A150-4AD2-823E-E4E0DCF85DF6).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-254">To enable Web Deploy to read SQL Server Compact databases, install SQL Server Compact on the development computer by using the following link: [Microsoft SQL Server Compact 4.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=15F7C9B3-A150-4AD2-823E-E4E0DCF85DF6).</span></span>

## <a name="deploying-to-the-test-environment"></a><span data-ttu-id="ad7e3-255">Wdrażanie w środowisku testowym</span><span class="sxs-lookup"><span data-stu-id="ad7e3-255">Deploying to the Test Environment</span></span>

<span data-ttu-id="ad7e3-256">Aby można było publikować w środowisku testowym, należy utworzyć profil publikowania skonfigurowany do korzystania z karty **pakiet/publikowanie SQL** na potrzeby publikowania bazy danych zamiast ustawień bazy danych profilu publikowania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-256">In order to publish to the Test environment, you have to create a publish profile that is configured to use the **Package/Publish SQL** tab for database publishing instead of the publish profile database settings.</span></span>

<span data-ttu-id="ad7e3-257">Najpierw usuń istniejący profil testu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-257">First, delete the existing Test profile.</span></span>

<span data-ttu-id="ad7e3-258">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy projekt ContosoUniversity, a następnie kliknij pozycję **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-258">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="ad7e3-259">Wybierz kartę **profil** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-259">Select the **Profile** tab.</span></span>

<span data-ttu-id="ad7e3-260">Kliknij pozycję **Zarządzaj profilami**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-260">Click **Manage Profiles**.</span></span>

<span data-ttu-id="ad7e3-261">Wybierz pozycję **test**, kliknij pozycję **Usuń**, a następnie kliknij przycisk **Zamknij**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-261">Select **Test**, click **Remove**, and then click **Close**.</span></span>

<span data-ttu-id="ad7e3-262">Zamknij kreatora **publikacji w sieci Web** , aby zapisać tę zmianę.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-262">Close the **Publish Web** wizard to save this change.</span></span>

<span data-ttu-id="ad7e3-263">Następnie utwórz nowy profil testu i użyj go do opublikowania projektu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-263">Next, create a new Test profile and use it to publish the project.</span></span>

<span data-ttu-id="ad7e3-264">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy projekt ContosoUniversity, a następnie kliknij pozycję **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-264">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="ad7e3-265">Wybierz kartę **profil** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-265">Select the **Profile** tab.</span></span>

<span data-ttu-id="ad7e3-266">Wybierz pozycję **&lt;nowy...&gt;** z listy rozwijanej, a następnie wprowadź "test" jako nazwę profilu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-266">Select **&lt;New...&gt;** from the drop-down list, and enter "Test" as the profile name.</span></span>

<span data-ttu-id="ad7e3-267">W polu **adres URL usługi** wprowadź wartość *localhost*.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-267">In the **Service URL** box, enter *localhost*.</span></span>

<span data-ttu-id="ad7e3-268">W polu **Witryna/aplikacja** wprowadź *domyślną witrynę sieci Web/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-268">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*.</span></span>

<span data-ttu-id="ad7e3-269">W polu **docelowy adres URL** wprowadź `http://localhost/ContosoUniversity/`.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-269">In the **Destination URL** box, enter `http://localhost/ContosoUniversity/`.</span></span>

<span data-ttu-id="ad7e3-270">Kliknij przycisk **Dalej**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-270">Click **Next**.</span></span>

<span data-ttu-id="ad7e3-271">Na karcie **Ustawienia** zostanie wyświetlone ostrzeżenie, że została skonfigurowana karta **pakowanie/publikowanie SQL** i umożliwia ona przesłonięcie ich przez kliknięcie pozycji Włącz nowe ulepszenia publikowania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-271">The **Settings** tab warns you that the **Package/Publish SQL** tab has been configured, and it gives you an opportunity to override them by clicking enable the new database publishing improvements.</span></span> <span data-ttu-id="ad7e3-272">W przypadku tego wdrożenia nie chcesz przesłonić ustawień na karcie **pakiet/publikacja SQL** , więc kliknij przycisk **dalej**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-272">For this deployment you don't want to override the **Package/Publish SQL** tab settings, so just click **Next**.</span></span>

![Publish_Web_wizard_Settings_tab_Migrate](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image19.png)

<span data-ttu-id="ad7e3-274">Komunikat na karcie **Podgląd** wskazuje, że **nie wybrano żadnych baz danych do opublikowania**, ale oznacza to, że publikowanie bazy danych nie jest skonfigurowane w profilu publikowania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-274">A message on the **Preview** tab indicates that **No databases are selected to publish**, but this only means that database publishing is not configured in the publish profile.</span></span>

<span data-ttu-id="ad7e3-275">Kliknij przycisk **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-275">Click **Publish**.</span></span>

![Publish_Web_wizard_Preview_tab_Migrate](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image20.png)

<span data-ttu-id="ad7e3-277">Program Visual Studio wdroży aplikację i otworzy przeglądarkę na stronie głównej witryny w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-277">Visual Studio deploys the application and opens the browser to the home page of the site in the test environment.</span></span> <span data-ttu-id="ad7e3-278">Uruchom stronę instruktorów, aby zobaczyć, że są wyświetlane te same dane, które zostały wcześniej wyświetlone.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-278">Run the Instructors page to see that it displays the same data that you saw earlier.</span></span> <span data-ttu-id="ad7e3-279">Uruchom stronę **Dodawanie uczniów** , Dodaj nowego ucznia, a następnie Wyświetl nowych uczniów na stronie **uczniów** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-279">Run the **Add Students** page, add a new student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="ad7e3-280">Spowoduje to sprawdzenie, czy można zaktualizować bazę danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-280">This verifies that the you can update the database.</span></span> <span data-ttu-id="ad7e3-281">Wybierz stronę **Aktualizowanie kredytów** (musisz się zalogować), aby sprawdzić, czy baza danych członkostwa została wdrożona i czy masz do niej dostęp.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-281">Select the **Update Credits** page (you'll need to log in) to verify that the membership database was deployed and you have access to it.</span></span>

## <a name="creating-a-sql-server-database-for-the-production-environment"></a><span data-ttu-id="ad7e3-282">Tworzenie bazy danych SQL Server dla środowiska produkcyjnego</span><span class="sxs-lookup"><span data-stu-id="ad7e3-282">Creating a SQL Server Database for the Production Environment</span></span>

<span data-ttu-id="ad7e3-283">Teraz, gdy wdrożono go w środowisku testowym, można przystąpić do konfigurowania wdrożenia do produkcji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-283">Now that you've deployed to the test environment, you're ready to set up deployment to production.</span></span> <span data-ttu-id="ad7e3-284">Począwszy od środowiska testowego, należy utworzyć bazę danych do wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-284">You begin as you did for the test environment, by creating a database to deploy to.</span></span> <span data-ttu-id="ad7e3-285">W miarę odwoływania się z przeglądu plan hostingu Cytanium w języku Lite zezwala tylko na pojedynczą bazę danych SQL Server, więc zostanie skonfigurowana tylko jedna baza danych, a nie dwie.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-285">As you recall from the Overview, the Cytanium Lite hosting plan only allows a single SQL Server database, so you will set up only one database, not two.</span></span> <span data-ttu-id="ad7e3-286">Wszystkie tabele i dane z baz danych SQL Server Compact członkostwa i szkoły zostaną wdrożone w jednej SQL Server bazie danych w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-286">All of the tables and data from the membership and School SQL Server Compact databases will be deployed into one SQL Server database in production.</span></span>

<span data-ttu-id="ad7e3-287">Przejdź do panelu sterowania Cytanium w [http://panel.cytanium.com](http://panel.cytanium.com).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-287">Go to the Cytanium control panel at [http://panel.cytanium.com](http://panel.cytanium.com).</span></span> <span data-ttu-id="ad7e3-288">Przytrzymaj mysz nad **bazami danych** , a następnie kliknij **SQL Server 2008**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-288">Hold the mouse over **Databases** and then click **SQL Server 2008**.</span></span>

<span data-ttu-id="ad7e3-289">[![Selecting_Databases_in_Control_Panel](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image22.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-289">[![Selecting_Databases_in_Control_Panel](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image22.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image21.png)</span></span>

<span data-ttu-id="ad7e3-290">Na stronie **SQL Server 2008** kliknij pozycję **Utwórz bazę danych**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-290">In the **SQL Server 2008** page, click **Create Database**.</span></span>

<span data-ttu-id="ad7e3-291">[![Selecting_Create_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image24.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-291">[![Selecting_Create_Database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image24.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image23.png)</span></span>

<span data-ttu-id="ad7e3-292">Nazwij bazę danych "Szkoła" i kliknij przycisk **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-292">Name the database "School" and click **Save**.</span></span> <span data-ttu-id="ad7e3-293">(Strona automatycznie dodaje prefiks "contosou", więc rzeczywista nazwa to "contosouSchool").</span><span class="sxs-lookup"><span data-stu-id="ad7e3-293">(The page automatically adds the prefix "contosou", so the effective name will be "contosouSchool".)</span></span>

<span data-ttu-id="ad7e3-294">[![Naming_the_database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image26.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-294">[![Naming_the_database](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image26.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image25.png)</span></span>

<span data-ttu-id="ad7e3-295">Na tej samej stronie kliknij pozycję **Utwórz użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-295">On the same page, click **Create User**.</span></span> <span data-ttu-id="ad7e3-296">Na serwerach Cytanium zamiast korzystania ze zintegrowanych zabezpieczeń systemu Windows i umożliwiających tożsamość puli aplikacji otwieranie bazy danych, utworzysz użytkownika, który ma uprawnienia do otwierania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-296">On Cytanium's servers, rather than using integrated Windows security and letting the application pool identity open your database, you'll create a user that has authority to open your database.</span></span> <span data-ttu-id="ad7e3-297">Poświadczenia użytkownika zostaną dodane do parametrów połączenia, które przechodzą w produkcyjny plik *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-297">You'll add the user's credentials to the connection strings that go in the production *Web.config* file.</span></span> <span data-ttu-id="ad7e3-298">W tym kroku utworzysz te poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-298">In this step you create those credentials.</span></span>

<span data-ttu-id="ad7e3-299">[![Creating_a_database_user](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image28.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-299">[![Creating_a_database_user](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image28.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image27.png)</span></span>

<span data-ttu-id="ad7e3-300">Wypełnij pola wymagane na stronie **właściwości użytkownika SQL** :</span><span class="sxs-lookup"><span data-stu-id="ad7e3-300">Fill in the required fields in the **SQL User Properties** page:</span></span>

- <span data-ttu-id="ad7e3-301">Wprowadź wartość "ContosoUniversityUser" jako nazwę.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-301">Enter "ContosoUniversityUser" as the name.</span></span>
- <span data-ttu-id="ad7e3-302">Wprowadź hasło.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-302">Enter a password.</span></span>
- <span data-ttu-id="ad7e3-303">Wybierz **contosouSchool** jako domyślną bazę danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-303">Select **contosouSchool** as the default database.</span></span>
- <span data-ttu-id="ad7e3-304">Zaznacz pole wyboru **contosouSchool** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-304">Select the **contosouSchool** check box.</span></span>

<span data-ttu-id="ad7e3-305">[![SQL_User_Properties_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image30.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-305">[![SQL_User_Properties_page](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image30.png)](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image29.png)</span></span>

## <a name="configuring-database-deployment-for-the-production-environment"></a><span data-ttu-id="ad7e3-306">Konfigurowanie wdrażania bazy danych dla środowiska produkcyjnego</span><span class="sxs-lookup"><span data-stu-id="ad7e3-306">Configuring Database Deployment for the Production Environment</span></span>

<span data-ttu-id="ad7e3-307">Teraz możesz przystąpić do konfigurowania ustawień wdrażania bazy danych na karcie **pakowanie/publikowanie SQL** , tak jak wcześniej dla środowiska testowego.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-307">Now you're ready to set up database deployment settings in the **Package/Publish SQL** tab, as you did earlier for the test environment.</span></span>

<span data-ttu-id="ad7e3-308">Otwórz okno **właściwości projektu** , wybierz kartę **pakowanie/publikowanie SQL** i upewnij się, że na liście rozwijanej **Konfiguracja** wybrano pozycję **Active (wersja)** lub **Zwolnij** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-308">Open the **Project Properties** window, select the **Package/Publish SQL** tab, and make sure that **Active (Release)** or **Release** is selected in the **Configuration** drop-down list.</span></span>

<span data-ttu-id="ad7e3-309">W przypadku konfigurowania ustawień wdrożenia dla każdej bazy danych, kluczową różnicą między działaniem w środowisku produkcyjnym i testowym jest konfiguracja parametrów połączenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-309">When you configure deployment settings for each database, the key difference between what you do for production and test environments is in how you configure connection strings.</span></span> <span data-ttu-id="ad7e3-310">Dla środowiska testowego wprowadzono różne parametry połączenia z bazą danych docelowych, ale dla środowiska produkcyjnego parametry połączenia docelowego będą takie same dla obu baz danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-310">For the test environment you entered different destination database connection strings, but for the production environment the destination connection string will be the same for both databases.</span></span> <span data-ttu-id="ad7e3-311">Wynika to z faktu, że wdrażasz obie bazy danych w jednej bazie danych w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-311">This is because you are deploying both databases to one database in production.</span></span>

### <a name="configuring-deployment-settings-for-the-membership-database"></a><span data-ttu-id="ad7e3-312">Konfigurowanie ustawień wdrożenia dla bazy danych członkostwa</span><span class="sxs-lookup"><span data-stu-id="ad7e3-312">Configuring Deployment Settings for the Membership Database</span></span>

<span data-ttu-id="ad7e3-313">Aby skonfigurować ustawienia, które mają zastosowanie do bazy danych członkostwa, wybierz wiersz **DefaultConnection-Deployment** w tabeli **wpisy bazy danych** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-313">To configure settings that apply to the membership database, select the **DefaultConnection-Deployment** row in the **Database Entries** table.</span></span>

<span data-ttu-id="ad7e3-314">W polu **Parametry połączenia dla docelowej bazy danych**wprowadź parametry połączenia wskazujące nową utworzoną SQL Server produkcyjnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-314">In **Connection string for destination database**, enter a connection string that points to the new production SQL Server database that you just created.</span></span> <span data-ttu-id="ad7e3-315">Parametry połączenia można uzyskać z powitalnej wiadomości e-mail.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-315">You can get the connection string from your welcome email.</span></span> <span data-ttu-id="ad7e3-316">Odpowiednia część wiadomości e-mail zawiera następujące przykładowe parametry połączenia:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-316">The relevant part of the email contains the following sample connection string:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample5.cmd)]

<span data-ttu-id="ad7e3-317">Po zamianie trzech zmiennych, potrzebne parametry połączenia wyglądają następująco:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-317">After you replace the three variables, the connection string you need looks like this example:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample6.cmd)]

<span data-ttu-id="ad7e3-318">Skopiuj i wklej te parametry połączenia do **parametrów połączenia dla docelowej bazy danych** na karcie **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-318">Copy and paste this connection string into **Connection string for destination database** in the **Package/Publish SQL** tab.</span></span>

<span data-ttu-id="ad7e3-319">Upewnij się, że **dane ściągania i/lub schemat z istniejącej bazy danych** są nadal zaznaczone, a **Opcje skryptów bazy danych** nadal są **schematem i danymi**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-319">Make sure that **Pull data and/or schema from an existing database** is still selected, and that **Database scripting options** is still **Schema and Data**.</span></span>

<span data-ttu-id="ad7e3-320">W polu **skrypty bazy danych** wyczyść pole wyboru obok skryptu Grant. SQL.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-320">In the **Database Scripts** box, clear the check box next to the Grant.sql script.</span></span>

![Disable_Grant_script](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/_static/image31.png)

### <a name="configuring-deployment-settings-for-the-school-database"></a><span data-ttu-id="ad7e3-322">Konfigurowanie ustawień wdrożenia dla bazy danych szkoły</span><span class="sxs-lookup"><span data-stu-id="ad7e3-322">Configuring Deployment Settings for the School Database</span></span>

<span data-ttu-id="ad7e3-323">Następnie wybierz wiersz **SchoolContext-Deployment** w tabeli **wpisy bazy danych** w celu skonfigurowania ustawień bazy danych szkoły.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-323">Next, select the **SchoolContext-Deployment** row in the **Database Entries** table in order to configure the School database settings.</span></span>

<span data-ttu-id="ad7e3-324">Skopiuj te same parametry połączenia do **parametrów połączenia dla docelowej bazy danych** , która została skopiowana do tego pola dla bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-324">Copy the same connection string into **Connection string for destination database** that you copied into that field for the membership database.</span></span>

<span data-ttu-id="ad7e3-325">Upewnij się, że **dane ściągania i/lub schemat z istniejącej bazy danych** są nadal zaznaczone, a **Opcje skryptów bazy danych** nadal są **schematem i danymi**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-325">Make sure that **Pull data and/or schema from an existing database** is still selected, and that **Database scripting options** is still **Schema and Data**.</span></span>

<span data-ttu-id="ad7e3-326">W polu **skrypty bazy danych** wyczyść pole wyboru obok skryptu Grant. SQL.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-326">In the **Database Scripts** box, clear the check box next to the Grant.sql script.</span></span>

<span data-ttu-id="ad7e3-327">Zapisz zmiany na karcie **pakowanie/publikowanie SQL** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-327">Save the changes to the **Package/Publish SQL** tab.</span></span>

## <a name="setting-up-webconfig-transforms-for-the-connection-strings-to-production-databases"></a><span data-ttu-id="ad7e3-328">Konfigurowanie transformacji Web. config dla parametrów połączenia do produkcyjnych baz danych</span><span class="sxs-lookup"><span data-stu-id="ad7e3-328">Setting Up Web.Config Transforms for the Connection Strings to Production Databases</span></span>

<span data-ttu-id="ad7e3-329">Następnie skonfigurujesz przekształcenia *Web. config* , tak aby parametry połączenia we wdrożonym pliku *Web. config* wskazywały nową produkcyjną bazę danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-329">Next, you'll set up *Web.config* transformations so that the connection strings in the deployed *Web.config* file to point to the new production database.</span></span> <span data-ttu-id="ad7e3-330">Parametry połączenia wprowadzone na karcie **pakiet/Publikuj SQL** na potrzeby Web Deploy są takie same, jak w przypadku tej aplikacji, z wyjątkiem dodania opcji `MultipleResultSets`.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-330">The connection string that you entered on the **Package/Publish SQL** tab for Web Deploy to use is the same as the one the application needs to use, except for the addition of the `MultipleResultSets` option.</span></span>

<span data-ttu-id="ad7e3-331">Otwórz *plik Web. Product. config* i Zastąp element `connectionStrings` elementem `connectionStrings`, który wygląda podobnie do poniższego przykładu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-331">Open *Web.Production.config* and replace the `connectionStrings` element with a `connectionStrings` element that looks like the following example.</span></span> <span data-ttu-id="ad7e3-332">(Skopiuj tylko `connectionStrings` element, a nie otaczające znaczniki, które są podane w celu wyświetlenia kontekstu).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-332">(Only copy the `connectionStrings` element, not the surrounding tags that are provided to show the context.)</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample7.xml?highlight=2-11)]

<span data-ttu-id="ad7e3-333">Czasami widzisz porady z informacją, że należy zawsze szyfrować parametry połączenia w pliku *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-333">You sometimes see advice that tells you to always encrypt connection strings in the *Web.config* file.</span></span> <span data-ttu-id="ad7e3-334">Może to być odpowiednie w przypadku wdrożenia na serwerach w sieci firmowej.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-334">This might be appropriate if you were deploying to servers on your own company's network.</span></span> <span data-ttu-id="ad7e3-335">W przypadku wdrażania w udostępnionym środowisku hostingu, chociaż użytkownik ufa praktykom dotyczącym zabezpieczeń dostawcy hostingu i nie jest konieczne ani praktyczne do szyfrowania parametrów połączenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-335">When you are deploying to a shared hosting environment, though, you're trusting the security practices of the hosting provider, and it's not necessary or practical to encrypt the connection strings.</span></span>

## <a name="deploying-to-the-production-environment"></a><span data-ttu-id="ad7e3-336">Wdrażanie w środowisku produkcyjnym</span><span class="sxs-lookup"><span data-stu-id="ad7e3-336">Deploying to the Production Environment</span></span>

<span data-ttu-id="ad7e3-337">Teraz wszystko jest gotowe do wdrożenia w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-337">Now you're ready to deploy to production.</span></span> <span data-ttu-id="ad7e3-338">Web Deploy odczyta SQL Server Compact bazy danych w aplikacji projektu\_folderze *danych* i ponownie utworzysz wszystkie tabele i dane w produkcyjnej SQL Server bazie danych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-338">Web Deploy will read the SQL Server Compact databases in your project's *App\_Data* folder and re-create all of their tables and data in the production SQL Server database.</span></span> <span data-ttu-id="ad7e3-339">Aby można było opublikować program przy użyciu ustawień karty **sieci Web pakowanie/publikowanie** , należy utworzyć nowy profil publikowania dla środowiska produkcyjnego.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-339">In order to publish by using the **Package/Publish Web** tab settings, you have to create a new publish profile for production.</span></span>

<span data-ttu-id="ad7e3-340">Najpierw usuń istniejący profil produkcyjny zgodnie z wcześniejszym profilem testowym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-340">First, delete the existing Production profile as you did the Test profile earlier.</span></span>

<span data-ttu-id="ad7e3-341">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy projekt ContosoUniversity, a następnie kliknij pozycję **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-341">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="ad7e3-342">Wybierz kartę **profil** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-342">Select the **Profile** tab.</span></span>

<span data-ttu-id="ad7e3-343">Kliknij pozycję **Zarządzaj profilami**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-343">Click **Manage Profiles**.</span></span>

<span data-ttu-id="ad7e3-344">Wybierz pozycję **produkcja**, kliknij pozycję **Usuń**, a następnie kliknij przycisk **Zamknij**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-344">Select **Production**, click **Remove**, and then click **Close**.</span></span>

<span data-ttu-id="ad7e3-345">Zamknij kreatora **publikacji w sieci Web** , aby zapisać tę zmianę.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-345">Close the **Publish Web** wizard to save this change.</span></span>

<span data-ttu-id="ad7e3-346">Następnie utwórz nowy profil produkcyjny i użyj go do opublikowania projektu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-346">Next, create a new Production profile and use it to publish the project.</span></span>

<span data-ttu-id="ad7e3-347">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy projekt ContosoUniversity, a następnie kliknij pozycję **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-347">In **Solution Explorer**, right-click the ContosoUniversity project, and click **Publish**.</span></span>

<span data-ttu-id="ad7e3-348">Wybierz kartę **profil** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-348">Select the **Profile** tab.</span></span>

<span data-ttu-id="ad7e3-349">Kliknij przycisk **Importuj**, a następnie wybierz pobrany wcześniej plik. publishsettings.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-349">Click **Import**, and select the .publishsettings file that you downloaded earlier.</span></span>

<span data-ttu-id="ad7e3-350">Na karcie **połączenie** Zmień **docelowy adres URL** na prawidłowy tymczasowy adres URL, który w tym przykładzie jest http://contosouniversity.com.vserver01.cytanium.com.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-350">On the **Connection** tab, change the **Destination URL** to the correct temporary URL, which in this example is http://contosouniversity.com.vserver01.cytanium.com.</span></span>

<span data-ttu-id="ad7e3-351">Zmień nazwę profilu na produkcyjny.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-351">Rename the profile to Production.</span></span> <span data-ttu-id="ad7e3-352">(Wybierz kartę **profil** , a następnie kliknij pozycję **Zarządzaj profilami** , aby to zrobić).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-352">(Select the **Profile** tab and click **Manage Profiles** to do that).</span></span>

<span data-ttu-id="ad7e3-353">Zamknij kreatora **publikacji w sieci Web** , aby zapisać zmiany.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-353">Close the **Publish Web** wizard to save your changes.</span></span>

<span data-ttu-id="ad7e3-354">W prawdziwej aplikacji, w której baza danych była aktualizowana w środowisku produkcyjnym, przed opublikowaniem należy wykonać dwa dodatkowe kroki:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-354">In a real application in which the database was being updated in production, you would do two additional steps now before you publish:</span></span>

1. <span data-ttu-id="ad7e3-355">Przekaż *aplikację\_offline. htm*, jak pokazano w samouczku [wdrażanie do środowiska produkcyjnego](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-355">Upload *app\_offline.htm*, as shown in the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial.</span></span>
2. <span data-ttu-id="ad7e3-356">Użyj funkcji **Menedżer plików** w panelu sterowania Cytanium, aby skopiować pliki *ASPNET-prod. sdf* i *School-prod. sdf* z lokacji produkcyjnej do folderu *danych\_aplikacji* w projekcie ContosoUniversity.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-356">Use the **File Manager** feature of the Cytanium control panel to copy the *aspnet-Prod.sdf* and *School-Prod.sdf* files from the production site to the *App\_Data* folder of the ContosoUniversity project.</span></span> <span data-ttu-id="ad7e3-357">Dzięki temu dane wdrażane do nowej bazy danych SQL Server zawierają najnowsze aktualizacje wprowadzone przez produkcyjną witrynę sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-357">This ensures that the data you're deploying to the new SQL Server database includes the latest updates made by your production website.</span></span>

<span data-ttu-id="ad7e3-358">Na pasku narzędzi **kliknij przycisk Publikuj w sieci Web** , upewnij się, że wybrano pozycję Profil **produkcyjny** , a następnie kliknij pozycję **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-358">In the **Web One Click Publish** toolbar, make sure that the **Production** profile is selected, and then click **Publish**.</span></span>

<span data-ttu-id="ad7e3-359">Jeśli aplikacja została przekazana <em>\_offline. htm</em> przed opublikowaniem, musisz użyć narzędzia <strong>Menedżer plików</strong> w panelu sterowania Cytanium, aby usunąć <em>aplikację\_offline.</em> htm przed przetestem.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-359">If you uploaded <em>app\_offline.htm</em> before publishing, you have to use the <strong>File Manager</strong> utility in the Cytanium control panel to delete <em>app\_offline.</em>htm before you test.</span></span> <span data-ttu-id="ad7e3-360">Możesz również w tym samym czasie usunąć pliki <em>. sdf</em> z folderu <em>danych\_aplikacji</em> .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-360">You can also at the same time delete the <em>.sdf</em> files from the <em>App\_Data</em> folder.</span></span>

<span data-ttu-id="ad7e3-361">Teraz możesz otworzyć przeglądarkę i przejść do adresu URL witryny publicznej w celu przetestowania aplikacji w taki sam sposób, jak po wdrożeniu w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-361">You can now open a browser and go to the URL of your public site to test the application the same way you did after deploying to the test environment.</span></span>

## <a name="switching-to-sql-server-express-localdb-in-development"></a><span data-ttu-id="ad7e3-362">Przełączanie do SQL Server Express LocalDB w trakcie opracowywania</span><span class="sxs-lookup"><span data-stu-id="ad7e3-362">Switching to SQL Server Express LocalDB in Development</span></span>

<span data-ttu-id="ad7e3-363">Jak wyjaśniono w przeglądzie, najlepszym rozwiązaniem jest użycie tego samego aparatu bazy danych w środowisku programistycznym, który jest używany w testach i produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-363">As was explained in the Overview, it's generally best to use the same database engine in development that you use in test and production.</span></span> <span data-ttu-id="ad7e3-364">(Należy pamiętać, że zalety korzystania z SQL Server Express podczas opracowywania polega na tym, że baza danych będzie działała tak samo w środowiskach programistycznych, testowych i produkcyjnych). W tej sekcji skonfigurujesz projekt ContosoUniversity do użycia SQL Server Express LocalDB podczas uruchamiania aplikacji z programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-364">(Remember that the advantage to using SQL Server Express in development is that the database will work the same in your development, test, and production environments.) In this section you'll set up the ContosoUniversity project to use SQL Server Express LocalDB when you run the application from Visual Studio.</span></span>

<span data-ttu-id="ad7e3-365">Najprostszym sposobem przeprowadzenia migracji jest umożliwienie Code First i systemu członkostwa w tworzeniu nowych baz danych programistycznych.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-365">The simplest way to perform this migration is to let Code First and the membership system create both new development databases for you.</span></span> <span data-ttu-id="ad7e3-366">Zastosowanie tej metody do migracji wymaga wykonania trzech kroków:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-366">Using this method to migrate requires three steps:</span></span>

1. <span data-ttu-id="ad7e3-367">Zmień parametry połączenia, aby określić nowe bazy danych SQL Express LocalDB.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-367">Change the connection strings to specify new SQL Express LocalDB databases.</span></span>
2. <span data-ttu-id="ad7e3-368">Uruchom narzędzie do administrowania witryną sieci Web, aby utworzyć użytkownika administratora.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-368">Run the Web Site Administration Tool to create an administrator user.</span></span> <span data-ttu-id="ad7e3-369">Spowoduje to utworzenie bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-369">This creates the membership database.</span></span>
3. <span data-ttu-id="ad7e3-370">Za pomocą polecenia Migracje Code First Update-Database Utwórz i wypełnianie bazy danych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-370">Use the Code First Migrations update-database command to create and seed the application database.</span></span>

### <a name="updating-connection-strings-in-the-webconfig-file"></a><span data-ttu-id="ad7e3-371">Aktualizowanie parametrów połączenia w pliku Web. config</span><span class="sxs-lookup"><span data-stu-id="ad7e3-371">Updating Connection Strings in the Web.config file</span></span>

<span data-ttu-id="ad7e3-372">Otwórz plik *Web. config* i zastąp `connectionStrings` element następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-372">Open the *Web.config* file and replace the `connectionStrings` element with the following code:</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample8.xml)]

### <a name="creating-the-membership-database"></a><span data-ttu-id="ad7e3-373">Tworzenie bazy danych członkostwa</span><span class="sxs-lookup"><span data-stu-id="ad7e3-373">Creating the Membership Database</span></span>

<span data-ttu-id="ad7e3-374">W **Eksplorator rozwiązań**wybierz projekt ContosoUniversity, a następnie kliknij pozycję **Konfiguracja ASP.NET** w menu **projekt** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-374">In **Solution Explorer**, select the ContosoUniversity project, and then click **ASP.NET Configuration** in the **Project** menu.</span></span>

<span data-ttu-id="ad7e3-375">Wybierz kartę Zabezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-375">Select the Security tab.</span></span>

<span data-ttu-id="ad7e3-376">Kliknij przycisk **Utwórz role lub zarządzaj nimi**, a następnie Utwórz rolę **administratora** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-376">Click **Create or Manage Roles**, and then create an **Administrator** role.</span></span>

<span data-ttu-id="ad7e3-377">Wróć do karty zabezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-377">Return to the Security tab.</span></span>

<span data-ttu-id="ad7e3-378">Kliknij przycisk **Utwórz użytkownika**, a następnie zaznacz pole wyboru **administrator** i Utwórz użytkownika o nazwie admin.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-378">Click **Create user**, and then select the **Administrator** check box and create a user named admin.</span></span>

<span data-ttu-id="ad7e3-379">Zamknij **Narzędzie do administrowania witryną sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-379">Close the **Web Site Administration Tool**.</span></span>

### <a name="creating-the-school-database"></a><span data-ttu-id="ad7e3-380">Tworzenie bazy danych szkoły</span><span class="sxs-lookup"><span data-stu-id="ad7e3-380">Creating the School Database</span></span>

<span data-ttu-id="ad7e3-381">Otwórz okno konsoli Menedżera pakietów.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-381">Open the Package Manager Console window.</span></span>

<span data-ttu-id="ad7e3-382">Z listy rozwijanej **Projekt domyślny** wybierz projekt CONTOSOUNIVERSITY. dal.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-382">In the **Default project** drop-down list, select the ContosoUniversity.DAL project.</span></span>

<span data-ttu-id="ad7e3-383">Wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="ad7e3-383">Enter the following command:</span></span>

[!code-powershell[Main](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12/samples/sample9.ps1)]

<span data-ttu-id="ad7e3-384">Migracje Code First stosuje migrację początkową, która tworzy bazę danych, a następnie stosuje migrację DataUrodzenia, a następnie uruchamia metodę inicjatora.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-384">Code First Migrations applies the Initial migration that creates the database and then applies the AddBirthDate migration, then it runs the Seed method.</span></span>

<span data-ttu-id="ad7e3-385">Uruchom witrynę, naciskając klawisz CONTROL-F5.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-385">Run the site by pressing Control-F5.</span></span> <span data-ttu-id="ad7e3-386">Tak jak w przypadku środowisk testowych i produkcyjnych, Uruchom stronę **Dodawanie uczniów** , Dodaj nowego ucznia, a następnie Wyświetl nowych uczniów na stronie **uczniów** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-386">As you did for the test and production environments, run the **Add Students** page, add a new student, and then view the new student in the **Students** page.</span></span> <span data-ttu-id="ad7e3-387">Umożliwia to sprawdzenie, czy baza danych szkoły została utworzona i zainicjowana oraz że masz do niej dostęp do odczytu i zapisu.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-387">This verifies that the School database was created and initialized and that you have read and write access to it.</span></span>

<span data-ttu-id="ad7e3-388">Wybierz stronę **Aktualizuj kredyty** i zaloguj się, aby sprawdzić, czy baza danych członkostwa została wdrożona i czy masz do niej dostęp.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-388">Select the **Update Credits** page and log in to verify that the membership database was deployed and that you have access to it.</span></span> <span data-ttu-id="ad7e3-389">Jeśli nie przeprowadzisz migracji kont użytkowników, Utwórz konto administratora, a następnie wybierz stronę **Aktualizuj kredyty** , aby sprawdzić, czy działa.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-389">If you did not migrate your user accounts, create an administrator account and then select the **Update Credits** page to verify that it works.</span></span>

## <a name="cleaning-up-sql-server-compact-files"></a><span data-ttu-id="ad7e3-390">Czyszczenie SQL Server Compact plików</span><span class="sxs-lookup"><span data-stu-id="ad7e3-390">Cleaning Up SQL Server Compact Files</span></span>

<span data-ttu-id="ad7e3-391">Nie są już potrzebne pliki i pakiety NuGet dołączone do obsługi SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-391">You no longer need files and NuGet packages that were included to support SQL Server Compact.</span></span> <span data-ttu-id="ad7e3-392">Jeśli chcesz (ten krok nie jest wymagany), możesz wyczyścić niepotrzebne pliki i odwołania.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-392">If you want (this step is not required), you can clean up unneeded files and references.</span></span>

<span data-ttu-id="ad7e3-393">W **Eksplorator rozwiązań**Usuń pliki *. sdf* z folderu *\_aplikacji* i *amd64* i *x86* z folderu *bin* .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-393">In **Solution Explorer**, delete the *.sdf* files from the *App\_Data* folder and the *amd64* and *x86* folders from the *bin* folder.</span></span>

<span data-ttu-id="ad7e3-394">W **Eksplorator rozwiązań**kliknij prawym przyciskiem myszy Rozwiązanie (nie jeden z projektów), a następnie kliknij pozycję **Zarządzaj pakietami NuGet dla rozwiązania**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-394">In **Solution Explorer**, right-click the solution (not one of the projects), and then click **Manage NuGet Packages for Solution**.</span></span>

<span data-ttu-id="ad7e3-395">W lewym okienku okna dialogowego **Zarządzanie pakietami NuGet** wybierz pozycję **zainstalowane pakiety**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-395">In the left pane of the **Manage NuGet Packages** dialog box, select **Installed packages**.</span></span>

<span data-ttu-id="ad7e3-396">Wybierz pakiet **EntityFramework. SqlServerCompact** , a następnie kliknij pozycję **Zarządzaj**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-396">Select the **EntityFramework.SqlServerCompact** package and click **Manage**.</span></span>

<span data-ttu-id="ad7e3-397">W oknie dialogowym **Wybierz projekty** są wybrane oba projekty.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-397">In the **Select Projects** dialog box, both projects are selected.</span></span> <span data-ttu-id="ad7e3-398">Aby odinstalować pakiet w obu projektach, wyczyść oba pola wyboru, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-398">To uninstall the package in both projects, clear both check boxes, then click **OK**.</span></span>

<span data-ttu-id="ad7e3-399">W oknie dialogowym z pytaniem, czy chcesz odinstalować pakiety zależne, kliknij przycisk nie.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-399">In the dialog box that asks if you want to uninstall the dependent packages also, click No.</span></span> <span data-ttu-id="ad7e3-400">Jeden z nich to pakiet Entity Framework, który należy zachować.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-400">One of these is the Entity Framework package that you have to keep.</span></span>

<span data-ttu-id="ad7e3-401">Postępuj zgodnie z tą samą procedurą, aby odinstalować pakiet **SqlServerCompact** .</span><span class="sxs-lookup"><span data-stu-id="ad7e3-401">Follow the same procedure to uninstall the **SqlServerCompact** package.</span></span> <span data-ttu-id="ad7e3-402">(Pakiety muszą zostać odinstalowane w tej kolejności, ponieważ pakiet **EntityFramework. SqlServerCompact** zależy od pakietu **SqlServerCompact** ).</span><span class="sxs-lookup"><span data-stu-id="ad7e3-402">(The packages must be uninstalled in this order because the **EntityFramework.SqlServerCompact** package depends on the **SqlServerCompact** package.)</span></span>

<span data-ttu-id="ad7e3-403">Pomyślnie wykonano migrację do SQL Server Express i pełnych SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-403">You have now successfully migrated to SQL Server Express and full SQL Server.</span></span> <span data-ttu-id="ad7e3-404">W następnym samouczku wprowadzisz inną zmianę bazy danych i zobaczysz, jak wdrożyć zmiany w bazie danych, gdy bazy danych testowych i produkcyjnych używają SQL Server Express i pełnych SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ad7e3-404">In the next tutorial you'll make another database change, and you'll see how to deploy database changes when your test and production databases use SQL Server Express and full SQL Server.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ad7e3-405">[Poprzednie](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12.md)
> [dalej](deployment-to-a-hosting-provider-deploying-a-sql-server-database-update-11-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="ad7e3-405">[Previous](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12.md)
[Next](deployment-to-a-hosting-provider-deploying-a-sql-server-database-update-11-of-12.md)</span></span>
