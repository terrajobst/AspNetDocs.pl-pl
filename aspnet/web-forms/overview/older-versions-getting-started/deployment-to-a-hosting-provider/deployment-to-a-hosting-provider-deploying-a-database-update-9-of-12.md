---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12
title: 'Wdrażanie aplikacji sieci Web ASP.NET za pomocą programu SQL Server Compact przy użyciu programu Visual Studio lub Visual Web Developer: Wdrażanie aktualizacji bazy danych — 9 12 | Dokumentacja firmy Microsoft'
author: tdykstra
description: W tej serii samouczków dowiesz się, jak wdrożyć (opublikować) programu ASP.NET projektu aplikacji sieci web, który zawiera bazę danych programu SQL Server Compact przy użyciu Visual Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: a8d776af-4735-4612-87f6-9f326587f2d3
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12
msc.type: authoredcontent
ms.openlocfilehash: 045e1076183cc46e935df40120d0377108cbed61
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/25/2019
ms.locfileid: "58422154"
---
<a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-deploying-a-database-update---9-of-12"></a><span data-ttu-id="fdc6e-103">Wdrażanie aplikacji sieci Web ASP.NET za pomocą programu SQL Server Compact przy użyciu programu Visual Studio lub Visual Web Developer: Wdrażanie aktualizacji bazy danych — 9 12</span><span class="sxs-lookup"><span data-stu-id="fdc6e-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Deploying a Database Update - 9 of 12</span></span>
====================
<span data-ttu-id="fdc6e-104">przez [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="fdc6e-105">Pobieranie projektu startowego</span><span class="sxs-lookup"><span data-stu-id="fdc6e-105">Download Starter Project</span></span>](http://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="fdc6e-106">W tej serii samouczków dowiesz się, jak wdrożyć (opublikować) ASP.NET projektu aplikacji sieci web, która zawiera bazę danych programu SQL Server Compact przy użyciu programu Visual Studio 2012 RC lub Visual Studio Express 2012 RC for Web.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="fdc6e-107">Umożliwia także programu Visual Studio 2010 po zainstalowaniu aktualizacji publikowania w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="fdc6e-108">Aby zapoznać się z wprowadzeniem do serii, zobacz [pierwszym samouczku tej serii](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="fdc6e-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="fdc6e-109">Aby uzyskać samouczek, który zawiera funkcje wdrażania wprowadzone po wersji RC programu Visual Studio 2012, pokazuje, jak wdrażać wersje programu SQL Server, innym niż SQL Server Compact i pokazuje, jak wdrożyć w usłudze Azure App Service Web Apps, zobacz [wdrażanie aplikacji internetowych ASP.NET za pomocą programu Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="fdc6e-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="fdc6e-110">Omówienie</span><span class="sxs-lookup"><span data-stu-id="fdc6e-110">Overview</span></span>

<span data-ttu-id="fdc6e-111">W tym samouczku, wprowadzić zmianę w bazie danych i zmian kodu powiązanego przetestować zmiany w programie Visual Studio, a następnie wdrożyć aktualizację na środowisk testowych i produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-111">In this tutorial, you make a database change and related code changes, test the changes in Visual Studio, then deploy the update to both the test and production environments.</span></span>

<span data-ttu-id="fdc6e-112">Przypomnienie: Jeśli otrzymasz komunikat o błędzie lub coś nie działa podczas wykonywania kroków samouczka, należy koniecznie sprawdzić [strona rozwiązywania problemów](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="fdc6e-112">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="adding-a-new-column-to-a-table"></a><span data-ttu-id="fdc6e-113">Dodawanie nowej kolumny do tabeli</span><span class="sxs-lookup"><span data-stu-id="fdc6e-113">Adding a New Column to a Table</span></span>

<span data-ttu-id="fdc6e-114">W tej sekcji Dodaj kolumnę daty urodzenia `Person` klasa podstawowa dla `Student` i `Instructor` jednostek.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-114">In this section, you add a birth date column to the `Person` base class for the `Student` and `Instructor` entities.</span></span> <span data-ttu-id="fdc6e-115">Następnie należy zaktualizować Strona która wyświetla dane przez instruktorów, tak, aby wyświetlał nowej kolumny.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-115">Then you update the page that displays instructor data so that it displays the new column.</span></span>

<span data-ttu-id="fdc6e-116">W *ContosoUniversity.DAL* otwarty projekt *osoba.cs* i dodaj następującą właściwość na końcu `Person` klasy (powinny istnieć dwie zamykający nawias klamrowy następujący):</span><span class="sxs-lookup"><span data-stu-id="fdc6e-116">In the *ContosoUniversity.DAL* project, open *Person.cs* and add the following property at the end of the `Person` class (there should be two closing curly braces following it):</span></span>

[!code-csharp[Main](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/samples/sample1.cs)]

<span data-ttu-id="fdc6e-117">Następnie zaktualizuj Seed — metoda, dzięki czemu zapewnia wartości dla nowej kolumny.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-117">Next, update the Seed method so that it provides a value for the new column.</span></span> <span data-ttu-id="fdc6e-118">Otwórz *Migrations\Configuration.cs* i Zastąp blok kodu, który rozpoczyna się `var instructors = new List<Instructor>` z poniższy blok kodu, który zawiera informacje o dacie urodzenia:</span><span class="sxs-lookup"><span data-stu-id="fdc6e-118">Open *Migrations\Configuration.cs* and replace the code block that begins `var instructors = new List<Instructor>` with the following code block which includes birth date information:</span></span>

[!code-csharp[Main](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/samples/sample2.cs)]

<span data-ttu-id="fdc6e-119">W projekcie ContosoUniversity Otwórz *Instructors.aspx* i dodać nowe pole do szablonu, aby wyświetlić datę urodzenia.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-119">In the ContosoUniversity project, open *Instructors.aspx* and add a new template field to display the birth date.</span></span> <span data-ttu-id="fdc6e-120">Dodać go między tymi zatrudnienia przypisania daty i pakietu office:</span><span class="sxs-lookup"><span data-stu-id="fdc6e-120">Add it between the ones for hire date and office assignment:</span></span>

[!code-aspx[Main](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/samples/sample3.aspx)]

<span data-ttu-id="fdc6e-121">(Jeśli wcięcia kodu o szerokość jest niezsynchronizowana, można nacisnąć klawisze CTRL-K, a następnie CTRL-D do automatycznego ponownego sformatowania pliku.)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-121">(If code indentation gets out of sync, you can press CTRL-K and then CTRL-D to automatically reformat the file.)</span></span>

<span data-ttu-id="fdc6e-122">Skompiluj rozwiązanie, a następnie otwórz **Konsola Menedżera pakietów** okna.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-122">Build the solution, and then open the **Package Manager Console** window.</span></span> <span data-ttu-id="fdc6e-123">Upewnij się, że ContosoUniversity.DAL jest nadal wybrany jako **projekt domyślny**.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-123">Make sure that ContosoUniversity.DAL is still selected as the **Default project**.</span></span>

<span data-ttu-id="fdc6e-124">W **Konsola Menedżera pakietów** wybierz **ContosoUniversity.DAL** jako **projekt domyślny**, a następnie wprowadź następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="fdc6e-124">In the **Package Manager Console** window, select **ContosoUniversity.DAL** as the **Default project**, and then enter the following command:</span></span>

[!code-powershell[Main](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/samples/sample4.ps1)]

<span data-ttu-id="fdc6e-125">Po zakończeniu tego polecenia, programu Visual Studio otwiera plik klasy, który definiuje nowy `DbMigration` klasy, a następnie w `Up` metody zostanie wyświetlony kod, który tworzy nową kolumnę.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-125">When this command finishes, Visual Studio opens the class file that defines the new `DbMigration` class, and in the `Up` method you can see the code that creates the new column.</span></span>

![AddBirthDate_migration_code](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image1.png)

<span data-ttu-id="fdc6e-127">Skompiluj rozwiązanie, a następnie wprowadź następujące polecenie w **Konsola Menedżera pakietów** okna (Upewnij się, projekt ContosoUniversity.DAL została ona zaznaczona):</span><span class="sxs-lookup"><span data-stu-id="fdc6e-127">Build the solution, and then enter the following command in the **Package Manager Console** window (make sure the ContosoUniversity.DAL project is still selected):</span></span>

[!code-powershell[Main](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/samples/sample5.ps1)]

<span data-ttu-id="fdc6e-128">Po zakończeniu wykonywania polecenia Uruchom aplikację, a następnie wybierz stronę instruktorów.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-128">When the command finishes, run the application and select the Instructors page.</span></span> <span data-ttu-id="fdc6e-129">Po załadowaniu strony zobaczysz, że ma nowe pole daty urodzenia.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-129">When the page loads, you see that it has the new birth date field.</span></span>

<span data-ttu-id="fdc6e-130">[![Instructors_page_with_birth_date](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image3.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-130">[![Instructors_page_with_birth_date](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image3.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image2.png)</span></span>

## <a name="deploying-the-database-update-to-the-test-environment"></a><span data-ttu-id="fdc6e-131">Wdrażanie aktualizacji bazy danych do środowiska testowego</span><span class="sxs-lookup"><span data-stu-id="fdc6e-131">Deploying the Database Update to the Test Environment</span></span>

<span data-ttu-id="fdc6e-132">W **Eksploratora rozwiązań** wybierz projekt ContosoUniversity.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-132">In **Solution Explorer** select the ContosoUniversity project.</span></span>

<span data-ttu-id="fdc6e-133">W **Web publikacja w pojedynczym kliknięciem** narzędzi, wybierz opcję **testu** profil publikowania, a następnie kliknij przycisk **publikowanie w sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-133">In the **Web One Click Publish** toolbar, select the **Test** publish profile, and then click **Publish Web**.</span></span> <span data-ttu-id="fdc6e-134">(Jeśli pasek narzędzi jest wyłączona, wybierz projekt ContosoUniversity **Eksploratora rozwiązań**.)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-134">(If the toolbar is disabled, select the ContosoUniversity project in **Solution Explorer**.)</span></span>

<span data-ttu-id="fdc6e-135">Program Visual Studio wdroży zaktualizowaną aplikację i otwarciu przeglądarki do strony głównej.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-135">Visual Studio deploys the updated application, and the browser opens to the home page.</span></span> <span data-ttu-id="fdc6e-136">Uruchom stronę instruktorów, aby sprawdzić, czy aktualizacja została wdrożona pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-136">Run the Instructors page to verify that the update was successfully deployed.</span></span> <span data-ttu-id="fdc6e-137">Gdy aplikacja podejmie próbę dostępu do bazy danych dla tej strony, Code First aktualizuje schemat bazy danych i uruchamia `Seed` metody.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-137">When the application tries to access the database for this page, Code First updates the database schema and runs the `Seed` method.</span></span> <span data-ttu-id="fdc6e-138">Jeśli zostanie wyświetlona strona, zobaczysz oczekiwany **Data urodzenia** kolumnie znajdują się daty w nim.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-138">When the page displays, you see the expected **Birth Date** column with dates in it.</span></span>

<span data-ttu-id="fdc6e-139">[![Instructors_page_with_birth_date_Test](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image5.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-139">[![Instructors_page_with_birth_date_Test](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image5.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image4.png)</span></span>

## <a name="deploying-the-database-update-to-the-production-environment"></a><span data-ttu-id="fdc6e-140">Wdrażanie aktualizacji bazy danych do środowiska produkcyjnego</span><span class="sxs-lookup"><span data-stu-id="fdc6e-140">Deploying the Database Update to the Production Environment</span></span>

<span data-ttu-id="fdc6e-141">Teraz można wdrożyć do produkcji.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-141">You can now deploy to production.</span></span> <span data-ttu-id="fdc6e-142">Jedyna różnica polega na tym, których będziesz używać *aplikacji\_offline.htm* aby uniemożliwić użytkownikom dostęp do witryny i w ten sposób aktualizowania bazy danych, podczas gdy wdrażasz zmiany.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-142">The only difference is that you'll use *app\_offline.htm* to prevent users from accessing the site and thus updating the database while you're deploying changes.</span></span> <span data-ttu-id="fdc6e-143">Wdrożenia produkcyjnego należy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="fdc6e-143">For production deployment perform the following steps:</span></span>

- <span data-ttu-id="fdc6e-144">Przekaż *aplikacji\_offline.htm* plik do miejsca produkcji.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-144">Upload the *app\_offline.htm* file to the production site.</span></span>
- <span data-ttu-id="fdc6e-145">W programie Visual Studio, wybierz profil produkcji w **Web publikacja w pojedynczym kliknięciem** paska narzędzi i kliknij przycisk **publikowanie w sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-145">In Visual Studio, choose the Production profile in the **Web One Click Publish** toolbar and click **Publish Web**.</span></span>
- <span data-ttu-id="fdc6e-146">Usuń *aplikacji\_offline.htm* plik z witryny produkcyjnej.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-146">Delete the *app\_offline.htm* file from the production site.</span></span>

> [!NOTE]
> <span data-ttu-id="fdc6e-147">Gdy aplikacja jest używana w środowisku produkcyjnym powinny być implementowanie planu tworzenia kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-147">While your application is in use in the production environment you should be implementing a backup plan.</span></span> <span data-ttu-id="fdc6e-148">Oznacza to, że powinny być okresowo kopiowane *School-Prod.sdf* i *aspnet Prod.sdf* pliki z produkcji lokacji do lokalizacji bezpiecznego magazynu, a powinien utrzymywanie generacje kilka takich Tworzenie kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-148">That is, you should be periodically copying the *School-Prod.sdf* and *aspnet-Prod.sdf* files from the production site to a secure storage location, and you should be keeping several generations of such backups.</span></span> <span data-ttu-id="fdc6e-149">Po zaktualizowaniu bazy danych powinno się wykonanie kopii zapasowej z bezpośrednio przed zmianą.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-149">When you update the database, you should make a backup copy from immediately before the change.</span></span> <span data-ttu-id="fdc6e-150">Następnie jeśli popełnienia błędu, a nie odnaleźć go do czasu, po wdrożeniu do środowiska produkcyjnego, nadal będzie można odzyskać bazy danych do stanu, w jakim był, zanim zostanie ona uszkodzona.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-150">Then, if you make a mistake and don't discover it until after you have deployed it to production, you will still be able to recover the database to the state it was in before it became corrupted.</span></span>


<span data-ttu-id="fdc6e-151">Gdy program Visual Studio otwiera adres URL strony głównej w przeglądarce, *aplikacji\_offline.htm* zostanie wyświetlona strona.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-151">When Visual Studio opens the home page URL in the browser, the *app\_offline.htm* page is displayed.</span></span> <span data-ttu-id="fdc6e-152">Po usunięciu *aplikacji\_offline.htm* pliku, możesz przejść do strony głównej ponownie, aby sprawdzić, czy aktualizacja została wdrożona pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-152">After you delete the *app\_offline.htm* file, you can browse to your home page again to verify that the update was successfully deployed.</span></span>

<span data-ttu-id="fdc6e-153">[![Instructors_page_with_birth_date_Prod](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image7.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-153">[![Instructors_page_with_birth_date_Prod](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image7.png)](deployment-to-a-hosting-provider-deploying-a-database-update-9-of-12/_static/image6.png)</span></span>

<span data-ttu-id="fdc6e-154">Teraz udało Ci się wdrożyć aktualizację aplikacji, która obejmuje zmianę bazy danych testowych i produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-154">You've now deployed an application update that included a database change to both test and production.</span></span> <span data-ttu-id="fdc6e-155">Następnym samouczku dowiesz się, jak przeprowadzić migrację bazy danych z programu SQL Server Compact do programu SQL Server Express i SQL Server.</span><span class="sxs-lookup"><span data-stu-id="fdc6e-155">The next tutorial shows you how to migrate your database from SQL Server Compact to SQL Server Express and SQL Server.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fdc6e-156">[Poprzednie](deployment-to-a-hosting-provider-deploying-a-code-only-update-8-of-12.md)
> [dalej](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="fdc6e-156">[Previous](deployment-to-a-hosting-provider-deploying-a-code-only-update-8-of-12.md)
[Next](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12.md)</span></span>
