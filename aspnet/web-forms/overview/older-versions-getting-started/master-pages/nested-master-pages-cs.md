---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-cs
title: Zagnieżdżone strony wzorcoweC#() | Microsoft Docs
author: rick-anderson
description: Pokazuje, jak zagnieżdżać jedną stronę wzorcową w innej.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 32b7fb6e-d74b-4048-91f8-70631b2523ee
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-cs
msc.type: authoredcontent
ms.openlocfilehash: 67093266567a97cd22b353115616484fd9ef155e
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74596773"
---
# <a name="nested-master-pages-c"></a><span data-ttu-id="21c93-103">Zagnieżdżone strony wzorcowe (C#)</span><span class="sxs-lookup"><span data-stu-id="21c93-103">Nested Master Pages (C#)</span></span>

<span data-ttu-id="21c93-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="21c93-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="21c93-105">[Pobierz kod](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.zip) lub [Pobierz plik PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="21c93-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.pdf)</span></span>

> <span data-ttu-id="21c93-106">Pokazuje, jak zagnieżdżać jedną stronę wzorcową w innej.</span><span class="sxs-lookup"><span data-stu-id="21c93-106">Shows how to nest one master page within another.</span></span>

## <a name="introduction"></a><span data-ttu-id="21c93-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="21c93-107">Introduction</span></span>

<span data-ttu-id="21c93-108">W ciągu ostatnich dziewięciu samouczków zaobserwowano sposób implementacji układu dla całej witryny za pomocą stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="21c93-109">W Nutshell strony wzorcowe pozwalają nam, deweloperowi strony definiować typowe znaczniki na stronie wzorcowej wraz z określonymi regionami, które można dostosować na podstawie strony zawartości na stronie zawartość.</span><span class="sxs-lookup"><span data-stu-id="21c93-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="21c93-110">Kontrolki ContentPlaceHolder na stronie wzorcowej wskazują edytowalne regiony; niestandardowe znaczniki formantów ContentPlaceHolder są zdefiniowane na stronie zawartości za pomocą kontrolek zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="21c93-111">Techniki na stronie wzorcowej, które zostały dotąd omówione, są wspaniałe, jeśli masz jeden układ w całej lokacji.</span><span class="sxs-lookup"><span data-stu-id="21c93-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="21c93-112">Jednak wiele dużych witryn sieci Web ma układ witryny dostosowany do różnych sekcji.</span><span class="sxs-lookup"><span data-stu-id="21c93-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="21c93-113">Rozważmy na przykład aplikację opieki zdrowotnej używaną przez personel szpitaly do zarządzania informacjami, działaniami i rozliczeniami pacjenta.</span><span class="sxs-lookup"><span data-stu-id="21c93-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="21c93-114">W tej aplikacji mogą istnieć trzy typy stron sieci Web:</span><span class="sxs-lookup"><span data-stu-id="21c93-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="21c93-115">Strony dla pracowników, w których członkowie personelu mogą aktualizować dostępność, wyświetlać harmonogramy lub żądać czasu urlopu.</span><span class="sxs-lookup"><span data-stu-id="21c93-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="21c93-116">Strony specyficzne dla pacjenta, w których członkowie personelu wyświetlają lub edytują informacje dla określonego pacjenta.</span><span class="sxs-lookup"><span data-stu-id="21c93-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="21c93-117">Strony dotyczące rozliczeń, w których Księgowość przegląda bieżące Stany roszczeń i raporty finansowe.</span><span class="sxs-lookup"><span data-stu-id="21c93-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="21c93-118">Każda strona może korzystać ze wspólnego układu, takiego jak menu w górnej części i seria często używanych linków w dolnej części ekranu.</span><span class="sxs-lookup"><span data-stu-id="21c93-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="21c93-119">Jednak strony dotyczące personelu, pacjenta i rozliczeń mogą wymagać dostosowania tego Układu ogólnego.</span><span class="sxs-lookup"><span data-stu-id="21c93-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="21c93-120">Na przykład, być może wszystkie strony specyficzne dla personelu powinny zawierać kalendarz i listę zadań, które pokazują dostępność aktualnie zalogowanego użytkownika i dzienny harmonogram.</span><span class="sxs-lookup"><span data-stu-id="21c93-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="21c93-121">Być może wszystkie strony specyficzne dla pacjenta muszą wyświetlić nazwę, adres i informacje o ubezpieczeniach dla pacjenta, których informacje są edytowane.</span><span class="sxs-lookup"><span data-stu-id="21c93-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="21c93-122">Istnieje możliwość utworzenia takich dostosowanych układów przy użyciu *zagnieżdżonych stron wzorcowych*.</span><span class="sxs-lookup"><span data-stu-id="21c93-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="21c93-123">Aby zaimplementować powyższy scenariusz, możemy zacząć od utworzenia strony wzorcowej, która definiuje układ całej witryny, zawartość menu i stopki przy użyciu elementów ContentPlaceHolder definiujących edytowalne regiony.</span><span class="sxs-lookup"><span data-stu-id="21c93-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="21c93-124">Następnie utworzymy trzy zagnieżdżone strony wzorcowe, jeden dla każdego typu strony sieci Web.</span><span class="sxs-lookup"><span data-stu-id="21c93-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="21c93-125">Każda zagnieżdżona Strona wzorcowa będzie definiować zawartość między typem stron zawartości, które korzystają z strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="21c93-126">Inaczej mówiąc, zagnieżdżona Strona wzorcowa dla stron zawartości z konkretnym pacjentem będzie zawierać znaczniki i logikę programistyczną służącą do wyświetlania informacji o edytowanym pacjentu.</span><span class="sxs-lookup"><span data-stu-id="21c93-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="21c93-127">Podczas tworzenia nowej strony specyficznej dla pacjenta można powiązać ją z tą zagnieżdżoną stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="21c93-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="21c93-128">Ten samouczek zaczyna się od wyróżniania korzyści zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="21c93-129">Następnie pokazano, jak tworzyć i używać zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="21c93-130">Zagnieżdżone strony wzorcowe były możliwe od wersji 2,0 .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="21c93-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="21c93-131">Jednak program Visual Studio 2005 nie zawiera obsługi czasu projektowania dla zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="21c93-132">Dobra wiadomość polega na tym, że program Visual Studio 2008 oferuje bogate środowisko czasu projektowania dla zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="21c93-133">Jeśli interesuje Cię korzystanie z zagnieżdżonych stron głównych, ale nadal korzystasz z programu Visual Studio 2005, zapoznaj się z wpisem w blogu [Scott Guthrie](https://weblogs.asp.net/scottgu/), [porady dotyczące zagnieżdżonych stron wzorcowych w czasie projektowania programu VS 2005](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span><span class="sxs-lookup"><span data-stu-id="21c93-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>

## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="21c93-134">Zalety zagnieżdżonych stron wzorcowych</span><span class="sxs-lookup"><span data-stu-id="21c93-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="21c93-135">Wiele witryn sieci Web ma przebudowany projekt witryny, a także bardziej dostosowane projekty charakterystyczne dla niektórych typów stron.</span><span class="sxs-lookup"><span data-stu-id="21c93-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="21c93-136">Na przykład w naszej demonstracyjnej aplikacji sieci Web została utworzona sekcja administracji podstawowe (strony w folderze `~/Admin`).</span><span class="sxs-lookup"><span data-stu-id="21c93-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="21c93-137">Obecnie strony sieci Web w folderze `~/Admin` używają tej samej strony wzorcowej co te strony, a nie w sekcji Administracja (tj. `Site.master` lub `Alternate.master`, w zależności od wyboru użytkownika).</span><span class="sxs-lookup"><span data-stu-id="21c93-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="21c93-138">Na razie poudawać, że witryna ma tylko jedną stronę wzorcową, `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="21c93-139">Będziemy używać zagnieżdżonych stron wzorcowych z dwiema (lub więcej) stronami wzorcowymi, zaczynając od "użycie zagnieżdżonej strony wzorcowej dla sekcji administracyjnej" w dalszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="21c93-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>

<span data-ttu-id="21c93-140">Załóżmy, że został poproszony o dostosowanie układu stron administracyjnych w celu uwzględnienia dodatkowych informacji lub linków, które w przeciwnym razie nie będą obecne na innych stronach w witrynie.</span><span class="sxs-lookup"><span data-stu-id="21c93-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="21c93-141">Istnieją cztery techniki implementowania tego wymagania:</span><span class="sxs-lookup"><span data-stu-id="21c93-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="21c93-142">Ręcznie Dodaj informacje dotyczące administracji i linki do każdej strony zawartości w folderze `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="21c93-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="21c93-143">Zaktualizuj stronę wzorcową `Site.master`, aby zawierała informacje i linki dotyczące sekcji administracji, a następnie Dodaj kod do strony głównej, aby pokazać lub ukryć te sekcje w zależności od tego, czy jedna ze stron administracyjnych jest odwiedzana.</span><span class="sxs-lookup"><span data-stu-id="21c93-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="21c93-144">Utwórz nową stronę wzorcową dla sekcji Administracja, skopiuj ją do znacznika z `Site.master`, Dodaj informacje i linki dotyczące sekcji Administracja, a następnie zaktualizuj strony zawartości w folderze `~/Admin`, aby użyć tej nowej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="21c93-145">Utwórz zagnieżdżoną stronę wzorcową, która wiąże się z `Site.master` i że strony zawartości w folderze `~/Admin` używają tej nowej zagnieżdżonej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="21c93-146">Ta zagnieżdżona Strona wzorcowa będzie zawierać tylko dodatkowe informacje i linki specyficzne dla stron administracyjnych i nie musi powtarzać znaczników już zdefiniowanych w `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="21c93-147">Pierwsza opcja to najmniejszy palatable.</span><span class="sxs-lookup"><span data-stu-id="21c93-147">The first option is the least palatable.</span></span> <span data-ttu-id="21c93-148">Cały punkt korzystania ze stron wzorcowych polega na tym, że trzeba ręcznie kopiować i wklejać typowe znaczniki do nowych stron ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="21c93-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="21c93-149">Druga opcja jest akceptowalna, ale sprawia, że aplikacja jest mniej utrzymywana, gdy tworzy zbiorczo strony wzorcowe ze znacznikiem, które jest wyświetlane tylko sporadycznie, i wymaga, aby deweloperzy edytujący stronę wzorcową mogli obejść tę adiustację i zapamiętać, że dokładnie niektóre znaczniki są wyświetlane w przeciwieństwie do ukrycia.</span><span class="sxs-lookup"><span data-stu-id="21c93-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="21c93-150">Takie podejście byłoby mniej Tenable, ponieważ dostosowania z więcej niż większej liczby typów stron sieci Web, które trzeba uwzględnić na tej pojedynczej stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="21c93-151">Trzecia opcja eliminuje problemy z bałaganem i złożonością wyznaczoną dla drugiej opcji.</span><span class="sxs-lookup"><span data-stu-id="21c93-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="21c93-152">Jednak w przypadku opcji trzech głównej wadą jest wymagane skopiowanie i wklejenie wspólnego układu z `Site.master` do nowej strony głównej konkretnej sekcji administracji.</span><span class="sxs-lookup"><span data-stu-id="21c93-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="21c93-153">W przypadku późniejszej decyzji o zmianie układu dla całej witryny należy pamiętać, aby zmienić go w dwóch miejscach.</span><span class="sxs-lookup"><span data-stu-id="21c93-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="21c93-154">Czwarta opcja zagnieżdżonych stron wzorcowych daje nam najlepsze z drugiej i trzeciej opcji.</span><span class="sxs-lookup"><span data-stu-id="21c93-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="21c93-155">Informacje o układzie dla całej witryny są przechowywane w jednym pliku — stronie wzorcowej najwyższego poziomu — w przypadku oddzielenia zawartości specyficznej dla określonych regionów na różne pliki.</span><span class="sxs-lookup"><span data-stu-id="21c93-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="21c93-156">Ten samouczek rozpoczyna się od utworzenia i użycia prostej zagnieżdżonej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="21c93-157">Tworzymy nową stronę wzorcową najwyższego poziomu, dwie zagnieżdżone strony wzorcowe i dwie strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="21c93-158">Począwszy od opcji "Używanie zagnieżdżonej strony wzorcowej dla sekcji Administracja" Przyjrzyjmy się aktualizowaniu istniejącej architektury strony głównej, aby uwzględnić użycie zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="21c93-159">W szczególnych przypadkach tworzymy zagnieżdżoną stronę wzorcową i użyjemy jej do dołączania dodatkowej zawartości niestandardowej do stron zawartości w folderze `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="21c93-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="21c93-160">Krok 1. tworzenie prostej strony wzorcowej najwyższego poziomu</span><span class="sxs-lookup"><span data-stu-id="21c93-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="21c93-161">Utworzenie zagnieżdżonego wzorca opartego na jednej z istniejących stron wzorcowych, a następnie zaktualizowanie istniejącej strony zawartości do korzystania z tej nowej zagnieżdżonej strony wzorcowej zamiast strony wzorcowej najwyższego poziomu wiąże się z pewnymi złożonością, ponieważ istniejące strony zawartości już oczekują na niektóre Kontrolki ContentPlaceHolder zdefiniowane na stronie wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="21c93-162">W związku z tym zagnieżdżona Strona wzorcowa musi również zawierać te same kontrolki ContentPlaceHolder o tych samych nazwach.</span><span class="sxs-lookup"><span data-stu-id="21c93-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="21c93-163">Ponadto nasza aplikacja demonstracyjna ma dwie strony wzorcowe (`Site.master` i `Alternate.master`), które są dynamicznie przypisywane do strony zawartości w oparciu o preferencje użytkownika, co dodatkowo dodaje do tej złożoności.</span><span class="sxs-lookup"><span data-stu-id="21c93-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="21c93-164">Zapoznajemy się z aktualizacją istniejącej aplikacji w celu używania zagnieżdżonych stron wzorcowych w dalszej części tego samouczka, ale najpierw skupmy się na prostym przykładzie zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="21c93-165">Utwórz nowy folder o nazwie `NestedMasterPages`, a następnie Dodaj nowy plik strony głównej do tego folderu o nazwie `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="21c93-166">(Zobacz rysunek 1 zrzut ekranu przedstawiający Eksplorator rozwiązań po dodaniu tego folderu i pliku). Przeciągnij plik arkusza stylów `AlternateStyles.css` z Eksplorator rozwiązań do projektanta.</span><span class="sxs-lookup"><span data-stu-id="21c93-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="21c93-167">Spowoduje to dodanie elementu `<link>` do pliku arkusza stylów w elemencie `<head>`, po którym będzie wyglądać znacznik elementu `<head>` strony wzorcowej:</span><span class="sxs-lookup"><span data-stu-id="21c93-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample1.aspx)]

<span data-ttu-id="21c93-168">Następnie Dodaj następujący znacznik w formie sieci Web `Simple.master`:</span><span class="sxs-lookup"><span data-stu-id="21c93-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample2.aspx)]

<span data-ttu-id="21c93-169">Ten znacznik wyświetla link zatytułowany "zagnieżdżone strony wzorcowe (proste)" w górnej części strony w dużej białej czcionce na granatowym tle.</span><span class="sxs-lookup"><span data-stu-id="21c93-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="21c93-170">Poniżej znajduje się `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="21c93-171">Rysunek 1 przedstawia stronę wzorcową `Simple.master` po załadowaniu jej w programie Visual Studio Designer.</span><span class="sxs-lookup"><span data-stu-id="21c93-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>

<span data-ttu-id="21c93-172">[![zagnieżdżona Strona wzorcowa definiuje zawartość specyficzną dla stron w sekcji Administracja.](nested-master-pages-cs/_static/image2.png)](nested-master-pages-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-cs/_static/image2.png)](nested-master-pages-cs/_static/image1.png)</span></span>

<span data-ttu-id="21c93-173">**Ilustracja 01**. zagnieżdżona Strona wzorcowa definiuje zawartość specyficzną dla stron w sekcji Administracja ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-cs/_static/image3.png))</span></span>

## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="21c93-174">Krok 2. tworzenie prostej zagnieżdżonej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="21c93-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="21c93-175">`Simple.master` zawiera dwie kontrolki ContentPlaceHolder: element `MainContent` ContentPlaceHolder, który został dodany w formularzu sieci Web wraz z `head` ContentPlaceHolder w elemencie `<head>`.</span><span class="sxs-lookup"><span data-stu-id="21c93-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="21c93-176">Jeśli udało nam się utworzyć stronę zawartości i powiązać ją z `Simple.master` strona zawartości będzie miała dwie kontrolki zawartości odwołujące się do dwóch elementów ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="21c93-177">Podobnie, jeśli utworzymy zagnieżdżoną stronę wzorcową i powiążesz ją z `Simple.master`, zagnieżdżona Strona wzorcowa będzie miała dwie kontrolki zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="21c93-178">Dodajmy nową zagnieżdżoną stronę wzorcową do folderu `NestedMasterPages` o nazwie `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="21c93-179">Kliknij prawym przyciskiem myszy folder `NestedMasterPages` i wybierz polecenie Dodaj nowy element.</span><span class="sxs-lookup"><span data-stu-id="21c93-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="21c93-180">Spowoduje to wyświetlenie okna dialogowego Dodawanie nowego elementu pokazanego na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="21c93-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="21c93-181">Wybierz typ szablonu strony głównej i wpisz nazwę nowej strony głównej.</span><span class="sxs-lookup"><span data-stu-id="21c93-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="21c93-182">Aby wskazać, że nowa strona wzorcowa powinna być zagnieżdżoną stroną wzorcową, zaznacz pole wyboru "Wybierz stronę wzorcową".</span><span class="sxs-lookup"><span data-stu-id="21c93-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="21c93-183">Następnie kliknij przycisk Dodaj.</span><span class="sxs-lookup"><span data-stu-id="21c93-183">Next, click the Add button.</span></span> <span data-ttu-id="21c93-184">Spowoduje to wyświetlenie okna dialogowego Wybierz stronę wzorcową, które zostanie wyświetlone podczas wiązania strony zawartości ze stroną wzorcową (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="21c93-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="21c93-185">Wybierz stronę wzorcową `Simple.master` w folderze `NestedMasterPages` i kliknij przycisk OK.</span><span class="sxs-lookup"><span data-stu-id="21c93-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="21c93-186">Jeśli witryna sieci Web ASP.NET została utworzona przy użyciu modelu projektu aplikacji internetowej zamiast modelu projektu witryny sieci Web, w oknie dialogowym Dodaj nowy element zostanie wyświetlona wartość pola wyboru "Wybierz stronę wzorcową" na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="21c93-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="21c93-187">Aby utworzyć zagnieżdżoną stronę wzorcową podczas korzystania z modelu projektu aplikacji sieci Web, należy wybrać zagnieżdżony szablon strony wzorcowej (zamiast szablonu strony głównej).</span><span class="sxs-lookup"><span data-stu-id="21c93-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="21c93-188">Po wybraniu szablonu zagnieżdżonej strony wzorcowej i kliknięciu przycisku Dodaj zostanie wyświetlona ta sama okno dialogowe Wybieranie strony głównej pokazane na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="21c93-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>

<span data-ttu-id="21c93-189">[![zaznacz pole wyboru &quot;wybierz stronę wzorcową&quot;, aby dodać zagnieżdżoną stronę wzorcową](nested-master-pages-cs/_static/image5.png)](nested-master-pages-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-cs/_static/image5.png)](nested-master-pages-cs/_static/image4.png)</span></span>

<span data-ttu-id="21c93-190">**Ilustracja 02**. Zaznacz pole wyboru "Wybierz stronę wzorcową", aby dodać zagnieżdżoną stronę wzorcową ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image6.png))</span></span>

<span data-ttu-id="21c93-191">[![powiązać zagnieżdżoną stronę wzorcową z prostą. wzorcową stroną wzorcową](nested-master-pages-cs/_static/image8.png)](nested-master-pages-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-cs/_static/image8.png)](nested-master-pages-cs/_static/image7.png)</span></span>

<span data-ttu-id="21c93-192">**Rysunek 03**: Powiąż zagnieżdżoną stronę wzorcową ze stroną wzorcową `Simple.master` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image9.png))</span></span>

<span data-ttu-id="21c93-193">Rozszerzalne znaczniki strony wzorcowej, pokazane poniżej, zawierają dwie kontrolki zawartości odwołujące się do dwóch formantów ContentPlaceHolder na stronie wzorca najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample3.aspx)]

<span data-ttu-id="21c93-194">Z wyjątkiem dyrektywy `<%@ Master %>` pierwotna deklaracyjnej strony wzorcowej jest taka sama jak znacznik, który jest początkowo generowany podczas wiązania strony zawartości z tą samą stroną wzorcową najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="21c93-195">Podobnie jak w przypadku dyrektywy `<%@ Page %>` strony zawartości, dyrektywa `<%@ Master %>` zawiera atrybut `MasterPageFile`, który określa nadrzędną stronę wzorcową strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="21c93-196">Główną różnicą między zagnieżdżoną stroną wzorcową a stroną zawartości powiązaną z tą samą stroną wzorcową najwyższego poziomu jest to, że zagnieżdżona Strona wzorcowa może zawierać kontrolki ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="21c93-197">Kontrolki ContentPlaceHolder zagnieżdżonej strony wzorcowej definiują regiony, w których strony zawartości mogą dostosowywać adiustację.</span><span class="sxs-lookup"><span data-stu-id="21c93-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="21c93-198">Zaktualizuj tę zagnieżdżoną stronę wzorcową tak, aby wyświetlała tekst "Hello, from SimpleNested!"</span><span class="sxs-lookup"><span data-stu-id="21c93-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="21c93-199">w kontrolce zawartości, która odnosi się do formantu `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample4.aspx)]

<span data-ttu-id="21c93-200">Po dokonaniu tego dodawania Zapisz zagnieżdżoną stronę wzorcową, a następnie Dodaj nową stronę zawartości do folderu `NestedMasterPages` o nazwie `Default.aspx`i powiąż go ze stroną wzorcową `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="21c93-201">Po dodaniu tej strony może być niedostępna, aby zobaczyć, że nie zawiera żadnych kontrolek zawartości (zobacz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="21c93-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="21c93-202">Strona zawartości może uzyskać dostęp tylko do elementów ContentPlaceHolder swojej *nadrzędnej* strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="21c93-203">`SimpleNested.master` nie zawiera żadnych kontrolek ContentPlaceHolder; w związku z tym każda strona zawartości związana z tą stroną wzorcową nie może zawierać żadnych kontrolek zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>

<span data-ttu-id="21c93-204">[![Nowa strona zawartości nie zawiera żadnych kontrolek zawartości](nested-master-pages-cs/_static/image11.png)](nested-master-pages-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-204">[![The New Content Page Contains No Content Controls](nested-master-pages-cs/_static/image11.png)](nested-master-pages-cs/_static/image10.png)</span></span>

<span data-ttu-id="21c93-205">**Ilustracja 04**: Nowa strona zawartości nie zawiera żadnych kontrolek zawartości ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-cs/_static/image12.png))</span></span>

<span data-ttu-id="21c93-206">Należy zaktualizować zagnieżdżoną stronę wzorcową (`SimpleNested.master`), aby zawierała kontrolki ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="21c93-207">Zazwyczaj można chcieć, aby zagnieżdżone strony wzorcowe zawierały element ContentPlaceHolder dla każdego elementu ContentPlaceHolder zdefiniowanego przez jego nadrzędną stronę wzorcową, dzięki czemu jego podrzędna Strona wzorcowa lub strona zawartości może współdziałać z dowolną stroną wzorcową najwyższego poziomu. kontrolek.</span><span class="sxs-lookup"><span data-stu-id="21c93-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="21c93-208">Zaktualizuj stronę wzorcową `SimpleNested.master`, aby zawierała element ContentPlaceHolder w swoich dwóch kontrolkach zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="21c93-209">Nadaj formantowi ContentPlaceHolder taką samą nazwę, jak formant ContentPlaceHolder, do którego odwołuje się kontrolka zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="21c93-210">Oznacza to, że Dodaj kontrolkę ContentPlaceHolder o nazwie `MainContent` do kontrolki zawartość w `SimpleNested.master`, która odwołuje się do `MainContent` ContentPlaceHolder w `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="21c93-211">Wykonaj tę samą czynność w kontrolce zawartości, która odwołuje się do `head` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="21c93-212">Chociaż zaleca się nazywanie formantów ContentPlaceHolder na zagnieżdżonej stronie wzorcowej tak samo jak elementy ContentPlaceHolder na stronie wzorcowej najwyższego poziomu, ta symetria nazewnictwa nie jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="21c93-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="21c93-213">Możesz nadać kontrolki ContentPlaceHolder na zagnieżdżonej stronie wzorcowej dowolną nazwę.</span><span class="sxs-lookup"><span data-stu-id="21c93-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="21c93-214">Można jednak łatwiej zapamiętać, jakie elementy ContentPlaceHolder odpowiadają regionom strony, jeśli na stronie wzorcowej najwyższego poziomu i zagnieżdżonych stronach wzorcowych są używane te same nazwy.</span><span class="sxs-lookup"><span data-stu-id="21c93-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>

<span data-ttu-id="21c93-215">Po wprowadzeniu tych uzupełnień deklaratywne znaczniki strony wzorcowej `SimpleNested.master` powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="21c93-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample5.aspx)]

<span data-ttu-id="21c93-216">Usuń właśnie utworzoną stronę zawartości `Default.aspx`, a następnie dodaj ją ponownie, aby powiązać ją ze stroną wzorcową `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="21c93-217">Tym razem program Visual Studio dodaje do `Default.aspx`dwie kontrolki zawartości, odwołujące się do elementów ContentPlaceHolder teraz zdefiniowanych w `SimpleNested.master` (zobacz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="21c93-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="21c93-218">Dodaj tekst "Hello, z default. aspx!"</span><span class="sxs-lookup"><span data-stu-id="21c93-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="21c93-219">w kontrolce zawartości, do której odwołuje się `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="21c93-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="21c93-220">Rysunek 5 przedstawia trzy jednostki występujące w tym miejscu — `Simple.master`, `SimpleNested.master`i `Default.aspx` oraz sposób ich powiązania ze sobą.</span><span class="sxs-lookup"><span data-stu-id="21c93-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="21c93-221">Jak widać na diagramie, zagnieżdżona Strona wzorcowa implementuje formanty zawartości dla elementu ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="21c93-222">Jeśli te regiony muszą być dostępne dla strony zawartości, zagnieżdżona Strona wzorcowa musi dodać własne elementy ContentPlaceHolders do kontrolek zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>

<span data-ttu-id="21c93-223">[![na najwyższego poziomu i zagnieżdżonych stronach wzorcowych dyktowanie układu strony zawartości](nested-master-pages-cs/_static/image14.png)](nested-master-pages-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-cs/_static/image14.png)](nested-master-pages-cs/_static/image13.png)</span></span>

<span data-ttu-id="21c93-224">**Ilustracja 05**: strony nadrzędne najwyższego poziomu i zagnieżdżonych stron wzorcowych wymuszają układ strony zawartości ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-cs/_static/image15.png))</span></span>

<span data-ttu-id="21c93-225">To zachowanie ilustruje, jak strona zawartości lub strona wzorcowa jest firma Cognizant tylko nadrzędnej strony głównej.</span><span class="sxs-lookup"><span data-stu-id="21c93-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="21c93-226">To zachowanie jest również wskazywane przez projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="21c93-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="21c93-227">Rysunek 6 przedstawia projektanta `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="21c93-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="21c93-228">Gdy projektant jasno pokazuje, które regiony są edytowalne ze strony zawartości i jakie fragmenty nie są, nie można odróżnić regionów, które nie są edytowalne, są z zagnieżdżonej strony wzorcowej i jakie regiony znajdują się na stronie wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>

<span data-ttu-id="21c93-229">[![strona zawartości zawiera teraz kontrolki zawartości dla elementów ContentPlaceHolder zagnieżdżonej strony wzorcowej](nested-master-pages-cs/_static/image17.png)](nested-master-pages-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-cs/_static/image17.png)](nested-master-pages-cs/_static/image16.png)</span></span>

<span data-ttu-id="21c93-230">**Ilustracja 06**. Strona zawartości zawiera teraz formanty zawartości dla elementów ContentPlaceHolder zagnieżdżonej strony wzorcowej ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-cs/_static/image18.png))</span></span>

## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="21c93-231">Krok 3. Dodawanie drugiej prostej zagnieżdżonej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="21c93-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="21c93-232">Korzystanie z zagnieżdżonych stron wzorcowych jest bardziej oczywiste, gdy istnieje wiele zagnieżdżonych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="21c93-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="21c93-233">Aby zilustrować tę korzyść, należy utworzyć kolejną zagnieżdżoną stronę wzorcową w folderze `NestedMasterPages`. Nazwij tę nową zagnieżdżoną stronę wzorcową `SimpleNestedAlternate.master` i powiąż ją ze stroną wzorcową `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="21c93-234">Dodaj kontrolki ContentPlaceHolder na dwóch kontrolkach zawartości zagnieżdżonej strony wzorcowej, podobnie jak w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="21c93-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="21c93-235">Dodaj również tekst "Hello, from SimpleNestedAlternate!"</span><span class="sxs-lookup"><span data-stu-id="21c93-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="21c93-236">w kontrolce zawartości, która odnosi się do `MainContent` ContentPlaceHolder na stronie wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="21c93-237">Po wprowadzeniu tych zmian Nowa zagnieżdżona jednostronicowa Strona wzorcowa powinna wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="21c93-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample6.aspx)]

<span data-ttu-id="21c93-238">Utwórz stronę zawartości o nazwie `Alternate.aspx` w folderze `NestedMasterPages` i powiąż ją z `SimpleNestedAlternate.master` zagnieżdżoną stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="21c93-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="21c93-239">Dodaj tekst "Hello, z alternatywy!"</span><span class="sxs-lookup"><span data-stu-id="21c93-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="21c93-240">w kontrolce zawartości, która odnosi się do `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="21c93-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="21c93-241">Rysunek 7 przedstawia `Alternate.aspx` podczas wyświetlania za pomocą projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="21c93-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>

<span data-ttu-id="21c93-242">[![alternatywnej. aspx jest powiązany z stroną wzorcową SimpleNestedAlternate. Master](nested-master-pages-cs/_static/image20.png)](nested-master-pages-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-cs/_static/image20.png)](nested-master-pages-cs/_static/image19.png)</span></span>

<span data-ttu-id="21c93-243">**Ilustracja 07**: `Alternate.aspx` jest powiązany ze stroną wzorcową `SimpleNestedAlternate.master` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image21.png))</span></span>

<span data-ttu-id="21c93-244">Porównaj projektanta na rysunku 7 z projektantem na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="21c93-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="21c93-245">Obie strony zawartości mają ten sam układ zdefiniowany na stronie wzorcowej najwyższego poziomu (`Simple.master`), a mianowicie tytuł "zagnieżdżonych stron wzorcowych (prosty)".</span><span class="sxs-lookup"><span data-stu-id="21c93-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="21c93-246">W obu nadrzędnych stronach głównych obu tych elementów określono odrębną zawartość — tekst "Hello, from SimpleNested!".</span><span class="sxs-lookup"><span data-stu-id="21c93-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="21c93-247">na rysunku 6 i "Witaj, from SimpleNestedAlternate!"</span><span class="sxs-lookup"><span data-stu-id="21c93-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="21c93-248">na rysunku 7.</span><span class="sxs-lookup"><span data-stu-id="21c93-248">in Figure 7.</span></span> <span data-ttu-id="21c93-249">Te różnice są proste, ale można zwiększyć ten przykład, aby uwzględnić bardziej zrozumiałe różnice.</span><span class="sxs-lookup"><span data-stu-id="21c93-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="21c93-250">Na przykład strona `SimpleNested.master` może zawierać menu z opcjami specyficznymi dla jego stron zawartości, natomiast `SimpleNestedAlternate.master` mogą zawierać informacje dotyczące stron zawartości, które są z nią powiązane.</span><span class="sxs-lookup"><span data-stu-id="21c93-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="21c93-251">Teraz wyobraź sobie, że firma Microsoft musiała wprowadzić zmiany w układzie przemieszczenia.</span><span class="sxs-lookup"><span data-stu-id="21c93-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="21c93-252">Załóżmy na przykład, że chcemy dodać listę typowych linków do wszystkich stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="21c93-253">Aby to osiągnąć, zaktualizujemy stronę wzorcową najwyższego poziomu `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="21c93-254">Wszelkie zmiany zostaną natychmiast odzwierciedlone na zagnieżdżonych stronach wzorcowych, a po rozszerzeniu ich stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="21c93-255">Aby zademonstrować, w jaki sposób można zmienić układ witryny, należy otworzyć `Simple.master` stronę wzorcową i dodać następujące znaczniki między `topContent` i `mainContent` elementów `<div>`:</span><span class="sxs-lookup"><span data-stu-id="21c93-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample7.aspx)]

<span data-ttu-id="21c93-256">Spowoduje to dodanie dwóch linków do górnej części każdej strony, która wiąże się z `Simple.master`, `SimpleNested.master`lub `SimpleNestedAlternate.master`; te zmiany dotyczą wszystkich zagnieżdżonych stron wzorcowych i ich stron zawartości natychmiast.</span><span class="sxs-lookup"><span data-stu-id="21c93-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="21c93-257">Rysunek 8 przedstawia `Alternate.aspx`, gdy jest wyświetlany za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="21c93-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="21c93-258">Zwróć uwagę na dodanie linków w górnej części strony (w porównaniu do rysunku 7).</span><span class="sxs-lookup"><span data-stu-id="21c93-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>

<span data-ttu-id="21c93-259">[![zmienione na stronę wzorcową najwyższego poziomu są natychmiast odzwierciedlane na zagnieżdżonych stronach wzorcowych i ich stronach zawartości](nested-master-pages-cs/_static/image23.png)](nested-master-pages-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-cs/_static/image23.png)](nested-master-pages-cs/_static/image22.png)</span></span>

<span data-ttu-id="21c93-260">**Ilustracja 08**: zmiana na stronę wzorcową najwyższego poziomu jest natychmiast odzwierciedlana na zagnieżdżonych stronach wzorcowych i ich stronach zawartości ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-cs/_static/image24.png))</span></span>

## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="21c93-261">Używanie zagnieżdżonej strony wzorcowej dla sekcji Administracja</span><span class="sxs-lookup"><span data-stu-id="21c93-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="21c93-262">W tym momencie oglądamy zalety zagnieżdżonych stron wzorcowych i zaobserwowano, jak tworzyć i używać ich w aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="21c93-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="21c93-263">Przykłady w krokach 1, 2 i 3, jednak polegają na tworzeniu nowej strony wzorcowej najwyższego poziomu, nowych zagnieżdżonych stronach głównych i nowych stronach zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="21c93-264">Jak dodać nową zagnieżdżoną stronę wzorcową do witryny sieci Web z istniejącą stroną wzorcową najwyższego poziomu i stronami zawartości?</span><span class="sxs-lookup"><span data-stu-id="21c93-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="21c93-265">Integracja zagnieżdżonej strony wzorcowej z istniejącą witryną sieci Web i skojarzenie jej z istniejącymi stronami zawartości wymaga większego nakładu pracy niż od podstaw.</span><span class="sxs-lookup"><span data-stu-id="21c93-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="21c93-266">Kroki 4, 5, 6 i 7 eksplorują te wyzwania w miarę rozszerzania aplikacji demonstracyjnej, aby dołączyć nową zagnieżdżoną stronę wzorcową o nazwie `AdminNested.master`, która zawiera instrukcje dla administratora i jest używana przez strony ASP.NET w folderze `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="21c93-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="21c93-267">Integracja zagnieżdżonej strony wzorcowej z naszą aplikacją demonstracyjną wprowadza następujące progi:</span><span class="sxs-lookup"><span data-stu-id="21c93-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="21c93-268">Istniejące strony zawartości w folderze `~/Admin` mają pewne oczekiwania ze strony głównej.</span><span class="sxs-lookup"><span data-stu-id="21c93-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="21c93-269">W przypadku elementów uruchamiających oczekuje się, że niektóre kontrolki ContentPlaceHolder mają być obecne.</span><span class="sxs-lookup"><span data-stu-id="21c93-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="21c93-270">Ponadto strony `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` wywołują metodę `RefreshRecentProductsGrid` publicznego strony wzorcowej, ustawiać jej Właściwość `GridMessageText` lub mieć procedurę obsługi zdarzeń dla zdarzenia `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="21c93-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="21c93-271">W związku z tym, nasza zagnieżdżona Strona wzorcowa musi udostępniać te same elementy ContentPlaceHolders i publiczną składową.</span><span class="sxs-lookup"><span data-stu-id="21c93-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="21c93-272">W poprzednim samouczku rozszerzono klasę `BasePage`, aby dynamicznie ustawiać właściwość `MasterPageFile` obiektu `Page` na podstawie zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="21c93-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="21c93-273">Jak obsługujemy dynamiczne strony wzorcowe w przypadku używania zagnieżdżonych stron wzorcowych?</span><span class="sxs-lookup"><span data-stu-id="21c93-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="21c93-274">Te dwa wyzwania będą się pojawiać w miarę kompilowania zagnieżdżonej strony wzorcowej i używania jej z istniejących stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="21c93-275">Będziemy badać i surmount te problemy w miarę ich istnienia.</span><span class="sxs-lookup"><span data-stu-id="21c93-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="21c93-276">Krok 4. Tworzenie zagnieżdżonej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="21c93-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="21c93-277">Najpierw należy utworzyć zagnieżdżoną stronę wzorcową, która będzie używana przez strony w sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="21c93-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="21c93-278">Zgodnie z opisem w kroku 2, gdy dodajesz nową zagnieżdżoną stronę wzorcową, musimy określić nadrzędną stronę wzorcową strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="21c93-279">Jednak mamy dwie strony wzorcowe najwyższego poziomu: `Site.master` i `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="21c93-280">Odwołaj, że utworzyliśmy `Alternate.master` w poprzednim samouczku i napisany kod w klasie `BasePage`, która ustawia właściwość `MasterPageFile` obiektu strony w czasie wykonywania do `Site.master` lub `Alternate.master`, w zależności od wartości zmiennej sesji `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the Page object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="21c93-281">Jak skonfigurować naszą zagnieżdżoną stronę wzorcową tak, aby korzystała z odpowiedniej strony wzorcowej najwyższego poziomu?</span><span class="sxs-lookup"><span data-stu-id="21c93-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="21c93-282">Dostępne są dwie opcje:</span><span class="sxs-lookup"><span data-stu-id="21c93-282">We have two options:</span></span>

- <span data-ttu-id="21c93-283">Utwórz dwie zagnieżdżone strony wzorcowe, `AdminNestedSite.master` i `AdminNestedAlternate.master`, a następnie powiąż je z stronami wzorcowymi najwyższego poziomu odpowiednio `Site.master` i `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="21c93-284">W `BasePage`, ustawimy `MasterPageFile` obiektu `Page` na odpowiednią zagnieżdżoną stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="21c93-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="21c93-285">Utwórz pojedynczą zagnieżdżoną stronę wzorcową i strony zawartości używają tej konkretnej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="21c93-286">Następnie w czasie wykonywania musimy ustawić właściwość `MasterPageFile` zagnieżdżonej strony wzorcowej na odpowiednią stronę wzorcową najwyższego poziomu w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="21c93-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="21c93-287">(Jak już już wiesz, strony wzorcowe mają również właściwość `MasterPageFile`).</span><span class="sxs-lookup"><span data-stu-id="21c93-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="21c93-288">Użyjmy drugiej opcji.</span><span class="sxs-lookup"><span data-stu-id="21c93-288">Let's use the second option.</span></span> <span data-ttu-id="21c93-289">Utwórz pojedynczy zagnieżdżony plik strony głównej w folderze `~/Admin` o nazwie `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="21c93-290">Ponieważ zarówno `Site.master`, jak i `Alternate.master` mają ten sam zestaw elementów typu ContentPlaceHolder, nie ma znaczenia, do której strony głównej należy powiązać, chociaż zachęcamy do powiązania go z `Site.master` w celu zapewnienia spójności.</span><span class="sxs-lookup"><span data-stu-id="21c93-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>

<span data-ttu-id="21c93-291">[![dodać zagnieżdżoną stronę wzorcową do folderu ~/Admin.](nested-master-pages-cs/_static/image26.png)](nested-master-pages-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-cs/_static/image26.png)](nested-master-pages-cs/_static/image25.png)</span></span>

<span data-ttu-id="21c93-292">**Ilustracja 09**. Dodaj zagnieżdżoną stronę wzorcową do folderu `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="21c93-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="21c93-293">([Kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-293">([Click to view full-size image](nested-master-pages-cs/_static/image27.png))</span></span>

<span data-ttu-id="21c93-294">Ponieważ zagnieżdżona Strona wzorcowa jest powiązana ze stroną wzorcową z czterema kontrolkami elementów ContentPlaceHolder, program Visual Studio dodaje cztery kontrolki zawartości do nowego, zagnieżdżonego pliku strony głównej.</span><span class="sxs-lookup"><span data-stu-id="21c93-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="21c93-295">Podobnie jak w przypadku kroków 2 i 3, Dodaj kontrolkę ContentPlaceHolder w każdej kontrolce zawartości, dając ją taką samą nazwę jak formant ContentPlaceHolder strony wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="21c93-296">Dodaj również następujące znaczniki do kontrolki zawartości, która odnosi się do `MainContent` ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="21c93-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>

[!code-html[Main](nested-master-pages-cs/samples/sample8.html)]

<span data-ttu-id="21c93-297">Następnie zdefiniuj klasę `instructions` CSS w plikach CSS `Styles.css` i `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="21c93-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="21c93-298">Poniższe reguły CSS powodują, że elementy HTML mają styl z klasą `instructions`, które mają być wyświetlane z jasnym żółtym kolorem tła i czarnym, ciągłym obramowaniem:</span><span class="sxs-lookup"><span data-stu-id="21c93-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>

[!code-css[Main](nested-master-pages-cs/samples/sample9.css)]

<span data-ttu-id="21c93-299">Ponieważ ta funkcja adiustacji została dodana do zagnieżdżonej strony wzorcowej, zostanie wyświetlona tylko na tych stronach, które używają tej zagnieżdżonej strony wzorcowej (tj. stron w sekcji Administracja).</span><span class="sxs-lookup"><span data-stu-id="21c93-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="21c93-300">Po wprowadzeniu tych dodatków do zagnieżdżonej strony wzorcowej, jej deklaracyjne znaczniki powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="21c93-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample10.aspx)]

<span data-ttu-id="21c93-301">Zwróć uwagę, że każda kontrolka zawartości ma kontrolkę ContentPlaceHolder i że właściwości "`ID`" formantów "ContentPlaceHolder" mają przypisane te same wartości, co odpowiednie kontrolki ContentPlaceHolder na stronie wzorcowej najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="21c93-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="21c93-302">Ponadto znacznik charakterystyczny dla sekcji Administracja pojawia się w `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="21c93-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="21c93-303">Na rysunku nr 10 przedstawiono `AdminNested.master` zagnieżdżoną stronę wzorcową wyświetlaną za pomocą projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="21c93-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="21c93-304">Możesz zobaczyć instrukcje w żółtym polu w górnej części kontrolki zawartości `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="21c93-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>

<span data-ttu-id="21c93-305">[![zagnieżdżona Strona wzorcowa rozszerza stronę wzorcową najwyższego poziomu, aby zawierała instrukcje dla administratora.](nested-master-pages-cs/_static/image29.png)](nested-master-pages-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-cs/_static/image29.png)](nested-master-pages-cs/_static/image28.png)</span></span>

<span data-ttu-id="21c93-306">**Ilustracja 10**. zagnieżdżona Strona wzorcowa rozszerza stronę wzorcową najwyższego poziomu, aby zawierała instrukcje dla administratora.</span><span class="sxs-lookup"><span data-stu-id="21c93-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="21c93-307">([Kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-307">([Click to view full-size image](nested-master-pages-cs/_static/image30.png))</span></span>

## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="21c93-308">Krok 5. aktualizowanie istniejących stron zawartości do korzystania z nowej zagnieżdżonej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="21c93-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="21c93-309">Po dodaniu nowej strony zawartości do sekcji Administracja musimy powiązać ją ze stroną wzorcową `AdminNested.master`, która została właśnie utworzona.</span><span class="sxs-lookup"><span data-stu-id="21c93-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="21c93-310">Ale co o istniejących stronach zawartości?</span><span class="sxs-lookup"><span data-stu-id="21c93-310">But what about the existing content pages?</span></span> <span data-ttu-id="21c93-311">Obecnie wszystkie strony zawartości w lokacji pochodzą z klasy `BasePage`, która programowo ustawia stronę wzorcową strony zawartości w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="21c93-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="21c93-312">Nie jest to zachowanie dla stron zawartości w sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="21c93-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="21c93-313">Zamiast tego chcemy, aby te strony zawartości zawsze używały strony `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="21c93-314">Na podstawie zagnieżdżonej strony wzorcowej można wybrać odpowiednią stronę zawartości najwyższego poziomu w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="21c93-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="21c93-315">Najlepszym sposobem osiągnięcia tego żądanego zachowania jest utworzenie nowej niestandardowej klasy strony podstawowej o nazwie `AdminBasePage`, która rozszerza klasę `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="21c93-316">`AdminBasePage` może następnie zastępować `SetMasterPageFile` i ustawić `MasterPageFile` obiektu `Page` na wartość zakodowaną "~/Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="21c93-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="21c93-317">W ten sposób każda Strona, która pochodzi od `AdminBasePage` będzie używać `AdminNested.master`, natomiast każda Strona, która pochodzi od `BasePage` będzie miała Właściwość `MasterPageFile` ustawioną dynamicznie na "~/site.master" lub "~/Alternate.master" na podstawie wartości zmiennej sesji `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="21c93-318">Zacznij od dodania nowego pliku klasy do folderu `App_Code` o nazwie `AdminBasePage.cs`.</span><span class="sxs-lookup"><span data-stu-id="21c93-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.cs`.</span></span> <span data-ttu-id="21c93-319">`AdminBasePage` zwiększyć `BasePage`, a następnie Zastąp metodę `SetMasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="21c93-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="21c93-320">W tej metodzie Przypisz `MasterPageFile` wartość "~/Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="21c93-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="21c93-321">Po wprowadzeniu tych zmian plik klasy powinien wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="21c93-321">After making these changes your class file should look similar to the following:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample11.cs)]

<span data-ttu-id="21c93-322">Teraz musimy mieć istniejące strony zawartości w sekcji Administracja, które pochodzą od `AdminBasePage`, a nie `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="21c93-323">Przejdź do pliku klasy związanej z kodem dla każdej strony zawartości w folderze `~/Admin` i wprowadź tę zmianę.</span><span class="sxs-lookup"><span data-stu-id="21c93-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="21c93-324">Na przykład w `~/Admin/Default.aspx` zmienić deklarację klasy związanej z kodem z:</span><span class="sxs-lookup"><span data-stu-id="21c93-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample12.cs)]

<span data-ttu-id="21c93-325">Do:</span><span class="sxs-lookup"><span data-stu-id="21c93-325">To:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample13.cs)]

<span data-ttu-id="21c93-326">Rysunek 11 przedstawia sposób, w jaki strona wzorcowa najwyższego poziomu (`Site.master` lub `Alternate.master`), zagnieżdżona Strona wzorcowa (`AdminNested.master`) i strony zawartości sekcji administracyjnej są powiązane ze sobą.</span><span class="sxs-lookup"><span data-stu-id="21c93-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>

<span data-ttu-id="21c93-327">[![zagnieżdżona Strona wzorcowa definiuje zawartość specyficzną dla stron w sekcji Administracja.](nested-master-pages-cs/_static/image32.png)](nested-master-pages-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-cs/_static/image32.png)](nested-master-pages-cs/_static/image31.png)</span></span>

<span data-ttu-id="21c93-328">**Ilustracja 11**. zagnieżdżona Strona wzorcowa definiuje zawartość specyficzną dla stron w sekcji Administracja ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-cs/_static/image33.png))</span></span>

## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="21c93-329">Krok 6. dublowanie metod i właściwości publicznej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="21c93-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="21c93-330">Należy przypomnieć, że strony `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` współdziałają programowo ze stroną wzorcową: `~/Admin/AddProduct.aspx` wywołuje metodę `RefreshRecentProductsGrid` publiczną strony wzorcowej i ustawia jej Właściwość `GridMessageText`. `~/Admin/Products.aspx` ma procedurę obsługi zdarzeń dla zdarzenia `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="21c93-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="21c93-331">W poprzednim samouczku utworzyliśmy abstrakcyjną klasę `BaseMasterPage`, która definiuje te publiczne elementy członkowskie.</span><span class="sxs-lookup"><span data-stu-id="21c93-331">In the preceding tutorial we created an abstract `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="21c93-332">Na stronach `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` przyjęto założenie, że ich Strona główna pochodzi z klasy `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="21c93-333">Jednak strona `AdminNested.master`, obecnie rozszerza klasę `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="21c93-334">W związku z tym podczas odwiedzania `~/Admin/Products.aspx` `InvalidCastException` zostanie zgłoszony komunikat: "nie można rzutować obiektu typu" ASP. Admin\_adminnested\_Master "na typ" BaseMasterPage "."</span><span class="sxs-lookup"><span data-stu-id="21c93-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="21c93-335">Aby rozwiązać ten problem, musimy mieć `AdminNested.master` klasy związanej z kodem `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="21c93-336">Aktualizowanie deklaracji klasy zagnieżdżonej strony wzorcowej z:</span><span class="sxs-lookup"><span data-stu-id="21c93-336">Update the nested master page's code-behind class declaration from:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample14.cs)]

<span data-ttu-id="21c93-337">Do:</span><span class="sxs-lookup"><span data-stu-id="21c93-337">To:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample15.cs)]

<span data-ttu-id="21c93-338">Nie zostało to jeszcze zrobione.</span><span class="sxs-lookup"><span data-stu-id="21c93-338">We're not done yet.</span></span> <span data-ttu-id="21c93-339">Ponieważ Klasa `BaseMasterPage` jest abstrakcyjna, musimy zastąpić `abstract` elementy członkowskie, `RefreshRecentProductsGrid` i `GridMessageText`.</span><span class="sxs-lookup"><span data-stu-id="21c93-339">Because the `BaseMasterPage` class is abstract, we need to override the `abstract` members, `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="21c93-340">Te elementy członkowskie są używane przez strony wzorcowe najwyższego poziomu do aktualizowania interfejsów użytkownika.</span><span class="sxs-lookup"><span data-stu-id="21c93-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="21c93-341">(W rzeczywistości tylko strona wzorcowa `Site.master` używa tych metod, mimo że obie strony wzorcowe najwyższego poziomu implementują te metody, ponieważ oba rozszerzone `BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="21c93-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="21c93-342">Chociaż musimy zaimplementować te elementy członkowskie w `AdminNested.master`, wszystkie te implementacje muszą po prostu wywołać ten sam element członkowski na stronie wzorcowej najwyższego poziomu używanej przez zagnieżdżoną stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="21c93-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="21c93-343">Na przykład, gdy strona zawartości w sekcji Administracja wywołuje metodę `RefreshRecentProductsGrid` zagnieżdżonej strony wzorcowej, cała zagnieżdżona Strona wzorcowa musi mieć wartość, z kolei wywołać metodę `Site.master` lub `Alternate.master``RefreshRecentProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="21c93-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="21c93-344">Aby to osiągnąć, Zacznij od dodania następującej dyrektywy `@MasterType` w górnej części `AdminNested.master`:</span><span class="sxs-lookup"><span data-stu-id="21c93-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample16.aspx)]

<span data-ttu-id="21c93-345">Odwołaj, że dyrektywa `@MasterType` dodaje silnie wpisaną właściwość do klasy związanej z kodem o nazwie `Master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="21c93-346">Następnie zastąp `RefreshRecentProductsGrid` i `GridMessageText` członków i po prostu Deleguj wywołanie do odpowiedniej metody `Master`:</span><span class="sxs-lookup"><span data-stu-id="21c93-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample17.cs)]

<span data-ttu-id="21c93-347">Mając ten kod na miejscu, powinno być możliwe odwiedzenie i użycie stron zawartości w sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="21c93-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="21c93-348">Na rysunku 12 przedstawiono stronę `~/Admin/Products.aspx` wyświetlaną w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="21c93-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="21c93-349">Jak widać, Strona zawiera pole instrukcji administracyjnych zdefiniowane na zagnieżdżonej stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="21c93-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>

<span data-ttu-id="21c93-350">[![strony zawartości w sekcji Administracja zawierają instrukcje w górnej części każdej strony](nested-master-pages-cs/_static/image35.png)](nested-master-pages-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-cs/_static/image35.png)](nested-master-pages-cs/_static/image34.png)</span></span>

<span data-ttu-id="21c93-351">**Ilustracja 12**. strony zawartości w sekcji Administracja zawierają instrukcje w górnej części każdej strony ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-cs/_static/image36.png))</span></span>

## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="21c93-352">Krok 7. Korzystanie z odpowiedniej strony wzorcowej najwyższego poziomu w środowisku uruchomieniowym</span><span class="sxs-lookup"><span data-stu-id="21c93-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="21c93-353">Mimo że wszystkie strony zawartości w sekcji Administracja są w pełni funkcjonalne, wszystkie używają tej samej strony wzorcowej najwyższego poziomu i ignorują stronę wzorcową wybraną przez użytkownika na `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="21c93-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="21c93-354">To zachowanie jest spowodowane faktem, że zagnieżdżona Strona wzorcowa ma swoją właściwość `MasterPageFile` statycznie ustawiona na `Site.master` w `<%@ Master %>` dyrektywie.</span><span class="sxs-lookup"><span data-stu-id="21c93-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="21c93-355">Aby użyć strony wzorcowej najwyższego poziomu wybranej przez użytkownika końcowego, musimy ustawić właściwość `MasterPageFile` `AdminNested.master`na wartość w zmiennej sesji `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="21c93-356">Ze względu na to, że ustawimy właściwości `MasterPageFile` stron zawartości w `BasePage`, możesz zastanowić się, że ustawimy Właściwość `MasterPageFile` zagnieżdżonej strony wzorcowej w `BaseMasterPage` lub w klasie z kodem związanym `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="21c93-357">Nie będzie to jednak konieczne, ponieważ musimy ustawić właściwość `MasterPageFile` na końcu etapu wstępnego inicjowania.</span><span class="sxs-lookup"><span data-stu-id="21c93-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="21c93-358">Najwcześniejszy czas, który można programistycznie nacisnąć w cyklu życia strony z strony wzorcowej, to etap inicjowania (który występuje po etapie inicjowania wstępnego).</span><span class="sxs-lookup"><span data-stu-id="21c93-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="21c93-359">W związku z tym musimy ustawić właściwość `MasterPageFile` zagnieżdżonej strony wzorcowej na stronach zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="21c93-360">Jedyne strony zawartości, które używają `AdminNested.master` stronie wzorcowej, pochodzą z `AdminBasePage`.</span><span class="sxs-lookup"><span data-stu-id="21c93-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="21c93-361">W związku z tym możemy umieścić tę logikę w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="21c93-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="21c93-362">W kroku 5 overrode metodę `SetMasterPageFile`, ustawiając właściwość `MasterPageFile` obiektu `Page` na wartość "~/Admin/AdminNested.master".</span><span class="sxs-lookup"><span data-stu-id="21c93-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the `Page` object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="21c93-363">Zaktualizuj `SetMasterPageFile`, aby również ustawić właściwość `MasterPageFile` strony wzorcowej na wynik przechowywany w sesji:</span><span class="sxs-lookup"><span data-stu-id="21c93-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample18.cs)]

<span data-ttu-id="21c93-364">Metoda `GetMasterPageFileFromSession`, która została dodana do klasy `BasePage` w poprzednim samouczku, zwraca odpowiednią ścieżkę pliku strony głównej na podstawie wartości zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="21c93-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="21c93-365">Po dokonaniu tej zmiany wybór strony głównej użytkownika przenosi się do sekcji Administracja.</span><span class="sxs-lookup"><span data-stu-id="21c93-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="21c93-366">Rysunek 13 przedstawia tę samą stronę co Rysunek 12, ale po zmianie przez użytkownika opcji wyboru strony wzorcowej na `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="21c93-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>

<span data-ttu-id="21c93-367">[![zagnieżdżona Strona administracyjna używa strony wzorcowej najwyższego poziomu wybranej przez użytkownika](nested-master-pages-cs/_static/image38.png)](nested-master-pages-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="21c93-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-cs/_static/image38.png)](nested-master-pages-cs/_static/image37.png)</span></span>

<span data-ttu-id="21c93-368">**Ilustracja 13**. zagnieżdżona Strona administracyjna używa strony wzorcowej najwyższego poziomu wybranej przez użytkownika ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](nested-master-pages-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="21c93-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-cs/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="21c93-369">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="21c93-369">Summary</span></span>

<span data-ttu-id="21c93-370">Podobnie jak strony zawartości mogą być powiązane z stroną wzorcową, możliwe jest utworzenie zagnieżdżonych stron wzorcowych, gdy podrzędna Strona wzorcowa jest powiązana z nadrzędną stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="21c93-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="21c93-371">Podrzędna Strona wzorcowa może definiować kontrolki zawartości dla wszystkich elementów ContentPlaceHolder swojego elementu nadrzędnego; może wtedy dodać własne kontrolki ContentPlaceHolder (a także inne znaczniki) do tych kontrolek zawartości.</span><span class="sxs-lookup"><span data-stu-id="21c93-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="21c93-372">Zagnieżdżone strony wzorcowe są bardzo przydatne w dużych aplikacjach sieci Web, w których wszystkie strony współdzielą wygląd i działanie, ale pewne sekcje lokacji wymagają unikatowych dostosowań.</span><span class="sxs-lookup"><span data-stu-id="21c93-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="21c93-373">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="21c93-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="21c93-374">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="21c93-374">Further Reading</span></span>

<span data-ttu-id="21c93-375">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="21c93-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="21c93-376">Zagnieżdżone strony wzorcowe ASP.NET</span><span class="sxs-lookup"><span data-stu-id="21c93-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="21c93-377">Wskazówki dotyczące zagnieżdżonych stron wzorcowych i czasu projektowania programu VS 2005</span><span class="sxs-lookup"><span data-stu-id="21c93-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="21c93-378">Obsługa zagnieżdżonej strony głównej VS 2008</span><span class="sxs-lookup"><span data-stu-id="21c93-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="21c93-379">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="21c93-379">About the Author</span></span>

<span data-ttu-id="21c93-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor wielu książek ASP/ASP. NET Books i założyciel of 4GuysFromRolla.com, pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="21c93-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="21c93-381">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="21c93-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="21c93-382">Jego Najnowsza książka to [*Sams ASP.NET 3,5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="21c93-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="21c93-383">Scott można uzyskać w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem swojego blogu w [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="21c93-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="21c93-384">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="21c93-384">Special Thanks To</span></span>

<span data-ttu-id="21c93-385">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="21c93-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="21c93-386">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="21c93-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="21c93-387">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="21c93-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="21c93-388">[Poprzednie](specifying-the-master-page-programmatically-cs.md)
> [dalej](creating-a-site-wide-layout-using-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="21c93-388">[Previous](specifying-the-master-page-programmatically-cs.md)
[Next](creating-a-site-wide-layout-using-master-pages-vb.md)</span></span>
