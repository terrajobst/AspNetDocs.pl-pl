---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Programistyczne Określanie strony wzorcowej (VB) | Microsoft Docs
author: rick-anderson
description: Umożliwia programistyczne Ustawianie strony głównej zawartości za pośrednictwem programu obsługi zdarzeń przed inicjalizacją.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78567012"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="e75e3-103">Programowe określanie strony wzorcowej (VB)</span><span class="sxs-lookup"><span data-stu-id="e75e3-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="e75e3-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e75e3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e75e3-105">[Pobierz kod](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) lub [Pobierz plik PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="e75e3-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="e75e3-106">Umożliwia programistyczne Ustawianie strony głównej zawartości za pośrednictwem programu obsługi zdarzeń przed inicjalizacją.</span><span class="sxs-lookup"><span data-stu-id="e75e3-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="e75e3-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="e75e3-107">Introduction</span></span>

<span data-ttu-id="e75e3-108">Ponieważ przykład Inaugural w [*tworzeniu układu dla całej witryny za pomocą stron wzorcowych*](creating-a-site-wide-layout-using-master-pages-vb.md), wszystkie strony zawartości odwołują się do ich strony głównej w sposób deklaratywny za pośrednictwem atrybutu `MasterPageFile` w dyrektywie `@Page`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="e75e3-109">Na przykład następująca dyrektywa `@Page` łączy stronę zawartości ze stroną wzorcową `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="e75e3-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="e75e3-110">[Klasa`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx) w przestrzeni nazw `System.Web.UI` zawiera [Właściwość`MasterPageFile`](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) , która zwraca ścieżkę do strony wzorcowej strony zawartości; jest to właściwość, która jest ustawiana za pomocą dyrektywy `@Page`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="e75e3-111">Ta właściwość może również służyć do programistycznego określania strony głównej strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="e75e3-112">Takie podejście jest przydatne, jeśli chcesz dynamicznie przypisać stronę wzorcową w oparciu o czynniki zewnętrzne, takie jak użytkownik odwiedzający stronę.</span><span class="sxs-lookup"><span data-stu-id="e75e3-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="e75e3-113">W tym samouczku dodamy drugą stronę wzorcową do naszej witryny sieci Web i dynamicznie decyduje, która strona wzorcowa ma być używana w środowisku uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="e75e3-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="e75e3-114">Krok 1. sprawdzenie cyklu życia strony</span><span class="sxs-lookup"><span data-stu-id="e75e3-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="e75e3-115">Za każdym razem, gdy żądanie dociera do serwera sieci Web dla strony ASP.NET, która jest stroną zawartości, aparat ASP.NET musi odrzucić kontrolki zawartości strony do odpowiednich kontrolek ContentPlaceHolder na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="e75e3-116">Ta Fusion tworzy pojedynczą hierarchię formantów, która może następnie przechodzić przez typowy cykl życia strony.</span><span class="sxs-lookup"><span data-stu-id="e75e3-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="e75e3-117">Rysunek 1 ilustruje tę syntezę.</span><span class="sxs-lookup"><span data-stu-id="e75e3-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="e75e3-118">Krok 1 na rysunku 1 pokazuje początkową zawartość i hierarchie formantów stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="e75e3-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="e75e3-119">Na końcu końcowego etapu wstępnego inicjowania kontrolki zawartości na stronie są dodawane do odpowiednich elementów ContentPlaceHolders na stronie wzorcowej (krok 2).</span><span class="sxs-lookup"><span data-stu-id="e75e3-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="e75e3-120">Po tej syntezie Strona wzorcowa służy jako katalog główny hierarchii formantów.</span><span class="sxs-lookup"><span data-stu-id="e75e3-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="e75e3-121">Ta hierarchia formantów jest następnie dodawana do strony, aby utworzyć końcową hierarchię formantów (krok 3).</span><span class="sxs-lookup"><span data-stu-id="e75e3-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="e75e3-122">Wynikiem jest fakt, że hierarchia formantów strony obejmuje hierarchię formantów, która ma odmowę.</span><span class="sxs-lookup"><span data-stu-id="e75e3-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="e75e3-123">[![hierarchie formantów strony wzorcowej i zawartości są odrzucane razem podczas etapu wstępnego inicjowania](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="e75e3-124">**Ilustracja 01**: hierarchie formantów strony wzorcowej i zawartości są odrzucane razem z etapem wstępnego inicjowania ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="e75e3-125">Krok 2. Ustawianie właściwości`MasterPageFile`z kodu</span><span class="sxs-lookup"><span data-stu-id="e75e3-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="e75e3-126">Partakes strony wzorcowej w ramach tej syntezy zależy od wartości właściwości `MasterPageFile` obiektu `Page`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="e75e3-127">Ustawienie atrybutu `MasterPageFile` w dyrektywie `@Page` ma efekt netto przypisywania właściwości `MasterPageFile` `Page`podczas etapu inicjowania, który jest pierwszym etapem cyklu życia strony.</span><span class="sxs-lookup"><span data-stu-id="e75e3-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="e75e3-128">Możemy również programowo ustawić tę właściwość.</span><span class="sxs-lookup"><span data-stu-id="e75e3-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="e75e3-129">Jednak należy pamiętać, że ta właściwość jest ustawiona przed zastosowaniem fuzji na rysunku 1.</span><span class="sxs-lookup"><span data-stu-id="e75e3-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="e75e3-130">Na początku etapu wstępnego inicjowania obiekt `Page` wywołuje jego [zdarzenie`PreInit`](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) i wywołuje jego [metodę`OnPreInit`](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span><span class="sxs-lookup"><span data-stu-id="e75e3-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="e75e3-131">Aby programowo ustawić stronę wzorcową, można utworzyć procedurę obsługi zdarzeń dla zdarzenia `PreInit` lub zastąpić metodę `OnPreInit`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="e75e3-132">Przyjrzyjmy się obu podejściem.</span><span class="sxs-lookup"><span data-stu-id="e75e3-132">Let's look at both approaches.</span></span>

<span data-ttu-id="e75e3-133">Zacznij od otwarcia `Default.aspx.vb`, pliku klasy związanej z kodem dla strony głównej witryny.</span><span class="sxs-lookup"><span data-stu-id="e75e3-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="e75e3-134">Dodaj program obsługi zdarzeń dla zdarzenia `PreInit` strony, wpisując następujący kod:</span><span class="sxs-lookup"><span data-stu-id="e75e3-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="e75e3-135">W tym miejscu możemy ustawić właściwość `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="e75e3-136">Zaktualizuj kod, tak aby przypisywać wartość "~/site.master" do właściwości `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="e75e3-137">Jeśli ustawisz punkt przerwania i zaczniesz od debugowania, zobaczysz, że za każdym razem, gdy zostanie wyświetlona strona `Default.aspx` lub gdy na tej stronie znajduje się odświeżenie, zostanie wykonana procedura obsługi zdarzeń `Page_PreInit`, a właściwość `MasterPageFile` zostanie przypisana do "~/site.master".</span><span class="sxs-lookup"><span data-stu-id="e75e3-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="e75e3-138">Alternatywnie można przesłonić metodę `OnPreInit` klasy `Page` i ustawić właściwość `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="e75e3-139">Na potrzeby tego przykładu nie ustawimy strony wzorcowej na określonej stronie, ale zamiast `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="e75e3-140">Odwołaj, że utworzyliśmy niestandardową klasę strony podstawowej (`BasePage`) z powrotem w [*temacie Określanie tytułu, Meta tagów i innych nagłówków HTML na stronie wzorcowej*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="e75e3-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="e75e3-141">Obecnie `BasePage` przesłania metodę `OnLoadComplete` klasy `Page`, w której ustawia właściwość `Title` strony na podstawie danych mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="e75e3-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="e75e3-142">Zaktualizujmy `BasePage`, aby przesłonić również metodę `OnPreInit`, aby programowo określić stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="e75e3-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="e75e3-143">Ze względu na to, że wszystkie strony zawartości pochodzą z `BasePage`, wszystkie z nich są teraz przypisane do programu programowo.</span><span class="sxs-lookup"><span data-stu-id="e75e3-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="e75e3-144">W tym momencie program obsługi zdarzeń `PreInit` w `Default.aspx.vb` jest zbędny; Możesz go usunąć.</span><span class="sxs-lookup"><span data-stu-id="e75e3-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="e75e3-145">Co z dyrektywą`@Page`?</span><span class="sxs-lookup"><span data-stu-id="e75e3-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="e75e3-146">To, co może być nieco mylące, jest to, że właściwości strony zawartości `MasterPageFile` są teraz określane w dwóch miejscach: programowo w metodzie `OnPreInit` klasy `BasePage`, a także przy użyciu atrybutu `MasterPageFile` w dyrektywie `@Page`ej każdej strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="e75e3-147">Pierwszy etap cyklu życia strony jest etapem inicjalizacji.</span><span class="sxs-lookup"><span data-stu-id="e75e3-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="e75e3-148">Podczas tego etapu Właściwość `MasterPageFile` obiektu `Page` ma przypisaną wartość atrybutu `MasterPageFile` w dyrektywie `@Page` (jeśli jest dostępna).</span><span class="sxs-lookup"><span data-stu-id="e75e3-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="e75e3-149">Etap wstępnego inicjowania jest zgodny z etapem inicjalizacji. w tym miejscu można programowo ustawić właściwość `MasterPageFile` obiektu `Page`, zastępując wartość przypisaną z `@Page` dyrektywie.</span><span class="sxs-lookup"><span data-stu-id="e75e3-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="e75e3-150">Ponieważ ustawiamy Właściwość `MasterPageFile` obiektu `Page` programowo, można usunąć atrybut `MasterPageFile` z dyrektywy `@Page` bez wpływu na środowisko użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="e75e3-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="e75e3-151">Aby przekonać się, jak to zrobić, Usuń atrybut `MasterPageFile` z `@Page` dyrektywy w `Default.aspx` a następnie odwiedź stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="e75e3-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="e75e3-152">Zgodnie z oczekiwaniami, dane wyjściowe są takie same jak przed usunięciem atrybutu.</span><span class="sxs-lookup"><span data-stu-id="e75e3-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="e75e3-153">Czy właściwość `MasterPageFile` jest ustawiana za pośrednictwem dyrektywy `@Page` lub programowo jest w sposób niewzględny dla środowiska użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="e75e3-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="e75e3-154">Jednak atrybut `MasterPageFile` w dyrektywie `@Page` jest używany przez program Visual Studio podczas projektowania, aby utworzyć widok WYSIWYG w projektancie.</span><span class="sxs-lookup"><span data-stu-id="e75e3-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="e75e3-155">Jeśli powrócisz do `Default.aspx` w programie Visual Studio i przejdziesz do projektanta, zobaczysz komunikat "błąd strony głównej: Strona zawiera kontrolki wymagające odwołania do strony głównej, ale żadna nie jest określona" (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="e75e3-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="e75e3-156">Krótko mówiąc, należy pozostawić atrybut `MasterPageFile` w dyrektywie `@Page`, aby uzyskać bogate środowisko projektowania w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e75e3-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="e75e3-157">[![Visual Studio używa atrybutu MasterPageFile dyrektywy @Page w celu renderowania widoku projektu](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="e75e3-158">**Ilustracja 02**: program Visual Studio używa atrybutu `MasterPageFile` dyrektywy `@Page`, aby renderować widok projektu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="e75e3-159">Krok 3. Tworzenie alternatywnej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="e75e3-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="e75e3-160">Ze względu na to, że strona wzorcowa strony zawartości może być ustawiana programowo w czasie wykonywania, możliwe jest dynamiczne ładowanie konkretnej strony wzorcowej na podstawie niektórych zewnętrznych kryteriów.</span><span class="sxs-lookup"><span data-stu-id="e75e3-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="e75e3-161">Ta funkcja może być przydatna w sytuacjach, w których układ witryny musi się różnić w zależności od użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e75e3-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="e75e3-162">Na przykład aplikacja sieci Web aparatu blogów może umożliwić użytkownikom wybranie układu dla swojego blogu, gdzie każdy układ jest skojarzony z inną stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="e75e3-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="e75e3-163">W czasie wykonywania, gdy gość przegląda blog użytkownika, aplikacja sieci Web musi określić układ blogu i dynamicznie skojarzyć odpowiednią stronę wzorcową ze stroną zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="e75e3-164">Sprawdźmy, jak dynamicznie ładować stronę wzorcową w czasie wykonywania na podstawie niektórych zewnętrznych kryteriów.</span><span class="sxs-lookup"><span data-stu-id="e75e3-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="e75e3-165">Nasza witryna sieci Web obecnie zawiera tylko jedną stronę wzorcową (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="e75e3-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="e75e3-166">Potrzebujemy innej strony wzorcowej, aby zilustrować wybór strony wzorcowej w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="e75e3-167">Ten krok koncentruje się na tworzeniu i konfigurowaniu nowej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="e75e3-168">Krok 4 pozwala określić, która strona wzorcowa ma być używana w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="e75e3-169">Utwórz nową stronę wzorcową w folderze głównym o nazwie `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="e75e3-170">Dodaj również nowy arkusz stylów do witryny sieci Web o nazwie `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="e75e3-171">[![dodać kolejną stronę wzorcową i plik CSS do witryny sieci Web](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="e75e3-172">**Ilustracja 03**: Dodawanie kolejnej strony wzorcowej i pliku CSS do witryny sieci Web ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="e75e3-173">Zaprojektowano stronę wzorcową `Alternate.master`, aby tytuł był wyświetlany w górnej części strony, wyorodkowany i na granatowym tle.</span><span class="sxs-lookup"><span data-stu-id="e75e3-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="e75e3-174">Mam z lewej kolumny i przeniesiono tę zawartość poniżej kontrolki `MainContent` ContentPlaceHolder, która teraz obejmuje całą szerokość strony.</span><span class="sxs-lookup"><span data-stu-id="e75e3-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="e75e3-175">Ponadto nixed listę nieuporządkowanych lekcji i zastąpiono ją listą poziomą powyżej `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="e75e3-176">Zaktualizowano także czcionki i kolory używane przez stronę wzorcową (i przez rozszerzenie, strony zawartości).</span><span class="sxs-lookup"><span data-stu-id="e75e3-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="e75e3-177">Rysunek 4 przedstawia `Default.aspx` podczas korzystania ze strony wzorcowej `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="e75e3-178">ASP.NET obejmuje możliwość definiowania *motywów*.</span><span class="sxs-lookup"><span data-stu-id="e75e3-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="e75e3-179">Motyw to zbiór obrazów, plików CSS oraz ustawień właściwości kontrolki sieci Web, które można zastosować do strony w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="e75e3-180">Motywy są sposobem na przechodzenie, jeśli układy witryny różnią się tylko w obrazach wyświetlanych i według ich reguł CSS.</span><span class="sxs-lookup"><span data-stu-id="e75e3-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="e75e3-181">Jeśli układy różnią się znacznie, na przykład przy użyciu różnych kontrolek sieci Web lub mających radykalnie inny układ, należy użyć oddzielnych stron wzorcowych.</span><span class="sxs-lookup"><span data-stu-id="e75e3-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="e75e3-182">Aby uzyskać więcej informacji na temat motywów, zapoznaj się z sekcją dalsze informacje na końcu tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="e75e3-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="e75e3-183">[![naszej stronie zawartości można teraz używać nowego wyglądu i działania](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="e75e3-184">**Rysunek 04**: strony zawartości mogą teraz korzystać z nowego wyglądu i sposobu działania ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="e75e3-185">Gdy znaczniki strony głównej i zawartości są odrzucane, Klasa `MasterPage` sprawdza, czy każda kontrolka zawartości na stronie zawartości odwołuje się do elementu ContentPlaceHolder na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="e75e3-186">Wyjątek jest zgłaszany, jeśli znaleziono kontrolkę zawartości odwołującą się do nieistniejącego elementu ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="e75e3-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="e75e3-187">Innymi słowy, jest to konieczne, aby strona wzorcowa przypisana do strony zawartości zawierała element ContentPlaceHolder dla każdej kontrolki zawartości na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="e75e3-188">Strona wzorcowa `Site.master` zawiera cztery kontrolki ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="e75e3-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="e75e3-189">Niektóre strony zawartości w naszej witrynie sieci Web zawierają tylko jedną lub dwie kontrolki zawartości; inne osoby zawierają kontrolkę zawartości dla każdego z dostępnych elementów ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="e75e3-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="e75e3-190">Jeśli Twoja nowa strona wzorcowa (`Alternate.master`) może zostać kiedykolwiek przypisana do tych stron zawartości, które mają kontrolki zawartości dla wszystkich elementów ContentPlaceHolder w `Site.master`, jest to niezbędne, aby `Alternate.master` również obejmowały te same kontrolki ContentPlaceHolder jako `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="e75e3-191">Aby uzyskać `Alternate.master` stronę wzorcową podobną do kopalni (zobacz rysunek 4), Zacznij od zdefiniowania stylów strony wzorcowej w `AlternateStyles.css` arkuszu stylów.</span><span class="sxs-lookup"><span data-stu-id="e75e3-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="e75e3-192">Dodaj następujące reguły do `AlternateStyles.css`:</span><span class="sxs-lookup"><span data-stu-id="e75e3-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="e75e3-193">Następnie Dodaj następujące deklaratywne znaczniki do `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="e75e3-194">Jak widać, `Alternate.master` zawiera cztery kontrolki ContentPlaceHolder z tymi samymi wartościami `ID`, co elementy sterujące elementów ContentPlaceHolder w `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="e75e3-195">Ponadto zawiera kontrolkę ScriptManager, która jest niezbędna dla tych stron w naszej witrynie sieci Web, które używają ASP.NET AJAX Framework.</span><span class="sxs-lookup"><span data-stu-id="e75e3-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="e75e3-196">Testowanie nowej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="e75e3-196">Testing the New Master Page</span></span>

<span data-ttu-id="e75e3-197">Aby przetestować tę nową stronę wzorcową, zaktualizuj metodę `OnPreInit` klasy `BasePage`, tak aby Właściwość `MasterPageFile` była przypisana do wartości `"~/Alternate.maser"` a następnie odwiedź witrynę internetową.</span><span class="sxs-lookup"><span data-stu-id="e75e3-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="e75e3-198">Każda Strona powinna działać bez błędów z wyjątkiem dwóch: `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="e75e3-199">Dodanie produktu do widoku DetailsView w `~/Admin/AddProduct.aspx` powoduje `NullReferenceException` z wiersza kodu, który próbuje ustawić właściwość `GridMessageText` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="e75e3-200">Podczas odwiedzania `~/Admin/Products.aspx` `InvalidCastException` jest generowany podczas ładowania strony z komunikatem: "nie można rzutować obiektu typu" ASP. alternatywny\_Master "na typ" ASP. site\_Master "."</span><span class="sxs-lookup"><span data-stu-id="e75e3-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="e75e3-201">Te błędy występują, ponieważ Klasa `Site.master` związane z kodem zawiera publiczne zdarzenia, właściwości i metody, które nie są zdefiniowane w `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="e75e3-202">Część znaczników tych dwóch stron ma `@MasterType` dyrektywę odwołującą się do `Site.master` strony głównej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="e75e3-203">Ponadto moduł obsługi zdarzeń `ItemInserted` DetailsView w programie `~/Admin/AddProduct.aspx` zawiera kod, który rzutuje luźno wpisaną Właściwość `Page.Master` na obiekt typu `Site`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="e75e3-204">Dyrektywa `@MasterType` (w ten sposób używana) oraz Rzutowanie w programie obsługi zdarzeń `ItemInserted` ściśle Couples strony `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` na stronę wzorcową `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="e75e3-205">Aby przerwać ten ścisły sprzęg, możemy `Site.master` i `Alternate.master` pochodzić od wspólnej klasy bazowej, która zawiera definicje dla publicznych członków.</span><span class="sxs-lookup"><span data-stu-id="e75e3-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="e75e3-206">Poniżej można zaktualizować dyrektywę `@MasterType`, aby odwoływać się do tego wspólnego typu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="e75e3-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="e75e3-207">Tworzenie niestandardowej klasy podstawowej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="e75e3-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="e75e3-208">Dodaj nowy plik klasy do folderu `App_Code` o nazwie `BaseMasterPage.vb` i utwórz go od `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="e75e3-209">Musimy zdefiniować metodę `RefreshRecentProductsGrid` i Właściwość `GridMessageText` w `BaseMasterPage`, ale nie można po prostu przenieść ich z `Site.master`, ponieważ te elementy członkowskie współpracują z kontrolkami sieci Web, które są specyficzne dla `Site.master`ej strony wzorcowej (`RecentProducts` GridView i `GridMessage` etykieta).</span><span class="sxs-lookup"><span data-stu-id="e75e3-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="e75e3-210">Należy skonfigurować `BaseMasterPage` w taki sposób, aby te składowe zostały tam zdefiniowane, ale są faktycznie implementowane przez klasy pochodne `BaseMasterPage`(`Site.master` i `Alternate.master`).</span><span class="sxs-lookup"><span data-stu-id="e75e3-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="e75e3-211">Ten typ dziedziczenia jest możliwy poprzez oznaczenie klasy jako `MustInherit` i jej elementów członkowskich jako `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="e75e3-212">W skrócie, dodanie tych słów kluczowych do klasy i jej dwóch członków ogłasza, że `BaseMasterPage` nie zaimplementowano `RefreshRecentProductsGrid` i `GridMessageText`, ale te klasy pochodne będą.</span><span class="sxs-lookup"><span data-stu-id="e75e3-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="e75e3-213">Konieczne jest również zdefiniowanie zdarzenia `PricesDoubled` w `BaseMasterPage` i udostępnienie metod przez klasy pochodne w celu podniesienia zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="e75e3-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="e75e3-214">Wzorzec używany w .NET Framework do ułatwienia tego zachowania ma na celu utworzenie zdarzenia publicznego w klasie bazowej i dodanie chronionej, możliwej do zastąpienia metody o nazwie `OnEventName`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="e75e3-215">Klasy pochodne mogą następnie wywołać tę metodę w celu wypróbowania zdarzenia lub mogą zastąpić je, aby wykonać kod bezpośrednio przed wystąpieniem zdarzenia lub po nim.</span><span class="sxs-lookup"><span data-stu-id="e75e3-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="e75e3-216">Zaktualizuj swoją klasę `BaseMasterPage` tak, aby zawierała następujący kod:</span><span class="sxs-lookup"><span data-stu-id="e75e3-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="e75e3-217">Następnie przejdź do klasy `Site.master` związanej z kodem i utwórz ją z `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="e75e3-218">Ponieważ `BaseMasterPage` zawiera elementy członkowskie oznaczone `MustOverride` musimy przesłonić te elementy członkowskie tutaj w `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="e75e3-219">Dodaj słowo kluczowe `Overrides` do definicji metody i właściwości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="e75e3-220">Należy również zaktualizować kod, który wywołuje zdarzenie `PricesDoubled` w obsłudze zdarzeń `Click` przycisku `DoublePrice` z wywołaniem metody `OnPricesDoubled` klasy bazowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="e75e3-221">Po wprowadzeniu tych zmian Klasa `Site.master` z kodem powinna zawierać następujący kod:</span><span class="sxs-lookup"><span data-stu-id="e75e3-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="e75e3-222">Konieczna jest również aktualizacja klasy związanej z kodem `Alternate.master`, która dziedziczy po `BaseMasterPage` i przesłania dwa `MustOverride` członków.</span><span class="sxs-lookup"><span data-stu-id="e75e3-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="e75e3-223">Ale ponieważ `Alternate.master` nie zawiera widoku GridView zawierającego listę najnowszych produktów ani etykiety, która wyświetla komunikat po dodaniu nowego produktu do bazy danych, te metody nie muszą wykonywać żadnych czynności.</span><span class="sxs-lookup"><span data-stu-id="e75e3-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="e75e3-224">Odwoływanie się do klasy podstawowej strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="e75e3-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="e75e3-225">Po ukończeniu klasy `BaseMasterPage` i udostępnieniu przez nas dwóch stron wzorcowych ten ostatni krok polega na aktualizacji `~/Admin/AddProduct.aspx` i `~/Admin/Products.aspx` stron w celu odwoływania się do tego wspólnego typu.</span><span class="sxs-lookup"><span data-stu-id="e75e3-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="e75e3-226">Zacznij od zmiany dyrektywy `@MasterType` na obu stronach z:</span><span class="sxs-lookup"><span data-stu-id="e75e3-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="e75e3-227">Do:</span><span class="sxs-lookup"><span data-stu-id="e75e3-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="e75e3-228">Zamiast odwoływania się do ścieżki pliku Właściwość `@MasterType` teraz odwołuje się do typu podstawowego (`BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="e75e3-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="e75e3-229">W związku z tym silnie wpisaną Właściwość `Master` używana w klasach związanych z kodem w obu stronach jest teraz typu `BaseMasterPage` (zamiast typu `Site`).</span><span class="sxs-lookup"><span data-stu-id="e75e3-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="e75e3-230">Wraz z tą zmianą w miejscu należy ponownie odwiedzać `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="e75e3-231">Wcześniej spowodowało to błąd rzutowania, ponieważ strona jest skonfigurowana do używania strony wzorcowej `Alternate.master`, ale dyrektywa `@MasterType` odwołuje się do pliku `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="e75e3-232">Ale teraz Strona jest renderowana bez błędu.</span><span class="sxs-lookup"><span data-stu-id="e75e3-232">But now the page renders without error.</span></span> <span data-ttu-id="e75e3-233">Dzieje się tak, ponieważ strona wzorcowa `Alternate.master` może być rzutowana na obiekt typu `BaseMasterPage` (ponieważ rozszerza go).</span><span class="sxs-lookup"><span data-stu-id="e75e3-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="e75e3-234">Istnieje niewielkie zmiany, które należy wprowadzić w `~/Admin/AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="e75e3-235">Procedura obsługi zdarzeń `ItemInserted` formantu DetailsView używa właściwości `Master` o jednoznacznie określonym typie i właściwości `Page.Master` o swobodnym typie.</span><span class="sxs-lookup"><span data-stu-id="e75e3-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="e75e3-236">Podczas aktualizowania dyrektywy `@MasterType` Naprawiono odwołanie o jednoznacznie określonym typie, ale nadal trzeba zaktualizować odwołanie z określoną swobodną.</span><span class="sxs-lookup"><span data-stu-id="e75e3-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="e75e3-237">Zastąp następujący wiersz kodu:</span><span class="sxs-lookup"><span data-stu-id="e75e3-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="e75e3-238">Poniżej, który rzutuje `Page.Master` na typ podstawowy:</span><span class="sxs-lookup"><span data-stu-id="e75e3-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="e75e3-239">Krok 4. Określanie, którą stronę wzorcową powiązać ze stronami zawartości</span><span class="sxs-lookup"><span data-stu-id="e75e3-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="e75e3-240">Nasza Klasa `BasePage` obecnie ustawia wszystkie właściwości `MasterPageFile` strony zawartości na wartość zakodowaną w fazie wstępnego inicjowania cyklu życia strony.</span><span class="sxs-lookup"><span data-stu-id="e75e3-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="e75e3-241">Możemy zaktualizować ten kod, aby oprzeć stronę wzorcową w pewnym zewnętrznym składniku.</span><span class="sxs-lookup"><span data-stu-id="e75e3-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="e75e3-242">Być może załadowanie strony wzorcowej zależy od preferencji aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e75e3-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="e75e3-243">W takim przypadku musimy napisać kod w metodzie `OnPreInit` w `BasePage`, który wyszukuje preferencje strony wzorcowej aktualnie odwiedzanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e75e3-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="e75e3-244">Utwórzmy stronę sieci Web, która umożliwia użytkownikowi wybranie używanej strony wzorcowej — `Site.master` lub `Alternate.master` — i Zapisz ten wybór w zmiennej sesji.</span><span class="sxs-lookup"><span data-stu-id="e75e3-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="e75e3-245">Zacznij od utworzenia nowej strony sieci Web w katalogu głównym o nazwie `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="e75e3-246">Podczas tworzenia tej strony (lub innych stron zawartości odtąd) nie trzeba powiązać jej ze stroną wzorcową, ponieważ strona wzorcowa jest ustawiana programowo w `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="e75e3-247">Niemniej jednak, jeśli nowa strona nie zostanie powiązana ze stroną wzorcową, domyślne znaczniki deklaratywne nowej strony zawierają formularz sieci Web i inną zawartość dostarczoną przez stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="e75e3-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="e75e3-248">Musisz ręcznie zastąpić ten znacznik odpowiednimi kontrolkami zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="e75e3-249">Z tego powodu łatwiej jest utworzyć powiązanie nowej strony ASP.NET z stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="e75e3-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="e75e3-250">Ponieważ `Site.master` i `Alternate.master` mają ten sam zestaw elementów ContentPlaceHolder, nie ma znaczenia, którą stronę wzorcową wybrać podczas tworzenia nowej strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="e75e3-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="e75e3-251">W celu zapewnienia spójności zaleca się użycie `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="e75e3-252">[![dodać nową stronę zawartości do witryny sieci Web](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="e75e3-253">**Ilustracja 05**. Dodawanie nowej strony zawartości do witryny sieci Web ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="e75e3-254">Zaktualizuj plik `Web.sitemap`, aby zawierał wpis do tej lekcji.</span><span class="sxs-lookup"><span data-stu-id="e75e3-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="e75e3-255">Dodaj następujący znacznik poniżej `<siteMapNode>` dla stron wzorcowych i lekcji ASP.NET AJAX:</span><span class="sxs-lookup"><span data-stu-id="e75e3-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="e75e3-256">Przed dodaniem jakiejkolwiek zawartości do strony `ChooseMasterPage.aspx` Poświęć chwilę na zaktualizowanie klasy powiązanej z kodem strony, aby dziedziczyć ją po `BasePage` (a nie `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="e75e3-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="e75e3-257">Następnie Dodaj kontrolkę DropDownList do strony, ustaw jej Właściwość `ID` na `MasterPageChoice`i Dodaj dwa listy elementów z wartościami `Text` "~/site.master" i "~/Alternate.master".</span><span class="sxs-lookup"><span data-stu-id="e75e3-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="e75e3-258">Dodaj kontrolkę sieci Web przycisku do strony i ustaw jej `ID` i `Text` właściwości na `SaveLayout` i "Zapisz wybór układu".</span><span class="sxs-lookup"><span data-stu-id="e75e3-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="e75e3-259">W tym momencie znaczniki deklaratywne strony powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="e75e3-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="e75e3-260">Gdy strona jest najpierw odwiedzona, musi zostać wyświetlona wybrana strona wzorcowa.</span><span class="sxs-lookup"><span data-stu-id="e75e3-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="e75e3-261">Utwórz procedurę obsługi zdarzeń `Page_Load` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="e75e3-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="e75e3-262">Powyższy kod jest wykonywany tylko na pierwszej stronie odwiedzin (a nie na kolejnych ogłaszaniu zwrotnego).</span><span class="sxs-lookup"><span data-stu-id="e75e3-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="e75e3-263">Najpierw sprawdza, czy zmienna sesji `MyMasterPage` istnieje.</span><span class="sxs-lookup"><span data-stu-id="e75e3-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="e75e3-264">W takim przypadku próbuje znaleźć pasujący element ListItem w `MasterPageChoice` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="e75e3-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="e75e3-265">Jeśli zostanie znaleziony pasujący element ListItem, jego właściwość `Selected` jest ustawiona na `True`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="e75e3-266">Wymagany jest również kod, który zapisuje wybór użytkownika w zmiennej sesji `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="e75e3-267">Utwórz procedurę obsługi zdarzeń dla zdarzenia `Click` `SaveLayout` przycisku i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="e75e3-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="e75e3-268">O czas wykonywania procedury obsługi zdarzeń `Click` na ogłaszaniu zwrotnym Strona główna została już wybrana.</span><span class="sxs-lookup"><span data-stu-id="e75e3-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="e75e3-269">W związku z tym wybór listy rozwijanej użytkownika nie będzie obowiązywać do momentu odwiedzania następnej strony.</span><span class="sxs-lookup"><span data-stu-id="e75e3-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="e75e3-270">`Response.Redirect` Wymusza ponowne żądanie `ChooseMasterPage.aspx`przez przeglądarkę.</span><span class="sxs-lookup"><span data-stu-id="e75e3-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="e75e3-271">Po zakończeniu `ChooseMasterPage.aspx` stronie nasze końcowe zadanie ma mieć `BasePage` przypisać właściwość `MasterPageFile` na podstawie wartości zmiennej sesji `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="e75e3-272">Jeśli zmienna sesji nie jest ustawiona, ma `BasePage` domyślną `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="e75e3-273">Przeniesiono kod, który przypisuje Właściwość `MasterPageFile` obiektu `Page` z programu obsługi zdarzeń `OnPreInit` i do dwóch oddzielnych metod.</span><span class="sxs-lookup"><span data-stu-id="e75e3-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="e75e3-274">Ta pierwsza metoda, `SetMasterPageFile`, przypisuje Właściwość `MasterPageFile` do wartości zwracanej przez drugą metodę, `GetMasterPageFileFromSession`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="e75e3-275">Oznaczono metodę `SetMasterPageFile` `Overridable` tak, aby w przyszłości klasy rozszerzające `BasePage` można było opcjonalnie zastąpić je implementacją logiki niestandardowej, jeśli jest to konieczne.</span><span class="sxs-lookup"><span data-stu-id="e75e3-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="e75e3-276">Zobaczymy przykład zastąpienia właściwości `SetMasterPageFile` `BasePage`w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="e75e3-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="e75e3-277">Korzystając z tego kodu, odwiedź stronę `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e75e3-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="e75e3-278">Początkowo wybrana jest strona wzorcowa `Site.master` (zobacz rysunek 6), ale użytkownik może wybrać inną stronę wzorcową z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="e75e3-279">[![strony zawartości są wyświetlane przy użyciu strony wzorcowej witryny. Master](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="e75e3-280">**Ilustracja 06**. strony zawartości są wyświetlane przy użyciu strony wzorcowej `Site.master` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="e75e3-281">[![strony zawartości są teraz wyświetlane za pomocą alternatywnej strony wzorcowej wzorca](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e75e3-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="e75e3-282">**Ilustracja 07**: strony zawartości są teraz wyświetlane przy użyciu strony wzorcowej `Alternate.master` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="e75e3-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="e75e3-283">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="e75e3-283">Summary</span></span>

<span data-ttu-id="e75e3-284">Po odwiedzeniu strony zawartości, jej kontrolki zawartości są odrzucane przez kontrolki ContentPlaceHolder swojej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="e75e3-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="e75e3-285">Strona wzorcowa strony zawartości jest określana przez właściwość `MasterPageFile` klasy `Page`, która jest przypisana do atrybutu `MasterPageFile` dyrektywy `@Page` na etapie inicjowania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="e75e3-286">Jak pokazano w tym samouczku, można przypisać wartość do właściwości `MasterPageFile`, dopóki to zrobisz przed końcem etapu wstępnego inicjowania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="e75e3-287">Możliwość programowego określania strony wzorcowej otwiera drzwi dla bardziej zaawansowanych scenariuszy, takich jak dynamiczne wiązanie strony zawartości ze stroną wzorcową w oparciu o czynniki zewnętrzne.</span><span class="sxs-lookup"><span data-stu-id="e75e3-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="e75e3-288">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="e75e3-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="e75e3-289">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="e75e3-289">Further Reading</span></span>

<span data-ttu-id="e75e3-290">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="e75e3-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e75e3-291">Diagram cyklu życia strony ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e75e3-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="e75e3-292">ASP.NET cyklu życia strony</span><span class="sxs-lookup"><span data-stu-id="e75e3-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="e75e3-293">ASP.NET motywy i karnacje — Omówienie</span><span class="sxs-lookup"><span data-stu-id="e75e3-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="e75e3-294">Strony wzorcowe: porady, wskazówki i pułapki</span><span class="sxs-lookup"><span data-stu-id="e75e3-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="e75e3-295">Motywy w ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e75e3-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="e75e3-296">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="e75e3-296">About the Author</span></span>

<span data-ttu-id="e75e3-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor wielu książek ASP/ASP. NET Books i założyciel of 4GuysFromRolla.com, pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="e75e3-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e75e3-298">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="e75e3-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e75e3-299">Jego Najnowsza książka to [*Sams ASP.NET 3,5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e75e3-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="e75e3-300">Scott można uzyskać w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem swojego blogu w [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="e75e3-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="e75e3-301">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="e75e3-301">Special Thanks To</span></span>

<span data-ttu-id="e75e3-302">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="e75e3-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e75e3-303">Recenzent potencjalnych klientów dla tego samouczka został suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="e75e3-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="e75e3-304">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="e75e3-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e75e3-305">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e75e3-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e75e3-306">[Poprzednie](master-pages-and-asp-net-ajax-vb.md)
> [dalej](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e75e3-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
