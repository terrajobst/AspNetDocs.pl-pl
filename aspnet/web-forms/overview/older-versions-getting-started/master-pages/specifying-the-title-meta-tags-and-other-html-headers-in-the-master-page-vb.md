---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
title: Określanie tytułu, tagów Meta i innych nagłówków HTML na stronie wzorcowej (VB) | Microsoft Docs
author: rick-anderson
description: Analizuje różne techniki definiowania elementów &lt;&gt; na stronie wzorcowej ze strony zawartość.
ms.author: riande
ms.date: 05/21/2008
ms.assetid: ea8196f5-039d-43ec-8447-8997ad4d3900
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 160af664cdf27f9ede1273aaf915da749a39ad48
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74637726"
---
# <a name="specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb"></a><span data-ttu-id="a06d2-103">Określanie tytułu, tagów meta i innych nagłówków HTML na stronie wzorcowej (VB)</span><span class="sxs-lookup"><span data-stu-id="a06d2-103">Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page (VB)</span></span>

<span data-ttu-id="a06d2-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a06d2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a06d2-105">[Pobierz kod](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_03_VB.zip) lub [Pobierz plik PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_03_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="a06d2-105">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_03_VB.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_03_VB.pdf)</span></span>

> <span data-ttu-id="a06d2-106">Analizuje różne techniki definiowania elementów &lt;&gt; na stronie wzorcowej ze strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="a06d2-106">Looks at different techniques for defining assorted &lt;head&gt; elements in the Master Page from the content page.</span></span>

## <a name="introduction"></a><span data-ttu-id="a06d2-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="a06d2-107">Introduction</span></span>

<span data-ttu-id="a06d2-108">Nowe strony wzorcowe utworzone w programie Visual Studio 2008 mają domyślnie dwie kontrolki ContentPlaceHolder: jeden o nazwie `head`i znajduje się w elemencie `<head>`; i jeden nazwany `ContentPlaceHolder1`, umieszczony w formularzu sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a06d2-108">New master pages created in Visual Studio 2008 have, by default, two ContentPlaceHolder controls: one named `head`, and located in the `<head>` element; and one named `ContentPlaceHolder1`, placed within the Web Form.</span></span> <span data-ttu-id="a06d2-109">Celem `ContentPlaceHolder1` jest zdefiniowanie regionu w formularzu sieci Web, który można dostosować w zależności od strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-109">The purpose of `ContentPlaceHolder1` is to define a region in the Web Form that can be customized on a page-by-page basis.</span></span> <span data-ttu-id="a06d2-110">`head` ContentPlaceHolder umożliwia stronom Dodawanie zawartości niestandardowej do sekcji `<head>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-110">The `head` ContentPlaceHolder enables pages to add custom content to the `<head>` section.</span></span> <span data-ttu-id="a06d2-111">(Oczywiście te dwa elementy ContentPlaceHolder można modyfikować lub usuwać, a do strony głównej można dodawać dodatkowe elementy ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="a06d2-111">(Of course, these two ContentPlaceHolders can be modified or removed, and additional ContentPlaceHolder may be added to the master page.</span></span> <span data-ttu-id="a06d2-112">Nasza Strona główna, `Site.master`, ma obecnie cztery kontrolki ContentPlaceHolder.)</span><span class="sxs-lookup"><span data-stu-id="a06d2-112">Our master page, `Site.master`, currently has four ContentPlaceHolder controls.)</span></span>

<span data-ttu-id="a06d2-113">Element `<head>` HTML służy jako repozytorium informacji o dokumencie strony sieci Web, który nie jest częścią samego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="a06d2-113">The HTML `<head>` element serves as a repository for information about the web page document that is not part of the document itself.</span></span> <span data-ttu-id="a06d2-114">Obejmuje to takie informacje jak tytuł strony sieci Web, meta-informacje używane przez aparaty wyszukiwania lub wewnętrzne przeszukiwania oraz linki do zasobów zewnętrznych, takich jak źródła danych RSS, JavaScript i pliki CSS.</span><span class="sxs-lookup"><span data-stu-id="a06d2-114">This includes information such as the web page's title, meta-information used by search engines or internal crawlers, and links to external resources, such as RSS feeds, JavaScript, and CSS files.</span></span> <span data-ttu-id="a06d2-115">Niektóre z tych informacji mogą dotyczyć wszystkich stron w witrynie sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a06d2-115">Some of this information may be pertinent to all pages in the website.</span></span> <span data-ttu-id="a06d2-116">Na przykład możesz chcieć zaimportować globalne te same reguły CSS i pliki JavaScript dla każdej strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a06d2-116">For example, you might want to globally import the same CSS rules and JavaScript files for every ASP.NET page.</span></span> <span data-ttu-id="a06d2-117">Istnieją jednak części `<head>` elementu, które są specyficzne dla strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-117">However, there are portions of the `<head>` element that are page-specific.</span></span> <span data-ttu-id="a06d2-118">Tytuł strony jest głównym przykładem.</span><span class="sxs-lookup"><span data-stu-id="a06d2-118">The page title is a prime example.</span></span>

<span data-ttu-id="a06d2-119">W tym samouczku opisano sposób definiowania znaczników globalnych i specyficznych dla strony `<head>` na stronie wzorcowej i na stronach zawartości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-119">In this tutorial we examine how to define global and page-specific `<head>` section markup in the master page and in its content pages.</span></span>

## <a name="examining-the-master-pagesheadsection"></a><span data-ttu-id="a06d2-120">Badanie sekcji`<head>`strony wzorcowej</span><span class="sxs-lookup"><span data-stu-id="a06d2-120">Examining the Master Page's`<head>`Section</span></span>

<span data-ttu-id="a06d2-121">Domyślny plik strony głównej utworzony przez program Visual Studio 2008 zawiera następujące znaczniki w sekcji `<head>`:</span><span class="sxs-lookup"><span data-stu-id="a06d2-121">The default master page file created by Visual Studio 2008 contains the following markup in its `<head>` section:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample1.aspx)]

<span data-ttu-id="a06d2-122">Zauważ, że element `<head>` zawiera atrybut `runat="server"`, który wskazuje, że jest to formant serwera (zamiast statycznego kodu HTML).</span><span class="sxs-lookup"><span data-stu-id="a06d2-122">Notice that the `<head>` element contains a `runat="server"` attribute, which indicates that it is a server control (rather than static HTML).</span></span> <span data-ttu-id="a06d2-123">Wszystkie strony ASP.NET pochodzą z [klasy`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx), która znajduje się w przestrzeni nazw `System.Web.UI`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-123">All ASP.NET pages derive from the [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx), which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="a06d2-124">Ta klasa zawiera [właściwość`Header`](https://msdn.microsoft.com/library/system.web.ui.page.header.aspx) , która zapewnia dostęp do regionu `<head>` strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-124">This class contains a [`Header` property](https://msdn.microsoft.com/library/system.web.ui.page.header.aspx) that provides access to the page's `<head>` region.</span></span> <span data-ttu-id="a06d2-125">Za pomocą właściwości `Header` można ustawić tytuł strony ASP.NET lub dodać dodatkowe znaczniki do renderowanej `<head>` sekcji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-125">Using the `Header` property we can set an ASP.NET page's title or add additional markup to the rendered `<head>` section.</span></span> <span data-ttu-id="a06d2-126">Istnieje możliwość, że w celu dostosowania elementu `<head>` strony zawartości przez napisanie bitu kodu w programie obsługi zdarzeń `Page_Load` strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-126">It is possible, then, to customize a content page's `<head>` element by writing a bit of code in the page's `Page_Load` event handler.</span></span> <span data-ttu-id="a06d2-127">Sprawdzimy, jak programowo ustawić tytuł strony w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="a06d2-127">We examine how to programmatically set the page's title in Step 1.</span></span>

<span data-ttu-id="a06d2-128">Znaczniki wyświetlane w powyższym elemencie `<head>` zawierają również formant ContentPlaceHolder o nazwie `head`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-128">The markup shown in the `<head>` element above also includes a ContentPlaceHolder control named `head`.</span></span> <span data-ttu-id="a06d2-129">Ta kontrolka ContentPlaceHolder nie jest konieczna, ponieważ strony zawartości mogą programowo dodać zawartość niestandardową do elementu `<head>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-129">This ContentPlaceHolder control is not necessary, as content pages can add custom content to the `<head>` element programmatically.</span></span> <span data-ttu-id="a06d2-130">Jest to przydatne, jednak w sytuacjach, gdy strona zawartości musi dodać znacznik statyczny do `<head>` elementu, ponieważ oznakowanie statyczne może zostać dodane deklaratywnie do odpowiedniej kontrolki zawartości zamiast programowo.</span><span class="sxs-lookup"><span data-stu-id="a06d2-130">It's useful, however, in situations where a content page needs to add static markup to the `<head>` element as the static markup can be added declaratively to the corresponding Content control rather than programmatically.</span></span>

<span data-ttu-id="a06d2-131">Oprócz elementu `<title>` i `head` ContentPlaceHolder, element `<head>` strony wzorcowej powinien zawierać wszystkie znaczniki `<head>`na poziomie, które są wspólne dla wszystkich stron.</span><span class="sxs-lookup"><span data-stu-id="a06d2-131">In addition to the `<title>` element and `head` ContentPlaceHolder, the master page's `<head>` element should contain any `<head>`-level markup that's common to all pages.</span></span> <span data-ttu-id="a06d2-132">W naszej witrynie sieci Web wszystkie strony używają reguł CSS zdefiniowanych w pliku `Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-132">In our website, all pages use the CSS rules defined in the `Styles.css` file.</span></span> <span data-ttu-id="a06d2-133">W związku z tym Zaktualizowaliśmy element `<head>` w oknie [*Tworzenie układu dla całej witryny ze stronami wzorcowymi*](creating-a-site-wide-layout-using-master-pages-vb.md) w celu uwzględnienia odpowiedniego elementu `<link>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-133">Consequently, we updated the `<head>` element in the [*Creating a Site-Wide Layout with Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial to include a corresponding `<link>` element.</span></span> <span data-ttu-id="a06d2-134">Poniżej przedstawiono `Site.master` bieżącą `<head>`ą stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="a06d2-134">Our `Site.master` master page's current `<head>` markup is shown below.</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample2.aspx)]

## <a name="step-1-setting-a-content-pages-title"></a><span data-ttu-id="a06d2-135">Krok 1. Ustawianie tytułu strony zawartości</span><span class="sxs-lookup"><span data-stu-id="a06d2-135">Step 1: Setting a Content Page's Title</span></span>

<span data-ttu-id="a06d2-136">Tytuł strony sieci Web jest określany za pośrednictwem elementu `<title>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-136">The web page's title is specified via the `<title>` element.</span></span> <span data-ttu-id="a06d2-137">Ważne jest, aby ustawić tytuł każdej strony na odpowiednią wartość.</span><span class="sxs-lookup"><span data-stu-id="a06d2-137">It is important to set each page's title to an appropriate value.</span></span> <span data-ttu-id="a06d2-138">Podczas odwiedzania strony tytuł zostanie wyświetlony na pasku tytułu przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="a06d2-138">When visiting a page, its title is displayed in the browser's Title bar.</span></span> <span data-ttu-id="a06d2-139">Ponadto podczas zakładania zakładki strony przeglądarki używają tytułu strony jako sugerowanej nazwy zakładki.</span><span class="sxs-lookup"><span data-stu-id="a06d2-139">Additionally, when bookmarking a page, browsers use the page's title as the suggested name for the bookmark.</span></span> <span data-ttu-id="a06d2-140">Ponadto wiele aparatów wyszukiwania Wyświetla tytuł strony podczas wyświetlania wyników wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="a06d2-140">Also, many search engines show the page's title when displaying search results.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-141">Domyślnie program Visual Studio ustawia element `<title>` na stronie wzorcowej na "stronę bez tytułu".</span><span class="sxs-lookup"><span data-stu-id="a06d2-141">By default, Visual Studio sets the `<title>` element in the master page to "Untitled Page".</span></span> <span data-ttu-id="a06d2-142">Podobnie nowe strony ASP.NET `<title>` mają ustawioną wartość "Strona bez tytułu".</span><span class="sxs-lookup"><span data-stu-id="a06d2-142">Similarly, new ASP.NET pages have their `<title>` set to "Untitled Page", too.</span></span> <span data-ttu-id="a06d2-143">Ze względu na to, że można łatwo zapomnieć, aby ustawić odpowiednią wartość tytułu strony, istnieje wiele stron w Internecie z tytułem "Strona niezatytułowana".</span><span class="sxs-lookup"><span data-stu-id="a06d2-143">Because it can be easy to forget to set the page's title to an appropriate value, there are many pages on the Internet with the title "Untitled Page".</span></span> <span data-ttu-id="a06d2-144">Wyszukiwanie stron Google for Web z tym tytułem zwraca około 2 460 000 wyników.</span><span class="sxs-lookup"><span data-stu-id="a06d2-144">Searching Google for web pages with this title returns roughly 2,460,000 results.</span></span> <span data-ttu-id="a06d2-145">Nawet firma Microsoft jest podatna na publikowanie stron sieci Web z tytułem "Strona bez tytułu".</span><span class="sxs-lookup"><span data-stu-id="a06d2-145">Even Microsoft is susceptible to publishing web pages with the title "Untitled Page".</span></span> <span data-ttu-id="a06d2-146">W momencie tego zapisu w usłudze Google Search zgłoszono 236 takich stron sieci Web w domenie Microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="a06d2-146">At the time of this writing, a Google search reported 236 such web pages in the Microsoft.com domain.</span></span>

<span data-ttu-id="a06d2-147">Strona ASP.NET może określać jej tytuł w jeden z następujących sposobów:</span><span class="sxs-lookup"><span data-stu-id="a06d2-147">An ASP.NET page can specify its title in one of the following ways:</span></span>

- <span data-ttu-id="a06d2-148">Przez umieszczenie wartości bezpośrednio w `<title>` elemencie</span><span class="sxs-lookup"><span data-stu-id="a06d2-148">By placing the value directly within the `<title>` element</span></span>
- <span data-ttu-id="a06d2-149">Używanie `Title` atrybutu w dyrektywie `<%@ Page %>`</span><span class="sxs-lookup"><span data-stu-id="a06d2-149">Using the `Title` attribute in the `<%@ Page %>` directive</span></span>
- <span data-ttu-id="a06d2-150">Programowe Ustawianie właściwości `Title` strony przy użyciu kodu, takiego jak `Page.Title="title"` lub `Page.Header.Title="title"`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-150">Programmatically setting the page's `Title` property using code like `Page.Title="title"` or `Page.Header.Title="title"`.</span></span>

<span data-ttu-id="a06d2-151">Strony zawartości nie mają elementu `<title>`, ponieważ jest on zdefiniowany na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="a06d2-151">Content pages don't have a `<title>` element, as it's defined in the master page.</span></span> <span data-ttu-id="a06d2-152">W związku z tym, aby ustawić tytuł strony zawartości, można użyć atrybutu `Title` dyrektywy `<%@ Page %>` lub programowo ustawić go.</span><span class="sxs-lookup"><span data-stu-id="a06d2-152">Therefore, to set a content page's title you can either use the `<%@ Page %>` directive's `Title` attribute or set it programmatically.</span></span>

### <a name="setting-the-pages-title-declaratively"></a><span data-ttu-id="a06d2-153">Deklaratywne Ustawianie tytułu strony</span><span class="sxs-lookup"><span data-stu-id="a06d2-153">Setting the Page's Title Declaratively</span></span>

<span data-ttu-id="a06d2-154">Tytuł strony zawartości można ustawić deklaratywnie poprzez atrybut `Title` [dyrektywy`<%@ Page %>`](https://msdn.microsoft.com/library/ydy4x04a.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-154">A content page's title can be set declaratively through the `Title` attribute of the [`<%@ Page %>` directive](https://msdn.microsoft.com/library/ydy4x04a.aspx).</span></span> <span data-ttu-id="a06d2-155">Tę właściwość można ustawić przez bezpośrednie zmodyfikowanie dyrektywy `<%@ Page %>` lub przez okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-155">This property can be set by directly modifying the `<%@ Page %>` directive or through the Properties window.</span></span> <span data-ttu-id="a06d2-156">Przyjrzyjmy się obu podejściem.</span><span class="sxs-lookup"><span data-stu-id="a06d2-156">Let's look at both approaches.</span></span>

<span data-ttu-id="a06d2-157">W widoku źródła Znajdź dyrektywę `<%@ Page %>`, która znajduje się w górnej części deklaracyjnego znacznika strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-157">From the Source view, locate the `<%@ Page %>` directive, which is at the top of the page's declarative markup.</span></span> <span data-ttu-id="a06d2-158">`<%@ Page %>` dyrektywie `Default.aspx` poniżej:</span><span class="sxs-lookup"><span data-stu-id="a06d2-158">The `<%@ Page %>` directive for `Default.aspx` follows:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample3.aspx)]

<span data-ttu-id="a06d2-159">Dyrektywa `<%@ Page %>` określa atrybuty specyficzne dla strony używane przez aparat ASP.NET podczas analizowania i kompilowania strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-159">The `<%@ Page %>` directive specifies page-specific attributes used by the ASP.NET engine when parsing and compiling the page.</span></span> <span data-ttu-id="a06d2-160">Obejmuje to plik strony głównej, lokalizację pliku kodu oraz jego tytuł, między innymi informacjami.</span><span class="sxs-lookup"><span data-stu-id="a06d2-160">This includes its master page file, the location of its code file, and its title, among other information.</span></span>

<span data-ttu-id="a06d2-161">Domyślnie podczas tworzenia nowej strony zawartości program Visual Studio ustawia atrybut `Title` na "stronę bez tytułu".</span><span class="sxs-lookup"><span data-stu-id="a06d2-161">By default, when creating a new content page Visual Studio sets the `Title` attribute to "Untitled Page".</span></span> <span data-ttu-id="a06d2-162">Zmień atrybut `Title` `Default.aspx`z "strony" bez tytułu "na" samouczki stron wzorcowych ", a następnie Wyświetl stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="a06d2-162">Change `Default.aspx`'s `Title` attribute from "Untitled Page" to "Master Page Tutorials" and then view the page through a browser.</span></span> <span data-ttu-id="a06d2-163">Rysunek 1 pokazuje pasek tytułu przeglądarki, który odzwierciedla nowy tytuł strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-163">Figure 1 shows the browser's Title bar, which reflects the new page title.</span></span>

![Na pasku tytułu przeglądarki są teraz wyświetlane &quot;samouczków strony wzorcowej&quot; zamiast &quot;strony bez tytułu&quot;](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image1.png)

<span data-ttu-id="a06d2-165">**Ilustracja 01**. pasek tytułu przeglądarki pokazuje teraz "samouczki stron wzorcowych" zamiast "Strona bez tytułu"</span><span class="sxs-lookup"><span data-stu-id="a06d2-165">**Figure 01**: The Browser's Title Bar Now Shows "Master Page Tutorials" Instead of "Untitled Page"</span></span>

<span data-ttu-id="a06d2-166">Tytuł strony może być również ustawiony na podstawie okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-166">The page's title may also be set from the Properties window.</span></span> <span data-ttu-id="a06d2-167">Z okno Właściwości wybierz pozycję dokument z listy rozwijanej, aby załadować właściwości na poziomie strony, które obejmują Właściwość `Title`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-167">From the Properties window, select DOCUMENT from the drop-down list to load the page-level properties, which includes the `Title` property.</span></span> <span data-ttu-id="a06d2-168">Rysunek 2 przedstawia okno Właściwości po ustawieniu `Title` jako "samouczków strony wzorcowej".</span><span class="sxs-lookup"><span data-stu-id="a06d2-168">Figure 2 shows the Properties window after `Title` has been set to "Master Page Tutorials".</span></span>

![Możesz również skonfigurować tytuł z okna właściwości.](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image2.png)

<span data-ttu-id="a06d2-170">**Ilustracja 02**. Możesz również skonfigurować tytuł z okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-170">**Figure 02**: You May Configure the Title from the Properties Window, Too</span></span>

### <a name="setting-the-pages-title-programmatically"></a><span data-ttu-id="a06d2-171">Programistyczne Ustawianie tytułu strony</span><span class="sxs-lookup"><span data-stu-id="a06d2-171">Setting the Page's Title Programmatically</span></span>

<span data-ttu-id="a06d2-172">Znacznik `<head runat="server">` strony wzorcowej jest tłumaczony na wystąpienie [klasy`HtmlHead`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.aspx) , gdy strona jest renderowana przez aparat ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a06d2-172">The master page's `<head runat="server">` markup is translated into an [`HtmlHead` class](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.aspx) instance when the page is rendered by the ASP.NET engine.</span></span> <span data-ttu-id="a06d2-173">Klasa `HtmlHead` ma [właściwość`Title`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.title.aspx) , której wartość jest odzwierciedlona w renderowanym elemencie `<title>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-173">The `HtmlHead` class has a [`Title` property](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.title.aspx) whose value is reflected in the rendered `<title>` element.</span></span> <span data-ttu-id="a06d2-174">Ta właściwość jest dostępna z klasy ASP.NET strony powiązanej z kodem za pośrednictwem `Page.Header.Title`; Tę samą Właściwość można również uzyskać za pośrednictwem `Page.Title`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-174">This property is accessible from an ASP.NET page's code-behind class via `Page.Header.Title`; this same property can also be accessed via `Page.Title`.</span></span>

<span data-ttu-id="a06d2-175">Aby programowo ustawić tytuł strony, przejdź do klasy związanej z kodem `About.aspx` strony i Utwórz procedurę obsługi zdarzeń dla zdarzenia `Load` strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-175">To practice setting the page's title programmatically, navigate to the `About.aspx` page's code-behind class and create an event handler for the page's `Load` event.</span></span> <span data-ttu-id="a06d2-176">Następnie ustaw tytuł strony na "samouczki strony wzorcowej:: informacje:: *Data*", gdzie *Data* jest bieżącą datą.</span><span class="sxs-lookup"><span data-stu-id="a06d2-176">Next, set the page's title to "Master Page Tutorials :: About :: *date*", where *date* is the current date.</span></span> <span data-ttu-id="a06d2-177">Po dodaniu tego kodu program obsługi zdarzeń `Page_Load` powinien wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="a06d2-177">After adding this code your `Page_Load` event handler should look similar to the following:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample4.vb)]

<span data-ttu-id="a06d2-178">Rysunek 3 pokazuje pasek tytułu przeglądarki podczas odwiedzania strony `About.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-178">Figure 3 shows the browser's title bar when visiting the `About.aspx` page.</span></span>

![Tytuł strony jest programowo ustawiany i zawiera bieżącą datę](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image3.png)

<span data-ttu-id="a06d2-180">**Ilustracja 03**: nazwa strony jest programowo ustawiana i zawiera bieżącą datę</span><span class="sxs-lookup"><span data-stu-id="a06d2-180">**Figure 03**: The Page's Title is Programmatically Set and Includes the Current Date</span></span>

## <a name="step-2-automatically-assigning-a-page-title"></a><span data-ttu-id="a06d2-181">Krok 2: automatyczne przypisywanie tytułu strony</span><span class="sxs-lookup"><span data-stu-id="a06d2-181">Step 2: Automatically Assigning a Page Title</span></span>

<span data-ttu-id="a06d2-182">Zgodnie z opisem w kroku 1, tytuł strony może być ustawiony deklaratywnie lub programowo.</span><span class="sxs-lookup"><span data-stu-id="a06d2-182">As we saw in Step 1, a page's title can be set declaratively or programmatically.</span></span> <span data-ttu-id="a06d2-183">Jeśli zapomnisz jawnie zmienić tytuł na coś bardziej opisowego, strona będzie mieć tytuł domyślny "Strona bez tytułu".</span><span class="sxs-lookup"><span data-stu-id="a06d2-183">If you forget to explicitly change the title to something more descriptive, however, your page will have the default title, "Untitled Page".</span></span> <span data-ttu-id="a06d2-184">W idealnym przypadku tytuł strony zostanie automatycznie ustawiony dla nas w przypadku, gdy nie określimy jawnie jej wartości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-184">Ideally, the page's title would be set automatically for us in the event that we don't explicitly specify its value.</span></span> <span data-ttu-id="a06d2-185">Na przykład jeśli w środowisku uruchomieniowym tytuł strony jest "stroną bez tytułu", możemy chcieć, aby tytuł był automatycznie aktualizowany, tak samo jak nazwa pliku strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a06d2-185">For example, if at runtime the page's title is "Untitled Page", we might want to have the title automatically updated to be the same as the ASP.NET page's filename.</span></span> <span data-ttu-id="a06d2-186">Dobrą wiadomość polega na tym, że z małą ilością pracy z góry jest możliwe, że tytuł jest automatycznie przypisywany.</span><span class="sxs-lookup"><span data-stu-id="a06d2-186">The good news is that with a little bit of upfront work it is possible to have the title automatically assigned.</span></span>

<span data-ttu-id="a06d2-187">Wszystkie strony sieci Web ASP.NET pochodzą z klasy `Page` w przestrzeni nazw System. Web. UI.</span><span class="sxs-lookup"><span data-stu-id="a06d2-187">All ASP.NET web pages derive from the `Page` class in the System.Web.UI namespace.</span></span> <span data-ttu-id="a06d2-188">Klasa `Page` definiuje minimalną funkcjonalność wymaganą przez stronę ASP.NET i uwidacznia podstawowe właściwości, takie jak `IsPostBack`, `IsValid`, `Request`i `Response`, wśród wielu innych.</span><span class="sxs-lookup"><span data-stu-id="a06d2-188">The `Page` class defines the minimal functionality needed by an ASP.NET page and exposes essential properties like `IsPostBack`, `IsValid`, `Request`, and `Response`, among many others.</span></span> <span data-ttu-id="a06d2-189">Często, każda Strona w aplikacji sieci Web wymaga dodatkowych funkcji lub funkcjonalności.</span><span class="sxs-lookup"><span data-stu-id="a06d2-189">Oftentimes, every page in a web application requires additional features or functionality.</span></span> <span data-ttu-id="a06d2-190">Typowym sposobem na zapewnienie tego jest utworzenie niestandardowej klasy strony podstawowej.</span><span class="sxs-lookup"><span data-stu-id="a06d2-190">A common way of providing this is to create a custom base page class.</span></span> <span data-ttu-id="a06d2-191">Klasa niestandardowej strony podstawowej jest klasą utworzoną przez użytkownika, która dziedziczy z klasy `Page` i zawiera dodatkowe funkcje.</span><span class="sxs-lookup"><span data-stu-id="a06d2-191">A custom base page class is a class you create that derives from the `Page` class and includes additional functionality.</span></span> <span data-ttu-id="a06d2-192">Po utworzeniu tej klasy bazowej można uzyskać od niej strony ASP.NET (a nie klasy `Page`), oferując w ten sposób rozszerzoną funkcjonalność na stronach ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a06d2-192">Once this base class has been created, you can have your ASP.NET pages derive from it (rather than the `Page` class), thereby offering the extended functionality to your ASP.NET pages.</span></span>

<span data-ttu-id="a06d2-193">W tym kroku utworzymy stronę bazową, która automatycznie ustawia tytuł strony na nazwę pliku strony ASP.NET, jeśli tytuł nie został jawnie ustawiony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-193">In this step we create a base page that automatically sets the page's title to the ASP.NET page's filename if the title has not otherwise been explicitly set.</span></span> <span data-ttu-id="a06d2-194">Krok 3 sprawdza, jak ustawić tytuł strony na podstawie mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-194">Step 3 looks at setting the page's title based on the site map.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-195">Dokładne badanie tworzenia i używania niestandardowych klas stron podstawowych wykracza poza zakres tej serii samouczków.</span><span class="sxs-lookup"><span data-stu-id="a06d2-195">A thorough examination of creating and using custom base page classes is beyond the scope of this tutorial series.</span></span> <span data-ttu-id="a06d2-196">Aby uzyskać więcej informacji, Przeczytaj [przy użyciu niestandardowej klasy bazowej dla klas ASP.NET stron związanych z kodem](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-196">For more information, read [Using a Custom Base Class for Your ASP.NET Pages' Code-Behind Classes](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx).</span></span>

### <a name="creating-the-base-page-class"></a><span data-ttu-id="a06d2-197">Tworzenie klasy podstawowej strony</span><span class="sxs-lookup"><span data-stu-id="a06d2-197">Creating the Base Page Class</span></span>

<span data-ttu-id="a06d2-198">Pierwsze zadanie polega na utworzeniu klasy strony podstawowej, która jest klasą, która rozszerza klasę `Page`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-198">Our first task is to create a base page class, which is a class that extends the `Page` class.</span></span> <span data-ttu-id="a06d2-199">Zacznij od dodania folderu `App_Code` do projektu, klikając prawym przyciskiem myszy nazwę projektu w Eksplorator rozwiązań, wybierając pozycję Dodaj folder ASP.NET, a następnie wybierając pozycję `App_Code`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-199">Start by adding an `App_Code` folder to your project by right-clicking on the project name in the Solution Explorer, choosing Add ASP.NET Folder, and then selecting `App_Code`.</span></span> <span data-ttu-id="a06d2-200">Następnie kliknij prawym przyciskiem myszy folder `App_Code` i Dodaj nową klasę o nazwie `BasePage.vb`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-200">Next, right-click on the `App_Code` folder and add a new class named `BasePage.vb`.</span></span> <span data-ttu-id="a06d2-201">Rysunek 4 przedstawia Eksplorator rozwiązań po dodaniu folderu `App_Code` i klasy `BasePage.vb`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-201">Figure 4 shows the Solution Explorer after the `App_Code` folder and `BasePage.vb` class have been added.</span></span>

![Dodawanie folderu App_Code i klasy o nazwie BasePage](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image4.png)

<span data-ttu-id="a06d2-203">**Ilustracja 04**: dodawanie folderu `App_Code` i klasy o nazwie `BasePage`</span><span class="sxs-lookup"><span data-stu-id="a06d2-203">**Figure 04**: Add an `App_Code` Folder and a Class Named `BasePage`</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-204">Program Visual Studio obsługuje dwa tryby zarządzania projektami: projekty witryny sieci Web i projekty aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a06d2-204">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="a06d2-205">Folder `App_Code` jest przeznaczony do użycia z modelem projektu witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a06d2-205">The `App_Code` folder is designed to be used with the Web Site Project model.</span></span> <span data-ttu-id="a06d2-206">Jeśli używasz modelu projektu aplikacji sieci Web, umieść klasę `BasePage.vb` w folderze o nazwie coś innego niż `App_Code`, na przykład `Classes`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-206">If you are using the Web Application Project model, place the `BasePage.vb` class in a folder named something other than `App_Code`, such as `Classes`.</span></span> <span data-ttu-id="a06d2-207">Aby uzyskać więcej informacji na ten temat, zapoznaj się z tematem [Migrowanie projektu witryny sieci Web do projektu aplikacji sieci Web](http://webproject.scottgu.com/VisualBasic/Migration2/Migration2.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-207">For more information on this topic, refer to [Migrating a Web Site Project to a Web Application Project](http://webproject.scottgu.com/VisualBasic/Migration2/Migration2.aspx).</span></span>

<span data-ttu-id="a06d2-208">Ze względu na to, że niestandardowa strona podstawowa służy jako klasa bazowa dla klas ASP.NET stron z kodem, musi ona zostać rozszerzona o klasę `Page`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-208">Because the custom base page serves as the base class for ASP.NET pages' code-behind classes, it needs to extend the `Page` class.</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample5.vb)]

<span data-ttu-id="a06d2-209">Za każdym razem, gdy żądanie strony ASP.NET przechodzi przez serię etapów, culminating na żądana stronie jest renderowany w formacie HTML.</span><span class="sxs-lookup"><span data-stu-id="a06d2-209">Whenever an ASP.NET page is requested it proceeds through a series of stages, culminating in the requested page being rendered into HTML.</span></span> <span data-ttu-id="a06d2-210">Możemy wybrać etap, zastępując metodę `OnEvent` klasy `Page`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-210">We can tap into a stage by overriding the `Page` class's `OnEvent` method.</span></span> <span data-ttu-id="a06d2-211">W przypadku naszej strony podstawowej automatycznie ustawimy tytuł, jeśli nie został on jawnie określony przez etap `LoadComplete` (który może zostać odgadnąć, gdy jest to możliwe po etapie `Load`).</span><span class="sxs-lookup"><span data-stu-id="a06d2-211">For our base page let's automatically set the title if it has not been explicitly specified by the `LoadComplete` stage (which, as you might have guessed, occurs after the `Load` stage).</span></span>

<span data-ttu-id="a06d2-212">Aby to osiągnąć, Zastąp metodę `OnLoadComplete` i wprowadź następujący kod:</span><span class="sxs-lookup"><span data-stu-id="a06d2-212">To accomplish this, override the `OnLoadComplete` method and enter the following code:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample6.vb)]

<span data-ttu-id="a06d2-213">Metoda `OnLoadComplete` zaczyna się od określenia, czy właściwość `Title` nie została jeszcze jawnie ustawiona.</span><span class="sxs-lookup"><span data-stu-id="a06d2-213">The `OnLoadComplete` method starts by determining if the `Title` property has not yet been explicitly set.</span></span> <span data-ttu-id="a06d2-214">Jeśli właściwość `Title` jest `Nothing`, pusty ciąg lub ma wartość "Strona bez tytułu", zostanie ona przypisana do nazwy pliku żądanej strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a06d2-214">If the `Title` property is `Nothing`, an empty string, or has the value "Untitled Page", it is assigned to the filename of the requested ASP.NET page.</span></span> <span data-ttu-id="a06d2-215">Ścieżka fizyczna do żądanej strony ASP.NET `C:\MySites\Tutorial03\Login.aspx`, na przykład, jest dostępna za pośrednictwem właściwości `Request.PhysicalPath`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-215">The physical path to the requested ASP.NET page - `C:\MySites\Tutorial03\Login.aspx`, for example - is accessible via the `Request.PhysicalPath` property.</span></span> <span data-ttu-id="a06d2-216">Metoda `Path.GetFileNameWithoutExtension` służy do ściągania tylko części nazwy pliku, a następnie ta nazwa pliku jest następnie przypisywana do właściwości `Page.Title`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-216">The `Path.GetFileNameWithoutExtension` method is used to pull out just the filename portion, and this filename is then assigned to the `Page.Title` property.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-217">Zapraszam do udoskonalenia tej logiki w celu poprawy formatu tytułu.</span><span class="sxs-lookup"><span data-stu-id="a06d2-217">I invite you to enhance this logic to improve the format of the title.</span></span> <span data-ttu-id="a06d2-218">Na przykład jeśli nazwa pliku strony jest `Company-Products.aspx`, powyższy kod spowoduje utworzenie tytułu "produkty firmowe", ale w idealnym przypadku kreska zostanie zastąpiona spacją, tak jak w "produktach firmy".</span><span class="sxs-lookup"><span data-stu-id="a06d2-218">For example, if the page's filename is `Company-Products.aspx`, the above code will produce the title "Company-Products", but ideally the dash would be replaced with a space, as in "Company Products".</span></span> <span data-ttu-id="a06d2-219">Należy również rozważyć dodanie odstępu w przypadku zmiany wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="a06d2-219">Also, consider adding a space whenever there's a case change.</span></span> <span data-ttu-id="a06d2-220">Oznacza to, że należy rozważyć dodanie kodu, który przekształca nazwę pliku `OurBusinessHours.aspx` na tytuł "godzin pracy".</span><span class="sxs-lookup"><span data-stu-id="a06d2-220">That is, consider adding code that transforms the filename `OurBusinessHours.aspx` to a title of "Our Business Hours".</span></span>

### <a name="having-the-content-pages-inherit-the-base-page-class"></a><span data-ttu-id="a06d2-221">Posiadanie stron zawartości dziedziczą klasę strony podstawowej</span><span class="sxs-lookup"><span data-stu-id="a06d2-221">Having the Content Pages Inherit the Base Page Class</span></span>

<span data-ttu-id="a06d2-222">Teraz należy zaktualizować strony ASP.NET w naszej witrynie, aby dziedziczyć z niestandardowej strony podstawowej (`BasePage`) zamiast klasy `Page`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-222">We now need to update the ASP.NET pages in our site to derive from the custom base page (`BasePage`) instead of the `Page` class.</span></span> <span data-ttu-id="a06d2-223">W tym celu należy przejść do każdej klasy związanej z kodem i zmienić deklarację klasy z:</span><span class="sxs-lookup"><span data-stu-id="a06d2-223">To accomplish this go to each code-behind class and change the class declaration from:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample7.vb)]

<span data-ttu-id="a06d2-224">Do:</span><span class="sxs-lookup"><span data-stu-id="a06d2-224">To:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample8.vb)]

<span data-ttu-id="a06d2-225">Po wykonaniu tej czynności odwiedź witrynę za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="a06d2-225">After doing so, visit the site through a browser.</span></span> <span data-ttu-id="a06d2-226">Jeśli odwiedzasz stronę, której tytuł jest jawnie ustawiony, na przykład `Default.aspx` lub `About.aspx`, zostanie użyty jawnie określony tytuł.</span><span class="sxs-lookup"><span data-stu-id="a06d2-226">If you visit a page whose title is explicitly set, such as `Default.aspx` or `About.aspx`, the explicitly specified title is used.</span></span> <span data-ttu-id="a06d2-227">Jeśli jednak zostanie odwiedzana strona, której tytuł nie został zmieniony z domyślnej ("niezatytułowanej strony"), Klasa strony bazowej ustawia tytuł na nazwę pliku strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-227">If, however, you visit a page whose title has not been changed from the default ("Untitled Page"), the base page class sets the title to the page's filename.</span></span>

<span data-ttu-id="a06d2-228">Rysunek 5 przedstawia stronę `MultipleContentPlaceHolders.aspx` wyświetlaną w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a06d2-228">Figure 5 shows the `MultipleContentPlaceHolders.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="a06d2-229">Należy zauważyć, że tytuł jest precyzyjnie nazwą pliku strony (mniejszą od rozszerzenia), "MultipleContentPlaceHolders".</span><span class="sxs-lookup"><span data-stu-id="a06d2-229">Note that the title is precisely the page's filename (less the extension), "MultipleContentPlaceHolders".</span></span>

<span data-ttu-id="a06d2-230">[![jeśli tytuł nie zostanie określony jawnie, nazwa pliku strony zostanie automatycznie użyta](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image6.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a06d2-230">[![If a Title is Not Explicitly Specified, the Page's Filename is Automatically Used](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image6.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image5.png)</span></span>

<span data-ttu-id="a06d2-231">**Ilustracja 05**. Jeśli tytuł nie jest jawnie określony, nazwa pliku strony jest używana automatycznie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="a06d2-231">**Figure 05**: If a Title is Not Explicitly Specified, the Page's Filename is Automatically Used  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image7.png))</span></span>

## <a name="step-3-basing-the-page-title-on-the-site-map"></a><span data-ttu-id="a06d2-232">Krok 3. oparcie tytułu strony na mapie witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-232">Step 3: Basing the Page Title on the Site Map</span></span>

<span data-ttu-id="a06d2-233">ASP.NET oferuje niezawodną strukturę mapy witryny, która umożliwia deweloperom stron Definiowanie hierarchicznej mapy witryny w zewnętrznym zasobie (na przykład pliku XML lub tabeli bazy danych) wraz z kontrolkami sieci Web służącymi do wyświetlania informacji o mapie witryny (takich jak ścieżki mapy witryny). I kontrolki TreeView).</span><span class="sxs-lookup"><span data-stu-id="a06d2-233">ASP.NET offers a robust site map framework that enables page developers to define a hierarchical site map in an external resource (such as an XML file or database table) along with Web controls for displaying information about the site map (such as the SiteMapPath, Menu, and TreeView controls).</span></span>

<span data-ttu-id="a06d2-234">Strukturę mapy witryny można również uzyskać programowo przy użyciu klasy z kodem ASP.NET strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-234">The site map structure can also be accessed programmatically from an ASP.NET page's code-behind class.</span></span> <span data-ttu-id="a06d2-235">W ten sposób można automatycznie ustawić tytuł strony na tytuł odpowiedniego węzła w mapie witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-235">In this manner we can automatically set a page's title to the title of its corresponding node in the site map.</span></span> <span data-ttu-id="a06d2-236">Zwiększmy klasę `BasePage` utworzoną w kroku 2, aby zapewniała to funkcjonalność.</span><span class="sxs-lookup"><span data-stu-id="a06d2-236">Let's enhance the `BasePage` class created in Step 2 so that it offers this functionality.</span></span> <span data-ttu-id="a06d2-237">Najpierw musimy utworzyć mapę witryny dla naszej witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-237">But first we need to create a site map for our site.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-238">W tym samouczku założono, że czytelnik już zna środowisko ASP. Funkcje mapy witryny sieci.</span><span class="sxs-lookup"><span data-stu-id="a06d2-238">This tutorial assumes the reader already is familiar with ASP.NET's site map features.</span></span> <span data-ttu-id="a06d2-239">Aby uzyskać więcej informacji na temat korzystania z mapy witryny, zapoznaj się z artykułem moja część serii artykułów, [Badanie ASP. Nawigowanie po witrynie sieci](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-239">For more information on using the site map, consult my multi-part article series, [Examining ASP.NET's Site Navigation](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx).</span></span>

### <a name="creating-the-site-map"></a><span data-ttu-id="a06d2-240">Tworzenie mapy witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-240">Creating the Site Map</span></span>

<span data-ttu-id="a06d2-241">System mapy witryny jest zbudowany korzystającego [model dostawcy](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), który oddziela interfejs API mapy witryny od logiki, która deserializacji informacje z mapy witryny między pamięcią a magazynem trwałym.</span><span class="sxs-lookup"><span data-stu-id="a06d2-241">The site map system is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), which decouples the site map API from the logic that serializes site map information between memory and a persistent store.</span></span> <span data-ttu-id="a06d2-242">.NET Framework jest dostarczany z [klasą`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx), która jest domyślnym dostawcą mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-242">The .NET Framework ships with the [`XmlSiteMapProvider` class](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx), which is the default site map provider.</span></span> <span data-ttu-id="a06d2-243">Jako że jego nazwa oznacza, `XmlSiteMapProvider` używa pliku XML jako magazynu mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-243">As its name implies, `XmlSiteMapProvider` uses an XML file as its site map store.</span></span> <span data-ttu-id="a06d2-244">Użyjmy tego dostawcy do definiowania naszej mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-244">Let's use this provider for defining our site map.</span></span>

<span data-ttu-id="a06d2-245">Zacznij od utworzenia pliku mapy witryny w folderze głównym witryny sieci Web o nazwie `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-245">Start by creating a site map file in the website's root folder named `Web.sitemap`.</span></span> <span data-ttu-id="a06d2-246">Aby to osiągnąć, kliknij prawym przyciskiem myszy nazwę witryny sieci Web w Eksplorator rozwiązań, wybierz polecenie Dodaj nowy element, a następnie wybierz szablon mapa witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-246">To accomplish this, right-click on the website name in Solution Explorer, choose Add New Item, and select the Site Map template.</span></span> <span data-ttu-id="a06d2-247">Upewnij się, że plik ma nazwę `Web.sitemap` i kliknij przycisk Dodaj.</span><span class="sxs-lookup"><span data-stu-id="a06d2-247">Ensure that the file is named `Web.sitemap` and click Add.</span></span>

<span data-ttu-id="a06d2-248">[![dodać pliku o nazwie Web. sitemap do folderu głównego witryny sieci Web](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image9.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="a06d2-248">[![Add a File Named Web.sitemap to the Website's Root Folder](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image9.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image8.png)</span></span>

<span data-ttu-id="a06d2-249">**Ilustracja 06**. Dodawanie pliku o nazwie `Web.sitemap` do folderu głównego witryny sieci Web ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a06d2-249">**Figure 06**: Add a File Named `Web.sitemap` to the Website's Root Folder  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image10.png))</span></span>

<span data-ttu-id="a06d2-250">Dodaj następujący kod XML do pliku `Web.sitemap`:</span><span class="sxs-lookup"><span data-stu-id="a06d2-250">Add the following XML to the `Web.sitemap` file:</span></span>

[!code-xml[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample9.xml)]

<span data-ttu-id="a06d2-251">Ten plik XML definiuje hierarchiczną strukturę mapy witryny przedstawioną na rysunku 7.</span><span class="sxs-lookup"><span data-stu-id="a06d2-251">This XML defines the hierarchical site map structure shown in Figure 7.</span></span>

![Mapa witryny składa się obecnie z trzech węzłów mapy witryny](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image11.png)

<span data-ttu-id="a06d2-253">**Ilustracja 07**: Mapa witryny jest obecnie złożona z trzech węzłów mapy witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-253">**Figure 07**: The Site Map is Currently Composed of Three Site Map Nodes</span></span>

<span data-ttu-id="a06d2-254">Będziemy aktualizować strukturę mapy witryny w przyszłych samouczkach, dodając nowe przykłady.</span><span class="sxs-lookup"><span data-stu-id="a06d2-254">We will update the site map structure in future tutorials as we add new examples.</span></span>

### <a name="updating-the-master-page-to-include-navigation-web-controls"></a><span data-ttu-id="a06d2-255">Aktualizowanie strony głównej w celu uwzględnienia kontrolek sieci Web nawigacji</span><span class="sxs-lookup"><span data-stu-id="a06d2-255">Updating the Master Page to Include Navigation Web Controls</span></span>

<span data-ttu-id="a06d2-256">Teraz, gdy mamy zdefiniowaną mapę witryny, zaktualizuj stronę wzorcową, aby obejmowała kontrolki sieci Web nawigacji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-256">Now that we have a site map defined, let's update the master page to include navigation Web controls.</span></span> <span data-ttu-id="a06d2-257">W tym celu Dodajmy kontrolkę ListView do lewej kolumny w sekcji lekcje, która renderuje listę nieuporządkowaną z elementem listy dla każdego węzła zdefiniowanego w mapie witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-257">Specifically, let's add a ListView control to the left column in the Lessons section that renders an unordered list with a list item for each node defined in the site map.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-258">Formant ListView jest nowy do ASP.NET w wersji 3,5.</span><span class="sxs-lookup"><span data-stu-id="a06d2-258">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="a06d2-259">Jeśli używasz wcześniejszej wersji programu ASP.NET, zamiast tego użyj kontrolki wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="a06d2-259">If you are using a prior version of ASP.NET, use the Repeater control instead.</span></span> <span data-ttu-id="a06d2-260">Aby uzyskać więcej informacji na temat kontrolki ListView, zobacz [Używanie kontrolek ListView i formantu DataPager w programie ASP.NET 3.5](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-260">For more information on the ListView control, see [Using ASP.NET 3.5's ListView and DataPager Controls](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>

<span data-ttu-id="a06d2-261">Zacznij od usunięcia istniejącego nieuporządkowanego znacznika listy z sekcji lekcji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-261">Start by removing the existing unordered list markup from the Lessons section.</span></span> <span data-ttu-id="a06d2-262">Następnie przeciągnij kontrolkę ListView z przybornika i upuść ją pod nagłówkiem lekcji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-262">Next, drag a ListView control from the Toolbox and drop it beneath the Lessons heading.</span></span> <span data-ttu-id="a06d2-263">Element ListView znajduje się w sekcji danych przybornika wraz z innymi kontrolkami widoku: GridView, DetailsView i FormView.</span><span class="sxs-lookup"><span data-stu-id="a06d2-263">The ListView is located in the Data section of the Toolbox, alongside the other view controls: the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="a06d2-264">Ustaw właściwość `ID` elementu ListView na `LessonsList`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-264">Set the ListView's `ID` property to `LessonsList`.</span></span>

<span data-ttu-id="a06d2-265">W Kreatorze konfiguracji źródła danych wybierz opcję powiązania elementu ListView z nową kontrolką SiteMapDataSource o nazwie `LessonsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-265">From the Data Source Configuration Wizard choose to bind the ListView to a new SiteMapDataSource control named `LessonsDataSource`.</span></span> <span data-ttu-id="a06d2-266">Kontrolka SiteMapDataSource zwraca strukturę hierarchiczną z systemu mapy lokacji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-266">The SiteMapDataSource control returns the hierarchical structure from the site map system.</span></span>

<span data-ttu-id="a06d2-267">[![powiązać formant SiteMapDataSource z kontrolką ListView LessonsList](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image13.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="a06d2-267">[![Bind a SiteMapDataSource Control to the LessonsList ListView Control](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image13.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image12.png)</span></span>

<span data-ttu-id="a06d2-268">**Ilustracja 08**: powiązanie formantu SiteMapDataSource z kontrolką ListView LessonsList ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a06d2-268">**Figure 08**: Bind a SiteMapDataSource Control to the LessonsList ListView Control  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image14.png))</span></span>

<span data-ttu-id="a06d2-269">Po utworzeniu formantu SiteMapDataSource musimy zdefiniować szablony elementu ListView, aby renderować listę nieuporządkowaną z elementem listy dla każdego węzła zwróconego przez kontrolkę SiteMapDataSource.</span><span class="sxs-lookup"><span data-stu-id="a06d2-269">After creating the SiteMapDataSource control, we need to define the ListView's templates so that it renders an unordered list with a list item for each node returned by the SiteMapDataSource control.</span></span> <span data-ttu-id="a06d2-270">Można to osiągnąć przy użyciu następującego znacznika szablonu:</span><span class="sxs-lookup"><span data-stu-id="a06d2-270">This can be accomplished using the following template markup:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample10.aspx)]

<span data-ttu-id="a06d2-271">`LayoutTemplate` generuje znaczniki dla listy nieuporządkowanej (`<ul>...</ul>`), podczas gdy `ItemTemplate` renderuje każdy element zwracany przez SiteMapDataSource jako element listy (`<li>`) zawierający link do konkretnej lekcji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-271">The `LayoutTemplate` generates the markup for an unordered list (`<ul>...</ul>`) while the `ItemTemplate` renders each item returned by the SiteMapDataSource as a list item (`<li>`) that contains a link to the particular lesson.</span></span>

<span data-ttu-id="a06d2-272">Po skonfigurowaniu szablonów elementu ListView odwiedź witrynę sieci Web.</span><span class="sxs-lookup"><span data-stu-id="a06d2-272">After configuring the ListView's templates, visit the website.</span></span> <span data-ttu-id="a06d2-273">Jak pokazano na rysunku 9, sekcja lekcji zawiera pojedynczy element punktowany, Strona główna.</span><span class="sxs-lookup"><span data-stu-id="a06d2-273">As Figure 9 shows, the Lessons section contains a single bulleted item, Home.</span></span> <span data-ttu-id="a06d2-274">Gdzie znajdują się lekcje i używanie wielu kontrolek ContentPlaceHolder?</span><span class="sxs-lookup"><span data-stu-id="a06d2-274">Where are the About and Using Multiple ContentPlaceHolder Controls lessons?</span></span> <span data-ttu-id="a06d2-275">SiteMapDataSource jest zaprojektowana w celu zwrócenia hierarchicznego zestawu danych, ale formant ListView może wyświetlać tylko jeden poziom hierarchii.</span><span class="sxs-lookup"><span data-stu-id="a06d2-275">The SiteMapDataSource is designed to return a hierarchical set of data, but the ListView control can only display a single level of the hierarchy.</span></span> <span data-ttu-id="a06d2-276">W związku z tym zostanie wyświetlony tylko pierwszy poziom węzłów mapy witryny zwracanych przez SiteMapDataSource.</span><span class="sxs-lookup"><span data-stu-id="a06d2-276">Consequently, only the first level of site map nodes returned by the SiteMapDataSource is displayed.</span></span>

<span data-ttu-id="a06d2-277">[![sekcja lekcji zawiera pojedynczy element listy](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image16.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a06d2-277">[![The Lessons Section Contains a Single List Item](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image16.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image15.png)</span></span>

<span data-ttu-id="a06d2-278">**Ilustracja 09**. sekcja lekcji zawiera pojedynczy element listy ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="a06d2-278">**Figure 09**: The Lessons Section Contains a Single List Item  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image17.png))</span></span>

<span data-ttu-id="a06d2-279">Aby wyświetlić wiele poziomów, możemy zagnieździć wiele ListViews w `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-279">To display multiple levels we could nest multiple ListViews within the `ItemTemplate`.</span></span> <span data-ttu-id="a06d2-280">Ta technika została zbadana na [ *stronach wzorcowych i* w samouczku nawigacji witryny](../../data-access/introduction/master-pages-and-site-navigation-vb.md) my [Pracuj z samouczkiem](../../data-access/index.md)dotyczącym danych.</span><span class="sxs-lookup"><span data-stu-id="a06d2-280">This technique was examined in the [*Master Pages and Site Navigation* tutorial](../../data-access/introduction/master-pages-and-site-navigation-vb.md) of my [Working with Data tutorial series](../../data-access/index.md).</span></span> <span data-ttu-id="a06d2-281">Jednak dla tej serii samouczków mapa witryny będzie zawierać tylko dwa poziomy: Strona główna (najwyższego poziomu); i każda lekcja jako element podrzędny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-281">However, for this tutorial series our site map will contain just a two levels: Home (the top level); and each lesson as a child of Home.</span></span> <span data-ttu-id="a06d2-282">Zamiast poinstruować zagnieżdżony element ListView, możemy SiteMapDataSource, aby nie zwracał węzła początkowego przez ustawienie jego [właściwości`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) na `False`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-282">Rather than crafting a nested ListView, we can instead instruct the SiteMapDataSource to not return the starting node by setting its [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) to `False`.</span></span> <span data-ttu-id="a06d2-283">Efektem netto jest to, że SiteMapDataSource jest uruchamiany przez zwrócenie drugiej warstwy węzłów mapy lokacji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-283">The net effect is that the SiteMapDataSource starts by returning the second tier of site map nodes.</span></span>

<span data-ttu-id="a06d2-284">Po tej zmianie element ListView wyświetla elementy punktorów dla informacji o i używających wielu formantów ContentPlaceHolder, ale pomija element punktora dla strony głównej.</span><span class="sxs-lookup"><span data-stu-id="a06d2-284">With this change, the ListView displays bullet items for the About and Using Multiple ContentPlaceHolder Controls lessons, but omits a bullet item for Home.</span></span> <span data-ttu-id="a06d2-285">Aby to naprawić, można jawnie dodać element punktora dla strony głównej w `LayoutTemplate`:</span><span class="sxs-lookup"><span data-stu-id="a06d2-285">To remedy this, we can explicitly add a bullet item for Home in the `LayoutTemplate`:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample11.aspx)]

<span data-ttu-id="a06d2-286">Konfigurując SiteMapDataSource, aby pominąć węzeł początkowy i jawnie dodać element punktora macierzystego, w sekcji lekcje są teraz wyświetlane zamierzone dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="a06d2-286">By configuring the SiteMapDataSource to omit the starting node and explicitly adding a Home bullet item, the Lessons section now displays the intended output.</span></span>

<span data-ttu-id="a06d2-287">[![sekcja lekcji zawiera element punktora dla domu i każdego węzła podrzędnego](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image19.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="a06d2-287">[![The Lessons Section Contains a Bullet Item for Home and Each Child Node](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image19.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image18.png)</span></span>

<span data-ttu-id="a06d2-288">**Ilustracja 10**. sekcja lekcji zawiera element punktora dla domu i każdego węzła podrzędnego ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="a06d2-288">**Figure 10**: The Lessons Section Contains a Bullet Item for Home and Each Child Node  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image20.png))</span></span>

### <a name="setting-the-title-based-on-the-site-map"></a><span data-ttu-id="a06d2-289">Ustawianie tytułu na podstawie mapy witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-289">Setting the Title Based on the Site Map</span></span>

<span data-ttu-id="a06d2-290">Korzystając z mapy witryny, możemy zaktualizować nasze klasy `BasePage`, aby używały tytułu określonego na mapie witryny.</span><span class="sxs-lookup"><span data-stu-id="a06d2-290">With the site map in place, we can update our `BasePage` class to use the title specified in the site map.</span></span> <span data-ttu-id="a06d2-291">Podobnie jak w kroku 2, chcemy użyć tytułu węzła mapy witryny, jeśli tytuł strony nie został jawnie ustawiony przez dewelopera strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-291">As we did in Step 2, we only want to use the site map node's title if the page's title has not been explicitly set by the page developer.</span></span> <span data-ttu-id="a06d2-292">Jeśli żądana strona nie ma jawnie ustawionego tytułu strony i nie zostanie znaleziona na mapie witryny, powrócimy do użycia nazwy pliku żądanej strony (mniejszej od rozszerzenia), tak jak w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="a06d2-292">If the page being requested does not have an explicitly set page title and is not found in the site map, then we'll fall back to using the requested page's filename (less the extension), as we did in Step 2.</span></span> <span data-ttu-id="a06d2-293">Rysunek 11 przedstawia proces tej decyzji.</span><span class="sxs-lookup"><span data-stu-id="a06d2-293">Figure 11 illustrates this decision process.</span></span>

![W przypadku braku jawnie ustawionego tytułu strony jest używany tytuł odpowiedniego węzła mapy witryny](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image21.png)

<span data-ttu-id="a06d2-295">**Rysunek 11**. w przypadku braku jawnie ustawionego tytułu strony jest używany tytuł odpowiedniego węzła mapy witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-295">**Figure 11**: In the Absence of an Explicitly Set Page Title, the Corresponding Site Map Node's Title is Used</span></span>

<span data-ttu-id="a06d2-296">Zaktualizuj metodę `OnLoadComplete` klasy `BasePage` w taki sposób, aby obejmowała następujący kod:</span><span class="sxs-lookup"><span data-stu-id="a06d2-296">Update the `BasePage` class's `OnLoadComplete` method to include the following code:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample12.vb)]

<span data-ttu-id="a06d2-297">Tak jak wcześniej Metoda `OnLoadComplete` zaczyna się od określenia, czy tytuł strony został jawnie ustawiony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-297">As before, the `OnLoadComplete` method starts by determining whether the page's title has been explicitly set.</span></span> <span data-ttu-id="a06d2-298">Jeśli `Page.Title` jest `Nothing`, pusty ciąg lub zostanie przypisana wartość "Strona bez tytułu", kod automatycznie przypisze wartość do `Page.Title`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-298">If `Page.Title` is `Nothing`, an empty string, or is assigned the value "Untitled Page" then the code automatically assigns a value to `Page.Title`.</span></span>

<span data-ttu-id="a06d2-299">Aby określić tytuł, który ma być używany, kod rozpocznie się, odwołując się do [właściwości`CurrentNode`](https://msdn.microsoft.com/library/system.web.sitemap.currentnode.aspx) [klasy`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx).</span><span class="sxs-lookup"><span data-stu-id="a06d2-299">To determine the title to use, the code starts by referencing the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)'s [`CurrentNode` property](https://msdn.microsoft.com/library/system.web.sitemap.currentnode.aspx).</span></span> <span data-ttu-id="a06d2-300">`CurrentNode` zwraca wystąpienie [`SiteMapNode`](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) na mapie witryny, które odpowiada aktualnie żądanej stronie.</span><span class="sxs-lookup"><span data-stu-id="a06d2-300">`CurrentNode` returns the [`SiteMapNode`](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) instance in the site map that corresponds to the currently requested page.</span></span> <span data-ttu-id="a06d2-301">Przy założeniu, że aktualnie żądana strona zostanie znaleziona w ramach mapy witryny, właściwość `Title` `SiteMapNode`zostanie przypisana do tytułu strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-301">Assuming the currently requested page is found within the site map, the `SiteMapNode`'s `Title` property is assigned to the page's title.</span></span> <span data-ttu-id="a06d2-302">Jeśli aktualnie żądana strona nie znajduje się na mapie witryny, `CurrentNode` zwraca `Nothing` i nazwa pliku żądanej strony jest używana jako tytuł (jak zostało to zrobione w kroku 2).</span><span class="sxs-lookup"><span data-stu-id="a06d2-302">If the currently requested page is not in the site map, `CurrentNode` returns `Nothing` and the requested page's filename is used as the title (as was done in Step 2).</span></span>

<span data-ttu-id="a06d2-303">Na rysunku 12 przedstawiono stronę `MultipleContentPlaceHolders.aspx` wyświetlaną w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="a06d2-303">Figure 12 shows the `MultipleContentPlaceHolders.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="a06d2-304">Ponieważ tytuł strony nie jest jawnie ustawiony, jego odpowiedni tytuł węzła mapy witryny jest używany.</span><span class="sxs-lookup"><span data-stu-id="a06d2-304">Because this page's title is not explicitly set, its corresponding site map node's title is used instead.</span></span>

![Tytuł strony MultipleContentPlaceHolders. aspx jest pobierany z mapy witryny](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image22.png)

<span data-ttu-id="a06d2-306">**Rysunek 12**: tytuł strony MultipleContentPlaceHolders. aspx został pobrany z mapy witryny</span><span class="sxs-lookup"><span data-stu-id="a06d2-306">**Figure 12**: The MultipleContentPlaceHolders.aspx Page's Title is Pulled from the Site Map</span></span>

## <a name="step-4-adding-other-page-specific-markup-to-theheadsection"></a><span data-ttu-id="a06d2-307">Krok 4. Dodawanie innego znacznika specyficznego dla strony do sekcji`<head>`</span><span class="sxs-lookup"><span data-stu-id="a06d2-307">Step 4: Adding Other Page-Specific Markup to the`<head>`Section</span></span>

<span data-ttu-id="a06d2-308">Kroki 1, 2 i 3 zostały przeszukane podczas dostosowywania elementu `<title>` na podstawie strony.</span><span class="sxs-lookup"><span data-stu-id="a06d2-308">Steps 1, 2, and 3 looked at customizing the `<title>` element on a page-by-page basis.</span></span> <span data-ttu-id="a06d2-309">Oprócz `<title>`sekcja `<head>` może zawierać elementy `<meta>` i elementy `<link>`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-309">In addition to `<title>`, the `<head>` section may contain `<meta>` elements and `<link>` elements.</span></span> <span data-ttu-id="a06d2-310">Jak wspomniano wcześniej w tym samouczku, sekcja `<head>` `Site.master`zawiera element `<link>` do `Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-310">As noted earlier in this tutorial, `Site.master`'s `<head>` section includes a `<link>` element to `Styles.css`.</span></span> <span data-ttu-id="a06d2-311">Ponieważ ten `<link>` element jest zdefiniowany na stronie wzorcowej, znajduje się w sekcji `<head>` dla wszystkich stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-311">Because this `<link>` element is defined within the master page, it is included in the `<head>` section for all content pages.</span></span> <span data-ttu-id="a06d2-312">Jak możemy dowiedzieć się, jak dodać `<meta>` i `<link>` elementy na stronie?</span><span class="sxs-lookup"><span data-stu-id="a06d2-312">But how do we go about adding `<meta>` and `<link>` elements on a page-by-page basis?</span></span>

<span data-ttu-id="a06d2-313">Najprostszym sposobem dodawania zawartości specyficznej dla strony do sekcji `<head>` jest utworzenie kontrolki ContentPlaceHolder na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="a06d2-313">The easiest way to add page-specific content to the `<head>` section is by creating a ContentPlaceHolder control in the master page.</span></span> <span data-ttu-id="a06d2-314">Mamy już taki element ContentPlaceHolder (o nazwie `head`).</span><span class="sxs-lookup"><span data-stu-id="a06d2-314">We already have such a ContentPlaceHolder (named `head`).</span></span> <span data-ttu-id="a06d2-315">W związku z tym, aby dodać niestandardowe znaczniki `<head>`, Utwórz odpowiednią kontrolkę zawartości na stronie i Umieść znacznik w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="a06d2-315">Therefore, to add custom `<head>` markup, create a corresponding Content control in the page and place the markup there.</span></span>

<span data-ttu-id="a06d2-316">Aby zilustrować Dodawanie niestandardowych znaczników `<head>` do strony, dołączymy element `<meta>` Description do naszego bieżącego zestawu stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-316">To illustrate adding custom `<head>` markup to a page, let's include a `<meta>` description element to our current set of content pages.</span></span> <span data-ttu-id="a06d2-317">Element `<meta>` Description zawiera krótki opis strony sieci Web; Większość aparatów wyszukiwania zawiera te informacje w postaci pewnego formularza podczas wyświetlania wyników wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="a06d2-317">The `<meta>` description element provides a brief description about the web page; most search engines incorporate this information in some form when displaying search results.</span></span>

<span data-ttu-id="a06d2-318">Element `<meta>` Description ma następującą formę:</span><span class="sxs-lookup"><span data-stu-id="a06d2-318">A `<meta>` description element has the following form:</span></span>

[!code-html[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample13.html)]

<span data-ttu-id="a06d2-319">Aby dodać tę adiustację do strony zawartości, Dodaj powyższy tekst do kontrolki zawartość, która jest mapowana na stronę wzorcową `head` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="a06d2-319">To add this markup to a content page, add the above text to the Content control that maps to the master page's `head` ContentPlaceHolder.</span></span> <span data-ttu-id="a06d2-320">Na przykład, aby zdefiniować `<meta>` element Description dla `Default.aspx`, Dodaj następujący znacznik:</span><span class="sxs-lookup"><span data-stu-id="a06d2-320">For example, to define a `<meta>` description element for `Default.aspx`, add the following markup:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample14.aspx)]

<span data-ttu-id="a06d2-321">Ponieważ `head` ContentPlaceHolder nie znajduje się w treści strony HTML, znacznik dodany do kontrolki zawartości nie jest wyświetlany w widok Projekt.</span><span class="sxs-lookup"><span data-stu-id="a06d2-321">Because the `head` ContentPlaceHolder is not within the HTML page's body, the markup added to the Content control is not displayed in the Design view.</span></span> <span data-ttu-id="a06d2-322">Aby wyświetlić `<meta>` element opisu, odwiedź `Default.aspx` za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="a06d2-322">To see the `<meta>` description element visit `Default.aspx` through a browser.</span></span> <span data-ttu-id="a06d2-323">Po załadowaniu strony Wyświetl źródło i zwróć uwagę, że sekcja `<head>` zawiera znacznik określony w kontrolce zawartość.</span><span class="sxs-lookup"><span data-stu-id="a06d2-323">After the page has been loaded, view the source and note that the `<head>` section includes the markup specified in the Content control.</span></span>

<span data-ttu-id="a06d2-324">Poświęć chwilę na dodanie `<meta>` elementów opisu do `About.aspx`, `MultipleContentPlaceHolders.aspx`i `Login.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-324">Take a moment to add `<meta>` description elements to `About.aspx`, `MultipleContentPlaceHolders.aspx`, and `Login.aspx`.</span></span>

### <a name="programmatically-adding-markup-to-theheadregion"></a><span data-ttu-id="a06d2-325">Programistyczne Dodawanie znaczników do`<head>`regionu</span><span class="sxs-lookup"><span data-stu-id="a06d2-325">Programmatically Adding Markup to the`<head>`Region</span></span>

<span data-ttu-id="a06d2-326">`head` ContentPlaceHolder pozwala nam dodawać niestandardowe znaczniki do regionu `<head>` strony głównej.</span><span class="sxs-lookup"><span data-stu-id="a06d2-326">The `head` ContentPlaceHolder allows us to declaratively add custom markup to the master page's `<head>` region.</span></span> <span data-ttu-id="a06d2-327">Niestandardowe znaczniki mogą być również dodawane programowo.</span><span class="sxs-lookup"><span data-stu-id="a06d2-327">Custom markup may also be added programmatically.</span></span> <span data-ttu-id="a06d2-328">Odwołaj, że właściwość `Header` klasy `Page` zwraca wystąpienie `HtmlHead` zdefiniowane na stronie wzorcowej (`<head runat="server">`).</span><span class="sxs-lookup"><span data-stu-id="a06d2-328">Recall that the `Page` class's `Header` property returns the `HtmlHead` instance defined in the master page (the `<head runat="server">`).</span></span>

<span data-ttu-id="a06d2-329">Możliwość programistycznego dodawania zawartości do regionu `<head>` jest przydatna, gdy zawartość do dodania jest dynamiczna.</span><span class="sxs-lookup"><span data-stu-id="a06d2-329">Being able to programmatically add content to the `<head>` region is useful when the content to add is dynamic.</span></span> <span data-ttu-id="a06d2-330">Być może jest oparta na użytkowniku odwiedzającym stronę; być może jest ono pobierane z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="a06d2-330">Perhaps it's based on the user visiting the page; maybe it's being pulled from a database.</span></span> <span data-ttu-id="a06d2-331">Bez względu na przyczynę można dodać zawartość do `HtmlHead` przez dodanie formantów do swojej `Controls` kolekcji, tak więc:</span><span class="sxs-lookup"><span data-stu-id="a06d2-331">Regardless of the reason, you can add content to the `HtmlHead` by adding controls to its `Controls` collection like so:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample15.vb)]

<span data-ttu-id="a06d2-332">Powyższy kod dodaje element `<meta>` Keywords do regionu `<head>`, który zawiera rozdzielaną przecinkami listę słów kluczowych opisujących stronę.</span><span class="sxs-lookup"><span data-stu-id="a06d2-332">The above code adds the `<meta>` keywords element to the `<head>` region, which provides a comma-delimited list of keywords that describe the page.</span></span> <span data-ttu-id="a06d2-333">Należy pamiętać, że w celu dodania `<meta>` znacznika utworzysz wystąpienie [`HtmlMeta`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlmeta.aspx) , ustaw jego `Name` i `Content` właściwości, a następnie dodaj je do kolekcji `Header``Controls`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-333">Note that to add a `<meta>` tag you create an [`HtmlMeta`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlmeta.aspx) instance, set its `Name` and `Content` properties, and then add it to the `Header`'s `Controls` collection.</span></span> <span data-ttu-id="a06d2-334">Podobnie, aby programowo dodać element `<link>`, Utwórz obiekt [`HtmlLink`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmllink.aspx) , ustaw jego właściwości, a następnie dodaj go do kolekcji `Controls` `Header`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-334">Similarly, to programmatically add a `<link>` element, create an [`HtmlLink`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmllink.aspx) object, set its properties, and then add it to the `Header`'s `Controls` collection.</span></span>

> [!NOTE]
> <span data-ttu-id="a06d2-335">Aby dodać dowolny znacznik, Utwórz wystąpienie [`LiteralControl`](https://msdn.microsoft.com/library/system.web.ui.literalcontrol.aspx) , ustaw jego właściwość `Text`, a następnie dodaj ją do kolekcji `Controls` `Header`.</span><span class="sxs-lookup"><span data-stu-id="a06d2-335">To add arbitrary markup, create a [`LiteralControl`](https://msdn.microsoft.com/library/system.web.ui.literalcontrol.aspx) instance, set its `Text` property, and then add it to the `Header`'s `Controls` collection.</span></span>

## <a name="summary"></a><span data-ttu-id="a06d2-336">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="a06d2-336">Summary</span></span>

<span data-ttu-id="a06d2-337">W tym samouczku przedstawiono różne sposoby dodawania znaczników `<head>`ych do poszczególnych stron.</span><span class="sxs-lookup"><span data-stu-id="a06d2-337">In this tutorial we looked at a variety of ways to add `<head>` region markup on a page-by-page basis.</span></span> <span data-ttu-id="a06d2-338">Strona wzorcowa powinna zawierać wystąpienie `HtmlHead` (`<head runat="server">`) z elementem ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="a06d2-338">A master page should include an `HtmlHead` instance (`<head runat="server">`) with a ContentPlaceHolder.</span></span> <span data-ttu-id="a06d2-339">Wystąpienie `HtmlHead` umożliwia stronom zawartości programowe uzyskiwanie dostępu do regionu `<head>` i deklaratywne i programowo Ustawianie tytułu strony; formant ContentPlaceHolder umożliwia dodanie znaczników niestandardowych do sekcji `<head>` deklaratywnie przez kontrolkę zawartości.</span><span class="sxs-lookup"><span data-stu-id="a06d2-339">The `HtmlHead` instance allows content pages to programmatically access the `<head>` region and to declaratively and programmatically set the page's title; the ContentPlaceHolder control enables custom markup to be added to the `<head>` section declaratively through a Content control.</span></span>

<span data-ttu-id="a06d2-340">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="a06d2-340">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a06d2-341">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="a06d2-341">Further Reading</span></span>

<span data-ttu-id="a06d2-342">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="a06d2-342">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a06d2-343">Dynamiczne ustawianie tytułu strony w ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a06d2-343">Dynamically Setting the Page's Title in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [<span data-ttu-id="a06d2-344">Badanie ASP. Nawigacja w witrynie sieci</span><span class="sxs-lookup"><span data-stu-id="a06d2-344">Examining ASP.NET's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="a06d2-345">Jak używać tagów Meta HTML</span><span class="sxs-lookup"><span data-stu-id="a06d2-345">How To Use HTML Meta Tags</span></span>](http://searchenginewatch.com/showPage.html?page=2167931)
- [<span data-ttu-id="a06d2-346">Strony wzorcowe w ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a06d2-346">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/articles/419.aspx)
- [<span data-ttu-id="a06d2-347">Korzystanie z kontrolek ListView i formantu DataPager w programie ASP.NET 3.5</span><span class="sxs-lookup"><span data-stu-id="a06d2-347">Using ASP.NET 3.5's ListView and DataPager Controls</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="a06d2-348">Używanie niestandardowej klasy bazowej dla klas ASP.NET stron związanych z kodem</span><span class="sxs-lookup"><span data-stu-id="a06d2-348">Using a Custom Base Class for Your ASP.NET Pages' Code-Behind Classes</span></span>](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="a06d2-349">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="a06d2-349">About the Author</span></span>

<span data-ttu-id="a06d2-350">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor wielu książek ASP/ASP. NET Books i założyciel of 4GuysFromRolla.com, pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="a06d2-350">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a06d2-351">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="a06d2-351">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a06d2-352">Jego Najnowsza książka to [*Sams ASP.NET 3,5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a06d2-352">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a06d2-353">Scott można uzyskać w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem swojego blogu w [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="a06d2-353">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="a06d2-354">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="a06d2-354">Special Thanks To</span></span>

<span data-ttu-id="a06d2-355">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="a06d2-355">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a06d2-356">Recenzenci liderzy dla tego samouczka to Zack Kowalski i suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="a06d2-356">Lead reviewers for this tutorial were Zack Jones and Suchi Banerjee.</span></span> <span data-ttu-id="a06d2-357">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="a06d2-357">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a06d2-358">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="a06d2-358">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a06d2-359">[Poprzednie](multiple-contentplaceholders-and-default-content-vb.md)
> [dalej](urls-in-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a06d2-359">[Previous](multiple-contentplaceholders-and-default-content-vb.md)
[Next](urls-in-master-pages-vb.md)</span></span>
