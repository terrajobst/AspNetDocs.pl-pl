---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Korzystanie z strony wzorcowej ze strony zawartości (VB) | Microsoft Docs
author: rick-anderson
description: Bada, jak wywoływać metody, ustawiać właściwości, itd. strony wzorcowej z kodu na stronie zawartości.
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: fe1f7b80b26ff25c1ce744e4f823e3fb35eea074
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74577288"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="ca0ab-103">Interakcja ze stroną wzorcową z poziomu strony zawartości (VB)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="ca0ab-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ca0ab-105">[Pobierz kod](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) lub [Pobierz plik PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-105">[Download Code](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="ca0ab-106">Bada, jak wywoływać metody, ustawiać właściwości, itd. strony wzorcowej z kodu na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="ca0ab-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="ca0ab-107">Introduction</span></span>

<span data-ttu-id="ca0ab-108">W ciągu ostatnich pięciu samouczków oglądamy sposób tworzenia strony wzorcowej, definiowania obszarów zawartości, wiązania ASP.NET stron ze stroną wzorcową i definiowania zawartości specyficznej dla strony.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="ca0ab-109">Gdy osoba odwiedzająca żąda określonej strony zawartości, znaczniki zawartości i stron wzorcowych są odrzucane w czasie wykonywania, co spowodowało renderowanie ujednoliconej hierarchii formantów.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="ca0ab-110">W związku z tym już widzimy, w jaki sposób Strona wzorcowa i jedna z jej stron zawartości mogą się z nią współdziałać: Strona zawartości sprawdza adiustację, aby odmówić, że jest to formant ContentPlaceHolder na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="ca0ab-111">Co jeszcze sprawdzimy, jak strona wzorcowa i strona zawartości mogą programistycznie współdziałać.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="ca0ab-112">Oprócz definiowania znaczników dla kontrolek ContentPlaceHolder na stronie wzorcowej, strona zawartości może również przypisywać wartości do właściwości publicznych swojej strony wzorcowej i wywoływać metody publiczne.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="ca0ab-113">Podobnie Strona wzorcowa może współdziałać ze swoimi stronami zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="ca0ab-114">Gdy interakcja programowa między wzorcem a stroną zawartości jest mniej wspólna niż interakcja między nimi, istnieje wiele scenariuszy, w których ta interakcja programowa jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="ca0ab-115">W tym samouczku sprawdzimy, jak strona zawartości może programowo współdziałać z jej stroną wzorcową. w następnym samouczku dowiesz się, jak strona wzorcowa może w podobny sposób korzystać z jej stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="ca0ab-116">Przykłady interakcji programistycznej między stroną zawartości a jej stroną wzorcową</span><span class="sxs-lookup"><span data-stu-id="ca0ab-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="ca0ab-117">Gdy określony region strony musi być skonfigurowany na podstawie strony na stronie, używamy kontrolki ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="ca0ab-118">Ale co się stało z sytuacją, w której większość stron musi emitować niektóre dane wyjściowe, ale niewielka liczba stron, którą trzeba dostosować, aby pokazać coś innego?</span><span class="sxs-lookup"><span data-stu-id="ca0ab-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="ca0ab-119">Taki przykład, który został zbadany w samouczku [*wielu elementów ContentPlaceHolders i domyślnej zawartości*](multiple-contentplaceholders-and-default-content-vb.md) , obejmuje wyświetlanie interfejsu logowania na każdej stronie.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="ca0ab-120">Chociaż większość stron powinna zawierać interfejs logowania, należy go pominąć dla kilku stron, takich jak: główna strona logowania (`Login.aspx`); na stronie Tworzenie konta; i inne strony, które są dostępne tylko dla uwierzytelnionych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="ca0ab-121">Samouczek [*wielu elementów ContentPlaceHolders i domyślnej zawartości*](multiple-contentplaceholders-and-default-content-vb.md) przedstawia sposób definiowania zawartości domyślnej dla elementu ContentPlaceHolder na stronie wzorcowej, a następnie sposobu przesłonięcia go na tych stronach, w których zawartość domyślna nie była pożądana.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="ca0ab-122">Innym rozwiązaniem jest utworzenie publicznej właściwości lub metody na stronie głównej, która wskazuje, czy ma być wyświetlany lub ukryty interfejs logowania.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="ca0ab-123">Na przykład strona wzorcowa może zawierać właściwość publiczną o nazwie `ShowLoginUI` której wartość została użyta do ustawienia właściwości `Visible` kontrolki logowania na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="ca0ab-124">Te strony zawartości, w których powinien być pominięty interfejs użytkownika logowania, mogą następnie programowo ustawić właściwość `ShowLoginUI` na `False`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="ca0ab-125">Prawdopodobnie najbardziej typowym przykładem interakcji dotyczącej zawartości i strony głównej występuje, gdy dane wyświetlane na stronie wzorcowej muszą zostać odświeżone po transpired na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="ca0ab-126">Rozważmy stronę wzorcową zawierającą widok GridView, który wyświetla pięć ostatnio dodanych rekordów z określonej tabeli bazy danych i że jedna z jej stron zawartości zawiera interfejs do dodawania nowych rekordów do tej samej tabeli.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="ca0ab-127">Gdy użytkownik odwiedzi stronę, aby dodać nowy rekord, zobaczy pięć ostatnio dodanych rekordów wyświetlanych na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="ca0ab-128">Po wypełnieniu wartości kolumn nowego rekordu przesyła formularz.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="ca0ab-129">Przy założeniu, że element GridView na stronie wzorcowej ma właściwość `EnableViewState` ustawioną na wartość true (domyślnie), jego zawartość jest ponownie ładowana ze stanu widoku i w związku z tym pięć identycznych rekordów jest wyświetlany, nawet jeśli nowszy rekord został właśnie dodany do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="ca0ab-130">Może to spowodować odmylić użytkownika.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-131">Nawet Jeśli wyłączysz stan widoku GridView, tak aby ponownie powiązać się z jego podstawowym źródłem danych przy każdym ogłaszaniu zwrotnym, nadal nie będzie można wyświetlić właśnie dodanego rekordu, ponieważ dane są powiązane z widokiem GridView wcześniej w cyklu życia strony niż w przypadku dodania nowego rekordu do DataB ASE.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="ca0ab-132">Aby rozwiązać ten sposób, tak że dodany rekord zostanie wyświetlony w widoku GridView strony głównej na stronie ogłaszania zwrotnego, musimy poinstruować element GridView o konieczności ponownego powiązania ze źródłem danych *po* dodaniu nowego rekordu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="ca0ab-133">Wymaga to interakcji między stronami zawartości i wzorca, ponieważ interfejs do dodawania nowego rekordu (i jego programów obsługi zdarzeń) znajduje się na stronie zawartości, ale widok GridView, który należy odświeżyć, znajduje się na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="ca0ab-134">Ponieważ odświeżenie wyświetlania strony wzorcowej z programu obsługi zdarzeń na stronie zawartości jest jednym z najpopularniejszych potrzeb dotyczących interakcji z zawartością i stroną wzorcową, zapoznaj się z tym tematem bardziej szczegółowo.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="ca0ab-135">Pobranie dla tego samouczka obejmuje bazę danych Microsoft SQL Server 2005 Express Edition o nazwie `NORTHWIND.MDF` w folderze `App_Data` witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="ca0ab-136">Baza danych Northwind przechowuje informacje o produktach, pracownikach i sprzedaży fikcyjnej firmy, Northwind Traders.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="ca0ab-137">Krok 1 przeprowadzi Cię przez wyświetlanie pięciu ostatnio dodanych produktów w widoku GridView na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="ca0ab-138">Krok 2 powoduje utworzenie strony zawartości służącej do dodawania nowych produktów.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="ca0ab-139">Krok 3. zawarto informacje na temat tworzenia publicznych właściwości i metod na stronie głównej, a krok 4 ilustruje programistyczny interfejs z tymi właściwościami i metodami ze strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-140">Ten samouczek nie zawiera elementów roboczych związanych z pracą z danymi w ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="ca0ab-141">Procedura konfigurowania strony wzorcowej w celu wyświetlania danych i strony zawartości służącej do wstawiania danych jest kompletna, ale Breezy.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="ca0ab-142">Aby uzyskać bardziej szczegółowe informacje na temat wyświetlania i wstawiania danych i korzystania z kontrolek kontrolki SqlDataSource i GridView, zapoznaj się z zasobami w sekcji dalsze informacje na końcu tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="ca0ab-143">Krok 1. Wyświetlanie pięciu ostatnio dodanych produktów na stronie wzorcowej</span><span class="sxs-lookup"><span data-stu-id="ca0ab-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="ca0ab-144">Otwórz stronę wzorcową site. Master i Dodaj etykietę i kontrolkę GridView do `<div>``leftContent`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="ca0ab-145">Wyczyść Właściwość `Text` etykiety, ustaw jej Właściwość `EnableViewState` na `False`i Właściwość `ID` na `GridMessage`. Ustaw właściwość `ID` GridView na `RecentProducts`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="ca0ab-146">Następnie z projektanta rozwiń tag inteligentny GridView i wybierz powiązanie go z nowym źródłem danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="ca0ab-147">Spowoduje to uruchomienie Kreatora konfiguracji źródła danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="ca0ab-148">Ponieważ baza danych Northwind w folderze `App_Data` jest bazą danych Microsoft SQL Server, wybierz opcję utworzenia kontrolki SqlDataSource, wybierając pozycję (patrz rysunek 1). Nazwij `RecentProductsDataSource`kontrolki SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="ca0ab-149">[![powiązać widoku GridView z kontrolką kontrolki SqlDataSource o nazwie RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="ca0ab-150">**Ilustracja 01**. powiązanie widoku GridView z kontrolką kontrolki SqlDataSource o nazwie `RecentProductsDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="ca0ab-151">Następny krok prosi nas o określenie bazy danych, z którą ma zostać nawiązane połączenie.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="ca0ab-152">Z listy rozwijanej wybierz plik bazy danych `NORTHWIND.MDF` i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="ca0ab-153">Ponieważ ta baza danych jest używana po raz pierwszy, Kreator będzie oferować przechowywanie parametrów połączenia w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="ca0ab-154">Przechowuj parametry połączenia przy użyciu nazwy `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="ca0ab-155">[![połączyć się z bazą danych Northwind](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="ca0ab-156">**Ilustracja 02**. Łączenie się z bazą danych Northwind ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="ca0ab-157">Kreator konfiguracji źródła danych udostępnia dwie metody, za pomocą których można określić zapytanie używane do pobierania danych:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="ca0ab-158">Określenie niestandardowej instrukcji SQL lub procedury składowanej lub</span><span class="sxs-lookup"><span data-stu-id="ca0ab-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="ca0ab-159">Wybierając tabelę lub widok, a następnie określając kolumny do zwrócenia</span><span class="sxs-lookup"><span data-stu-id="ca0ab-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="ca0ab-160">Ponieważ chcemy zwrócić tylko pięć ostatnio dodanych produktów, musimy określić niestandardową instrukcję SQL.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="ca0ab-161">Użyj następującego `SELECT` kwerendy:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="ca0ab-162">Słowo kluczowe `TOP 5` zwraca tylko pięć pierwszych rekordów z zapytania.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="ca0ab-163">Klucz podstawowy tabeli `Products`, `ProductID`, jest kolumną `IDENTITY`, która zapewnia nam, że każdy nowy produkt dodany do tabeli będzie miał większą wartość niż poprzedni wpis.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="ca0ab-164">W związku z tym sortowanie wyników według `ProductID` w kolejności malejącej zwraca Produkty zaczynające się od ostatnio utworzonych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="ca0ab-165">[![zwrócić pięć ostatnio dodanych produktów](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="ca0ab-166">**Rysunek 03**: Zwróć pięć ostatnio dodanych produktów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="ca0ab-167">Po zakończeniu działania kreatora program Visual Studio generuje dwie BoundFieldsy dla widoku GridView w celu wyświetlenia `ProductName` i `UnitPrice` pól zwróconych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="ca0ab-168">W tym momencie deklaracyjne znaczniki strony wzorcowej powinny zawierać znaczniki podobne do następujących:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="ca0ab-169">Jak widać, znacznik zawiera: kontrolka sieci Web etykiety (`GridMessage`); `RecentProducts`GridView, z dwoma BoundFields; i kontrolka kontrolki SqlDataSource, która zwraca pięć ostatnio dodanych produktów.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="ca0ab-170">Po utworzeniu tego widoku GridView i skonfigurowaniu jego kontrolki kontrolki SqlDataSource odwiedź witrynę internetową za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="ca0ab-171">Jak pokazano na rysunku 4, w lewym dolnym rogu zobaczysz siatkę zawierającą pięć ostatnio dodanych produktów.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="ca0ab-172">[![GridView wyświetla pięć ostatnio dodanych produktów](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="ca0ab-173">**Ilustracja 04**: w widoku GridView są wyświetlane pięć ostatnio dodanych produktów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-174">Możesz wyczyścić wygląd GridView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="ca0ab-175">Niektóre sugestie obejmują formatowanie wyświetlanej wartości `UnitPrice` jako waluty i używanie kolorów i czcionek tła w celu poprawienia wyglądu siatki.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="ca0ab-176">Krok 2. Tworzenie strony zawartości w celu dodania nowych produktów</span><span class="sxs-lookup"><span data-stu-id="ca0ab-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="ca0ab-177">Następnym zadaniem jest utworzenie strony zawartości, za pomocą której użytkownik może dodać nowy produkt do tabeli `Products`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="ca0ab-178">Dodaj nową stronę zawartości do folderu `Admin` o nazwie `AddProduct.aspx`, aby upewnić się, że należy powiązać ją ze stroną wzorcową `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="ca0ab-179">Rysunek 5 przedstawia Eksplorator rozwiązań po dodaniu tej strony do witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="ca0ab-180">[![dodać nową stronę ASP.NET do folderu Admin](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="ca0ab-181">**Ilustracja 05**. Dodawanie nowej strony ASP.NET do folderu `Admin` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="ca0ab-182">Odwołaj ten element w [*temacie Określanie tytułu, Meta tagów i innych nagłówków HTML na stronie wzorcowej*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) — samouczek został utworzony za pomocą niestandardowej klasy strony podstawowej o nazwie `BasePage`, która wygenerowała tytuł strony, jeśli nie została ustawiona jawnie.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="ca0ab-183">Przejdź do klasy powiązanej z kodem `AddProduct.aspx` strony i utwórz ją od `BasePage` (zamiast z `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="ca0ab-184">Na koniec Zaktualizuj plik `Web.sitemap`, aby zawierał wpis do tej lekcji.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="ca0ab-185">Dodaj następujące oznakowanie poniżej `<siteMapNode>` dla błędów nazewnictwa identyfikatora formantu lekcja:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="ca0ab-186">Jak pokazano na rysunku 6, Dodawanie tego elementu `<siteMapNode>` jest odzwierciedlone na liście lekcji.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="ca0ab-187">Wróć do `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="ca0ab-188">W kontrolce zawartości dla `MainContent` ContentPlaceHolder Dodaj kontrolkę DetailsView i nadaj jej nazwę `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="ca0ab-189">Powiąż element DetailsView z nową kontrolką kontrolki SqlDataSource o nazwie `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="ca0ab-190">Podobnie jak w przypadku kontrolki SqlDataSource w kroku 1, należy skonfigurować kreatora tak, aby używał bazy danych Northwind, i wybrać opcję określenia niestandardowej instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="ca0ab-191">Ponieważ DetailsView zostanie użyty do dodawania elementów do bazy danych, musimy określić zarówno instrukcję `SELECT`, jak i instrukcję `INSERT`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="ca0ab-192">Użyj następującego `SELECT` kwerendy:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="ca0ab-193">Następnie na karcie Wstawianie Dodaj następującą instrukcję `INSERT`:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="ca0ab-194">Po zakończeniu działania kreatora przejdź do tagu inteligentnego DetailsView i zaznacz pole wyboru "Włącz wstawianie".</span><span class="sxs-lookup"><span data-stu-id="ca0ab-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="ca0ab-195">Spowoduje to dodanie CommandField do widoku DetailsView z właściwością `ShowInsertButton` ustawioną na wartość true.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="ca0ab-196">Ponieważ ten DetailsView zostanie użyty wyłącznie do wstawiania danych, ustaw właściwość `DefaultMode` DetailsView na `Insert`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="ca0ab-197">To wszystko.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-197">That's all there is to it!</span></span> <span data-ttu-id="ca0ab-198">Przetestujmy Tę stronę.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-198">Let's test this page.</span></span> <span data-ttu-id="ca0ab-199">Odwiedź witrynę `AddProduct.aspx` za pomocą przeglądarki, wprowadź nazwę i cenę (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="ca0ab-200">[![dodać nowego produktu do bazy danych](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="ca0ab-201">**Ilustracja 06**. Dodawanie nowego produktu do bazy danych ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="ca0ab-202">Po wpisaniu nazwy i ceny nowego produktu kliknij przycisk Wstaw.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="ca0ab-203">Powoduje to odświeżenie formularza.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-203">This causes the form to postback.</span></span> <span data-ttu-id="ca0ab-204">Na stronie ogłaszania zwrotnego jest wykonywana instrukcja `INSERT` kontrolki kontrolki SqlDataSource. dwa parametry są wypełniane wartościami wprowadzonymi przez użytkownika w dwóch kontrolkach pola tekstowego DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="ca0ab-205">Niestety, nie ma wizualizacji wizualnej, która wystąpiła operacja wstawiania.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="ca0ab-206">Najprawdopodobniej będzie wyświetlany komunikat z potwierdzeniem, że został dodany nowy rekord.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="ca0ab-207">Jestem tym ćwiczeniem dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="ca0ab-208">Ponadto po dodaniu nowego rekordu z widoku DetailsView widok GridView na stronie wzorcowej nadal pokazuje te same pięć rekordów jak poprzednio; nie obejmuje to właśnie dodanego rekordu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="ca0ab-209">Sprawdzimy, jak to naprawić w nadchodzących krokach.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-210">Oprócz dodania formy wizualnej opinii, że Wstawianie zakończyło się pomyślnie, zachęcamy do aktualizowania interfejsu wstawiania w widoku DetailsView w celu uwzględnienia weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="ca0ab-211">Obecnie nie jest przeprowadzana Walidacja.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-211">Currently, there is no validation.</span></span> <span data-ttu-id="ca0ab-212">Jeśli użytkownik wprowadzi nieprawidłową wartość pola `UnitPrice`, na przykład "zbyt kosztowna", zostanie zgłoszony wyjątek na stronie ogłaszania zwrotnego, gdy system próbuje skonwertować ten ciąg na wartość dziesiętną.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="ca0ab-213">Aby uzyskać więcej informacji na temat dostosowywania interfejsu wstawiania, zapoznaj się z [samouczkiem *Dostosowywanie interfejsu modyfikacji danych* ](https://asp.net/learn/data-access/tutorial-20-vb.aspx) z [serii praca z samouczkiem dotyczącym danych](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="ca0ab-214">Krok 3. Tworzenie publicznych właściwości i metod na stronie wzorcowej</span><span class="sxs-lookup"><span data-stu-id="ca0ab-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="ca0ab-215">W kroku 1 dodaliśmy kontrolkę sieci Web etykieta o nazwie `GridMessage` nad elementem GridView na stronie wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="ca0ab-216">Ta etykieta jest przeznaczona do opcjonalnego wyświetlania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="ca0ab-217">Na przykład po dodaniu nowego rekordu do tabeli `Products` może być konieczne wyświetlenie komunikatu z komunikatem "*NazwaProduktu* został dodany do bazy danych".</span><span class="sxs-lookup"><span data-stu-id="ca0ab-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="ca0ab-218">Zamiast nadawać twardemu kodowi tekst dla tej etykiety na stronie wzorcowej, możemy chcieć, aby wiadomość była dostosowywana na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="ca0ab-219">Ponieważ kontrolka Label jest zaimplementowana jako chroniona zmienna składowa na stronie wzorcowej, nie można uzyskać do niej dostępu bezpośrednio z poziomu stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="ca0ab-220">Aby można było korzystać z etykiety na stronie wzorcowej ze strony zawartości (lub, w tym przypadku, każda kontrolka sieci Web na stronie głównej) musi utworzyć właściwość publiczną na stronie wzorcowej, która uwidacznia formant sieci Web lub służy jako serwer proxy, za pomocą którego jedna z jego właściwości może być  otworzyć.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="ca0ab-221">Dodaj następującą składnię do klasy powiązanej z kodem strony wzorcowej, aby uwidocznić Właściwość `Text` etykiety:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="ca0ab-222">Gdy nowy rekord zostanie dodany do tabeli `Products` ze strony zawartości, `RecentProducts` GridView na stronie wzorcowej musi ponownie powiązać się ze swoim podstawowym źródłem danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="ca0ab-223">Aby ponownie powiązać element GridView, wywołaj jego metodę `DataBind`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="ca0ab-224">Ponieważ GridView na stronie wzorcowej nie jest programistycznie dostępny dla stron zawartości, musimy utworzyć metodę publiczną na stronie wzorcowej, która po wywołaniu powoduje ponowne powiązanie danych z elementem GridView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="ca0ab-225">Dodaj następującą metodę do klasy z kodem powiązanej ze stroną wzorcową:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="ca0ab-226">Mając Właściwość `GridMessageText` i metodę `RefreshRecentProductsGrid` na miejscu, każda strona zawartości może programowo ustawić lub odczytać wartość właściwości `Text` etykiety `GridMessage` lub ponownie powiązać dane z `RecentProducts` GridView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="ca0ab-227">Krok 4. badanie, jak uzyskać dostęp do publicznych właściwości i metod strony wzorcowej ze strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-228">Nie zapomnij oznaczyć właściwości i metod strony wzorcowej jako `Public`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="ca0ab-229">Jeśli te właściwości i metody nie są jawnie oznaczone jako `Public`, nie będą dostępne ze strony zawartość.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="ca0ab-230">Krok 4. wywoływanie publicznych członków strony wzorcowej ze strony zawartości</span><span class="sxs-lookup"><span data-stu-id="ca0ab-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="ca0ab-231">Teraz, gdy Strona główna ma niezbędne właściwości i metody publiczne, możemy wywoływać te właściwości i metody ze strony zawartości `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="ca0ab-232">W szczególnych przypadkach musimy ustawić właściwość `GridMessageText` strony głównej i wywołać jej metodę `RefreshRecentProductsGrid` po dodaniu nowego produktu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="ca0ab-233">Wszystkie kontrolki sieci Web danych ASP.NET wyzwalają zdarzenia bezpośrednio przed i po wykonaniu różnych zadań, które ułatwiają deweloperom stron wykonywanie niektórych działań programistycznych przed lub po zadaniu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="ca0ab-234">Na przykład gdy użytkownik końcowy kliknie przycisk wstawiania w widoku DetailsView, w przypadku ogłaszania zwrotnego, w trakcie odświeżania, DetailsView wygeneruje zdarzenie `ItemInserting` przed rozpoczęciem wstawiania przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="ca0ab-235">Następnie wstawia rekord do bazy danych programu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-235">It then inserts the record into the database.</span></span> <span data-ttu-id="ca0ab-236">Poniżej znajduje się zdarzenie `ItemInserted` w widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="ca0ab-237">Dlatego w celu pracy z stroną wzorcową po dodaniu nowego produktu Utwórz procedurę obsługi zdarzeń dla zdarzenia `ItemInserted` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="ca0ab-238">Istnieją dwa sposoby programistycznego interfejsu strony zawartości z jej stroną wzorcową:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="ca0ab-239">Za pomocą właściwości `Page.Master`, która zwraca swobodnie wpisane odwołanie do strony głównej lub</span><span class="sxs-lookup"><span data-stu-id="ca0ab-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="ca0ab-240">Określ typ strony głównej strony lub ścieżkę do pliku za pomocą dyrektywy `@MasterType`. spowoduje to automatyczne dodanie właściwości o jednoznacznie określonym typie do strony o nazwie `Master`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="ca0ab-241">Przeanalizujmy oba podejścia.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="ca0ab-242">Korzystanie z właściwości`Page.Master`ze swobodnym typem</span><span class="sxs-lookup"><span data-stu-id="ca0ab-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="ca0ab-243">Wszystkie strony sieci Web ASP.NET muszą pochodzić od klasy `Page`, która znajduje się w przestrzeni nazw `System.Web.UI`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="ca0ab-244">Klasa `Page` zawiera [właściwość`Master`](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) , która zwraca odwołanie do strony wzorcowej strony.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="ca0ab-245">Jeśli strona nie zawiera strony wzorcowej `Master` zwraca `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="ca0ab-246">Właściwość `Master` zwraca obiekt typu [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (znajdujący się również w `System.Web.UI` przestrzeni nazw), który jest typem podstawowym, z którego pochodzą wszystkie strony wzorcowe.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="ca0ab-247">W związku z tym, aby użyć publicznych właściwości lub metod zdefiniowanych na stronie głównej witryny sieci Web, należy rzutować `MasterPage` obiektu zwróconego z właściwości `Master` na odpowiedni typ.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="ca0ab-248">Ze względu na to, że nazywamy nasze `Site.master`pliku strony głównej, Klasa z kodem jest nazywana `Site`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="ca0ab-249">W związku z tym Poniższy kod rzutuje Właściwość `Page.Master` na wystąpienie klasy `Site`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="ca0ab-250">Teraz, gdy do typu witryny została powiązana właściwość `Page.Master` o swobodnym typie, możemy odwoływać się do właściwości i metod specyficznych dla lokacji.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="ca0ab-251">Jak pokazano na rysunku 7, właściwość publiczna `GridMessageText` pojawia się na liście rozwijanej IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="ca0ab-252">[![technologia IntelliSense wyświetla publiczne właściwości i metody strony głównej](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="ca0ab-253">**Ilustracja 07**. Technologia IntelliSense wyświetla publiczne właściwości i metody strony głównej ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-254">Jeśli nazwa pliku strony głównej jest nazywana `MasterPage.master`, nazwa klasy na stronie wzorcowej jest `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="ca0ab-255">Może to prowadzić do niejednoznaczności kodu podczas rzutowania z typu `System.Web.UI.MasterPage` do klasy `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="ca0ab-256">Krótko mówiąc, należy w pełni zakwalifikować typ, do którego jest dokonywane rzutowanie, co może być nieco trudne w przypadku korzystania z modelu projektu witryny sieci Web.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="ca0ab-257">Moja sugestia powinna mieć pewność, że podczas tworzenia strony wzorcowej należy podać nazwę inną niż `MasterPage.master` lub, a nawet lepiej, utworzyć odwołanie o jednoznacznie określonym typie do strony głównej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="ca0ab-258">Tworzenie odwołania o jednoznacznie określonym typie za pomocą dyrektywy`@MasterType`</span><span class="sxs-lookup"><span data-stu-id="ca0ab-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="ca0ab-259">Jeśli dokładnie widzisz, że Klasa ASP.NET strony z kodem jest klasą częściową (należy zwrócić uwagę na słowo kluczowe `Partial` w definicji klasy).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="ca0ab-260">Klasy częściowe zostały wprowadzone w C# systemach i Visual Basic with.NET Framework 2,0 i w Nutshell umożliwiają definiowanie elementów członkowskich klasy w wielu plikach.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="ca0ab-261">Plik klasy związanej z kodem — `AddProduct.aspx.vb`, na przykład — zawiera kod, który został utworzony przez nas, a my.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="ca0ab-262">Oprócz naszego kodu aparat ASP.NET automatycznie tworzy oddzielny plik klasy z właściwościami i obsługą zdarzeń w programie, który tłumaczy deklaratywne znaczniki na hierarchię klas strony.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="ca0ab-263">Automatyczne generowanie kodu, które odbywa się za każdym razem, gdy strona ASP.NET jest odwiedzana paves w sposób nieinteresujący i przydatny.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="ca0ab-264">W przypadku stron wzorcowych, jeśli poinformujemy aparat ASP.NET o tym, która strona wzorcowa jest używana przez naszą stronę zawartości, generuje dla nas silnie wpisaną Właściwość `Master`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="ca0ab-265">Użyj [dyrektywy`@MasterType`](https://msdn.microsoft.com/library/ms228274.aspx) , aby poinformować aparat ASP.NET o typie strony głównej strony zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="ca0ab-266">Dyrektywa `@MasterType` może zaakceptować nazwę typu strony wzorcowej lub ścieżki pliku.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="ca0ab-267">Aby określić, że strona `AddProduct.aspx` używa `Site.master` jako strony głównej, Dodaj następującą dyrektywę na początku `AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="ca0ab-268">Ta dyrektywa nakazuje aparatowi ASP.NET Dodawanie odwołania o jednoznacznie określonym typie do strony wzorcowej za pomocą właściwości o nazwie `Master`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="ca0ab-269">W przypadku dyrektywy `@MasterType` na miejscu możemy wywoływać publiczne właściwości i metody strony wzorcowej `Site.master` bezpośrednio przez właściwość `Master` bez rzutowania.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="ca0ab-270">W przypadku pominięcia dyrektywy `@MasterType` składnia `Page.Master` i `Master` zwrócić te same czynności: obiekt z swobodnym typem na stronę wzorcową strony.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="ca0ab-271">Jeśli dołączysz dyrektywę `@MasterType`, `Master` zwraca odwołanie o jednoznacznie określonym typie do określonej strony głównej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="ca0ab-272">`Page.Master`jednak nadal zwraca odwołanie o swobodnym typie.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="ca0ab-273">Aby uzyskać bardziej szczegółowe informacje na temat tego, jak jest to przypadek i jak tworzona jest właściwość `Master`, gdy dyrektywa `@MasterType` jest uwzględniona, zobacz artykuł [K. Scott](http://odetocode.com/blogs/scott/default.aspx) [2,0 ASP.NET —`@MasterType` wpis w](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)blogu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="ca0ab-274">Aktualizowanie strony wzorcowej po dodaniu nowego produktu</span><span class="sxs-lookup"><span data-stu-id="ca0ab-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="ca0ab-275">Teraz, gdy wiemy, jak wywoływać publiczne właściwości i metody strony wzorcowej ze strony zawartości, jesteśmy gotowi do zaktualizowania strony `AddProduct.aspx`, aby Strona główna była odświeżana po dodaniu nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="ca0ab-276">Na początku kroku 4 utworzyliśmy procedurę obsługi zdarzeń dla zdarzenia `ItemInserting` formantu DetailsView, które jest wykonywane natychmiast po dodaniu nowego produktu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="ca0ab-277">Dodaj następujący kod do tego programu obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="ca0ab-278">Powyższy kod używa zarówno właściwości `Page.Master` o swobodnym typie i właściwości `Master` o jednoznacznie określonym typie.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="ca0ab-279">Należy pamiętać, że właściwość `GridMessageText` jest ustawiona na wartość "*ProductName* dodana do siatki..." Wartości dodanego produktu są dostępne za pomocą kolekcji `e.Values`; Jak widać, dodaliśmy wartość `ProductName` można uzyskać za pośrednictwem `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="ca0ab-280">Na rysunku nr 8 przedstawiono stronę `AddProduct.aspx` natychmiast po nowym produkcie — Scott, który został dodany do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="ca0ab-281">Należy zauważyć, że nazwa dodanego produktu jest zapisywana na etykiecie strony wzorcowej i że widok GridView został odświeżony w celu uwzględnienia produktu i jego ceny.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="ca0ab-282">[![etykietę strony wzorcowej i widok GridView Pokaż produkt dodany](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="ca0ab-283">**Ilustracja 08**: etykieta strony wzorcowej i widok GridView pokazują produkt dodany ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ca0ab-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ca0ab-284">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="ca0ab-284">Summary</span></span>

<span data-ttu-id="ca0ab-285">Najlepiej, gdy strona wzorcowa i jej strony zawartości są całkowicie oddzielone od siebie i nie wymagają interakcji.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="ca0ab-286">Gdy strony wzorcowe i strony zawartości powinny być zaprojektowane z tym celem, istnieje kilka typowych scenariuszy, w których strona zawartości musi mieć interfejs ze stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="ca0ab-287">Jednym z najczęstszych centrów przyczyn dotyczących aktualizowania określonej części ekranu głównego na podstawie niektórych akcji, które transpired na stronie zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="ca0ab-288">Dobra wiadomość polega na tym, że jest stosunkowo prosta, aby strona zawartości była programowo współdziałać ze stroną wzorcową.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="ca0ab-289">Zacznij od utworzenia publicznych właściwości lub metod na stronie wzorcowej, które hermetyzują funkcje, które muszą być wywoływane przez stronę zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="ca0ab-290">Następnie na stronie zawartość Uzyskuj dostęp do właściwości i metod strony wzorcowej za pomocą właściwości `Page.Master` o swobodnym typie lub użyj dyrektywy `@MasterType`, aby utworzyć odwołanie z jednoznacznie określonymi typami do strony głównej.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="ca0ab-291">W następnym samouczku sprawdzimy, jak strona wzorcowa może programistycznie korzystać z jednej z jej stron zawartości.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="ca0ab-292">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="ca0ab-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ca0ab-293">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="ca0ab-293">Further Reading</span></span>

<span data-ttu-id="ca0ab-294">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="ca0ab-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ca0ab-295">Uzyskiwanie dostępu do danych i aktualizowanie ich w programie ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ca0ab-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="ca0ab-296">ASP.NET strony wzorcowe: porady, wskazówki i pułapki</span><span class="sxs-lookup"><span data-stu-id="ca0ab-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="ca0ab-297">`@MasterType` w ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="ca0ab-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="ca0ab-298">Przekazywanie informacji między zawartością a stronami wzorcowymi</span><span class="sxs-lookup"><span data-stu-id="ca0ab-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="ca0ab-299">Praca z danymi w samouczkach ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ca0ab-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="ca0ab-300">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="ca0ab-300">About the Author</span></span>

<span data-ttu-id="ca0ab-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor wielu książek ASP/ASP. NET Books i założyciel of 4GuysFromRolla.com, pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ca0ab-302">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ca0ab-303">Jego Najnowsza książka to [*Sams ASP.NET 3,5 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="ca0ab-304">Scott można uzyskać w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) lub za pośrednictwem swojego blogu w [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="ca0ab-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ca0ab-305">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="ca0ab-305">Special Thanks To</span></span>

<span data-ttu-id="ca0ab-306">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ca0ab-307">Recenzent potencjalnych klientów dla tego samouczka został Zack Nowak.</span><span class="sxs-lookup"><span data-stu-id="ca0ab-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="ca0ab-308">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="ca0ab-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ca0ab-309">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ca0ab-310">[Poprzednie](control-id-naming-in-content-pages-vb.md)
> [dalej](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ca0ab-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
