---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
title: Wprowadzenie z Entity Framework 4,0 Database First i ASP.NET 4 Web Forms — część 2 | Microsoft Docs
author: tdykstra
description: Przykładowa aplikacja internetowa Contoso University pokazuje, jak tworzyć aplikacje ASP.NET Web Forms przy użyciu Entity Framework. Przykładowa aplikacja to...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: fb63a326-a4ae-4b0c-a4f5-412327197216
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
msc.type: authoredcontent
ms.openlocfilehash: bd6a2e29e6f0df04e39be29160e2e08cc99c4706
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78566011"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-2"></a><span data-ttu-id="06e16-104">Wprowadzenie z Entity Framework 4,0 Database First i ASP.NET 4 Web Forms — część 2</span><span class="sxs-lookup"><span data-stu-id="06e16-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 2</span></span>

<span data-ttu-id="06e16-105">Autor [Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="06e16-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="06e16-106">Przykładowa aplikacja internetowa Contoso University pokazuje, jak tworzyć aplikacje ASP.NET Web Forms przy użyciu Entity Framework 4,0 i programu Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="06e16-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="06e16-107">Aby uzyskać informacje na temat serii samouczków, zobacz [pierwszy samouczek w serii](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="06e16-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="the-entitydatasource-control"></a><span data-ttu-id="06e16-108">Formant EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="06e16-108">The EntityDataSource Control</span></span>

<span data-ttu-id="06e16-109">W poprzednim samouczku została utworzona witryna sieci Web, baza danych i model danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-109">In the previous tutorial you created a web site, a database, and a data model.</span></span> <span data-ttu-id="06e16-110">W tym samouczku poznasz formant `EntityDataSource`, który ASP.NET zapewnia, aby ułatwić współpracę z Entity Framework modelem danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-110">In this tutorial you work with the `EntityDataSource` control that ASP.NET provides in order to make it easy to work with an Entity Framework data model.</span></span> <span data-ttu-id="06e16-111">Utworzysz kontrolkę `GridView` do wyświetlania i edytowania danych uczniów, kontrolki `DetailsView` do dodawania nowych uczniów oraz `DropDownList` kontroli wybierania działu (którego będziesz używać później do wyświetlania skojarzonych kursów).</span><span class="sxs-lookup"><span data-stu-id="06e16-111">You'll create a `GridView` control for displaying and editing student data, a `DetailsView` control for adding new students, and a `DropDownList` control for selecting a department (which you'll use later for displaying associated courses).</span></span>

<span data-ttu-id="06e16-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span></span>

<span data-ttu-id="06e16-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span></span>

<span data-ttu-id="06e16-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span></span>

<span data-ttu-id="06e16-115">Zwróć uwagę, że w tej aplikacji nie będziesz dodawać walidacji danych wejściowych do stron, które aktualizują bazę danych, a niektóre z nich nie będą tak niezawodne, jak byłyby wymagane w aplikacji produkcyjnej.</span><span class="sxs-lookup"><span data-stu-id="06e16-115">Note that in this application you won't be adding input validation to pages that update the database, and some of the error handling will not be as robust as would be required in a production application.</span></span> <span data-ttu-id="06e16-116">Dzięki temu samouczek jest ukierunkowany na Entity Framework i utrzymuje zbyt długi czas.</span><span class="sxs-lookup"><span data-stu-id="06e16-116">That keeps the tutorial focused on the Entity Framework and keeps it from getting too long.</span></span> <span data-ttu-id="06e16-117">Aby uzyskać szczegółowe informacje na temat sposobu dodawania tych funkcji do aplikacji, zobacz [Weryfikowanie danych wejściowych użytkownika na stronach sieci Web ASP.NET](https://msdn.microsoft.com/library/7kh55542.aspx) i [obsługa błędów w ASP.NET stronach i aplikacjach](https://msdn.microsoft.com/library/w16865z6.aspx).</span><span class="sxs-lookup"><span data-stu-id="06e16-117">For details about how to add these features to your application, see [Validating User Input in ASP.NET Web Pages](https://msdn.microsoft.com/library/7kh55542.aspx) and [Error Handling in ASP.NET Pages and Applications](https://msdn.microsoft.com/library/w16865z6.aspx).</span></span>

## <a name="adding-and-configuring-the-entitydatasource-control"></a><span data-ttu-id="06e16-118">Dodawanie i Konfigurowanie kontrolki EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="06e16-118">Adding and Configuring the EntityDataSource Control</span></span>

<span data-ttu-id="06e16-119">Zaczniesz od skonfigurowania formantu `EntityDataSource`, aby odczytywać jednostki `Person` z zestawu jednostek `People`.</span><span class="sxs-lookup"><span data-stu-id="06e16-119">You'll begin by configuring an `EntityDataSource` control to read `Person` entities from the `People` entity set.</span></span>

<span data-ttu-id="06e16-120">Upewnij się, że masz otwarty program Visual Studio i że pracujesz nad projektem utworzonym w części 1.</span><span class="sxs-lookup"><span data-stu-id="06e16-120">Make sure you have Visual Studio open and that you're working with the project you created in part 1.</span></span> <span data-ttu-id="06e16-121">Jeśli projekt nie został skompilowany od czasu utworzenia modelu danych lub od momentu ostatniej zmiany w nim, Skompiluj projekt teraz.</span><span class="sxs-lookup"><span data-stu-id="06e16-121">If you haven't built the project since you created the data model or since the last change you made to it, build the project now.</span></span> <span data-ttu-id="06e16-122">Zmiany w modelu danych nie są udostępniane projektantowi do czasu skompilowania projektu.</span><span class="sxs-lookup"><span data-stu-id="06e16-122">Changes to the data model are not made available to the designer until the project is built.</span></span>

<span data-ttu-id="06e16-123">Utwórz nową stronę sieci Web przy użyciu **formularza sieci Web przy użyciu szablonu strony głównej** , a następnie nadaj mu nazwę *Students. aspx*.</span><span class="sxs-lookup"><span data-stu-id="06e16-123">Create a new web page using the **Web Form using Master Page** template, and name it *Students.aspx*.</span></span>

<span data-ttu-id="06e16-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span></span>

<span data-ttu-id="06e16-125">Określ wartość *site. Master* jako stronę wzorcową.</span><span class="sxs-lookup"><span data-stu-id="06e16-125">Specify *Site.Master* as the master page.</span></span> <span data-ttu-id="06e16-126">Na wszystkich stronach utworzonych dla tych samouczków zostanie użyta ta strona wzorcowa.</span><span class="sxs-lookup"><span data-stu-id="06e16-126">All of the pages you create for these tutorials will use this master page.</span></span>

<span data-ttu-id="06e16-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span></span>

<span data-ttu-id="06e16-128">W widoku **źródła** dodaj nagłówek `h2` do kontrolki `Content` o nazwie `Content2`, jak pokazano w następującym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="06e16-128">In **Source** view, add an `h2` heading to the `Content` control named `Content2`, as shown in the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample1.aspx)]

<span data-ttu-id="06e16-129">Na karcie **dane** w **przyborniku**przeciągnij kontrolkę `EntityDataSource` na stronę, upuść ją pod nagłówkiem i zmień identyfikator, aby `StudentsEntityDataSource`:</span><span class="sxs-lookup"><span data-stu-id="06e16-129">From the **Data** tab of the **Toolbox**, drag an `EntityDataSource` control to the page, drop it below the heading, and change the ID to `StudentsEntityDataSource`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample2.aspx)]

<span data-ttu-id="06e16-130">Przełącz się do widoku **projektu** , kliknij tag inteligentny kontroli źródła danych, a następnie kliknij przycisk **Konfiguruj źródło danych** , aby uruchomić kreatora **konfiguracji źródła danych** .</span><span class="sxs-lookup"><span data-stu-id="06e16-130">Switch to **Design** view, click the data source control's smart tag, and then click **Configure Data Source** to launch the **Configure Data Source** wizard.</span></span>

<span data-ttu-id="06e16-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span></span>

<span data-ttu-id="06e16-132">W kroku **Konfiguruj** pracę kreatora, wybierz opcję **SchoolEntities** jako wartość **nazwanego połączenia**i wybierz pozycję **SchoolEntities** jako wartość **DefaultContainerName** .</span><span class="sxs-lookup"><span data-stu-id="06e16-132">In the **Configure ObjectContext** wizard step, select **SchoolEntities** as the value for **Named Connection**, and select **SchoolEntities** as the **DefaultContainerName** value.</span></span> <span data-ttu-id="06e16-133">Następnie kliknij przycisk **Next** (Dalej).</span><span class="sxs-lookup"><span data-stu-id="06e16-133">Then click **Next**.</span></span>

<span data-ttu-id="06e16-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span></span>

<span data-ttu-id="06e16-135">Uwaga: Jeśli w tym momencie zostanie wyświetlone następujące okno dialogowe, należy skompilować projekt przed kontynuowaniem.</span><span class="sxs-lookup"><span data-stu-id="06e16-135">Note: If you get the following dialog box at this point, you have to build the project before proceeding.</span></span>

<span data-ttu-id="06e16-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span></span>

<span data-ttu-id="06e16-137">W kroku **Konfigurowanie wyboru danych** wybierz **osoby** jako wartość dla **obiektu entitySetName**.</span><span class="sxs-lookup"><span data-stu-id="06e16-137">In the **Configure Data Selection** step, select **People** as the value for **EntitySetName**.</span></span> <span data-ttu-id="06e16-138">W obszarze **Wybierz**upewnij się, że zaznaczone jest pole wyboru **zaznacz** wszystko.</span><span class="sxs-lookup"><span data-stu-id="06e16-138">Under **Select**, make sure the **Select A** ll check box is selected.</span></span> <span data-ttu-id="06e16-139">Następnie wybierz opcje, aby włączyć aktualizowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="06e16-139">Then select the options to enable update and delete.</span></span> <span data-ttu-id="06e16-140">Gdy skończysz, kliknij przycisk **Zakończ**.</span><span class="sxs-lookup"><span data-stu-id="06e16-140">When you're done, click **Finish**.</span></span>

<span data-ttu-id="06e16-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span></span>

## <a name="configuring-database-rules-to-allow-deletion"></a><span data-ttu-id="06e16-142">Konfigurowanie reguł bazy danych w celu umożliwienia usuwania</span><span class="sxs-lookup"><span data-stu-id="06e16-142">Configuring Database Rules to Allow Deletion</span></span>

<span data-ttu-id="06e16-143">Zostanie utworzona strona umożliwiająca użytkownikom usuwanie uczniów z tabeli `Person`, która ma trzy relacje z innymi tabelami (`Course`, `StudentGrade`i `OfficeAssignment`).</span><span class="sxs-lookup"><span data-stu-id="06e16-143">You'll be creating a page that lets users delete students from the `Person` table, which has three relationships with other tables (`Course`, `StudentGrade`, and `OfficeAssignment`).</span></span> <span data-ttu-id="06e16-144">Domyślnie baza danych uniemożliwi usunięcie wiersza w `Person`, jeśli istnieją powiązane wiersze w jednej z innych tabel.</span><span class="sxs-lookup"><span data-stu-id="06e16-144">By default, the database will prevent you from deleting a row in `Person` if there are related rows in one of the other tables.</span></span> <span data-ttu-id="06e16-145">W pierwszej kolejności można ręcznie usunąć powiązane wiersze lub skonfigurować bazę danych, aby usunąć ją automatycznie po usunięciu `Person` wiersza.</span><span class="sxs-lookup"><span data-stu-id="06e16-145">You can manually delete the related rows first, or you can configure the database to delete them automatically when you delete a `Person` row.</span></span> <span data-ttu-id="06e16-146">W przypadku rekordów uczniów w tym samouczku należy skonfigurować bazę danych do automatycznego usuwania powiązanych danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-146">For student records in this tutorial, you'll configure the database to delete the related data automatically.</span></span> <span data-ttu-id="06e16-147">Ponieważ uczniowie mogą mieć powiązane wiersze tylko w tabeli `StudentGrade`, należy skonfigurować tylko jedną z trzech relacji.</span><span class="sxs-lookup"><span data-stu-id="06e16-147">Because students can have related rows only in the `StudentGrade` table, you need to configure only one of the three relationships.</span></span>

<span data-ttu-id="06e16-148">Jeśli używasz pliku *uczelni. mdf* pobranego z projektu, który zawiera ten samouczek, możesz pominąć tę sekcję, ponieważ te zmiany konfiguracji zostały już wykonane.</span><span class="sxs-lookup"><span data-stu-id="06e16-148">If you're using the *School.mdf* file that you downloaded from the project that goes with this tutorial, you can skip this section because these configuration changes have already been done.</span></span> <span data-ttu-id="06e16-149">Jeśli baza danych została utworzona przez uruchomienie skryptu, skonfiguruj bazę danych, wykonując następujące procedury.</span><span class="sxs-lookup"><span data-stu-id="06e16-149">If you created the database by running a script, configure the database by performing the following procedures.</span></span>

<span data-ttu-id="06e16-150">W **Eksplorator serwera**Otwórz diagram bazy danych utworzony w części 1.</span><span class="sxs-lookup"><span data-stu-id="06e16-150">In **Server Explorer**, open the database diagram that you created in part 1.</span></span> <span data-ttu-id="06e16-151">Kliknij prawym przyciskiem myszy relację między `Person` i `StudentGrade` (wiersz między tabelami), a następnie wybierz polecenie **Właściwości**.</span><span class="sxs-lookup"><span data-stu-id="06e16-151">Right-click the relationship between `Person` and `StudentGrade` (the line between tables), and then select **Properties**.</span></span>

<span data-ttu-id="06e16-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span></span>

<span data-ttu-id="06e16-153">W oknie **Właściwości** rozwiń węzeł **Wstaw i Specyfikacja aktualizacji** i ustaw właściwość **DeleteRule** na **kaskadowo**.</span><span class="sxs-lookup"><span data-stu-id="06e16-153">In the **Properties** window, expand **INSERT and UPDATE Specification** and set the **DeleteRule** property to **Cascade**.</span></span>

<span data-ttu-id="06e16-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span></span>

<span data-ttu-id="06e16-155">Zapisz i Zamknij diagram.</span><span class="sxs-lookup"><span data-stu-id="06e16-155">Save and close the diagram.</span></span> <span data-ttu-id="06e16-156">Jeśli zostanie wyświetlony monit o zaktualizowanie bazy danych, kliknij przycisk **tak**.</span><span class="sxs-lookup"><span data-stu-id="06e16-156">If you're asked whether you want to update the database, click **Yes**.</span></span>

<span data-ttu-id="06e16-157">Aby upewnić się, że model zachowuje jednostki znajdujące się w pamięci w synchronizacji z działaniem bazy danych, należy ustawić odpowiednie reguły w modelu danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-157">To make sure that the model keeps entities that are in memory in sync with what the database is doing, you must set corresponding rules in the data model.</span></span> <span data-ttu-id="06e16-158">Otwórz *SchoolModel. edmx*, kliknij prawym przyciskiem myszy linię skojarzenia między `Person` i `StudentGrade`, a następnie wybierz polecenie **Właściwości**.</span><span class="sxs-lookup"><span data-stu-id="06e16-158">Open *SchoolModel.edmx*, right-click the association line between `Person` and `StudentGrade`, and then select **Properties**.</span></span>

<span data-ttu-id="06e16-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span></span>

<span data-ttu-id="06e16-160">W oknie **Właściwości** Ustaw **elementu end1 onDelete** na **kaskadowo**.</span><span class="sxs-lookup"><span data-stu-id="06e16-160">In the **Properties** window, set **End1 OnDelete** to **Cascade**.</span></span>

<span data-ttu-id="06e16-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span></span>

<span data-ttu-id="06e16-162">Zapisz i zamknij plik *SchoolModel. edmx* , a następnie Skompiluj ponownie projekt.</span><span class="sxs-lookup"><span data-stu-id="06e16-162">Save and close the *SchoolModel.edmx* file, and then rebuild the project.</span></span>

<span data-ttu-id="06e16-163">Ogólnie rzecz biorąc, gdy baza danych ulegnie zmianie, istnieje kilka opcji synchronizacji modelu:</span><span class="sxs-lookup"><span data-stu-id="06e16-163">In general, when the database changes, you have several choices for how to sync up the model:</span></span>

- <span data-ttu-id="06e16-164">W przypadku niektórych rodzajów zmian (takich jak dodawanie lub odświeżanie tabel, widoków lub procedur składowanych) kliknij prawym przyciskiem myszy w Projektancie i wybierz polecenie **Aktualizuj model z bazy danych** , aby Projektant automatycznie wprowadza zmiany.</span><span class="sxs-lookup"><span data-stu-id="06e16-164">For certain kinds of changes (such as adding or refreshing tables, views, or stored procedures), right-click in the designer and select **Update Model from Database** to have the designer make the changes automatically.</span></span>
- <span data-ttu-id="06e16-165">Wygeneruj ponownie model danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-165">Regenerate the data model.</span></span>
- <span data-ttu-id="06e16-166">Wprowadź ręczne aktualizacje takie jak ten.</span><span class="sxs-lookup"><span data-stu-id="06e16-166">Make manual updates like this one.</span></span>

<span data-ttu-id="06e16-167">W takim przypadku można ponownie wygenerować model lub odświeżyć tabele, których dotyczy zmiana relacji, ale należy wprowadzić zmianę nazwy pola (z `FirstName` na `FirstMidName`).</span><span class="sxs-lookup"><span data-stu-id="06e16-167">In this case, you could have regenerated the model or refreshed the tables affected by the relationship change, but then you'd have to make the field-name change again (from `FirstName` to `FirstMidName`).</span></span>

## <a name="using-a-gridview-control-to-read-and-update-entities"></a><span data-ttu-id="06e16-168">Odczytywanie i aktualizowanie jednostek przy użyciu kontrolki GridView</span><span class="sxs-lookup"><span data-stu-id="06e16-168">Using a GridView Control to Read and Update Entities</span></span>

<span data-ttu-id="06e16-169">W tej sekcji użyjesz kontrolki `GridView` do wyświetlania, aktualizowania lub usuwania uczniów.</span><span class="sxs-lookup"><span data-stu-id="06e16-169">In this section you'll use a `GridView` control to display, update, or delete students.</span></span>

<span data-ttu-id="06e16-170">Otwórz lub przejdź do *uczniów. aspx* i przejdź do widoku **projektu** .</span><span class="sxs-lookup"><span data-stu-id="06e16-170">Open or switch to *Students.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="06e16-171">Na karcie **dane** w **przyborniku**przeciągnij kontrolkę `GridView` z prawej strony kontrolki `EntityDataSource`, nadaj jej nazwę `StudentsGridView`, kliknij tag inteligentny, a następnie wybierz pozycję **StudentsEntityDataSource** jako źródło danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-171">From the **Data** tab of the **Toolbox**, drag a `GridView` control to the right of the `EntityDataSource` control, name it `StudentsGridView`, click the smart tag, and then select **StudentsEntityDataSource** as the data source.</span></span>

<span data-ttu-id="06e16-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span></span>

<span data-ttu-id="06e16-173">Kliknij przycisk **Odśwież schemat** (kliknij przycisk **tak** , jeśli zostanie wyświetlony monit o potwierdzenie), a następnie kliknij pozycję **Włącz stronicowanie**, **Włącz sortowanie**, **Włącz edytowanie**i **Włącz usuwanie**.</span><span class="sxs-lookup"><span data-stu-id="06e16-173">Click **Refresh Schema** (click **Yes** if you're prompted to confirm), then click **Enable Paging**, **Enable Sorting**, **Enable Editing**, and **Enable Deleting**.</span></span>

<span data-ttu-id="06e16-174">Kliknij przycisk **Edytuj kolumny**.</span><span class="sxs-lookup"><span data-stu-id="06e16-174">Click **Edit Columns**.</span></span>

<span data-ttu-id="06e16-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span></span>

<span data-ttu-id="06e16-176">W polu **wybrane pola** Usuń **PersonID**, **LastName**i **HireDate**.</span><span class="sxs-lookup"><span data-stu-id="06e16-176">In the **Selected fields** box, delete **PersonID**, **LastName**, and **HireDate**.</span></span> <span data-ttu-id="06e16-177">Zazwyczaj nie jest wyświetlany klucz rekordu dla użytkowników, data zatrudnienia nie ma znaczenia dla uczniów, a obie części nazwy są umieszczane w jednym polu, więc wystarczy jedno z nazw pól.</span><span class="sxs-lookup"><span data-stu-id="06e16-177">You typically don't display a record key to users, hire date is not relevant to students, and you'll put both parts of the name in one field, so you only need one of the name fields.)</span></span>

<span data-ttu-id="06e16-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span></span>

<span data-ttu-id="06e16-179">Wybierz pole **FirstMidName** , a następnie kliknij przycisk **Konwertuj to pole na TemplateField**.</span><span class="sxs-lookup"><span data-stu-id="06e16-179">Select the **FirstMidName** field and then click **Convert this field into a TemplateField**.</span></span>

<span data-ttu-id="06e16-180">Wykonaj te same czynności dla **EnrollmentDate**.</span><span class="sxs-lookup"><span data-stu-id="06e16-180">Do the same for **EnrollmentDate**.</span></span>

<span data-ttu-id="06e16-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span></span>

<span data-ttu-id="06e16-182">Kliknij przycisk **OK** , a następnie przejdź do widoku **źródła** .</span><span class="sxs-lookup"><span data-stu-id="06e16-182">Click **OK** and then switch to **Source** view.</span></span> <span data-ttu-id="06e16-183">Pozostałe zmiany będą łatwiejsze do wykonania bezpośrednio w znacznikach.</span><span class="sxs-lookup"><span data-stu-id="06e16-183">The remaining changes will be easier to do directly in markup.</span></span> <span data-ttu-id="06e16-184">`GridView` znaczników kontrolki wygląda teraz podobnie jak w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="06e16-184">The `GridView` control markup now looks like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample3.aspx)]

<span data-ttu-id="06e16-185">Pierwsza kolumna po polu polecenia to pole szablonu, które wyświetla imię i nazwisko.</span><span class="sxs-lookup"><span data-stu-id="06e16-185">The first column after the command field is a template field that currently displays the first name.</span></span> <span data-ttu-id="06e16-186">Zmień znaczniki pola tego szablonu, aby wyglądać jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="06e16-186">Change the markup for this template field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample4.aspx)]

<span data-ttu-id="06e16-187">W trybie wyświetlania dwie `Label` kontrolki wyświetlają imię i nazwisko.</span><span class="sxs-lookup"><span data-stu-id="06e16-187">In display mode, two `Label` controls display the first and last name.</span></span> <span data-ttu-id="06e16-188">W trybie edycji są podane dwa pola tekstowe, aby można było zmienić imię i nazwisko.</span><span class="sxs-lookup"><span data-stu-id="06e16-188">In edit mode, two text boxes are provided so you can change the first and last name.</span></span> <span data-ttu-id="06e16-189">Podobnie jak w przypadku kontrolek `Label` w trybie wyświetlania, wyrażenia `Bind` i `Eval` są dokładnie takie same jak w przypadku kontrolek źródła danych ASP.NET, które łączą się bezpośrednio z bazami danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-189">As with the `Label` controls in display mode, you use `Bind` and `Eval` expressions exactly as you would with ASP.NET data source controls that connect directly to databases.</span></span> <span data-ttu-id="06e16-190">Jedyną różnicą jest to, że należy określić właściwości jednostki zamiast kolumn bazy danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-190">The only difference is that you're specifying entity properties instead of database columns.</span></span>

<span data-ttu-id="06e16-191">Ostatnia kolumna to pole szablonu, które wyświetla datę rejestracji.</span><span class="sxs-lookup"><span data-stu-id="06e16-191">The last column is a template field that displays the enrollment date.</span></span> <span data-ttu-id="06e16-192">Zmień znaczniki dla tego pola, aby wyglądać jak w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="06e16-192">Change the markup for this field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample5.aspx)]

<span data-ttu-id="06e16-193">W trybie wyświetlania i edycji ciąg formatu "{0, d}" powoduje wyświetlenie daty w formacie "Data krótka".</span><span class="sxs-lookup"><span data-stu-id="06e16-193">In both display and edit mode, the format string "{0,d}" causes the date to be displayed in the "short date" format.</span></span> <span data-ttu-id="06e16-194">(Komputer może być skonfigurowany do wyświetlania tego formatu inaczej niż obrazy ekranu wyświetlane w tym samouczku).</span><span class="sxs-lookup"><span data-stu-id="06e16-194">(Your computer might be configured to display this format differently from the screen images shown in this tutorial.)</span></span>

<span data-ttu-id="06e16-195">Zwróć uwagę, że w każdym z tych pól szablonu Projektant użył wyrażenia `Bind` domyślnie, ale został zmieniony na wyrażenie `Eval` w elementach `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="06e16-195">Notice that in each of these template fields, the designer used a `Bind` expression by default, but you've changed that to an `Eval` expression in the `ItemTemplate` elements.</span></span> <span data-ttu-id="06e16-196">Wyrażenie `Bind` sprawia, że dane są dostępne we właściwościach kontrolki `GridView` na wypadek, gdyby trzeba było uzyskać dostęp do danych w kodzie.</span><span class="sxs-lookup"><span data-stu-id="06e16-196">The `Bind` expression makes the data available in `GridView` control properties in case you need to access the data in code.</span></span> <span data-ttu-id="06e16-197">Na tej stronie nie musisz uzyskiwać dostępu do tych danych w kodzie, więc możesz używać `Eval`, co jest bardziej wydajne.</span><span class="sxs-lookup"><span data-stu-id="06e16-197">In this page you don't need to access this data in code, so you can use `Eval`, which is more efficient.</span></span> <span data-ttu-id="06e16-198">Aby uzyskać więcej informacji, zobacz [pobieranie danych z kontrolek danych](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx).</span><span class="sxs-lookup"><span data-stu-id="06e16-198">For more information, see [Getting your data out of the data controls](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx).</span></span>

## <a name="revising-entitydatasource-control-markup-to-improve-performance"></a><span data-ttu-id="06e16-199">Poprawianie znaczników kontrolki EntityDataSource w celu zwiększenia wydajności</span><span class="sxs-lookup"><span data-stu-id="06e16-199">Revising EntityDataSource Control Markup to Improve Performance</span></span>

<span data-ttu-id="06e16-200">W znaczniku dla kontrolki `EntityDataSource` usuń atrybuty `ConnectionString` i `DefaultContainerName` i zastąp je atrybutem `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="06e16-200">In the markup for the `EntityDataSource` control, remove the `ConnectionString` and `DefaultContainerName` attributes and replace them with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="06e16-201">Ta zmiana powinna być podejmowana za każdym razem, gdy tworzysz kontrolkę `EntityDataSource`, chyba że trzeba użyć połączenia innego niż to, które jest stałe w klasie kontekstu obiektu.</span><span class="sxs-lookup"><span data-stu-id="06e16-201">This is a change you should make every time you create an `EntityDataSource` control, unless you need to use a connection that is different from the one that's hard-coded in the object context class.</span></span> <span data-ttu-id="06e16-202">Użycie atrybutu `ContextTypeName` zapewnia następujące korzyści:</span><span class="sxs-lookup"><span data-stu-id="06e16-202">Using the `ContextTypeName` attribute provides the following benefits:</span></span>

- <span data-ttu-id="06e16-203">Lepsza wydajność.</span><span class="sxs-lookup"><span data-stu-id="06e16-203">Better performance.</span></span> <span data-ttu-id="06e16-204">Gdy formant `EntityDataSource` inicjuje model danych przy użyciu atrybutów `ConnectionString` i `DefaultContainerName`, wykonuje dodatkowe prace w celu załadowania metadanych dla każdego żądania.</span><span class="sxs-lookup"><span data-stu-id="06e16-204">When the `EntityDataSource` control initializes the data model using the `ConnectionString` and `DefaultContainerName` attributes, it performs additional work to load metadata on every request.</span></span> <span data-ttu-id="06e16-205">Nie jest to konieczne, jeśli określisz atrybut `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="06e16-205">This isn't necessary if you specify the `ContextTypeName` attribute.</span></span>
- <span data-ttu-id="06e16-206">Ładowanie z opóźnieniem jest domyślnie włączone w wygenerowanych klasach kontekstu obiektów (takich jak `SchoolEntities` w tym samouczku) w Entity Framework 4,0.</span><span class="sxs-lookup"><span data-stu-id="06e16-206">Lazy loading is turned on by default in generated object context classes (such as `SchoolEntities` in this tutorial) in Entity Framework 4.0.</span></span> <span data-ttu-id="06e16-207">Oznacza to, że właściwości nawigacji są ładowane z danymi powiązanymi automatycznie, gdy ich potrzebujesz.</span><span class="sxs-lookup"><span data-stu-id="06e16-207">This means that navigation properties are loaded with related data automatically right when you need it.</span></span> <span data-ttu-id="06e16-208">Ładowanie z opóźnieniem zostało wyjaśnione bardziej szczegółowo w dalszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="06e16-208">Lazy loading is explained in more detail later in this tutorial.</span></span>
- <span data-ttu-id="06e16-209">Wszystkie dostosowania, które zostały zastosowane do klasy kontekstu obiektu (w tym przypadku Klasa `SchoolEntities`) będzie dostępna dla formantów, które używają kontrolki `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="06e16-209">Any customizations that you've applied to the object context class (in this case, the `SchoolEntities` class) will be available to controls that use the `EntityDataSource` control.</span></span> <span data-ttu-id="06e16-210">Dostosowywanie klasy kontekstu obiektów jest zaawansowanym tematem, który nie jest objęty tą serią samouczków.</span><span class="sxs-lookup"><span data-stu-id="06e16-210">Customizing the object context class is an advanced topic that is not covered in this tutorial series.</span></span> <span data-ttu-id="06e16-211">Aby uzyskać więcej informacji, zobacz [rozszerzanie wygenerowanych typów Entity Framework](https://msdn.microsoft.com/library/dd456844.aspx).</span><span class="sxs-lookup"><span data-stu-id="06e16-211">For more information, see [Extending Entity Framework Generated Types](https://msdn.microsoft.com/library/dd456844.aspx).</span></span>

<span data-ttu-id="06e16-212">Znacznik będzie teraz podobny do poniższego przykładu (kolejność właściwości może się różnić):</span><span class="sxs-lookup"><span data-stu-id="06e16-212">The markup will now resemble the following example (the order of the properties might be different):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample6.aspx)]

<span data-ttu-id="06e16-213">Atrybut `EnableFlattening` odwołuje się do funkcji, która była wymagana we wcześniejszych wersjach Entity Framework ponieważ kolumny klucza obcego nie zostały ujawnione jako właściwości jednostki.</span><span class="sxs-lookup"><span data-stu-id="06e16-213">The `EnableFlattening` attribute refers to a feature that was needed in earlier versions of the Entity Framework because foreign key columns were not exposed as entity properties.</span></span> <span data-ttu-id="06e16-214">Bieżąca wersja umożliwia korzystanie z *skojarzeń kluczy obcych*, co oznacza, że właściwości klucza obcego są ujawniane dla wszystkich skojarzeń z wyjątkiem wielu-do-wielu.</span><span class="sxs-lookup"><span data-stu-id="06e16-214">The current version makes it possible to use *foreign key associations*, which means foreign key properties are exposed for all but many-to-many associations.</span></span> <span data-ttu-id="06e16-215">Jeśli jednostki mają właściwości klucza obcego i nie mają [typów złożonych](https://msdn.microsoft.com/library/bb738472.aspx), można pozostawić ten atrybut ustawiony na `False`.</span><span class="sxs-lookup"><span data-stu-id="06e16-215">If your entities have foreign key properties and no [complex types](https://msdn.microsoft.com/library/bb738472.aspx), you can leave this attribute set to `False`.</span></span> <span data-ttu-id="06e16-216">Nie usuwaj atrybutu z znaczników, ponieważ wartość domyślna to `True`.</span><span class="sxs-lookup"><span data-stu-id="06e16-216">Don't remove the attribute from the markup, because the default value is `True`.</span></span> <span data-ttu-id="06e16-217">Aby uzyskać więcej informacji, zobacz [spłaszczanie obiektów (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span><span class="sxs-lookup"><span data-stu-id="06e16-217">For more information, see [Flattening Objects (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span></span>

<span data-ttu-id="06e16-218">Uruchom stronę i zobaczysz listę studentów i pracowników (filtr dotyczy tylko studentów w następnym samouczku).</span><span class="sxs-lookup"><span data-stu-id="06e16-218">Run the page and you see a list of students and employees (you'll filter for just students in the next tutorial).</span></span> <span data-ttu-id="06e16-219">Imię i nazwisko są wyświetlane razem.</span><span class="sxs-lookup"><span data-stu-id="06e16-219">The first name and last name are displayed together.</span></span>

<span data-ttu-id="06e16-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span></span>

<span data-ttu-id="06e16-221">Aby posortować ekran, kliknij nazwę kolumny.</span><span class="sxs-lookup"><span data-stu-id="06e16-221">To sort the display, click a column name.</span></span>

<span data-ttu-id="06e16-222">Kliknij przycisk **Edytuj** w dowolnym wierszu.</span><span class="sxs-lookup"><span data-stu-id="06e16-222">Click **Edit** in any row.</span></span> <span data-ttu-id="06e16-223">Wyświetlane są pola tekstowe, w których można zmienić imię i nazwisko.</span><span class="sxs-lookup"><span data-stu-id="06e16-223">Text boxes are displayed where you can change the first and last name.</span></span>

<span data-ttu-id="06e16-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span></span>

<span data-ttu-id="06e16-225">Przycisk **Usuń** również działa.</span><span class="sxs-lookup"><span data-stu-id="06e16-225">The **Delete** button also works.</span></span> <span data-ttu-id="06e16-226">Kliknij przycisk Usuń dla wiersza, który ma datę rejestracji i znika wiersz.</span><span class="sxs-lookup"><span data-stu-id="06e16-226">Click delete for a row that has an enrollment date and the row disappears.</span></span> <span data-ttu-id="06e16-227">(Wiersze bez daty rejestracji przedstawiają instruktorów i może zostać wyświetlony błąd integralności referencyjnej.</span><span class="sxs-lookup"><span data-stu-id="06e16-227">(Rows without an enrollment date represent instructors and you may get a referential integrity error.</span></span> <span data-ttu-id="06e16-228">W następnym samouczku przefiltruje tę listę w celu uwzględnienia tylko studentów.)</span><span class="sxs-lookup"><span data-stu-id="06e16-228">In the next tutorial you'll filter this list to include just students.)</span></span>

## <a name="displaying-data-from-a-navigation-property"></a><span data-ttu-id="06e16-229">Wyświetlanie danych z właściwości nawigacji</span><span class="sxs-lookup"><span data-stu-id="06e16-229">Displaying Data from a Navigation Property</span></span>

<span data-ttu-id="06e16-230">Teraz Załóżmy, że chcesz wiedzieć, ile kursów każdy student został zarejestrowany w usłudze.</span><span class="sxs-lookup"><span data-stu-id="06e16-230">Now suppose you want to know how many courses each student is enrolled in.</span></span> <span data-ttu-id="06e16-231">Entity Framework udostępnia te informacje we właściwości nawigacji `StudentGrades` jednostki `Person`.</span><span class="sxs-lookup"><span data-stu-id="06e16-231">The Entity Framework provides that information in the `StudentGrades` navigation property of the `Person` entity.</span></span> <span data-ttu-id="06e16-232">Ponieważ projekt bazy danych nie zezwala na zarejestrowanie studenta w kursie bez przypisanej klasy, można założyć, że posiadanie wiersza w wierszu tabeli `StudentGrade`, który jest skojarzony z kursem, jest takie samo jak w przypadku zarejestrowania w kursie.</span><span class="sxs-lookup"><span data-stu-id="06e16-232">Because the database design does not allow a student to be enrolled in a course without having a grade assigned, for this tutorial you can assume that having a row in the `StudentGrade` table row that is associated with a course is the same as being enrolled in the course.</span></span> <span data-ttu-id="06e16-233">(Właściwość nawigacji `Courses` jest tylko dla instruktorów).</span><span class="sxs-lookup"><span data-stu-id="06e16-233">(The `Courses` navigation property is only for instructors.)</span></span>

<span data-ttu-id="06e16-234">Gdy używasz atrybutu `ContextTypeName` formantu `EntityDataSource`, Entity Framework automatycznie pobiera informacje dla właściwości nawigacji podczas uzyskiwania dostępu do tej właściwości.</span><span class="sxs-lookup"><span data-stu-id="06e16-234">When you use the `ContextTypeName` attribute of the `EntityDataSource` control, the Entity Framework automatically retrieves information for a navigation property when you access that property.</span></span> <span data-ttu-id="06e16-235">Jest to nazywane *ładowaniem z opóźnieniem*.</span><span class="sxs-lookup"><span data-stu-id="06e16-235">This is called *lazy loading*.</span></span> <span data-ttu-id="06e16-236">Jednak może to być niewydajne, ponieważ powoduje osobne wywołanie do bazy danych za każdym razem, gdy są niezbędne dodatkowe informacje.</span><span class="sxs-lookup"><span data-stu-id="06e16-236">However, this can be inefficient, because it results in a separate call to the database each time additional information is needed.</span></span> <span data-ttu-id="06e16-237">Jeśli potrzebujesz danych z właściwości nawigacji dla każdej jednostki zwracanej przez formant `EntityDataSource`, bardziej wydajne jest pobranie powiązanych danych wraz z samą jednostką w jednym wywołaniu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-237">If you need data from the navigation property for every entity returned by the `EntityDataSource` control, it's more efficient to retrieve the related data along with the entity itself in a single call to the database.</span></span> <span data-ttu-id="06e16-238">Jest to tzw. *ładowanie eager*i określanie eager ładowania dla właściwości nawigacji przez ustawienie właściwości `Include` kontrolki `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="06e16-238">This is called *eager loading*, and you specify eager loading for a navigation property by setting the `Include` property of the `EntityDataSource` control.</span></span>

<span data-ttu-id="06e16-239">W *uczniach. aspx*chcesz wyświetlić liczbę kursów dla każdego ucznia, więc najlepszym wyborem jest ładowanie eager.</span><span class="sxs-lookup"><span data-stu-id="06e16-239">In *Students.aspx*, you want to show the number of courses for every student, so eager loading is the best choice.</span></span> <span data-ttu-id="06e16-240">Jeśli zostały wyświetlone wszystkie uczniów, ale podano liczbę kursów tylko dla kilku z nich (co wymagałoby zapisania kodu jako uzupełnienie znacznika), ładowanie z opóźnieniem może być lepszym wyborem.</span><span class="sxs-lookup"><span data-stu-id="06e16-240">If you were displaying all students but showing the number of courses only for a few of them (which would require writing some code in addition to the markup), lazy loading might be a better choice.</span></span>

<span data-ttu-id="06e16-241">Otwórz lub przejdź do opcji *uczniowie. aspx*, przejdź do widoku **projektu** , wybierz pozycję `StudentsEntityDataSource`, a w oknie **Właściwości** ustaw właściwość **include** na **StudentGrades**.</span><span class="sxs-lookup"><span data-stu-id="06e16-241">Open or switch to *Students.aspx*, switch to **Design** view, select `StudentsEntityDataSource`, and in the **Properties** window set the **Include** property to **StudentGrades**.</span></span> <span data-ttu-id="06e16-242">(Jeśli chcesz uzyskać wiele właściwości nawigacji, możesz określić ich nazwy oddzielone przecinkami — na przykład **StudentGrades, kursy**.).</span><span class="sxs-lookup"><span data-stu-id="06e16-242">(If you wanted to get multiple navigation properties, you could specify their names separated by commas — for example, **StudentGrades, Courses**.)</span></span>

<span data-ttu-id="06e16-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span></span>

<span data-ttu-id="06e16-244">Przejdź do widoku **źródła** .</span><span class="sxs-lookup"><span data-stu-id="06e16-244">Switch to **Source** view.</span></span> <span data-ttu-id="06e16-245">W kontrolce `StudentsGridView` po ostatnim elemencie `asp:TemplateField` Dodaj następujące pole nowego szablonu:</span><span class="sxs-lookup"><span data-stu-id="06e16-245">In the `StudentsGridView` control, after the last `asp:TemplateField` element, add the following new template field:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample7.aspx)]

<span data-ttu-id="06e16-246">W wyrażeniu `Eval` można odwołać się do `StudentGrades`właściwości nawigacji.</span><span class="sxs-lookup"><span data-stu-id="06e16-246">In the `Eval` expression, you can reference the navigation property `StudentGrades`.</span></span> <span data-ttu-id="06e16-247">Ponieważ ta właściwość zawiera kolekcję, ma właściwość `Count`, która służy do wyświetlania liczby kursów, w których student jest zarejestrowany.</span><span class="sxs-lookup"><span data-stu-id="06e16-247">Because this property contains a collection, it has a `Count` property that you can use to display the number of courses in which the student is enrolled.</span></span> <span data-ttu-id="06e16-248">W późniejszym samouczku zobaczysz, jak wyświetlać dane z właściwości nawigacji, które zawierają pojedyncze jednostki zamiast kolekcji.</span><span class="sxs-lookup"><span data-stu-id="06e16-248">In a later tutorial you'll see how to display data from navigation properties that contain single entities instead of collections.</span></span> <span data-ttu-id="06e16-249">(Należy zauważyć, że nie można użyć elementów `BoundField` do wyświetlania danych z właściwości nawigacji).</span><span class="sxs-lookup"><span data-stu-id="06e16-249">(Note that you cannot use `BoundField` elements to display data from navigation properties.)</span></span>

<span data-ttu-id="06e16-250">Uruchom stronę i zobaczysz, ile kursów jest zarejestrowanych dla każdego ucznia.</span><span class="sxs-lookup"><span data-stu-id="06e16-250">Run the page and you now see how many courses each student is enrolled in.</span></span>

<span data-ttu-id="06e16-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span></span>

## <a name="using-a-detailsview-control-to-insert-entities"></a><span data-ttu-id="06e16-252">Wstawianie jednostek przy użyciu kontrolki DetailsView</span><span class="sxs-lookup"><span data-stu-id="06e16-252">Using a DetailsView Control to Insert Entities</span></span>

<span data-ttu-id="06e16-253">Następnym krokiem jest utworzenie strony z kontrolką `DetailsView`, która pozwoli dodawać nowych uczniów.</span><span class="sxs-lookup"><span data-stu-id="06e16-253">The next step is to create a page that has a `DetailsView` control that will let you add new students.</span></span> <span data-ttu-id="06e16-254">Zamknij przeglądarkę, a następnie utwórz nową stronę sieci Web przy użyciu strony głównej programu *site. Master* .</span><span class="sxs-lookup"><span data-stu-id="06e16-254">Close the browser and then create a new web page using the *Site.Master* master page.</span></span> <span data-ttu-id="06e16-255">Nadaj stronie nazwę *StudentsAdd. aspx*, a następnie przejdź do widoku **źródła** .</span><span class="sxs-lookup"><span data-stu-id="06e16-255">Name the page *StudentsAdd.aspx*, and then switch to **Source** view.</span></span>

<span data-ttu-id="06e16-256">Dodaj następujące znaczniki, aby zamienić istniejące znaczniki dla kontrolki `Content` o nazwie `Content2`:</span><span class="sxs-lookup"><span data-stu-id="06e16-256">Add the following markup to replace the existing markup for the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample8.aspx)]

<span data-ttu-id="06e16-257">Ten znacznik tworzy formant `EntityDataSource`, który jest podobny do tego, który został utworzony w *uczniów. aspx*, z tą różnicą, że umożliwia wstawianie.</span><span class="sxs-lookup"><span data-stu-id="06e16-257">This markup creates an `EntityDataSource` control that is similar to the one you created in *Students.aspx*, except it enables insertion.</span></span> <span data-ttu-id="06e16-258">Podobnie jak w przypadku kontrolki `GridView`, pola powiązane kontrolki `DetailsView` są kodowane dokładnie tak, jak w przypadku formantu danych, który łączy się bezpośrednio z bazą danych, z tą różnicą, że odwołują się do właściwości jednostki.</span><span class="sxs-lookup"><span data-stu-id="06e16-258">As with the `GridView` control, the bound fields of the `DetailsView` control are coded exactly as they would be for a data control that connects directly to a database, except that they reference entity properties.</span></span> <span data-ttu-id="06e16-259">W takim przypadku kontrolka `DetailsView` jest używana tylko do wstawiania wierszy, więc ustawiono domyślny tryb `Insert`.</span><span class="sxs-lookup"><span data-stu-id="06e16-259">In this case, the `DetailsView` control is used only for inserting rows, so you have set the default mode to `Insert`.</span></span>

<span data-ttu-id="06e16-260">Uruchom stronę i Dodaj nowego ucznia.</span><span class="sxs-lookup"><span data-stu-id="06e16-260">Run the page and add a new student.</span></span>

<span data-ttu-id="06e16-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span></span>

<span data-ttu-id="06e16-262">Nic się nie stanie po wstawieniu nowego ucznia, ale jeśli teraz uruchomisz *uczniów. aspx*, zobaczysz nowe informacje ucznia.</span><span class="sxs-lookup"><span data-stu-id="06e16-262">Nothing will happen after you insert a new student, but if you now run *Students.aspx*, you'll see the new student information.</span></span>

## <a name="displaying-data-in-a-drop-down-list"></a><span data-ttu-id="06e16-263">Wyświetlanie danych na liście rozwijanej</span><span class="sxs-lookup"><span data-stu-id="06e16-263">Displaying Data in a Drop-Down List</span></span>

<span data-ttu-id="06e16-264">W poniższych krokach zostanie podjęta próba powiązania formantu `DropDownList` z zestawem jednostek przy użyciu kontrolki `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="06e16-264">In the following steps you'll databind a `DropDownList` control to an entity set using an `EntityDataSource` control.</span></span> <span data-ttu-id="06e16-265">W tej części samouczka nie będzie można wykonać wielu czynności z tą listą.</span><span class="sxs-lookup"><span data-stu-id="06e16-265">In this part of the tutorial, you won't do much with this list.</span></span> <span data-ttu-id="06e16-266">W kolejnych częściach należy użyć listy, aby umożliwić użytkownikom wybranie działu w celu wyświetlenia kursów skojarzonych z działem.</span><span class="sxs-lookup"><span data-stu-id="06e16-266">In subsequent parts, though, you'll use the list to let users select a department to display courses associated with the department.</span></span>

<span data-ttu-id="06e16-267">Utwórz nową stronę sieci Web o nazwie *kursy. aspx*.</span><span class="sxs-lookup"><span data-stu-id="06e16-267">Create a new web page named *Courses.aspx*.</span></span> <span data-ttu-id="06e16-268">W widoku **źródła** Dodaj nagłówek do kontrolki `Content` o nazwie `Content2`:</span><span class="sxs-lookup"><span data-stu-id="06e16-268">In **Source** view, add a heading to the `Content` control that's named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample9.aspx)]

<span data-ttu-id="06e16-269">W widoku **projektu** dodaj formant `EntityDataSource` do strony tak jak wcześniej, z wyjątkiem tego, że ta nazwa `DepartmentsEntityDataSource`a.</span><span class="sxs-lookup"><span data-stu-id="06e16-269">In **Design** view, add an `EntityDataSource` control to the page as you did before, except this time name it `DepartmentsEntityDataSource`.</span></span> <span data-ttu-id="06e16-270">Wybierz pozycję **działy** jako wartość **entitySetName** i wybierz tylko właściwości **DepartmentID** i **name** .</span><span class="sxs-lookup"><span data-stu-id="06e16-270">Select **Departments** as the **EntitySetName** value, and select only the **DepartmentID** and **Name** properties.</span></span>

<span data-ttu-id="06e16-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span></span>

<span data-ttu-id="06e16-272">Na karcie **standardowe** **przybornika**przeciągnij kontrolkę `DropDownList` na stronę, nadaj jej nazwę `DepartmentsDropDownList`, kliknij tag inteligentny i wybierz pozycję **Wybierz źródło danych** , aby uruchomić **Kreatora konfiguracji źródła**danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-272">From the **Standard** tab of the **Toolbox**, drag a `DropDownList` control to the page, name it `DepartmentsDropDownList`, click the smart tag, and select **Choose Data Source** to start the **DataSource Configuration Wizard**.</span></span>

<span data-ttu-id="06e16-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span></span>

<span data-ttu-id="06e16-274">W kroku **Wybierz źródło danych** wybierz pozycję **DepartmentsEntityDataSource** jako źródło danych, kliknij przycisk **Odśwież schemat**, a następnie wybierz opcję **Nazwa** jako pole danych do wyświetlenia i **DepartmentID** jako pole danych wartości.</span><span class="sxs-lookup"><span data-stu-id="06e16-274">In the **Choose a Data Source** step, select **DepartmentsEntityDataSource** as the data source, click **Refresh Schema**, and then select **Name** as the data field to display and **DepartmentID** as the value data field.</span></span> <span data-ttu-id="06e16-275">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="06e16-275">Click **OK**.</span></span>

<span data-ttu-id="06e16-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span></span>

<span data-ttu-id="06e16-277">Metoda używana do powiązania formantu przy użyciu Entity Framework jest taka sama jak w przypadku innych kontrolek źródła danych ASP.NET, z wyjątkiem określania jednostek i właściwości jednostek.</span><span class="sxs-lookup"><span data-stu-id="06e16-277">The method you use to databind the control using the Entity Framework is the same as with other ASP.NET data source controls except you're specifying entities and entity properties.</span></span>

<span data-ttu-id="06e16-278">Przełącz się do widoku **źródła** i Dodaj "Wybierz dział:" bezpośrednio przed formantem `DropDownList`.</span><span class="sxs-lookup"><span data-stu-id="06e16-278">Switch to **Source** view and add "Select a department:" immediately before the `DropDownList` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample10.aspx)]

<span data-ttu-id="06e16-279">W tym momencie Zmień znaczniki dla kontrolki `EntityDataSource`, zastępując atrybuty `ConnectionString` i `DefaultContainerName` atrybutem `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="06e16-279">As a reminder, change the markup for the `EntityDataSource` control at this point by replacing the `ConnectionString` and `DefaultContainerName` attributes with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="06e16-280">Często najlepiej czekać, aż po utworzeniu kontrolki powiązanej z danymi, która jest połączona z kontrolką źródła danych, przed zmianą `EntityDataSource` znaczników kontrolki, ponieważ po wprowadzeniu zmiany projektant nie będzie udostępniać opcji **Odśwież schemat** w kontrolce powiązanej z danymi.</span><span class="sxs-lookup"><span data-stu-id="06e16-280">It's often best to wait until after you've created the data-bound control that is linked to the data source control before you change the `EntityDataSource` control markup, because after you make the change, the designer will not provide you with a **Refresh Schema** option in the data-bound control.</span></span>

<span data-ttu-id="06e16-281">Uruchom stronę i wybierz dział z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="06e16-281">Run the page and you can select a department from the drop-down list.</span></span>

<span data-ttu-id="06e16-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="06e16-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span></span>

<span data-ttu-id="06e16-283">To kończy wprowadzenie do korzystania z formantu `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="06e16-283">This completes the introduction to using the `EntityDataSource` control.</span></span> <span data-ttu-id="06e16-284">Praca z tą kontrolką zwykle nie różni się od pracy z innymi ASP.NETmi formantami źródła danych, z tą różnicą, że obiekty i właściwości są odwołujące się do tabel i kolumn.</span><span class="sxs-lookup"><span data-stu-id="06e16-284">Working with this control is generally no different from working with other ASP.NET data source controls, except that you reference entities and properties instead of tables and columns.</span></span> <span data-ttu-id="06e16-285">Jedyny wyjątek polega na tym, że chcesz uzyskać dostęp do właściwości nawigacji.</span><span class="sxs-lookup"><span data-stu-id="06e16-285">The only exception is when you want to access navigation properties.</span></span> <span data-ttu-id="06e16-286">W następnym samouczku zobaczysz, że składnia używana z kontrolką `EntityDataSource` może również różnić się od innych kontrolek źródła danych podczas filtrowania, grupowania i porządkowania danych.</span><span class="sxs-lookup"><span data-stu-id="06e16-286">In the next tutorial you'll see that the syntax you use with `EntityDataSource` control might also differ from other data source controls when you filter, group, and order data.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="06e16-287">[Poprzednie](the-entity-framework-and-aspnet-getting-started-part-1.md)
> [dalej](the-entity-framework-and-aspnet-getting-started-part-3.md)</span><span class="sxs-lookup"><span data-stu-id="06e16-287">[Previous](the-entity-framework-and-aspnet-getting-started-part-1.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-3.md)</span></span>
