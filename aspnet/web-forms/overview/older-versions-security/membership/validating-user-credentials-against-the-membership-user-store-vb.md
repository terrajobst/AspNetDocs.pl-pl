---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
title: Sprawdzanie poprawności poświadczeń użytkownika względem Store użytkownika członkostwa (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku zostanie omówiony sposób sprawdzania poprawności poświadczeń użytkownika względem magazynu użytkowników członkostwa przy użyciu zarówno programowy sposób, jak i kontrolka Login...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 17772912-b47b-4557-9ce9-80f22df642f7
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
msc.type: authoredcontent
ms.openlocfilehash: 98869574adb8ac85a2b6dad8db2a583e013150fe
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59393180"
---
# <a name="validating-user-credentials-against-the-membership-user-store-vb"></a><span data-ttu-id="d598c-103">Walidacja poświadczeń użytkownika względem magazynu użytkowników członkostwa (VB)</span><span class="sxs-lookup"><span data-stu-id="d598c-103">Validating User Credentials Against the Membership User Store (VB)</span></span>

<span data-ttu-id="d598c-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d598c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d598c-105">[Pobierz program Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) lub [Pobierz plik PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="d598c-105">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span></span>

> <span data-ttu-id="d598c-106">W tym samouczku zostanie omówiony sposób sprawdzania poprawności poświadczeń użytkownika względem magazynu użytkowników członkostwa przy użyciu zarówno programowy sposób, jak i kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="d598c-107">Również przyjrzymy się jak dostosować wygląd i zachowanie kontrolki logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-107">We will also look at how to customize the login control's appearance and behavior.</span></span>


## <a name="introduction"></a><span data-ttu-id="d598c-108">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="d598c-108">Introduction</span></span>

<span data-ttu-id="d598c-109">W <a id="Tutorial05"> </a> [poprzedni Samouczek](creating-user-accounts-vb.md) zobaczyliśmy, jak utworzyć nowe konto użytkownika w ramach członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="d598c-110">Najpierw przyjrzeliśmy się programowe tworzenie kont użytkowników za pośrednictwem `Membership` klasy `CreateUser` metody, a następnie za pomocą kontrolki CreateUserWizard sieci Web.</span><span class="sxs-lookup"><span data-stu-id="d598c-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="d598c-111">Na stronie logowania weryfikuje obecnie podane poświadczenia z ustaloną listą par nazwa użytkownika i hasło.</span><span class="sxs-lookup"><span data-stu-id="d598c-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="d598c-112">Musimy zaktualizować logiki na stronie logowania, tak aby sprawdza poprawność poświadczeń względem magazynu użytkowników struktury członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="d598c-113">Znacznie takich jak tworzenie kont użytkowników, poświadczenia mogą być sprawdzone programowo, albo w sposób deklaratywny.</span><span class="sxs-lookup"><span data-stu-id="d598c-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="d598c-114">Interfejs API członkostwa obejmuje metodę programowe sprawdzanie poprawności poświadczeń użytkownika względem magazynu użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d598c-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="d598c-115">I ASP.NET, który jest dostarczany za pomocą kontrolki logowania sieci Web, która renderuje interfejsu użytkownika za pomocą pól tekstowych dla nazwy użytkownika i hasła oraz przycisk, aby zalogować się.</span><span class="sxs-lookup"><span data-stu-id="d598c-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="d598c-116">W tym samouczku zostanie omówiony sposób sprawdzania poprawności poświadczeń użytkownika względem magazynu użytkowników członkostwa przy użyciu zarówno programowy sposób, jak i kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="d598c-117">Również przyjrzymy się jak dostosować wygląd i zachowanie kontrolki logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="d598c-118">Zaczynajmy!</span><span class="sxs-lookup"><span data-stu-id="d598c-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="d598c-119">Krok 1. Sprawdzanie poprawności poświadczeń względem Store użytkownika członkostwa</span><span class="sxs-lookup"><span data-stu-id="d598c-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="d598c-120">Dla witryn sieci web, które korzystają z uwierzytelniania formularzy użytkownik loguje się do witryny sieci Web, odwiedzając stronę logowania i wprowadzając swoje poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="d598c-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="d598c-121">Te poświadczenia są porównywane względem magazynu użytkowników.</span><span class="sxs-lookup"><span data-stu-id="d598c-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="d598c-122">Jeśli są one prawidłowe, użytkownik otrzymuje biletu uwierzytelniania formularzy, który jest token zabezpieczający, który wskazuje tożsamości i autentyczności obiekt odwiedzający.</span><span class="sxs-lookup"><span data-stu-id="d598c-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="d598c-123">Aby sprawdzić użytkownika względem framework członkostwa, należy użyć `Membership` klasy [ `ValidateUser` metoda](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="d598c-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="d598c-124">`ValidateUser` Metoda przyjmuje dwa parametry wejściowe — `username` i `password` — i zwraca wartość logiczną wskazującą, czy poświadczenia są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-124">The `ValidateUser` method takes in two input parameters - `username` and `password` - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="d598c-125">Za pomocą `CreateUser` metoda zbadaliśmy w poprzednim samouczku `ValidateUser` metoda deleguje rzeczywista weryfikacja do skonfigurowanego dostawcy członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="d598c-126">`SqlMembershipProvider` Sprawdza poprawność podanych poświadczeń, uzyskując hasło użytkownika określony za pomocą `aspnet_Membership_GetPasswordWithFormat` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="d598c-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="d598c-127">Pamiętamy `SqlMembershipProvider` przechowuje hasła użytkowników przy użyciu jednej z trzech formatów: wyczyść, szyfrowane, lub mieszany.</span><span class="sxs-lookup"><span data-stu-id="d598c-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="d598c-128">`aspnet_Membership_GetPasswordWithFormat` Procedura składowana ma zwracać hasła w formacie raw.</span><span class="sxs-lookup"><span data-stu-id="d598c-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="d598c-129">Dla zaszyfrowanych lub skrótu hasła `SqlMembershipProvider` przekształca `password` wartości przekazanej do `ValidateUser` metody na jego równoważnik szyfrowane lub mieszany stanu i porównuje ją z czego został zwrócony z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="d598c-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the `password` value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="d598c-130">Jeśli hasło przechowywane w bazie danych jest zgodny sformatowane hasła podanego przez użytkownika, poświadczenia są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="d598c-131">Zaktualizujmy naszą stronę logowania (~ /`Login.aspx`) tak, aby sprawdza poprawność podanych poświadczeń względem magazynu użytkowników struktury członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="d598c-132">Utworzyliśmy tę stronę logowania w <a id="Tutorial02"> </a> [ *omówienie uwierzytelniania formularzy* ](../introduction/an-overview-of-forms-authentication-vb.md) samouczek, Tworzenie interfejsu z dwóch pól tekstowych dla nazwy użytkownika i hasła, Zapamiętaj mnie pole wyboru i przycisku logowania (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="d598c-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="d598c-133">Kod sprawdza poprawność wprowadzone poświadczenia z ustaloną listą par nazwa użytkownika i hasło (Scott/hasła, Jisun/hasło i hasła/Sam).</span><span class="sxs-lookup"><span data-stu-id="d598c-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="d598c-134">W <a id="Tutorial03"> </a> [ *Konfiguracja uwierzytelniania formularzy i Tematy zaawansowane* ](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) samouczek Zaktualizowaliśmy kodu strony logowania do przechowywania dodatkowych informacji w formularzach bilet uwierzytelnienia `UserData` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d598c-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>


<span data-ttu-id="d598c-135">[![Interfejs strony logowania zawiera dwa pola tekstowe, elementu CheckBoxList i przycisku](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span></span>

<span data-ttu-id="d598c-136">**Rysunek 1**: Na stronie logowania interfejsu zawiera dwa pola tekstowe, elementu CheckBoxList i przycisku ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span></span>


<span data-ttu-id="d598c-137">Interfejs użytkownika na stronie logowania może pozostać bez zmian, ale musimy Zastąp przycisk logowania `Click` programu obsługi zdarzeń z kodem, który sprawdza poprawność użytkownika względem magazynu użytkowników struktury członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="d598c-138">Aktualizacja programu obsługi zdarzeń, aby jego kod wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="d598c-138">Update the event handler so that its code appears as follows:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample1.vb)]

<span data-ttu-id="d598c-139">Ten kod jest niezwykle proste.</span><span class="sxs-lookup"><span data-stu-id="d598c-139">This code is remarkably simple.</span></span> <span data-ttu-id="d598c-140">Rozpoczniemy pracę przez wywołanie metody `Membership.ValidateUser` jest metoda w podanej nazwy użytkownika i hasła.</span><span class="sxs-lookup"><span data-stu-id="d598c-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="d598c-141">Jeśli ta metoda zwraca wartość PRAWDA, a następnie użytkownik jest zalogowany do witryny za pomocą `FormsAuthentication` metody RedirectFromLoginPage klasy.</span><span class="sxs-lookup"><span data-stu-id="d598c-141">If that method returns True, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="d598c-142">(Tak jak Omówiliśmy to w <a id="Tutorial02"> </a> [ *omówienie uwierzytelniania formularzy* ](../introduction/an-overview-of-forms-authentication-vb.md) samouczku `FormsAuthentication.RedirectFromLoginPage` tworzy bilet uwierzytelniania formularzy i następnie przekierowuje użytkownika do odpowiedniej strony.) Jeśli poświadczenia są nieprawidłowe, jednak `InvalidCredentialsMessage` etykieta jest wyświetlana, informujący użytkownika, że jego nazwa użytkownika lub hasło jest niepoprawne.</span><span class="sxs-lookup"><span data-stu-id="d598c-142">(As we discussed in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="d598c-143">To wszystko.</span><span class="sxs-lookup"><span data-stu-id="d598c-143">That's all there is to it!</span></span>

<span data-ttu-id="d598c-144">Aby sprawdzić, czy strony logowania działa zgodnie z oczekiwaniami, spróbuj zalogować się za pomocą jednego konta użytkownika utworzonego w poprzednim samouczku.</span><span class="sxs-lookup"><span data-stu-id="d598c-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="d598c-145">Jeśli konto nie zostało jeszcze utworzone, przejdź dalej i utworzyć ją z `~/Membership/CreatingUserAccounts.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="d598c-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="d598c-146">Gdy użytkownik wprowadzi swoje poświadczenia i przesyła formularz strony logowania, poświadczenia, w tym jej hasła są przesyłane przez Internet do serwera sieci web w *zwykły tekst*.</span><span class="sxs-lookup"><span data-stu-id="d598c-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="d598c-147">Oznacza to, że wszelkie haker wykrywanie ruchu sieciowego można zobaczyć, nazwę użytkownika i hasło.</span><span class="sxs-lookup"><span data-stu-id="d598c-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="d598c-148">Aby temu zapobiec, jest niezbędne do szyfrowania ruchu sieciowego przy użyciu [gniazda warstwy SSL (Secure)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="d598c-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="d598c-149">Pozwoli to zagwarantować, są zaszyfrowane poświadczenia (a także kod znaczników HTML całą stronę) od momentu jego opuszczają przeglądarki otrzymanie przez serwer sieci web.</span><span class="sxs-lookup"><span data-stu-id="d598c-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>


### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="d598c-150">Sposób obsługi nieudanych prób logowania w ramach członkostwa</span><span class="sxs-lookup"><span data-stu-id="d598c-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="d598c-151">Gdy użytkownik osiągnie strony logowania i przesyła swoich poświadczeń, przeglądarki zgłasza żądanie HTTP do strony logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="d598c-152">Jeśli poświadczenia są prawidłowe, odpowiedź HTTP zawiera bilet uwierzytelniania w pliku cookie.</span><span class="sxs-lookup"><span data-stu-id="d598c-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="d598c-153">W związku z tym haker podjęto próbę przerwania do witryny usługi można utworzyć program, który wyczerpująco wysyła żądania HTTP do strony logowania przy użyciu prawidłowej nazwy użytkownika i przewidywanie hasło.</span><span class="sxs-lookup"><span data-stu-id="d598c-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="d598c-154">Jeśli odgadnięcia hasła jest prawidłowa, strony logowania zwróci pliku cookie biletu uwierzytelniania, w tym momencie program wie, że ma on stumbled po parę prawidłowe nazwy użytkownika i hasła.</span><span class="sxs-lookup"><span data-stu-id="d598c-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="d598c-155">Poprzez atak siłowy takiego programu może być możliwość natknąć się od hasła użytkownika, zwłaszcza, jeśli hasło jest słabym.</span><span class="sxs-lookup"><span data-stu-id="d598c-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="d598c-156">Aby uniknąć takich ataków siłowych, w ramach członkostwa do zablokowania użytkownika, jeśli istnieje wiele prób zalogowania się niepowodzeniem w określonym czasie.</span><span class="sxs-lookup"><span data-stu-id="d598c-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="d598c-157">Dokładne parametry są konfigurowane za pomocą następujących ustawień konfiguracji dwóch dostawcy członkostwa:</span><span class="sxs-lookup"><span data-stu-id="d598c-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="d598c-158">`maxInvalidPasswordAttempts` -Określa, ile nieprawidłowe hasło prób są dozwolone dla użytkownika w przedziale czasu, zanim konto jest zablokowane. Wartość domyślna to 5.</span><span class="sxs-lookup"><span data-stu-id="d598c-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="d598c-159">`passwordAttemptWindow` -Określa okres czasu, w ciągu kilku minut, podczas których określoną liczbę nieudanych prób logowania spowoduje, że konto zostało zablokowane. Wartość domyślna to 10.</span><span class="sxs-lookup"><span data-stu-id="d598c-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="d598c-160">Jeśli użytkownik zostały zablokowane, ona nie mogą się zalogować, dopóki administrator odblokowuje konto.</span><span class="sxs-lookup"><span data-stu-id="d598c-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="d598c-161">Po użytkownik zostaje zablokowane, `ValidateUser` zostanie metoda *zawsze* zwracają `False`nawet wtedy, gdy podano prawidłowe poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="d598c-161">When a user is locked out, the `ValidateUser` method will *always* return `False`, even if valid credentials are supplied.</span></span> <span data-ttu-id="d598c-162">Podczas tego zachowania zmniejsza prawdopodobieństwo, że haker spowoduje awarię do witryny za pomocą metod atak siłowy, jego znajdą blokowaniem prawidłowym użytkownikiem, który po prostu zapomniał swojego hasła lub przypadkowo ma włączony klawisz Caps Lock lub wystąpił zły dzień Pisownia.</span><span class="sxs-lookup"><span data-stu-id="d598c-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="d598c-163">Niestety nie ma wbudowanego narzędzia odblokowywania konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="d598c-164">Aby odblokować konto, możesz zmodyfikować bazy danych bezpośrednio — zmienić `IsLockedOut` pole `aspnet_Membership` tabeli na odpowiednim kontem użytkownika — lub utworzyć opartego na sieci web interfejs, który wyświetla blokady konta przy użyciu opcji, aby je odblokować.</span><span class="sxs-lookup"><span data-stu-id="d598c-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="d598c-165">Będziemy sprawdzać Tworzenie interfejsów administracyjnych do wykonywania typowych zadań związanych z kontem i roli użytkownika w przyszłości zapoznać się z samouczkiem.</span><span class="sxs-lookup"><span data-stu-id="d598c-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="d598c-166">Jednym z minusów `ValidateUser` metodą jest, że gdy podane poświadczenia są nieprawidłowe, nie zapewnia żadnych wyjaśnienie, dlaczego.</span><span class="sxs-lookup"><span data-stu-id="d598c-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="d598c-167">Poświadczenia mogą być nieprawidłowe, ponieważ nie istnieje żadne pasującą parę nazwy użytkownika i hasła w magazynie użytkownika lub ponieważ użytkownik nie ma jeszcze zatwierdzone lub użytkownik został zablokowany. W kroku 4 zobaczymy sposób wyświetlania bardziej szczegółowy komunikat dla użytkownika, gdy ich próba logowania nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="d598c-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>


## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="d598c-168">Krok 2. Zbieranie poświadczeń za pomocą kontrolki sieci Web logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="d598c-169">[Formantu sieci Web logowania](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) powoduje wyświetlenie domyślnego interfejsu użytkownika jest bardzo podobne do przedstawionego utworzyliśmy w <a id="Tutorial02"> </a> [ *omówienie uwierzytelniania formularzy* ](../introduction/an-overview-of-forms-authentication-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="d598c-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial.</span></span> <span data-ttu-id="d598c-170">Za pomocą kontrolki logowania zapisuje NAS Praca z konieczności tworzenia interfejsu do zbierania poświadczeń odwiedzającego.</span><span class="sxs-lookup"><span data-stu-id="d598c-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="d598c-171">Ponadto kontrolki logowania automatycznie zaloguje użytkowników (przy założeniu, że przesłane poświadczenia są poprawne), a tym samym zapisywanie nam od konieczności pisania kodu.</span><span class="sxs-lookup"><span data-stu-id="d598c-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="d598c-172">Zaktualizujmy `Login.aspx`, zastępując utworzonych ręcznie interfejsu i kodu za pomocą kontrolki logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="d598c-173">Start, usuwając istniejący kod znaczników i kodu w `Login.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d598c-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="d598c-174">Możesz usunąć ją od razu wykupić lub po prostu komentarz dotyczący działanie. Aby przekształcić w komentarz oznaczeniu deklaracyjnym, należy ująć ją za pomocą `<%--` i `--%>` ograniczników.</span><span class="sxs-lookup"><span data-stu-id="d598c-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="d598c-175">Ograniczniki te można wprowadzić ręcznie lub, jak pokazano na rysunku 2, możesz wybrać tekst, który ma komentarz, a następnie kliknij przycisk Komentarz zaznaczonych wierszach ikonę na pasku narzędzi.</span><span class="sxs-lookup"><span data-stu-id="d598c-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="d598c-176">Podobnie umożliwia komentarz ikonę wybranych wierszy w komentarz zaznaczony kod w klasie CodeBehind.</span><span class="sxs-lookup"><span data-stu-id="d598c-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>


<span data-ttu-id="d598c-177">[![Komentarz istniejące deklaratywne znaczników i kodu źródłowego w Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span></span>

<span data-ttu-id="d598c-178">**Rysunek 2**: Komentarz się istniejących deklaratywne znaczników i kodu źródłowego w Login.aspx ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in Login.aspx  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d598c-179">Komentarz ikonę wybranych wierszy nie jest dostępna podczas wyświetlania oznaczeniu deklaracyjnym w programie Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="d598c-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="d598c-180">Jeśli nie używasz programu Visual Studio 2008 należy ręcznie dodać `<%--` i `--%>` ograniczników.</span><span class="sxs-lookup"><span data-stu-id="d598c-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>


<span data-ttu-id="d598c-181">Następnie przeciągnij formant logowania z przybornika do strony i ustaw jego `ID` właściwość `myLogin`.</span><span class="sxs-lookup"><span data-stu-id="d598c-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="d598c-182">W tym momencie ekran powinien wyglądać podobnie do rysunek 3.</span><span class="sxs-lookup"><span data-stu-id="d598c-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="d598c-183">Należy pamiętać, że kontrolka Login domyślny interfejs zawiera kontrolki TextBox dla nazwy użytkownika i hasło, Pamiętaj mnie przy następnym pole wyboru i przycisk w dzienniku.</span><span class="sxs-lookup"><span data-stu-id="d598c-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="d598c-184">Dostępne są także `RequiredFieldValidator` kontrolki dla dwóch pól tekstowych.</span><span class="sxs-lookup"><span data-stu-id="d598c-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>


<span data-ttu-id="d598c-185">[![Dodaj kontrolkę logowanie do strony](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span></span>

<span data-ttu-id="d598c-186">**Rysunek 3**: Dodaj kontrolkę logowanie do strony ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span></span>


<span data-ttu-id="d598c-187">I wszystko jest gotowe!</span><span class="sxs-lookup"><span data-stu-id="d598c-187">And we're done!</span></span> <span data-ttu-id="d598c-188">Po kliknięciu przycisk Zaloguj kontrolki logowania nastąpi odświeżenie strony i kontrolki logowania będzie wywoływać `Membership.ValidateUser` metody, przekazując wprowadzić nazwę użytkownika i hasło.</span><span class="sxs-lookup"><span data-stu-id="d598c-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="d598c-189">Jeśli poświadczenia są nieprawidłowe, kontrolka Login wyświetla komunikat informujący, np.</span><span class="sxs-lookup"><span data-stu-id="d598c-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="d598c-190">Jeśli jednak poświadczenia są prawidłowe, kontrolka Login tworzy bilet uwierzytelniania formularzy i przekierowuje użytkownika do odpowiedniej strony.</span><span class="sxs-lookup"><span data-stu-id="d598c-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="d598c-191">Kontrolka Login używa czterech czynników do określenia odpowiedniej strony do przekierowania użytkownika po pomyślnym zalogowaniu:</span><span class="sxs-lookup"><span data-stu-id="d598c-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="d598c-192">Czy kontrolki logowania się na stronie logowania, zgodnie z definicją `loginUrl` ustawieniu konfiguracji uwierzytelniania formularzy; wartość domyślna tego ustawienia to `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="d598c-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="d598c-193">Obecność `ReturnUrl` parametr querystring</span><span class="sxs-lookup"><span data-stu-id="d598c-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="d598c-194">Wartość kontrolki logowania [ `DestinationUrl` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="d598c-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="d598c-195">`defaultUrl` Wartość określona w formularzach Ustawienia konfiguracji uwierzytelniania; wartość domyślna to ustawienie jest Default.aspx</span><span class="sxs-lookup"><span data-stu-id="d598c-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is Default.aspx</span></span>

<span data-ttu-id="d598c-196">Rysunek 4 przedstawia, jak kontrolka Login korzysta z tych czterech parametrów na decyzję odpowiedniej strony.</span><span class="sxs-lookup"><span data-stu-id="d598c-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>


<span data-ttu-id="d598c-197">[![Dodaj kontrolkę logowanie do strony](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span></span>

<span data-ttu-id="d598c-198">**Rysunek 4**: Dodaj kontrolkę logowanie do strony ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span></span>


<span data-ttu-id="d598c-199">Poświęć chwilę, w celu przetestowania kontrolki logowania, odwiedzając witrynę za pośrednictwem przeglądarki i logując się jako istniejącego użytkownika w ramach członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="d598c-200">Kontrolka Login renderowanych interfejs jest wysoce konfigurowalne.</span><span class="sxs-lookup"><span data-stu-id="d598c-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="d598c-201">Istnieje kilka właściwości, które mają wpływ na jego wygląd; Co więcej kontrolki logowania, można przekonwertować na szablon precyzyjną kontrolę nad tym układ elementów interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="d598c-202">W pozostałej części tego kroku zbadamy, jak dostosować wygląd i układ.</span><span class="sxs-lookup"><span data-stu-id="d598c-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="d598c-203">Dostosowywanie wyglądu kontrolki logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="d598c-204">Kontrolka Login domyślne ustawienia właściwości renderowania interfejsu użytkownika z tytułem (Zaloguj), kontrolki pola tekstowego i etykiety dla nazwy użytkownika i hasła danych wejściowych, Pamiętaj mnie czasu obok pola wyboru, a przycisk Zaloguj.</span><span class="sxs-lookup"><span data-stu-id="d598c-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="d598c-205">Wystąpienia te elementy są wszystkie konfigurowane za pomocą kontrolki logowania wiele właściwości.</span><span class="sxs-lookup"><span data-stu-id="d598c-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="d598c-206">Ponadto można dodać dodatkowe elementy interfejsu użytkownika — np. łącze do strony, aby utworzyć nowe konto użytkownika — przez ustawienie właściwości lub dwie.</span><span class="sxs-lookup"><span data-stu-id="d598c-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="d598c-207">Poświęć kilka chwil gussy wygląd naszego kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="d598c-208">Ponieważ `Login.aspx` strona ma już tekstu w górnej części strony, która jest wyświetlany komunikat logowania, tytuł kontrolka Login jest zbędny.</span><span class="sxs-lookup"><span data-stu-id="d598c-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="d598c-209">W związku z tym, wyczyść [ `TitleText` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) wartość, aby można było usunąć tytuł kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="d598c-210">Nazwa użytkownika: i hasło: Etykiety na lewo od dwóch kontrolek TextBox można dostosować za pomocą [ `UserNameLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) i [ `PasswordLabelText` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d598c-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="d598c-211">Zmienimy nazwę użytkownika: Etykiety można odczytać nazwy użytkownika:.</span><span class="sxs-lookup"><span data-stu-id="d598c-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="d598c-212">Style etykiety i pole tekstowe są konfigurowane za pomocą [ `LabelStyle` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) i [ `TextBoxStyle` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d598c-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="d598c-213">Zapamiętaj mnie właściwości Text następnego wyboru czasu można ustawić za pomocą kontrolki logowania [ `RememberMeText` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), i domyślną zaewidencjonowane, stan jest konfigurowane za pomocą [ `RememberMeSet` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx)(której wartość domyślna to False).</span><span class="sxs-lookup"><span data-stu-id="d598c-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="d598c-214">Przejdź dalej i ustawić `RememberMeSet` właściwości na wartość True, dzięki czemu Pamiętaj mnie czasu obok pola wyboru będzie sprawdzany przez domyślny.</span><span class="sxs-lookup"><span data-stu-id="d598c-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="d598c-215">Kontrolka Login oferuje dwie właściwości dostosowania układu jej kontrolek interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="d598c-216">[ `TextLayout` Właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) wskazuje, czy nazwa użytkownika: i hasło: Etykiety są wyświetlane po lewej stronie, ich odpowiednich pól tekstowych (ustawienie domyślne) lub nad nimi.</span><span class="sxs-lookup"><span data-stu-id="d598c-216">The [`TextLayout` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="d598c-217">[ `Orientation` Właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) wskazuje, czy dane wejściowe użytkownika i hasło są umieszczone w pionie (jeden nad drugim) lub w poziomie.</span><span class="sxs-lookup"><span data-stu-id="d598c-217">The [`Orientation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="d598c-218">Zamierzam pozostawić te dwie właściwości ustawione na ich wartości domyślne, ale zachęcam Cię do wypróbowania ustawienie tych dwóch właściwości do wartości innych niż domyślne, aby zobaczyć efekt wynikowy.</span><span class="sxs-lookup"><span data-stu-id="d598c-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="d598c-219">W następnej sekcji konfigurowania układu kontrolki logowania przyjrzymy się przy użyciu szablonów definiują dokładny układ elementy interfejsu użytkownika formantu układu.</span><span class="sxs-lookup"><span data-stu-id="d598c-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>


<span data-ttu-id="d598c-220">Podsumowanie ustawień właściwości kontrolki logowania, ustawiając [ `CreateUserText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) i [ `CreateUserUrl` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) do nie zarejestrowano jeszcze?</span><span class="sxs-lookup"><span data-stu-id="d598c-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="d598c-221">Tworzenie konta usługi!</span><span class="sxs-lookup"><span data-stu-id="d598c-221">Create an account!</span></span> <span data-ttu-id="d598c-222">i `~/Membership/CreatingUserAccounts.aspx`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d598c-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="d598c-223">Spowoduje to dodanie hiperłącze interfejsu kontrolka Login wskazuje stronę utworzonego w <a id="Tutorial05"> </a> [poprzedni Samouczek](creating-user-accounts-vb.md).</span><span class="sxs-lookup"><span data-stu-id="d598c-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md).</span></span> <span data-ttu-id="d598c-224">Kontrolka Login [ `HelpPageText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) i [ `HelpPageUrl` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) i [ `PasswordRecoveryText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) i [ `PasswordRecoveryUrl` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) działają w taki sam sposób renderowania łączy do strony pomocy i strona odzyskiwania hasła.</span><span class="sxs-lookup"><span data-stu-id="d598c-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="d598c-225">Po wprowadzeniu tych zmian właściwości oznaczeniu deklaracyjnym i wyglądu kontrolki logowania powinien wyglądać podobnie do przedstawionego na rysunku 5.</span><span class="sxs-lookup"><span data-stu-id="d598c-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>


<span data-ttu-id="d598c-226">[![Wartości właściwości kontrolek logowania dyktowanie jego wygląd](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span></span>

<span data-ttu-id="d598c-227">**Rysunek 5**: Właściwości kontrolek logowania wartości dyktowanie jego wygląd ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span></span>


### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="d598c-228">Konfigurowanie układu kontrolki logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="d598c-229">Kontrolka sieci Web logowania domyślnym interfejsem użytkownika decydujących o interfejsu w kodzie HTML `<table>`.</span><span class="sxs-lookup"><span data-stu-id="d598c-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="d598c-230">Ale co zrobić, jeśli potrzebujemy bardziej precyzyjną kontrolę nad wyniku renderowania?</span><span class="sxs-lookup"><span data-stu-id="d598c-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="d598c-231">Może być chcemy zastąpić `<table>` z serią `<div>` tagów.</span><span class="sxs-lookup"><span data-stu-id="d598c-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="d598c-232">Lub co zrobić, jeśli nasza aplikacja wymaga dodatkowych poświadczeń do uwierzytelniania?</span><span class="sxs-lookup"><span data-stu-id="d598c-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="d598c-233">Wiele witryn sieci Web finansowych, na przykład wymagać od użytkowników Podaj nie tylko nazwę użytkownika i hasło, ale również osobisty numer identyfikacyjny (PIN) lub inne informacje identyfikacyjne.</span><span class="sxs-lookup"><span data-stu-id="d598c-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="d598c-234">Niezależnie od przyczyny mogą być, jest możliwe do przekonwertowania kontrolka Login szablon, w którym firma Microsoft wyraźnie zdefiniować oznaczeniu deklaracyjnym interfejsu.</span><span class="sxs-lookup"><span data-stu-id="d598c-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="d598c-235">Musimy wykonać dwie czynności, aby można było zaktualizować kontrolki logowania do zbierania dodatkowych poświadczeń:</span><span class="sxs-lookup"><span data-stu-id="d598c-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="d598c-236">Zaktualizuj interfejs kontrolki logowania do uwzględnienia w kontrolkach internetowych do zbierania dodatkowych poświadczeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="d598c-237">Tak, aby użytkownik jest uwierzytelniany tylko, jeśli nazwy użytkownika i hasła jest prawidłowa, a ich dodatkowe poświadczenia są prawidłowe, zbyt, musi zostać zastąpiona logiki uwierzytelniania wewnętrznego kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="d598c-238">Aby wykonać pierwsze zadanie, musimy przekonwertować kontrolki logowania na szablon i Dodaj wymagane kontrolki sieci Web.</span><span class="sxs-lookup"><span data-stu-id="d598c-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="d598c-239">Jak w przypadku drugie zadanie logiki uwierzytelniania kontrolki logowania może zostać zastąpiona przez tworzenie obsługi zdarzeń dla formantu [ `Authenticate` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="d598c-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="d598c-240">Zaktualizujmy kontrolki logowania, który monituje użytkowników o ich nazwy użytkownika, hasło i adres e-mail i uwierzytelnia użytkownika tylko wtedy, jeśli podany adres e-mail jest zgodny adres e-mail użytkownika w pliku.</span><span class="sxs-lookup"><span data-stu-id="d598c-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="d598c-241">Najpierw musimy przekonwertować interfejsu kontroli Zaloguj się do szablonu.</span><span class="sxs-lookup"><span data-stu-id="d598c-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="d598c-242">Kontrolka Login tagu inteligentnego Wybierz Konwertuj do opcji szablonu.</span><span class="sxs-lookup"><span data-stu-id="d598c-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>


<span data-ttu-id="d598c-243">[![Konwertuj kontrolkę Zaloguj się do szablonu](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span></span>

<span data-ttu-id="d598c-244">**Rysunek 6**: Konwertuj kontrolkę Zaloguj się do szablonu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d598c-245">Aby cofnąć kontrolka Login wstępnie template wersji, kliknij link resetowania z tagu kontrolki.</span><span class="sxs-lookup"><span data-stu-id="d598c-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>


<span data-ttu-id="d598c-246">Konwertowanie szablonu kontrolki logowania dodaje `LayoutTemplate` do formantu w oznaczeniu deklaracyjnym za pomocą elementów kodu HTML i formantów sieci Web, definiowanie interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="d598c-247">Jak pokazano na rysunku 7, konwertowania formant z szablonem usuwa wiele właściwości w oknie właściwości, takie jak `TitleText`, `CreateUserUrl`, i tak dalej, ponieważ wartości tych właściwości są ignorowane, gdy przy użyciu szablonu.</span><span class="sxs-lookup"><span data-stu-id="d598c-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>


<span data-ttu-id="d598c-248">[![Mniej właściwości są dostępne podczas logowania kontrolny została przeniesiona do szablonu](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span></span>

<span data-ttu-id="d598c-249">**Rysunek 7**: Mniej właściwości są dostępne podczas logowania kontrolny jest konwertowana na szablon ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span></span>


<span data-ttu-id="d598c-250">Kod znaczników HTML w `LayoutTemplate` może być modyfikowany.</span><span class="sxs-lookup"><span data-stu-id="d598c-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="d598c-251">Podobnie możesz dodać żadnych nowych formantów sieci Web do szablonu.</span><span class="sxs-lookup"><span data-stu-id="d598c-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="d598c-252">Jednak ważne jest, kontrolki sieci Web core tej kontrolki logowania pozostają w szablonie i zachować przypisanych do nich `ID` wartości.</span><span class="sxs-lookup"><span data-stu-id="d598c-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="d598c-253">W szczególności nie zostaje usunięte ani zmienić nazwy `UserName` lub `Password` pola tekstowe, `RememberMe` zaznacz pole wyboru `LoginButton` przycisku `FailureText` etykietę, lub `RequiredFieldValidator` kontrolki.</span><span class="sxs-lookup"><span data-stu-id="d598c-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="d598c-254">Aby zebrać adres e-mail osoby odwiedzającej, należy dodać pole tekstowe do szablonu.</span><span class="sxs-lookup"><span data-stu-id="d598c-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="d598c-255">Dodaj następujące oznaczeniu deklaracyjnym między wierszem tabeli (`<tr>`) zawierający `Password` pola tekstowego i wiersza tabeli, który przechowuje Pamiętaj mnie obok czasu wyboru:</span><span class="sxs-lookup"><span data-stu-id="d598c-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample2.aspx)]

<span data-ttu-id="d598c-256">Po dodaniu `Email` pola tekstowego, odwiedź stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="d598c-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="d598c-257">Jak pokazano na rysunku 8, interfejs użytkownika kontrolki logowania zawiera teraz trzecie pole tekstowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>


<span data-ttu-id="d598c-258">[![Kontrolka Login teraz zawiera pole tekstowe dla adresu E-mail użytkownika](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span></span>

<span data-ttu-id="d598c-259">**Rysunek 8**: Kontrolka Login teraz zawiera pole tekstowe dla adresu E-mail użytkownika ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span></span>


<span data-ttu-id="d598c-260">Na tym etapie kontrolka Login jest nadal przy użyciu `Membership.ValidateUser` metodę, aby sprawdzić poprawność podanych poświadczeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="d598c-261">Odpowiednio wartość zawierana `Email` pole tekstowe nie ma żadnego wpływu na tego, czy użytkownik może zalogować się.</span><span class="sxs-lookup"><span data-stu-id="d598c-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="d598c-262">W kroku 3 przedstawiony zostanie sposób zastąpienia kontrolka Login logiki uwierzytelniania, dzięki czemu poświadczenia tylko są uznawane za ważne, jeśli nazwa użytkownika i hasło są prawidłowe, a podany adres e-mail jest zgodny za pomocą adresu e-mail w pliku.</span><span class="sxs-lookup"><span data-stu-id="d598c-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="d598c-263">Krok 3. Modyfikowanie logiki uwierzytelniania kontrolki logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="d598c-264">Po użytkownik dostarcza jej poświadczenia i kliknięcia, które ensues przycisk Zaloguj odświeżenie strony i logowania sterowania przechodzi od jego przepływu pracy uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="d598c-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="d598c-265">Przepływ pracy jest uruchamiany, tworząc [ `LoggingIn` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="d598c-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="d598c-266">Wszystkie procedury obsługi zdarzeń skojarzonych z tym zdarzeniem może spowodować anulowanie dziennika operacji, ustawiając `e.Cancel` właściwość `True`.</span><span class="sxs-lookup"><span data-stu-id="d598c-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `True`.</span></span>

<span data-ttu-id="d598c-267">Jeśli nie zostanie anulowana dziennika operacji, przepływ pracy w miarę, tworząc [ `Authenticate` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="d598c-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="d598c-268">Jeśli program obsługi zdarzeń dla `Authenticate` zdarzeń, a następnie ją jest odpowiedzialny za sprawdzenie, czy podane poświadczenia są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="d598c-269">Jeśli zostanie określona żadna procedura obsługi zdarzeń, korzysta z kontrolki logowania `Membership.ValidateUser` metody do sprawdzania poprawności poświadczeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="d598c-270">Jeśli podane poświadczenia są prawidłowe, a następnie zostanie utworzony bilet uwierzytelniania formularzy, [ `LoggedIn` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) jest wywoływane, a użytkownik jest przekierowywany do odpowiedniej strony.</span><span class="sxs-lookup"><span data-stu-id="d598c-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="d598c-271">Jeśli jednak poświadczenia zostaną uznane za nieprawidłowe, a następnie [ `LoginError` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) jest wywoływane i zostanie wyświetlony komunikat informujący użytkownika, że ich poświadczenia były nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="d598c-272">Domyślnie w przypadku niepowodzenia logowania kontroli po prostu ustawia jego `FailureText` etykiety formantu właściwość Text na komunikat o błędzie (próba logowania zakończyła się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="d598c-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="d598c-273">Spróbuj ponownie później).</span><span class="sxs-lookup"><span data-stu-id="d598c-273">Please try again ).</span></span> <span data-ttu-id="d598c-274">Jednak jeśli kontrolka Login [ `FailureAction` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) ustawiono `RedirectToLoginPage`, następnie problemów kontrolki logowania `Response.Redirect` do strony logowania, dodając parametr querystring `loginfailure=1` (co powoduje, że nazwa logowania formant, aby wyświetlić komunikat o błędzie).</span><span class="sxs-lookup"><span data-stu-id="d598c-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="d598c-275">Rysunek 9 oferuje jest blokowy przepływu pracy uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="d598c-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>


<span data-ttu-id="d598c-276">[![Przepływ pracy uwierzytelniania kontrolki logowania](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span></span>

<span data-ttu-id="d598c-277">**Rysunek 9**: Przepływ pracy uwierzytelniania kontrolka Login ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d598c-278">Jeśli zastanawiasz zastosowania `FailureAction`firmy `RedirectToLogin` Strona opcji, należy rozważyć następujący scenariusz.</span><span class="sxs-lookup"><span data-stu-id="d598c-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="d598c-279">Obecnie nasz `Site.master` strony wzorcowej ma obecnie tekst Witaj, stranger wyświetlana w kolumnie po lewej stronie, gdy odwiedzanych przez użytkownika anonimowego, ale Wyobraź sobie, że Chcieliśmy, aby zastąpić ten tekst za pomocą kontrolki logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="d598c-280">Pozwoliłoby to użytkownik anonimowy zalogować się na dowolnej stronie w witrynie, nie wymagając od nich bezpośrednio odwiedź stronę logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="d598c-281">Jednak jeśli użytkownik nie może zalogować się za pomocą kontrolki logowania renderowany przez stronę wzorcową, sensowne przekierowywania ich do strony logowania (`Login.aspx`), ponieważ tej strony, prawdopodobnie zawiera dodatkowe informacje, łącza i innych pomoc — np. linki w celu utworzenia nowe konto lub pobrać utraty hasła —, które nie zostały dodane do strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="d598c-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>


### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="d598c-282">Tworzenie`Authenticate`program obsługi zdarzeń</span><span class="sxs-lookup"><span data-stu-id="d598c-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="d598c-283">Aby podłączyć naszych logiki uwierzytelniania niestandardowego, należy utworzyć program obsługi zdarzeń dla formantu logowania `Authenticate` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="d598c-284">Tworzenie zdarzenia obsługi dla `Authenticate` zdarzeń wygeneruje następującą definicję obsługi zdarzenia:</span><span class="sxs-lookup"><span data-stu-id="d598c-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample3.vb)]

<span data-ttu-id="d598c-285">Jak widać, `Authenticate` programu obsługi zdarzeń jest przekazywany obiekt typu [ `AuthenticateEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) jako drugi parametr wejściowy.</span><span class="sxs-lookup"><span data-stu-id="d598c-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="d598c-286">`AuthenticateEventArgs` Klasa zawiera właściwość typu Boolean o nazwie `Authenticated` używany do określenia, czy podane poświadczenia są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="d598c-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="d598c-287">Nasze zadania, a następnie jest napisać tutaj kod, który określa, czy podane poświadczenia są prawidłowe i ustawienie `e.Authenticate` właściwość odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d598c-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="d598c-288">Określanie i sprawdzanie poprawności podanych poświadczeń</span><span class="sxs-lookup"><span data-stu-id="d598c-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="d598c-289">Korzystanie z kontrolki logowania [ `UserName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) i [ `Password` właściwości](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) można określić nazwę użytkownika i hasło poświadczeń wprowadzonych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="d598c-290">W celu określenia wartości wprowadzone do wszelkich dodatkowych formantów sieci Web (takie jak `Email` TextBox dodane w poprzednim kroku), użyj `LoginControlID.FindControl`("*`controlID`*") do uzyskania programowego odwołania do sieci Web formant w szablonie, którego `ID` właściwości jest równa *`controlID`*.</span><span class="sxs-lookup"><span data-stu-id="d598c-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use `LoginControlID.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="d598c-291">Na przykład, aby pobrać odwołanie do `Email` pola tekstowego, użyj następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="d598c-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`Dim EmailTextBox As TextBox = CType(myLogin.FindControl("Email"), TextBox)`

<span data-ttu-id="d598c-292">Aby zweryfikować poświadczenia użytkownika należy wykonać dwie czynności:</span><span class="sxs-lookup"><span data-stu-id="d598c-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="d598c-293">Upewnij się, że podana nazwa użytkownika i hasło są prawidłowe</span><span class="sxs-lookup"><span data-stu-id="d598c-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="d598c-294">Upewnij się, czy wprowadzony adres e-mail jest zgodna z adresem e-mail plik dla użytkowników próbujących się zalogować</span><span class="sxs-lookup"><span data-stu-id="d598c-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="d598c-295">Aby osiągnąć Sprawdź najpierw, możemy po prostu użyć `Membership.ValidateUser` metody, takie jak widzieliśmy w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="d598c-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="d598c-296">Dla drugiego wyboru należy ustalić adres e-mail użytkownika, aby firma Microsoft może porównać na adres e-mail, wprowadzone w formancie TextBox.</span><span class="sxs-lookup"><span data-stu-id="d598c-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="d598c-297">Aby uzyskać informacje na temat określonego użytkownika, należy użyć `Membership` klasy [ `GetUser` metoda](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="d598c-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="d598c-298">`GetUser` Metoda ma kilka przeciążeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="d598c-299">Jeśli nie określono przekazywanie w żadnych parametrów, zwraca informacje o aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="d598c-300">Aby uzyskać informacje na temat określonego użytkownika, wywołaj `GetUser` przekazując swoją nazwę użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="d598c-301">W obu przypadkach `GetUser` zwraca [ `MembershipUser` obiektu](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), który ma właściwości, takie jak `UserName`, `Email`, `IsApproved`, `IsOnline`i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="d598c-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="d598c-302">Poniższy kod implementuje tych dwóch kontroli.</span><span class="sxs-lookup"><span data-stu-id="d598c-302">The following code implements these two checks.</span></span> <span data-ttu-id="d598c-303">Jeśli oba zakończy się pomyślnie, następnie `e.Authenticate` ustawiono `True`, w przeciwnym razie jest ona przypisana `False`.</span><span class="sxs-lookup"><span data-stu-id="d598c-303">If both pass, then `e.Authenticate` is set to `True`, otherwise it is assigned `False`.</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample4.vb)]

<span data-ttu-id="d598c-304">Przy użyciu tego kodu w miejscu spróbuj zalogować się jako prawidłowego użytkownika, wprowadzając prawidłową nazwę użytkownika, hasło i adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="d598c-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="d598c-305">Spróbuj ponownie, ale tym razem użyj celowo nieprawidłowy adres e-mail (zobacz rysunek 10).</span><span class="sxs-lookup"><span data-stu-id="d598c-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="d598c-306">Na koniec Wypróbuj raz trzeci przy użyciu nazwy użytkownika nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="d598c-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="d598c-307">W pierwszym przypadku należy pomyślnie zalogowanie się do witryny, ale w dwóch ostatnich przypadkach powinien zostać wyświetlony komunikat nieprawidłowe poświadczenia kontrolka Login.</span><span class="sxs-lookup"><span data-stu-id="d598c-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>


<span data-ttu-id="d598c-308">[![Tito nie można zalogować się w przypadku określenia nieprawidłowy adres E-mail](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span></span>

<span data-ttu-id="d598c-309">**Na rysunku nr 10**: Tito nie dziennika w przypadku dostarczenie niepoprawny adres E-mail ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="d598c-310">Zgodnie z opisem w sekcji jak członkostwa Framework obsługuje nieprawidłowych prób logowania w kroku 1, gdy `Membership.ValidateUser` metoda jest nazywana i przekazywana nieprawidłowe poświadczenia, jego śledzi Nieprawidłowa próba logowania i blokuje się użytkownika, jeśli określony przekraczają Próg nieudanych prób podania w określonym przedziale czasu.</span><span class="sxs-lookup"><span data-stu-id="d598c-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="d598c-311">Od naszych wywołania logiki uwierzytelniania niestandardowego `ValidateUser` metody niepoprawnego hasła dla prawidłowej nazwy użytkownika powoduje zwiększenie licznika próba nieprawidłowego logowania, ale ten licznik nie jest zwiększany w przypadku, gdy nazwa użytkownika i hasło są prawidłowe, ale adres e-mail jest nieprawidłowy.</span><span class="sxs-lookup"><span data-stu-id="d598c-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="d598c-312">To, to zachowanie jest odpowiedni, ponieważ jest mało prawdopodobne, że haker będzie znać nazwę użytkownika i hasło, ale ma używanie atak siłowy techniki, aby określić adres e-mail użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>


## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="d598c-313">Krok 4. Poprawa kontrolka Login nieprawidłowymi poświadczeniami komunikatu</span><span class="sxs-lookup"><span data-stu-id="d598c-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="d598c-314">Gdy użytkownik próbuje się zalogować przy użyciu nieprawidłowych poświadczeń, kontrolka Login pojawi się komunikat wyjaśniający, że próba logowania nie powiodła się.</span><span class="sxs-lookup"><span data-stu-id="d598c-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="d598c-315">W szczególności kontrolka wyświetla komunikat określony przez jego [ `FailureText` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), który ma wartość domyślną próba logowania zakończyła się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="d598c-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="d598c-316">Spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="d598c-316">Please try again.</span></span>

<span data-ttu-id="d598c-317">Odwołaj, istnieje wiele powodów dlaczego poświadczeń użytkownika może być nieprawidłowy:</span><span class="sxs-lookup"><span data-stu-id="d598c-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="d598c-318">Nazwa użytkownika nie istnieje</span><span class="sxs-lookup"><span data-stu-id="d598c-318">The username may not exist</span></span>
- <span data-ttu-id="d598c-319">Nazwa użytkownika istnieje, ale hasło jest nieprawidłowe</span><span class="sxs-lookup"><span data-stu-id="d598c-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="d598c-320">Nazwa użytkownika i hasło są prawidłowe, ale użytkownik nie jest jeszcze zatwierdzone.</span><span class="sxs-lookup"><span data-stu-id="d598c-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="d598c-321">Nazwa użytkownika i hasło są prawidłowe, ale użytkownik jest zablokowany limit (najprawdopodobniej ponieważ przekroczyły liczbę nieudanych prób logowania w określonym przedziale czasu)</span><span class="sxs-lookup"><span data-stu-id="d598c-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="d598c-322">I może być też inne przyczyny przy użyciu logiki uwierzytelniania niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="d598c-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="d598c-323">Na przykład z kodem napisaliśmy w kroku 3, nazwa użytkownika i hasło może być prawidłowy, ale adres e-mail jest niepoprawny.</span><span class="sxs-lookup"><span data-stu-id="d598c-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="d598c-324">Niezależnie od tego, dlaczego poświadczenia są nieprawidłowe kontrolka Login wyświetla ten sam komunikat o błędzie.</span><span class="sxs-lookup"><span data-stu-id="d598c-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="d598c-325">Ten brak opinii może być mylące dla użytkownika, którego konto nie ma jeszcze zatwierdzone lub który zostało zablokowane. Usługa trochę pracy, firma Microsoft udostępnia kontrolki logowania, wyświetli się komunikat bardziej odpowiednie.</span><span class="sxs-lookup"><span data-stu-id="d598c-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="d598c-326">Zawsze, gdy użytkownik próbuje zalogować się przy użyciu nieprawidłowych poświadczeń zgłasza kontrolka Login jego `LoginError` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d598c-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="d598c-327">Przejdź dalej i utworzyć program obsługi zdarzeń dla tego zdarzenia i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="d598c-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample5.vb)]

<span data-ttu-id="d598c-328">Powyższy kod, który rozpoczyna się przez ustawienie kontrolki logowania `FailureText` właściwości na wartość domyślną (próba logowania zakończyła się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="d598c-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="d598c-329">Spróbuj ponownie później).</span><span class="sxs-lookup"><span data-stu-id="d598c-329">Please try again ).</span></span> <span data-ttu-id="d598c-330">Następnie sprawdza, jeśli nazwę, którą podano mapuje do istniejącego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="d598c-331">Jeśli tak, consults wynikowy `MembershipUser` obiektu `IsLockedOut` i `IsApproved` właściwości w celu ustalenia, czy konto zostało zablokowane lub nie została jeszcze zatwierdzona.</span><span class="sxs-lookup"><span data-stu-id="d598c-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="d598c-332">W obu przypadkach `FailureText` właściwość zostanie zaktualizowany w celu odpowiadająca wartość.</span><span class="sxs-lookup"><span data-stu-id="d598c-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="d598c-333">Aby przetestować ten kod, celowo próbować zalogować się jako istniejącego użytkownika, ale użyć niepoprawnego hasła.</span><span class="sxs-lookup"><span data-stu-id="d598c-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="d598c-334">Wykonaj tym pięć razy pod rząd w przedziale czasu wynoszącym 10 minut, a konto zostanie zablokowane. Jak przedstawia rysunek 11, logowanie kolejnych prób będzie zawsze się nie powieść (nawet w przypadku prawidłowego hasła), ale będą teraz wyświetlane bardziej opisowe Twoje konto zostało zablokowane z powodu zbyt wielu nieudanych prób logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="d598c-335">Skontaktuj się z administratorem i poproś wiadomości odblokować konto.</span><span class="sxs-lookup"><span data-stu-id="d598c-335">Please contact the administrator to have your account unlocked message.</span></span>


<span data-ttu-id="d598c-336">[![Tito wykonana zbyt wiele nieudanych prób logowania, a zostało zablokowane](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d598c-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span></span>

<span data-ttu-id="d598c-337">**Rysunek 11**: Tito wykonywane zbyt wiele nieprawidłowych prób logowania ma został zablokowany do edycji i ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d598c-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d598c-338">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="d598c-338">Summary</span></span>

<span data-ttu-id="d598c-339">Wcześniejsze tego samouczka naszą stronę logowania sprawdzić poprawności podanych poświadczeń z ustaloną listą par nazwa użytkownika i hasło.</span><span class="sxs-lookup"><span data-stu-id="d598c-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="d598c-340">W tym samouczku Zaktualizowaliśmy stronę, aby zweryfikować poświadczeń względem framework członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="d598c-341">W kroku 1 przyjrzeliśmy się przy użyciu `Membership.ValidateUser` metoda programowo.</span><span class="sxs-lookup"><span data-stu-id="d598c-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="d598c-342">W kroku 2 zastąpiliśmy naszego interfejsu ręcznie utworzone przez użytkownika i kodu za pomocą kontrolki logowania.</span><span class="sxs-lookup"><span data-stu-id="d598c-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="d598c-343">Kontrolka Login powoduje wyświetlenie interfejsu użytkownika standardowego logowania i automatycznie przeprowadza walidację poświadczeń użytkownika względem framework członkostwa.</span><span class="sxs-lookup"><span data-stu-id="d598c-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="d598c-344">Ponadto w przypadku prawidłowe poświadczenia, kontrolka Login loguje użytkownika za pomocą uwierzytelniania formularzy.</span><span class="sxs-lookup"><span data-stu-id="d598c-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="d598c-345">Krótko mówiąc w pełni funkcjonalne logowania użytkownika jest dostępna po prostu przeciągając kontrolki logowania do strony, nie dodatkowych oznaczeniu deklaracyjnym lub kod.</span><span class="sxs-lookup"><span data-stu-id="d598c-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="d598c-346">Co więcej, kontrolka Login jest dużym stopniu dostosowywane, pozwalając na poprawnie stopnia kontroli nad zarówno renderowanych interfejsu i uwierzytelniania logikę użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="d598c-347">W tym momencie odwiedzających naszą witrynę internetową można utworzyć nowego konta użytkownika i dziennika do witryny, ale musimy jeszcze Przyjrzyj się ograniczenie dostępu do stron, na podstawie uwierzytelnionego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="d598c-348">Obecnie każdy użytkownik, uwierzytelnieni lub anonimowi, można wyświetlić dowolną stronę w naszej witrynie.</span><span class="sxs-lookup"><span data-stu-id="d598c-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="d598c-349">Wraz z kontroli dostępu do stron naszej witrynie na podstawie użytkownika przez użytkownika, firma Microsoft może być niektóre strony, w których funkcje zależą od użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="d598c-350">Następnego samouczka pokazano, jak ograniczyć dostęp i funkcje na stronie, na podstawie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="d598c-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="d598c-351">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="d598c-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d598c-352">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="d598c-352">Further Reading</span></span>

<span data-ttu-id="d598c-353">Więcej informacji na tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="d598c-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d598c-354">Wyświetlanie niestandardowych komunikatów zablokowane i nie zatwierdzonych użytkowników</span><span class="sxs-lookup"><span data-stu-id="d598c-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="d598c-355">Badanie programu ASP.NET 2.0 na członkostwo, role i profilu</span><span class="sxs-lookup"><span data-stu-id="d598c-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="d598c-356">Instrukcje: Tworzenie strony logowania programu ASP.NET</span><span class="sxs-lookup"><span data-stu-id="d598c-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="d598c-357">Dokumentacja techniczna kontrolki logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="d598c-358">Korzystanie z kontrolek logowania</span><span class="sxs-lookup"><span data-stu-id="d598c-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="d598c-359">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="d598c-359">About the Author</span></span>

<span data-ttu-id="d598c-360">Pracował nad Bento Scottem, autor wiele książek ASP/ASP.NET i założyciel 4GuysFromRolla.com, przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="d598c-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d598c-361">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="d598c-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d598c-362">Jego najnowszą książkę Stephena  *[Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="d598c-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="d598c-363">Scott można z Tobą skontaktować w [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem jego blog znajduje się na [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="d598c-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="d598c-364">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="d598c-364">Special Thanks To</span></span>

<span data-ttu-id="d598c-365">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="d598c-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d598c-366">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Teresa Murphy i Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="d598c-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="d598c-367">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="d598c-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d598c-368">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="d598c-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d598c-369">[Poprzednie](creating-user-accounts-vb.md)
> [dalej](user-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d598c-369">[Previous](creating-user-accounts-vb.md)
[Next](user-based-authorization-vb.md)</span></span>
