---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
title: Tworzenie ról i zarządzanie nimi (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Ten samouczek analizuje kroki niezbędne do skonfigurowania w ramach ról. Poniżej utworzymy stron sieci web do tworzenia i usuwania ról.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: 83af9f5f-9a00-4f83-8afc-e98bdd49014e
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
msc.type: authoredcontent
ms.openlocfilehash: ef00ae5ddac44f17aed040db7df04a5c0f896caf
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/09/2019
ms.locfileid: "59386336"
---
# <a name="creating-and-managing-roles-vb"></a><span data-ttu-id="73a69-104">Tworzenie ról i zarządzanie nimi (VB)</span><span class="sxs-lookup"><span data-stu-id="73a69-104">Creating and Managing Roles (VB)</span></span>

<span data-ttu-id="73a69-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="73a69-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="73a69-106">[Pobierz program Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) lub [Pobierz plik PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="73a69-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span></span>

> <span data-ttu-id="73a69-107">Ten samouczek analizuje kroki niezbędne do skonfigurowania w ramach ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="73a69-108">Poniżej utworzymy stron sieci web do tworzenia i usuwania ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-108">Following that, we will build web pages to create and delete roles.</span></span>


## <a name="introduction"></a><span data-ttu-id="73a69-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="73a69-109">Introduction</span></span>

<span data-ttu-id="73a69-110">W <a id="_msoanchor_1"> </a> [ *autoryzacja na podstawie użytkownika* ](../membership/user-based-authorization-vb.md) samouczka będziemy przyjrzano się przy użyciu Autoryzacja adresów URL do ograniczenia dostępu w przypadku niektórych użytkowników zestaw stron oraz zbadano deklaracyjne i programowe techniki dostosowywania funkcji strony ASP.NET na podstawie zaproszonych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="73a69-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-vb.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="73a69-111">Udzielanie uprawnień dostępu do strony lub funkcji na podstawie użytkownika przez użytkownika, jednak może stać się okropnej konserwacji, w scenariuszach w przypadku, gdy istnieje wiele kont użytkowników, lub gdy uprawnienia użytkowników zmieniają się często.</span><span class="sxs-lookup"><span data-stu-id="73a69-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="73a69-112">Ilekroć użytkownika zyskuje lub traci autoryzacji do wykonania określonego zadania, administrator musi zaktualizować odpowiednich reguł autoryzacji adresów URL, deklaratywne znaczników i kodu.</span><span class="sxs-lookup"><span data-stu-id="73a69-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="73a69-113">Niemniej przykład często pomoże do klasyfikowania użytkowników do grup lub *role* a następnie zastosować uprawnienia na podstawie roli przez rolę.</span><span class="sxs-lookup"><span data-stu-id="73a69-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="73a69-114">Na przykład większość aplikacji sieci web ma określony zestaw stron lub zadania, które są przeznaczone tylko do użytkowników administracyjnych.</span><span class="sxs-lookup"><span data-stu-id="73a69-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="73a69-115">Za pomocą technik wyniesione *autoryzacja na podstawie użytkownika* samouczku dodamy odpowiednie reguły autoryzacji adresów URL, deklaratywne znaczników i kodu, aby umożliwić określone konta użytkowników do wykonywania zadań administracyjnych.</span><span class="sxs-lookup"><span data-stu-id="73a69-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="73a69-116">Ale jeśli dodano nowego administratora lub istniejącego administratora niezbędnych do jej prawa administracyjne odwołany, firma Microsoft musiałaby wróć i aktualizować pliki konfiguracji i stron sieci web.</span><span class="sxs-lookup"><span data-stu-id="73a69-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="73a69-117">Przy użyciu ról jednak można utworzyć rolę o nazwie Administratorzy i przypisz tych zaufanych użytkowników do roli Administratorzy.</span><span class="sxs-lookup"><span data-stu-id="73a69-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="73a69-118">Następnie dodamy odpowiednie reguły autoryzacji adresów URL, deklaratywne znaczników i kodu, aby umożliwić roli Administratorzy w celu wykonywania różnych zadań administracyjnych.</span><span class="sxs-lookup"><span data-stu-id="73a69-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="73a69-119">Dzięki tej infrastruktury w miejscu Dodawanie nowych administratorów do witryny lub usunięcie istniejących jest proste i polega na tym lub usuwanie użytkownika z rolą administratora.</span><span class="sxs-lookup"><span data-stu-id="73a69-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="73a69-120">Nie konfiguracji, oznaczeniu deklaracyjnym lub zmian w kodzie są niezbędne.</span><span class="sxs-lookup"><span data-stu-id="73a69-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="73a69-121">Program ASP.NET oferuje role umożliwiająca Definiowanie ról i skojarzenie ich z kontami użytkowników.</span><span class="sxs-lookup"><span data-stu-id="73a69-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="73a69-122">Za pomocą framework ról, firma Microsoft można tworzyć i usuwać role należy dodać użytkowników lub usunąć użytkowników z roli, określić zbiór użytkowników, które należą do określonej roli i sprawdzić, czy użytkownik należy do określonej roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="73a69-123">Skonfigurowane w ramach ról firma Microsoft może ograniczyć dostęp do stron, na podstawie roli roli przy użyciu reguł autoryzacji adresów URL i Pokaż lub Ukryj dodatkowe informacje i funkcje na stronie, na podstawie ról aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="73a69-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="73a69-124">Ten samouczek analizuje kroki niezbędne do skonfigurowania w ramach ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="73a69-125">Poniżej utworzymy stron sieci web do tworzenia i usuwania ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="73a69-126">W <a id="_msoanchor_2"> </a> [ *przypisywanie ról do użytkowników* ](assigning-roles-to-users-vb.md) samouczka przyjrzymy się jak dodawać i usuwać użytkowników z ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-vb.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="73a69-127">A następnie w <a id="_msoanchor_3"> </a> [ *autoryzacji opartej na rolach* ](role-based-authorization-vb.md) samouczek, należy sprawdzić, jak ograniczyć dostęp do stron, na podstawie roli według roli oraz jak dostosować zależności funkcji strony w roli zaproszonych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="73a69-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="73a69-128">Zaczynajmy!</span><span class="sxs-lookup"><span data-stu-id="73a69-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="73a69-129">Krok 1. Dodawanie nowej strony ASP.NET</span><span class="sxs-lookup"><span data-stu-id="73a69-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="73a69-130">W tym samouczku i kolejne dwa firma Microsoft będzie mieć badanie różnych funkcji związanych z ról i funkcji.</span><span class="sxs-lookup"><span data-stu-id="73a69-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="73a69-131">Musimy szereg stron ASP.NET do zaimplementowania tematy dotyczące badania w tych samouczkach.</span><span class="sxs-lookup"><span data-stu-id="73a69-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="73a69-132">Umożliwia tworzenie tych stron i zaktualizuj mapy witryny.</span><span class="sxs-lookup"><span data-stu-id="73a69-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="73a69-133">Rozpocznij od utworzenia nowego folderu w projekcie o nazwie `Roles`.</span><span class="sxs-lookup"><span data-stu-id="73a69-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="73a69-134">Następnie dodaj cztery nowe strony programu ASP.NET do `Roles` folderze łączenia każdego stronę z `Site.master` strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="73a69-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="73a69-135">Nazwa strony:</span><span class="sxs-lookup"><span data-stu-id="73a69-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="73a69-136">Na tym etapie projektu w Eksploratorze rozwiązań powinny wyglądać podobnie do ekranu zrzut, jak pokazano na rysunku 1.</span><span class="sxs-lookup"><span data-stu-id="73a69-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


[![F<span data-ttu-id="73a69-137">Nasze nowe strony zostały dodane do folderu role]</span><span class="sxs-lookup"><span data-stu-id="73a69-137">our New Pages Have Been Added to the Roles Folder]</span></span>(creating-and-managing-roles-vb/_static/image2.png)](creating-and-managing-roles-vb/_static/image1.png)

<span data-ttu-id="73a69-138">**Rysunek 1**: Cztery nowe strony zostały dodane do `Roles` Folder ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image3.png))</span></span>


<span data-ttu-id="73a69-139">Każda strona w tym momencie powinna mieć dwóch kontrolek zawartości, jeden dla każdej strony wzorcowej kontrolek ContentPlaceHolder: `MainContent` i `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="73a69-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample1.aspx)]

<span data-ttu-id="73a69-140">Pamiętamy `LoginContent` firmy ContentPlaceHolder domyślne znaczników Wyświetla łącze do logowania się lub wylogowywania z lokacji, w zależności od tego, czy użytkownik jest uwierzytelniony.</span><span class="sxs-lookup"><span data-stu-id="73a69-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="73a69-141">Obecność `Content2` zawartości kontrolki na stronie ASP.NET, jednak zastępuje znaczników domyślnej strony wzorcowej.</span><span class="sxs-lookup"><span data-stu-id="73a69-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="73a69-142">Tak jak Omówiliśmy to w <a id="_msoanchor_4"> </a> [ *omówienie uwierzytelniania formularzy* ](../introduction/an-overview-of-forms-authentication-vb.md) samouczek, Zastępowanie domyślnego języka znaczników przydaje się na stronach, gdy nie chcemy wyświetlić skojarzone z logowaniem Opcje w lewej kolumnie.</span><span class="sxs-lookup"><span data-stu-id="73a69-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="73a69-143">Te cztery stron, chcemy wyświetlić znaczników domyślną stronę wzorcową dla `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="73a69-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="73a69-144">W związku z tym, Usuń oznaczeniu deklaracyjnym dla `Content2` formantu zawartości.</span><span class="sxs-lookup"><span data-stu-id="73a69-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="73a69-145">Po wykonaniu tej czynności, wszystkich znaczników cztery strony powinna zawierać tylko jeden formant zawartości.</span><span class="sxs-lookup"><span data-stu-id="73a69-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="73a69-146">Na koniec zaktualizuj mapy witryny (`Web.sitemap`) do uwzględnienia tych nowych stron sieci web.</span><span class="sxs-lookup"><span data-stu-id="73a69-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="73a69-147">Dodaj następujący kod XML po `<siteMapNode>` dodaliśmy samouczki członkostwa.</span><span class="sxs-lookup"><span data-stu-id="73a69-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample2.xml)]

<span data-ttu-id="73a69-148">Za pomocą mapy witryny aktualizacji odwiedź witrynę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="73a69-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="73a69-149">Jak pokazano na rysunku 2, nawigacji po lewej stronie teraz zawiera elementy samouczki ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>


[![F<span data-ttu-id="73a69-150">Nasze nowe strony zostały dodane do folderu role]</span><span class="sxs-lookup"><span data-stu-id="73a69-150">our New Pages Have Been Added to the Roles Folder]</span></span>(creating-and-managing-roles-vb/_static/image5.png)](creating-and-managing-roles-vb/_static/image4.png)

<span data-ttu-id="73a69-151">**Rysunek 2**: Cztery nowe strony zostały dodane do `Roles` Folder ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image6.png))</span></span>


## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="73a69-152">Krok 2. Określanie i Konfigurowanie dostawcy Framework ról</span><span class="sxs-lookup"><span data-stu-id="73a69-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="73a69-153">Jak w ramach członkostwa w ramach ról jest kompilowanych na podstawie modelu dostawców.</span><span class="sxs-lookup"><span data-stu-id="73a69-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="73a69-154">Zgodnie z opisem w <a id="_msoanchor_5"> </a> [ *podstawy zabezpieczeń i Obsługa platformy ASP.NET* ](../introduction/security-basics-and-asp-net-support-vb.md) samouczek, .NET Framework jest dostarczany z trzech dostawców wbudowanych ról: [ `AuthorizationStoreRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx) , [ `WindowsTokenRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), i [ `SqlRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="73a69-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-vb.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="73a69-155">W tej serii samouczków skupia się na `SqlRoleProvider`, który używa jako magazynu ról bazy danych programu Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="73a69-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="73a69-156">Wewnętrznie framework ról i `SqlRoleProvider` działają podobnie jak w ramach członkostwa i `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="73a69-157">.NET Framework zawiera `Roles` klasy, która służy jako interfejs API, aby w ramach ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="73a69-158">`Roles` Klasy udostępnił metod, takich jak `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="73a69-158">The `Roles` class has shared methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="73a69-159">Podczas wywoływania jednej z następujących metod `Roles` klasy deleguje wywołanie skonfigurowany dostawca.</span><span class="sxs-lookup"><span data-stu-id="73a69-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="73a69-160">`SqlRoleProvider` Współpracuje z tabel pełnionymi (`aspnet_Roles` i `aspnet_UsersInRoles`) w odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="73a69-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="73a69-161">Aby można było używać `SqlRoleProvider` dostawcy w naszej aplikacji, należy określić, jakie bazy danych do użycia jako magazyn.</span><span class="sxs-lookup"><span data-stu-id="73a69-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="73a69-162">`SqlRoleProvider` Oczekuje sklepu określoną rolę, aby mieć określone tabele bazy danych, widoków i procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="73a69-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="73a69-163">Te obiekty wymagania bazy danych można dodać za pomocą [ `aspnet_regsql.exe` narzędzie](https://msdn.microsoft.com/library/ms229862.aspx).</span><span class="sxs-lookup"><span data-stu-id="73a69-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="73a69-164">W tym momencie mamy już bazę danych przy użyciu schematu, które są niezbędne do `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="73a69-165">Ponownie <a id="_msoanchor_6"> </a> [ *tworzenie schematu członkostwa w programie SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) samouczku utworzyliśmy bazę danych o nazwie `SecurityTutorials.mdf` i używać `aspnet_regsql.exe` umożliwiające dodanie aplikacji usługi, które uwzględnione obiekty bazy danych wymagane przez `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="73a69-166">W związku z tym musimy poinformować szablon role, aby włączyć obsługę roli oraz używanie `SqlRoleProvider` z `SecurityTutorials.mdf` baza danych jako magazynu ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="73a69-167">W ramach ról jest skonfigurowany za pośrednictwem `<roleManager>` element aplikacji w witrynie `Web.config` pliku.</span><span class="sxs-lookup"><span data-stu-id="73a69-167">The Roles framework is configured via the `<roleManager>` element in the application's `Web.config` file.</span></span> <span data-ttu-id="73a69-168">Domyślnie obsługa roli jest wyłączona.</span><span class="sxs-lookup"><span data-stu-id="73a69-168">By default, role support is disabled.</span></span> <span data-ttu-id="73a69-169">Aby ją włączyć, należy ustawić [ `<roleManager>` ](https://msdn.microsoft.com/library/ms164660.aspx) elementu `enabled` atrybutu `true` w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="73a69-169">To enable it, you must set the [`<roleManager>`](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample3.xml)]

<span data-ttu-id="73a69-170">Domyślnie wszystkie aplikacje sieci web mają dostawcy ról, o nazwie `AspNetSqlRoleProvider` typu `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="73a69-171">Ten dostawca domyślny jest zarejestrowany w `machine.config` (znajdujący się w `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="73a69-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample4.xml)]

<span data-ttu-id="73a69-172">Dostawcy `connectionStringName` atrybut określa magazynu ról, które jest używane.</span><span class="sxs-lookup"><span data-stu-id="73a69-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="73a69-173">`AspNetSqlRoleProvider` Dostawcy ustawia ten atrybut `LocalSqlServer`, który również jest zdefiniowany w `machine.config` i punkty, domyślnie do bazy danych programu SQL Server 2005 Express Edition w `App_Data` folder o nazwie `aspnet.mdf`.</span><span class="sxs-lookup"><span data-stu-id="73a69-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="73a69-174">W związku z tym jeśli bez określania żadnych informacji o dostawcy w naszej aplikacji możemy po prostu włącz framework role `Web.config` plik, aplikacja używa domyślnego zarejestrowany dostawca ról, `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="73a69-175">Jeśli `~/App_Data/aspnet.mdf` bazy danych nie istnieje, środowisko uruchomieniowe ASP.NET utworzyć automatycznie i Dodaj schemat usług aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73a69-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="73a69-176">Jednak firma Microsoft nie chcesz używać `aspnet.mdf` bazy danych; zamiast chcemy do użycia `SecurityTutorials.mdf` bazy danych, który możemy wcześniej utworzony i dodany schemat usług aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73a69-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="73a69-177">Ta modyfikacja można zrobić na dwa sposoby:</span><span class="sxs-lookup"><span data-stu-id="73a69-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="73a69-178"><strong>Określ wartość dla</strong><strong>`LocalSqlServer`</strong><strong>nazwa parametrów połączenia w</strong><strong>`Web.config`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="73a69-178"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="73a69-179">Przez zastąpienie `LocalSqlServer` wartość Nazwa parametrów połączenia w `Web.config`, możemy użyć domyślnej zarejestrowany dostawca ról (`AspNetSqlRoleProvider`) i jest poprawnie pracować `SecurityTutorials.mdf` bazy danych.</span><span class="sxs-lookup"><span data-stu-id="73a69-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="73a69-180">Aby uzyskać więcej informacji na temat tej techniki, zobacz [Scott Guthrie](https://weblogs.asp.net/scottgu/)firmy wpis w blogu [Konfigurowanie platformy ASP.NET 2.0 usługi aplikacji, użyj programu SQL Server 2000 lub SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="73a69-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="73a69-181"><strong>Dodaj nowego dostawcę zarejestrowanego typu</strong><strong>`SqlRoleProvider`</strong><strong>i konfigurowania jej</strong><strong>`connectionStringName`</strong><strong>ustawienie, aby wskazywał</strong> <strong>`SecurityTutorials.mdf`</strong> <strong>bazy danych.</strong></span><span class="sxs-lookup"><span data-stu-id="73a69-181"><strong>Add a new registered provider of type</strong><strong>`SqlRoleProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="73a69-182">Jest to metoda zalecana i używane w <a id="_msoanchor_7"> </a> [ *tworzenie schematu członkostwa w programie SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) samouczek to podejście będę używać w tym samouczku, jak również.</span><span class="sxs-lookup"><span data-stu-id="73a69-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="73a69-183">Dodaj następujące role konfiguracji znaczników `Web.config` pliku.</span><span class="sxs-lookup"><span data-stu-id="73a69-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="73a69-184">Ten kod znaczników rejestruje nowego dostawcę o nazwie</span><span class="sxs-lookup"><span data-stu-id="73a69-184">This markup registers a new provider named</span></span> `SecurityTutorialsSqlRoleProvider.`

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample5.xml)]

<span data-ttu-id="73a69-185">Definiuje znaczniki powyżej `SecurityTutorialsSqlRoleProvider` jako domyślnego dostawcę (za pośrednictwem `defaultProvider` atrybutu w `<roleManager>` elementu).</span><span class="sxs-lookup"><span data-stu-id="73a69-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="73a69-186">Ustawia również `SecurityTutorialsSqlRoleProvider`firmy `applicationName` ustawienie `SecurityTutorials`, która jest taka sama `applicationName` ustawienia używane przez dostawcy członkostwa (`SecurityTutorialsSqlMembershipProvider`).</span><span class="sxs-lookup"><span data-stu-id="73a69-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="73a69-187">Gdy nie są wyświetlane w tym miejscu [ `<add>` elementu](https://msdn.microsoft.com/library/ms164662.aspx) dla `SqlRoleProvider` może również zawierać `commandTimeout` atrybutu, aby określić wartość limitu czasu bazy danych w ciągu kilku sekund.</span><span class="sxs-lookup"><span data-stu-id="73a69-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="73a69-188">Wartość domyślna to 30.</span><span class="sxs-lookup"><span data-stu-id="73a69-188">The default value is 30.</span></span>

<span data-ttu-id="73a69-189">Za pomocą tej konfiguracji znaczników w miejscu jesteśmy gotowi rozpocząć korzystanie z funkcji ról w ramach naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73a69-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="73a69-190">Powyższe znaczników konfiguracji ilustruje użycie `<roleManager>` elementu `enabled` i `defaultProvider` atrybutów.</span><span class="sxs-lookup"><span data-stu-id="73a69-190">The above configuration markup illustrates using the `<roleManager>` element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="73a69-191">Istnieje szereg innych atrybutów, które mają wpływ na sposób w ramach ról kojarzy informacje o roli na podstawie użytkownika według.</span><span class="sxs-lookup"><span data-stu-id="73a69-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="73a69-192">Będziemy sprawdzać tych ustawień w <a id="_msoanchor_8"> </a> [ *autoryzacji opartej na rolach* ](role-based-authorization-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="73a69-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial.</span></span>


## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="73a69-193">Krok 3. Badanie interfejs API ról</span><span class="sxs-lookup"><span data-stu-id="73a69-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="73a69-194">Funkcje w ramach ról jest uwidaczniany za pomocą [ `Roles` klasy](https://msdn.microsoft.com/library/system.web.security.roles.aspx), zawierającą trzynaście udostępnionego metody służące do wykonywania operacji opartej na rolach.</span><span class="sxs-lookup"><span data-stu-id="73a69-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen shared methods for performing role-based operations.</span></span> <span data-ttu-id="73a69-195">Gdy przyjrzymy się tworzenia i usuwania ról w kroki 4 i 6 użyjemy [ `CreateRole` ](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) i [ `DeleteRole` ](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) metody, które dodać lub usunąć rolę z systemu.</span><span class="sxs-lookup"><span data-stu-id="73a69-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="73a69-196">Aby uzyskać listę wszystkich ról w systemie, użyj [ `GetAllRoles` metoda](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (zobacz krok 5).</span><span class="sxs-lookup"><span data-stu-id="73a69-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="73a69-197">[ `RoleExists` Metoda](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) zwraca wartość logiczną wskazującą, czy określona rola istnieje.</span><span class="sxs-lookup"><span data-stu-id="73a69-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="73a69-198">W następnym samouczku będziemy sprawdzać Tworzenie skojarzeń użytkowników z rolami.</span><span class="sxs-lookup"><span data-stu-id="73a69-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="73a69-199">`Roles` Klasy [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [ `AddUserToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [ `AddUsersToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), i [ `AddUsersToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) metody Dodaj co najmniej jednego użytkownika do co najmniej jedną rolę.</span><span class="sxs-lookup"><span data-stu-id="73a69-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="73a69-200">Aby usunąć użytkowników z ról, należy użyć [ `RemoveUserFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [ `RemoveUserFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [ `RemoveUsersFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), lub [ `RemoveUsersFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) metody.</span><span class="sxs-lookup"><span data-stu-id="73a69-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="73a69-201">W <a id="_msoanchor_9"> </a> [ *autoryzacji opartej na rolach* ](role-based-authorization-vb.md) samouczku przedstawiony zostanie sposób programowo pokazać lub ukryć funkcji na podstawie roli aktualnie zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="73a69-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="73a69-202">Aby to osiągnąć, możemy użyć klasy roli [ `FindUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [ `GetRolesForUser` ](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [ `GetUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), lub [ `IsUserInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) metody.</span><span class="sxs-lookup"><span data-stu-id="73a69-202">To accomplish this, we can use the Role class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="73a69-203">Należy pamiętać o tym, które jest wywoływane, ilekroć jednej z następujących metod, `Roles` klasy deleguje wywołanie skonfigurowany dostawca.</span><span class="sxs-lookup"><span data-stu-id="73a69-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="73a69-204">W naszym przypadku oznacza to, że wywołanie jest wysyłany do `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="73a69-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="73a69-205">`SqlRoleProvider` Następnie wykonuje operację z odpowiednią bazą danych, na podstawie wywoływanej metody.</span><span class="sxs-lookup"><span data-stu-id="73a69-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="73a69-206">Na przykład, kod `Roles.CreateRole("Administrators")` skutkuje `SqlRoleProvider` wykonywania `aspnet_Roles_CreateRole` procedurą składowaną, która wstawia nowy rekord do `aspnet_Roles` tabelę o nazwie Administratorzy.</span><span class="sxs-lookup"><span data-stu-id="73a69-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>


<span data-ttu-id="73a69-207">W pozostałej części tego samouczka analizuje przy użyciu `Roles` klasy `CreateRole`, `GetAllRoles`, i `DeleteRole` metody do zarządzania rolami w systemie.</span><span class="sxs-lookup"><span data-stu-id="73a69-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="73a69-208">Krok 4. Tworzenie nowych ról</span><span class="sxs-lookup"><span data-stu-id="73a69-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="73a69-209">Role umożliwiają arbitralnie grupy użytkowników i najczęściej ta metoda grupowania jest używana do bardziej wygodne stosuje reguły autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="73a69-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="73a69-210">Jednak aby można było używać ról jako mechanizmu autoryzacji, najpierw należy zdefiniować role, jakie istnieje w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="73a69-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="73a69-211">Niestety program ASP.NET nie ma kontroli CreateRoleWizard.</span><span class="sxs-lookup"><span data-stu-id="73a69-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="73a69-212">Aby dodać nowe role musimy utworzyć interfejs użytkownika odpowiedni i wywołania interfejsu API ról, określić główną przyczynę.</span><span class="sxs-lookup"><span data-stu-id="73a69-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="73a69-213">Dobra wiadomość jest to bardzo łatwe.</span><span class="sxs-lookup"><span data-stu-id="73a69-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="73a69-214">W trakcie nie formantu sieci CreateRoleWizard Web ma [narzędzie Administratorskie witryny sieci Web platformy ASP.NET](https://msdn.microsoft.com/library/ms228053.aspx), czyli lokalnej aplikacji platformy ASP.NET zaprojektowany na potrzeby przeglądania i zarządzania konfiguracją aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="73a69-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="73a69-215">Jednak nie mam duże fanem narzędzie Administratorskie witryny sieci Web platformy ASP.NET z dwóch przyczyn.</span><span class="sxs-lookup"><span data-stu-id="73a69-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="73a69-216">Najpierw jest nieco pracowały i środowisko użytkownika pozostawia znacznie być wskazane.</span><span class="sxs-lookup"><span data-stu-id="73a69-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="73a69-217">Po drugie narzędzie Administratorskie witryny sieci Web platformy ASP.NET jest przeznaczony do działają tylko lokalnie, co oznacza, że konieczne będzie można utworzyć własną rolę zarządzania stron sieci web, jeśli trzeba zarządzać zdalnie ról w działającej witrynie.</span><span class="sxs-lookup"><span data-stu-id="73a69-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="73a69-218">Tych dwóch powodów w tym samouczku, a następnie koncentruje się na tworzenie roli niezbędne narzędzia do zarządzania na stronie sieci web, a nie opierając się na narzędzie Administratorskie witryny sieci Web platformy ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="73a69-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>


<span data-ttu-id="73a69-219">Otwórz `ManageRoles.aspx` stronie `Roles` folderu oraz dodawać do strony pola tekstowego i kontrolki przycisku w sieci Web.</span><span class="sxs-lookup"><span data-stu-id="73a69-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="73a69-220">Ustaw formant pola tekstowego `ID` właściwości `RoleName` i przycisku `ID` i `Text` właściwości w celu `CreateRoleButton` i Utwórz rolę, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="73a69-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="73a69-221">W tym momencie oznaczeniu deklaracyjnym strony powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="73a69-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample6.aspx)]

<span data-ttu-id="73a69-222">Następnie kliknij dwukrotnie `CreateRoleButton` formantu w projektancie, aby utworzyć przycisk `Click` program obsługi zdarzeń, a następnie dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="73a69-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample7.vb)]

<span data-ttu-id="73a69-223">Powyższy kod uruchamia, przypisując Nazwa roli przycięty, wprowadzić w `RoleName` polu tekstowym `newRoleName` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="73a69-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="73a69-224">Następnie `Roles` klasy `RoleExists` metoda jest wywoływana w celu określenia, czy rola `newRoleName` już istnieje w systemie.</span><span class="sxs-lookup"><span data-stu-id="73a69-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="73a69-225">Jeśli rola nie istnieje, jest tworzony przez wywołanie `CreateRole` metody.</span><span class="sxs-lookup"><span data-stu-id="73a69-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="73a69-226">Jeśli `CreateRole` metody jest przekazywana nazwa roli, która już istnieje w systemie, `ProviderException` wyjątku.</span><span class="sxs-lookup"><span data-stu-id="73a69-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="73a69-227">Dlatego kod najpierw sprawdza, aby upewnić się, że rola nie istnieje już w systemie przed wywołaniem `CreateRole`.</span><span class="sxs-lookup"><span data-stu-id="73a69-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="73a69-228">`Click` Programu obsługi zdarzeń stwierdza, usuwając `RoleName` pola `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="73a69-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="73a69-229">Możesz się zastanawiać, co się stanie, jeśli użytkownik nie wprowadzić dowolną wartość w `RoleName` pola tekstowego.</span><span class="sxs-lookup"><span data-stu-id="73a69-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="73a69-230">Jeśli wartość przekazywana do `CreateRole` metodą jest `Nothing` lub pustym ciągiem, wyjątek jest zgłaszany.</span><span class="sxs-lookup"><span data-stu-id="73a69-230">If the value passed into the `CreateRole` method is `Nothing` or an empty string, an exception is raised.</span></span> <span data-ttu-id="73a69-231">Podobnie jeśli nazwa roli zawiera przecinek jest zgłaszany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="73a69-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="73a69-232">W związku z tym strony powinna zawierać kontrolek weryfikacji, aby upewnić się, użytkownik musi wprowadzić roli i że nie zawiera żadnych przecinkami.</span><span class="sxs-lookup"><span data-stu-id="73a69-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="73a69-233">Opuścić w charakterze ćwiczenia dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="73a69-233">I leave as an exercise for the reader.</span></span>


<span data-ttu-id="73a69-234">Utwórz rolę o nazwie Administratorzy.</span><span class="sxs-lookup"><span data-stu-id="73a69-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="73a69-235">Odwiedź stronę `ManageRoles.aspx` stronie za pośrednictwem przeglądarki, wpisz w polu tekstowym administratorów (patrz rysunek 3), a następnie kliknij przycisk Utwórz rolę.</span><span class="sxs-lookup"><span data-stu-id="73a69-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>


[![C<span data-ttu-id="73a69-236">Twórz grupy administratorów]</span><span class="sxs-lookup"><span data-stu-id="73a69-236">reate an Administrators Role]</span></span>(creating-and-managing-roles-vb/_static/image8.png)](creating-and-managing-roles-vb/_static/image7.png)

<span data-ttu-id="73a69-237">**Rysunek 3**: Utworzenie roli administratorów ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image9.png))</span></span>


<span data-ttu-id="73a69-238">Co się dzieje?</span><span class="sxs-lookup"><span data-stu-id="73a69-238">What happens?</span></span> <span data-ttu-id="73a69-239">Występuje odświeżenie strony, ale nie ma żadnych wizualnych oznak aktywacji, który faktycznie został rolę dodawane do systemu.</span><span class="sxs-lookup"><span data-stu-id="73a69-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="73a69-240">Firma Microsoft aktualizuje tę stronę w kroku 5, aby uwzględnić wizualną opinię.</span><span class="sxs-lookup"><span data-stu-id="73a69-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="73a69-241">Teraz, jednak możesz sprawdzić, przechodząc do utworzono rolę `SecurityTutorials.mdf` bazy danych i wyświetlanie danych za pomocą `aspnet_Roles` tabeli.</span><span class="sxs-lookup"><span data-stu-id="73a69-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="73a69-242">Jak pokazano na rysunku 4, `aspnet_Roles` tabela zawiera rekord o rolach administratorów po prostu dodanego przez producenta.</span><span class="sxs-lookup"><span data-stu-id="73a69-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>


[![T<span data-ttu-id="73a69-243">ma on aspnet_Roles tabeli Wiersz dla administratorów]</span><span class="sxs-lookup"><span data-stu-id="73a69-243">he aspnet_Roles Table has a Row for the Administrators]</span></span>(creating-and-managing-roles-vb/_static/image11.png)](creating-and-managing-roles-vb/_static/image10.png)

<span data-ttu-id="73a69-244">**Rysunek 4**: `aspnet_Roles` Tabela zawiera wiersz dla administratorów ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image12.png))</span></span>


## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="73a69-245">Krok 5. Wyświetlanie ról w systemie</span><span class="sxs-lookup"><span data-stu-id="73a69-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="73a69-246">Możemy rozszerzyć `ManageRoles.aspx` strony, aby dołączyć listę bieżących ról w systemie.</span><span class="sxs-lookup"><span data-stu-id="73a69-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="73a69-247">W tym celu należy dodać kontrolki widoku siatki do strony i ustaw jego `ID` właściwość `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="73a69-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="73a69-248">Następnie dodaj metodę do klasy CodeBehind strony o nazwie `DisplayRolesInGrid` przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="73a69-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample8.vb)]

<span data-ttu-id="73a69-249">`Roles` Klasy `GetAllRoles` metoda zwraca wszystkie role w systemie jako tablicę ciągów.</span><span class="sxs-lookup"><span data-stu-id="73a69-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="73a69-250">Ta tablica ciągów następnie jest powiązany z kontrolki GridView.</span><span class="sxs-lookup"><span data-stu-id="73a69-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="73a69-251">Aby powiązać listę ról w widoku GridView ładowaniu strony, należy wywołać `DisplayRolesInGrid` metody na stronie `Page_Load` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73a69-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="73a69-252">Poniższy kod wywołuje tę metodę, gdy najpierw odwiedzenia strony, ale nie na kolejne ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="73a69-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample9.vb)]

<span data-ttu-id="73a69-253">Przy użyciu tego kodu w miejscu odwiedź stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="73a69-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="73a69-254">Jak pokazano na rysunku 5, powinien zostać wyświetlony siatkę z jedną kolumną etykietą elementu.</span><span class="sxs-lookup"><span data-stu-id="73a69-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="73a69-255">Siatka zawiera wiersz dla roli Administratorzy, dodane w kroku 4.</span><span class="sxs-lookup"><span data-stu-id="73a69-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>


[![T<span data-ttu-id="73a69-256">Przedstawia on GridView role, w jednej kolumnie]</span><span class="sxs-lookup"><span data-stu-id="73a69-256">he GridView Displays the Roles in a Single Column]</span></span>(creating-and-managing-roles-vb/_static/image14.png)](creating-and-managing-roles-vb/_static/image13.png)

<span data-ttu-id="73a69-257">**Rysunek 5**: Kontrolki GridView są wyświetlane role w jednej kolumnie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image15.png))</span></span>


<span data-ttu-id="73a69-258">Kontrolki GridView wyświetla pojedynczy kolumnę z etykietą elementu, ponieważ w widoku GridView `AutoGenerateColumns` właściwość jest ustawiona na wartość True (domyślnie), co powoduje, że GridView automatycznie utworzyć kolumnę dla każdej właściwości w jego `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="73a69-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="73a69-259">Tablica ma tylko jedną właściwość, która reprezentuje elementów w tablicy, dlatego jednej kolumny w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="73a69-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="73a69-260">Podczas wyświetlania danych przy użyciu GridView, chcę jawnie Definiowanie kolumn, a nie ich generowane niejawnie, przy widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="73a69-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="73a69-261">Jawne określenie kolumny jest znacznie łatwiejsze do formatowania danych, zmienić kolejność kolumn i wykonywania innych typowych zadań.</span><span class="sxs-lookup"><span data-stu-id="73a69-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="73a69-262">W związku z tym zaktualizuj GridView oznaczeniu deklaracyjnym tak, aby jej kolumn są jawnie zdefiniowane.</span><span class="sxs-lookup"><span data-stu-id="73a69-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="73a69-263">Rozpocznij od GridView `AutoGenerateColumns` wartość False dla właściwości.</span><span class="sxs-lookup"><span data-stu-id="73a69-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="73a69-264">Następnie dodaj TemplateField do siatki, ustaw jego `HeaderText` właściwość role i skonfiguruj jego `ItemTemplate` tak, aby wyświetlał zawartości tablicy.</span><span class="sxs-lookup"><span data-stu-id="73a69-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="73a69-265">Aby to osiągnąć, należy dodać formant etykiety w sieci Web o nazwie `RoleNameLabel` do `ItemTemplate` i powiąż jego `Text` właściwości</span><span class="sxs-lookup"><span data-stu-id="73a69-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to</span></span> `Container.DataItem.`

<span data-ttu-id="73a69-266">Te właściwości i `ItemTemplate`jego zawartość, można ustawić deklaratywne lub przy użyciu GridView pola, okno dialogowe i Edytuj szablony interfejsu.</span><span class="sxs-lookup"><span data-stu-id="73a69-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="73a69-267">Aby uzyskać dostęp do pola okno dialogowe, kliknij łącze Edytowanie kolumn w tagu inteligentnego GridView.</span><span class="sxs-lookup"><span data-stu-id="73a69-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="73a69-268">Następnie usunąć zaznaczenie pola wyboru pól Generuj automatycznie, aby ustawić `AutoGenerateColumns` właściwości na wartość False i Dodaj TemplateField w kontrolce GridView, ustawiając jego `HeaderText` właściwości roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="73a69-269">Aby zdefiniować `ItemTemplate`firmy zawartości, wybierz opcję Edytuj szablony z GridView tagu inteligentnego.</span><span class="sxs-lookup"><span data-stu-id="73a69-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="73a69-270">Przeciągnij formant etykiety w sieci Web na `ItemTemplate`, ustaw jego `ID` właściwości `RoleNameLabel`oraz skonfigurować jego ustawienia powiązań danych, aby jego `Text` właściwość jest powiązana z `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="73a69-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="73a69-271">Niezależnie od tego, jakie podejście, możesz użyć wynikowy oznaczeniu deklaracyjnym GridView powinien wyglądać podobnie do następujących, gdy wszystko będzie gotowe.</span><span class="sxs-lookup"><span data-stu-id="73a69-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="73a69-272">Zawartość tablicy są wyświetlane przy użyciu składni wiązania danych `<%# Container.DataItem %>`.</span><span class="sxs-lookup"><span data-stu-id="73a69-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="73a69-273">Dokładny opis dlaczego ta składnia jest używana podczas wyświetlania zawartości tablicy powiązany z kontrolki GridView wykracza poza zakres tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="73a69-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="73a69-274">Aby uzyskać więcej informacji dotyczących tej kwestii, zobacz [powiązanie tablicy skalarną z formantu sieci Web danych](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="73a69-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>


<span data-ttu-id="73a69-275">Obecnie `RoleList` GridView tylko jest powiązana z listy ról, jeśli najpierw odwiedzenia strony.</span><span class="sxs-lookup"><span data-stu-id="73a69-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="73a69-276">Musimy odświeżyć siatki, po każdym dodaniu nowej roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="73a69-277">Aby to zrobić, należy zaktualizować `CreateRoleButton` przycisku `Click` programu obsługi zdarzeń, tak że wywołuje `DisplayRolesInGrid` metodę, jeśli utworzono nową rolę.</span><span class="sxs-lookup"><span data-stu-id="73a69-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample11.vb)]

<span data-ttu-id="73a69-278">Teraz, gdy użytkownik dodaje nową rolę `RoleList` GridView zawiera po prostu dodać roli w zwrotu, zapewniając wizualną opinię, że rola została pomyślnie utworzona.</span><span class="sxs-lookup"><span data-stu-id="73a69-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="73a69-279">Na przykład można znaleźć `ManageRoles.aspx` strony za pośrednictwem przeglądarki, a następnie dodaj rolę o nazwie nadzorców.</span><span class="sxs-lookup"><span data-stu-id="73a69-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="73a69-280">Po kliknięciu przycisku Utwórz rolę nastąpi odświeżenie strony i siatki zostanie zaktualizowana, aby obejmować administratorów, a także nową rolę, nadzorców.</span><span class="sxs-lookup"><span data-stu-id="73a69-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>


[![T<span data-ttu-id="73a69-281">ma on rolę nadzorców, dodano]</span><span class="sxs-lookup"><span data-stu-id="73a69-281">he Supervisors Role has Been Added]</span></span>(creating-and-managing-roles-vb/_static/image17.png)](creating-and-managing-roles-vb/_static/image16.png)

<span data-ttu-id="73a69-282">**Rysunek 6**: Rola nadzorców ma, dodano ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image18.png))</span></span>


## <a name="step-6-deleting-roles"></a><span data-ttu-id="73a69-283">Krok 6. Usuwanie ról</span><span class="sxs-lookup"><span data-stu-id="73a69-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="73a69-284">W tym momencie użytkownik może utworzyć nową rolę i wyświetlić wszystkie istniejące role z `ManageRoles.aspx` strony.</span><span class="sxs-lookup"><span data-stu-id="73a69-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="73a69-285">Teraz użytkownicy również usuwania ról.</span><span class="sxs-lookup"><span data-stu-id="73a69-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="73a69-286">`Roles.DeleteRole` Metoda ma dwa przeciążenia:</span><span class="sxs-lookup"><span data-stu-id="73a69-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="73a69-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) -Usuwa rolę *roleName*.</span><span class="sxs-lookup"><span data-stu-id="73a69-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="73a69-288">Wyjątek jest generowany, jeśli rola zawiera co najmniej jednego członka.</span><span class="sxs-lookup"><span data-stu-id="73a69-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="73a69-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) -Usuwa rolę *roleName*.</span><span class="sxs-lookup"><span data-stu-id="73a69-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="73a69-290">Jeśli *throwOnPopulateRole* jest `True`, a następnie jest zgłaszany wyjątek, jeśli rola zawiera co najmniej jednego członka.</span><span class="sxs-lookup"><span data-stu-id="73a69-290">If *throwOnPopulateRole* is `True`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="73a69-291">Jeśli *throwOnPopulateRole* jest `False`, a następnie rola zostanie usunięty, czy zawiera on żadnych elementów członkowskich, czy nie.</span><span class="sxs-lookup"><span data-stu-id="73a69-291">If *throwOnPopulateRole* is `False`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="73a69-292">Wewnętrznie `DeleteRole(roleName)` wywołania metody `DeleteRole(roleName, True)`.</span><span class="sxs-lookup"><span data-stu-id="73a69-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, True)`.</span></span>

<span data-ttu-id="73a69-293">`DeleteRole` Metoda również spowoduje zgłoszenie wyjątku, jeśli *roleName* jest `Nothing` ani być pustym ciągiem lub jeśli *roleName* zawiera przecinek.</span><span class="sxs-lookup"><span data-stu-id="73a69-293">The `DeleteRole` method will also throw an exception if *roleName* is `Nothing` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="73a69-294">Jeśli *roleName* nie istnieje w systemie, `DeleteRole` zakończy się niepowodzeniem w trybie dyskretnym, bez zgłaszania wyjątku.</span><span class="sxs-lookup"><span data-stu-id="73a69-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="73a69-295">Możemy rozszerzyć GridView w `ManageRoles.aspx` obejmujący usuwania przycisku, po kliknięciu spowoduje usunięcie wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="73a69-296">Rozpocznij, dodając do kontrolki GridView przycisk Usuń, przechodząc do okna dialogowego pól i dodawanie przycisk Usuń, który znajduje się w obszarze opcji CommandField.</span><span class="sxs-lookup"><span data-stu-id="73a69-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="73a69-297">Wprowadzić Delete znajdujący się po lewej stronie kolumny i ustaw jego `DeleteText` właściwości do usunięcia roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>


[![A<span data-ttu-id="73a69-298">Przycisk Usuń w kontrolce GridView RoleList dd]</span><span class="sxs-lookup"><span data-stu-id="73a69-298">dd a Delete Button to the RoleList GridView]</span></span>(creating-and-managing-roles-vb/_static/image20.png)](creating-and-managing-roles-vb/_static/image19.png)

<span data-ttu-id="73a69-299">**Rysunek 7**: Przycisk Usuń, aby dodać `RoleList` kontrolki GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-and-managing-roles-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="73a69-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image21.png))</span></span>


<span data-ttu-id="73a69-300">Po dodaniu przycisk Usuń, oznaczeniu deklaracyjnym w widoku GridView powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="73a69-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample12.aspx)]

<span data-ttu-id="73a69-301">Następnie należy utworzyć procedurę obsługi zdarzeń dla GridView `RowDeleting` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73a69-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="73a69-302">To zdarzenie, które jest wywoływane na odświeżenie strony, po kliknięciu przycisku Usuń rolę.</span><span class="sxs-lookup"><span data-stu-id="73a69-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="73a69-303">Dodaj następujący kod do narzędzia obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="73a69-303">Add the following code to the event handler.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample13.vb)]

<span data-ttu-id="73a69-304">Zaczyna się kod, odwołując się do programowego `RoleNameLabel` formant w wierszu kliknięcia przycisku którego usunięcia roli sieci Web.</span><span class="sxs-lookup"><span data-stu-id="73a69-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="73a69-305">`Roles.DeleteRole` Następnie wywoływana jest metoda, przekazując `Text` z `RoleNameLabel` i `False`, a tym samym usunąć rolę, niezależnie od tego, czy znajdują się użytkownicy, wszelkie skojarzone z rolą.</span><span class="sxs-lookup"><span data-stu-id="73a69-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `False`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="73a69-306">Na koniec `RoleList` GridView są odświeżane, tak aby po prostu usunąć roli nie będzie już wyświetlany w siatce.</span><span class="sxs-lookup"><span data-stu-id="73a69-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="73a69-307">Przycisk Usuń rolę nie wymaga dowolny rodzaj potwierdzenie od użytkownika przed usunięciem roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="73a69-308">Jednym z najprostszych sposobów, aby potwierdzić akcję jest poprzez okno dialogowe Potwierdź po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="73a69-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="73a69-309">Aby uzyskać więcej informacji na temat tej techniki, zobacz [dodawanie potwierdzenia po stronie klienta podczas usuwania](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="73a69-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="73a69-310">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="73a69-310">Summary</span></span>

<span data-ttu-id="73a69-311">Wiele aplikacji sieci web ma niektórych reguł autoryzacji lub funkcji na poziomie strony, które jest dostępne tylko dla niektórych klas użytkowników.</span><span class="sxs-lookup"><span data-stu-id="73a69-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="73a69-312">Na przykład może być zestaw stron sieci web, które tylko administratorzy będą mieć dostęp.</span><span class="sxs-lookup"><span data-stu-id="73a69-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="73a69-313">Zamiast definiować te reguły autoryzacji na podstawie użytkownika według, często jest bardziej użyteczny do zdefiniowania reguł na podstawie roli.</span><span class="sxs-lookup"><span data-stu-id="73a69-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="73a69-314">Zamiast jawnie, umożliwiając użytkownikom Scott i Jisun dostępu administracyjnego stron sieci web, będzie łatwiejszy w utrzymaniu podejście jest aby umożliwić członkom roli Administratorzy programu dostęp do tych stron, a następnie do oznaczania Scott i Jisun jako należące do użytkowników Grupy administratorów.</span><span class="sxs-lookup"><span data-stu-id="73a69-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="73a69-315">W ramach ról ułatwia tworzenie ról i zarządzanie nimi.</span><span class="sxs-lookup"><span data-stu-id="73a69-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="73a69-316">W tym samouczku zbadaliśmy sposobu skonfigurowania struktury role, aby użyć `SqlRoleProvider`, który używa jako magazynu ról bazy danych programu Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="73a69-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="73a69-317">Utworzyliśmy również strony sieci web, która wyświetla istniejące role w systemie i pozwala dotyczące nowych ról, które ma zostać utworzony i istniejące do usunięcia.</span><span class="sxs-lookup"><span data-stu-id="73a69-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="73a69-318">W kolejnych samouczkach zobaczymy, jak przypisać użytkowników do ról i sposób stosowania autoryzacji opartej na rolach.</span><span class="sxs-lookup"><span data-stu-id="73a69-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="73a69-319">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="73a69-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="73a69-320">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="73a69-320">Further Reading</span></span>

<span data-ttu-id="73a69-321">Więcej informacji na tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="73a69-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="73a69-322">Badanie programu ASP.NET 2.0 na członkostwo, role i profilu</span><span class="sxs-lookup"><span data-stu-id="73a69-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="73a69-323">Instrukcje: Za pomocą menedżera ról na platformie ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="73a69-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="73a69-324">Dostawców ról</span><span class="sxs-lookup"><span data-stu-id="73a69-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="73a69-325">Stopniowe własne narzędzia do administrowania witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="73a69-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="73a69-326">Dokumentacja techniczna dotycząca `<roleManager>` — Element</span><span class="sxs-lookup"><span data-stu-id="73a69-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="73a69-327">Przy użyciu członkostwa i interfejsów API Manager roli</span><span class="sxs-lookup"><span data-stu-id="73a69-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="73a69-328">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="73a69-328">About the Author</span></span>

<span data-ttu-id="73a69-329">Pracował nad Bento Scottem, autor wiele książek ASP/ASP.NET i założyciel 4GuysFromRolla.com, przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="73a69-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="73a69-330">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="73a69-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="73a69-331">Jego najnowszą książkę Stephena  *[Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="73a69-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="73a69-332">Scott można z Tobą skontaktować w [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem jego blog znajduje się na [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="73a69-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="73a69-333">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="73a69-333">Special Thanks To</span></span>

<span data-ttu-id="73a69-334">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="73a69-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="73a69-335">Wiodące osób dokonujących przeglądu, w tym samouczku obejmują Alicja Maziarz, Suchi Banerjee i Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="73a69-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="73a69-336">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="73a69-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="73a69-337">Jeśli tak, Porzuć mnie linii w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="73a69-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="73a69-338">[Poprzednie](role-based-authorization-cs.md)
> [dalej](assigning-roles-to-users-vb.md)</span><span class="sxs-lookup"><span data-stu-id="73a69-338">[Previous](role-based-authorization-cs.md)
[Next](assigning-roles-to-users-vb.md)</span></span>
