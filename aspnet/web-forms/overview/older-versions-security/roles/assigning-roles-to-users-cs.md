---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: Przypisywanie ról do użytkowników (C#) | Microsoft Docs
author: rick-anderson
description: W tym samouczku utworzysz dwie strony ASP.NET, aby ułatwić zarządzanie użytkownikami należącymi do ról. Na pierwszej stronie znajdują się urządzenia, aby zobaczyć, co...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: 3346e47cf604ed1d4003ca83203116666e37cb1b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78571772"
---
# <a name="assigning-roles-to-users-c"></a><span data-ttu-id="f89b7-104">Przypisywanie ról do użytkowników (C#)</span><span class="sxs-lookup"><span data-stu-id="f89b7-104">Assigning Roles to Users (C#)</span></span>

<span data-ttu-id="f89b7-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f89b7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f89b7-106">[Pobierz kod](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) lub [Pobierz plik PDF](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="f89b7-106">[Download Code](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="f89b7-107">W tym samouczku utworzysz dwie strony ASP.NET, aby ułatwić zarządzanie użytkownikami należącymi do ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="f89b7-108">Na pierwszej stronie znajdują się urządzenia, w których użytkownicy należą do danej roli, elementy, do których należy określony użytkownik, oraz możliwość przypisywania lub usuwania określonego użytkownika z danej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="f89b7-109">Na drugiej stronie zostanie rozszerzony formant formancie CreateUserWizard, dzięki czemu będzie on zawierał krok pozwalający określić role, do których należy nowo utworzony użytkownik.</span><span class="sxs-lookup"><span data-stu-id="f89b7-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="f89b7-110">Jest to przydatne w scenariuszach, w których administrator może tworzyć nowe konta użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f89b7-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

## <a name="introduction"></a><span data-ttu-id="f89b7-111">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="f89b7-111">Introduction</span></span>

<span data-ttu-id="f89b7-112"><a id="_msoanchor_1"> </a> [Poprzedni samouczek](creating-and-managing-roles-cs.md) sprawdził strukturę role i `SqlRoleProvider`znaleźliśmy, jak używać klasy `Roles` do tworzenia, pobierania i usuwania ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="f89b7-113">Oprócz tworzenia i usuwania ról musimy mieć możliwość przypisywania lub usuwania użytkowników z roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="f89b7-114">Niestety, usługa ASP.NET nie dostarcza żadnych kontrolek sieci Web do zarządzania użytkownikami należącymi do ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="f89b7-115">Zamiast tego należy utworzyć własne strony ASP.NET, aby zarządzać tymi skojarzeniami.</span><span class="sxs-lookup"><span data-stu-id="f89b7-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="f89b7-116">Dobra wiadomość polega na tym, że dodawanie i usuwanie użytkowników do ról jest bardzo proste.</span><span class="sxs-lookup"><span data-stu-id="f89b7-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="f89b7-117">Klasa `Roles` zawiera kilka metod dodawania jednego lub kilku użytkowników do co najmniej jednej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="f89b7-118">W tym samouczku utworzysz dwie strony ASP.NET, aby ułatwić zarządzanie użytkownikami należącymi do ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="f89b7-119">Na pierwszej stronie znajdują się urządzenia, w których użytkownicy należą do danej roli, elementy, do których należy określony użytkownik, oraz możliwość przypisywania lub usuwania określonego użytkownika z danej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="f89b7-120">Na drugiej stronie zostanie rozszerzony formant formancie CreateUserWizard, dzięki czemu będzie on zawierał krok pozwalający określić role, do których należy nowo utworzony użytkownik.</span><span class="sxs-lookup"><span data-stu-id="f89b7-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="f89b7-121">Jest to przydatne w scenariuszach, w których administrator może tworzyć nowe konta użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f89b7-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="f89b7-122">Zacznijmy!</span><span class="sxs-lookup"><span data-stu-id="f89b7-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="f89b7-123">Wyświetlanie informacji o tym, co użytkownicy należą do ról</span><span class="sxs-lookup"><span data-stu-id="f89b7-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="f89b7-124">Pierwszą kolejnością działalności w tym samouczku jest utworzenie strony sieci Web, z której użytkownicy mogą być przypisani do ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="f89b7-125">Zanim będziemy wypróbujemy o sposobie przypisywania użytkowników do ról, najpierw koncentrują się na sposobach określania, którzy użytkownicy należą do ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="f89b7-126">Istnieją dwa sposoby wyświetlania tych informacji: "według roli" lub "według użytkownika".</span><span class="sxs-lookup"><span data-stu-id="f89b7-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="f89b7-127">Możemy zezwolić odwiedzającemu na wybranie roli, a następnie wyświetlenie wszystkich użytkowników należących do roli (wyświetlanie "według roli") lub monitowanie osoby odwiedzającej o wybranie użytkownika, a następnie wyświetlenie im ról przypisanych do tego użytkownika (wyświetlanych przez użytkownika).</span><span class="sxs-lookup"><span data-stu-id="f89b7-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="f89b7-128">Widok "według roli" jest przydatny w sytuacjach, gdy osoba odwiedzająca chce znać zestaw użytkowników należących do określonej roli; Widok "według użytkownika" jest idealnym rozwiązaniem, gdy osoba odwiedzająca musi znać określone role użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="f89b7-129">Na naszej stronie znajdują się interfejsy "według ról" i "według użytkownika".</span><span class="sxs-lookup"><span data-stu-id="f89b7-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="f89b7-130">Zaczniemy od utworzenia interfejsu "przez użytkownika".</span><span class="sxs-lookup"><span data-stu-id="f89b7-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="f89b7-131">Ten interfejs będzie składać się z listy rozwijanej i listy pól wyboru.</span><span class="sxs-lookup"><span data-stu-id="f89b7-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="f89b7-132">Lista rozwijana zostanie wypełniona zestawem użytkowników w systemie. pola wyboru wyliczą role.</span><span class="sxs-lookup"><span data-stu-id="f89b7-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="f89b7-133">Wybranie użytkownika z listy rozwijanej spowoduje sprawdzenie ról, do których należy użytkownik.</span><span class="sxs-lookup"><span data-stu-id="f89b7-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="f89b7-134">Osoba odwiedzająca stronę może zaznaczać lub usuwać zaznaczenie pól wyboru, aby dodać lub usunąć wybranego użytkownika z odpowiednich ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="f89b7-135">Używanie listy rozwijanej do wyświetlania kont użytkowników nie jest idealnym wyborem dla witryn sieci Web, w których może znajdować się setki kont użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f89b7-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="f89b7-136">Lista rozwijana została zaprojektowana tak, aby umożliwić użytkownikowi wybranie jednego elementu z stosunkowo krótkiej listy opcji.</span><span class="sxs-lookup"><span data-stu-id="f89b7-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="f89b7-137">Szybko staje się nieporęczny, ponieważ liczba elementów listy rośnie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="f89b7-138">W przypadku tworzenia witryny sieci Web, która będzie miała potencjalnie dużą liczbę kont użytkowników, warto rozważyć użycie alternatywnego interfejsu użytkownika, takiego jak GridView z możliwością stronicowania lub interfejs z możliwością filtrowania, który wyświetla listę monitów odwiedzających o wybranie litery, a następnie tylko pokazuje użytkowników, których nazwa użytkownika rozpoczyna się od wybranej litery.</span><span class="sxs-lookup"><span data-stu-id="f89b7-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>

## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="f89b7-139">Krok 1. Tworzenie interfejsu użytkownika "według użytkownika"</span><span class="sxs-lookup"><span data-stu-id="f89b7-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="f89b7-140">Otwórz stronę `UsersAndRoles.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="f89b7-141">W górnej części strony Dodaj kontrolkę sieci Web etykieta o nazwie `ActionStatus` i wyczyść jej Właściwość `Text`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="f89b7-142">Ta etykieta zostanie użyta w celu przekazywania informacji zwrotnych o wykonanych akcjach, wyświetlania komunikatów, takich jak "użytkownik Tito został dodany do roli administratorów" lub "użytkownik Jisun został usunięty z roli nadzoru".</span><span class="sxs-lookup"><span data-stu-id="f89b7-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="f89b7-143">Aby te komunikaty były wychodzące, ustaw właściwość `CssClass` etykiety na "ważne".</span><span class="sxs-lookup"><span data-stu-id="f89b7-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="f89b7-144">Następnie Dodaj następującą definicję klasy CSS do arkusza stylów `Styles.css`:</span><span class="sxs-lookup"><span data-stu-id="f89b7-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="f89b7-145">Ta definicja CSS instruuje przeglądarkę, aby wyświetlała etykietę przy użyciu dużej, czerwonej czcionki.</span><span class="sxs-lookup"><span data-stu-id="f89b7-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="f89b7-146">Rysunek 1 pokazuje ten efekt za pomocą projektanta programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f89b7-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>

<span data-ttu-id="f89b7-147">[![Właściwość CssClass etykiety skutkuje dużą, czerwoną czcionką](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span></span>

<span data-ttu-id="f89b7-148">**Rysunek 1**: Właściwość `CssClass` etykiety powoduje dużą, czerwoną czcionkę ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>

<span data-ttu-id="f89b7-149">Następnie Dodaj DropDownList do strony, ustaw jej Właściwość `ID` na `UserList`i ustaw dla jej właściwości `AutoPostBack` wartość true.</span><span class="sxs-lookup"><span data-stu-id="f89b7-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="f89b7-150">Użyjemy tej DropDownList, aby wyświetlić listę wszystkich użytkowników w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="f89b7-151">Ta DropDownList zostanie powiązana z kolekcją obiektów MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="f89b7-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="f89b7-152">Ponieważ chcemy, aby DropDownList wyświetlał Właściwość UserName obiektu MembershipUser (i użyć jej jako wartości elementów listy), ustaw właściwości `DataTextField` i `DataValueField` DropDownList na "UserName".</span><span class="sxs-lookup"><span data-stu-id="f89b7-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="f89b7-153">Poniżej DropDownList Dodaj wzmacniak o nazwie `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="f89b7-154">Ten wzmacniak wyświetli listę wszystkich ról w systemie jako serię pól wyboru.</span><span class="sxs-lookup"><span data-stu-id="f89b7-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="f89b7-155">Zdefiniuj `ItemTemplate` wzmacniak przy użyciu następujących znaczników deklaratywnych:</span><span class="sxs-lookup"><span data-stu-id="f89b7-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="f89b7-156">Znacznik `ItemTemplate` zawiera pojedynczy formant sieci Web CheckBox o nazwie `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="f89b7-157">Właściwość `AutoPostBack` pola wyboru ma wartość true, a właściwość `Text` jest powiązana z `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="f89b7-158">Przyczyną jest to, że składnia DataBinding jest po prostu `Container.DataItem` jest, ponieważ struktura role zwraca listę nazw ról jako tablicę ciągów i jest to tablica ciągów, którą będziemy wiązać z Wzmacniaką.</span><span class="sxs-lookup"><span data-stu-id="f89b7-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="f89b7-159">Dokładny opis dlaczego ta składnia jest używana do wyświetlania zawartości tablicy powiązanej z kontrolką sieci Web, wykracza poza zakres tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="f89b7-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="f89b7-160">Aby uzyskać więcej informacji na ten temat, zapoznaj się z tematem [Powiązywanie tablicy skalarnej z kontrolką sieci Web danych](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f89b7-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="f89b7-161">Na tym etapie deklaratywne znaczniki interfejsu "według użytkownika" powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="f89b7-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="f89b7-162">Teraz można napisać kod, aby powiązać zestaw kont użytkowników z DropDownList i zestawem ról z Wzmacniaką.</span><span class="sxs-lookup"><span data-stu-id="f89b7-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="f89b7-163">W klasie z kodem związanym ze stroną Dodaj metodę o nazwie `BindUsersToUserList` i inne nazwane `BindRolesList`, używając następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="f89b7-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="f89b7-164">Metoda `BindUsersToUserList` pobiera wszystkie konta użytkowników w systemie za pomocą [metody`Membership.GetAllUsers`](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="f89b7-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="f89b7-165">Zwraca [obiekt`MembershipUserCollection`](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), który jest kolekcją [wystąpień`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="f89b7-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="f89b7-166">Ta kolekcja jest następnie powiązana z `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="f89b7-167">Wystąpienia `MembershipUser`, które korzeń kolekcje zawierają różne właściwości, takie jak `UserName`, `Email`, `CreationDate`i `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="f89b7-168">Aby nakazać DropDownList wyświetlić wartość właściwości `UserName`, upewnij się, że właściwości `DataTextField` `UserList` DropDownList i `DataValueField` zostały ustawione na "UserName".</span><span class="sxs-lookup"><span data-stu-id="f89b7-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="f89b7-169">Metoda `Membership.GetAllUsers` ma dwa przeciążenia: jeden, który nie akceptuje parametrów wejściowych i zwraca wszystkich użytkowników, a drugi, który przyjmuje wartości całkowite dla indeksu strony i rozmiaru strony, i zwraca tylko określony podzestaw użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f89b7-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="f89b7-170">Gdy w elemencie interfejsu użytkownika z możliwością stronicowania są wyświetlane duże ilości kont użytkowników, drugie Przeciążenie może być używane do bardziej wydajnej strony użytkowników, ponieważ zwraca tylko dokładny podzbiór kont użytkowników, a nie wszystkie z nich.</span><span class="sxs-lookup"><span data-stu-id="f89b7-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>

<span data-ttu-id="f89b7-171">Metoda `BindRolesToList` zaczyna się od wywołania [metody`GetAllRoles`](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx)klasy `Roles`, która zwraca tablicę ciągów zawierającą role w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="f89b7-172">Ta tablica ciągów jest następnie powiązana z Wzmacniaką.</span><span class="sxs-lookup"><span data-stu-id="f89b7-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="f89b7-173">Na koniec należy wywołać te dwie metody podczas pierwszego ładowania strony.</span><span class="sxs-lookup"><span data-stu-id="f89b7-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="f89b7-174">Dodaj następujący kod do programu obsługi zdarzeń `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="f89b7-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="f89b7-175">Korzystając z tego kodu, poświęć chwilę na odwiedzenie strony za pomocą przeglądarki. ekran powinien wyglądać podobnie do rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="f89b7-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="f89b7-176">Wszystkie konta użytkowników są wypełniane na liście rozwijanej, a poniżej, każda rola jest wyświetlana jako pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="f89b7-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="f89b7-177">Ze względu na to, że ustawimy właściwości `AutoPostBack` DropDownList i CheckBoxs na true, zmiana wybranego użytkownika lub zaznaczenie lub cofnięcie zaznaczenia roli powoduje odświeżenie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="f89b7-178">Nie wykonano żadnej akcji, jednak ponieważ mamy jeszcze napisać kod, aby obsłużyć te akcje.</span><span class="sxs-lookup"><span data-stu-id="f89b7-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="f89b7-179">Te zadania zostaną przedstawione w dwóch następnych sekcjach.</span><span class="sxs-lookup"><span data-stu-id="f89b7-179">We'll tackle these tasks in the next two sections.</span></span>

<span data-ttu-id="f89b7-180">[![zostanie wyświetlona strona użytkownicy i role](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span></span>

<span data-ttu-id="f89b7-181">**Rysunek 2**. na stronie są wyświetlane Użytkownicy i role ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>

### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="f89b7-182">Sprawdzanie ról, do których należy wybrany użytkownik</span><span class="sxs-lookup"><span data-stu-id="f89b7-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="f89b7-183">Gdy strona zostanie załadowana po raz pierwszy lub po wybraniu nowego użytkownika z listy rozwijanej, musimy zaktualizować pola wyboru `UsersRoleList`, aby dana rola pola wyboru została sprawdzona tylko wtedy, gdy wybrany użytkownik należy do tej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="f89b7-184">Aby to osiągnąć, należy utworzyć metodę o nazwie `CheckRolesForSelectedUser` przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="f89b7-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="f89b7-185">Powyższy kod zaczyna się od określenia, kto jest wybranym użytkownikiem.</span><span class="sxs-lookup"><span data-stu-id="f89b7-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="f89b7-186">Następnie używa [metody`GetRolesForUser(userName)`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) klasy role, aby zwrócić zestaw ról określonego użytkownika jako tablicę ciągów.</span><span class="sxs-lookup"><span data-stu-id="f89b7-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="f89b7-187">Następnie są wyliczane elementy wzmacniania, a pole wyboru `RoleCheckBox` każdego elementu jest programowo przywoływane.</span><span class="sxs-lookup"><span data-stu-id="f89b7-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="f89b7-188">Pole wyboru jest zaznaczone tylko wtedy, gdy rola, do której odnosi się, znajduje się w `selectedUsersRoles` tablicy ciągów.</span><span class="sxs-lookup"><span data-stu-id="f89b7-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="f89b7-189">Składnia `selectedUserRoles.Contains<string>(...)` nie zostanie skompilowana, jeśli używany jest program ASP.NET w wersji 2,0.</span><span class="sxs-lookup"><span data-stu-id="f89b7-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="f89b7-190">Metoda `Contains<string>` jest częścią [biblioteki LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query), która jest nowa dla ASP.NET 3,5.</span><span class="sxs-lookup"><span data-stu-id="f89b7-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="f89b7-191">Jeśli nadal używasz programu ASP.NET w wersji 2,0, zamiast tego użyj [metody`Array.IndexOf<string>`](https://msdn.microsoft.com/library/eha9t187.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f89b7-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>

<span data-ttu-id="f89b7-192">Metoda `CheckRolesForSelectedUser` musi być wywoływana w dwóch przypadkach: podczas pierwszego ładowania strony i za każdym razem, gdy wybrany indeks `UserList` DropDownList jest zmieniany.</span><span class="sxs-lookup"><span data-stu-id="f89b7-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="f89b7-193">W związku z tym należy wywołać tę metodę z programu obsługi zdarzeń `Page_Load` (po wywołaniach do `BindUsersToUserList` i `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="f89b7-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="f89b7-194">Ponadto Utwórz procedurę obsługi zdarzeń dla zdarzenia `SelectedIndexChanged` DropDownList i Wywołaj tę metodę z tego miejsca.</span><span class="sxs-lookup"><span data-stu-id="f89b7-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="f89b7-195">Korzystając z tego kodu, można testować stronę za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f89b7-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="f89b7-196">Ponieważ jednak strona `UsersAndRoles.aspx` obecnie nie ma możliwości przypisywania użytkowników do ról, żaden użytkownik nie ma ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="f89b7-197">Utworzymy interfejs do przypisywania użytkowników do ról na chwilę, więc możesz wykonać moje słowo, że ten kod działa i sprawdzić, czy jest to możliwe później, lub ręcznie dodać użytkowników do ról, wstawiając rekordy do tabeli `aspnet_UsersInRoles` w celu przetestowania tej funkcji teraz.</span><span class="sxs-lookup"><span data-stu-id="f89b7-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="f89b7-198">Przypisywanie i usuwanie użytkowników z ról</span><span class="sxs-lookup"><span data-stu-id="f89b7-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="f89b7-199">Gdy osoba odwiedzająca sprawdzi lub usunie zaznaczenie pola wyboru w naszym `UsersRoleList`, musimy dodać lub usunąć wybranego użytkownika z odpowiedniej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="f89b7-200">Właściwość `AutoPostBack` pola wyboru jest obecnie ustawiona na wartość true, co spowoduje, że w dowolnym momencie jest zaznaczone pole wyboru w tym obszarze, w którym jest sprawdzane lub niezaznaczone.</span><span class="sxs-lookup"><span data-stu-id="f89b7-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="f89b7-201">Krótko mówiąc, musimy utworzyć procedurę obsługi zdarzeń dla zdarzenia `CheckChanged` pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="f89b7-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="f89b7-202">Ponieważ pole wyboru znajduje się w kontrolce wzmacniania, musimy ręcznie dodać instalację procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f89b7-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="f89b7-203">Zacznij od dodania procedury obsługi zdarzeń do klasy związanej z kodem jako metody `protected`, np.:</span><span class="sxs-lookup"><span data-stu-id="f89b7-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="f89b7-204">Będziemy ponownie pisać kod dla tego programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f89b7-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="f89b7-205">Ale po pierwsze Przyjrzyjmy się obsłudze zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f89b7-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="f89b7-206">Z pola wyboru w `ItemTemplate`ej wzmacniak Dodaj `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="f89b7-207">Ta składnia służy do nadrutu `RoleCheckBox_CheckChanged` obsługi zdarzeń do zdarzenia `CheckedChanged` `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="f89b7-208">Ostatnim zadaniem jest ukończenie procedury obsługi zdarzeń `RoleCheckBox_CheckChanged`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="f89b7-209">Musimy zacząć od odwoływania się do kontrolki CheckBox, która wywołała zdarzenie, ponieważ to wystąpienie pola wyboru informuje nas o tym, jakie role zostało sprawdzone lub niezaznaczone za pośrednictwem jej `Text` i `Checked` właściwości.</span><span class="sxs-lookup"><span data-stu-id="f89b7-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="f89b7-210">Korzystając z tych informacji oraz nazwy użytkownika wybranego użytkownika, dodajesz lub usuniesz użytkownika z roli za pośrednictwem metody [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) lub [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx)klasy `Roles`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="f89b7-211">Powyższy kod jest uruchamiany przez program programowo odwołujący się do pola wyboru, które wywołało zdarzenie, które jest dostępne za pośrednictwem parametru wejściowego `sender`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="f89b7-212">Jeśli pole wyboru jest zaznaczone, wybrany użytkownik zostanie dodany do określonej roli, w przeciwnym razie zostaną usunięte z roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="f89b7-213">W obu przypadkach etykieta `ActionStatus` wyświetla komunikat z podsumowaniem wykonywanej akcji.</span><span class="sxs-lookup"><span data-stu-id="f89b7-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="f89b7-214">Poświęć chwilę na przetestowanie tej strony za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f89b7-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="f89b7-215">Wybierz pozycję User Tito, a następnie Dodaj Tito do ról Administratorzy i kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>

<span data-ttu-id="f89b7-216">[![Tito został dodany do ról Administratorzy i kierownicy](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span></span>

<span data-ttu-id="f89b7-217">**Rysunek 3**. Tito został dodany do ról Administratorzy i kierownicy ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>

<span data-ttu-id="f89b7-218">Następnie wybierz pozycję User Bruce (użytkownik) z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="f89b7-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="f89b7-219">Istnieje ogłaszanie zwrotne i pola wyboru dla wzmacniania są aktualizowane za pośrednictwem `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="f89b7-220">Ponieważ Bruce nie należy jeszcze do żadnej roli, dwa pola wyboru nie są zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="f89b7-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="f89b7-221">Następnie Dodaj Bruce do roli kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-221">Next, add Bruce to the Supervisors role.</span></span>

<span data-ttu-id="f89b7-222">[![Bruce został dodany do roli kierownicy](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span></span>

<span data-ttu-id="f89b7-223">**Rysunek 4**. Bruce został dodany do roli kierownicy ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>

<span data-ttu-id="f89b7-224">Aby kontynuować weryfikację funkcjonalności metody `CheckRolesForSelectedUser`, wybierz użytkownika innego niż Tito lub Bruce.</span><span class="sxs-lookup"><span data-stu-id="f89b7-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="f89b7-225">Należy zauważyć, że pola wyboru są automatycznie niezaznaczone, co oznacza, że nie należą do żadnej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="f89b7-226">Wróć do Tito.</span><span class="sxs-lookup"><span data-stu-id="f89b7-226">Return to Tito.</span></span> <span data-ttu-id="f89b7-227">Należy zaznaczyć pola wyboru Administratorzy i opiekunowie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="f89b7-228">Krok 2. Tworzenie interfejsu użytkownika "według ról"</span><span class="sxs-lookup"><span data-stu-id="f89b7-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="f89b7-229">W tym momencie został ukończony interfejs "według użytkowników" i jest gotowy do rozpoczęcia pracy z interfejsem "według ról".</span><span class="sxs-lookup"><span data-stu-id="f89b7-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="f89b7-230">Interfejs "według ról" poprosi użytkownika o wybranie roli z listy rozwijanej, a następnie wyświetlenie zestawu użytkowników należących do tej roli w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="f89b7-231">Dodaj kolejną kontrolkę DropDownList do strony `UsersAndRoles.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="f89b7-232">Umieść ten element poniżej kontrolki wzmacniania, nadaj jej nazwę `RoleList`i ustaw dla jej właściwości `AutoPostBack` wartość true.</span><span class="sxs-lookup"><span data-stu-id="f89b7-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="f89b7-233">Poniżej Dodaj widok GridView i nadaj mu nazwę `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="f89b7-234">W tym widoku GridView zostaną wystawione użytkownicy, którzy należą do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="f89b7-235">Ustaw dla właściwości `AutoGenerateColumns` GridView wartość false, Dodaj TemplateField do kolekcji `Columns` siatki i ustaw jej Właściwość `HeaderText` na "Users".</span><span class="sxs-lookup"><span data-stu-id="f89b7-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="f89b7-236">Zdefiniuj `ItemTemplate` TemplateField tak, aby wyświetlała wartość wyrażenia DataBinding `Container.DataItem` we właściwości `Text` etykiety o nazwie `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="f89b7-237">Po dodaniu i skonfigurowaniu widoku GridView znaczniki deklaratywne interfejsu "według roli" powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="f89b7-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="f89b7-238">Musimy wypełnić `RoleList` DropDownList z zestawem ról w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="f89b7-239">W tym celu należy zaktualizować metodę `BindRolesToList` tak, aby tworzyła tablicę ciągów zwracaną przez metodę `Roles.GetAllRoles` do `RolesList` DropDownList (jak również wzmacniak `UsersRoleList`).</span><span class="sxs-lookup"><span data-stu-id="f89b7-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="f89b7-240">Ostatnie dwa wiersze w `BindRolesToList` metodzie zostały dodane w celu powiązania zestawu ról z `RoleList` kontrolką DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="f89b7-241">Rysunek 5 przedstawia wynik końcowy, gdy jest wyświetlany za pomocą przeglądarki — lista rozwijana uzupełniona o role systemu.</span><span class="sxs-lookup"><span data-stu-id="f89b7-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>

<span data-ttu-id="f89b7-242">[![role są wyświetlane w RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span></span>

<span data-ttu-id="f89b7-243">**Rysunek 5**. role są wyświetlane w `RoleList` DropDownList (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>

### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="f89b7-244">Wyświetlanie użytkowników należących do wybranej roli</span><span class="sxs-lookup"><span data-stu-id="f89b7-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="f89b7-245">Po pierwszym załadowaniu strony lub wybraniu nowej roli z `RoleList` DropDownList musi zostać wyświetlona lista użytkowników należących do tej roli w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="f89b7-246">Utwórz metodę o nazwie `DisplayUsersBelongingToRole` przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="f89b7-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="f89b7-247">Ta metoda rozpoczyna się od pobrania wybranej roli z `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="f89b7-248">Następnie używa [metody`Roles.GetUsersInRole(roleName)`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) , aby pobrać tablicę ciągów nazw użytkowników należących do tej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="f89b7-249">Ta tablica jest następnie powiązana z `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="f89b7-250">Ta metoda musi być wywoływana w dwóch przypadkach: podczas początkowego ładowania strony i gdy wybrana rola w `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="f89b7-251">W związku z tym zaktualizuj procedurę obsługi zdarzeń `Page_Load`, tak aby ta metoda była wywoływana po wywołaniu `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="f89b7-252">Następnie Utwórz procedurę obsługi zdarzeń dla zdarzenia `SelectedIndexChanged` `RoleList`, a następnie Wywołaj tę metodę.</span><span class="sxs-lookup"><span data-stu-id="f89b7-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="f89b7-253">W przypadku tego kodu w `RolesUserList` GridView powinien wyświetlać tych użytkowników, którzy należą do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="f89b7-254">Jak pokazano na rysunku 6, rola kierownicy składa się z dwóch członków: Bruce i Tito.</span><span class="sxs-lookup"><span data-stu-id="f89b7-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>

<span data-ttu-id="f89b7-255">[![GridView wyświetla listę użytkowników należących do wybranej roli](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span></span>

<span data-ttu-id="f89b7-256">**Ilustracja 6**. widok GridView wyświetla listę użytkowników należących do wybranej roli ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>

### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="f89b7-257">Usuwanie użytkowników z wybranej roli</span><span class="sxs-lookup"><span data-stu-id="f89b7-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="f89b7-258">Uzupełnimy widok `RolesUserList` GridView, aby zawierał kolumnę przycisków "Usuń".</span><span class="sxs-lookup"><span data-stu-id="f89b7-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="f89b7-259">Kliknięcie przycisku "Usuń" dla określonego użytkownika spowoduje usunięcie ich z tej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="f89b7-260">Zacznij od dodania pola Usuń pole do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="f89b7-261">Oznacz to pole jako po lewej stronie i zmień jego właściwość `DeleteText` z "Delete" (domyślnie) na "Remove".</span><span class="sxs-lookup"><span data-stu-id="f89b7-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>

<span data-ttu-id="f89b7-262">[![dodać](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-262">[![Add the](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span></span>

<span data-ttu-id="f89b7-263">**Rysunek 7**. Dodawanie przycisku "Usuń" do widoku GridView ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>

<span data-ttu-id="f89b7-264">Po kliknięciu przycisku "Usuń" zostanie kliknięte ogłaszanie zwrotne i zostanie zgłoszone zdarzenie `RowDeleting` GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="f89b7-265">Musimy utworzyć procedurę obsługi zdarzeń dla tego zdarzenia i napisać kod, który usuwa użytkownika z wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="f89b7-266">Utwórz procedurę obsługi zdarzeń, a następnie Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="f89b7-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="f89b7-267">Kod jest uruchamiany przez określenie wybranej nazwy roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="f89b7-268">Następnie programowo odwołuje się do formantu `UserNameLabel` z wiersza, którego kliknięto przycisk "Usuń", aby określić nazwę użytkownika, który ma zostać usunięty.</span><span class="sxs-lookup"><span data-stu-id="f89b7-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="f89b7-269">Użytkownik zostanie następnie usunięty z roli za pośrednictwem wywołania metody `Roles.RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="f89b7-270">`RolesUserList` GridView jest następnie odświeżane i wyświetlany jest komunikat za pośrednictwem kontrolki etykieta `ActionStatus`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="f89b7-271">Przycisk "Usuń" nie wymaga żadnych potwierdzeń przed usunięciem użytkownika z roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="f89b7-272">Zapraszam Cię do dodania dowolnego poziomu potwierdzenia użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="f89b7-273">Jednym z najprostszych sposobów potwierdzania akcji jest użycie okna dialogowego potwierdzenia po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="f89b7-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="f89b7-274">Aby uzyskać więcej informacji na temat tej techniki, zobacz [Dodawanie potwierdzenia po stronie klienta podczas usuwania](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="f89b7-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>

<span data-ttu-id="f89b7-275">Na rysunku nr 8 przedstawiono stronę po usunięciu użytkownika Tito z grupy kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>

<span data-ttu-id="f89b7-276">[![Niemniej, Tito nie jest już opiekunem](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span></span>

<span data-ttu-id="f89b7-277">**Rysunek 8**: Niemniej, Tito nie jest już nadzorcą ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>

### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="f89b7-278">Dodawanie nowych użytkowników do wybranej roli</span><span class="sxs-lookup"><span data-stu-id="f89b7-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="f89b7-279">Wraz z usunięciem użytkowników z wybranej roli osoba odwiedzająca Tę stronę powinna również dodać użytkownika do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="f89b7-280">Najlepszy interfejs do dodawania użytkownika do wybranej roli zależy od liczby kont użytkowników, które mają być używane.</span><span class="sxs-lookup"><span data-stu-id="f89b7-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="f89b7-281">Jeśli witryna sieci Web będzie zawierała tylko kilka dziesiątych kont użytkowników, możesz użyć DropDownList tutaj.</span><span class="sxs-lookup"><span data-stu-id="f89b7-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="f89b7-282">Jeśli istnieją tysiące kont użytkowników, należy dołączyć interfejs użytkownika, który umożliwia odwiedzanie strony za pomocą kont, wyszukiwanie określonego konta lub filtrowanie kont użytkowników w inny sposób.</span><span class="sxs-lookup"><span data-stu-id="f89b7-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="f89b7-283">Na tej stronie Przyjrzyjmy się bardzo prostemu interfejsowi, który działa niezależnie od liczby kont użytkowników w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="f89b7-284">W takim przypadku użyjemy pola tekstowego z monitem osoby odwiedzającej o wpisanie nazwy użytkownika, który chce dodać do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="f89b7-285">Jeśli użytkownik o tej nazwie nie istnieje lub użytkownik jest już członkiem roli, zostanie wyświetlony komunikat w `ActionStatus` etykiecie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="f89b7-286">Jeśli jednak użytkownik istnieje i nie jest członkiem roli, dodamy je do roli i odświeży siatkę.</span><span class="sxs-lookup"><span data-stu-id="f89b7-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="f89b7-287">Dodaj pole tekstowe i przycisk poniżej widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="f89b7-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="f89b7-288">Ustaw `ID` pola tekstowego na `UserNameToAddToRole` i ustaw właściwości `ID` i `Text` przycisku, aby `AddUserToRoleButton` i "dodać użytkownika do roli".</span><span class="sxs-lookup"><span data-stu-id="f89b7-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="f89b7-289">Następnie Utwórz procedurę obsługi zdarzeń `Click` dla `AddUserToRoleButton` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="f89b7-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="f89b7-290">Większość kodu w programie obsługi zdarzeń `Click` wykonuje różne sprawdzenia poprawności.</span><span class="sxs-lookup"><span data-stu-id="f89b7-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="f89b7-291">Zapewnia to, że osoba odwiedzająca podała nazwę użytkownika w polu tekstowym `UserNameToAddToRole`, że użytkownik istnieje w systemie i nie należy do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="f89b7-292">Jeśli którykolwiek z tych sprawdzeń nie powiedzie się, zostanie wyświetlony odpowiedni komunikat w `ActionStatus`, a program obsługi zdarzeń zostanie zakończony.</span><span class="sxs-lookup"><span data-stu-id="f89b7-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="f89b7-293">Jeśli wszystkie testy zostaną zakończone, użytkownik zostanie dodany do roli za pośrednictwem metody `Roles.AddUserToRole`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="f89b7-294">Po wykonaniu tej czynności Właściwość `Text` TextBox jest wyczyszczona. widok GridView zostanie odświeżony, a w etykiecie `ActionStatus` zostanie wyświetlony komunikat informujący o pomyślnym dodaniu określonego użytkownika do wybranej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="f89b7-295">Aby upewnić się, że określony użytkownik nie należy jeszcze do wybranej roli, używamy [metody`Roles.IsUserInRole(userName, roleName)`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), która zwraca wartość logiczną wskazującą, czy *Nazwa użytkownika* jest członkiem *roli role*.</span><span class="sxs-lookup"><span data-stu-id="f89b7-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="f89b7-296">Ta metoda zostanie ponownie użyta w <a id="_msoanchor_2"> </a> [następnym samouczku](role-based-authorization-cs.md) , gdy będzie wyglądała Autoryzacja oparta na rolach.</span><span class="sxs-lookup"><span data-stu-id="f89b7-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>

<span data-ttu-id="f89b7-297">Odwiedź stronę za pośrednictwem przeglądarki i wybierz rolę kierownicy z `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="f89b7-298">Spróbuj wprowadzić nieprawidłową nazwę użytkownika — powinien zostać wyświetlony komunikat z informacją, że użytkownik nie istnieje w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>

<span data-ttu-id="f89b7-299">[![nie można dodać nieistniejącego użytkownika do roli](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span></span>

<span data-ttu-id="f89b7-300">**Rysunek 9**: nie można dodać nieistniejącego użytkownika do roli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>

<span data-ttu-id="f89b7-301">Teraz spróbuj dodać prawidłowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-301">Now try adding a valid user.</span></span> <span data-ttu-id="f89b7-302">Przejdź dalej i Dodaj Tito do roli kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-302">Go ahead and re-add Tito to the Supervisors role.</span></span>

<span data-ttu-id="f89b7-303">[![Tito jest ponownie nadzorcą!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span></span>

<span data-ttu-id="f89b7-304">**Rysunek 10**: Tito jest ponownie nadzorcą!</span><span class="sxs-lookup"><span data-stu-id="f89b7-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="f89b7-305">([Kliknij, aby wyświetlić obraz o pełnym rozmiarze](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>

## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="f89b7-306">Krok 3. Aktualizacja wielu interfejsów "według użytkownika" i "według roli"</span><span class="sxs-lookup"><span data-stu-id="f89b7-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="f89b7-307">Na stronie `UsersAndRoles.aspx` są dostępne dwa oddzielne interfejsy służące do zarządzania użytkownikami i rolami.</span><span class="sxs-lookup"><span data-stu-id="f89b7-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="f89b7-308">Obecnie te dwa interfejsy działają niezależnie od siebie, więc możliwe jest, że zmiana wprowadzona w jednym interfejsie nie zostanie odzwierciedlona natychmiast w drugim.</span><span class="sxs-lookup"><span data-stu-id="f89b7-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="f89b7-309">Załóżmy na przykład, że osoba odwiedzająca stronę wybierze rolę kierownicy z `RoleList` DropDownList, która zawiera listę Bruce i Tito jako członków.</span><span class="sxs-lookup"><span data-stu-id="f89b7-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="f89b7-310">Następnie odwiedzający wybiera Tito z `UserList` DropDownList, który sprawdza, czy są to pola wyboru Administratorzy i opiekunowie w Wzmacniake `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="f89b7-311">Jeśli odwiedzający następnie usunie rolę kierownika z wzmacniak, Tito jest usuwana z roli kierownicy, ale ta modyfikacja nie zostanie odzwierciedlona w interfejsie "według roli".</span><span class="sxs-lookup"><span data-stu-id="f89b7-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="f89b7-312">Widok GridView nadal będzie Tito jako członek roli kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="f89b7-313">Aby rozwiązać ten problem, należy odświeżyć widok GridView za każdym razem, gdy rola jest zaznaczona lub nie została sprawdzona przez wzmacniak `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="f89b7-314">Podobnie musimy odświeżyć wzmacniak za każdym razem, gdy użytkownik zostanie usunięty lub dodany do roli z interfejsu "według roli".</span><span class="sxs-lookup"><span data-stu-id="f89b7-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="f89b7-315">Wzmacniak w interfejsie użytkownika jest odświeżany przez wywołanie metody `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="f89b7-316">Interfejs "według roli" można zmodyfikować w programie obsługi zdarzeń `RowDeleting` `RolesUserList` GridView i `Click` obsłudze zdarzenia `AddUserToRoleButton` przycisku.</span><span class="sxs-lookup"><span data-stu-id="f89b7-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="f89b7-317">W związku z tym musimy wywołać metodę `CheckRolesForSelectedUser` z każdej z tych metod.</span><span class="sxs-lookup"><span data-stu-id="f89b7-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="f89b7-318">Podobnie widok GridView w interfejsie "według roli" jest odświeżany przez wywołanie metody `DisplayUsersBelongingToRole` i interfejsu "przez użytkownika" jest modyfikowany za pomocą programu obsługi zdarzeń `RoleCheckBox_CheckChanged`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="f89b7-319">W związku z tym musimy wywołać metodę `DisplayUsersBelongingToRole` z tej procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="f89b7-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="f89b7-320">Po wprowadzeniu tych drobnych zmian kodu interfejsy "według użytkownika" i "według roli" są teraz prawidłowo aktualizowane krzyżowo.</span><span class="sxs-lookup"><span data-stu-id="f89b7-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="f89b7-321">Aby to sprawdzić, odwiedź stronę za pośrednictwem przeglądarki i wybierz odpowiednio Tito i nadzorców z `UserList` i `RoleList` kontrolek DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="f89b7-322">Należy pamiętać, że po usunięciu roli kierownicy dla Tito z Wzmacniakka w interfejsie użytkownika, Tito jest automatycznie usuwana z widoku GridView w interfejsie "według roli".</span><span class="sxs-lookup"><span data-stu-id="f89b7-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="f89b7-323">Dodawanie Tito z powrotem do roli kierownicy z poziomu interfejsu "według roli" powoduje automatyczne ponowne sprawdzenie pola wyboru opiekunów w interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="f89b7-324">Krok 4. dostosowanie formancie CreateUserWizard w celu uwzględnienia kroku "Określ role"</span><span class="sxs-lookup"><span data-stu-id="f89b7-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="f89b7-325"><a id="_msoanchor_3"> </a>W samouczku [*Tworzenie kont użytkowników*](../membership/creating-user-accounts-cs.md) pokazano, jak używać kontrolki sieci Web formancie CreateUserWizard w celu zapewnienia interfejsu do tworzenia nowego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="f89b7-326">Formant formancie CreateUserWizard może być używany na jeden z dwóch sposobów:</span><span class="sxs-lookup"><span data-stu-id="f89b7-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="f89b7-327">Oznacza to, że osoby odwiedzające mogą utworzyć własne konto użytkownika w lokacji i</span><span class="sxs-lookup"><span data-stu-id="f89b7-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="f89b7-328">Jako środek do tworzenia nowych kont przez administratorów</span><span class="sxs-lookup"><span data-stu-id="f89b7-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="f89b7-329">W pierwszym przypadku użycia osoba odwiedzająca przechodzi do witryny i wypełnia formancie CreateUserWizard, wprowadzając informacje w celu zarejestrowania się w witrynie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="f89b7-330">W drugim przypadku administrator tworzy nowe konto dla innej osoby.</span><span class="sxs-lookup"><span data-stu-id="f89b7-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="f89b7-331">W przypadku tworzenia konta przez administratora dla innej osoby warto umożliwić administratorowi określenie ról, do których należy konto użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="f89b7-332"><a id="_msoanchor_4"> </a>W samouczku [ *przechowującym* *dodatkowe informacje o użytkowniku* ](../membership/storing-additional-user-information-cs.md) przedstawiono sposób dostosowywania formancie CreateUserWizard przez dodanie dodatkowych `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="f89b7-333">Przyjrzyjmy się sposobom dodawania dodatkowego kroku do formancie CreateUserWizard w celu określenia ról nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="f89b7-334">Otwórz stronę `CreateUserWizardWithRoles.aspx` i Dodaj kontrolkę formancie CreateUserWizard o nazwie `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="f89b7-335">Ustaw właściwość `ContinueDestinationPageUrl` kontrolki na wartość "~/default.aspx".</span><span class="sxs-lookup"><span data-stu-id="f89b7-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="f89b7-336">Ze względu na to, że administrator będzie używać tego formantu formancie CreateUserWizard do tworzenia nowych kont użytkowników, ustaw właściwość `LoginCreatedUser` kontrolki na wartość false.</span><span class="sxs-lookup"><span data-stu-id="f89b7-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="f89b7-337">Ta właściwość `LoginCreatedUser` określa, czy użytkownik jest automatycznie zalogowany jako właśnie utworzony użytkownik, i domyślnie ma wartość true.</span><span class="sxs-lookup"><span data-stu-id="f89b7-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="f89b7-338">Ustawimy ją na wartość false, ponieważ w przypadku utworzenia nowego konta przez administratora chcemy, aby był on zalogowany jako sam.</span><span class="sxs-lookup"><span data-stu-id="f89b7-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="f89b7-339">Następnie wybierz pozycję "Dodaj/Usuń `WizardSteps`..." z tagu inteligentnego formancie CreateUserWizard i Dodaj nowy `WizardStep`, ustawiając jego `ID` na `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="f89b7-340">Przenieś `SpecifyRolesStep WizardStep` tak, aby był dostępny po kroku "Utwórz nowe konto", ale przed krokiem "Ukończ".</span><span class="sxs-lookup"><span data-stu-id="f89b7-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="f89b7-341">Ustaw właściwość `Title` `WizardStep`na wartość "Określ role", jej Właściwość `StepType` na `Step`, a jej Właściwość `AllowReturn` na false.</span><span class="sxs-lookup"><span data-stu-id="f89b7-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>

<span data-ttu-id="f89b7-342">[![dodać](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-342">[![Add the](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span></span>

<span data-ttu-id="f89b7-343">**Ilustracja 11**. Dodawanie `WizardStep` "Określ role" do formancie CreateUserWizard ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>

<span data-ttu-id="f89b7-344">Po wprowadzeniu tej zmiany deklaratywne znaczniki formancie CreateUserWizard powinny wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="f89b7-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="f89b7-345">W `WizardStep`"Określ role" Dodaj formant CheckBoxList o nazwie `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="f89b7-346">Ta formant CheckBoxList wyświetli listę dostępnych ról, umożliwiając osobie odwiedzającej stronę przeszukanie ról, do których należy nowo utworzony użytkownik.</span><span class="sxs-lookup"><span data-stu-id="f89b7-346">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="f89b7-347">Pozostawiłem dwa zadania kodowania: najpierw należy wypełnić `RoleList` formant CheckBoxList z rolami w systemie. Po drugie należy dodać utworzonego użytkownika do wybranych ról, gdy użytkownik przejdzie z kroku "Określ role" do kroku "Complete".</span><span class="sxs-lookup"><span data-stu-id="f89b7-347">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="f89b7-348">W programie obsługi zdarzeń `Page_Load` można wykonać pierwsze zadanie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-348">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="f89b7-349">Poniższy kod programowo odwołuje się do pola wyboru `RoleList` podczas pierwszej wizyty na stronie i wiąże z nim role w systemie.</span><span class="sxs-lookup"><span data-stu-id="f89b7-349">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="f89b7-350">Powyższy kod powinien wyglądać znajomo.</span><span class="sxs-lookup"><span data-stu-id="f89b7-350">The above code should look familiar.</span></span> <span data-ttu-id="f89b7-351"><a id="_msoanchor_5"> </a>W samouczku [ *przechowywanie* *dodatkowych informacji o użytkowniku* ](../membership/storing-additional-user-information-cs.md) użyto dwóch instrukcji `FindControl`, aby odwołać się do formantu sieci Web z poziomu `WizardStep`niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="f89b7-351">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="f89b7-352">Kod, który wiąże role z Formant CheckBoxList, został wykonany z wcześniej w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="f89b7-352">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="f89b7-353">Aby wykonać drugie zadanie programistyczne, musimy wiedzieć, że krok "Określ role" został ukończony.</span><span class="sxs-lookup"><span data-stu-id="f89b7-353">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="f89b7-354">Odwołaj, że formancie CreateUserWizard ma zdarzenie `ActiveStepChanged`, które jest wyzwalane za każdym razem, gdy osoba odwiedzająca przechodzi z jednego kroku do drugiego.</span><span class="sxs-lookup"><span data-stu-id="f89b7-354">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="f89b7-355">W tym miejscu możemy określić, czy użytkownik osiągnął krok "ukończony"; Jeśli tak, musimy dodać użytkownika do wybranych ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-355">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="f89b7-356">Utwórz procedurę obsługi zdarzeń dla zdarzenia `ActiveStepChanged` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="f89b7-356">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="f89b7-357">Jeśli użytkownik już osiągnął krok "ukończony", program obsługi zdarzeń wylicza elementy `RoleList` formant CheckBoxList, a właśnie utworzony użytkownik zostanie przypisany do wybranych ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-357">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="f89b7-358">Odwiedź Tę stronę za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f89b7-358">Visit this page through a browser.</span></span> <span data-ttu-id="f89b7-359">Pierwszym krokiem w formancie CreateUserWizard jest standardowy krok "Utwórz nowe konto", który będzie monitowany o nazwę użytkownika, hasło, adres e-mail i inne informacje o kluczu.</span><span class="sxs-lookup"><span data-stu-id="f89b7-359">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="f89b7-360">Wprowadź informacje, aby utworzyć nowego użytkownika o nazwie Wanda.</span><span class="sxs-lookup"><span data-stu-id="f89b7-360">Enter the information to create a new user named Wanda.</span></span>

<span data-ttu-id="f89b7-361">[![utworzyć nowego użytkownika o nazwie Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-361">[![Create a New User Named Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span></span>

<span data-ttu-id="f89b7-362">**Ilustracja 12**. Tworzenie nowego użytkownika o nazwie Wanda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-362">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>

<span data-ttu-id="f89b7-363">Kliknij przycisk "Utwórz użytkownika".</span><span class="sxs-lookup"><span data-stu-id="f89b7-363">Click the "Create User" button.</span></span> <span data-ttu-id="f89b7-364">Formancie CreateUserWizard wewnętrznie wywołuje metodę `Membership.CreateUser`, tworząc nowe konto użytkownika, a następnie przechodzi do następnego kroku "Określ role".</span><span class="sxs-lookup"><span data-stu-id="f89b7-364">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="f89b7-365">W tym miejscu są wyświetlane role systemowe.</span><span class="sxs-lookup"><span data-stu-id="f89b7-365">Here the system roles are listed.</span></span> <span data-ttu-id="f89b7-366">Zaznacz pole wyboru nadzorcy i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="f89b7-366">Check the Supervisors checkbox and click Next.</span></span>

<span data-ttu-id="f89b7-367">[![uczyń Wanda członkiem roli kierownicy](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-367">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span></span>

<span data-ttu-id="f89b7-368">**Ilustracja 13**. Udostępnianie Wanda członkom roli kierownicy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-368">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>

<span data-ttu-id="f89b7-369">Kliknięcie przycisku Dalej powoduje ogłoszenie zwrotne i aktualizację `ActiveStep` do kroku "Complete".</span><span class="sxs-lookup"><span data-stu-id="f89b7-369">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="f89b7-370">W obsłudze zdarzeń `ActiveStepChanged` ostatnio utworzone konto użytkownika jest przypisane do roli kierownicy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-370">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="f89b7-371">Aby to sprawdzić, Wróć do strony `UsersAndRoles.aspx` i wybierz pozycję kierownicy z `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="f89b7-371">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="f89b7-372">Jak pokazano na rysunku 14, kierownicy składają się z trzech użytkowników: Bruce, Tito i Wanda.</span><span class="sxs-lookup"><span data-stu-id="f89b7-372">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>

<span data-ttu-id="f89b7-373">[![Bruce, Tito i Wanda to wszyscy kierownicy](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="f89b7-373">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span></span>

<span data-ttu-id="f89b7-374">**Ilustracja 14**. Bruce, Tito i Wanda to wszyscy kierownicy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="f89b7-374">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f89b7-375">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="f89b7-375">Summary</span></span>

<span data-ttu-id="f89b7-376">Struktura ról oferuje metody pobierania informacji o rolach i metodach określonych użytkowników w celu określenia, którzy użytkownicy należą do określonej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-376">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="f89b7-377">Ponadto istnieje kilka metod dodawania i usuwania co najmniej jednego użytkownika do co najmniej jednej roli.</span><span class="sxs-lookup"><span data-stu-id="f89b7-377">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="f89b7-378">W tym samouczku koncentrujemy się na dwóch następujących metodach: `AddUserToRole` i `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="f89b7-378">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="f89b7-379">Istnieją dodatkowe warianty umożliwiające dodanie wielu użytkowników do jednej roli i przypisanie wielu ról do jednego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-379">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="f89b7-380">W tym samouczku zawarto również przyjrzeć się rozszerzaniu formantu formancie CreateUserWizard w celu uwzględnienia `WizardStep`, aby określić nowo utworzone role użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-380">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="f89b7-381">Taki krok może pomóc administratorowi uprościć proces tworzenia kont użytkowników dla nowych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f89b7-381">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="f89b7-382">W tym momencie dowiesz się, jak tworzyć i usuwać role oraz jak dodawać i usuwać użytkowników z ról.</span><span class="sxs-lookup"><span data-stu-id="f89b7-382">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="f89b7-383">Jednak zapoznaj się z zastosowaniem autoryzacji opartej na rolach.</span><span class="sxs-lookup"><span data-stu-id="f89b7-383">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="f89b7-384"><a id="_msoanchor_6"> </a>W [poniższym samouczku](role-based-authorization-cs.md) opisano definiowanie reguł autoryzacji adresów URL na podstawie ról, a także Ograniczanie funkcjonalności na poziomie strony na podstawie aktualnie zalogowanych ról użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f89b7-384">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="f89b7-385">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="f89b7-385">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f89b7-386">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="f89b7-386">Further Reading</span></span>

<span data-ttu-id="f89b7-387">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="f89b7-387">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f89b7-388">Omówienie narzędzia administracyjnego witryny sieci Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f89b7-388">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="f89b7-389">Badanie ASP. Członkostwo, role i profil w sieci</span><span class="sxs-lookup"><span data-stu-id="f89b7-389">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="f89b7-390">Stopniowa narzędzie do administrowania witryną sieci Web</span><span class="sxs-lookup"><span data-stu-id="f89b7-390">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f89b7-391">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="f89b7-391">About the Author</span></span>

<span data-ttu-id="f89b7-392">Scott Mitchell, autor wielu książek ASP/ASP. NET Books i założyciel of 4GuysFromRolla.com, pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="f89b7-392">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f89b7-393">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="f89b7-393">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f89b7-394">Jego Najnowsza książka to *[Sams ASP.NET 2,0 w ciągu 24 godzin](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="f89b7-394">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="f89b7-395">Scott można uzyskać w [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) lub za pośrednictwem swojego blogu w [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="f89b7-395">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f89b7-396">Specjalne podziękowania dla...</span><span class="sxs-lookup"><span data-stu-id="f89b7-396">Special Thanks To…</span></span>

<span data-ttu-id="f89b7-397">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="f89b7-397">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f89b7-398">Recenzent potencjalnych klientów dla tego samouczka został Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="f89b7-398">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="f89b7-399">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="f89b7-399">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f89b7-400">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f89b7-400">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f89b7-401">[Poprzednie](creating-and-managing-roles-cs.md)
> [dalej](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="f89b7-401">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
