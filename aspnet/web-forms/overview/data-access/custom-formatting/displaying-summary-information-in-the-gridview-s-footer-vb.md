---
uid: web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
title: Wyświetlanie informacji podsumowania w stopce kontrolki GridView (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Informacje podsumowujące często jest wyświetlany w dolnej części raportu, w wierszu podsumowania. W kontrolce GridView może zawierać wiersz stopki, do którego komórek możemy żądania ściągnięcia...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 41c818b7-603a-402b-8847-890a63547b6f
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: e6352ee468a8862288a4ee72613ad535b8372352
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134009"
---
# <a name="displaying-summary-information-in-the-gridviews-footer-vb"></a><span data-ttu-id="8f77e-104">Wyświetlanie informacji podsumowania w stopce kontrolki GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="8f77e-104">Displaying Summary Information in the GridView's Footer (VB)</span></span>

<span data-ttu-id="8f77e-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8f77e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8f77e-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) lub [Pobierz plik PDF](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8f77e-106">[Download Sample App](http://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) or [Download PDF](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span></span>

> <span data-ttu-id="8f77e-107">Informacje podsumowujące często jest wyświetlany w dolnej części raportu, w wierszu podsumowania.</span><span class="sxs-lookup"><span data-stu-id="8f77e-107">Summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="8f77e-108">W kontrolce GridView mogą zawierać wiersz stopki, do którego komórek możemy programowe Wstawianie danych agregacji.</span><span class="sxs-lookup"><span data-stu-id="8f77e-108">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span> <span data-ttu-id="8f77e-109">W tym samouczku opisano sposób wyświetlania zagregowanych danych w tym wierszu stopki.</span><span class="sxs-lookup"><span data-stu-id="8f77e-109">In this tutorial we'll see how to display aggregate data in this footer row.</span></span>

## <a name="introduction"></a><span data-ttu-id="8f77e-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="8f77e-110">Introduction</span></span>

<span data-ttu-id="8f77e-111">Oprócz możliwości wyświetlania każdej cen produktów, jednostek w magazynie, jednostek w kolejności i której kolejność chcesz zmienić poziomy, użytkownik może również zainteresować się agregacji informacje, takie jak średnia cena łączna liczba jednostek w magazynie i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="8f77e-111">In addition to seeing each of the products' prices, units in stock, units on order, and reorder levels, a user might also be interested in aggregate information, such as the average price, the total number of units in stock, and so on.</span></span> <span data-ttu-id="8f77e-112">Takie informacje podsumowujące często jest wyświetlany w dolnej części raportu, w wierszu podsumowania.</span><span class="sxs-lookup"><span data-stu-id="8f77e-112">Such summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="8f77e-113">W kontrolce GridView mogą zawierać wiersz stopki, do którego komórek możemy programowe Wstawianie danych agregacji.</span><span class="sxs-lookup"><span data-stu-id="8f77e-113">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span>

<span data-ttu-id="8f77e-114">To zadanie przedstawia nam trzy wyzwania:</span><span class="sxs-lookup"><span data-stu-id="8f77e-114">This task presents us with three challenges:</span></span>

1. <span data-ttu-id="8f77e-115">Konfigurowanie kontrolki GridView, aby wyświetlić jego wiersz stopki</span><span class="sxs-lookup"><span data-stu-id="8f77e-115">Configuring the GridView to display its footer row</span></span>
2. <span data-ttu-id="8f77e-116">Określanie podsumowania danych; oznacza to jak możemy obliczeniowych średnia cena lub łączna liczba jednostek w magazynie?</span><span class="sxs-lookup"><span data-stu-id="8f77e-116">Determining the summary data; that is, how do we compute the average price or the total of the units in stock?</span></span>
3. <span data-ttu-id="8f77e-117">Wstawianie danych podsumowania do komórek wiersza stopki</span><span class="sxs-lookup"><span data-stu-id="8f77e-117">Injecting the summary data into the appropriate cells of the footer row</span></span>

<span data-ttu-id="8f77e-118">W tym samouczku opisano sposób przezwyciężyć te wyzwania.</span><span class="sxs-lookup"><span data-stu-id="8f77e-118">In this tutorial we'll see how to overcome these challenges.</span></span> <span data-ttu-id="8f77e-119">W szczególności utworzymy strona, która wyświetla listę kategorii z listy rozwijanej z wybranej kategorii produktów, wyświetlany w kontrolce GridView.</span><span class="sxs-lookup"><span data-stu-id="8f77e-119">Specifically, we'll create a page that lists the categories in a drop-down list with the selected category's products displayed in a GridView.</span></span> <span data-ttu-id="8f77e-120">Kontrolki GridView będzie zawierać wiersz stopki, który przedstawia średnią cenę i całkowita liczba jednostek w magazynie i na produkty z tej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-120">The GridView will include a footer row that shows the average price and total number of units in stock and on order for products in that category.</span></span>

<span data-ttu-id="8f77e-121">[![Informacje podsumowania jest wyświetlany w wierszu stopce kontrolki GridView](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-121">[![Summary Information is Displayed in the GridView's Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="8f77e-122">**Rysunek 1**: Informacje podsumowania jest wyświetlany w wierszu stopce kontrolki GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-122">**Figure 1**: Summary Information is Displayed in the GridView's Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span></span>

<span data-ttu-id="8f77e-123">Ten samouczek, za pomocą kategorii produktów wzorzec/szczegół interfejsu, opiera się na koncepcji omówione wcześniej [wzorzec/szczegół filtrowanie przy użyciu kontrolki DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="8f77e-123">This tutorial, with its category to products master/detail interface, builds upon the concepts covered in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial.</span></span> <span data-ttu-id="8f77e-124">Jeśli jeszcze nie znasz już samouczkiem wcześniej, zrób to przed kontynuowaniem korzystania z niej.</span><span class="sxs-lookup"><span data-stu-id="8f77e-124">If you've not yet worked through the earlier tutorial, please do so before continuing on with this one.</span></span>

## <a name="step-1-adding-the-categories-dropdownlist-and-products-gridview"></a><span data-ttu-id="8f77e-125">Krok 1. Dodawanie kontrolki DropDownList kategorie i produktów GridView</span><span class="sxs-lookup"><span data-stu-id="8f77e-125">Step 1: Adding the Categories DropDownList and Products GridView</span></span>

<span data-ttu-id="8f77e-126">Przed dotyczących osoby z podsumowania informacje dodane w stopce kontrolki GridView, najpierw po prostu utworzymy raport wzorzec/szczegół.</span><span class="sxs-lookup"><span data-stu-id="8f77e-126">Before concerning ourselves with adding summary information to the GridView's footer, let's first simply build the master/detail report.</span></span> <span data-ttu-id="8f77e-127">Po pierwszym kroku została ukończona, omówimy jak dołączyć dane podsumowujące.</span><span class="sxs-lookup"><span data-stu-id="8f77e-127">Once we've completed this first step, we'll look at how to include summary data.</span></span>

<span data-ttu-id="8f77e-128">Zacznij od otwarcia `SummaryDataInFooter.aspx` stronie `CustomFormatting` folderu.</span><span class="sxs-lookup"><span data-stu-id="8f77e-128">Start by opening the `SummaryDataInFooter.aspx` page in the `CustomFormatting` folder.</span></span> <span data-ttu-id="8f77e-129">Dodaj formant DropDownList i ustaw jego `ID` do `Categories`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-129">Add a DropDownList control and set its `ID` to `Categories`.</span></span> <span data-ttu-id="8f77e-130">Następnie kliknij łącze Wybierz źródło danych z kontrolki DropDownList tagów inteligentnych i zoptymalizowany pod kątem, aby dodać nowe kontrolki ObjectDataSource, o nazwie `CategoriesDataSource` wywołującej `CategoriesBLL` klasy `GetCategories()` metody.</span><span class="sxs-lookup"><span data-stu-id="8f77e-130">Next, click on the Choose Data Source link from the DropDownList's smart tag and opt to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="8f77e-131">[![Dodawanie nowego elementu ObjectDataSource, o nazwie CategoriesDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-131">[![Add a New ObjectDataSource Named CategoriesDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span></span>

<span data-ttu-id="8f77e-132">**Rysunek 2**: Dodaj nazwę nowej kontrolki ObjectDataSource `CategoriesDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-132">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="8f77e-133">[![Masz ObjectDataSource, wywołaj metodę GetCategories() klasy CategoriesBLL](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-133">[![Have the ObjectDataSource Invoke the CategoriesBLL Class's GetCategories() Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="8f77e-134">**Rysunek 3**: Masz wywołania elementu ObjectDataSource `CategoriesBLL` klasy `GetCategories()` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-134">**Figure 3**: Have the ObjectDataSource Invoke the `CategoriesBLL` Class's `GetCategories()` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span></span>

<span data-ttu-id="8f77e-135">Po skonfigurowaniu kontrolki ObjectDataSource, Kreator wyświetli nam konfiguracji źródła danych DropDownList kreatora, w którym trzeba określić wartości pola danych, które powinny być wyświetlane, i który z nich powinien odpowiadać wartości metody DropDownList firmy `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="8f77e-135">After configuring the ObjectDataSource, the wizard returns us to the DropDownList's Data Source Configuration wizard from which we need to specify what data field value should be displayed and which one should correspond to the value of the DropDownList's `ListItem` s.</span></span> <span data-ttu-id="8f77e-136">Masz `CategoryName` wyświetlanemu polu i użyj `CategoryID` jako wartość.</span><span class="sxs-lookup"><span data-stu-id="8f77e-136">Have the `CategoryName` field displayed and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="8f77e-137">[![Użyj CategoryName i pola CategoryID jako tekst i wartość ListItems, odpowiednio](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-137">[![Use the CategoryName and CategoryID Fields as the Text and Value for the ListItems, Respectively](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span></span>

<span data-ttu-id="8f77e-138">**Rysunek 4**: Użyj `CategoryName` i `CategoryID` pól jako `Text` i `Value` dla `ListItem` s, odpowiednio ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-138">**Figure 4**: Use the `CategoryName` and `CategoryID` Fields as the `Text` and `Value` for the `ListItem` s, Respectively ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="8f77e-139">W tym momencie mamy kontrolki DropDownList (`Categories`), wyświetla listę kategorii w systemie.</span><span class="sxs-lookup"><span data-stu-id="8f77e-139">At this point we have a DropDownList (`Categories`) that lists the categories in the system.</span></span> <span data-ttu-id="8f77e-140">Teraz należy dodać w kontrolce GridView, który zawiera listę tych produktów, które należą do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-140">We now need to add a GridView that lists those products that belong to the selected category.</span></span> <span data-ttu-id="8f77e-141">Zanim przejdziemy, jednak przyjrzeć zaznacz pole wyboru włączenia automatycznego ogłaszania zwrotnego w DropDownList tagu inteligentnego.</span><span class="sxs-lookup"><span data-stu-id="8f77e-141">Before we do, though, take a moment to check the Enable AutoPostBack checkbox in the DropDownList's smart tag.</span></span> <span data-ttu-id="8f77e-142">Zgodnie z opisem w *wzorzec/szczegół filtrowanie przy użyciu kontrolki DropDownList* samouczków, ustawiając DropDownList `AutoPostBack` właściwość `True` strony zostanie opublikowany ponownie każdorazowo DropDownList wartość zostanie zmieniona.</span><span class="sxs-lookup"><span data-stu-id="8f77e-142">As discussed in the *Master/Detail Filtering With a DropDownList* tutorial, by setting the DropDownList's `AutoPostBack` property to `True` the page will be posted back each time the DropDownList value is changed.</span></span> <span data-ttu-id="8f77e-143">Spowoduje to GridView zostanie odświeżona, wyświetlanie tych produktów w nowo wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-143">This will cause the GridView to be refreshed, showing those products for the newly selected category.</span></span> <span data-ttu-id="8f77e-144">Jeśli `AutoPostBack` właściwość jest ustawiona na `False` (ustawienie domyślne), zmieniając kategorii nie powoduje odświeżenie strony i w związku z tym nie będzie aktualizacji listy produktów.</span><span class="sxs-lookup"><span data-stu-id="8f77e-144">If the `AutoPostBack` property is set to `False` (the default), changing the category won't cause a postback and therefore won't update the listed products.</span></span>

<span data-ttu-id="8f77e-145">[![Zaznacz pole wyboru AutoPostBack Włącz w tagu inteligentnego DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-145">[![Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="8f77e-146">**Rysunek 5**: Zaznacz pole wyboru Włącz automatycznego ogłaszania zwrotnego w tagu inteligentnego DropDownList ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-146">**Figure 5**: Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png))</span></span>

<span data-ttu-id="8f77e-147">Dodawanie kontrolki widoku siatki do strony w celu wyświetlania produktów dla wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-147">Add a GridView control to the page in order to display the products for the selected category.</span></span> <span data-ttu-id="8f77e-148">Ustaw GridView `ID` do `ProductsInCategory` i powiązać ją z nowego elementu ObjectDataSource, o nazwie `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-148">Set the GridView's `ID` to `ProductsInCategory` and bind it to a new ObjectDataSource named `ProductsInCategoryDataSource`.</span></span>

<span data-ttu-id="8f77e-149">[![Dodawanie nowego elementu ObjectDataSource, o nazwie ProductsInCategoryDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-149">[![Add a New ObjectDataSource Named ProductsInCategoryDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span></span>

<span data-ttu-id="8f77e-150">**Rysunek 6**: Dodaj nazwę nowej kontrolki ObjectDataSource `ProductsInCategoryDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-150">**Figure 6**: Add a New ObjectDataSource Named `ProductsInCategoryDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span></span>

<span data-ttu-id="8f77e-151">Skonfigurować kontrolki ObjectDataSource wywołuje `ProductsBLL` klasy `GetProductsByCategoryID(categoryID)` metody.</span><span class="sxs-lookup"><span data-stu-id="8f77e-151">Configure the ObjectDataSource so that it invokes the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="8f77e-152">[![Masz ObjectDataSource, wywołaj metodę GetProductsByCategoryID(categoryID)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-152">[![Have the ObjectDataSource Invoke the GetProductsByCategoryID(categoryID) Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="8f77e-153">**Rysunek 7**: Masz wywołania elementu ObjectDataSource `GetProductsByCategoryID(categoryID)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-153">**Figure 7**: Have the ObjectDataSource Invoke the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span></span>

<span data-ttu-id="8f77e-154">Ponieważ `GetProductsByCategoryID(categoryID)` metoda przyjmuje parametr wejściowy w ostatnim kroku kreatora można określić źródło wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="8f77e-154">Since the `GetProductsByCategoryID(categoryID)` method takes in an input parameter, in the final step of the wizard we can specify the source of the parameter value.</span></span> <span data-ttu-id="8f77e-155">Aby wyświetlić te produkty z wybranej kategorii, ma parametr pobierane z `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="8f77e-155">In order to display those products from the selected category, have the parameter pulled from the `Categories` DropDownList.</span></span>

<span data-ttu-id="8f77e-156">[![Uzyskiwanie categoryID wartość parametru metody DropDownList wybrane kategorie](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-156">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span></span>

<span data-ttu-id="8f77e-157">**Rysunek 8**: Pobierz *`categoryID`* wartość parametru metody DropDownList wybrane kategorie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-157">**Figure 8**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span></span>

<span data-ttu-id="8f77e-158">Po zakończeniu pracy kreatora widoku GridView mają elementu BoundField dla każdej właściwości produktu.</span><span class="sxs-lookup"><span data-stu-id="8f77e-158">After completing the wizard the GridView will have a BoundField for each of the product properties.</span></span> <span data-ttu-id="8f77e-159">Umożliwia czyszczenie, aby tylko te BoundFields `ProductName`, `UnitPrice`, `UnitsInStock`, i `UnitsOnOrder` BoundFields są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="8f77e-159">Let's clean up these BoundFields so that only the `ProductName`, `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields are displayed.</span></span> <span data-ttu-id="8f77e-160">Możesz dodać wszelkie ustawienia na poziomie pola do pozostałych BoundFields (takie jak formatowanie `UnitPrice` jako walutę).</span><span class="sxs-lookup"><span data-stu-id="8f77e-160">Feel free to add any field-level settings to the remaining BoundFields (such as formatting the `UnitPrice` as a currency).</span></span> <span data-ttu-id="8f77e-161">Po wprowadzeniu tych zmian, oznaczeniu deklaracyjnym GridView powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="8f77e-161">After making these changes, the GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="8f77e-162">W tym momencie mamy pełnej funkcjonalności raportu wzorzec/szczegół, który zawiera nazwę, cenę jednostkową, jednostek w magazynie i jednostek w kolejności dla tych produktów, które należą do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-162">At this point we have a fully functioning master/detail report that shows the name, unit price, units in stock, and units on order for those products that belong to the selected category.</span></span>

<span data-ttu-id="8f77e-163">[![Uzyskiwanie categoryID wartość parametru metody DropDownList wybrane kategorie](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-163">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span></span>

<span data-ttu-id="8f77e-164">**Rysunek 9**: Pobierz *`categoryID`* wartość parametru metody DropDownList wybrane kategorie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-164">**Figure 9**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span></span>

## <a name="step-2-displaying-a-footer-in-the-gridview"></a><span data-ttu-id="8f77e-165">Krok 2. Wyświetlanie stopki w widoku GridView</span><span class="sxs-lookup"><span data-stu-id="8f77e-165">Step 2: Displaying a Footer in the GridView</span></span>

<span data-ttu-id="8f77e-166">W kontrolce GridView można wyświetlić nagłówek i stopka wiersza.</span><span class="sxs-lookup"><span data-stu-id="8f77e-166">The GridView control can display both a header and footer row.</span></span> <span data-ttu-id="8f77e-167">Te wiersze są wyświetlane w zależności od wartości `ShowHeader` i `ShowFooter` właściwości, za pomocą `ShowHeader` przyjęty `True` i `ShowFooter` do `False`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-167">These rows are displayed depending on the values of the `ShowHeader` and `ShowFooter` properties, respectively, with `ShowHeader` defaulting to `True` and `ShowFooter` to `False`.</span></span> <span data-ttu-id="8f77e-168">Aby dołączyć stopce kontrolki GridView po prostu ustaw jego `ShowFooter` właściwość `True`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-168">To include a footer in the GridView simply set its `ShowFooter` property to `True`.</span></span>

<span data-ttu-id="8f77e-169">[![Wartość True właściwości ShowFooter GridView](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-169">[![Set the GridView's ShowFooter Property to True](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span></span>

<span data-ttu-id="8f77e-170">**Na rysunku nr 10**: Ustaw GridView `ShowFooter` właściwości `True` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-170">**Figure 10**: Set the GridView's `ShowFooter` Property to `True` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span></span>

<span data-ttu-id="8f77e-171">Wiersz stopki ma komórki dla każdego z pól zdefiniowanych w kontrolce GridView; Jednak te komórki są domyślnie puste.</span><span class="sxs-lookup"><span data-stu-id="8f77e-171">The footer row has a cell for each of the fields defined in the GridView; however, these cells are empty by default.</span></span> <span data-ttu-id="8f77e-172">Poświęć chwilę, aby wyświetlić postępach w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="8f77e-172">Take a moment to view our progress in a browser.</span></span> <span data-ttu-id="8f77e-173">Za pomocą `ShowFooter` teraz właściwością `True`, widoku GridView zawiera stopkę pusty wiersz.</span><span class="sxs-lookup"><span data-stu-id="8f77e-173">With the `ShowFooter` property now set to `True`, the GridView includes an empty footer row.</span></span>

<span data-ttu-id="8f77e-174">[![Teraz GridView zawiera wiersz stopki](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-174">[![The GridView Now Includes a Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span></span>

<span data-ttu-id="8f77e-175">**Rysunek 11**: Kontrolki GridView zawiera teraz wiersz stopki ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-175">**Figure 11**: The GridView Now Includes a Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span></span>

<span data-ttu-id="8f77e-176">Wiersz stopki rysunek 11 nie Wyróżnij, ponieważ zawiera ona białe tło.</span><span class="sxs-lookup"><span data-stu-id="8f77e-176">The footer row in Figure 11 doesn't stand out, as it has a white background.</span></span> <span data-ttu-id="8f77e-177">Utwórzmy `FooterStyle` klasy CSS w `Styles.css` , określa ciemnym tle czerwony, a następnie skonfiguruj `GridView.skin` plik Skin w `DataWebControls` motywu, aby przypisać tej klasy CSS do GridView `FooterStyle`firmy `CssClass` właściwości.</span><span class="sxs-lookup"><span data-stu-id="8f77e-177">Let's create a `FooterStyle` CSS class in `Styles.css` that specifies a dark red background and then configure the `GridView.skin` Skin file in the `DataWebControls` Theme to assign this CSS class to the GridView's `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="8f77e-178">Jeśli zachodzi potrzeba projektujesz skórek i motywów, odwołaj się do [wyświetlanie danych za pomocą kontrolki ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="8f77e-178">If you need to brush up on Skins and Themes, refer back to the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial.</span></span>

<span data-ttu-id="8f77e-179">Rozpocznij, dodając następujące klasy CSS do `Styles.css`:</span><span class="sxs-lookup"><span data-stu-id="8f77e-179">Start by adding the following CSS class to `Styles.css`:</span></span>

[!code-css[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample2.css)]

<span data-ttu-id="8f77e-180">`FooterStyle` Klasy CSS jest podobna we styl `HeaderStyle` klasy, mimo że `HeaderStyle`firmy kolor tła subtlety ciemniejszego i jego tekstu zostaną wyświetlone pogrubioną czcionką.</span><span class="sxs-lookup"><span data-stu-id="8f77e-180">The `FooterStyle` CSS class is similar in style to the `HeaderStyle` class, although the `HeaderStyle`'s background color is subtlety darker and its text is displayed in a bold font.</span></span> <span data-ttu-id="8f77e-181">Co więcej tekst w stopce kontrolki jest wyrównany do prawej natomiast skupia się tekst nagłówka.</span><span class="sxs-lookup"><span data-stu-id="8f77e-181">Furthermore, the text in the footer is right-aligned whereas the header's text is centered.</span></span>

<span data-ttu-id="8f77e-182">Następnie, aby skojarzyć ten klasę CSS z stopce kontrolki GridView, co, otwórz `GridView.skin` w pliku `DataWebControls` motywu i ustaw `FooterStyle`firmy `CssClass` właściwości.</span><span class="sxs-lookup"><span data-stu-id="8f77e-182">Next, to associate this CSS class with every GridView's footer, open the `GridView.skin` file in the `DataWebControls` Theme and set the `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="8f77e-183">Po dodaniu tego kodu znaczników pliku powinno wyglądać:</span><span class="sxs-lookup"><span data-stu-id="8f77e-183">After this addition the file's markup should look like:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="8f77e-184">Jak zrzucie ekranu poniżej przedstawiono, ta zmiana powoduje stopki wyraźnie więcej.</span><span class="sxs-lookup"><span data-stu-id="8f77e-184">As the screen shot below shows, this change makes the footer stand out more clearly.</span></span>

<span data-ttu-id="8f77e-185">[![Kolor tła czerwonawego ma teraz wiersz stopce kontrolki GridView](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-185">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span></span>

<span data-ttu-id="8f77e-186">**Rysunek 12**: Wiersz stopki GridView ma teraz czerwonawego kolor tła ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-186">**Figure 12**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span></span>

## <a name="step-3-computing-the-summary-data"></a><span data-ttu-id="8f77e-187">Krok 3. Przetwarzanie danych podsumowania</span><span class="sxs-lookup"><span data-stu-id="8f77e-187">Step 3: Computing the Summary Data</span></span>

<span data-ttu-id="8f77e-188">Za pomocą stopce kontrolki GridView wyświetlane dalej wyzwanie, połączonego z nami przedstawiono sposób obliczenia dane podsumowujące.</span><span class="sxs-lookup"><span data-stu-id="8f77e-188">With the GridView's footer displayed, the next challenge facing us is how to compute the summary data.</span></span> <span data-ttu-id="8f77e-189">Istnieją dwa sposoby obliczeń tych agregacji informacji:</span><span class="sxs-lookup"><span data-stu-id="8f77e-189">There are two ways to compute this aggregate information:</span></span>

1. <span data-ttu-id="8f77e-190">Za pomocą kwerendy SQL firma Microsoft może wydać dodatkowych kwerend w bazie danych do obliczenia dane podsumowania dla określonej kategorii.</span><span class="sxs-lookup"><span data-stu-id="8f77e-190">Through a SQL query we could issue an additional query to the database to compute the summary data for a particular category.</span></span> <span data-ttu-id="8f77e-191">SQL obejmuje pewną liczbę funkcji agregujących, wraz z `GROUP BY` klauzuli, aby określić dane, w którym można podsumować dane.</span><span class="sxs-lookup"><span data-stu-id="8f77e-191">SQL includes a number of aggregate functions along with a `GROUP BY` clause to specify the data over which the data should be summarized.</span></span> <span data-ttu-id="8f77e-192">Następujące zapytanie SQL będzie przywrócić potrzebnych informacji:</span><span class="sxs-lookup"><span data-stu-id="8f77e-192">The following SQL query would bring back the needed information:</span></span>  

    [!code-sql[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample4.sql)]

    <span data-ttu-id="8f77e-193">Oczywiście nie byłoby dobrze wydać to zapytanie bezpośrednio z `SummaryDataInFooter.aspx` strony, ale raczej, tworząc metody w `ProductsTableAdapter` i `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-193">Of course you wouldn't want to issue this query directly from the `SummaryDataInFooter.aspx` page, but rather by creating a method in the `ProductsTableAdapter` and the `ProductsBLL`.</span></span>
2. <span data-ttu-id="8f77e-194">Obliczenia te informacje, ponieważ ona jest dodawany do kontrolki GridView zgodnie z opisem w [niestandardowe formatowanie oparte na danych](custom-formatting-based-upon-data-cs.md) samouczku, widoku GridView `RowDataBound` program obsługi zdarzeń jest uruchamiana raz dla każdego wiersza dodawane do kontrolki GridView po jego zostały z danymi.</span><span class="sxs-lookup"><span data-stu-id="8f77e-194">Compute this information as it's being added to the GridView as discussed in [Custom Formatting Based Upon Data](custom-formatting-based-upon-data-cs.md) tutorial, the GridView's `RowDataBound` event handler fires once for each row being added to the GridView after its been databound.</span></span> <span data-ttu-id="8f77e-195">Tworząc program obsługi zdarzeń dla tego zdarzenia nam zapewnić działającego całkowitej wartości chcemy, aby agregować.</span><span class="sxs-lookup"><span data-stu-id="8f77e-195">By creating an event handler for this event we can keep a running total of the values we want to aggregate.</span></span> <span data-ttu-id="8f77e-196">Po ostatnim wierszu danych została powiązana z GridView mamy sum oraz informacjami potrzebnymi do obliczenia średniej.</span><span class="sxs-lookup"><span data-stu-id="8f77e-196">After the last data row has been bound to the GridView we have the totals and the information needed to compute the average.</span></span>

<span data-ttu-id="8f77e-197">I zazwyczaj używają drugiej metody, zapisuje podróż do bazy danych i pracy potrzeba do implementacji funkcji Podsumowanie warstwy dostępu do danych i warstwy logiki biznesowej, ale każda z tych metod może wystarczyć.</span><span class="sxs-lookup"><span data-stu-id="8f77e-197">I typically employ the second approach as it saves a trip to the database and the effort needed to implement the summary functionality in the Data Access Layer and Business Logic Layer, but either approach would suffice.</span></span> <span data-ttu-id="8f77e-198">W tym samouczku możemy użyć drugiej opcji i śledzenie Suma przy użyciu `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-198">For this tutorial let's use the second option and keep track of the running total using the `RowDataBound` event handler.</span></span>

<span data-ttu-id="8f77e-199">Tworzenie `RowDataBound` program obsługi zdarzeń dla widoku GridView wybranie kontrolki GridView w projektancie, klikając ikonę pioruna w oknie właściwości i dwukrotne kliknięcie `RowDataBound` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-199">Create a `RowDataBound` event handler for the GridView by selecting the GridView in the Designer, clicking the lightning bolt icon from the Properties window, and double-clicking the `RowDataBound` event.</span></span> <span data-ttu-id="8f77e-200">Alternatywnie można wybrać dla widoku GridView i jej RowDataBound zdarzenia z listy rozwijanej w górnej części pliku klasy związane z kodem programu ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8f77e-200">Alternatively, you can select the GridView and its RowDataBound event from the drop-down lists at the top of the ASP.NET code-behind class file.</span></span> <span data-ttu-id="8f77e-201">Spowoduje to utworzenie nowego programu obsługi zdarzeń o nazwie `ProductsInCategory_RowDataBound` w `SummaryDataInFooter.aspx` strony osobna klasa kodu.</span><span class="sxs-lookup"><span data-stu-id="8f77e-201">This will create a new event handler named `ProductsInCategory_RowDataBound` in the `SummaryDataInFooter.aspx` page's code-behind class.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample5.vb)]

<span data-ttu-id="8f77e-202">Aby sumy należy zdefiniować zmienne poza zakresem obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-202">In order to maintain a running total we need to define variables outside of the scope of the event handler.</span></span> <span data-ttu-id="8f77e-203">Utwórz cztery następujące zmienne na poziomie strony:</span><span class="sxs-lookup"><span data-stu-id="8f77e-203">Create the following four page-level variables:</span></span>

- <span data-ttu-id="8f77e-204">`_totalUnitPrice`, typu `Decimal`</span><span class="sxs-lookup"><span data-stu-id="8f77e-204">`_totalUnitPrice`, of type `Decimal`</span></span>
- <span data-ttu-id="8f77e-205">`_totalNonNullUnitPriceCount`, typu `Integer`</span><span class="sxs-lookup"><span data-stu-id="8f77e-205">`_totalNonNullUnitPriceCount`, of type `Integer`</span></span>
- <span data-ttu-id="8f77e-206">`_totalUnitsInStock`, typu `Integer`</span><span class="sxs-lookup"><span data-stu-id="8f77e-206">`_totalUnitsInStock`, of type `Integer`</span></span>
- <span data-ttu-id="8f77e-207">`_totalUnitsOnOrder`, typu `Integer`</span><span class="sxs-lookup"><span data-stu-id="8f77e-207">`_totalUnitsOnOrder`, of type `Integer`</span></span>

<span data-ttu-id="8f77e-208">Następnie napisać kod, aby zwiększyć te trzy zmienne, dla każdego wiersza danych podczas `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-208">Next, write the code to increment these three variables for each data row encountered in the `RowDataBound` event handler.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample6.vb)]

<span data-ttu-id="8f77e-209">`RowDataBound` Program obsługi zdarzeń, który rozpoczyna się poprzez zapewnienie, że firma Microsoft jest zajmujących się DataRow.</span><span class="sxs-lookup"><span data-stu-id="8f77e-209">The `RowDataBound` event handler starts by ensuring that we're dealing with a DataRow.</span></span> <span data-ttu-id="8f77e-210">Gdy zostanie który zostało nawiązane, `Northwind.ProductsRow` wystąpienia, która właśnie została powiązana z `GridViewRow` obiektu `e.Row` jest przechowywana w zmiennej `product`.</span><span class="sxs-lookup"><span data-stu-id="8f77e-210">Once that's been established, the `Northwind.ProductsRow` instance that was just bound to the `GridViewRow` object in `e.Row` is stored in the variable `product`.</span></span> <span data-ttu-id="8f77e-211">Następny, uruchomione łączna liczba zmiennych są zwiększane o bieżącego produktu odpowiadające im wartości (przy założeniu, że nie zawierają bazy danych `NULL` wartości).</span><span class="sxs-lookup"><span data-stu-id="8f77e-211">Next, running total variables are incremented by the current product's corresponding values (assuming that they don't contain a database `NULL` value).</span></span> <span data-ttu-id="8f77e-212">Firma Microsoft zachować informacje o jednocześnie działające `UnitPrice` łącznej liczby przypadków i liczba non -`NULL` `UnitPrice` rejestruje ponieważ średnia cena jest równy ilorazowi tych dwóch liczb.</span><span class="sxs-lookup"><span data-stu-id="8f77e-212">We keep track of both the running `UnitPrice` total and the number of non-`NULL` `UnitPrice` records because the average price is the quotient of these two numbers.</span></span>

## <a name="step-4-displaying-the-summary-data-in-the-footer"></a><span data-ttu-id="8f77e-213">Krok 4. Wyświetlanie danych podsumowania w stopce</span><span class="sxs-lookup"><span data-stu-id="8f77e-213">Step 4: Displaying the Summary Data in the Footer</span></span>

<span data-ttu-id="8f77e-214">Za pomocą dane podsumowania sumowane ostatnim krokiem jest do wyświetlenia go w wierszu stopce kontrolki GridView.</span><span class="sxs-lookup"><span data-stu-id="8f77e-214">With the summary data totaled, the last step is to display it in the GridView's footer row.</span></span> <span data-ttu-id="8f77e-215">To zadanie, można osiągnąć programowo za pośrednictwem `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-215">This task, too, can be accomplished programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="8f77e-216">Pamiętamy `RowDataBound` obsługi zdarzenia generowane dla *co* wiersza, który jest powiązany z GridView, w tym wierszu stopki.</span><span class="sxs-lookup"><span data-stu-id="8f77e-216">Recall that the `RowDataBound` event handler fires for *every* row that's bound to the GridView, including the footer row.</span></span> <span data-ttu-id="8f77e-217">W związku z tym możemy rozszerzyć nasze programu obsługi zdarzeń, aby wyświetlić dane w wierszu stopki, używając następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="8f77e-217">Therefore, we can augment our event handler to display the data in the footer row using the following code:</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="8f77e-218">Ponieważ wiersz stopki jest dodawana do kontrolki GridView po wszystkich wierszy danych zostały dodane, firma Microsoft może być pewność, że przez czas jesteśmy gotowi wyświetlić dane podsumowania w stopce, który ukończy Suma obliczeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-218">Since the footer row is added to the GridView after all of the data rows have been added, we can be confident that by the time we're ready to display the summary data in the footer the running total calculations will have completed.</span></span> <span data-ttu-id="8f77e-219">Ostatnim krokiem jest następnie ustaw te wartości w komórkach stopki.</span><span class="sxs-lookup"><span data-stu-id="8f77e-219">The last step, then, is to set these values in the footer's cells.</span></span>

<span data-ttu-id="8f77e-220">Aby wyświetlić tekst w komórce stopki określonego, użyj `e.Row.Cells(index).Text = value`, gdzie `Cells` indeksowanie rozpoczyna się od 0.</span><span class="sxs-lookup"><span data-stu-id="8f77e-220">To display text in a particular footer cell, use `e.Row.Cells(index).Text = value`, where the `Cells` indexing starts at 0.</span></span> <span data-ttu-id="8f77e-221">Poniższy kod oblicza średnią cenę (całkowita cena dzielona przez liczbę produktów) i wyświetla go wraz z całkowitą liczbą jednostek w magazynie i jednostki w kolejności w komórkach odpowiednie stopce kontrolki GridView.</span><span class="sxs-lookup"><span data-stu-id="8f77e-221">The following code computes the average price (the total price divided by the number of products) and displays it along with the total number of units in stock and units on order in the appropriate footer cells of the GridView.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="8f77e-222">Rysunek 13 zawiera raport, po dodaniu tego kodu.</span><span class="sxs-lookup"><span data-stu-id="8f77e-222">Figure 13 shows the report after this code has been added.</span></span> <span data-ttu-id="8f77e-223">Uwaga jak `ToString("c")` powoduje, że średnia cena informacje podsumowujące do być sformatowane następująco walutę.</span><span class="sxs-lookup"><span data-stu-id="8f77e-223">Note how the `ToString("c")` causes the average price summary information to be formatted like a currency.</span></span>

<span data-ttu-id="8f77e-224">[![Kolor tła czerwonawego ma teraz wiersz stopce kontrolki GridView](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8f77e-224">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span></span>

<span data-ttu-id="8f77e-225">**Rysunek 13**: Wiersz stopki GridView ma teraz czerwonawego kolor tła ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="8f77e-225">**Figure 13**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="8f77e-226">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="8f77e-226">Summary</span></span>

<span data-ttu-id="8f77e-227">Wyświetlanie podsumowania danych jest typowym wymogiem raportów i kontrolki GridView ułatwia obejmują takie informacje w jego wierszu stopki.</span><span class="sxs-lookup"><span data-stu-id="8f77e-227">Displaying summary data is a common report requirement, and the GridView control makes it easy to include such information in its footer row.</span></span> <span data-ttu-id="8f77e-228">Wiersz stopka jest wyświetlany podczas GridView `ShowFooter` właściwość jest ustawiona na `True` i może zawierać tekstu w komórkach ustawić programowo za pomocą `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="8f77e-228">The footer row is displayed when the GridView's `ShowFooter` property is set to `True` and can have the text in its cells set programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="8f77e-229">Przetwarzanie danych podsumowania albo można przeprowadzić przez ponownie zapytanie do bazy danych lub przy użyciu kodu w klasie CodeBehind strony ASP.NET, można programowo obliczyć dane podsumowujące.</span><span class="sxs-lookup"><span data-stu-id="8f77e-229">Computing the summary data can either be done by re-querying the database or by using code in the ASP.NET page's code-behind class to programmatically compute the summary data.</span></span>

<span data-ttu-id="8f77e-230">W tym samouczku zawiera niestandardowe formatowanie przy użyciu kontrolki GridView DetailsView i FormView nasze badania.</span><span class="sxs-lookup"><span data-stu-id="8f77e-230">This tutorial concludes our examination of custom formatting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="8f77e-231">Naszego następnego samouczka dotyczącego naszych badań Wstawianie, aktualizowanie i usuwanie danych przy użyciu tych tych samych kontrolek.</span><span class="sxs-lookup"><span data-stu-id="8f77e-231">Our next tutorial kicks off our exploration of inserting, updating, and deleting data using these same controls.</span></span>

<span data-ttu-id="8f77e-232">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="8f77e-232">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8f77e-233">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="8f77e-233">About the Author</span></span>

<span data-ttu-id="8f77e-234">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="8f77e-234">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8f77e-235">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="8f77e-235">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8f77e-236">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8f77e-236">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8f77e-237">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8f77e-237">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8f77e-238">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8f77e-238">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8f77e-239">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="8f77e-239">Previous</span></span>](using-the-formview-s-templates-vb.md)
