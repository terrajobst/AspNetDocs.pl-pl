---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Aktualizowanie elementu TableAdapter w celu używania sprzężenia (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Podczas pracy z bazą danych jest często dane żądania, która jest rozłożona się między wieloma tabelami. Aby pobrać dane z dwóch różnych tabel możemy użyć albo...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: d5b69b502cf650a477b2841c25ad3f1ab5f8da93
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57073838"
---
<a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="960cd-104">Aktualizowanie elementu TableAdapter w celu używania sprzężeń JOIN (C#)</span><span class="sxs-lookup"><span data-stu-id="960cd-104">Updating the TableAdapter to Use JOINs (C#)</span></span>
====================
<span data-ttu-id="960cd-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="960cd-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="960cd-106">[Pobierz program Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) lub [Pobierz plik PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="960cd-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="960cd-107">Podczas pracy z bazą danych jest często dane żądania, która jest rozłożona się między wieloma tabelami.</span><span class="sxs-lookup"><span data-stu-id="960cd-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="960cd-108">Aby pobrać dane z dwóch różnych tabel możemy użyć skorelowane podzapytanie lub operacji tworzenia sprzężenia.</span><span class="sxs-lookup"><span data-stu-id="960cd-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="960cd-109">W tym samouczku porównamy skorelowany podzapytań i składni klauzuli JOIN przed obejrzeniem sposób tworzenia, zawierający sprzężenia w jego główne zapytanie TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="960cd-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="960cd-110">Introduction</span></span>

<span data-ttu-id="960cd-111">Przy użyciu relacyjnych baz danych dane, które jesteśmy zainteresowani Praca z często rozkłada się na wiele tabel.</span><span class="sxs-lookup"><span data-stu-id="960cd-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="960cd-112">Na przykład podczas wyświetlania informacji o produkcie prawdopodobnie chcemy wyświetlić listę każdego produktu s odpowiedniej kategorii i nazw s dostawców.</span><span class="sxs-lookup"><span data-stu-id="960cd-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="960cd-113">`Products` Tabela ma `CategoryID` i `SupplierID` wartości, ale rzeczywiste nazwy kategorii i dostawcy znajdują się w `Categories` i `Suppliers` tabel, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="960cd-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="960cd-114">Aby pobrać informacje z inną, powiązanej tabeli, możemy użyć *skorelowane podzapytań* lub `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="960cd-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="960cd-115">Skorelowane podzapytanie jest zagnieżdżoną `SELECT` zapytania, który odwołuje się do kolumn w zapytaniu zewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="960cd-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="960cd-116">Na przykład w [Tworzenie warstwy dostępu do danych](../introduction/creating-a-data-access-layer-cs.md) samouczka użyliśmy dwóch podzapytań skorelowane w `ProductsTableAdapter` s główne zapytanie, aby zwrócić nazwy kategorii i dostawcy dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="960cd-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="960cd-117">Element `JOIN` jest konstrukcją SQL, która scala powiązane wiersze z dwóch różnych tabel.</span><span class="sxs-lookup"><span data-stu-id="960cd-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="960cd-118">Użyliśmy `JOIN` w [zapytania danych przy użyciu kontrolki SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) samouczka, aby wyświetlić informacje o kategorii obok każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="960cd-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="960cd-119">Przyczyna, firma Microsoft ma abstained z przy użyciu `JOIN` s przy użyciu elementów TableAdapter jest ze względu na ograniczenia w Kreatorze s TableAdapter, aby automatycznie wygenerować odpowiadającą `INSERT`, `UPDATE`, i `DELETE` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="960cd-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="960cd-120">W szczególności jeśli TableAdapter s główne zapytanie zawiera którykolwiek `JOIN` s, TableAdapter nie automatyczne tworzenie zapytań ad-hoc instrukcji SQL lub procedur składowanych do jego `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="960cd-121">W tym samouczku krótko porównamy i kontrast skorelowane podzapytań i `JOIN` s przed rozpoczęciem pracy, jak utworzyć obiekt TableAdapter, która obejmuje `JOIN` s w jego główne zapytanie.</span><span class="sxs-lookup"><span data-stu-id="960cd-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="960cd-122">Porównywanie i kontrastujących skorelowane podzapytań i`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="960cd-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="960cd-123">Pamiętamy `ProductsTableAdapter` utworzony w pierwszym samouczku `Northwind` zestawu danych używa skorelowany podzapytań przywrócić nazwy każdego produktu s odpowiedniej kategorii i dostawcy.</span><span class="sxs-lookup"><span data-stu-id="960cd-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="960cd-124">`ProductsTableAdapter` Poniżej przedstawiono główne zapytanie s.</span><span class="sxs-lookup"><span data-stu-id="960cd-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="960cd-125">Dwa skorelowane podzapytań - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` i `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` — są `SELECT` zapytań zwracających pojedynczą wartość dla każdego produktu jako dodatkową kolumnę w zewnętrzny blok `SELECT` instrukcja s lista kolumn.</span><span class="sxs-lookup"><span data-stu-id="960cd-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="960cd-126">Alternatywnie `JOIN` może służyć do zwrotu nazwy każdego produktu s dostawcy i kategorii.</span><span class="sxs-lookup"><span data-stu-id="960cd-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="960cd-127">Następujące zapytanie zwraca ten sam wynik co powyżej, ale używa `JOIN` s zamiast podzapytań:</span><span class="sxs-lookup"><span data-stu-id="960cd-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="960cd-128">A `JOIN` scala rekordy z jednej tabeli rekordy z innej tabeli na podstawie pewnych kryteriów.</span><span class="sxs-lookup"><span data-stu-id="960cd-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="960cd-129">W powyższym zapytaniu, na przykład `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` powoduje, że program SQL Server do scalenia każdego rekordu produktu z kategorii rejestrowania, którego `CategoryID` wartość odpowiada produkt s `CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="960cd-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="960cd-130">Scalonego wyniku pozwala pracować z odpowiedniego pola kategorii dla każdego produktu (takie jak `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="960cd-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="960cd-131">`JOIN` s są często używane podczas wykonywania zapytań dotyczących danych z relacyjnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="960cd-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="960cd-132">Jeśli dopiero zaczynasz korzystać z `JOIN` składni lub trzeba nieco projektujesz jej użycie d zalecam [samouczek SQL Join](http://www.w3schools.com/sql/sql_join.asp) na [szkół W3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="960cd-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="960cd-133">Warto odczytu są także [ `JOIN` podstawy](https://msdn.microsoft.com/library/ms191517.aspx) i [podstawy podzapytania](https://msdn.microsoft.com/library/ms189575.aspx) sekcje [SQL — książki Online](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="960cd-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="960cd-134">Ponieważ `JOIN` s i skorelowane podzapytania mogą posłużyć do pobierania danych powiązane z innymi tabelami, wielu deweloperów są pozostawiane drapanie ich nagłówki i zastanawiasz się, które rozwiązanie do użycia.</span><span class="sxs-lookup"><span data-stu-id="960cd-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="960cd-135">Wszystkie SQL gurus I ve Rozmawialiśmy do dostęp mniej więcej tak samo, że t ma znaczenia performance-wise jako programu SQL Server powoduje wygenerowanie plany wykonywania mniej więcej taka sama.</span><span class="sxs-lookup"><span data-stu-id="960cd-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="960cd-136">Porady, następnie polega na użyciu techniki, które Ty i Twój zespół są najbardziej Ci.</span><span class="sxs-lookup"><span data-stu-id="960cd-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="960cd-137">Uzasadnia, biorąc pod uwagę, że po nadając tej porady te ekspertów natychmiast express swoje preferencje `JOIN` s za pośrednictwem skorelowany podzapytania.</span><span class="sxs-lookup"><span data-stu-id="960cd-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="960cd-138">Podczas tworzenia warstwy dostępu do danych, przy użyciu wpisanych zestawów danych, narzędzia działają lepiej korzystając z podzapytania.</span><span class="sxs-lookup"><span data-stu-id="960cd-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="960cd-139">W szczególności, Kreator s TableAdapter nie generowane automatycznie odpowiadającego `INSERT`, `UPDATE`, i `DELETE` instrukcji, jeśli główne zapytanie zawiera którykolwiek `JOIN` s, ale generowane automatycznie tych instrukcji, gdy skorelowane podzapytania są używane.</span><span class="sxs-lookup"><span data-stu-id="960cd-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="960cd-140">Aby poznać tego braku, Utwórz tymczasowe wpisana zestawu danych w `~/App_Code/DAL` folderu.</span><span class="sxs-lookup"><span data-stu-id="960cd-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="960cd-141">W Kreatorze konfiguracji TableAdapter chce używać instrukcji języka SQL zapytań ad-hoc, a następnie wprowadź następujące `SELECT` zapytania (patrz rysunek 1):</span><span class="sxs-lookup"><span data-stu-id="960cd-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]


<span data-ttu-id="960cd-142">[![Wprowadź główne zapytanie, która zawiera sprzężenia](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="960cd-143">**Rysunek 1**: Wprowadź kwerendę Main zawierający `JOIN` s ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>


<span data-ttu-id="960cd-144">Domyślnie automatycznie utworzy TableAdapter `INSERT`, `UPDATE`, i `DELETE` instrukcji na podstawie głównego zapytania.</span><span class="sxs-lookup"><span data-stu-id="960cd-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="960cd-145">Po kliknięciu przycisku Zaawansowane widać, że ta funkcja jest włączona.</span><span class="sxs-lookup"><span data-stu-id="960cd-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="960cd-146">Niezależnie od tego ustawienia TableAdapter nie będzie mogła tworzyć `INSERT`, `UPDATE`, i `DELETE` instrukcji ponieważ główne zapytanie zawiera `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="960cd-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Wprowadź główne zapytanie, która zawiera sprzężenia](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="960cd-148">**Rysunek 2**: Wprowadź główne zapytanie, która zawiera `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="960cd-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="960cd-149">Kliknij przycisk Zakończ, aby zakończyć działanie kreatora.</span><span class="sxs-lookup"><span data-stu-id="960cd-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="960cd-150">W tym momencie usługi s DataSet Designer będzie zawierać pojedynczy obiekt TableAdapter z obiektu DataTable z kolumny dla każdego pola, zwracany w `SELECT` listy kolumny zapytania s.</span><span class="sxs-lookup"><span data-stu-id="960cd-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="960cd-151">Obejmuje to `CategoryName` i `SupplierName`, jak pokazano na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="960cd-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable zawiera kolumnę dla każdego pola, zwrócony na liście kolumn](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="960cd-153">**Rysunek 3**: DataTable zawiera kolumnę dla każdego pola, zwrócony na liście kolumn</span><span class="sxs-lookup"><span data-stu-id="960cd-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="960cd-154">Chociaż DataTable ma odpowiednie kolumny, TableAdapter nie ma wartości dla swojej `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="960cd-155">Można to potwierdzić, kliknij na obiekt TableAdapter w projektancie, a następnie przejdź do okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="960cd-156">Będzie informacja, że `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości są ustawione na (Brak).</span><span class="sxs-lookup"><span data-stu-id="960cd-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="960cd-157">[![Element InsertCommand elementu UpdateCommand i właściwości elementu DeleteCommand są ustawione na (Brak)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="960cd-158">**Rysunek 4**: `InsertCommand`, `UpdateCommand`, I `DeleteCommand` właściwości są ustawione na (Brak) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>


<span data-ttu-id="960cd-159">W celu obejścia tego braku, można ręcznie zapewniamy instrukcji SQL i parametry `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości, za pośrednictwem oknie właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="960cd-160">Alternatywnie można Zaczniemy od konfiguracji zapytania TableAdapter głównego s, aby *nie* zawierać `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="960cd-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="960cd-161">Dzięki temu będzie `INSERT`, `UPDATE`, i `DELETE` instrukcje, aby być generowane automatycznie dla nas.</span><span class="sxs-lookup"><span data-stu-id="960cd-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="960cd-162">Po ukończeniu kreatora, firma Microsoft może następnie ręcznie zaktualizować TableAdapter s `SelectCommand` w oknie właściwości, tak że obejmuje `JOIN` składni.</span><span class="sxs-lookup"><span data-stu-id="960cd-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="960cd-163">Chociaż to podejście pozwala skutecznie, jest bardzo kruchy po przy użyciu zapytań SQL w trybie ad-hoc, ponieważ w dowolnym momencie główne zapytanie TableAdapter s ponownie skonfigurować za pomocą Kreatora automatycznego generowania `INSERT`, `UPDATE`, i `DELETE` instrukcje są tworzone ponownie.</span><span class="sxs-lookup"><span data-stu-id="960cd-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="960cd-164">Oznacza to, że wszystkie modyfikacje później wprowadziliśmy zostałyby utracone jeśli możemy kliknięto prawym przyciskiem myszy na obiekt TableAdapter, wybrana konfiguracja z menu kontekstowego i ukończyć kreatora ponownie.</span><span class="sxs-lookup"><span data-stu-id="960cd-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="960cd-165">Kruchości s TableAdapter generowanych automatycznie `INSERT`, `UPDATE`, i `DELETE` instrukcji jest można jednak ograniczone do instrukcji SQL zapytań ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="960cd-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="960cd-166">Twoje TableAdapter używa procedur składowanych, można dostosować `SelectCommand`, `InsertCommand`, `UpdateCommand`, lub `DeleteCommand` procedur składowanych i ponownie uruchom Kreator konfiguracji TableAdapter bez obawy, że będzie procedur składowanych zmodyfikowane.</span><span class="sxs-lookup"><span data-stu-id="960cd-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="960cd-167">Przez następne kilka kroków, które utworzymy TableAdapter, która początkowo używa główne zapytanie, które pomija dowolne `JOIN` s, aby odpowiednie wstawiania, aktualizacji i usuwania przechowywane procedury będą generowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="960cd-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="960cd-168">Następnie zaktualizujemy `SelectCommand` tak, który używa `JOIN` zwracającego dodatkowe kolumny z powiązanych tabel.</span><span class="sxs-lookup"><span data-stu-id="960cd-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="960cd-169">Na koniec utworzymy odpowiednią klasę warstwy logiki biznesowej i demonstrującą używanie TableAdapter strony sieci web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="960cd-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="960cd-170">Krok 1. Tworzenie TableAdapter za pomocą uproszczonego główne zapytanie</span><span class="sxs-lookup"><span data-stu-id="960cd-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="960cd-171">W tym samouczku dodamy TableAdapter i silnie typizowaną klasę DataTable `Employees` tabelę `NorthwindWithSprocs` zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="960cd-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="960cd-172">`Employees` Tabela zawiera `ReportsTo` pola, które określone `EmployeeID` menedżera pracownika s.</span><span class="sxs-lookup"><span data-stu-id="960cd-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="960cd-173">Na przykład pracownik ma Dodsworth Anna `ReportTo` wartość 5, która jest `EmployeeID` z Bator Steven.</span><span class="sxs-lookup"><span data-stu-id="960cd-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="960cd-174">W związku z tym Anna raporty Steven, swojemu menedżerowi.</span><span class="sxs-lookup"><span data-stu-id="960cd-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="960cd-175">Wraz z raportowania każdemu pracownikowi s `ReportsTo` wartości, firma Microsoft może być również konieczne pobrać nazwy jego menedżera.</span><span class="sxs-lookup"><span data-stu-id="960cd-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="960cd-176">Można to zrobić za pomocą `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="960cd-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="960cd-177">Jednak przy użyciu `JOIN` podczas początkowo tworzenie TableAdapter wyklucza kreatora z automatycznego generowania odpowiednich wstawiania, aktualizowania i usuwania możliwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="960cd-178">W związku z tym, Zaczniemy, tworząc TableAdapter, w których główne zapytanie nie zawiera żadnych `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="960cd-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="960cd-179">Następnie w kroku 2, zaktualizujemy procedurę główne zapytanie przechowywane, aby pobrać nazwę menedżera s za pośrednictwem `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="960cd-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="960cd-180">Zacznij od otwarcia `NorthwindWithSprocs` zestawu danych w `~/App_Code/DAL` folderu.</span><span class="sxs-lookup"><span data-stu-id="960cd-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="960cd-181">Kliknij prawym przyciskiem myszy w projektancie, wybierz opcję Dodaj menu kontekstowe i wybierz element menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="960cd-182">Spowoduje to uruchomienie Kreatora konfiguracji TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="960cd-183">Jak przedstawiono na rysunku 5, należy za pomocą kreatora, Utwórz nowe procedury składowane, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="960cd-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="960cd-184">Dla przypomnienia informacji na temat tworzenia nowych procedur składowanych z Kreatora s TableAdapter, zapoznaj się [tworzenie nowych procedur składowanych dla s wpisany zestaw danych TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="960cd-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>


<span data-ttu-id="960cd-185">[![Wybierz pozycję Utwórz nowe procedury składowane opcji](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="960cd-186">**Rysunek 5**: Wybierz pozycję Utwórz nowe procedury składowane opcji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>


<span data-ttu-id="960cd-187">Należy użyć następującego `SELECT` instrukcji kwerendy głównych s TableAdapter:</span><span class="sxs-lookup"><span data-stu-id="960cd-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="960cd-188">Ponieważ to zapytanie nie zawiera żadnych `JOIN` s, TableAdapter Kreator automatycznie utworzy procedur składowanych z odpowiednimi `INSERT`, `UPDATE`, i `DELETE` instrukcji, a także procedury składowanej do wykonywania głównych Zapytanie.</span><span class="sxs-lookup"><span data-stu-id="960cd-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="960cd-189">Następny krok pozwala nam nazwę procedury przechowywane s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="960cd-190">Użyj nazw `Employees_Select`, `Employees_Insert`, `Employees_Update`, i `Employees_Delete`, jak pokazano na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="960cd-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="960cd-191">[![Nazwa procedury przechowywane s TableAdapter](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="960cd-192">**Rysunek 6**: Nadaj nazwę procedur składowanych s TableAdapter ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>


<span data-ttu-id="960cd-193">Ostatnim krokiem monituje o nas nazwę metody s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="960cd-194">Użyj `Fill` i `GetEmployees` jako nazwy metody.</span><span class="sxs-lookup"><span data-stu-id="960cd-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="960cd-195">Należy także pozostawić Utwórz metody służące do wysyłania aktualizacji bezpośrednio do bazy danych (GenerateDBDirectMethods) zaznacz pole wyboru zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="960cd-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="960cd-196">[![Nazwa metody wypełnienie s TableAdapter i GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="960cd-197">**Rysunek 7**: Nazwa s TableAdapter metody `Fill` i `GetEmployees` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>


<span data-ttu-id="960cd-198">Po ukończeniu kreatora, Poświęć chwilę, aby zbadać procedur składowanych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="960cd-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="960cd-199">Powinny zostać wyświetlone cztery nowe: `Employees_Select`, `Employees_Insert`, `Employees_Update`, i `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="960cd-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="960cd-200">Następnie sprawdź `EmployeesDataTable` i `EmployeesTableAdapter` właśnie utworzony.</span><span class="sxs-lookup"><span data-stu-id="960cd-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="960cd-201">DataTable zawiera kolumnę dla każdego pola, zwrócony przez główne zapytanie.</span><span class="sxs-lookup"><span data-stu-id="960cd-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="960cd-202">Kliknij w metodzie TableAdapter, a następnie przejdź do okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="960cd-203">Będzie informacja, że `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości są prawidłowo skonfigurowane do wywoływania odpowiednich procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="960cd-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="960cd-204">[![TableAdapter obejmuje Insert, Update i usuwanie funkcji](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="960cd-205">**Rysunek 8**: TableAdapter obejmuje Insert, Update i usuwanie możliwości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>


<span data-ttu-id="960cd-206">Za pomocą wstawiania, aktualizowania i usuwania automatycznie tworzyć procedury składowane i `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości poprawnie skonfigurowana, możemy przystąpić do dostosowywania `SelectCommand` s przechowywane procedury, aby zwrócić dodatkowe informacje na temat każdego menedżera pracownika s.</span><span class="sxs-lookup"><span data-stu-id="960cd-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="960cd-207">W szczególności należy zaktualizować `Employees_Select` użyj procedury składowanej `JOIN` i zwracają Menedżera s `FirstName` i `LastName` wartości.</span><span class="sxs-lookup"><span data-stu-id="960cd-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="960cd-208">Po zaktualizowaniu procedury składowanej będzie musimy zaktualizować na obiekt DataTable, aby obejmowała te dodatkowe kolumny.</span><span class="sxs-lookup"><span data-stu-id="960cd-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="960cd-209">Firma Microsoft będzie czoła te dwa zadania w krokach 2 i 3.</span><span class="sxs-lookup"><span data-stu-id="960cd-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="960cd-210">Krok 2. Dostosowywanie procedury składowanej do uwzględnienia`JOIN`</span><span class="sxs-lookup"><span data-stu-id="960cd-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="960cd-211">Początek, przechodząc do Eksploratora serwera, przechodzenie do szczegółów w folderze procedur składowanych s bazy danych Northwind i otwierania `Employees_Select` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="960cd-212">Jeśli nie widzisz tej procedury składowanej, kliknij prawym przyciskiem myszy w folderze procedur składowanych, a następnie wybierz polecenie Odśwież.</span><span class="sxs-lookup"><span data-stu-id="960cd-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="960cd-213">Zaktualizuj procedury składowanej, tak aby używał `LEFT JOIN` najpierw zwrócić Menedżera s i nazwisko:</span><span class="sxs-lookup"><span data-stu-id="960cd-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="960cd-214">Po zaktualizowaniu `SELECT` instrukcji, Zapisz zmiany, przechodząc do menu Plik i wybierając pozycję Zapisz `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="960cd-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="960cd-215">Alternatywnie możesz kliknij ikonę Zapisz na pasku narzędzi lub naciśnij klawisze Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="960cd-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="960cd-216">Po zapisaniu zmian, kliknij prawym przyciskiem myszy `Employees_Select` procedurę składowaną w Eksploratorze serwera i wybierz polecenie Execute.</span><span class="sxs-lookup"><span data-stu-id="960cd-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="960cd-217">Spowoduje to uruchomienie procedury składowanej i wyświetlić wyniki w oknie danych wyjściowych (patrz rysunek 9).</span><span class="sxs-lookup"><span data-stu-id="960cd-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="960cd-218">[![Wyniki procedury przechowywane są wyświetlane w oknie danych wyjściowych](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="960cd-219">**Rysunek 9**: Wyniki procedury przechowywane są wyświetlane w oknie danych wyjściowych ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="960cd-220">Krok 3. Aktualizowanie kolumn s DataTable</span><span class="sxs-lookup"><span data-stu-id="960cd-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="960cd-221">W tym momencie `Employees_Select` przechowywane procedury zwraca `ManagerFirstName` i `ManagerLastName` wartości, ale `EmployeesDataTable` brakuje tych kolumn.</span><span class="sxs-lookup"><span data-stu-id="960cd-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="960cd-222">Można dodać te Brak kolumn do DataTable w jeden z dwóch sposobów:</span><span class="sxs-lookup"><span data-stu-id="960cd-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="960cd-223">**Ręcznie** — kliknij prawym przyciskiem myszy na DataTable w Projektancie obiektów DataSet i z menu Dodaj, wybierz kolumnę.</span><span class="sxs-lookup"><span data-stu-id="960cd-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="960cd-224">Można następnie nazwa kolumny i odpowiednio ustawić jej właściwości.</span><span class="sxs-lookup"><span data-stu-id="960cd-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="960cd-225">**Automatycznie** — Kreator konfiguracji TableAdapter zaktualizuje kolumn tabeli DataTable s, aby odzwierciedlić pola, zwracany przez `SelectCommand` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="960cd-226">Korzystając z instrukcji SQL zapytań ad-hoc, Kreator spowoduje również usunięcie `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości od `SelectCommand` zawiera teraz `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="960cd-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="960cd-227">Jednak korzystając z procedur składowanych, te właściwości polecenia pozostają bez zmian.</span><span class="sxs-lookup"><span data-stu-id="960cd-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="960cd-228">Rozważyliśmy ręcznego dodawania kolumn tabeli DataTable w poprzednich samouczkach, w tym [Master/szczegółów przy użyciu punktowanej listy z rekordów głównych z kontrolką DataList szczegółów](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) i [przesyłanie plików](../working-with-binary-files/uploading-files-cs.md), a firma Microsoft będzie Obejrzyj ten proces ponownie bardziej szczegółowo w naszym samouczku dalej.</span><span class="sxs-lookup"><span data-stu-id="960cd-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="960cd-229">W tym samouczku jednak umożliwia automatyczne podejście za pomocą Kreatora konfiguracji TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="960cd-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="960cd-230">Rozpocznij, klikając prawym przyciskiem myszy `EmployeesTableAdapter` i wybierając pozycję Konfiguruj, z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="960cd-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="960cd-231">Otwarte Kreatora konfiguracji TableAdapter, który zawiera listę procedur składowanych, umożliwiający wybranie, wstawianie, aktualizowanie i usuwanie wraz z ich wartości zwracane i parametry (jeśli istnieje).</span><span class="sxs-lookup"><span data-stu-id="960cd-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="960cd-232">Na rysunku nr 10 przedstawiono tego kreatora.</span><span class="sxs-lookup"><span data-stu-id="960cd-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="960cd-233">W tym miejscu można widzimy, że `Employees_Select` przechowywane procedury teraz zwraca `ManagerFirstName` i `ManagerLastName` pola.</span><span class="sxs-lookup"><span data-stu-id="960cd-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="960cd-234">[![Kreator pokazuje listy kolumn zaktualizowane dla Employees_Select procedury składowanej](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="960cd-235">**Na rysunku nr 10**: Kreator pokazuje listy kolumn zaktualizowane dla `Employees_Select` Stored Procedure ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>


<span data-ttu-id="960cd-236">Ukończ pracę kreatora, klikając przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="960cd-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="960cd-237">Po powrocie do Projektanta obiektów DataSet `EmployeesDataTable` zawiera dwa dodatkowe kolumny: `ManagerFirstName` i `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="960cd-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="960cd-238">[![EmployeesDataTable zawiera dwie nowe kolumny](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="960cd-239">**Rysunek 11**: `EmployeesDataTable` Zawiera dwie nowe kolumny ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>


<span data-ttu-id="960cd-240">Aby zilustrować, że zaktualizowany `Employees_Select` procedury składowanej jest aktywna i czy wstawiania, aktualizowania i usuwania możliwości TableAdapter działają nadal, niech s, Utwórz stronę sieci web, która umożliwia użytkownikom wyświetlanie i usuwanie pracowników.</span><span class="sxs-lookup"><span data-stu-id="960cd-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="960cd-241">Przed utworzeniem taka strona, jednak należy najpierw utworzyć nową klasę w warstwy logiki biznesowej do pracy z pracownikami z `NorthwindWithSprocs` zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="960cd-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="960cd-242">W kroku 4, utworzymy `EmployeesBLLWithSprocs` klasy.</span><span class="sxs-lookup"><span data-stu-id="960cd-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="960cd-243">W kroku 5 użyjemy tej klasy ze strony programu ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="960cd-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="960cd-244">Krok 4. Implementowanie warstwy logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="960cd-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="960cd-245">Utwórz nowy plik klasy w `~/App_Code/BLL` folder o nazwie `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="960cd-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="960cd-246">Ta klasa naśladuje semantyki istniejącej `EmployeesBLL` klasy, tylko tym nowe jeden udostępnia metody mniej i używa `NorthwindWithSprocs` zestawu danych (zamiast `Northwind` zestawu danych).</span><span class="sxs-lookup"><span data-stu-id="960cd-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="960cd-247">Dodaj następujący kod do `EmployeesBLLWithSprocs` klasy.</span><span class="sxs-lookup"><span data-stu-id="960cd-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="960cd-248">`EmployeesBLLWithSprocs` Klasy s `Adapter` właściwość zwraca wystąpienie `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="960cd-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="960cd-249">Jest on używany przez klasy s `GetEmployees` i `DeleteEmployee` metody.</span><span class="sxs-lookup"><span data-stu-id="960cd-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="960cd-250">`GetEmployees` Wywołania metody `EmployeesTableAdapter` odpowiadającego s `GetEmployees` metody, która wywołuje `Employees_Select` procedury składowanej i wypełnia jego wyniki w `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="960cd-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="960cd-251">`DeleteEmployee` Podobnie wywołania metod `EmployeesTableAdapter` s `Delete` metody, która wywołuje `Employees_Delete` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="960cd-252">Krok 5. Praca z danymi w warstwie prezentacji</span><span class="sxs-lookup"><span data-stu-id="960cd-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="960cd-253">Za pomocą `EmployeesBLLWithSprocs` klasy kompletne, możemy ponownie gotowe do pracy z danymi pracowników przy użyciu strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="960cd-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="960cd-254">Otwórz `JOINs.aspx` strony w `AdvancedDAL` folder i przeciągnij GridView z przybornika w projektancie, ustawiając jego `ID` właściwość `Employees`.</span><span class="sxs-lookup"><span data-stu-id="960cd-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="960cd-255">Następnie za pomocą tagu inteligentnego s GridView powiązać siatki nowej kontrolki ObjectDataSource o nazwie `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="960cd-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="960cd-256">Konfigurowanie kontrolki ObjectDataSource używać `EmployeesBLLWithSprocs` klasy, a następnie z karty Wybierz i Usuń, upewnij się, że `GetEmployees` i `DeleteEmployee` metody są wybrane z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="960cd-257">Kliknij przycisk Zakończ, aby zakończyć konfigurowanie s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="960cd-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="960cd-258">[![Konfigurowanie kontrolki ObjectDataSource na korzystanie z klasy EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="960cd-259">**Rysunek 12**: Konfigurowanie kontrolki ObjectDataSource do użycia `EmployeesBLLWithSprocs` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>


<span data-ttu-id="960cd-260">[![Mogą używać kontrolki ObjectDataSource GetEmployees i metod DeleteEmployee](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="960cd-261">**Rysunek 13**: Mogą używać kontrolki ObjectDataSource `GetEmployees` i `DeleteEmployee` metody ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>


<span data-ttu-id="960cd-262">Program Visual Studio spowoduje to dodanie elementu BoundField do kontrolki GridView dla każdego z `EmployeesDataTable` s kolumn.</span><span class="sxs-lookup"><span data-stu-id="960cd-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="960cd-263">Usuń wszystkie te BoundFields, z wyjątkiem `Title`, `LastName`, `FirstName`, `ManagerFirstName`, i `ManagerLastName` i Zmień nazwę `HeaderText` właściwości dla ostatnich czterech BoundFields Last Name, imię, imię Menedżera s i Menedżer s nazwisko, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="960cd-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="960cd-264">Aby zezwolić użytkownikom na usuwanie pracowników z tej strony, musimy wykonać dwie czynności.</span><span class="sxs-lookup"><span data-stu-id="960cd-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="960cd-265">Po pierwsze poinstruuj GridView zapewnienie możliwości usuwania, zaznaczając opcję Włącz usuwanie, z jego tagu inteligentnego.</span><span class="sxs-lookup"><span data-stu-id="960cd-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="960cd-266">Po drugie, zmiana ObjectDataSource s `OldValuesParameterFormatString` z wartością ustawioną przez kreatora kontrolki ObjectDataSource (`original_{0}`) do wartości domyślnej (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="960cd-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="960cd-267">Po wprowadzeniu tych zmian, z kontrolkami GridView i kontrolki ObjectDataSource s oznaczeniu deklaracyjnym powinien wyglądać podobnie do poniższej:</span><span class="sxs-lookup"><span data-stu-id="960cd-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="960cd-268">Przetestowania strony, odwiedzając za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="960cd-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="960cd-269">Jak pokazano na rysunku 14, strony wyświetli listę każdego pracownika i Menedżera s imienia (przy założeniu, że mają one).</span><span class="sxs-lookup"><span data-stu-id="960cd-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="960cd-270">[![SPRZĘŻENIA w Employees_Select przechowywane procedury zwraca nazwę s Menedżera](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="960cd-271">**Rysunek 14**: `JOIN` w `Employees_Select` procedury składowanej zwraca Menedżera s Nazwa ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>


<span data-ttu-id="960cd-272">Kliknięcie przycisku Usuń rozpoczyna się usuwanie przepływu pracy, którą culminates w trakcie wykonania `Employees_Delete` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="960cd-273">Jednak próba dokonania `DELETE` instrukcji w procedurze składowanej zakończy się niepowodzeniem z powodu naruszenia ograniczenia klucza obcego (zobacz rysunek 15).</span><span class="sxs-lookup"><span data-stu-id="960cd-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="960cd-274">W szczególności każdy pracownik ma co najmniej jednego rekordu `Orders` tabeli, co powoduje usunięcie nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="960cd-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="960cd-275">[![Trwa usuwanie pracownika, który ma odpowiadające im wyniki zamówienia w naruszenie ograniczenia klucza obcego](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="960cd-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="960cd-276">**Rysunek 15**: Trwa usuwanie pracownika, który ma odpowiadające im wyniki zamówienia w naruszenie ograniczenia klucza obcego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="960cd-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>


<span data-ttu-id="960cd-277">Umożliwia pracownika usunięty użytkownik może:</span><span class="sxs-lookup"><span data-stu-id="960cd-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="960cd-278">Aktualizacja kaskadowo usuwa, ograniczenie klucza obcego</span><span class="sxs-lookup"><span data-stu-id="960cd-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="960cd-279">Ręcznie usuń rekordy z `Orders` tabeli dla pracowników do usunięcia, lub</span><span class="sxs-lookup"><span data-stu-id="960cd-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="960cd-280">Aktualizacja `Employees_Delete` najpierw usuń powiązane rekordy z procedury składowanej `Orders` tabeli przed usunięciem `Employees` rekordu.</span><span class="sxs-lookup"><span data-stu-id="960cd-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="960cd-281">Omówiliśmy tej techniki w [za pomocą istniejących procedur składowanych dla s wpisany zestaw danych TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="960cd-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="960cd-282">Można pozostawić to w charakterze ćwiczenia dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="960cd-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="960cd-283">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="960cd-283">Summary</span></span>

<span data-ttu-id="960cd-284">Podczas pracy z relacyjnych baz danych, często zapytania ich dane z wielu powiązanych tabelach.</span><span class="sxs-lookup"><span data-stu-id="960cd-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="960cd-285">Skorelowane podzapytań i `JOIN` s Podaj dwie techniki uzyskiwania dostępu do danych z powiązanych tabel w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="960cd-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="960cd-286">W poprzednich samouczkach najczęściej wprowadziliśmy użytkowania skorelowany podzapytań ponieważ TableAdapter nie może automatycznie wygenerować `INSERT`, `UPDATE`, i `DELETE` instrukcji zapytań obejmujących `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="960cd-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="960cd-287">Gdy te wartości można podać ręcznie, korzystając z instrukcji SQL zapytań ad-hoc, wszelkie dostosowania zostaną zastąpione po ukończeniu działania Kreatora konfiguracji TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="960cd-288">Na szczęście TableAdapters utworzone za pomocą procedur składowanych nie odczuwają kruchości ten sam, jak te utworzone za pomocą instrukcji SQL zapytań ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="960cd-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="960cd-289">Dlatego jest to możliwe, aby utworzyć obiekt TableAdapter używa których główne zapytanie `JOIN` korzystając z procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="960cd-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="960cd-290">W tym samouczku będziemy pokazaliśmy, jak utworzyć obiekt TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="960cd-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="960cd-291">Rozpoczęliśmy przy użyciu `JOIN`— mniej `SELECT` wyszukiwać TableAdapter s główne zapytanie tak, że odpowiednie insert, update i delete, przechowywane procedury utworzony automatycznie.</span><span class="sxs-lookup"><span data-stu-id="960cd-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="960cd-292">Za pomocą TableAdapter s konfiguracji początkowej pełną, firma Microsoft rozszerzone `SelectCommand` użyj procedury składowanej `JOIN` i ponownie uruchomiono kreatora konfiguracji TableAdapter w celu zaktualizowania `EmployeesDataTable` s kolumn.</span><span class="sxs-lookup"><span data-stu-id="960cd-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="960cd-293">Ponowne uruchomienie Kreatora konfiguracji TableAdapter, automatycznie aktualizowane `EmployeesDataTable` kolumny odzwierciedla pola danych zwracane przez `Employees_Select` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="960cd-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="960cd-294">Alternatywnie można dodaliśmy te kolumny ręcznie do elementu DataTable.</span><span class="sxs-lookup"><span data-stu-id="960cd-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="960cd-295">Przeanalizujemy ręczne dodawanie kolumn do DataTable w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="960cd-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="960cd-296">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="960cd-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="960cd-297">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="960cd-297">About the Author</span></span>

<span data-ttu-id="960cd-298">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="960cd-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="960cd-299">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="960cd-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="960cd-300">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="960cd-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="960cd-301">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="960cd-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="960cd-302">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="960cd-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="960cd-303">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="960cd-303">Special Thanks To</span></span>

<span data-ttu-id="960cd-304">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="960cd-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="960cd-305">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Hilton Geisenow, David Suru i Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="960cd-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="960cd-306">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="960cd-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="960cd-307">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="960cd-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="960cd-308">[Poprzednie](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [dalej](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="960cd-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>
