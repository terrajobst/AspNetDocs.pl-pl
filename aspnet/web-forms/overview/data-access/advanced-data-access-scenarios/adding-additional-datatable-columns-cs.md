---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
title: Dodawanie dodatkowych kolumn tabeli DataTableC#() | Microsoft Docs
author: rick-anderson
description: W przypadku tworzenia typu zestawu danych przy użyciu kreatora TableAdapter odpowiadający mu element DataTable zawiera kolumny zwrócone przez zapytanie głównej bazy danych. Jednak...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 615f3361-f21f-4338-8bc1-fce8ae071de9
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: a96f254aa54e7077456ac1a9bd6c5e2a17619d96
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74610686"
---
# <a name="adding-additional-datatable-columns-c"></a><span data-ttu-id="3ac6f-104">Dodawanie dodatkowych kolumn tabeli DataTable (C#)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-104">Adding Additional DataTable Columns (C#)</span></span>

<span data-ttu-id="3ac6f-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3ac6f-106">[Pobierz kod](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) lub [Pobierz plik PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) or [Download PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span></span>

> <span data-ttu-id="3ac6f-107">W przypadku tworzenia typu zestawu danych przy użyciu kreatora TableAdapter odpowiadający mu element DataTable zawiera kolumny zwrócone przez zapytanie głównej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="3ac6f-108">Zdarza się jednak, że element DataTable musi zawierać dodatkowe kolumny.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="3ac6f-109">W tym samouczku dowiesz się, dlaczego procedury składowane są zalecane, gdy potrzebne są dodatkowe kolumny tabeli DataTable.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="3ac6f-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="3ac6f-110">Introduction</span></span>

<span data-ttu-id="3ac6f-111">Podczas dodawania TableAdapter do określonego zestawu danych, odpowiadający schemat DataTable jest określany przez zapytanie główne TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="3ac6f-112">Na przykład, jeśli zapytanie główne zwraca pola danych *a*, *b*i *c*, element DataTable będzie miał trzy odpowiadające im kolumny o nazwie *a*, *b*i *c*. Oprócz jego głównego zapytania TableAdapter może zawierać dodatkowe zapytania, które zwracają, ewentualnie, podzestaw danych na podstawie pewnego parametru.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="3ac6f-113">Przykładowo oprócz zapytania głównego `ProductsTableAdapter` s, które zwraca informacje o wszystkich produktach, zawiera również metody takie jak `GetProductsByCategoryID(categoryID)` i `GetProductByProductID(productID)`, które zwracają informacje o produkcie na podstawie dostarczonego parametru.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="3ac6f-114">Model, w którym schemat elementu DataTable s odzwierciedla zapytanie główne TableAdapter s, działa prawidłowo, jeśli wszystkie metody TableAdapter s zwracają te same lub mniejsze pola danych niż określone w zapytaniu głównym.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="3ac6f-115">Jeśli metoda TableAdapter musi zwrócić dodatkowe pola danych, należy odpowiednio rozwinąć schemat DataTable.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="3ac6f-116">W obszarze [wzorzec/szczegóły przy użyciu listy punktowanej rekordów głównych z szczegółowym](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) samouczekem elementu DataList dodaliśmy metodę do `CategoriesTableAdapter`, która zwróciła `CategoryID`, `CategoryName`i `Description` pól danych zdefiniowanych w zapytaniu głównym i `NumberOfProducts`, dodatkowe pole danych, które zgłosiło liczbę produktów skojarzonych z każdą kategorią.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="3ac6f-117">Dodano ręcznie nową kolumnę do `CategoriesDataTable`, aby przechwycić wartość pola dane `NumberOfProducts` z tej nowej metody.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="3ac6f-118">Zgodnie z opisem w samouczku [przekazywanie plików](../working-with-binary-files/uploading-files-cs.md) należy zwrócić szczególną uwagę na TableAdapters, które korzystają z instrukcji SQL ad hoc i zawierają metody, których pola danych nie pasują dokładnie do głównej kwerendy.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-cs.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="3ac6f-119">Jeśli Kreator konfiguracji TableAdapter jest ponownie uruchamiany, zaktualizuje wszystkie metody TableAdapter, tak aby ich lista pól danych była zgodna z główną kwerendą.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="3ac6f-120">W związku z tym wszystkie metody z dostosowanymi listami kolumn zostaną przywrócone do głównej listy kolumn zapytania i nie zwróci oczekiwanych danych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="3ac6f-121">Ten problem nie występuje w przypadku korzystania z procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="3ac6f-122">W tym samouczku dowiesz się, jak zwiększyć schemat DataTable s w celu uwzględnienia dodatkowych kolumn.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="3ac6f-123">Ze względu na brittleness TableAdapter w przypadku korzystania z instrukcji SQL ad hoc w tym samouczku będziemy używać procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="3ac6f-124">Aby uzyskać więcej informacji na temat konfigurowania TableAdapter w celu korzystania z procedur składowanych, zapoznaj się z tematem [Tworzenie nowych procedur składowanych dla wpisanych zestawów danych s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) i [używanie istniejących procedur składowanych dla wpisanych zestawów danych s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) .</span><span class="sxs-lookup"><span data-stu-id="3ac6f-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="3ac6f-125">Krok 1. Dodawanie kolumny`PriceQuartile`do`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="3ac6f-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="3ac6f-126">W oknie *Tworzenie nowych procedur składowanych dla wpisanych danych TableAdapters* samouczek został utworzony zestaw danych o określonym typie o nazwie `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="3ac6f-127">Ten zestaw danych zawiera obecnie dwa tabele: `ProductsDataTable` i `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="3ac6f-128">`ProductsTableAdapter` ma trzy następujące metody:</span><span class="sxs-lookup"><span data-stu-id="3ac6f-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="3ac6f-129">`GetProducts` — główne zapytanie, które zwraca wszystkie rekordy z tabeli `Products`</span><span class="sxs-lookup"><span data-stu-id="3ac6f-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="3ac6f-130">`GetProductsByCategoryID(categoryID)` — zwraca wszystkie produkty z określonym *IDkategorii*.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="3ac6f-131">`GetProductByProductID(productID)` — zwraca konkretny produkt z określonym identyfikatorem *ProductID*.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="3ac6f-132">Główne zapytanie i dwie dodatkowe metody zwracają ten sam zestaw pól danych, a mianowicie wszystkie kolumny z tabeli `Products`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="3ac6f-133">Brak skorelowanych podkwerend lub `JOIN` s ściągające powiązane dane z tabel `Categories` lub `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="3ac6f-134">W związku z tym `ProductsDataTable` ma odpowiadającą kolumnę dla każdego pola w tabeli `Products`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="3ac6f-135">Na potrzeby tego samouczka Dodaj metodę do `ProductsTableAdapter` o nazwie `GetProductsWithPriceQuartile`, która zwraca wszystkie produkty.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="3ac6f-136">Oprócz standardowych pól danych produktu, `GetProductsWithPriceQuartile` również zawiera pole danych `PriceQuartile`, które wskazuje, na podstawie którego kwartyl cena produktu jest równa.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="3ac6f-137">Na przykład te produkty, których ceny znajdują się w najtańszym 25%, będą miały `PriceQuartile` wartość 1, natomiast te, których ceny przypadają na dole 25%, będą mieć wartość 4.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="3ac6f-138">Zanim przejdziemy do utworzenia procedury składowanej w celu zwrócenia tych informacji, najpierw musimy zaktualizować `ProductsDataTable`, aby uwzględnić kolumnę do przechowywania `PriceQuartile` wyników, gdy zostanie użyta metoda `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="3ac6f-139">Otwórz zestaw danych `NorthwindWithSprocs` i kliknij prawym przyciskiem myszy `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="3ac6f-140">Wybierz pozycję Dodaj z menu kontekstowego, a następnie wybierz kolumnę.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-140">Choose Add from the context-menu and then pick Column.</span></span>

<span data-ttu-id="3ac6f-141">[![dodać nowej kolumny do ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="3ac6f-142">**Rysunek 1**. Dodawanie nowej kolumny do `ProductsDataTable` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image3.png))</span></span>

<span data-ttu-id="3ac6f-143">Spowoduje to dodanie nowej kolumny do elementu DataTable o nazwie Kolumna1 typu `System.String`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="3ac6f-144">Musimy zaktualizować tę nazwę kolumny s do PriceQuartile i jej typ `System.Int32`, ponieważ będzie ona używana do przechowywania liczby z zakresu od 1 do 4.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="3ac6f-145">Wybierz nowo dodaną kolumnę w `ProductsDataTable` i, w okno Właściwości, ustaw właściwość `Name` na PriceQuartile oraz Właściwość `DataType` na `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>

<span data-ttu-id="3ac6f-146">[![ustawić nową nazwę kolumny s i właściwości DataType](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="3ac6f-147">**Rysunek 2**: ustaw nową kolumnę s `Name` i `DataType` właściwości ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image6.png))</span></span>

<span data-ttu-id="3ac6f-148">Jak pokazano na rysunku 2, istnieją dodatkowe właściwości, które można ustawić, na przykład czy wartości w kolumnie muszą być unikatowe, jeśli kolumna jest kolumną typu autoprzyrost, niezależnie od tego, czy wartości `NULL` bazy danych są dozwolone i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="3ac6f-149">Pozostaw te wartości domyślne.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="3ac6f-150">Krok 2. Tworzenie metody`GetProductsWithPriceQuartile`</span><span class="sxs-lookup"><span data-stu-id="3ac6f-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="3ac6f-151">Teraz, gdy `ProductsDataTable` zostało zaktualizowane w celu uwzględnienia kolumny `PriceQuartile`, jesteśmy gotowi do utworzenia metody `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3ac6f-152">Zacznij od kliknięcia prawym przyciskiem myszy TableAdapter i wybierz polecenie Dodaj zapytanie z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="3ac6f-153">Spowoduje to wyświetlenie Kreatora konfiguracji zapytania TableAdapter, który najpierw powiadamia nas o tym, czy chcemy użyć instrukcji SQL ad hoc, czy nowej lub istniejącej procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="3ac6f-154">Ponieważ nie mamy jeszcze procedury składowanej, która zwraca dane kwartyl ceny, zezwól TableAdapter na utworzenie tej procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="3ac6f-155">Wybierz opcję Utwórz nową procedurę składowaną, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-155">Select the Create new stored procedure option and click Next.</span></span>

<span data-ttu-id="3ac6f-156">[![nakazać kreatorowi TableAdapter utworzenie procedury składowanej dla nas](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="3ac6f-157">**Rysunek 3**. nakazuje kreatorowi TableAdapter utworzenie procedury składowanej dla nas ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image9.png))</span></span>

<span data-ttu-id="3ac6f-158">Na następnym ekranie przedstawionym na rysunku 4 Kreator pyta, jaki typ zapytania dodać.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="3ac6f-159">Ponieważ metoda `GetProductsWithPriceQuartile` zwróci wszystkie kolumny i rekordy z tabeli `Products`, zaznacz opcję Wybierz, która zwraca wiersze, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>

<span data-ttu-id="3ac6f-160">[![zapytanie będzie instrukcją SELECT, która zwraca wiele wierszy](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="3ac6f-161">**Ilustracja 4**. zapytanie będzie `SELECT` instrukcją zwracającą wiele wierszy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image12.png))</span></span>

<span data-ttu-id="3ac6f-162">Następnie zostanie wyświetlony monit o zapytanie `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="3ac6f-163">W Kreatorze wprowadź następujące zapytanie:</span><span class="sxs-lookup"><span data-stu-id="3ac6f-163">Enter the following query into the wizard:</span></span>

[!code-sql[Main](adding-additional-datatable-columns-cs/samples/sample1.sql)]

<span data-ttu-id="3ac6f-164">Powyższe zapytanie używa SQL Server 2005 s nowej [funkcji`NTILE`](https://msdn.microsoft.com/library/ms175126.aspx) , aby podzielić wyniki do czterech grup, w których grupy są określane przez `UnitPrice` wartości sortowane w kolejności malejącej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="3ac6f-165">Niestety Konstruktor zapytań nie wie, jak przeanalizować słowa kluczowego `OVER` i zostanie wyświetlony błąd podczas analizowania powyższego zapytania.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="3ac6f-166">W związku z tym Wprowadź powyższe zapytanie bezpośrednio w polu tekstowym kreatora, nie używając Konstruktor zapytań.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="3ac6f-167">Aby uzyskać więcej informacji na temat NTILE i SQL Server 2005 innych funkcji klasyfikacji, zobacz [zwracają rankingowe wyniki z Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) i [sekcji funkcje klasyfikacji](https://msdn.microsoft.com/library/ms189798.aspx) w [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>

<span data-ttu-id="3ac6f-168">Po wprowadzeniu kwerendy `SELECT` i kliknięciu przycisku Dalej Kreator poprosi nas o podanie nazwy procedury składowanej, która zostanie utworzona.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="3ac6f-169">Nazwij nową procedurę składowaną `Products_SelectWithPriceQuartile` a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>

<span data-ttu-id="3ac6f-170">[![nazwę procedury składowanej Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="3ac6f-171">**Rysunek 5**. Nazwij `Products_SelectWithPriceQuartile` procedury składowanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image15.png))</span></span>

<span data-ttu-id="3ac6f-172">Na koniec zostanie wyświetlony monit o podanie nazwy metod TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="3ac6f-173">Pozostaw zaznaczone pole wyboru Wypełnij DataTable i wróć do nich elementy CheckBox, a następnie nadaj im nazwę metody `FillWithPriceQuartile` i `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>

<span data-ttu-id="3ac6f-174">[![Nazwij metody TableAdapter s i kliknij przycisk Zakończ.](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="3ac6f-175">**Ilustracja 6**. Nazwij metody TableAdapter s i kliknij przycisk Zakończ ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image18.png))</span></span>

<span data-ttu-id="3ac6f-176">Po określeniu zapytania `SELECT` i procedurze składowanej oraz metodach TableAdapter o nazwie kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="3ac6f-177">W tym momencie może pojawić się ostrzeżenie lub dwa z kreatora z informacją, że `OVER` konstrukcja lub instrukcja SQL nie jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="3ac6f-178">Te ostrzeżenia można zignorować.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-178">These warnings can be ignored.</span></span>

<span data-ttu-id="3ac6f-179">Po zakończeniu działania kreatora TableAdapter powinien zawierać metody `FillWithPriceQuartile` i `GetProductsWithPriceQuartile`, a baza danych powinna zawierać procedurę przechowywaną o nazwie `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="3ac6f-180">Poświęć chwilę, aby sprawdzić, czy TableAdapter rzeczywiście zawiera tę nową metodę i czy procedura składowana została prawidłowo dodana do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="3ac6f-181">Jeśli podczas sprawdzania bazy danych nie widzisz procedury składowanej, kliknij prawym przyciskiem myszy folder procedury składowane i wybierz polecenie Odśwież.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>

![Sprawdź, czy nowa metoda została dodana do TableAdapter](adding-additional-datatable-columns-cs/_static/image19.png)

<span data-ttu-id="3ac6f-183">**Rysunek 7**. Sprawdzanie, czy nowa metoda została dodana do TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3ac6f-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>

<span data-ttu-id="3ac6f-184">[![upewnij się, że baza danych zawiera Products_SelectWithPriceQuartile procedury składowanej](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span></span>

<span data-ttu-id="3ac6f-185">**Ilustracja 8**. Upewnij się, że baza danych zawiera procedurę składowaną `Products_SelectWithPriceQuartile` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3ac6f-186">Jedną z korzyści wynikających z używania procedur składowanych zamiast instrukcji SQL ad hoc jest to, że ponowne uruchomienie Kreatora konfiguracji TableAdapter nie spowoduje modyfikacji list kolumn procedury składowane.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="3ac6f-187">Sprawdź to, klikając prawym przyciskiem myszy TableAdapter, wybierając opcję Konfiguruj z menu kontekstowego, aby uruchomić kreatora, a następnie kliknąć przycisk Zakończ, aby zakończyć pracę.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="3ac6f-188">Następnie przejdź do bazy danych i zapoznaj się z `Products_SelectWithPriceQuartile` procedurą składowaną.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="3ac6f-189">Należy pamiętać, że lista kolumn nie została zmodyfikowana.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="3ac6f-190">Czy korzystamy z instrukcji SQL ad hoc, ponowne uruchomienie Kreatora konfiguracji TableAdapter spowodowałoby przywrócenie listy kolumn zapytania s w celu dopasowania jej do głównej listy kolumn zapytania, a tym samym usunięcie instrukcji NTILE z zapytania używanego przez metodę `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>

<span data-ttu-id="3ac6f-191">Gdy metoda `GetProductsWithPriceQuartile` warstwy dostępu do danych jest wywoływana, TableAdapter wykonuje `Products_SelectWithPriceQuartile` procedurę składowaną i dodaje wiersz do `ProductsDataTable` dla każdego zwróconego rekordu.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="3ac6f-192">Pola danych zwracane przez procedurę składowaną są mapowane na kolumny `ProductsDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="3ac6f-193">Ponieważ istnieje pole danych `PriceQuartile` zwrócone z procedury składowanej, jego wartość jest przypisana do kolumny `ProductsDataTable` s `PriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="3ac6f-194">Dla tych metod TableAdapter, których zapytania nie zwracają pola danych `PriceQuartile`, wartość `PriceQuartile` kolumna s jest wartością określoną przez `DefaultValue` właściwości.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="3ac6f-195">Jak pokazano na rysunku 2, ta wartość jest ustawiana na `DBNull`, domyślnie.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="3ac6f-196">Jeśli wolisz inną wartość domyślną, po prostu Ustaw odpowiednio Właściwość `DefaultValue`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="3ac6f-197">Upewnij się, że wartość `DefaultValue` jest prawidłowa, przyjmując kolumnę s `DataType` (tj. `System.Int32` dla kolumny `PriceQuartile`).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="3ac6f-198">W tym momencie wykonamy kroki niezbędne do dodania dodatkowej kolumny do elementu DataTable.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="3ac6f-199">Aby sprawdzić, czy ta dodatkowa kolumna działa zgodnie z oczekiwaniami, należy utworzyć stronę ASP.NET, która wyświetla wszystkie nazwy produktów, ceny i kwartyl cen.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="3ac6f-200">Przed wykonaniem tej czynności najpierw należy zaktualizować warstwę logiki biznesowej w celu uwzględnienia metody wywołującej metodę DAL `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3ac6f-201">Będziemy aktualizować LOGIKI biznesowej dalej, w kroku 3, a następnie utworzyć stronę ASP.NET w kroku 4.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="3ac6f-202">Krok 3. Rozszerzanie warstwy logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="3ac6f-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="3ac6f-203">Przed użyciem nowej metody `GetProductsWithPriceQuartile` z warstwy prezentacji należy najpierw dodać odpowiednią metodę do LOGIKI biznesowej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="3ac6f-204">Otwórz plik klasy `ProductsBLLWithSprocs` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="3ac6f-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>

[!code-csharp[Main](adding-additional-datatable-columns-cs/samples/sample2.cs)]

<span data-ttu-id="3ac6f-205">Podobnie jak w przypadku innych metod pobierania danych w `ProductsBLLWithSprocs`, Metoda `GetProductsWithPriceQuartile` po prostu wywołuje metodę `GetProductsWithPriceQuartile` odpowiadającą DAL i zwraca wyniki.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="3ac6f-206">Krok 4. Wyświetlanie informacji o kwartyl cen na stronie sieci Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="3ac6f-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="3ac6f-207">Po dodaniu LOGIKI BIZNESOWEJu wszystko gotowe do utworzenia strony ASP.NET, która pokazuje KWARTYL cenowe dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="3ac6f-208">Otwórz stronę `AddingColumns.aspx` w folderze `AdvancedDAL` i przeciągnij widok GridView z przybornika do projektanta, ustawiając jego właściwość `ID` na `Products`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="3ac6f-209">Z tagu inteligentnego GridView s powiąż go z nowym elementem ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="3ac6f-210">Skonfiguruj element ObjectDataSource, aby używał metody `GetProductsWithPriceQuartile` `ProductsBLLWithSprocs` Class.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3ac6f-211">Ponieważ będzie to siatka tylko do odczytu, Ustaw listę rozwijaną na kartach Aktualizuj, Wstaw i Usuń na wartość (brak).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="3ac6f-212">[![skonfigurować element ObjectDataSource do używania klasy ProductsBLLWithSprocs](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span></span>

<span data-ttu-id="3ac6f-213">**Ilustracja 9**. Konfigurowanie elementu ObjectDataSource do używania klasy `ProductsBLLWithSprocs` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image25.png))</span></span>

<span data-ttu-id="3ac6f-214">[![pobrać informacji o produkcie z metody GetProductsWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span></span>

<span data-ttu-id="3ac6f-215">**Ilustracja 10**. Pobieranie informacji o produkcie z metody `GetProductsWithPriceQuartile` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image28.png))</span></span>

<span data-ttu-id="3ac6f-216">Po zakończeniu działania Kreatora konfiguracji źródła danych program Visual Studio automatycznie doda element BoundField lub CheckBoxField do widoku GridView dla każdego z pól danych zwracanych przez metodę.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="3ac6f-217">Jedno z tych pól danych jest `PriceQuartile`, które jest kolumną dodaną do `ProductsDataTable` w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="3ac6f-218">Edytuj pola GridView, usuwając wszystkie elementy oprócz `ProductName`, `UnitPrice`i `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="3ac6f-219">Skonfiguruj `UnitPrice` BoundField, aby sformatować jego wartość jako walutę i mieć odpowiednio `UnitPrice` i `PriceQuartile` BoundFields i wyrównane do prawej strony.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="3ac6f-220">Na koniec zaktualizuj odpowiednio pozostałe właściwości `HeaderText` BoundFields do produktu, ceny i kwartyl.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="3ac6f-221">Zaznacz również pole wyboru Włącz sortowanie w tagu inteligentnym GridView.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="3ac6f-222">Po wprowadzeniu tych zmian znaczniki deklaratywne GridView i ObjectDataSource s powinny wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="3ac6f-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-additional-datatable-columns-cs/samples/sample3.aspx)]

<span data-ttu-id="3ac6f-223">Rysunek 11 przedstawia Tę stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="3ac6f-224">Należy pamiętać, że początkowo produkty są uporządkowane według ich cen w kolejności malejącej, przy czym każdy produkt ma przypisaną odpowiednią wartość `PriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="3ac6f-225">Oczywiście te dane mogą być sortowane według innych kryteriów z wartością kolumny kwartyl, która nadal odzwierciedla klasyfikację produktu w odniesieniu do ceny (patrz rysunek 12).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>

<span data-ttu-id="3ac6f-226">[![produkty są uporządkowane według ich cen](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span></span>

<span data-ttu-id="3ac6f-227">**Ilustracja 11**. produkty są uporządkowane według ich cen ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image31.png))</span></span>

<span data-ttu-id="3ac6f-228">[![produkty są uporządkowane według ich nazw](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span></span>

<span data-ttu-id="3ac6f-229">**Ilustracja 12**. produkty są uporządkowane według ich nazw ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="3ac6f-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image34.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3ac6f-230">Za pomocą kilku wierszy kodu możemy rozszerzyć widok GridView, aby kolorować wiersze produktu na podstawie ich wartości `PriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="3ac6f-231">Możemy pokolorować te produkty w pierwszej kwartyl w kolorze zielonym, które w drugim kwartyl są żółte i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="3ac6f-232">Zachęcam do Poświęć chwilę na dodanie tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="3ac6f-233">Jeśli potrzebujesz odświeżacza na potrzeby formatowania widoku GridView, zapoznaj się z tematem [formatowanie niestandardowe na podstawie](../custom-formatting/custom-formatting-based-upon-data-cs.md) samouczka dotyczącego danych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>

## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="3ac6f-234">Alternatywne podejście — Tworzenie innego TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3ac6f-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="3ac6f-235">Jak widać w tym samouczku, podczas dodawania metody do TableAdapter, która zwraca pola danych inne niż te, które są wpisane przez zapytanie główne, możemy dodać odpowiednie kolumny do tabeli DataTable.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="3ac6f-236">Takie podejście jednak również działa tylko wtedy, gdy istnieje niewielka liczba metod w TableAdapter, które zwracają różne pola danych i jeśli te alternatywne pola danych nie różnią się zbyt wiele od głównej kwerendy.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="3ac6f-237">Zamiast dodawać kolumny do tabeli DataTable, można dodać kolejną TableAdapter do zestawu danych, który zawiera metody z pierwszego TableAdapter, które zwracają różne pola danych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="3ac6f-238">W tym samouczku zamiast dodawania kolumny `PriceQuartile` do `ProductsDataTable` (gdzie jest używana tylko przez metodę `GetProductsWithPriceQuartile`), możemy dodać dodatkowe TableAdapter do zestawu danych o nazwie `ProductsWithPriceQuartileTableAdapter`, który użył procedury składowanej `Products_SelectWithPriceQuartile` jako głównej kwerendy.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="3ac6f-239">ASP.NET strony, które są konieczne do uzyskania informacji o produkcie, użyj `ProductsWithPriceQuartileTableAdapter`, podczas gdy te, które nie mogły nadal korzystać z `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="3ac6f-240">Po dodaniu nowego TableAdapter, tabele danych pozostają untarnished i ich kolumny są precyzyjnie dublowane, zwracane przez ich metody TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="3ac6f-241">Jednak dodatkowe TableAdapters mogą wprowadzać powtarzające się zadania i funkcje.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="3ac6f-242">Na przykład, jeśli te strony ASP.NET, które wyświetlają kolumnę `PriceQuartile`, również potrzebne do zapewnienia obsługi instrukcji INSERT, Update i DELETE, `ProductsWithPriceQuartileTableAdapter` muszą mieć prawidłowo skonfigurowane właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="3ac6f-243">Chociaż te właściwości spowodują odbicie `ProductsTableAdapter` s, ta konfiguracja wprowadza dodatkowy krok.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="3ac6f-244">Ponadto istnieją dwa sposoby aktualizowania, usuwania lub dodawania produktu do bazy danych — za pomocą klas `ProductsTableAdapter` i `ProductsWithPriceQuartileTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="3ac6f-245">Pobranie dla tego samouczka zawiera klasę `ProductsWithPriceQuartileTableAdapter` w `NorthwindWithSprocs` zestawie danych, który ilustruje to alternatywne podejście.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="3ac6f-246">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="3ac6f-246">Summary</span></span>

<span data-ttu-id="3ac6f-247">W większości scenariuszy wszystkie metody w TableAdapter będą zwracać ten sam zestaw pól danych, ale istnieją sytuacje, w których dana metoda lub dwie mogą wymagać zwrócenia pola dodatkowego.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="3ac6f-248">Na przykład w przypadku [wzorca/szczegółów przy użyciu listy punktowanej rekordów głównych z szczegółowym](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) samouczekem elementu DataList dodaliśmy metodę do `CategoriesTableAdapter`, która oprócz pól danych głównego zapytania nie zwróciła pola `NumberOfProducts`, które zgłosiło liczbę produktów skojarzonych z każdą kategorią.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="3ac6f-249">W tym samouczku dodaliśmy metodę dodawania metody do `ProductsTableAdapter`, która zwróciła pole `PriceQuartile` jako uzupełnienie głównych pól danych zapytania.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="3ac6f-250">Aby przechwytywać dodatkowe pola danych zwracane przez metody TableAdapter, należy dodać odpowiednie kolumny do elementu DataTable.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="3ac6f-251">Jeśli planujesz Ręczne dodawanie kolumn do elementu DataTable, zaleca się, aby TableAdapter używać procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="3ac6f-252">Jeśli TableAdapter używa instrukcji ad-hoc SQL, za każdym razem, gdy Kreator konfiguracji TableAdapter zostanie uruchomiony wszystkie listy pól danych metody Przywróć do pól danych zwracanych przez zapytanie główne.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="3ac6f-253">Ten problem nie obejmuje procedur składowanych, dlatego zaleca się ich użycie w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="3ac6f-254">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="3ac6f-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3ac6f-255">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="3ac6f-255">About the Author</span></span>

<span data-ttu-id="3ac6f-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3ac6f-257">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3ac6f-258">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3ac6f-259">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3ac6f-260">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3ac6f-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3ac6f-261">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="3ac6f-261">Special Thanks To</span></span>

<span data-ttu-id="3ac6f-262">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3ac6f-263">Recenzenci liderzy dla tego samouczka to Randy Schmidt, Jacky Goor, Bernadette Leigh i Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="3ac6f-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="3ac6f-264">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="3ac6f-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3ac6f-265">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3ac6f-266">[Poprzednie](updating-the-tableadapter-to-use-joins-cs.md)
> [dalej](working-with-computed-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="3ac6f-266">[Previous](updating-the-tableadapter-to-use-joins-cs.md)
[Next](working-with-computed-columns-cs.md)</span></span>
