---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
title: Dodawanie dodatkowych kolumn tabeli DataTable (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Podczas korzystania z Kreatora TableAdapter, aby utworzyć zestaw danych z kontrolą typów, odpowiedniego elementu DataTable zawiera kolumny zwracane przez zapytanie głównej bazy danych. Ale tam...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 615f3361-f21f-4338-8bc1-fce8ae071de9
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 1e1751c6969f1a278ee438c3bee6171644aacdbf
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59406187"
---
# <a name="adding-additional-datatable-columns-c"></a><span data-ttu-id="0a336-104">Dodawanie dodatkowych kolumn tabeli DataTable (C#)</span><span class="sxs-lookup"><span data-stu-id="0a336-104">Adding Additional DataTable Columns (C#)</span></span>

<span data-ttu-id="0a336-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0a336-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0a336-106">[Pobierz program Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) lub [Pobierz plik PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0a336-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) or [Download PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span></span>

> <span data-ttu-id="0a336-107">Podczas korzystania z Kreatora TableAdapter, aby utworzyć zestaw danych z kontrolą typów, odpowiedniego elementu DataTable zawiera kolumny zwracane przez zapytanie głównej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="0a336-108">Jednak istnieją sytuacje, gdy DataTable musi zawierać dodatkowe kolumny.</span><span class="sxs-lookup"><span data-stu-id="0a336-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="0a336-109">W tym samouczku dowie się, dlaczego procedury składowane są zalecane, jeśli zaistnieje taka potrzeba dodatkowych kolumn tabeli DataTable.</span><span class="sxs-lookup"><span data-stu-id="0a336-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="0a336-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="0a336-110">Introduction</span></span>

<span data-ttu-id="0a336-111">Podczas dodawania TableAdapter z zestawem danych z kontrolą typów, odpowiedni schemat s DataTable jest określany przez główne zapytanie TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="0a336-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="0a336-112">Na przykład, jeśli główne zapytanie zwraca pola danych *A*, *B*, i *C*, DataTable będzie mieć trzy odpowiednie kolumny o nazwie *A*, *B*, i *C*. Oprócz jego główne zapytanie TableAdapter może zawierać dodatkowe zapytania, które zwracają, podzbiór danych na podstawie niektórych parametru.</span><span class="sxs-lookup"><span data-stu-id="0a336-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="0a336-113">Na przykład, w uzupełnieniu do `ProductsTableAdapter` główne zapytanie s, która zwraca informacje o produktach, zawiera ona także metod, takich jak `GetProductsByCategoryID(categoryID)` i `GetProductByProductID(productID)`, które zwracają informacje określonego produktu, oparte na podany parametr.</span><span class="sxs-lookup"><span data-stu-id="0a336-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="0a336-114">Model o schematu s DataTable odzwierciedlają TableAdapter s główne zapytanie działa dobrze, jeśli wszystkie metody TableAdapter s zwracać taki sam lub mniej niż określone w głównym zapytaniu pól.</span><span class="sxs-lookup"><span data-stu-id="0a336-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="0a336-115">Jeśli metoda TableAdapter musi zwrócić dodatkowe pola danych, następnie należy rozwijania schematu elementu DataTable s odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="0a336-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="0a336-116">W [Master/szczegółów przy użyciu punktowanej listy z rekordów głównych z kontrolką DataList szczegółów](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) samouczek dodaliśmy metodę `CategoriesTableAdapter` zwróconą `CategoryID`, `CategoryName`, i `Description` pól danych zdefiniowanych w główne zapytanie plus `NumberOfProducts`, pola dodatkowe dane, które podać liczbę produktów skojarzonych z każdej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0a336-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="0a336-117">Ręcznie dodaliśmy nową kolumnę, aby `CategoriesDataTable` w celu przechwycenia `NumberOfProducts` wartość z tej nowej metody pola danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="0a336-118">Zgodnie z opisem w [przesyłanie plików](../working-with-binary-files/uploading-files-cs.md) samouczek, doskonałe należy uważać za pomocą adapterów TableAdapter, użyj instrukcji SQL zapytań ad-hoc, która ma metody pól danych, których nie są dokładnie zgodne główne zapytanie.</span><span class="sxs-lookup"><span data-stu-id="0a336-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-cs.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="0a336-119">Jeśli Kreator konfiguracji TableAdapter zostanie ponownie uruchomione, jego zaktualizuje wszystkie metody TableAdapter s tak, aby ich lista pól danych odpowiada główne zapytanie.</span><span class="sxs-lookup"><span data-stu-id="0a336-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="0a336-120">W związku z tym wszystkie metody, przy użyciu kolumn niestandardowych list powrócić do listy kolumn główne zapytanie s i nie zwraca oczekiwanych danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="0a336-121">Ten problem nie występuje, gdy za pomocą procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0a336-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="0a336-122">W tym samouczku przedstawiony zostanie sposób rozszerzyć schemat s DataTable w celu uwzględnienia dodatkowych kolumn.</span><span class="sxs-lookup"><span data-stu-id="0a336-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="0a336-123">Z powodu kruchości TableAdapter, korzystając z instrukcji SQL zapytań ad-hoc w tym samouczku użyjemy procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0a336-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="0a336-124">Zapoznaj się [tworzenie nowych procedur składowanych dla s wpisany zestaw danych TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) i [za pomocą istniejących procedur składowanych dla s wpisany zestaw danych TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) samouczki, aby uzyskać więcej informacji na temat Konfigurowanie TableAdapter na używanie procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0a336-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="0a336-125">Krok 1. Dodawanie`PriceQuartile`kolumny`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="0a336-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="0a336-126">W *tworzenie nowych procedur składowanych dla s wpisany zestaw danych TableAdapters* samouczku utworzyliśmy wpisany zestaw danych o nazwie `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="0a336-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="0a336-127">Ten zestaw danych zawiera obecnie dwie DataTable: `ProductsDataTable` i `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0a336-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="0a336-128">`ProductsTableAdapter` Ma następujące trzy metody:</span><span class="sxs-lookup"><span data-stu-id="0a336-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="0a336-129">`GetProducts` -główne zapytanie zwraca wszystkie rekordy z `Products` tabeli</span><span class="sxs-lookup"><span data-stu-id="0a336-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="0a336-130">`GetProductsByCategoryID(categoryID)` -Zwraca wszystkie produkty z określonym *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="0a336-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="0a336-131">`GetProductByProductID(productID)` — Zwraca iloczyn danego z określonym *productID*.</span><span class="sxs-lookup"><span data-stu-id="0a336-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="0a336-132">Główne zapytanie i dwie dodatkowe metody wszystkie zwracać ten sam zestaw pól danych, a mianowicie wszystkie kolumny z `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0a336-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="0a336-133">Nie ma żadnych skorelowany podzapytania lub `JOIN` s ściągania danych powiązanych z `Categories` lub `Suppliers` tabel.</span><span class="sxs-lookup"><span data-stu-id="0a336-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="0a336-134">W związku z tym `ProductsDataTable` ma odpowiadającej mu kolumny dla każdego pola w `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="0a336-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="0a336-135">W tym samouczku umożliwiają s Dodaj metodę, która `ProductsTableAdapter` o nazwie `GetProductsWithPriceQuartile` zwracającego wszystkie produkty.</span><span class="sxs-lookup"><span data-stu-id="0a336-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="0a336-136">Oprócz pól danych Standardowy produkt w `GetProductsWithPriceQuartile` będą również zawierać `PriceQuartile` pola danych, która wskazuje, w ramach której kwartyl cena produktu s mieści się.</span><span class="sxs-lookup"><span data-stu-id="0a336-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="0a336-137">Na przykład mieć tych produktów, których ceny są podane w najbardziej kosztowne 25% `PriceQuartile` wartość 1, natomiast te, których ceny mieszczą się w dolnej 25% będzie miał wartość 4.</span><span class="sxs-lookup"><span data-stu-id="0a336-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="0a336-138">Zanim firma martwić o Tworzenie procedury składowanej do zwracania tych informacji, jednak najpierw musimy zaktualizować `ProductsDataTable` aby zawierała kolumnę zawierającą `PriceQuartile` wyniki podczas `GetProductsWithPriceQuartile` metoda jest używana.</span><span class="sxs-lookup"><span data-stu-id="0a336-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="0a336-139">Otwórz `NorthwindWithSprocs` zestawu danych i kliknij prawym przyciskiem myszy `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0a336-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="0a336-140">Z menu kontekstowego wybierz polecenie Dodaj, a następnie wybierz kolumnę.</span><span class="sxs-lookup"><span data-stu-id="0a336-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="0a336-141">[![Dodaj nową kolumnę do ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="0a336-142">**Rysunek 1**: Dodaj nową kolumnę, aby `ProductsDataTable` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="0a336-143">Spowoduje to dodanie nowej kolumny do DataTable o nazwie Kolumna1 typu `System.String`.</span><span class="sxs-lookup"><span data-stu-id="0a336-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="0a336-144">Należy zaktualizować nazwę tej kolumny s PriceQuartile i jej typ `System.Int32` ponieważ będą używane do przechowywania liczbą z przedziału od 1 do 4.</span><span class="sxs-lookup"><span data-stu-id="0a336-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="0a336-145">Wybierz kolumnę nowo dodane w `ProductsDataTable` i w oknie właściwości ustaw `Name` właściwości PriceQuartile i `DataType` właściwość `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="0a336-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="0a336-146">[![Ustaw nową nazwę s kolumny i właściwości typu danych](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="0a336-147">**Rysunek 2**: Ustaw s nową kolumnę `Name` i `DataType` właściwości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image6.png))</span></span>


<span data-ttu-id="0a336-148">Jak pokazano na rysunku 2, istnieją dodatkowe właściwości, które można ustawić, takie jak czy muszą być unikatowe, jeśli kolumna jest kolumną automatycznego przyrostu wartości w kolumnie, czy baza danych `NULL` wartości są dozwolone i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="0a336-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="0a336-149">Należy pozostawić te wartości ustawione na ich wartości domyślne.</span><span class="sxs-lookup"><span data-stu-id="0a336-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="0a336-150">Krok 2. Tworzenie`GetProductsWithPriceQuartile`— metoda</span><span class="sxs-lookup"><span data-stu-id="0a336-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="0a336-151">Teraz, gdy `ProductsDataTable` został zaktualizowany w celu uwzględnienia `PriceQuartile` kolumny, możemy przystąpić do tworzenia `GetProductsWithPriceQuartile` metody.</span><span class="sxs-lookup"><span data-stu-id="0a336-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0a336-152">Rozpocznij, klikając prawym przyciskiem myszy na obiekt TableAdapter i wybierając pozycję Dodaj zapytanie, z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="0a336-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="0a336-153">Otwarte Kreatora konfiguracji zapytania TableAdapter najpierw żąda nam do tego, czy chcemy użyć instrukcji SQL zapytań ad-hoc lub nowej lub istniejącej procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="0a336-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="0a336-154">Ponieważ firma Microsoft don t jeszcze mają procedury przechowywanej, która zwraca dane kwartyl ceny, umożliwiają s Zezwalaj TableAdapter utworzyć tę procedurę składowaną dla nas.</span><span class="sxs-lookup"><span data-stu-id="0a336-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="0a336-155">Wybierz opcję tworzenia nowej procedury składowanej, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0a336-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="0a336-156">[![Poinstruuj kreatora TableAdapter, aby utworzyć procedurę składowaną dla nas](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="0a336-157">**Rysunek 3**: Poinstruuj kreatora TableAdapter w celu utworzenia przechowywane procedury dla nas ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="0a336-158">Kolejne na ekranie pokazano na rysunku 4 Kreator zapyta, nam jakiego typu zapytania do dodania.</span><span class="sxs-lookup"><span data-stu-id="0a336-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="0a336-159">Ponieważ `GetProductsWithPriceQuartile` metoda zwróci wszystkie kolumny i rekordy z `Products` tabeli, wybierz pozycję, która zwraca wiersze opcji, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0a336-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="0a336-160">[![Zapytanie będzie instrukcję SELECT tego zwraca wiele wierszy](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="0a336-161">**Rysunek 4**: Nasze zapytania będą `SELECT` instrukcji tego zwraca wiele wierszy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="0a336-162">Następnie możemy monit o podanie `SELECT` zapytania.</span><span class="sxs-lookup"><span data-stu-id="0a336-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="0a336-163">W kreatorze, wprowadź następujące zapytanie:</span><span class="sxs-lookup"><span data-stu-id="0a336-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-cs/samples/sample1.sql)]

<span data-ttu-id="0a336-164">Powyższe zapytanie używa programu SQL Server 2005 s nowego [ `NTILE` funkcja](https://msdn.microsoft.com/library/ms175126.aspx) podzielić wyniki na cztery grupy, w której grupy są określane przez `UnitPrice` wartości posortowane w kolejności malejącej.</span><span class="sxs-lookup"><span data-stu-id="0a336-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="0a336-165">Niestety, Konstruktor kwerend nie wie jak przeanalizować `OVER` — słowo kluczowe i zostanie wyświetlony błąd podczas analizowania powyższym zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="0a336-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="0a336-166">W związku z tym należy wprowadzić powyżej zapytania bezpośrednio w polu tekstowym w kreatorze, bez przy użyciu konstruktora zapytań.</span><span class="sxs-lookup"><span data-stu-id="0a336-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="0a336-167">Więcej informacji na temat s NTILE i SQL Server 2005 innych funkcji klasyfikacji, zobacz [zwracanie wyników randze spośród wszystkich dokumentów przy użyciu programu Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) i [sekcji funkcji Klasyfikacja](https://msdn.microsoft.com/library/ms189798.aspx) z [SQL Server 2005 — książki Online](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="0a336-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="0a336-168">Po wprowadzeniu `SELECT` zapytań i kliknięciu przycisku Dalej, Kreator zapyta nam podać nazwę dla procedury składowanej, zostanie utworzony.</span><span class="sxs-lookup"><span data-stu-id="0a336-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="0a336-169">Nadaj nazwę nowej procedury składowanej `Products_SelectWithPriceQuartile` i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="0a336-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="0a336-170">[![Nazwa Products_SelectWithPriceQuartile procedury składowanej](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="0a336-171">**Rysunek 5**: Nazwa procedury składowanej `Products_SelectWithPriceQuartile` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="0a336-172">Ponadto firma Microsoft jest monit o podanie nazwy metody TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="0a336-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="0a336-173">Pozostaw zarówno wypełnienia DataTable i zwraca DataTable pól wyboru zaznaczone i nazwę metody `FillWithPriceQuartile` i `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="0a336-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="0a336-174">[![Nazwa TableAdapter s metody i kliknij przycisk Zakończ](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="0a336-175">**Rysunek 6**: Nazwa metody s TableAdapter, a następnie kliknij przycisk Zakończ ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="0a336-176">Za pomocą `SELECT` określone zapytanie i procedur składowanych i metody TableAdapter, nosi nazwę, kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="0a336-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="0a336-177">W tym momencie możesz otrzymać ostrzeżenie lub dwóch od kreatora informacją, że `OVER` instrukcji lub konstrukcji SQL nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="0a336-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="0a336-178">Można zignorować te ostrzeżenia.</span><span class="sxs-lookup"><span data-stu-id="0a336-178">These warnings can be ignored.</span></span>

<span data-ttu-id="0a336-179">Po ukończeniu kreatora, powinien zawierać TableAdapter `FillWithPriceQuartile` i `GetProductsWithPriceQuartile` metod i baza danych powinna zawierać procedury składowanej o nazwie `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="0a336-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="0a336-180">Poświęć chwilę, aby sprawdzić, że TableAdapter w rzeczywistości zawiera ta nowa metoda i czy procedura składowana została poprawnie dodane do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="0a336-181">Podczas sprawdzania bazy danych, jeśli nie widzisz procedury składowanej spróbuj kliknij prawym przyciskiem myszy folder procedur składowanych i wybieranie pozycji Odśwież.</span><span class="sxs-lookup"><span data-stu-id="0a336-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Sprawdź, czy nowa metoda został dodany do elementu TableAdapter](adding-additional-datatable-columns-cs/_static/image19.png)

<span data-ttu-id="0a336-183">**Rysunek 7**: Sprawdź, czy nowa metoda został dodany do elementu TableAdapter</span><span class="sxs-lookup"><span data-stu-id="0a336-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="0a336-184">[![Upewnij się, że baza danych zawiera Products_SelectWithPriceQuartile procedury składowanej](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)</span></span>

<span data-ttu-id="0a336-185">**Rysunek 8**: Upewnij się, że baza danych zawiera `Products_SelectWithPriceQuartile` Stored Procedure ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0a336-186">Jest jedną z zalet przy użyciu procedur składowanych zamiast instrukcji SQL zapytań ad-hoc, że ponowne uruchomienie Kreatora konfiguracji TableAdapter nie zmodyfikuje listę kolumn procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0a336-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="0a336-187">To sprawdzić przez kliknięcie prawym przyciskiem myszy na obiekt TableAdapter, wybranie opcji konfiguracji z menu kontekstowego, aby uruchomić kreatora, a następnie klikając Zakończ, aby go ukończyć.</span><span class="sxs-lookup"><span data-stu-id="0a336-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="0a336-188">Następnie przejdź do bazy danych i widok `Products_SelectWithPriceQuartile` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="0a336-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="0a336-189">Należy pamiętać, że jego lista kolumn nie zostały zmodyfikowane.</span><span class="sxs-lookup"><span data-stu-id="0a336-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="0a336-190">Miał zostały używamy instrukcji SQL zapytań ad-hoc, ponownego uruchamiania Kreatora konfiguracji TableAdapter będzie mieć przywrócono tej listy kolumny zapytania s odpowiada liście kolumn główne zapytanie, usuwając instrukcji NTILE z zapytania używanego przez `GetProductsWithPriceQuartile` metody.</span><span class="sxs-lookup"><span data-stu-id="0a336-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="0a336-191">Gdy s warstwy dostępu do danych `GetProductsWithPriceQuartile` metoda jest wywoływana, wykonuje TableAdapter `Products_SelectWithPriceQuartile` procedury składowanej i dodaje wiersz, aby `ProductsDataTable` dla każdego zwrócił rekordu.</span><span class="sxs-lookup"><span data-stu-id="0a336-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="0a336-192">Pola danych zwracane przez procedurę składowaną są mapowane do `ProductsDataTable` s kolumn.</span><span class="sxs-lookup"><span data-stu-id="0a336-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="0a336-193">Ponieważ `PriceQuartile` pola danych zwracane z procedury składowanej, jego wartość jest przypisywana do `ProductsDataTable` s `PriceQuartile` kolumny.</span><span class="sxs-lookup"><span data-stu-id="0a336-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="0a336-194">Te metody TableAdapter, których zapytania nie zwracają `PriceQuartile` pola danych `PriceQuartile` wartość kolumny s jest wartość określoną przez jego `DefaultValue` właściwości.</span><span class="sxs-lookup"><span data-stu-id="0a336-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="0a336-195">Jak pokazano na rysunku 2, ta wartość jest równa `DBNull`, wartość domyślna.</span><span class="sxs-lookup"><span data-stu-id="0a336-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="0a336-196">Jeśli chcesz użyć innej wartości domyślnej, po prostu ustaw `DefaultValue` właściwość odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="0a336-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="0a336-197">Po prostu upewnij się, że `DefaultValue` wartość jest prawidłowa, biorąc pod uwagę kolumny s `DataType` (czyli `System.Int32` dla `PriceQuartile` kolumny).</span><span class="sxs-lookup"><span data-stu-id="0a336-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="0a336-198">Na tym etapie firma Microsoft wykonano czynności niezbędne do dodawania dodatkową kolumnę do elementu DataTable.</span><span class="sxs-lookup"><span data-stu-id="0a336-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="0a336-199">Aby sprawdzić, czy w tej kolumnie dodatkowe działa zgodnie z oczekiwaniami, zezwala s Tworzenie strony ASP.NET, która wyświetla każdego produktu, Nazwa s, ceny i kwartyl ceny.</span><span class="sxs-lookup"><span data-stu-id="0a336-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="0a336-200">Zanim do tego, jednak najpierw musimy zaktualizować warstwę logiki biznesowej do uwzględnienia metodą, która wywołuje w dół do DAL s `GetProductsWithPriceQuartile` metody.</span><span class="sxs-lookup"><span data-stu-id="0a336-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0a336-201">Firma Microsoft następnie aktualizowane LOGIKI w kroku 3 i następnie utwórz strony programu ASP.NET w kroku 4.</span><span class="sxs-lookup"><span data-stu-id="0a336-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="0a336-202">Krok 3. Przestarzałe, warstwę logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="0a336-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="0a336-203">Zanim użyjemy nowy `GetProductsWithPriceQuartile` metody z warstwy prezentacji, należy najpierw dodamy odpowiedniej metody do LOGIKI.</span><span class="sxs-lookup"><span data-stu-id="0a336-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="0a336-204">Otwórz `ProductsBLLWithSprocs` klasy plików i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0a336-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-csharp[Main](adding-additional-datatable-columns-cs/samples/sample2.cs)]

<span data-ttu-id="0a336-205">Inne pobierania danych, metody, takie jak `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` metoda po prostu wywołuje warstwę DAL odpowiadającego s `GetProductsWithPriceQuartile` metodę i zwraca wyniki.</span><span class="sxs-lookup"><span data-stu-id="0a336-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="0a336-206">Krok 4. Wyświetlanie informacji kwartyl ceny na stronie sieci Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0a336-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="0a336-207">Dodając LOGIKI ukończyć możemy ponownie gotowe do tworzenia strony ASP.NET, która pokazuje kwartyl cena dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="0a336-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="0a336-208">Otwórz `AddingColumns.aspx` strony w `AdvancedDAL` folder i przeciągnij GridView z przybornika w projektancie, ustawiając jego `ID` właściwość `Products`.</span><span class="sxs-lookup"><span data-stu-id="0a336-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="0a336-209">Za pomocą tagu inteligentnego s GridView powiązać go do nowego elementu ObjectDataSource, o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0a336-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="0a336-210">Konfigurowanie kontrolki ObjectDataSource używać `ProductsBLLWithSprocs` klasy s `GetProductsWithPriceQuartile` metody.</span><span class="sxs-lookup"><span data-stu-id="0a336-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="0a336-211">Ponieważ są to siatki tylko do odczytu zestawu list rozwijanych w UPDATE, INSERT i usuwanie kart (Brak).</span><span class="sxs-lookup"><span data-stu-id="0a336-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="0a336-212">[![Konfigurowanie kontrolki ObjectDataSource na korzystanie z klasy ProductsBLLWithSprocs](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)</span></span>

<span data-ttu-id="0a336-213">**Rysunek 9**: Konfigurowanie kontrolki ObjectDataSource do użycia `ProductsBLLWithSprocs` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image25.png))</span></span>


<span data-ttu-id="0a336-214">[![Pobieranie informacji o produkcie z metody GetProductsWithPriceQuartile](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)</span></span>

<span data-ttu-id="0a336-215">**Na rysunku nr 10**: Pobieranie informacji o produkcie z `GetProductsWithPriceQuartile` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image28.png))</span></span>


<span data-ttu-id="0a336-216">Po zakończeniu pracy kreatora Konfigurowanie źródła danych, program Visual Studio automatycznie doda elementu BoundField lub CheckBoxField do kontrolki GridView dla każdego pola danych zwracany przez metodę.</span><span class="sxs-lookup"><span data-stu-id="0a336-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="0a336-217">Jedno z tych pól danych jest `PriceQuartile`, czyli kolumny, dodaliśmy do `ProductsDataTable` w kroku 1.</span><span class="sxs-lookup"><span data-stu-id="0a336-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="0a336-218">Edytuj pola s GridView, usuwając wszystkie elementy oprócz `ProductName`, `UnitPrice`, i `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="0a336-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="0a336-219">Konfigurowanie `UnitPrice` elementu BoundField sformatować wartość jako walutę i `UnitPrice` i `PriceQuartile` BoundFields i Centrum — wyrównany do prawej, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="0a336-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="0a336-220">Na koniec zaktualizuj pozostałe BoundFields `HeaderText` właściwości do produktu, ceny i cena KWARTYL, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="0a336-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="0a336-221">Sprawdź także włączyć sortowanie pola wyboru tagów inteligentnych s GridView.</span><span class="sxs-lookup"><span data-stu-id="0a336-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="0a336-222">Po tych zmian kontrolkami GridView i kontrolki ObjectDataSource s oznaczeniu deklaracyjnym powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="0a336-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-cs/samples/sample3.aspx)]

<span data-ttu-id="0a336-223">Na ilustracji 11 pokazano tej strony po odwiedzeniu za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0a336-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="0a336-224">Należy pamiętać, że początkowo produkty są uporządkowane według ich ceny w kolejności malejącej w poszczególnych produktach przypisaną odpowiednią `PriceQuartile` wartość.</span><span class="sxs-lookup"><span data-stu-id="0a336-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="0a336-225">Oczywiście te dane można sortować według innych kryteriów z wartością kolumny kwartyl cena nadal odzwierciedlający klasyfikacji produktu s względem cen (zobacz rysunek 12).</span><span class="sxs-lookup"><span data-stu-id="0a336-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="0a336-226">[![Produkty są uporządkowane według ich cen.](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)</span></span>

<span data-ttu-id="0a336-227">**Rysunek 11**: Produkty są uporządkowane według ich ceny ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image31.png))</span></span>


<span data-ttu-id="0a336-228">[![Produkty są uporządkowane według ich nazw](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="0a336-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)</span></span>

<span data-ttu-id="0a336-229">**Rysunek 12**: Produkty są uporządkowane według ich nazw ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-additional-datatable-columns-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="0a336-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="0a336-230">Przy użyciu kilku wierszy kodu firma Microsoft może rozszerzyć widoku GridView tak, aby go pokolorowane wierszy produktów na podstawie ich `PriceQuartile` wartość.</span><span class="sxs-lookup"><span data-stu-id="0a336-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="0a336-231">Firma Microsoft może kolor tych produktów w pierwszy kwartyl jasnozielony, w drugim kwartyl żółty światła i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="0a336-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="0a336-232">Zachęcam Cię do Poświęć chwilę, aby dodać tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="0a336-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="0a336-233">Jeśli potrzebujesz przypomnienia informacji na temat formatowania w kontrolce GridView, zapoznaj się z [niestandardowe formatowanie oparte na danych](../custom-formatting/custom-formatting-based-upon-data-cs.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="0a336-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="0a336-234">Alternatywnym podejściem — tworzenie innego TableAdapter</span><span class="sxs-lookup"><span data-stu-id="0a336-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="0a336-235">Jak możemy opisany w tym samouczku, gdy dodanie metody do TableAdapter, która zwraca pola danych niż te, województw przez główne zapytanie, możemy dodać odpowiednich kolumn do DataTable.</span><span class="sxs-lookup"><span data-stu-id="0a336-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="0a336-236">Takie podejście, jednak działa dobrze, tylko wtedy, gdy istnieje kilka metod w TableAdapter, które zwracają różnych pól danych, a jeśli tych pól danych różnią się zbytnio od głównego zapytania.</span><span class="sxs-lookup"><span data-stu-id="0a336-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="0a336-237">Zamiast Dodawanie kolumn do DataTable, możesz zamiast tego dodać inny obiekt TableAdapter do zestawu danych, który zawiera metody z pierwszym TableAdapter, które zwracają różnych pól danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="0a336-238">Na potrzeby tego samouczka zamiast dodawać `PriceQuartile` kolumny `ProductsDataTable` (gdy jest on używany tylko przez `GetProductsWithPriceQuartile` metoda), można dodaliśmy dodatkowe TableAdapter do zestawu danych o nazwie `ProductsWithPriceQuartileTableAdapter` używanym `Products_SelectWithPriceQuartile` przechowywane Procedura jako jego główne zapytanie.</span><span class="sxs-lookup"><span data-stu-id="0a336-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="0a336-239">Użyj strony ASP.NET, które wymagane można pobrać informacji o produkcie przy użyciu kwartyl cena `ProductsWithPriceQuartileTableAdapter`, natomiast te, które nie może w dalszym ciągu używać `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="0a336-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="0a336-240">Dodając nowy obiekt TableAdapter, DataTables pozostają untarnished i kolumn dokładnie takie same jak stosowane pola danych zwracane przez metody TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="0a336-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="0a336-241">Jednak dodatkowe TableAdapters wprowadzić powtarzających się zadań i funkcje.</span><span class="sxs-lookup"><span data-stu-id="0a336-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="0a336-242">Na przykład, jeśli te strony ASP.NET, które wyświetlane `PriceQuartile` kolumny również potrzebne zapewnienie wstawiania, aktualizowania i usuwania pomocy technicznej, `ProductsWithPriceQuartileTableAdapter` muszą znaleźć się jego `InsertCommand`, `UpdateCommand`, i `DeleteCommand` właściwości prawidłowo skonfigurowane.</span><span class="sxs-lookup"><span data-stu-id="0a336-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="0a336-243">Chociaż te właściwości będą takie same jak stosowane `ProductsTableAdapter` s, ta konfiguracja wprowadza dodatkowego kroku.</span><span class="sxs-lookup"><span data-stu-id="0a336-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="0a336-244">Ponadto obecnie istnieją dwa sposoby, aby zaktualizować, usuń lub Dodaj produkt do bazy danych — za pośrednictwem `ProductsTableAdapter` i `ProductsWithPriceQuartileTableAdapter` klasy.</span><span class="sxs-lookup"><span data-stu-id="0a336-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="0a336-245">W tym samouczku do pobrania obejmują programy `ProductsWithPriceQuartileTableAdapter` klasy w `NorthwindWithSprocs` zestawu danych, który ilustruje takie podejście alternatywne.</span><span class="sxs-lookup"><span data-stu-id="0a336-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="0a336-246">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="0a336-246">Summary</span></span>

<span data-ttu-id="0a336-247">W większości przypadków wszystkie metody w TableAdapter zwróci ten sam zestaw pól danych, ale istnieją momenty, gdy konkretną metodę lub dwóch może być konieczne zwrócić dodatkowe pola.</span><span class="sxs-lookup"><span data-stu-id="0a336-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="0a336-248">Na przykład w [Master/szczegółów przy użyciu punktowanej listy z rekordów głównych z kontrolką DataList szczegółów](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) samouczek dodaliśmy metodę `CategoriesTableAdapter` , oprócz pól danych główne zapytanie s zwrócił `NumberOfProducts` pola, które podać liczbę produktów skojarzonych z każdej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0a336-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="0a336-249">W tym samouczku przyjrzeliśmy się dodanie metody w `ProductsTableAdapter` zwróconą `PriceQuartile` pola oprócz pól danych główne zapytanie s.</span><span class="sxs-lookup"><span data-stu-id="0a336-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="0a336-250">Do przechwytywania dodatkowych danych pola zwracane przez metody TableAdapter s musimy dodać odpowiednich kolumn do DataTable.</span><span class="sxs-lookup"><span data-stu-id="0a336-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="0a336-251">Jeśli planujesz ręczne dodawanie kolumn do DataTable, zaleca się, że TableAdapter używanie procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="0a336-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="0a336-252">Jeśli element TableAdapter używa instrukcji SQL zapytań ad-hoc, ilekroć Kreator konfiguracji TableAdapter jest uruchamiana wszystkie metody pól danych zwrócony przez główne zapytanie przywrócić list pól danych.</span><span class="sxs-lookup"><span data-stu-id="0a336-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="0a336-253">Ten problem nie jest rozszerzana procedur przechowywanych, dlatego zaleca się i zostały użyte w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="0a336-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="0a336-254">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="0a336-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0a336-255">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="0a336-255">About the Author</span></span>

<span data-ttu-id="0a336-256">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="0a336-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0a336-257">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0a336-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0a336-258">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0a336-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0a336-259">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0a336-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0a336-260">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0a336-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0a336-261">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="0a336-261">Special Thanks To</span></span>

<span data-ttu-id="0a336-262">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="0a336-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0a336-263">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Randy Schmidt, Jacky Goor, Bernadette Leigh i Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="0a336-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="0a336-264">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="0a336-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0a336-265">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0a336-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0a336-266">[Poprzednie](updating-the-tableadapter-to-use-joins-cs.md)
> [dalej](working-with-computed-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0a336-266">[Previous](updating-the-tableadapter-to-use-joins-cs.md)
[Next](working-with-computed-columns-cs.md)</span></span>
