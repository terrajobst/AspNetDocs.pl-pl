---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: Korzystanie z istniejących procedur składowanych dla elementów TableAdapter Typizowanego zestawu danych (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W poprzednim samouczku dowiedzieliśmy, jak wygenerować nowe procedury składowane za pomocą Kreatora TableAdapter. W tym samouczku będziemy Dowiedz się, jak ten sam obiekt TableAdapter...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: 25e34512abc779bfef2d2bb99a8b62de073e8ed6
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59381489"
---
# <a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="00a1f-104">Korzystanie z istniejących procedur składowanych dla elementów TableAdapter typizowanego zestawu danych (VB)</span><span class="sxs-lookup"><span data-stu-id="00a1f-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="00a1f-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="00a1f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="00a1f-106">[Pobierz program Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) lub [Pobierz plik PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="00a1f-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="00a1f-107">W poprzednim samouczku dowiedzieliśmy, jak wygenerować nowe procedury składowane za pomocą Kreatora TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="00a1f-108">W tym samouczku dowie się, jak tym samym Kreatorze TableAdapter mogą współdziałać za pomocą istniejących procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="00a1f-109">Możemy również dowiedzieć się, jak można ręcznie dodać nowe procedury składowane do naszej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-109">We also learn how to manually add new stored procedures to our database.</span></span>


## <a name="introduction"></a><span data-ttu-id="00a1f-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="00a1f-110">Introduction</span></span>

<span data-ttu-id="00a1f-111">W [poprzedni Samouczek](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) widzieliśmy jak s wpisany zestaw danych TableAdapters może zostać skonfigurowany w taki sposób, aby użyć procedur składowanych na potrzeby dostępu do danych, a nie w trybie ad-hoc instrukcji języka SQL.</span><span class="sxs-lookup"><span data-stu-id="00a1f-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="00a1f-112">W szczególności zbadaliśmy sposób automatycznego tworzenia tych procedurach składowanych Kreator TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="00a1f-113">Podczas przenoszenia starszych aplikacji na platformie ASP.NET 2.0 lub podczas tworzenia witryny sieci Web programu ASP.NET 2.0 wokół istniejącego modelu danych, jest szansa, że baza danych zawiera już procedur składowanych, której potrzebujesz.</span><span class="sxs-lookup"><span data-stu-id="00a1f-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="00a1f-114">Alternatywnie można utworzyć przechowywanych procedur, ręcznie lub za pomocą narzędzia do niektórych innych niż kreatora TableAdapter, która automatycznie generuje przechowywanych procedur.</span><span class="sxs-lookup"><span data-stu-id="00a1f-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="00a1f-115">W tym samouczku przedstawiony zostanie sposób konfigurowania TableAdapter używać istniejących procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="00a1f-116">Ponieważ bazy danych Northwind jest tylko niewielki zestaw wbudowanych procedur składowanych, również przyjrzymy się czynności, aby ręcznie dodać nowe procedury składowane w bazie danych za pośrednictwem środowiska programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="00a1f-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="00a1f-117">Rozpocznij pracę dzięki s!</span><span class="sxs-lookup"><span data-stu-id="00a1f-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="00a1f-118">W [opakowywanie modyfikacji bazy danych w ramach transakcji](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) samouczek dodaliśmy metody do TableAdapter do obsługi transakcji (`BeginTransaction`, `CommitTransaction`i tak dalej).</span><span class="sxs-lookup"><span data-stu-id="00a1f-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="00a1f-119">Alternatywnie transakcji można zarządzać wyłącznie w obrębie procedury składowanej, który nie wymaga żadnych modyfikacji kodu warstwy dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="00a1f-120">W tym samouczku przyjrzymy się polecenia T-SQL służącego do wykonania procedury składowanej s instrukcji w zakresie transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>


## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="00a1f-121">Krok 1. Dodawanie procedur składowanych w bazie danych Northwind</span><span class="sxs-lookup"><span data-stu-id="00a1f-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="00a1f-122">Programu Visual Studio ułatwia dodawanie nowych procedur składowanych do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="00a1f-123">Umożliwiają s Dodaj nową procedurę składowaną z bazą danych Northwind, która zwraca wszystkie kolumny z `Products` tabeli dla tych, które mają konkretny `CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="00a1f-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="00a1f-124">W oknie Eksploratora serwera rozwiń węzeł bazy danych Northwind, tak, aby jego folderów — diagramy baz danych, tabele, widoki i tak dalej — są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="00a1f-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="00a1f-125">Jak widać widzieliśmy w poprzednim samouczku folderu procedur składowanych zawiera bazy danych s istniejących procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="00a1f-126">Aby dodać nową procedurę składowaną, kliknij prawym przyciskiem myszy folder procedur składowanych i wybierz opcję Dodaj nową procedurę przechowywaną z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="00a1f-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>


<span data-ttu-id="00a1f-127">[![Kliknij prawym przyciskiem myszy Folder procedur składowanych i Dodaj nową procedurę składowaną](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="00a1f-128">**Rysunek 1**: Kliknij prawym przyciskiem myszy Folder procedur przechowywanych i Dodaj nową procedurę przechowywaną ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>


<span data-ttu-id="00a1f-129">Jak pokazano na rysunku 1, wybierając opcję Dodaj nową procedurę przechowywaną spowoduje otwarcie okna skryptu w programie Visual Studio z konturem skrypt SQL potrzebne do utworzenia procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="00a1f-130">To nasze zadania do określania się ten skrypt i uruchomić go w tym momencie procedury składowanej zostaną dodane do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="00a1f-131">Wprowadź następujący skrypt:</span><span class="sxs-lookup"><span data-stu-id="00a1f-131">Enter the following script:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="00a1f-132">Ten skrypt po wykonaniu doda nową procedurę składowaną w bazie danych Northwind, o nazwie `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="00a1f-133">Tę procedurę składowaną przyjmuje jeden parametr wejściowy (`@CategoryID`, typu `int`) i zwraca wszystkie pola dla tych produktów z pasującą `CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="00a1f-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="00a1f-134">Do wykonania tej operacji `CREATE PROCEDURE` skryptu i dodać procedurę składowaną w bazie danych, kliknij ikonę Zapisz na pasku narzędzi lub naciśnij klawisze Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="00a1f-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="00a1f-135">Po wykonaniu tej czynności odświeżania folderu procedur składowanych, procedurę składowaną przedstawiający nowo utworzony.</span><span class="sxs-lookup"><span data-stu-id="00a1f-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="00a1f-136">Ponadto skryptów w oknie zmieni subtlety z `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` do `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="00a1f-137">`CREATE PROCEDURE` Dodaje nową procedurę składowaną w bazie danych, podczas gdy `ALTER PROCEDURE` aktualizuje istniejący zestaw.</span><span class="sxs-lookup"><span data-stu-id="00a1f-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="00a1f-138">Od początku skryptu został zmieniony na `ALTER PROCEDURE`zmiany procedur przechowywanych danych wejściowych w instrukcji SQL lub parametrów i klikając ikonę Zapisz spowoduje zaktualizowanie procedury składowanej za pomocą tych zmian.</span><span class="sxs-lookup"><span data-stu-id="00a1f-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="00a1f-139">Na rysunku 2 przedstawiono program Visual Studio po `Products_SelectByCategoryID` procedura składowana została zapisana.</span><span class="sxs-lookup"><span data-stu-id="00a1f-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>


<span data-ttu-id="00a1f-140">[![Products_SelectByCategoryID procedura składowana została dodana do bazy danych](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="00a1f-141">**Rysunek 2**: Procedura składowana `Products_SelectByCategoryID` został dodany do bazy danych ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>


## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="00a1f-142">Krok 2. Konfigurowanie TableAdapter do użycia istniejącą procedurę składowaną</span><span class="sxs-lookup"><span data-stu-id="00a1f-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="00a1f-143">Teraz, gdy `Products_SelectByCategoryID` procedura składowana została dodana do bazy danych, możemy skonfigurować nasz warstwy dostępu do danych, aby użyć tej procedury składowanej, gdy jeden z jego metod jest wywoływany.</span><span class="sxs-lookup"><span data-stu-id="00a1f-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="00a1f-144">W szczególności firma Microsoft doda `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` metody `ProductsTableAdapter` w `NorthwindWithSprocs` wpisany zestaw danych, który wywołuje `Products_SelectByCategoryID` przechowywane procedury, którą właśnie utworzyliśmy.</span><span class="sxs-lookup"><span data-stu-id="00a1f-144">In particular, we will add a `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="00a1f-145">Zacznij od otwarcia `NorthwindWithSprocs` zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="00a1f-146">Kliknij prawym przyciskiem myszy `ProductsTableAdapter` i wybierz polecenie Dodaj zapytanie, aby uruchomić Kreatora konfiguracji zapytania TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="00a1f-147">W [poprzedni Samouczek](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) postanowiliśmy mają TableAdapter, Utwórz nową procedurę składowaną dla nas.</span><span class="sxs-lookup"><span data-stu-id="00a1f-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="00a1f-148">Na potrzeby tego samouczka, chcemy, aby powiązać nową metodę TableAdapter do istniejących `Products_SelectByCategoryID` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="00a1f-149">W związku z tym opcję użycia istniejącej procedury składowanej z pierwszego kroku s kreatora, a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>


<span data-ttu-id="00a1f-150">[![Wybierz opcję użycia istniejącej procedury składowanej — opcja](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="00a1f-151">**Rysunek 3**: Wybierz opcję Użyj istniejącej przechowywane procedury opcji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>


<span data-ttu-id="00a1f-152">Następujący ekran zawiera listy rozwijanej wypełniony bazy danych s procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="00a1f-153">Wybieranie procedury składowanej wyświetla jego parametrów wejściowych po lewej i pola danych zwracane (jeśli istnieją) po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="00a1f-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="00a1f-154">Wybierz `Products_SelectByCategoryID` przechowywane procedury z listy i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>


<span data-ttu-id="00a1f-155">[![Wybierz Products_SelectByCategoryID procedury składowanej](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="00a1f-156">**Rysunek 4**: Wybierz `Products_SelectByCategoryID` Stored Procedure ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>


<span data-ttu-id="00a1f-157">Następny ekran najpierw zadaje nam jakiego rodzaju dane zwracane przez procedurę składowaną, a nasze odpowiedzi w tym miejscu określa typ zwracany przez metodę TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="00a1f-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="00a1f-158">Na przykład, jeśli firma Microsoft wskazują, że dane tabelaryczne są zwracane, metoda zwróci `ProductsDataTable` wystąpienie wypełnione przy użyciu rekordów zwracanych przez procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="00a1f-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="00a1f-159">Z kolei jeśli wskazaliśmy, że ta procedura składowana zwraca pojedynczą wartość TableAdapter zwróci `Object` , jest przypisywana wartość w pierwszej kolumnie pierwszy rekord zwrócone przez procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="00a1f-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="00a1f-160">Ponieważ `Products_SelectByCategoryID` procedura składowana ma zwracać wszystkie produkty, które należą do określonej kategorii, wybierz pierwszą odpowiedź — dane tabelaryczne — i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>


<span data-ttu-id="00a1f-161">[![Wskazuje, że procedura składowana ma zwracać dane tabelaryczne](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="00a1f-162">**Rysunek 5**: Wskazuje, że procedury składowanej zwraca dane tabelaryczne ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>


<span data-ttu-id="00a1f-163">Pozostaje tylko do wskazania, co metoda wzorce do użycia oraz nazwy dotyczącej tych metod.</span><span class="sxs-lookup"><span data-stu-id="00a1f-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="00a1f-164">Pozostaw zarówno wypełnienia DataTable i zwrócenia opcje DataTable zaznaczone, ale Zmień nazwę metody służące do `FillByCategoryID` i `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="00a1f-165">Następnie kliknij przycisk Dalej, aby przejrzeć podsumowanie zadań, które wykona Kreator.</span><span class="sxs-lookup"><span data-stu-id="00a1f-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="00a1f-166">Jeśli wszystko jest poprawne, kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="00a1f-166">If everything looks correct, click Finish.</span></span>


<span data-ttu-id="00a1f-167">[![Nazwa FillByCategoryID metod i GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="00a1f-168">**Rysunek 6**: Nazwa metody `FillByCategoryID` i `GetProductsByCategoryID` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="00a1f-169">Metody TableAdapter, którą właśnie utworzyliśmy, `FillByCategoryID` i `GetProductsByCategoryID`, oczekiwany parametr wejściowy typu `Integer`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="00a1f-170">Wartość tego parametru wejściowego jest przekazywany do procedury składowanej za pośrednictwem jego `@CategoryID` parametru.</span><span class="sxs-lookup"><span data-stu-id="00a1f-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="00a1f-171">Jeśli zmodyfikujesz `Products_SelectByCategory` przechowywane parametry procedury s, musisz również zaktualizować parametry dla tych metod TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="00a1f-172">Zgodnie z opisem w [poprzedniego samouczka](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), można to zrobić na dwa sposoby: przez ręczne dodawanie i usuwanie parametrów z kolekcji parametrów lub uruchamiając ponownie kreatora TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>


## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="00a1f-173">Krok 3. Dodawanie`GetProductsByCategoryID(categoryID)`metody LOGIKI</span><span class="sxs-lookup"><span data-stu-id="00a1f-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="00a1f-174">Za pomocą `GetProductsByCategoryID` metody DAL pełną, następnym krokiem jest zapewnienie dostępu do tej metody w warstwy logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="00a1f-175">Otwórz `ProductsBLLWithSprocs` klasy plików i dodaj następującą metodę:</span><span class="sxs-lookup"><span data-stu-id="00a1f-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>


[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="00a1f-176">Ta metoda LOGIKI po prostu zwraca `ProductsDataTable` zwróciło `ProductsTableAdapter` s `GetProductsByCategoryID` metody.</span><span class="sxs-lookup"><span data-stu-id="00a1f-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="00a1f-177">`DataObjectMethodAttribute` Atrybut zawiera metadane używane przez kreatora ObjectDataSource s Konfigurowanie źródła danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="00a1f-178">W szczególności ta metoda pojawi się na liście rozwijanej wybierz kartę s.</span><span class="sxs-lookup"><span data-stu-id="00a1f-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="00a1f-179">Krok 4. Wyświetlanie produktów według kategorii</span><span class="sxs-lookup"><span data-stu-id="00a1f-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="00a1f-180">Aby przetestować nowo dodanych `Products_SelectByCategoryID` procedury składowanej oraz odpowiednich metod DAL i LOGIKI, umożliwiają tworzenie strony ASP.NET, która zawiera kontrolki DropDownList i GridView s.</span><span class="sxs-lookup"><span data-stu-id="00a1f-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="00a1f-181">Metody DropDownList spowoduje wyświetlenie listy wszystkich kategorii w bazie danych podczas widoku GridView wyświetli produktów należących do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="00a1f-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="00a1f-182">Firma Microsoft interfejsy wzorzec/szczegół ve utworzone za pomocą kontrolek DROPDOWNLIST w poprzednich samouczkach.</span><span class="sxs-lookup"><span data-stu-id="00a1f-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="00a1f-183">Aby uzyskać bardziej przyjrzeć się raportem wzorzec/szczegół implementacji, zobacz [wzorzec/szczegół filtrowanie przy użyciu kontrolki DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="00a1f-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>


<span data-ttu-id="00a1f-184">Otwórz `ExistingSprocs.aspx` stronie `AdvancedDAL` folder i przeciągnij kontrolki DropDownList z przybornika do projektanta.</span><span class="sxs-lookup"><span data-stu-id="00a1f-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="00a1f-185">Ustaw DropDownList s `ID` właściwości `Categories` i jego `AutoPostBack` właściwość `True`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="00a1f-186">Następnie z jej tagu inteligentnego powiązać metody DropDownList nowe kontrolki ObjectDataSource, o nazwie `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="00a1f-187">Skonfigurować kontrolki ObjectDataSource pobiera dane z `CategoriesBLL` klasy s `GetCategories` metody.</span><span class="sxs-lookup"><span data-stu-id="00a1f-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="00a1f-188">Ustawianie list rozwijanych w UPDATE, INSERT i usuwanie kart (Brak).</span><span class="sxs-lookup"><span data-stu-id="00a1f-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="00a1f-189">[![Pobieranie danych z metody GetCategories CategoriesBLL klasy s](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="00a1f-190">**Rysunek 7**: Pobieranie danych z `CategoriesBLL` klasy s `GetCategories` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>


<span data-ttu-id="00a1f-191">[![Ustaw list rozwijanych w UPDATE, INSERT i usuwanie kart (Brak)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="00a1f-192">**Rysunek 8**: Ustaw listy rozwijane w aktualizacji, WSTAWIANIA i usuwania karty (Brak) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>


<span data-ttu-id="00a1f-193">Po zakończeniu pracy Kreatora ObjectDataSource, skonfiguruj kontrolki DropDownList, aby wyświetlić `CategoryName` pola danych i korzystać z `CategoryID` pola jako `Value` dla każdego `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="00a1f-194">W tym momencie DropDownList i kontrolki ObjectDataSource s oznaczeniu deklaracyjnym powinien podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="00a1f-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="00a1f-195">Następnie przeciągnij GridView do konstruktora, umieszczając go poniżej metody DropDownList.</span><span class="sxs-lookup"><span data-stu-id="00a1f-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="00a1f-196">Ustaw GridView s `ID` do `ProductsByCategory` i z jego tag inteligentny powiązać go do nowego elementu ObjectDataSource, o nazwie `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="00a1f-197">Konfigurowanie `ProductsByCategoryDataSource` ObjectDataSource do użycia `ProductsBLLWithSprocs` klasy go pobrać jego dane za pomocą `GetProductsByCategoryID(categoryID)` metody.</span><span class="sxs-lookup"><span data-stu-id="00a1f-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="00a1f-198">Ponieważ ten GridView będą używane tylko do wyświetlania danych, ustaw list rozwijanych w UPDATE, INSERT i usuwanie kart (Brak) i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>


<span data-ttu-id="00a1f-199">[![Konfigurowanie kontrolki ObjectDataSource na korzystanie z klasy ProductsBLLWithSprocs](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="00a1f-200">**Rysunek 9**: Konfigurowanie kontrolki ObjectDataSource do użycia `ProductsBLLWithSprocs` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>


<span data-ttu-id="00a1f-201">[![Pobieranie danych z metody GetProductsByCategoryID(categoryID)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="00a1f-202">**Na rysunku nr 10**: Pobieranie danych z `GetProductsByCategoryID(categoryID)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>


<span data-ttu-id="00a1f-203">Metody wybranej na karcie Wybierz oczekuje parametru, więc w ostatnim kroku kreatora nam wyświetla monit o podanie parametru źródła s.</span><span class="sxs-lookup"><span data-stu-id="00a1f-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="00a1f-204">Zmień wartość na liście rozwijanej źródła parametru do kontroli, a następnie wybierz `Categories` formantu z listy rozwijanej ControlID.</span><span class="sxs-lookup"><span data-stu-id="00a1f-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="00a1f-205">Kliknij przycisk Zakończ, aby zakończyć działanie kreatora.</span><span class="sxs-lookup"><span data-stu-id="00a1f-205">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="00a1f-206">[![Użyj metody DropDownList kategorie jako źródło categoryID parametru](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="00a1f-207">**Rysunek 11**: Użyj `Categories` DropDownList jako źródło `categoryID` parametru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>


<span data-ttu-id="00a1f-208">Po zakończeniu pracy Kreatora ObjectDataSource programu Visual Studio spowoduje to dodanie BoundFields i CheckBoxField dla każdego pola danych produktu.</span><span class="sxs-lookup"><span data-stu-id="00a1f-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="00a1f-209">Możesz dostosować te pola, zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="00a1f-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="00a1f-210">Odwiedź stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="00a1f-210">Visit the page through a browser.</span></span> <span data-ttu-id="00a1f-211">Przy wybranej kategorii Beverages strony i odpowiadających im produktów, które są wyświetlane w siatce.</span><span class="sxs-lookup"><span data-stu-id="00a1f-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="00a1f-212">Zmiana listy rozwijanej do alternatywnego kategorii, jak rysunek 12 przedstawiono powoduje odświeżenie strony i ponownie ładuje siatki z produktami nowo wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="00a1f-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>


<span data-ttu-id="00a1f-213">[![Produkty z kategorii generuje są wyświetlane.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="00a1f-214">**Rysunek 12**: Produkty z kategorii generuje są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>


## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="00a1f-215">Krok 5. Zawijania instrukcji s procedurę składowaną w ramach zakresu transakcji</span><span class="sxs-lookup"><span data-stu-id="00a1f-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="00a1f-216">W [opakowywanie modyfikacji bazy danych w ramach transakcji](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) samouczku Omówiliśmy techniki serię instrukcji modyfikacji bazy danych w zakresie transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="00a1f-217">Odwołania, który modyfikacje w obszarze parasola transakcji albo wszystkie powiedzie się lub wszystkie zakończone niepowodzeniem, gwarantując niepodzielność.</span><span class="sxs-lookup"><span data-stu-id="00a1f-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="00a1f-218">Techniki za pomocą transakcji obejmują:</span><span class="sxs-lookup"><span data-stu-id="00a1f-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="00a1f-219">Korzystanie z klas w `System.Transactions` przestrzeni nazw</span><span class="sxs-lookup"><span data-stu-id="00a1f-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="00a1f-220">O warstwie dostępu do danych użycia klas ADO.NET, takich jak `SqlTransaction`, i</span><span class="sxs-lookup"><span data-stu-id="00a1f-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="00a1f-221">Dodawanie poleceń języka T-SQL transakcji, bezpośrednio w ramach procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="00a1f-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="00a1f-222">*Opakowywanie modyfikacji bazy danych w ramach transakcji* samouczek używane klasy ADO.NET w warstwy DAL.</span><span class="sxs-lookup"><span data-stu-id="00a1f-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="00a1f-223">W pozostałej części tego samouczka analizuje sposób zarządzania transakcji za pomocą polecenia języka T-SQL z w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="00a1f-224">Są trzy polecenia SQL klucza ręczny, zatwierdzanie i wycofywania transakcji `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, i `ROLLBACK TRANSACTION`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="00a1f-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="00a1f-225">Jak podejście ADO.NET, podczas korzystania z transakcji z w ramach procedury składowanej, musimy się z następującym wzorcem:</span><span class="sxs-lookup"><span data-stu-id="00a1f-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="00a1f-226">Wskazuje początek transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="00a1f-227">Wykonaj instrukcje SQL, wchodzące w skład transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="00a1f-228">Jeśli występuje błąd w jednym z instrukcji z kroku nr 2 wycofywania transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="00a1f-229">Jeśli wszystkie instrukcje z kroku nr 2 zakończy się bez błędów, należy zatwierdzić transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="00a1f-230">Ten wzorzec może być implementowany w składni języka T-SQL przy użyciu następującego szablonu:</span><span class="sxs-lookup"><span data-stu-id="00a1f-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="00a1f-231">Szablon, który rozpoczyna się przez definiowanie `TRY...CATCH` block konstrukcję jesteś nowym użytkownikiem programu SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="00a1f-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="00a1f-232">Za pomocą `Try...Catch` bloków w języku Visual Basic SQL `TRY...CATCH` blok jest wykonywany instrukcji w `TRY` bloku.</span><span class="sxs-lookup"><span data-stu-id="00a1f-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="00a1f-233">Jeśli każda instrukcja zgłasza błąd, natychmiast przekazaniu kontroli do `CATCH` bloku.</span><span class="sxs-lookup"><span data-stu-id="00a1f-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="00a1f-234">Jeśli nie ma żadnych błędów, wykonywania instrukcji SQL tej transakcji, korzeń `COMMIT TRANSACTION` instrukcji zatwierdza zmiany i wykonuje transakcję.</span><span class="sxs-lookup"><span data-stu-id="00a1f-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="00a1f-235">Jeśli jednak jedno z oświadczeń powoduje wystąpienie błędu `ROLLBACK TRANSACTION` w `CATCH` bloku przywraca bazę danych do stanu przed rozpoczęciem transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="00a1f-236">Procedura składowana także zgłasza błąd za pomocą [polecenie RAISERROR](https://msdn.microsoft.com/library/ms178592.aspx), co powoduje, że `SqlException` do wywołania w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="00a1f-237">Ponieważ `TRY...CATCH` bloku jest nowym składnikiem programu SQL Server 2005, powyższego szablonu nie będzie działać, jeśli używasz starszej wersji programu Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="00a1f-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="00a1f-238">Jeśli nie używasz programu SQL Server 2005, zapoznaj się z [zarządzania transakcji w procedur składowanych serwera SQL](http://www.4guysfromrolla.com/webtech/080305-1.shtml) dla szablonu, który będzie działać z innymi wersjami programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="00a1f-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>


<span data-ttu-id="00a1f-239">Pozwól, s, spójrz na konkretny przykład.</span><span class="sxs-lookup"><span data-stu-id="00a1f-239">Let s look at a concrete example.</span></span> <span data-ttu-id="00a1f-240">Ograniczenie klucza obcego istnieje między `Categories` i `Products` tabel, co oznacza, że każdy `CategoryID` pole `Products` tabeli musi być mapowane `CategoryID` wartość w `Categories` tabeli.</span><span class="sxs-lookup"><span data-stu-id="00a1f-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="00a1f-241">Dowolna akcja, którą naruszyłoby to ograniczenie, np. podjęto próbę usunięcia kategorii, która jest skojarzona produktów, powoduje naruszenie ograniczenia klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="00a1f-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="00a1f-242">Aby to sprawdzić, ponownie przykład aktualizowanie i usuwanie istniejących danych binarnych w pracy z sekcji danych binarnych (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="00a1f-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="00a1f-243">Ta strona zawiera listę poszczególnych kategorii w systemie, wraz z przyciski edytowania i usuwania (zobacz rysunek 13), ale Jeśli spróbujesz usunąć kategorię, która jest skojarzona produktów — takich jak Beverages — usunięcie nie powiodło się z powodu naruszenia ograniczenia klucza obcego (zobacz rysunek 14).</span><span class="sxs-lookup"><span data-stu-id="00a1f-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>


<span data-ttu-id="00a1f-244">[![Każda kategoria jest wyświetlany w widoku GridView z funkcją Edytuj i usuń przyciski](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="00a1f-245">**Rysunek 13**: Każda kategoria jest wyświetlany w widoku GridView z funkcją Edytuj i usuń przyciski ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>


<span data-ttu-id="00a1f-246">[![Nie można usunąć kategorii, której istniejących produktów](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="00a1f-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="00a1f-247">**Rysunek 14**: Nie można usunąć kategorii, której istniejących produktów ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="00a1f-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>


<span data-ttu-id="00a1f-248">Wyobraź sobie, jednak, że chcemy zezwolić na kategorie w celu usunięcia niezależnie od tego, czy mają jednak powiązane z produktami.</span><span class="sxs-lookup"><span data-stu-id="00a1f-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="00a1f-249">Należy usunąć kategorię z produktami, Wyobraź sobie, że chcemy także usunięcie jego istniejących produktów (mimo że innym rozwiązaniem byłoby wystarczy ustawić dla swoich produktów `CategoryID` wartości `NULL`).</span><span class="sxs-lookup"><span data-stu-id="00a1f-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="00a1f-250">Ta funkcja może być implementowane za pomocą reguł cascade ograniczenie klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="00a1f-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="00a1f-251">Alternatywnie można utworzyć procedurę składowaną, która akceptuje `@CategoryID` parametr wejściowy i wywołana jawnie usuwa wszystkie skojarzone produkty, a następnie określonej kategorii.</span><span class="sxs-lookup"><span data-stu-id="00a1f-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="00a1f-252">Nasze pierwsza próba procedury składowanej może wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="00a1f-252">Our first attempt at such a stored procedure might look like the following:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="00a1f-253">Gdy ostatecznie spowoduje to usunięcie skojarzone produkty i kategorii, go nie jest to w obszarze parasola transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="00a1f-254">Wyobraź sobie, że istnieje kilka innych ograniczenie klucza obcego na `Categories` zezwolili spowoduje usunięcie określonego `@CategoryID` wartość.</span><span class="sxs-lookup"><span data-stu-id="00a1f-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="00a1f-255">Problem polega na tym, że w takim przypadku wszystkie produkty zostaną usunięte przed staramy się usunąć kategorię.</span><span class="sxs-lookup"><span data-stu-id="00a1f-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="00a1f-256">Wynikiem jest, że dla kategorii, tę procedurę składowaną spowoduje usunięcie wszystkich jej produktów podczas gdy pozostała kategorii, ponieważ nadal ma powiązane rekordy w innej tabeli.</span><span class="sxs-lookup"><span data-stu-id="00a1f-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="00a1f-257">Jeśli procedura składowana zostały opakowane w zakresie transakcji, jednak usuwa do `Products` tabeli będzie można wycofać w przypadku nie można usunąć `Categories`.</span><span class="sxs-lookup"><span data-stu-id="00a1f-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="00a1f-258">Poniższy skrypt procedury składowanej używa transakcji, aby zapewnić niepodzielność między tymi dwoma `DELETE` instrukcji:</span><span class="sxs-lookup"><span data-stu-id="00a1f-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="00a1f-259">Poświęć chwilę, aby dodać `Categories_Delete` przechowywane procedury z bazą danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="00a1f-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="00a1f-260">Odwołaj się do kroku 1 instrukcje dotyczące dodawania procedur składowanych do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="00a1f-261">Krok 6. Aktualizowanie`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="00a1f-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="00a1f-262">Podczas gdy my będziemy dodano `Categories_Delete` procedurę składowaną w bazie danych, warstwy DAL jest obecnie skonfigurowany do używania instrukcji SQL zapytań ad-hoc przeprowadzić delete.</span><span class="sxs-lookup"><span data-stu-id="00a1f-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="00a1f-263">Musimy zaktualizować `CategoriesTableAdapter` i poinformuj go do korzystania ze `Categories_Delete` procedurę składowaną w zamian.</span><span class="sxs-lookup"><span data-stu-id="00a1f-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="00a1f-264">Wcześniej w tym samouczku pracy przy użyciu `NorthwindWithSprocs` zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="00a1f-265">Jednak, że zestaw danych zawiera tylko pojedynczy element `ProductsDataTable`, więc chcemy Praca z elementami roboczymi.</span><span class="sxs-lookup"><span data-stu-id="00a1f-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="00a1f-266">W związku z tym, w pozostałej części tego samouczka I mówiąc o m Data Access Layer I odwołujące się do `Northwind` zestawu danych, który utworzyliśmy najpierw w [Tworzenie warstwy dostępu do danych](../introduction/creating-a-data-access-layer-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="00a1f-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>


<span data-ttu-id="00a1f-267">Otwórz zestaw danych Northwind, wybierz `CategoriesTableAdapter`, a następnie przejdź do okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="00a1f-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="00a1f-268">Wyświetla okno właściwości `InsertCommand`, `UpdateCommand`, `DeleteCommand`, i `SelectCommand` posługują się TableAdapter, a także jej nazwę oraz informacje o połączeniu.</span><span class="sxs-lookup"><span data-stu-id="00a1f-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="00a1f-269">Rozwiń `DeleteCommand` właściwości, aby wyświetlić jego szczegóły.</span><span class="sxs-lookup"><span data-stu-id="00a1f-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="00a1f-270">Jak pokazano na rysunku 15, `DeleteCommand` s `CommandType` właściwość jest ustawiona na tekst, który powoduje, że będzie można wysyłać tekst `CommandText` właściwość jako kwerendy SQL zapytań ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="00a1f-270">As Figure 15 shows, the `DeleteCommand` s `CommandType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>


![W Projektancie Aby wyświetlić jego właściwości w oknie dialogowym właściwości wybierz CategoriesTableAdapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="00a1f-272">**Rysunek 15**: Wybierz `CategoriesTableAdapter` w Projektancie Aby wyświetlić jego właściwości w oknie dialogowym właściwości</span><span class="sxs-lookup"><span data-stu-id="00a1f-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>


<span data-ttu-id="00a1f-273">Aby zmienić te ustawienia, zaznacz tekst, (element DeleteCommand) w oknie dialogowym właściwości, a następnie wybierz (nowość) z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="00a1f-274">Spowoduje to wyczyszczenie ustawienia `CommandText`, `CommandType`, i `Parameters` właściwości.</span><span class="sxs-lookup"><span data-stu-id="00a1f-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="00a1f-275">Następnym etapem jest skonfigurowanie `CommandType` właściwości `StoredProcedure` , a następnie wpisz nazwę procedury składowanej dla `CommandText` (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="00a1f-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="00a1f-276">W przypadku wprowadzenia się upewnić, że właściwości w tej kolejności — najpierw `CommandType` i następnie `CommandText` — Visual Studio będzie automatycznie wypełnić kolekcję parametrów.</span><span class="sxs-lookup"><span data-stu-id="00a1f-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="00a1f-277">Jeśli nie podasz tych właściwości w podanej kolejności, należy ręcznie dodać parametry przez Edytor kolekcji parametrów.</span><span class="sxs-lookup"><span data-stu-id="00a1f-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="00a1f-278">W obu przypadkach go s, aby kliknąć wielokropek we właściwości parametrów, aby wyświetlić się Edytor kolekcji parametrów, aby sprawdzić, czy zostały wprowadzone zmiany w ustawieniach odpowiedni parametr (zobacz rysunek 16).</span><span class="sxs-lookup"><span data-stu-id="00a1f-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="00a1f-279">Jeśli nie widzisz żadnych parametrów w oknie dialogowym Dodaj `@CategoryID` parametru ręcznie (nie trzeba dodawać `@RETURN_VALUE` parametru).</span><span class="sxs-lookup"><span data-stu-id="00a1f-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>


![Upewnij się, że ustawienia parametry są poprawne](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="00a1f-281">**Rysunek 16**: Upewnij się, że ustawienia parametry są poprawne</span><span class="sxs-lookup"><span data-stu-id="00a1f-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>


<span data-ttu-id="00a1f-282">Po zaktualizowaniu warstwy DAL usuwania kategorii spowoduje usunięcie wszystkich jej skojarzone produkty i automatycznie w tym celu w obszarze parasola transakcji.</span><span class="sxs-lookup"><span data-stu-id="00a1f-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="00a1f-283">Aby to sprawdzić, wróć do strony aktualizowanie i usuwanie istniejących danych binarnych, a następnie kliknij przycisk Usuń jeden z tych kategorii.</span><span class="sxs-lookup"><span data-stu-id="00a1f-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="00a1f-284">Jeden jednym kliknięciem myszy kategorię i wszystkich jego skojarzone produkty zostaną usunięte.</span><span class="sxs-lookup"><span data-stu-id="00a1f-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="00a1f-285">Przed testowaniem `Categories_Delete` procedury składowanej, co spowoduje usunięcie wiele produktów wraz z wybranej kategorii, może być rozważenie wykonanie kopii zapasowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="00a1f-286">Jeśli używasz `NORTHWND.MDF` bazy danych w `App_Data`, po prostu zamknąć program Visual Studio i skopiuj pliki MDF i LDF w `App_Data` do niektórych innego folderu.</span><span class="sxs-lookup"><span data-stu-id="00a1f-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="00a1f-287">Po zakończeniu testowania funkcji, można przywrócić bazy danych przez zamknięcie programu Visual Studio i zastąpienie bieżącego plików MDF i LDF pliki `App_Data` z kopią zapasową.</span><span class="sxs-lookup"><span data-stu-id="00a1f-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>


## <a name="summary"></a><span data-ttu-id="00a1f-288">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="00a1f-288">Summary</span></span>

<span data-ttu-id="00a1f-289">TableAdapter Kreator s będą automatycznie generować procedur składowanych dla nas, istnieją czasy, kiedy możemy być może już tych procedur składowanych, które zostały utworzone lub chcesz je utworzyć ręcznie lub za pomocą innych narzędzi zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="00a1f-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="00a1f-290">Aby uwzględnić takich scenariuszy, można również skonfigurować wskaż istniejącą procedurę składowaną TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="00a1f-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="00a1f-291">W tym samouczku zobaczyliśmy, jak ręcznie dodać procedur składowanych do bazy danych za pośrednictwem środowiska programu Visual Studio oraz sposób połączenie metody TableAdapter s do tych procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="00a1f-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="00a1f-292">Możemy również zbadane polecenia języka T-SQL i wzorzec skrypt używany dla początkowego, zatwierdzanie i wycofywanie transakcji z w procedurze składowanej.</span><span class="sxs-lookup"><span data-stu-id="00a1f-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="00a1f-293">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="00a1f-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="00a1f-294">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="00a1f-294">About the Author</span></span>

<span data-ttu-id="00a1f-295">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="00a1f-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="00a1f-296">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="00a1f-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="00a1f-297">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="00a1f-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="00a1f-298">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00a1f-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="00a1f-299">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="00a1f-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="00a1f-300">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="00a1f-300">Special Thanks To</span></span>

<span data-ttu-id="00a1f-301">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="00a1f-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="00a1f-302">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Hilton Geisenow, S ren Jacob Lauritsen i Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="00a1f-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="00a1f-303">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="00a1f-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="00a1f-304">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00a1f-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="00a1f-305">[Poprzednie](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [dalej](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="00a1f-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
