---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Aktualizowanie TableAdapter do używania sprzężeń (VB) | Microsoft Docs
author: rick-anderson
description: Podczas pracy z bazą danych często żądają danych rozłożonych między wieloma tabelami. Aby pobrać dane z dwóch różnych tabel, możemy użyć jednej z nich...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c94baa99b126cdd24d69afc3d02bfe8b069419b
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74604253"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="6d720-104">Aktualizowanie elementu TableAdapter w celu używania sprzężeń JOIN (VB)</span><span class="sxs-lookup"><span data-stu-id="6d720-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="6d720-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6d720-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6d720-106">[Pobierz kod](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) lub [Pobierz plik PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6d720-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="6d720-107">Podczas pracy z bazą danych często żądają danych rozłożonych między wieloma tabelami.</span><span class="sxs-lookup"><span data-stu-id="6d720-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="6d720-108">Aby pobrać dane z dwóch różnych tabel, można użyć skorelowanego podzapytania lub operacji JOIN.</span><span class="sxs-lookup"><span data-stu-id="6d720-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="6d720-109">W tym samouczku porównano skorelowane podzapytania i składnię JOIN przed rozpoczęciem tworzenia TableAdapter zawierającego SPRZĘŻENIe w jego głównym zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="6d720-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="6d720-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="6d720-110">Introduction</span></span>

<span data-ttu-id="6d720-111">W przypadku relacyjnych baz danych dane, z którymi jesteśmy zainteresowani, są często rozłożone na wiele tabel.</span><span class="sxs-lookup"><span data-stu-id="6d720-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="6d720-112">Na przykład podczas wyświetlania informacji o produkcie warto wyświetlić listę odpowiednich nazw kategorii i dostawców produktów.</span><span class="sxs-lookup"><span data-stu-id="6d720-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="6d720-113">Tabela `Products` ma `CategoryID` i `SupplierID` wartości, ale rzeczywista nazwa kategorii i dostawcy znajdują się odpowiednio w tabelach `Categories` i `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="6d720-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="6d720-114">Aby pobrać informacje z innej powiązanej tabeli, można użyć *skorelowanych podkwerend* lub `JOIN`*s*.</span><span class="sxs-lookup"><span data-stu-id="6d720-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="6d720-115">Skorelowane podzapytanie jest zagnieżdżoną kwerendą `SELECT`, która odwołuje się do kolumn w zewnętrznym zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="6d720-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="6d720-116">Na przykład w samouczku [Tworzenie warstwy dostępu do danych](../introduction/creating-a-data-access-layer-vb.md) zostały użyte dwa skorelowane podzapytania w zapytaniu głównym `ProductsTableAdapter` s w celu zwrócenia kategorii i nazw dostawców dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="6d720-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="6d720-117">`JOIN` to konstrukcja SQL, która scala powiązane wiersze z dwóch różnych tabel.</span><span class="sxs-lookup"><span data-stu-id="6d720-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="6d720-118">Do wyświetlania informacji o kategorii obok każdego produktu użyto `JOIN` w [danych zapytania za pomocą samouczka kontrolki kontrolki SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="6d720-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="6d720-119">Przyczyna abstained z używania `JOIN` s z TableAdapters wynika z faktu, że ograniczenia w Kreatorze TableAdapter s umożliwiają automatyczne generowanie odpowiednich instrukcji `INSERT`, `UPDATE`i `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="6d720-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="6d720-120">Dokładniej mówiąc, jeśli główne zapytanie TableAdapter s zawiera dowolne `JOIN` s, TableAdapter nie może utworzyć instrukcji SQL ad hoc ani procedur składowanych dla właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="6d720-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="6d720-121">W tym samouczku zostaną krótko porównane i powiązane podzapytania, a `JOIN` s przed rozpoczęciem eksplorowania sposobu tworzenia TableAdapter zawierającego `JOIN` s w jego głównym zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="6d720-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="6d720-122">Porównywanie i różnicowanie skorelowanych podzapytań oraz`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="6d720-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="6d720-123">Odwołaj, że `ProductsTableAdapter` utworzone w pierwszym samouczku w `Northwind` DataSet używa skorelowanego podzapytań, aby przywrócić każde odpowiednie produkty i nazwę dostawcy.</span><span class="sxs-lookup"><span data-stu-id="6d720-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="6d720-124">Poniżej przedstawiono zapytanie główne `ProductsTableAdapter` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="6d720-125">Dwa skorelowane podzapytania — `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` i `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` — są `SELECT` zapytania, które zwracają pojedynczą wartość na produkt jako dodatkową kolumnę na liście kolumn zewnętrznej `SELECT` instrukcji s.</span><span class="sxs-lookup"><span data-stu-id="6d720-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="6d720-126">Alternatywnie można użyć `JOIN`, aby zwrócić każdy dostawca produktu i nazwę kategorii.</span><span class="sxs-lookup"><span data-stu-id="6d720-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="6d720-127">Poniższe zapytanie zwraca te same dane wyjściowe co powyżej, ale używa `JOIN` s zamiast podkwerend:</span><span class="sxs-lookup"><span data-stu-id="6d720-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="6d720-128">`JOIN` scala rekordy z jednej tabeli z rekordami z innej tabeli na podstawie niektórych kryteriów.</span><span class="sxs-lookup"><span data-stu-id="6d720-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="6d720-129">Na przykład w powyższym zapytaniu `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instruuje SQL Server, aby scalić każdy rekord produktu z rekordem kategorii, którego wartość `CategoryID` jest zgodna z wartością `CategoryID` produktu.</span><span class="sxs-lookup"><span data-stu-id="6d720-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="6d720-130">Scalony wynik pozwala nam korzystać z odpowiednich pól kategorii dla każdego produktu (na przykład `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="6d720-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="6d720-131">`JOIN` s są często używane podczas wykonywania zapytań dotyczących danych z relacyjnych baz danych.</span><span class="sxs-lookup"><span data-stu-id="6d720-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="6d720-132">Jeśli jesteś nowym użytkownikiem składni `JOIN` lub potrzebujesz pędzla w górę w celu użycia, I d zalecamy zapoznanie się z [samouczkiem dotyczącym sprzężenia SQL](http://www.w3schools.com/sql/sql_join.asp) w [szkołach W3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="6d720-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="6d720-133">Jest [`JOIN`](https://msdn.microsoft.com/library/ms191517.aspx) to również, że odczytywanie to sekcje podstawowe i [podzapytania](https://msdn.microsoft.com/library/ms189575.aspx) dotyczące usługi [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d720-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="6d720-134">Ze względu na to, że `JOIN` s i skorelowane podzapytania mogą być używane do pobierania powiązanych danych z innych tabel, wielu deweloperów pozostawiła swoje głowice i zastanawia się, które podejście ma być używane.</span><span class="sxs-lookup"><span data-stu-id="6d720-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="6d720-135">Wszystkie Gurus języka SQL, do których odpowiedziano te same działania, tak samo, że nie jest to bardzo istotne dla wydajności, ponieważ SQL Server będzie generować bardzo identyczne plany wykonania.</span><span class="sxs-lookup"><span data-stu-id="6d720-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="6d720-136">W tym celu należy użyć techniki, z którą ty i Twój zespół.</span><span class="sxs-lookup"><span data-stu-id="6d720-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="6d720-137">Warto zwrócić uwagę na to, że po przeprowadzeniu tej porady eksperci natychmiast wyrażają preferencję `JOIN` s za pośrednictwem skorelowanych podzapytań.</span><span class="sxs-lookup"><span data-stu-id="6d720-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="6d720-138">Podczas kompilowania warstwy dostępu do danych przy użyciu wpisanych zestawów DataSet narzędzia działają lepiej podczas korzystania z podzapytań.</span><span class="sxs-lookup"><span data-stu-id="6d720-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="6d720-139">W szczególności Kreator TableAdapter s nie generuje automatycznie odpowiednich instrukcji `INSERT`, `UPDATE`i `DELETE`, jeśli główne zapytanie zawiera wszystkie `JOIN` s, ale te instrukcje zostaną automatycznie wygenerowane w przypadku użycia skorelowanych podzapytań.</span><span class="sxs-lookup"><span data-stu-id="6d720-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="6d720-140">Aby zbadać to niedoskonałość, należy utworzyć tymczasowy zestaw danych o określonym typie w folderze `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="6d720-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="6d720-141">W Kreatorze konfiguracji TableAdapter wybierz, aby użyć instrukcji SQL ad hoc i wprowadź następujące zapytanie `SELECT` (patrz rysunek 1):</span><span class="sxs-lookup"><span data-stu-id="6d720-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]

<span data-ttu-id="6d720-142">[![wprowadzić głównej kwerendy zawierającej sprzężenia](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="6d720-143">**Rysunek 1**. Wprowadź główną kwerendę zawierającą `JOIN` s ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>

<span data-ttu-id="6d720-144">Domyślnie TableAdapter automatycznie tworzy instrukcje `INSERT`, `UPDATE`i `DELETE` na podstawie zapytania głównego.</span><span class="sxs-lookup"><span data-stu-id="6d720-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="6d720-145">Po kliknięciu przycisku Zaawansowane można zobaczyć, że ta funkcja jest włączona.</span><span class="sxs-lookup"><span data-stu-id="6d720-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="6d720-146">Pomimo tego ustawienia TableAdapter nie będzie mógł utworzyć instrukcji `INSERT`, `UPDATE`i `DELETE`, ponieważ główne zapytanie zawiera `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="6d720-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Wprowadź zapytanie główne zawierające sprzężenia](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="6d720-148">**Rysunek 2**. wprowadzanie głównego zapytania zawierającego `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="6d720-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="6d720-149">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="6d720-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="6d720-150">W tym momencie Projektant zestawu danych s będzie zawierać pojedyncze TableAdapter z elementem DataTable z kolumnami dla każdego z pól zwróconych na liście kolumn `SELECT` zapytania s.</span><span class="sxs-lookup"><span data-stu-id="6d720-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="6d720-151">Obejmuje to `CategoryName` i `SupplierName`, jak pokazano na rysunku 3.</span><span class="sxs-lookup"><span data-stu-id="6d720-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![Element DataTable zawiera kolumnę dla każdego pola zwróconego na liście kolumn.](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="6d720-153">**Rysunek 3**. tabela DataTable zawiera kolumnę dla każdego pola zwróconego na liście kolumn</span><span class="sxs-lookup"><span data-stu-id="6d720-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="6d720-154">Gdy element DataTable ma odpowiednie kolumny, TableAdapter nie ma wartości dla właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="6d720-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="6d720-155">Aby to potwierdzić, kliknij TableAdapter w projektancie, a następnie przejdź do okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d720-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="6d720-156">Zobaczysz, że właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand` są ustawione na wartość (brak).</span><span class="sxs-lookup"><span data-stu-id="6d720-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="6d720-157">[![właściwości InsertCommand, UpdateCommand i DeleteCommand są ustawione na (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="6d720-158">**Rysunek 4**. właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand` są ustawione na (brak) ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>

<span data-ttu-id="6d720-159">Aby obejść ten brak, możemy ręcznie dostarczyć instrukcje i parametry SQL dla `InsertCommand`, `UpdateCommand`i `DeleteCommand` właściwości za pośrednictwem okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d720-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="6d720-160">Alternatywnie można rozpocząć od skonfigurowania zapytania głównego TableAdapter s, aby *nie* zawierały żadnych `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="6d720-161">Dzięki temu instrukcje `INSERT`, `UPDATE`i `DELETE` będą generowane automatycznie dla nas.</span><span class="sxs-lookup"><span data-stu-id="6d720-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="6d720-162">Po zakończeniu działania kreatora można ręcznie zaktualizować TableAdapter `SelectCommand` z okno Właściwości, aby zawierał składnię `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="6d720-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="6d720-163">Chociaż to podejście działa, jest bardzo kruchy w przypadku korzystania z zapytań SQL ad hoc, ponieważ za każdym razem, gdy zapytanie główne TableAdapter s zostało ponownie skonfigurowane za pośrednictwem kreatora, automatycznie generowane instrukcje `INSERT`, `UPDATE`i `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="6d720-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="6d720-164">Oznacza to, że wszystkie wprowadzone później modyfikacje zostaną utracone, jeśli zostanie kliknięty prawym przyciskiem myszy w TableAdapter, wybierz pozycję Konfiguruj z menu kontekstowego, a następnie ponownie Ukończ pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="6d720-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="6d720-165">Brittleness z TableAdapter s `INSERT`generowanym automatycznie, `UPDATE`i `DELETE` są na szczęście, ograniczone do instrukcji SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="6d720-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="6d720-166">Jeśli TableAdapter korzysta z procedur składowanych, można dostosować `SelectCommand`, `InsertCommand`, `UpdateCommand`lub `DeleteCommand` procedury składowane, a następnie ponownie uruchomić Kreatora konfiguracji TableAdapter bez konieczności obawowania, że procedury składowane zostaną zmodyfikowane.</span><span class="sxs-lookup"><span data-stu-id="6d720-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="6d720-167">W ciągu następnych kilku kroków utworzymy TableAdapter, która początkowo korzysta z głównego zapytania, które pomija wszystkie `JOIN` s, aby odpowiednie procedury składowane INSERT, Update i DELETE będą generowane automatycznie.</span><span class="sxs-lookup"><span data-stu-id="6d720-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="6d720-168">Następnie zaktualizujemy `SelectCommand` tak, aby używała `JOIN`, która zwraca dodatkowe kolumny z powiązanych tabel.</span><span class="sxs-lookup"><span data-stu-id="6d720-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="6d720-169">Na koniec utworzymy odpowiednią klasę warstwy logiki biznesowej i wykażemy użycie TableAdapter na stronie sieci Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6d720-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="6d720-170">Krok 1. Tworzenie TableAdapter przy użyciu uproszczonego zapytania głównego</span><span class="sxs-lookup"><span data-stu-id="6d720-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="6d720-171">W tym samouczku dodamy TableAdapter i silnie wpisaną wartość DataTable dla tabeli `Employees` w zestawie danych `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="6d720-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="6d720-172">Tabela `Employees` zawiera pole `ReportsTo`, które określa `EmployeeID` menedżera pracowników.</span><span class="sxs-lookup"><span data-stu-id="6d720-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="6d720-173">Na przykład pracownik Anne Dodsworth ma `ReportTo` wartość 5, czyli `EmployeeID` z Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="6d720-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="6d720-174">W związku z tym Anne raporty do Steven, jego Menedżera.</span><span class="sxs-lookup"><span data-stu-id="6d720-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="6d720-175">Wraz z raportowaniem każdej wartości `ReportsTo` pracownika może być również konieczne pobranie nazwy swojego menedżera.</span><span class="sxs-lookup"><span data-stu-id="6d720-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="6d720-176">Można to zrobić przy użyciu `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="6d720-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="6d720-177">Jednak przy pierwszym tworzeniu TableAdapter przy użyciu `JOIN` uniemożliwia kreatorowi automatyczne generowanie odpowiednich funkcji INSERT, Update i DELETE.</span><span class="sxs-lookup"><span data-stu-id="6d720-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="6d720-178">W związku z tym zaczniemy od utworzenia elementu TableAdapter, którego zapytanie główne nie zawiera żadnych `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="6d720-179">Następnie w kroku 2 będziemy aktualizować główną procedurę przechowywaną zapytania, aby pobrać nazwę Menedżera za pośrednictwem `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="6d720-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="6d720-180">Zacznij od otwarcia `NorthwindWithSprocs` zestawu danych w folderze `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="6d720-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="6d720-181">Kliknij prawym przyciskiem myszy projektanta, wybierz opcję Dodaj z menu kontekstowego i wybierz element menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="6d720-182">Spowoduje to uruchomienie Kreatora konfiguracji TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="6d720-183">Zgodnie z ilustracją 5 przedstawia Kreator tworzy nowe procedury składowane i klika dalej.</span><span class="sxs-lookup"><span data-stu-id="6d720-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="6d720-184">Aby uzyskać odświeżacz dotyczący tworzenia nowych procedur składowanych z poziomu kreatora TableAdapter s, zapoznaj się z tematem [Tworzenie nowych procedur składowanych dla określonego typu zestawu danych s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="6d720-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="6d720-185">[![wybrać opcję Utwórz nowe procedury składowane](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="6d720-186">**Rysunek 5**. Wybierz opcję Utwórz nowe procedury składowane ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>

<span data-ttu-id="6d720-187">Użyj następującej instrukcji `SELECT` dla głównego zapytania TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="6d720-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="6d720-188">Ponieważ to zapytanie nie zawiera żadnych `JOIN` s, Kreator TableAdapter automatycznie utworzy procedury składowane z odpowiednimi `INSERT`, `UPDATE`i `DELETE` instrukcjami, jak również procedurę przechowywaną do wykonywania zapytania głównego.</span><span class="sxs-lookup"><span data-stu-id="6d720-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="6d720-189">Poniższy krok pozwala nam nazwać procedury składowane TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="6d720-190">Użyj nazw `Employees_Select`, `Employees_Insert`, `Employees_Update`i `Employees_Delete`, jak pokazano na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="6d720-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="6d720-191">[Nazwa ![procedury składowane TableAdapter](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="6d720-192">**Ilustracja 6**. Nazwij procedury składowane TableAdapter ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>

<span data-ttu-id="6d720-193">Ostatni krok monituje nas o nazwę metod TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="6d720-194">Użyj `Fill` i `GetEmployees` jako nazw metod.</span><span class="sxs-lookup"><span data-stu-id="6d720-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="6d720-195">Pamiętaj również, aby pozostawić zaznaczone pole wyboru Utwórz metody do wysyłania aktualizacji bezpośrednio do bazy danych (GenerateDBDirectMethods).</span><span class="sxs-lookup"><span data-stu-id="6d720-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="6d720-196">[![Nazwij metody TableAdapter i GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="6d720-197">**Rysunek 7**. Nazwij metody TableAdapter s `Fill` i `GetEmployees` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>

<span data-ttu-id="6d720-198">Po zakończeniu działania kreatora Poświęć chwilę na przeanalizowanie procedur składowanych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="6d720-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="6d720-199">Powinny być widoczne cztery nowe: `Employees_Select`, `Employees_Insert`, `Employees_Update`i `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="6d720-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="6d720-200">Następnie sprawdź `EmployeesDataTable` i `EmployeesTableAdapter` utworzone.</span><span class="sxs-lookup"><span data-stu-id="6d720-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="6d720-201">Element DataTable zawiera kolumnę dla każdego pola zwróconego przez zapytanie główne.</span><span class="sxs-lookup"><span data-stu-id="6d720-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="6d720-202">Kliknij TableAdapter, a następnie przejdź do okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d720-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="6d720-203">Zobaczysz, że właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand` są poprawnie skonfigurowane do wywoływania odpowiednich procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="6d720-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="6d720-204">[![TableAdapter obejmuje możliwości wstawiania, aktualizowania i usuwania](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="6d720-205">**Ilustracja 8**. TableAdapter zawiera możliwości INSERT, Update i Delete ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>

<span data-ttu-id="6d720-206">Przy użyciu automatycznie utworzonych i `InsertCommand``UpdateCommand`, aktualizacji i właściwości przechowywanych procedury składowane INSERT, Update i `DeleteCommand` są gotowe do dostosowania procedury składowanej `SelectCommand` s w celu zwrócenia dodatkowych informacji na temat każdego z menedżerów pracowników.</span><span class="sxs-lookup"><span data-stu-id="6d720-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="6d720-207">W szczególnych przypadkach należy zaktualizować `Employees_Select` procedury składowanej, aby użyć `JOIN` i zwrócić wartości `FirstName` i `LastName` Menedżera.</span><span class="sxs-lookup"><span data-stu-id="6d720-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="6d720-208">Po zaktualizowaniu procedury składowanej należy zaktualizować element DataTable, aby zawierał te dodatkowe kolumny.</span><span class="sxs-lookup"><span data-stu-id="6d720-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="6d720-209">Te dwa zadania zostaną przedstawione w krokach 2 i 3.</span><span class="sxs-lookup"><span data-stu-id="6d720-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="6d720-210">Krok 2. Dostosowywanie procedury składowanej w celu uwzględnienia`JOIN`</span><span class="sxs-lookup"><span data-stu-id="6d720-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="6d720-211">Zacznij od przechodzenia do Eksplorator serwera, przechodzenie do szczegółów folderu procedur składowanych Northwind Database i otwieranie `Employees_Select` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="6d720-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="6d720-212">Jeśli nie widzisz tej procedury składowanej, kliknij prawym przyciskiem myszy folder procedury składowane i wybierz polecenie Odśwież.</span><span class="sxs-lookup"><span data-stu-id="6d720-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="6d720-213">Zaktualizuj procedurę składowaną, tak aby używała `LEFT JOIN` do zwrócenia najpierw Menedżera i nazwisko:</span><span class="sxs-lookup"><span data-stu-id="6d720-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="6d720-214">Po zaktualizowaniu instrukcji `SELECT` Zapisz zmiany, przechodząc do menu plik i wybierając pozycję Zapisz `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="6d720-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="6d720-215">Alternatywnie możesz kliknąć ikonę Zapisz na pasku narzędzi lub nacisnąć klawisze CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="6d720-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="6d720-216">Po zapisaniu zmian kliknij prawym przyciskiem myszy `Employees_Select` procedury składowanej w Eksplorator serwera i wybierz polecenie Execute (wykonaj).</span><span class="sxs-lookup"><span data-stu-id="6d720-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="6d720-217">Spowoduje to uruchomienie procedury składowanej i wyświetlenie jej wyników w oknie danych wyjściowych (zobacz rysunek 9).</span><span class="sxs-lookup"><span data-stu-id="6d720-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="6d720-218">[![wyniki procedur składowanych są wyświetlane w Okno Dane wyjściowe](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="6d720-219">**Ilustracja 9**. wyniki procedur składowanych są wyświetlane w okno dane wyjściowe ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="6d720-220">Krok 3. aktualizowanie kolumn DataTable s</span><span class="sxs-lookup"><span data-stu-id="6d720-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="6d720-221">W tym momencie `Employees_Select` procedura składowana zwraca `ManagerFirstName` i `ManagerLastName` wartości, ale w `EmployeesDataTable` brakuje tych kolumn.</span><span class="sxs-lookup"><span data-stu-id="6d720-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="6d720-222">Te brakujące kolumny można dodać do elementu DataTable na jeden z dwóch sposobów:</span><span class="sxs-lookup"><span data-stu-id="6d720-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="6d720-223">**Ręcznie** — kliknij prawym przyciskiem myszy element DataTable w Projektancie obiektów DataSet, a następnie w menu Dodaj wybierz pozycję kolumna.</span><span class="sxs-lookup"><span data-stu-id="6d720-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="6d720-224">Następnie można nazwać kolumnę i odpowiednio ustawić jej właściwości.</span><span class="sxs-lookup"><span data-stu-id="6d720-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="6d720-225">**Automatycznie** — Kreator konfiguracji TableAdapter zaktualizuje kolumny DataTable s w celu odzwierciedlenia pól zwracanych przez `SelectCommand` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="6d720-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="6d720-226">W przypadku korzystania z instrukcji SQL ad hoc kreator usunie również właściwości `InsertCommand`, `UpdateCommand`i `DeleteCommand`, ponieważ `SelectCommand` zawiera teraz `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="6d720-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="6d720-227">Jednak w przypadku korzystania z procedur składowanych te właściwości poleceń pozostają nienaruszone.</span><span class="sxs-lookup"><span data-stu-id="6d720-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="6d720-228">Dodaliśmy ręczne dodawaj kolumny DataTable w poprzednich samouczkach, w tym [wzorzec/szczegóły przy użyciu listy punktowanej rekordów głównych z szczegółami DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) i [przekazywania plików](../working-with-binary-files/uploading-files-vb.md), a my poznamy ten proces ponownie w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="6d720-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="6d720-229">Jednak w tym samouczku użyjemy automatycznej metody za pomocą Kreatora konfiguracji TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="6d720-230">Zacznij od kliknięcia prawym przyciskiem myszy `EmployeesTableAdapter` i wybrania opcji Konfiguruj z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="6d720-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="6d720-231">Spowoduje to wyświetlenie Kreatora konfiguracji TableAdapter, w którym są wyświetlane procedury składowane używane do wybierania, wstawiania, aktualizowania i usuwania oraz ich wartości zwracane i parametry (jeśli istnieją).</span><span class="sxs-lookup"><span data-stu-id="6d720-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="6d720-232">Ten Kreator zawiera rysunek 10.</span><span class="sxs-lookup"><span data-stu-id="6d720-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="6d720-233">W tym miejscu możemy zobaczyć, że `Employees_Select` procedura składowana zwróci teraz pola `ManagerFirstName` i `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="6d720-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="6d720-234">[![Kreator wyświetla listę zaktualizowanych kolumn dla procedury składowanej Employees_Select](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="6d720-235">**Ilustracja 10**. Kreator wyświetla zaktualizowaną listę kolumn dla `Employees_Select` procedury składowanej ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>

<span data-ttu-id="6d720-236">Aby zakończyć pracę kreatora, kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="6d720-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="6d720-237">Po powrocie do projektanta obiektów DataSet `EmployeesDataTable` obejmuje dwie dodatkowe kolumny: `ManagerFirstName` i `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="6d720-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="6d720-238">[![EmployeesDataTable zawiera dwie nowe kolumny](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="6d720-239">**Ilustracja 11**. `EmployeesDataTable` zawiera dwie nowe kolumny ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>

<span data-ttu-id="6d720-240">Aby zilustrować, że uaktualniona `Employees_Select` procedura składowana obowiązuje i że możliwości wstawiania, aktualizowania i usuwania TableAdapter są nadal funkcjonalne, Utwórz stronę sieci Web, która umożliwia użytkownikom wyświetlanie i usuwanie pracowników.</span><span class="sxs-lookup"><span data-stu-id="6d720-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="6d720-241">Przed utworzeniem takiej strony musimy jednak najpierw utworzyć nową klasę w warstwie logiki biznesowej do pracy z pracownikami z zestawu danych `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="6d720-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="6d720-242">W kroku 4 utworzymy klasę `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="6d720-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="6d720-243">W kroku 5 będziemy używać tej klasy ze strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6d720-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="6d720-244">Krok 4. Implementowanie warstwy logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="6d720-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="6d720-245">Utwórz nowy plik klasy w folderze `~/App_Code/BLL` o nazwie `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="6d720-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="6d720-246">Ta klasa naśladuje semantykę istniejącej klasy `EmployeesBLL`, tylko ten nowy z nich zapewnia mniejszą liczbę metod i używa `NorthwindWithSprocs` zestawu danych (zamiast zestawu danych `Northwind`).</span><span class="sxs-lookup"><span data-stu-id="6d720-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="6d720-247">Dodaj następujący kod do klasy `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="6d720-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="6d720-248">Właściwość `Adapter` `EmployeesBLLWithSprocs` klasy s zwraca wystąpienie `NorthwindWithSprocs` `EmployeesTableAdapter`zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="6d720-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="6d720-249">Jest on używany przez metody `GetEmployees` i `DeleteEmployee` klasy.</span><span class="sxs-lookup"><span data-stu-id="6d720-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="6d720-250">Metoda `GetEmployees` wywołuje `EmployeesTableAdapter` `GetEmployees` odpowiadającą metodzie, która wywołuje `Employees_Select` procedurę składowaną i wypełnia wyniki w `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="6d720-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="6d720-251">Metoda `DeleteEmployee` podobnie wywołuje metodę `EmployeesTableAdapter` s `Delete`, która wywołuje `Employees_Delete` procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="6d720-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="6d720-252">Krok 5. Praca z danymi w warstwie prezentacji</span><span class="sxs-lookup"><span data-stu-id="6d720-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="6d720-253">Po zakończeniu `EmployeesBLLWithSprocs`j klasy wszystko gotowe do pracy z danymi pracownika za pomocą strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6d720-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="6d720-254">Otwórz stronę `JOINs.aspx` w folderze `AdvancedDAL` i przeciągnij widok GridView z przybornika do projektanta, ustawiając jego właściwość `ID` na `Employees`.</span><span class="sxs-lookup"><span data-stu-id="6d720-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="6d720-255">Następnie w tagu inteligentnym GridView należy powiązać siatkę z nową kontrolką ObjectDataSource o nazwie `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="6d720-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="6d720-256">Skonfiguruj element ObjectDataSource do używania klasy `EmployeesBLLWithSprocs` i z kart wybierz i Usuń upewnij się, że na listach rozwijanych są wybrane metody `GetEmployees` i `DeleteEmployee`.</span><span class="sxs-lookup"><span data-stu-id="6d720-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="6d720-257">Kliknij przycisk Zakończ, aby zakończyć konfigurację elementu ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="6d720-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="6d720-258">[![skonfigurować element ObjectDataSource do używania klasy EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="6d720-259">**Ilustracja 12**. Konfigurowanie elementu ObjectDataSource do używania klasy `EmployeesBLLWithSprocs` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>

<span data-ttu-id="6d720-260">[![, aby element ObjectDataSource używał metod GetEmployees i DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="6d720-261">**Ilustracja 13**. aby element ObjectDataSource używał metod `GetEmployees` i `DeleteEmployee` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>

<span data-ttu-id="6d720-262">Program Visual Studio doda BoundField do widoku GridView dla każdej z kolumn `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="6d720-263">Usuń wszystkie te BoundFields z wyjątkiem `Title`, `LastName`, `FirstName`, `ManagerFirstName`i `ManagerLastName`, a następnie zmień nazwę `HeaderText` właściwości dla ostatnich czterech BoundFields na nazwisko, imię, nazwisko, imię i nazwisko, a Menedżer s odpowiednio nazwisko.</span><span class="sxs-lookup"><span data-stu-id="6d720-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="6d720-264">Aby umożliwić użytkownikom usuwanie pracowników z tej strony, musimy wykonać dwie rzeczy.</span><span class="sxs-lookup"><span data-stu-id="6d720-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="6d720-265">Najpierw poinstruuj widok GridView, aby udostępnić możliwości usuwania, sprawdzając opcję Włącz usuwanie z jej tagu inteligentnego.</span><span class="sxs-lookup"><span data-stu-id="6d720-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="6d720-266">Następnie zmień właściwość `OldValuesParameterFormatString` ObjectDataSource s z wartości ustawionej przez kreatora ObjectDataSource (`original_{0}`) na wartość domyślną (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="6d720-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="6d720-267">Po wprowadzeniu tych zmian, znaczniki deklaratywne GridView i ObjectDataSource s powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="6d720-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="6d720-268">Przetestuj stronę, odwiedzając ją za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="6d720-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="6d720-269">Jak pokazano na rysunku 14, na stronie zostanie wyświetlona lista każdego pracownika i jego nazwa kierownika (przy założeniu, że ma ona jeden).</span><span class="sxs-lookup"><span data-stu-id="6d720-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="6d720-270">[![SPRZĘŻENIa w procedurze składowanej Employees_Select zwraca nazwę Menedżera](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="6d720-271">**Ilustracja 14**. `JOIN` w procedurze składowanej `Employees_Select` zwraca nazwę Menedżera ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>

<span data-ttu-id="6d720-272">Kliknięcie przycisku Usuń powoduje uruchomienie usuwania przepływu pracy, który culminates wykonywanie procedury składowanej `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="6d720-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="6d720-273">Jednak próba `DELETE` instrukcji w procedurze składowanej kończy się niepowodzeniem z powodu naruszenia ograniczenia klucza obcego (patrz rysunek 15).</span><span class="sxs-lookup"><span data-stu-id="6d720-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="6d720-274">W każdym przypadku każdy pracownik ma jeden lub więcej rekordów w tabeli `Orders`, co powoduje niepowodzenie usuwania.</span><span class="sxs-lookup"><span data-stu-id="6d720-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="6d720-275">[![usunięcie pracownika, który ma odpowiednie zamówienia, spowoduje naruszenie ograniczenia klucza obcego](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="6d720-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="6d720-276">**Ilustracja 15**. Usuwanie pracownika z odpowiednimi zamówieniami skutkuje naruszeniem ograniczenia klucza obcego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="6d720-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>

<span data-ttu-id="6d720-277">Aby zezwolić na usunięcie pracownika, możesz:</span><span class="sxs-lookup"><span data-stu-id="6d720-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="6d720-278">Zaktualizuj ograniczenie klucza obcego do usuwania kaskadowego,</span><span class="sxs-lookup"><span data-stu-id="6d720-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="6d720-279">Ręcznie usuń rekordy z tabeli `Orders` dla pracowników, które chcesz usunąć.</span><span class="sxs-lookup"><span data-stu-id="6d720-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="6d720-280">Zaktualizuj procedurę składowaną `Employees_Delete`, aby najpierw usunąć powiązane rekordy z tabeli `Orders` przed usunięciem rekordu `Employees`.</span><span class="sxs-lookup"><span data-stu-id="6d720-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="6d720-281">Omawiana technika została omówiona w [istniejących procedurach składowanych w samouczku TableAdapters zestawu danych](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="6d720-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="6d720-282">Jestem tym ćwiczeniem dla czytnika.</span><span class="sxs-lookup"><span data-stu-id="6d720-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="6d720-283">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="6d720-283">Summary</span></span>

<span data-ttu-id="6d720-284">Podczas pracy z relacyjnymi bazami danych często zapytania pobierają dane z wielu powiązanych tabel.</span><span class="sxs-lookup"><span data-stu-id="6d720-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="6d720-285">Skorelowane podzapytania i `JOIN` s zapewniają dwie różne techniki uzyskiwania dostępu do danych z powiązanych tabel w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="6d720-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="6d720-286">W poprzednich samouczkach najczęściej używano skorelowanych podkwerend, ponieważ TableAdapter nie może automatycznie generować instrukcji `INSERT`, `UPDATE`i `DELETE` dla zapytań obejmujących `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="6d720-287">Te wartości można podać ręcznie, podczas korzystania z instrukcji SQL ad hoc wszystkie dostosowania zostaną nadpisywane po zakończeniu działania Kreatora konfiguracji TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="6d720-288">Na szczęście TableAdapters utworzone przy użyciu procedur składowanych nie pogorszą się od tych samych brittleness, co te utworzone przy użyciu instrukcji SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="6d720-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="6d720-289">W związku z tym jest możliwe utworzenie elementu TableAdapter, którego główne zapytanie używa `JOIN` podczas korzystania z procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="6d720-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="6d720-290">W tym samouczku przedstawiono sposób tworzenia takich TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="6d720-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="6d720-291">Uruchomiono za pomocą zapytania `SELECT` `JOIN`-less dla zapytania głównego TableAdapter s, aby odpowiednie procedury składowane INSERT, Update i DELETE byłyby tworzone na podstawie autostartu.</span><span class="sxs-lookup"><span data-stu-id="6d720-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="6d720-292">Po zakończeniu konfiguracji początkowej TableAdapter s podaliśmy procedurę składowaną `SelectCommand`, aby użyć `JOIN` i ponownie uruchomiła Kreatora konfiguracji TableAdapter w celu zaktualizowania kolumn `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="6d720-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="6d720-293">Ponowne uruchomienie Kreatora konfiguracji programu TableAdapter automatycznie zaktualizowała kolumny `EmployeesDataTable`, aby odzwierciedlały pola danych zwracane przez `Employees_Select` procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="6d720-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="6d720-294">Alternatywnie, możemy dodać te kolumny ręcznie do elementu DataTable.</span><span class="sxs-lookup"><span data-stu-id="6d720-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="6d720-295">Będziemy eksplorować Ręczne dodawanie kolumn do tabeli DataTable w następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="6d720-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="6d720-296">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="6d720-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6d720-297">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="6d720-297">About the Author</span></span>

<span data-ttu-id="6d720-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="6d720-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6d720-299">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="6d720-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6d720-300">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6d720-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6d720-301">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6d720-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6d720-302">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6d720-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6d720-303">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="6d720-303">Special Thanks To</span></span>

<span data-ttu-id="6d720-304">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="6d720-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6d720-305">Recenzenci liderzy dla tego samouczka to Hilton Geisenow, David suru i Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="6d720-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="6d720-306">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="6d720-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6d720-307">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6d720-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6d720-308">[Poprzednie](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [dalej](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6d720-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
