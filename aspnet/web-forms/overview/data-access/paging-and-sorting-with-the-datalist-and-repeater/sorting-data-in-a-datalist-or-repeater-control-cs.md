---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: Sortowanie danych w kontrolce DataList lub WzmacniakeC#() | Microsoft Docs
author: rick-anderson
description: W tym samouczku dowiesz się, jak uwzględnić obsługę sortowania w elemencie DataList i Wzmacniake, a także jak utworzyć element DataList lub wzmacniak, którego dane mogą...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 66a09c637d33c812b39e0ce85a552bd71665a2e1
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74634663"
---
# <a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="9ddb4-103">Sortowanie danych w kontrolce DataList lub Repeater (C#)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>

<span data-ttu-id="9ddb4-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9ddb4-105">[Pobierz przykładową aplikację](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) lub [Pobierz plik PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="9ddb4-106">W tym samouczku dowiesz się, jak uwzględnić obsługę sortowania w elemencie DataList i Wzmacniake, a także jak utworzyć element DataList lub wzmacniak, którego dane mogą być stronicowane i posortowane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="introduction"></a><span data-ttu-id="9ddb4-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="9ddb4-107">Introduction</span></span>

<span data-ttu-id="9ddb4-108">W [poprzednim samouczku](paging-report-data-in-a-datalist-or-repeater-control-cs.md) sprawdziłmy, jak dodać obsługę stronicowania do elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="9ddb4-109">Utworzyliśmy nową metodę w klasie `ProductsBLL` (`GetProductsAsPagedDataSource`), która zwróciła obiekt `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="9ddb4-110">Gdy jest to powiązane z elementem DataList lub wzmacniak, element DataList lub wzmacniak wyświetli tylko żądaną stronę danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="9ddb4-111">Ta technika jest podobna do tego, co jest używane wewnętrznie przez kontrolki GridView, DetailsView i FormView, aby zapewnić wbudowane funkcje stronicowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="9ddb4-112">Oprócz oferowania obsługi stronicowania, widok GridView obejmuje również obsługę sortowania w polu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="9ddb4-113">Żadna z elementów DataList i wzmacniak nie zapewnia wbudowanej funkcji sortowania; jednak sortowanie funkcji można dodać przy użyciu bitu kodu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="9ddb4-114">W tym samouczku dowiesz się, jak uwzględnić obsługę sortowania w elemencie DataList i Wzmacniake, a także jak utworzyć element DataList lub wzmacniak, którego dane mogą być stronicowane i posortowane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="9ddb4-115">Przegląd sortowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-115">A Review of Sorting</span></span>

<span data-ttu-id="9ddb4-116">Jak opisano w samouczku dotyczącego [stronicowania i sortowania danych raportu](../paging-and-sorting/paging-and-sorting-report-data-cs.md) , kontrolka GridView udostępnia pomoc techniczną do sortowania pól.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="9ddb4-117">Każde pole GridView może mieć skojarzone `SortExpression`, które wskazuje pole danych, według którego mają być sortowane dane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="9ddb4-118">Gdy właściwość GridView `AllowSorting` jest ustawiona na `true`, każde pole GridView, które ma `SortExpression` wartość właściwości, ma swój nagłówek renderowany jako element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="9ddb4-119">Gdy użytkownik kliknie konkretny nagłówek pola GridView, następuje odświeżenie, a dane są sortowane według klikniętego pola s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="9ddb4-120">Formant GridView ma również właściwość `SortExpression`, która przechowuje `SortExpression` pola GridView, według którego są sortowane dane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="9ddb4-121">Ponadto Właściwość `SortDirection` wskazuje, czy dane mają być sortowane w kolejności rosnącej czy malejącej (Jeśli użytkownik kliknie dwa razy łącze nagłówka pola GridView), kolejność sortowania jest przełączana.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="9ddb4-122">Gdy widok GridView jest powiązany z jego kontrolą źródła danych, `SortExpression` i `SortDirection` właściwości do kontroli źródła danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="9ddb4-123">Formant źródła danych pobiera dane, a następnie sortuje je według podanych `SortExpression` i `SortDirection` właściwości.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="9ddb4-124">Po posortowaniu danych formant źródła danych zwraca go do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="9ddb4-125">Aby replikować tę funkcję za pomocą kontrolek DataList lub wzmacniak, musimy:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="9ddb4-126">Tworzenie interfejsu sortowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-126">Create a sorting interface</span></span>
- <span data-ttu-id="9ddb4-127">Zapamiętaj pole danych, według którego ma zostać wykonane sortowanie, i czy ma być sortowane w kolejności rosnącej czy malejącej</span><span class="sxs-lookup"><span data-stu-id="9ddb4-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="9ddb4-128">Poinstruuj element ObjectDataSource, aby posortować dane według określonego pola danych</span><span class="sxs-lookup"><span data-stu-id="9ddb4-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="9ddb4-129">Te trzy zadania zostaną przedstawione w krokach 3 i 4.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="9ddb4-130">Poniżej opisano, jak uwzględnić obsługę stronicowania i sortowania w elemencie DataList lub Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="9ddb4-131">Krok 2. Wyświetlanie produktów w Wzmacniake</span><span class="sxs-lookup"><span data-stu-id="9ddb4-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="9ddb4-132">Przed zainstalowaniem dowolnych funkcji związanych z sortowaniem Zacznij od poinformowania o produktach w kontrolce wzmacniania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="9ddb4-133">Zacznij od otwarcia strony `Sorting.aspx` w folderze `PagingSortingDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="9ddb4-134">Dodaj kontrolkę wzmacniak do strony sieci Web, ustawiając jej Właściwość `ID` na `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="9ddb4-135">W tagu inteligentnym wzmacniak Utwórz nowy element ObjectDataSource o nazwie `ProductsDataSource` i skonfiguruj go tak, aby pobierał dane z metody `GetProducts()` klasy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="9ddb4-136">Wybierz opcję (brak) z listy rozwijanej na kartach Wstawianie, aktualizowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="9ddb4-137">[![utworzyć elementu ObjectDataSource i skonfigurować go tak, aby korzystał z metody GetProductsAsPagedDataSource ()](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="9ddb4-138">**Rysunek 1**. Utwórz element ObjectDataSource i skonfiguruj go tak, aby korzystał z metody `GetProductsAsPagedDataSource()` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>

<span data-ttu-id="9ddb4-139">[![ustawić listy rozwijane na kartach Aktualizuj, Wstaw i Usuń do (brak).](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="9ddb4-140">**Rysunek 2**. Ustawianie list rozwijanych w kartach Aktualizuj, Wstaw i Usuń do (brak) ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>

<span data-ttu-id="9ddb4-141">W przeciwieństwie do obiektu DataList, program Visual Studio nie tworzy automatycznie `ItemTemplate` dla formantu wzmacniak po powiązaniu go ze źródłem danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="9ddb4-142">Ponadto należy dodać tę `ItemTemplate` deklaratywnie, ponieważ tag inteligentny kontrolka nie ma opcji Edytuj szablony znalezionej w elemencie DataList s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="9ddb4-143">Niech s użyje tego samego `ItemTemplate` z poprzedniego samouczka, w którym wyświetlana jest nazwa produktu, dostawca i Kategoria.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="9ddb4-144">Po dodaniu `ItemTemplate`u znaczniki deklaratywne i ObjectDataSource s powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="9ddb4-145">Rysunek 3 przedstawia Tę stronę, gdy jest wyświetlany za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-145">Figure 3 shows this page when viewed through a browser.</span></span>

<span data-ttu-id="9ddb4-146">[![zostanie wyświetlona nazwa każdego produktu, dostawcy i kategorii](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="9ddb4-147">**Rysunek 3**. zostanie wyświetlona nazwa każdego produktu, dostawcy i kategorii ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>

## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="9ddb4-148">Krok 3. nakazuje elementowi ObjectDataSource sortowanie danych</span><span class="sxs-lookup"><span data-stu-id="9ddb4-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="9ddb4-149">Aby posortować dane wyświetlane w Wzmacniake, musimy poinformować element ObjectDataSource wyrażenia Sort, według którego mają być sortowane dane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="9ddb4-150">Przed pobraniem danych przez element ObjectDataSource zostanie najpierw wyzwolone jego [zdarzenie`Selecting`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), które pozwala nam określić wyrażenie sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="9ddb4-151">Procedura obsługi zdarzeń `Selecting` jest przenoszona do obiektu typu [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), który ma właściwość o nazwie [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="9ddb4-152">Klasa `DataSourceSelectArguments` została zaprojektowana w celu przekazywania żądań związanych z danymi od konsumenta danych do kontroli źródła danych i zawiera [właściwość`SortExpression`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="9ddb4-153">Aby przekazać informacje o sortowaniu ze strony ASP.NET do elementu ObjectDataSource, Utwórz procedurę obsługi zdarzeń dla zdarzenia `Selecting` i użyj następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="9ddb4-154">Wartość *'sortexpression* powinna mieć przypisaną nazwę pola danych, według którego będą sortowane dane (na przykład ProductName).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="9ddb4-155">Nie ma żadnej właściwości związanej z kierunkiem sortowania, dlatego jeśli chcesz sortować dane w kolejności malejącej, Dołącz wartość DESC ciągu do wartości *'sortexpression* (np. ProductName).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="9ddb4-156">Spróbuj wykonać inne zakodowane wartości *'sortexpression* i przetestuj wyniki w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="9ddb4-157">Jak pokazano na rysunku 4, jeśli jako *'sortexpression*jest używany Opis programu ProductName, produkty są sortowane według nazwy w odwrotnej kolejności alfabetycznej.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="9ddb4-158">[![produkty są sortowane według nazwy w odwrotnej kolejności alfabetycznej](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="9ddb4-159">**Ilustracja 4**. produkty są sortowane według nazwy w odwrotnej kolejności alfabetycznej ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>

## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="9ddb4-160">Krok 4. Tworzenie interfejsu sortowania i zapamiętywanie wyrażenia sortowania i kierunku</span><span class="sxs-lookup"><span data-stu-id="9ddb4-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="9ddb4-161">Włączenie obsługi sortowania w widoku GridView spowoduje przekonwertowanie każdego tekstu nagłówka pola sortowania w element LinkButton, który po kliknięciu sortuje odpowiednio dane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="9ddb4-162">Taki interfejs sortowania ma sens dla widoku GridView, gdzie jego dane są starannie ułożone w kolumnach.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="9ddb4-163">Jednak dla kontrolek DataList i wzmacniak jest wymagany inny interfejs sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="9ddb4-164">Typowy interfejs sortowania dla listy danych (w przeciwieństwie do siatki danych) jest listą rozwijaną, która dostarcza pola, według których dane mogą być sortowane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="9ddb4-165">Zezwól na wdrożenie takiego interfejsu dla tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="9ddb4-166">Dodaj kontrolkę sieci Web DropDownList powyżej wzmacniaka `SortableProducts` i ustaw jej Właściwość `ID` na `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="9ddb4-167">Na okno Właściwości kliknij wielokropek we właściwości `Items`, aby wyświetlić Edytor kolekcji ListItem.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="9ddb4-168">Dodaj `ListItem` s, aby posortować dane według pól `ProductName`, `CategoryName`i `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="9ddb4-169">Dodaj również `ListItem`, aby posortować produkty według ich nazwy w odwrotnej kolejności alfabetycznej.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="9ddb4-170">Właściwości `ListItem` `Text` można ustawić na dowolną wartość (taką jak nazwa), ale właściwości `Value` muszą być ustawione na nazwę pola danych (na przykład ProductName).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="9ddb4-171">Aby posortować wyniki w kolejności malejącej, Dołącz wartość DESC ciągu do nazwy pola danych, na przykład ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>

![Dodaj element ListItem dla każdego z pól danych do sortowania](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="9ddb4-173">**Rysunek 5**. Dodawanie `ListItem` dla każdego z pól danych do sortowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>

<span data-ttu-id="9ddb4-174">Na koniec Dodaj kontrolkę sieci Web przycisk po prawej stronie DropDownList.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="9ddb4-175">Ustaw jej `ID` na `RefreshRepeater` i jej Właściwość `Text` do odświeżenia.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="9ddb4-176">Po utworzeniu `ListItem` s i dodaniem przycisku Odśwież składni deklaracyjnej DropDownList i Button powinna wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="9ddb4-177">Po ukończeniu sortowania DropDownList należy najpierw zaktualizować procedurę obsługi zdarzeń elementu ObjectDataSource s `Selecting`, tak aby używała wybranej właściwości `SortBy``ListItem` s `Value` w przeciwieństwie do zakodowanego wyrażenia sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="9ddb4-178">W tym momencie podczas pierwszego odwiedzania strony produkty będą początkowo sortowane według pola danych `ProductName`, ponieważ `SortBy` `ListItem` wybrane domyślnie (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="9ddb4-179">Wybranie innej opcji sortowania, takiej jak kategoria i kliknięcie przycisku Odśwież spowoduje wystąpienie zwrotne i ponowne sortowanie danych według nazwy kategorii, jak pokazano na rysunku 7.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>

<span data-ttu-id="9ddb4-180">[![produkty są początkowo sortowane według ich nazwy](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="9ddb4-181">**Ilustracja 6**. produkty są początkowo sortowane według ich nazwy ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>

<span data-ttu-id="9ddb4-182">[![produkty są teraz sortowane według kategorii](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="9ddb4-183">**Rysunek 7**. produkty są teraz sortowane według kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ddb4-184">Kliknięcie przycisku Odśwież powoduje, że dane zostaną automatycznie posortowane, ponieważ stan widoku wzmacniak został wyłączony, co powoduje, że wzmacniak ponownie powiąże się ze źródłem danych na każdym odświeżeniu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="9ddb4-185">Jeśli pozostawiono stan widoku wzmacniak s włączony, zmiana listy rozwijanej sortowania nie będzie miała wpływu na kolejność sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="9ddb4-186">Aby rozwiązać ten wyjątek, należy utworzyć procedurę obsługi zdarzeń dla zdarzenia `Click` przycisku Odśwież i ponownie powiązać wzmacniak z jego źródłem danych (wywołując metodę `DataBind()`a.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>

## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="9ddb4-187">Zapamiętywanie wyrażenia sortowania i kierunku</span><span class="sxs-lookup"><span data-stu-id="9ddb4-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="9ddb4-188">Podczas tworzenia elementu DataList lub wzmacniak do sortowania na stronie, w której mogą wystąpić odświeżenia odnoszące się do sortowania, należy pamiętać, że wyrażenie sortowania i kierunek są zapamiętywane na stronach ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="9ddb4-189">Załóżmy na przykład, że zaktualizowaliśmy wzmacniak w tym samouczku, aby dodać przycisk Usuń dla każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="9ddb4-190">Gdy użytkownik kliknie przycisk Usuń, należy uruchomić kod, aby usunąć wybrany produkt, a następnie ponownie powiązać dane z Wzmacniakem.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="9ddb4-191">Jeśli szczegóły sortowania nie są utrwalane w odniesieniu do ogłaszania zwrotnego, dane wyświetlane na ekranie zostaną przywrócone do oryginalnej kolejności sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="9ddb4-192">W tym samouczku DropDownList niejawnie zapisuje wyrażenie sortowania i kierunek w stanie widoku dla nas.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="9ddb4-193">Jeśli korzystamy z innego interfejsu sortowania o jeden z, powiedzmy, LinkButtons, który dostarczył różne opcje sortowania, mamy zadbać o zapamiętanie kolejności sortowania na stronach ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="9ddb4-194">Można to osiągnąć przez przechowywanie parametrów sortowania w stanie widoku strony, przez uwzględnienie parametru Sort w ciągu QueryString lub innej metody trwałości stanu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="9ddb4-195">W przyszłości przykłady w tym samouczku dowiesz się, jak utrwalać szczegóły sortowania w stanie widoku strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="9ddb4-196">Krok 5. Dodawanie obsługi sortowania do elementu DataList używającego domyślnego stronicowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="9ddb4-197">W [poprzednim samouczku](paging-report-data-in-a-datalist-or-repeater-control-cs.md) sprawdziłmy, jak zaimplementować domyślne stronicowanie za pomocą elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="9ddb4-198">Pozwól s zwiększyć ten poprzedni przykład, aby uwzględnić możliwość sortowania danych stronicowanych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="9ddb4-199">Zacznij od otwarcia stron `SortingWithDefaultPaging.aspx` i `Paging.aspx` w folderze `PagingSortingDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="9ddb4-200">Na stronie `Paging.aspx` kliknij przycisk Source (Źródło), aby wyświetlić znaczniki deklaratywne strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="9ddb4-201">Skopiuj zaznaczony tekst (patrz rysunek 8) i wklej go do deklaratywnego znacznika `SortingWithDefaultPaging.aspx` między tagami `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>

<span data-ttu-id="9ddb4-202">[![przeprowadzić replikację deklaratywnego znacznika w &lt;ASP: Content&gt; tagów z pliku stronicowania. aspx do SortingWithDefaultPaging. aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="9ddb4-203">**Ilustracja 8**. replikowanie znaczników deklaratywnych w `<asp:Content>` tagów z `Paging.aspx` do `SortingWithDefaultPaging.aspx` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>

<span data-ttu-id="9ddb4-204">Po skopiowaniu oznakowania deklaracyjnego Skopiuj metody i właściwości w klasie `Paging.aspx`ej z kodem związanym ze stroną do klasy związanej z kodem dla `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="9ddb4-205">Następnie Poświęć chwilę na wyświetlenie strony `SortingWithDefaultPaging.aspx` w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="9ddb4-206">Powinien on mieć taką samą funkcjonalność i wygląd jak `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="9ddb4-207">Rozszerzanie ProductsBLL w celu uwzględnienia domyślnej metody stronicowania i sortowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="9ddb4-208">W poprzednim samouczku utworzyliśmy metodę `GetProductsAsPagedDataSource(pageIndex, pageSize)` w klasie `ProductsBLL`, która zwróciła obiekt `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="9ddb4-209">Ten obiekt `PagedDataSource` został wypełniony *wszystkimi* produktami (za pośrednictwem metody `GetProducts()` logiki biznesowej s), ale w przypadku powiązana z kolumną DataList są wyświetlane tylko te rekordy, które odpowiadają określonym parametrom wejściowym *pageIndex* i *PageSize* .</span><span class="sxs-lookup"><span data-stu-id="9ddb4-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="9ddb4-210">Wcześniej w tym samouczku dodaliśmy obsługę sortowania, określając wyrażenie sortowania z programu obsługi zdarzeń `Selecting` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="9ddb4-211">Jest to dobre rozwiązanie, gdy element ObjectDataSource zwraca obiekt, który może być posortowany, jak `ProductsDataTable` zwracany przez metodę `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="9ddb4-212">Jednak obiekt `PagedDataSource` zwrócony przez metodę `GetProductsAsPagedDataSource` nie obsługuje sortowania jego wewnętrznego źródła danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="9ddb4-213">Zamiast tego należy posortować wyniki zwrócone przez metodę `GetProducts()` *przed* umieszczeniem jej w `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="9ddb4-214">Aby to osiągnąć, Utwórz nową metodę w klasie `ProductsBLL`, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="9ddb4-215">Aby posortować `ProductsDataTable` zwrócone przez metodę `GetProducts()`, należy określić właściwość `Sort` jej domyślnego `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="9ddb4-216">Metoda `GetProductsSortedAsPagedDataSource` różni się nieco od metody `GetProductsAsPagedDataSource` utworzonej w poprzednim samouczku.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="9ddb4-217">W szczególności `GetProductsSortedAsPagedDataSource` akceptuje dodatkowy parametr wejściowy `sortExpression` i przypisuje tę wartość do właściwości `Sort` `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="9ddb4-218">Kilka wierszy kodu później, `DefaultView``ProductDataTable` s jest przypisany do `PagedDataSource` obiektu DataSource.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="9ddb4-219">Wywoływanie metody GetProductsSortedAsPagedDataSource i określanie wartości parametru wejściowego 'Sortexpression</span><span class="sxs-lookup"><span data-stu-id="9ddb4-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="9ddb4-220">Po ukończeniu metody `GetProductsSortedAsPagedDataSource` następnym krokiem jest podanie wartości tego parametru.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="9ddb4-221">Element ObjectDataSource w `SortingWithDefaultPaging.aspx` jest obecnie skonfigurowany do wywoływania metody `GetProductsAsPagedDataSource` i przekazuje dwa parametry wejściowe za pomocą dwóch `QueryStringParameters`, które są określone w kolekcji `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="9ddb4-222">Te dwa `QueryStringParameters` wskazują, że źródło dla `GetProductsAsPagedDataSource` metod *popageindex* i *PageSize* pochodzi z pól QueryString `pageIndex` i `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="9ddb4-223">Zaktualizuj Właściwość `SelectMethod` ObjectDataSource s tak, aby wywołuje nową metodę `GetProductsSortedAsPagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="9ddb4-224">Następnie Dodaj nowe `QueryStringParameter` tak, aby parametr wejściowy *'sortexpression* był dostępny z poziomu pola QueryString `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="9ddb4-225">Ustaw `DefaultValue` `QueryStringParameter` s na ProductName.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="9ddb4-226">Po wprowadzeniu tych zmian znaczniki deklaratywne ObjectDataSource powinny wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="9ddb4-227">W tym momencie strona `SortingWithDefaultPaging.aspx` sortuje wyniki alfabetycznie według nazwy produktu (zobacz rysunek 9).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="9ddb4-228">Jest to spowodowane tym, że wartość ProductName jest domyślnie przenoszona jako parametr `GetProductsSortedAsPagedDataSource` *'sortexpression* metody s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>

<span data-ttu-id="9ddb4-229">[Domyślnie ![wyniki są sortowane według NazwaProduktu](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="9ddb4-230">**Rysunek 9**: Domyślnie wyniki są sortowane według `ProductName` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>

<span data-ttu-id="9ddb4-231">Jeśli ręcznie dodasz `sortExpression` QueryString pola, takie jak `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` wyniki zostaną posortowane według określonego `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="9ddb4-232">Jednak ten `sortExpression` parametr nie jest uwzględniony w ciągu QueryString podczas przechodzenia do innej strony danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="9ddb4-233">W rzeczywistości klikaj przyciski Dalej lub Ostatnia strona Wróć do `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="9ddb4-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="9ddb4-234">Ponadto nie ma obecnie interfejsu sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="9ddb4-235">Jedyny sposób, w jaki użytkownik może zmienić kolejność sortowania danych stronicowanych jest przez bezpośrednie manipulowanie QueryString.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="9ddb4-236">Tworzenie interfejsu sortowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="9ddb4-237">Najpierw należy zaktualizować metodę `RedirectUser`, aby wysłać użytkownika do `SortingWithDefaultPaging.aspx` (zamiast `Paging.aspx`) i dołączyć wartość `sortExpression` do ciągu QueryString.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="9ddb4-238">Należy również dodać właściwość `SortExpression` tylko do odczytu na poziomie strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="9ddb4-239">Ta właściwość, podobna do właściwości `PageIndex` i `PageSize` utworzonych w poprzednim samouczku, zwraca wartość pola `sortExpression` QueryString, jeśli istnieje, a wartość domyślna (ProductName) w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="9ddb4-240">Obecnie Metoda `RedirectUser` akceptuje tylko jeden parametr wejściowy indeksu strony do wyświetlenia.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="9ddb4-241">Mogą jednak wystąpić sytuacje, w których chcemy przekierować użytkownika do określonej strony danych przy użyciu wyrażenia sortowania innego niż określone w ciągu kwerendy.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="9ddb4-242">W tej chwili utworzymy interfejs sortowania dla tej strony, który będzie zawierać serię kontrolek sieci Web przycisków do sortowania danych według określonej kolumny.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="9ddb4-243">Po kliknięciu jednego z tych przycisków chcemy przekierować użytkownika w celu przekierowania w odpowiednie wartości wyrażenia sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="9ddb4-244">Aby zapewnić tę funkcję, należy utworzyć dwie wersje metody `RedirectUser`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="9ddb4-245">Pierwsza z nich powinna akceptować tylko indeks strony do wyświetlenia, podczas gdy druga akceptuje indeks strony i wyrażenie sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="9ddb4-246">W pierwszym przykładzie w tym samouczku utworzyliśmy interfejs sortowania przy użyciu DropDownList.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="9ddb4-247">Na potrzeby tego przykładu należy użyć trzech kontrolek sieci Web, umieszczonych powyżej elementu DataList, do sortowania według `ProductName`, jeden dla `CategoryName`i jeden dla `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="9ddb4-248">Dodaj kontrolki sieci Web z trzema przyciskami, ustawiając odpowiednio `ID` i właściwości `Text`:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="9ddb4-249">Następnie Utwórz procedurę obsługi zdarzeń `Click` dla każdej z nich.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="9ddb4-250">Procedury obsługi zdarzeń powinny wywołać metodę `RedirectUser`, zwracając użytkownika do pierwszej strony przy użyciu odpowiedniego wyrażenia sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="9ddb4-251">Podczas pierwszego odwiedzania strony dane są sortowane według nazwy produktu alfabetycznie (zapoznaj się z powrotem do rysunku 9).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="9ddb4-252">Kliknij przycisk Dalej, aby przejść do drugiej strony danych, a następnie kliknij przycisk Sortuj według kategorii.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="9ddb4-253">Spowoduje to zwrócenie do pierwszej strony danych posortowanej według nazwy kategorii (patrz rysunek 10).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="9ddb4-254">Podobnie klikając przycisk Sortuj według dostawcy sortuje dane według dostawcy, rozpoczynając od pierwszej strony danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="9ddb4-255">Wybór sortowania jest zapamiętany, ponieważ dane są stronicowane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="9ddb4-256">Rysunek 11 przedstawia stronę po sortowaniu według kategorii, a następnie przejściu do trzynastej strony danych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>

<span data-ttu-id="9ddb4-257">[![produkty są sortowane według kategorii](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="9ddb4-258">**Ilustracja 10**. produkty są sortowane według kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>

<span data-ttu-id="9ddb4-259">[![wyrażenie sortowania jest zapamiętywane podczas stronicowania danych](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="9ddb4-260">**Ilustracja 11**. wyrażenie sortowania jest zapamiętywane podczas stronicowania danych ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>

## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="9ddb4-261">Krok 6. niestandardowe stronicowanie za pomocą rekordów w Wzmacniake</span><span class="sxs-lookup"><span data-stu-id="9ddb4-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="9ddb4-262">Przykład elementu DataList zbadany w kroku 5 stron za pośrednictwem jego danych przy użyciu niewydajnej domyślnej techniki stronicowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="9ddb4-263">Podczas stronicowania przy użyciu wystarczająco dużych ilości danych jest konieczne użycie stronicowania niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="9ddb4-264">Do [wydajnego stronicowania za pomocą dużych ilości danych](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) i [sortowania niestandardowych](../paging-and-sorting/sorting-custom-paged-data-cs.md) samouczków danych z stronicowania zbadamy różnice między domyślnym i niestandardowym stronicowaniem i UTWORZONYMI metodami w logiki biznesowej na potrzeby wykorzystywania niestandardowego stronicowania i sortowania niestandardowych danych stron.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="9ddb4-265">W szczególności w tych dwóch wcześniejszych samouczkach dodaliśmy następujące trzy metody do klasy `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="9ddb4-266">`GetProductsPaged(startRowIndex, maximumRows)` zwraca określony podzbiór rekordów, zaczynając od *StartRowIndex* i nie przekracza *MaximumRows*.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="9ddb4-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` zwraca określony podzbiór rekordów posortowanych według określonego parametru wejściowego *'sortexpression* .</span><span class="sxs-lookup"><span data-stu-id="9ddb4-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="9ddb4-268">`TotalNumberOfProducts()` zawiera łączną liczbę rekordów w tabeli `Products` Database.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="9ddb4-269">Te metody mogą służyć do wydajnej strony i sortowania danych przy użyciu elementu DataList lub formantu wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="9ddb4-270">Aby to zilustrować, Zacznij od utworzenia kontrolki wzmacniak z obsługą niestandardowego stronicowania. następnie dodamy funkcje sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="9ddb4-271">Otwórz stronę `SortingWithCustomPaging.aspx` w folderze `PagingSortingDataListRepeater` i Dodaj wzmacniak do strony, ustawiając jej Właściwość `ID` na `Products`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="9ddb4-272">W tagu inteligentnym wzmacniak Utwórz nowy element ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="9ddb4-273">Skonfiguruj ją, aby wybrać jej dane z metody `GetProductsPaged` `ProductsBLL` Class.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>

<span data-ttu-id="9ddb4-274">[![skonfigurować element ObjectDataSource do używania metody GetProductsPaged klasy ProductsBLL](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="9ddb4-275">**Rysunek 12**. Konfigurowanie elementu ObjectDataSource do używania metody `GetProductsPaged` `ProductsBLL` klasy s ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>

<span data-ttu-id="9ddb4-276">Ustaw listę rozwijaną na kartach UPDATE, INSERT i DELETE na wartość (brak), a następnie kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="9ddb4-277">Kreator konfiguracji źródła danych wyświetla teraz monit dotyczący źródeł `GetProductsPaged` metod *StartRowIndex* i *MaximumRows* Input Parameters.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="9ddb4-278">W rzeczywistości te parametry wejściowe są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="9ddb4-279">Zamiast tego wartości *StartRowIndex* i *MaximumRows* będą przesyłane za pomocą właściwości `Arguments` w programie obsługi zdarzeń `Selecting` ObjectDataSource s, podobnie jak w przypadku określenia *'sortexpression* w tym samouczku pierwszej demonstracyjnej.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="9ddb4-280">W związku z tym pozostaw listę rozwijaną źródła parametrów w Kreatorze ustawionym na brak.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>

<span data-ttu-id="9ddb4-281">[![pozostawić źródła parametrów ustawione na wartość None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="9ddb4-282">**Ilustracja 13**. pozostawienie źródeł parametrów ustawionymi na None ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ddb4-283">*Nie* ustawiaj właściwości `EnablePaging` ObjectDataSource s na `true`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="9ddb4-284">Spowoduje to, że element ObjectDataSource automatycznie uwzględni własne parametry *StartRowIndex* i *MaximumRows* do listy istniejących parametrów `SelectMethod` s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="9ddb4-285">Właściwość `EnablePaging` jest przydatna podczas wiązania niestandardowych danych stronicowanych do kontrolki GridView, DetailsView lub FormView, ponieważ te kontrolki oczekują określonego zachowania z elementu ObjectDataSource, który jest dostępny tylko wtedy, gdy właściwość `EnablePaging` jest `true`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="9ddb4-286">Ponieważ trzeba ręcznie dodać obsługę stronicowania dla elementu DataList i wzmacniak, pozostaw tę właściwość ustawioną na `false` (wartość domyślna), ponieważ będziemy tworzenie w wymaganych funkcjach bezpośrednio na naszej stronie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>

<span data-ttu-id="9ddb4-287">Na koniec Zdefiniuj `ItemTemplate`ka, aby wyświetlić nazwę produktu, kategorię i dostawcę.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="9ddb4-288">Po wprowadzeniu tych zmian, składnia deklaracyjne i ObjectDataSource s powinna wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="9ddb4-289">Poświęć chwilę na odwiedzenie strony za pomocą przeglądarki i Zauważ, że żadne rekordy nie są zwracane.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="9ddb4-290">Jest to spowodowane tym, że już teraz podasz wartości parametrów *StartRowIndex* i *MaximumRows* ; w związku z tym wartości 0 są przesyłane w obu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="9ddb4-291">Aby określić te wartości, należy utworzyć procedurę obsługi zdarzeń dla zdarzenia ObjectDataSource s `Selecting` i ustawić te wartości parametrów programowo na odpowiednio kodowane wartości 0 i 5:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="9ddb4-292">Po tej zmianie Strona, która jest wyświetlana w przeglądarce, pokazuje pierwsze pięć produktów.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>

<span data-ttu-id="9ddb4-293">[![wyświetlane są pięć pierwszych rekordów](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="9ddb4-294">**Ilustracja 14**. wyświetlane są pięć pierwszych rekordów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ddb4-295">Produkty wymienione na rysunku 14 mają być sortowane według nazwy produktu, ponieważ procedura składowana `GetProductsPaged`, która wykonuje wydajne niestandardowe zapytanie stronicowania, porządkuje wyniki według `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>

<span data-ttu-id="9ddb4-296">Aby umożliwić użytkownikowi przechodzenie między stronami, musimy śledzić indeks wierszy początkowych i maksymalną liczbę wierszy oraz zapamiętać te wartości na stronach ogłaszania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="9ddb4-297">W domyślnym przykładzie stronicowania użyto pól QueryString, aby zachować te wartości. na potrzeby tego pokazu poinformuj te informacje w stanie widoku strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="9ddb4-298">Utwórz następujące dwie właściwości:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-298">Create the following two properties:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="9ddb4-299">Następnie zaktualizuj kod w programie obsługi zdarzeń Selecting, tak aby używał właściwości `StartRowIndex` i `MaximumRows` zamiast zakodowanych wartości 0 i 5:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="9ddb4-300">W tym momencie nasza strona nadal zawiera tylko pięć pierwszych rekordów.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="9ddb4-301">Jednak przy użyciu tych właściwości będziemy gotowi się do utworzenia naszego interfejsu stronicowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="9ddb4-302">Dodawanie interfejsu stronicowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-302">Adding the Paging Interface</span></span>

<span data-ttu-id="9ddb4-303">Zezwól na użycie tego samego pierwszego, poprzedniego, następnego, ostatniego interfejsu stronicowania używanego w domyślnym przykładzie stronicowania, w tym kontrolki sieci Web etykieta, która wyświetla informacje o przeglądanej stronie i liczbie istniejących stron.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="9ddb4-304">Dodaj cztery przyciski kontrolek sieci Web i etykietę poniżej wzmacniania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-304">Add the four Button Web controls and Label below the Repeater.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="9ddb4-305">Następnie utwórz obsługę zdarzeń `Click` dla czterech przycisków.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="9ddb4-306">Po kliknięciu jednego z tych przycisków musimy zaktualizować `StartRowIndex` i ponownie powiązać dane z Wzmacniakem.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="9ddb4-307">Kod dla pierwszych, poprzednich i następnych przycisków jest mały, ale dla ostatniego przycisku jak określamy indeks początku wiersza dla ostatniej strony danych?</span><span class="sxs-lookup"><span data-stu-id="9ddb4-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="9ddb4-308">Aby obliczyć ten indeks, a także można określić, czy następny i ostatni przycisk powinien być włączony, musimy wiedzieć, ile rekordów w sumie jest stronicowanych.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="9ddb4-309">Możemy to określić, wywołując metodę `ProductsBLL` klasy s `TotalNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="9ddb4-310">Niech s utworzy właściwość tylko do odczytu, na poziomie strony o nazwie `TotalRowCount`, która zwraca wyniki metody `TotalNumberOfProducts()`:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="9ddb4-311">Za pomocą tej właściwości możemy teraz określić indeks ostatniego wiersza początku strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="9ddb4-312">W związku z tym liczba całkowita wyniku `TotalRowCount` minus 1 podzielona przez `MaximumRows`, pomnożona przez `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="9ddb4-313">Teraz można napisać obsługę zdarzeń `Click` dla czterech przycisków interfejsu stronicowania:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="9ddb4-314">Na koniec musimy wyłączyć pierwsze i poprzednie przyciski w interfejsie stronicowania podczas wyświetlania pierwszej strony danych i następnych i ostatnich przycisków podczas wyświetlania ostatniej strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="9ddb4-315">Aby to osiągnąć, Dodaj następujący kod do programu obsługi zdarzeń `Selecting` ObjectDataSource s:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="9ddb4-316">Po dodaniu tych `Click` obsługi zdarzeń i kodzie do włączania lub wyłączania elementów interfejsu stronicowania na podstawie bieżącego indeksu wierszy początkowych Przetestuj stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="9ddb4-317">Jak pokazano na rysunku 15, podczas pierwszego odwiedzania strony pierwszy i Poprzedni przycisk zostaną wyłączone.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="9ddb4-318">Kliknięcie przycisku Dalej powoduje wyświetlenie drugiej strony danych, a następnie kliknięcie pozycji Ostatnia wyświetla końcową stronę (zobacz ilustracje 16 i 17).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="9ddb4-319">Podczas wyświetlania ostatniej strony danych, zarówno następny, jak i ostatni przycisk są wyłączone.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>

<span data-ttu-id="9ddb4-320">[![poprzednie i ostatnie przyciski są wyłączone podczas wyświetlania pierwszej strony produktów](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="9ddb4-321">**Ilustracja 15**. przyciski poprzednie i ostatnie są wyłączone podczas wyświetlania pierwszej strony produktów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>

<span data-ttu-id="9ddb4-322">[![zostanie wyświetlona druga strona produktów](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-322">[![The Second Page of Products are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="9ddb4-323">**Ilustracja 16**. zostanie wyświetlona druga strona produktów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-323">**Figure 16**: The Second Page of Products are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>

<span data-ttu-id="9ddb4-324">[![kliknięciu pozycji ostatni wyświetla końcową stronę danych](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="9ddb4-325">**Ilustracja 17**. kliknięcie pozycji Ostatnia wyświetla końcową stronę danych ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>

## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="9ddb4-326">Krok 7. dołączenie obsługi sortowania z niestandardowym Wzmacniakem stronicowanym</span><span class="sxs-lookup"><span data-stu-id="9ddb4-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="9ddb4-327">Po zaimplementowaniu niestandardowego stronicowania jest ono gotowe do uwzględnienia obsługi sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="9ddb4-328">Metoda `ProductsBLL` klasy s `GetProductsPagedAndSorted` ma takie same parametry wejściowe *StartRowIndex* i *MaximumRows* jak `GetProductsPaged`, ale zezwala na dodatkowy parametr wejściowy *'sortexpression* .</span><span class="sxs-lookup"><span data-stu-id="9ddb4-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="9ddb4-329">Aby użyć metody `GetProductsPagedAndSorted` z `SortingWithCustomPaging.aspx`, musimy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="9ddb4-330">Zmień właściwość "ObjectDataSource s `SelectMethod` z `GetProductsPaged` na `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="9ddb4-331">Dodaj obiekt *'sortexpression* `Parameter` do kolekcji ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="9ddb4-332">Utwórz prywatną Właściwość `SortExpression` na poziomie strony, która będzie utrzymywać swoją wartość na stronach ogłaszania zwrotnego przez stan widoku strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="9ddb4-333">Zaktualizuj procedurę obsługi zdarzeń `Selecting` ObjectDataSource s, aby przypisać parametr ObjectDataSource s *'sortexpression* wartość właściwości `SortExpression` na poziomie strony.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="9ddb4-334">Utwórz interfejs sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-334">Create the sorting interface.</span></span>

<span data-ttu-id="9ddb4-335">Zacznij od zaktualizowania właściwości `SelectMethod` ObjectDataSource s i dodania `Parameter` *'sortexpression* .</span><span class="sxs-lookup"><span data-stu-id="9ddb4-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="9ddb4-336">Upewnij się, że właściwość *'sortexpression* `Parameter` s `Type` jest ustawiona na `String`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="9ddb4-337">Po wykonaniu tych pierwszych dwóch zadań znacznik deklaratywny programu ObjectDataSource powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="9ddb4-338">Następnie potrzebujemy właściwości `SortExpression` na poziomie strony, której wartość jest serializowana do stanu widoku.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="9ddb4-339">Jeśli nie ustawiono żadnej wartości wyrażenia sortowania, użyj opcji ProductName jako domyślnego:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-339">If no sort expression value has been set, use ProductName as the default:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="9ddb4-340">Zanim element ObjectDataSource wywoła metodę `GetProductsPagedAndSorted`, musimy ustawić `Parameter` *'sortexpression* na wartość właściwości `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="9ddb4-341">W obsłudze zdarzeń `Selecting` Dodaj następujący wiersz kodu:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-341">In the `Selecting` event handler, add the following line of code:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="9ddb4-342">To wszystko, co ma na celu zaimplementowanie interfejsu sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="9ddb4-343">Podobnie jak w ostatnim przykładzie, niech s zaimplementowano interfejs sortowania przy użyciu trzech kontrolek sieci Web, które umożliwiają użytkownikowi sortowanie wyników według nazwy produktu, kategorii lub dostawcy.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>

[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="9ddb4-344">Utwórz obsługę zdarzeń `Click` dla tych trzech kontrolek przycisków.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="9ddb4-345">W obsłudze zdarzeń Zresetuj `StartRowIndex` do 0, ustaw `SortExpression` na odpowiednią wartość i ponownie Powiąż dane z Wzmacniaką:</span><span class="sxs-lookup"><span data-stu-id="9ddb4-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>

[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="9ddb4-346">Wszystko, co wszystko jest gotowe!</span><span class="sxs-lookup"><span data-stu-id="9ddb4-346">That s all there is to it!</span></span> <span data-ttu-id="9ddb4-347">Chociaż wprowadzono kilka kroków, aby uzyskać niestandardowe stronicowanie i zaimplementowane sortowanie, kroki były bardzo podobne do tych, które są wymagane do domyślnego stronicowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="9ddb4-348">Ilustracja 18 pokazuje produkty podczas wyświetlania ostatniej strony danych w posortowaniu według kategorii.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>

<span data-ttu-id="9ddb4-349">[zostanie wyświetlona ![ostatniej stronie danych posortowanej według kategorii.](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="9ddb4-350">**Ilustracja 18**. wyświetlana jest Ostatnia strona danych posortowana według kategorii (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="9ddb4-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9ddb4-351">W poprzednich przykładach podczas sortowania według dostawcy dostawcy użyto jako wyrażenia sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="9ddb4-352">Jednak w przypadku implementacji stronicowania niestandardowego musimy użyć elementu NazwaFirmy.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="9ddb4-353">Wynika to z faktu, że procedura składowana odpowiedzialna za implementowanie niestandardowego stronicowania `GetProductsPagedAndSorted` przekazuje wyrażenie sortowania do słowa kluczowego `ROW_NUMBER()`, słowo kluczowe `ROW_NUMBER()` wymaga rzeczywistej nazwy kolumny, a nie aliasu.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="9ddb4-354">W związku z tym należy użyć `CompanyName` (nazwę kolumny w tabeli `Suppliers`), a nie aliasu użytego w kwerendzie `SELECT` (`SupplierName`) dla wyrażenia Sort.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>

## <a name="summary"></a><span data-ttu-id="9ddb4-355">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="9ddb4-355">Summary</span></span>

<span data-ttu-id="9ddb4-356">Ani element DataList, ani wzmacniak nie oferują wbudowanej pomocy w zakresie sortowania, ale z niestandardowym interfejsem sortowania, można dodać tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="9ddb4-357">Podczas implementowania sortowania, ale nie stronicowania, wyrażenie sortowania można określić za pomocą obiektu `DataSourceSelectArguments` przekazaną do metody `Select` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="9ddb4-358">Ta właściwość `SortExpression` obiektu `DataSourceSelectArguments` można przypisać w programie obsługi zdarzeń `Selecting` ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="9ddb4-359">Aby dodać funkcje sortowania do elementu DataList lub wzmacniak, który już zapewnia obsługę stronicowania, najprostszym podejściem jest dostosowanie warstwy logiki biznesowej w celu uwzględnienia metody, która akceptuje wyrażenie sortowania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="9ddb4-360">Te informacje można następnie przekazywać przez parametr w elemencie ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="9ddb4-361">Ten samouczek wykonuje nasze badanie stronicowania i sortowania za pomocą kontrolek DataList i wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="9ddb4-362">Nasz następnym i ostatni samouczek zapoznaj się z tematem Dodawanie kontrolek sieci Web przycisków do szablonów DataList i wzmacniak w celu zapewnienia pewnych niestandardowych, inicjowanych przez użytkownika funkcji dla poszczególnych elementów.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="9ddb4-363">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="9ddb4-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9ddb4-364">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="9ddb4-364">About the Author</span></span>

<span data-ttu-id="9ddb4-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9ddb4-366">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9ddb4-367">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9ddb4-368">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9ddb4-369">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="9ddb4-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="9ddb4-370">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="9ddb4-370">Special Thanks To</span></span>

<span data-ttu-id="9ddb4-371">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9ddb4-372">Recenzent potencjalnego klienta dla tego samouczka był David suru.</span><span class="sxs-lookup"><span data-stu-id="9ddb4-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="9ddb4-373">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="9ddb4-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9ddb4-374">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9ddb4-375">[Poprzednie](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [dalej](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9ddb4-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
