---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
title: Dodawanie przycisków i reagowanie na nie w widoku GridView (VB) | Microsoft Docs
author: rick-anderson
description: W tym samouczku powiesz się, jak dodać niestandardowe przyciski, zarówno do szablonu, jak i do pól kontrolki GridView lub DetailsView. W szczególności będziemy lecenia...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 06c6bbd2-4bdc-435b-87a3-df2c868f4baa
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
msc.type: authoredcontent
ms.openlocfilehash: 8727d8faead02340d223c75845bf29f63d1a0834
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74600972"
---
# <a name="adding-and-responding-to-buttons-to-a-gridview-vb"></a><span data-ttu-id="1e9b5-104">Dodawanie przycisków i reagowanie na nie w kontrolce GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-104">Adding and Responding to Buttons to a GridView (VB)</span></span>

<span data-ttu-id="1e9b5-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1e9b5-106">[Pobierz przykładową aplikację](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) lub [Pobierz plik PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span></span>

> <span data-ttu-id="1e9b5-107">W tym samouczku powiesz się, jak dodać niestandardowe przyciski, zarówno do szablonu, jak i do pól kontrolki GridView lub DetailsView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="1e9b5-108">W szczególności utworzymy interfejs, który ma FormView, który umożliwi użytkownikowi dostęp do stron przez dostawców.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>

## <a name="introduction"></a><span data-ttu-id="1e9b5-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="1e9b5-109">Introduction</span></span>

<span data-ttu-id="1e9b5-110">Chociaż wiele scenariuszy raportowania obejmuje dostęp tylko do odczytu do danych raportu, nie jest to rzadko spotykane w przypadku raportów, które obejmują możliwość wykonywania akcji na podstawie wyświetlanych danych.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-110">While many reporting scenarios involve read-only access to the report data, it s not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="1e9b5-111">Zwykle dotyczy to Dodawanie kontrolki sieci Web Button, element LinkButton lub kliknięto element ImageButton przy użyciu każdego rekordu wyświetlanego w raporcie, który po kliknięciu powoduje odświeżenie i wywołanie kodu po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="1e9b5-112">Najbardziej typowym przykładem jest edytowanie i usuwanie danych w oparciu o rekord po rekordzie.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="1e9b5-113">W rzeczywistości od momentu, w którym zawarto instrukcje dotyczące [wstawiania, aktualizowania i usuwania danych](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , edytowanie i usuwanie jest tak popularne, że formanty GridView, DetailsView i FormView mogą obsługiwać takie funkcje bez konieczności pisania pojedynczego wiersza kodu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="1e9b5-114">Oprócz przycisków Edytuj i Usuń, formanty GridView, DetailsView i FormView mogą również zawierać przyciski, LinkButtons lub ImageButtons, które po kliknięciu wykonują niestandardową logikę po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="1e9b5-115">W tym samouczku powiesz się, jak dodać niestandardowe przyciski, zarówno do szablonu, jak i do pól kontrolki GridView lub DetailsView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="1e9b5-116">W szczególności utworzymy interfejs, który ma FormView, który umożliwi użytkownikowi dostęp do stron przez dostawców.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="1e9b5-117">Dla danego dostawcy FormView wyświetli informacje o dostawcy wraz z kontrolką sieci Web przycisku, która po kliknięciu spowoduje oznaczenie wszystkich skojarzonych produktów jako nieobsługiwane.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="1e9b5-118">Ponadto w widoku GridView są wyświetlane produkty dostarczone przez wybranego dostawcę, z każdym wierszem zawierającym przyciski zwiększania cen i rabatów, które po kliknięciu powodują podnoszenie lub zmniejszenie produktu `UnitPrice` o 10% (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product s `UnitPrice` by 10% (see Figure 1).</span></span>

<span data-ttu-id="1e9b5-119">[![oba elementy FormView i GridView zawierają przyciski, które wykonują akcje niestandardowe](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span></span>

<span data-ttu-id="1e9b5-120">**Rysunek 1**: oba elementy FormView i GridView zawierają przyciski, które wykonują akcje niestandardowe ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span></span>

## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="1e9b5-121">Krok 1. Dodawanie stron sieci Web samouczka przycisku</span><span class="sxs-lookup"><span data-stu-id="1e9b5-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="1e9b5-122">Zanim sprawdzimy, jak dodać niestandardowe przyciski, poświęć chwilę na utworzenie stron ASP.NET w naszym projekcie witryny sieci Web, które będą potrzebne do tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-122">Before we look at how to add a custom buttons, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="1e9b5-123">Zacznij od dodania nowego folderu o nazwie `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="1e9b5-124">Następnie Dodaj następujące dwie strony ASP.NET do tego folderu, aby upewnić się, że każda strona jest skojarzona z `Site.master` stroną wzorcową:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![Dodaj strony ASP.NET dla samouczków związanych z przyciskami niestandardowymi](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image4.png)

<span data-ttu-id="1e9b5-126">**Rysunek 2**. dodawanie stron ASP.NET dla samouczków związanych z przyciskami niestandardowymi</span><span class="sxs-lookup"><span data-stu-id="1e9b5-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="1e9b5-127">Podobnie jak w przypadku innych folderów, `Default.aspx` w folderze `CustomButtons` wyświetli samouczki w sekcji.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="1e9b5-128">Odwołaj się do tego, że formant użytkownika `SectionLevelTutorialListing.ascx` udostępnia tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="1e9b5-129">W związku z tym należy dodać tę kontrolkę użytkownika do `Default.aspx`, przeciągając ją z Eksplorator rozwiązań na stronę widok Projekt strony.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="1e9b5-130">[![dodać kontrolkę użytkownika SectionLevelTutorialListing. ascx do default. aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span></span>

<span data-ttu-id="1e9b5-131">**Rysunek 3**. Dodawanie kontrolki użytkownika `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span></span>

<span data-ttu-id="1e9b5-132">Na koniec Dodaj strony jako wpisy do pliku `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="1e9b5-133">W każdym przypadku Dodaj następujące znaczniki po stronicowaniu i sortowaniu `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>

[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample1.xml)]

<span data-ttu-id="1e9b5-134">Po aktualizacji `Web.sitemap`zapoznaj się z witryną internetową samouczków za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="1e9b5-135">Menu po lewej stronie zawiera teraz elementy do edycji, wstawiania i usuwania samouczków.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Mapa witryny zawiera teraz wpis do samouczka dotyczącego przycisków niestandardowych](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image8.png)

<span data-ttu-id="1e9b5-137">**Rysunek 4**. Mapa witryny zawiera teraz wpis do samouczka dotyczącego przycisków niestandardowych</span><span class="sxs-lookup"><span data-stu-id="1e9b5-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="1e9b5-138">Krok 2. Dodawanie widoku FormView zawierającego listę dostawców</span><span class="sxs-lookup"><span data-stu-id="1e9b5-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="1e9b5-139">Zacznij korzystać z tego samouczka, dodając FormView, który wyświetla listę dostawców.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-139">Let s get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="1e9b5-140">Zgodnie z opisem we wprowadzeniu, ten formant FormView umożliwi użytkownikowi dostęp do stron przez dostawców, pokazując produkty dostarczone przez dostawcę w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="1e9b5-141">Ponadto ten formant FormView będzie zawierał przycisk, który po kliknięciu spowoduje oznaczenie wszystkich produktów dostawcy jako niewykorzystane.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier s products as discontinued.</span></span> <span data-ttu-id="1e9b5-142">Zanim będziemy wypróbujemy z dodaniem niestandardowego przycisku do FormView, pozwól najpierw utworzyć FormView, aby wyświetlić informacje o dostawcy.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-142">Before we concern ourselves with adding the custom button to the FormView, let s first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="1e9b5-143">Zacznij od otwarcia strony `CustomButtons.aspx` w folderze `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="1e9b5-144">Dodaj do strony formant FormView, przeciągając go z przybornika do projektanta i ustawiając jego właściwość `ID` na `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="1e9b5-145">W tagu inteligentnym FormView Utwórz nowy element ObjectDataSource o nazwie `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-145">From the FormView s smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>

<span data-ttu-id="1e9b5-146">[![utworzyć nowego elementu ObjectDataSource o nazwie SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span></span>

<span data-ttu-id="1e9b5-147">**Rysunek 5**. Utwórz nowy element ObjectDataSource o nazwie `SuppliersDataSource` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span></span>

<span data-ttu-id="1e9b5-148">Skonfiguruj nowy element ObjectDataSource, który będzie wysyłać zapytania z metody `GetSuppliers()` `SuppliersBLL` Class (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="1e9b5-149">Ponieważ ten FormView nie udostępnia interfejsu do aktualizowania informacji o dostawcy, wybierz opcję (brak) z listy rozwijanej na karcie aktualizacja.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>

<span data-ttu-id="1e9b5-150">[![skonfigurować źródło danych tak, aby korzystało z metody getdostawcy () klasy SuppliersBLL](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span></span>

<span data-ttu-id="1e9b5-151">**Ilustracja 6**. Skonfiguruj źródło danych tak, aby korzystało z metody `GetSuppliers()` `SuppliersBLL` Class ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class s `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span></span>

<span data-ttu-id="1e9b5-152">Po skonfigurowaniu elementu ObjectDataSource program Visual Studio wygeneruje `InsertItemTemplate`, `EditItemTemplate`i `ItemTemplate` dla widoku FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="1e9b5-153">Usuń `InsertItemTemplate` i `EditItemTemplate` i zmodyfikuj `ItemTemplate` tak, aby wyświetlał tylko nazwę firmy dostawcy i numer telefonu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier s company name and phone number.</span></span> <span data-ttu-id="1e9b5-154">Na koniec Włącz obsługę stronicowania dla FormView, zaznaczając pole wyboru Włącz stronicowanie w tagu inteligentnym (lub ustawiając jego właściwość `AllowPaging` na `True`).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="1e9b5-155">Po wprowadzeniu zmian znaczniki deklaratywne strony powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-155">After these changes your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample2.aspx)]

<span data-ttu-id="1e9b5-156">Rysunek 7 przedstawia stronę CustomButtons. aspx wyświetlaną w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>

<span data-ttu-id="1e9b5-157">[![FormView wyświetla listę pól NazwaFirmy i telefon z aktualnie wybranego dostawcy](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span></span>

<span data-ttu-id="1e9b5-158">**Rysunek 7**. formant FormView wyświetla listę `CompanyName` i `Phone` pól z aktualnie wybranego dostawcy ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span></span>

## <a name="step-3-adding-a-gridview-that-lists-the-selected-supplier-s-products"></a><span data-ttu-id="1e9b5-159">Krok 3. Dodawanie widoku GridView zawierającego listę wybranych produktów dostawcy</span><span class="sxs-lookup"><span data-stu-id="1e9b5-159">Step 3: Adding a GridView that Lists the Selected Supplier s Products</span></span>

<span data-ttu-id="1e9b5-160">Przed dodaniem przycisku Zakończ wszystkie produkty do szablonu FormView s Dodaj najpierw widok GridView poniżej widoku FormView, który zawiera listę produktów dostarczonych przez wybranego dostawcę.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-160">Before we add the Discontinue All Products Button to the FormView s template, let s first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="1e9b5-161">Aby to osiągnąć, Dodaj widok GridView do strony, ustaw jej Właściwość `ID` na `SuppliersProducts`i Dodaj nowy element ObjectDataSource o nazwie `SuppliersProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>

<span data-ttu-id="1e9b5-162">[![utworzyć nowego elementu ObjectDataSource o nazwie SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span></span>

<span data-ttu-id="1e9b5-163">**Ilustracja 8**. Tworzenie nowego elementu ObjectDataSource o nazwie `SuppliersProductsDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span></span>

<span data-ttu-id="1e9b5-164">Skonfiguruj ten element ObjectDataSource, aby korzystał z metody `GetProductsBySupplierID(supplierID)` klasy ProductsBLL (zobacz rysunek 9).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-164">Configure this ObjectDataSource to use the ProductsBLL class s `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="1e9b5-165">Gdy ten widok GridView zezwoli na dostosowanie ceny produktu, nie będzie używać wbudowanej edycji ani usuwania funkcji z widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-165">While this GridView will allow for a product s price to be adjusted, it won't be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="1e9b5-166">W związku z tym, można ustawić listę rozwijaną na wartość (brak) dla kart "Usuń" i "Wyczyść".</span><span class="sxs-lookup"><span data-stu-id="1e9b5-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource s UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="1e9b5-167">[![skonfigurować źródło danych tak, aby korzystało z metody ProductsBLL Class s GetProductsBySupplierID (IDDostawcy)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span></span>

<span data-ttu-id="1e9b5-168">**Rysunek 9**. Konfigurowanie źródła danych do używania metody `GetProductsBySupplierID(supplierID)` `ProductsBLL` klasy s ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class s `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span></span>

<span data-ttu-id="1e9b5-169">Ponieważ metoda `GetProductsBySupplierID(supplierID)` akceptuje parametr wejściowy, Kreator ObjectDataSource monituje nas o źródło wartości tego parametru.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="1e9b5-170">Aby przekazać wartość `SupplierID` z widoku FormView, Ustaw listę rozwijaną Źródło parametru na Control i listę rozwijaną ControlID na `Suppliers` (identyfikator FormView utworzony w kroku 2).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>

<span data-ttu-id="1e9b5-171">[![wskazać, że parametr IDDostawcy powinien pochodzić z kontrolki FormView dostawcy](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span></span>

<span data-ttu-id="1e9b5-172">**Ilustracja 10**. wskazuje, że parametr *`supplierID`* powinien pochodzić z `Suppliers` kontrolki FormView ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span></span>

<span data-ttu-id="1e9b5-173">Po ukończeniu działania kreatora ObjectDataSource, GridView będzie zawierać BoundField lub CheckBoxField dla każdego z pól danych produktu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product s data fields.</span></span> <span data-ttu-id="1e9b5-174">Pozwól s przyciąć ten punkt w dół, aby pokazać tylko `ProductName` i `UnitPrice` BoundFields wraz z `Discontinued` CheckBoxField; Ponadto poinformuj s `UnitPrice` BoundField o tym, że tekst jest sformatowany jako waluta.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-174">Let s trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let s format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="1e9b5-175">Znaczniki deklaratywne w widoku GridView i `SuppliersProductsDataSource` nie powinny wyglądać podobnie do następującej:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource s declarative markup should look similar to the following markup:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample3.aspx)]

<span data-ttu-id="1e9b5-176">W tym momencie nasz samouczek wyświetla raport główny/szczegóły, umożliwiając użytkownikowi wybranie dostawcy z widoku FormView u góry i wyświetlenie produktów dostarczonych przez tego dostawcę za pośrednictwem widoku GridView u dołu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="1e9b5-177">Na rysunku 11 przedstawiono zrzut ekranu przedstawiający Tę stronę podczas wybierania dostawcy Tokio dla sprzedawców z widoku FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>

<span data-ttu-id="1e9b5-178">[![wybrane produkty dostawcy są wyświetlane w widoku GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span></span>

<span data-ttu-id="1e9b5-179">**Ilustracja 11**. wybrane produkty dostawcy są wyświetlane w widoku GridView (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-179">**Figure 11**: The Selected Supplier s Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span></span>

## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="1e9b5-180">Krok 4. Tworzenie metod DAL i LOGIKI biznesowej w celu zaprzestania korzystania ze wszystkich produktów dla dostawcy</span><span class="sxs-lookup"><span data-stu-id="1e9b5-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="1e9b5-181">Zanim będziemy mogli dodać przycisk do FormView, który po kliknięciu spowoduje zaprzestanie wszystkich produktów dostawcy, najpierw musimy dodać metodę do DAL i LOGIKI biznesowej, które wykonują tę akcję.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier s products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="1e9b5-182">W szczególności ta metoda będzie nazywana `DiscontinueAllProductsForSupplier(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="1e9b5-183">Po kliknięciu przycisku FormView należy wywołać tę metodę w warstwie logiki biznesowej, przechodząc do wybranego dostawcy `SupplierID`; LOGIKI biznesowej następnie wywoła do odpowiedniej metody warstwy dostępu do danych, która wystawia do bazy danych instrukcję `UPDATE`, która nie będzie kontynuować określonych produktów dostawcy.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-183">When the FormView s Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier s `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier s products.</span></span>

<span data-ttu-id="1e9b5-184">Zgodnie z naszymi poprzednimi samouczkami będziemy używać podejścia dolnego, rozpoczynając od tworzenia metody DAL, a następnie metody LOGIKI biznesowej i na końcu implementując funkcję na stronie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="1e9b5-185">Otwórz zestaw danych `Northwind.xsd` określonym w folderze `App_Code/DAL` i Dodaj nową metodę do `ProductsTableAdapter` (kliknij prawym przyciskiem myszy `ProductsTableAdapter` i wybierz polecenie Dodaj zapytanie).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="1e9b5-186">Spowoduje to wyświetlenie Kreatora konfiguracji zapytania TableAdapter, który przeprowadzi Cię przez proces dodawania nowej metody.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="1e9b5-187">Zacznij od wskazywania, że nasza metoda DAL będzie używać ad-hoc instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>

<span data-ttu-id="1e9b5-188">[![utworzyć metodę DAL przy użyciu instrukcji SQL ad hoc](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span></span>

<span data-ttu-id="1e9b5-189">**Ilustracja 12**. Tworzenie metody dal przy użyciu instrukcji SQL ad hoc ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span></span>

<span data-ttu-id="1e9b5-190">Następnie Kreator poprosi nas o typ zapytania, który ma zostać utworzony.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="1e9b5-191">Ponieważ metoda `DiscontinueAllProductsForSupplier(supplierID)` będzie wymagała aktualizacji tabeli bazy danych `Products`, ustawienie pola `Discontinued` na 1 dla wszystkich produktów dostarczonych przez określony *`supplierID`* wymaga utworzenia zapytania, które aktualizuje dane.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>

<span data-ttu-id="1e9b5-192">[![wybrać typu zapytania UPDATE](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span></span>

<span data-ttu-id="1e9b5-193">**Ilustracja 13**. Wybierz typ zapytania Update ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span></span>

<span data-ttu-id="1e9b5-194">Na następnym ekranie kreatora znajduje się TableAdapter istniejąca instrukcja `UPDATE`, która aktualizuje wszystkie pola zdefiniowane w `Products` DataTable.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-194">The next wizard screen provides the TableAdapter s existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="1e9b5-195">Zastąp ten tekst zapytania następującą instrukcją:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-195">Replace this query text with the following statement:</span></span>

[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample4.sql)]

<span data-ttu-id="1e9b5-196">Po wprowadzeniu tego zapytania i kliknięciu przycisku Dalej na ostatnim ekranie kreatora zostanie wyświetlony monit o podanie nowej metody s `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-196">After entering this query and clicking Next, the last wizard screen asks for the new method s name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="1e9b5-197">Ukończ pracę kreatora, klikając przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="1e9b5-198">Po powrocie do projektanta obiektów DataSet powinna zostać wyświetlona nowa metoda w `ProductsTableAdapter` o nazwie `DiscontinueAllProductsForSupplier(@SupplierID)`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>

<span data-ttu-id="1e9b5-199">[![nazwę nowej metody DAL DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span></span>

<span data-ttu-id="1e9b5-200">**Ilustracja 14**. Nazwa nowej metody dal `DiscontinueAllProductsForSupplier` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span></span>

<span data-ttu-id="1e9b5-201">Przy użyciu metody `DiscontinueAllProductsForSupplier(supplierID)` utworzonej w warstwie dostępu do danych następnym zadaniem jest utworzenie metody `DiscontinueAllProductsForSupplier(supplierID)` w warstwie logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="1e9b5-202">Aby to zrobić, Otwórz plik klasy `ProductsBLL` i Dodaj następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample5.vb)]

<span data-ttu-id="1e9b5-203">Ta metoda po prostu wywołuje metodę `DiscontinueAllProductsForSupplier(supplierID)` w DAL, przekazując do podanej wartości parametru *`supplierID`* .</span><span class="sxs-lookup"><span data-stu-id="1e9b5-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="1e9b5-204">Jeśli istnieją jakieś reguły biznesowe, które zezwalają na wycofanie produktów dostawcy w pewnych okolicznościach, te reguły powinny zostać zaimplementowane w tym miejscu w LOGIKI biznesowej.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-204">If there were any business rules that only allowed a supplier s products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="1e9b5-205">W przeciwieństwie do `UpdateProduct` przeciążeń w klasie `ProductsBLL`, podpis metody `DiscontinueAllProductsForSupplier(supplierID)` nie zawiera atrybutu `DataObjectMethodAttribute` (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="1e9b5-206">Wyklucza to metodę `DiscontinueAllProductsForSupplier(supplierID)` z listy rozwijanej "Kreator konfiguracji źródła danych" w Kreatorze aktualizacji. Ten atrybut został pominięty, ponieważ będziemy wywoływana metodę `DiscontinueAllProductsForSupplier(supplierID)` bezpośrednio z programu obsługi zdarzeń na naszej stronie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource s Configure Data Source wizard s drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>

## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="1e9b5-207">Krok 5. Dodawanie przycisku zaniechania wszystkich produktów do widoku FormView</span><span class="sxs-lookup"><span data-stu-id="1e9b5-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="1e9b5-208">Po zakończeniu `DiscontinueAllProductsForSupplier(supplierID)`j metody w LOGIKI biznesowej i DAL, ostatnim krokiem do dodania możliwości zaprzestania działania wszystkich produktów dla wybranego dostawcy jest dodanie kontrolki sieci Web Button do `ItemTemplate`FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView s `ItemTemplate`.</span></span> <span data-ttu-id="1e9b5-209">Pozwól s dodać taki przycisk poniżej numeru telefonu dostawcy z tekstem przycisku, zaniechać wszystkie produkty i `ID` wartość właściwości `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-209">Let s add such a Button below the supplier s phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="1e9b5-210">Kontrolkę sieci Web tego przycisku można dodać za pomocą projektanta, klikając łącze Edytuj szablony w tagu inteligentnym FormView (patrz rysunek 15) lub bezpośrednio za pomocą składni deklaracyjnej.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView s smart tag (see Figure 15), or directly through the declarative syntax.</span></span>

<span data-ttu-id="1e9b5-211">[![dodać kontrolkę sieci Web przycisk nie Kontynuuj wszystkie produkty do widoku FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span></span>

<span data-ttu-id="1e9b5-212">**Ilustracja 15**. Dodawanie kontrolki sieci Web przycisk nie Kontynuuj wszystkie produkty do `ItemTemplate` FormView ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView s `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span></span>

<span data-ttu-id="1e9b5-213">Gdy przycisk zostanie kliknięty przez użytkownika odwiedzającego stronę, następuje odświeżenie i [zdarzenie`ItemCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="1e9b5-214">Aby wykonać niestandardowy kod w odpowiedzi na kliknięty przycisk, można utworzyć procedurę obsługi zdarzeń dla tego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="1e9b5-215">Należy zrozumieć, że zdarzenie `ItemCommand` wyzwalane za każdym razem, gdy *dowolny* przycisk, element LinkButton lub formant sieci Web kliknięto element ImageButton jest kliknięty w widoku FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="1e9b5-216">Oznacza to, że gdy użytkownik przejdzie z jednej strony do drugiego w widoku FormView, wyzwalane jest zdarzenie `ItemCommand`. Ta sama czynność, gdy użytkownik kliknie pozycję Nowy, edytuj lub Usuń w widoku FormView, który obsługuje wstawianie, aktualizowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="1e9b5-217">Ponieważ `ItemCommand` wyzwalane niezależnie od tego, jaki przycisk jest kliknięty, w programie obsługi zdarzeń musimy określić, czy przycisk zaniechania wszystkich produktów został kliknięty, czy był jakiś inny przycisk.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="1e9b5-218">Aby to osiągnąć, można ustawić wartość właściwości formant sieci Web dla przycisku `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-218">To accomplish this, we can set the Button Web control s `CommandName` property to some identifying value.</span></span> <span data-ttu-id="1e9b5-219">Gdy przycisk zostanie kliknięty, ta wartość `CommandName` jest przenoszona do programu obsługi zdarzeń `ItemCommand`, dzięki czemu można określić, czy przycisk zaniechania wszystkich produktów był kliknięty.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="1e9b5-220">Ustaw wartość właściwości `CommandName` nie Kontynuuj wszystkie produkty na DiscontinueProducts.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-220">Set the Discontinue All Products Button s `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="1e9b5-221">Na koniec użyj okna dialogowego potwierdzenia po stronie klienta, aby upewnić się, że użytkownik naprawdę chce przestać korzystać z wybranych produktów dostawcy.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-221">Finally, let s use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier s products.</span></span> <span data-ttu-id="1e9b5-222">Jak widać w temacie [Dodawanie potwierdzenia po stronie klienta podczas usuwania](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) samouczka, można to zrobić za pomocą bitu języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="1e9b5-223">W szczególności ustaw właściwość OnClientClick przycisku Web Control s na `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="1e9b5-223">In particular, set the Button Web control s OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="1e9b5-224">Po wprowadzeniu tych zmian składnia deklaratywna FormView powinna wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-224">After making these changes, the FormView s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample6.aspx)]

<span data-ttu-id="1e9b5-225">Następnie Utwórz procedurę obsługi zdarzeń dla zdarzenia `ItemCommand` FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-225">Next, create an event handler for the FormView s `ItemCommand` event.</span></span> <span data-ttu-id="1e9b5-226">W tym obsłudze zdarzeń musimy najpierw określić, czy przycisk zaniechania wszystkich produktów został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="1e9b5-227">Jeśli tak, chcemy utworzyć wystąpienie klasy `ProductsBLL` i wywołać jej metodę `DiscontinueAllProductsForSupplier(supplierID)`, przekazując w `SupplierID` wybranego FormView:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample7.vb)]

<span data-ttu-id="1e9b5-228">Należy pamiętać, że `SupplierID` bieżącego wybranego dostawcy w widoku FormView można uzyskać za pomocą właściwości FormView s [`SelectedValue`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView s [`SelectedValue` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="1e9b5-229">Właściwość `SelectedValue` zwraca pierwszą wartość klucza danych dla rekordu wyświetlanego w widoku FormView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="1e9b5-230">[Właściwość`DataKeyNames`](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx)FormView, która wskazuje pola danych, z których pobierane są wartości klucza danych, zostało automatycznie ustawione na `SupplierID` przez program Visual Studio w przypadku powiązania elementu ObjectDataSource z powrotem do FormView w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-230">The FormView s [`DataKeyNames` property](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="1e9b5-231">Po utworzeniu programu obsługi zdarzeń `ItemCommand` Poświęć chwilę na przetestowanie strony.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="1e9b5-232">Przejdź do dostawcy Cooperativa de Quesos "Las Cabras" (jest to piąty dostawca w widoku FormView dla mnie).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it s the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="1e9b5-233">Ten dostawca oferuje dwa produkty, Queso Cabrales i Queso Manchego La pastora, które *nie* zostały wycofane.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="1e9b5-234">Załóżmy, że Cooperativa de Quesos "Las Cabras" został usunięty z firmy i w związku z tym jego produkty mają być wycofane.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="1e9b5-235">Kliknij przycisk zaniechanie wszystkich produktów.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="1e9b5-236">Spowoduje to wyświetlenie okna dialogowego potwierdzenia po stronie klienta (zobacz rysunek 16).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>

<span data-ttu-id="1e9b5-237">[![Cooperativa de Quesos Las Cabras oferuje dwa aktywne produkty](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span></span>

<span data-ttu-id="1e9b5-238">**Rysunek 16**: Cooperativa de Quesos Las Cabras dostarcza dwa aktywne produkty ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span></span>

<span data-ttu-id="1e9b5-239">Jeśli klikniesz przycisk OK w oknie dialogowym potwierdzenia po stronie klienta, zostanie ono przesłane, co spowoduje odświeżenie zdarzenia "FormView s `ItemCommand`".</span><span class="sxs-lookup"><span data-stu-id="1e9b5-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView s `ItemCommand` event will fire.</span></span> <span data-ttu-id="1e9b5-240">Utworzona procedura obsługi zdarzeń zostanie następnie wykonana, wywołująca metodę `DiscontinueAllProductsForSupplier(supplierID)` i zaniechania zarówno Queso Cabrales, jak i Queso Manchego La pastora.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="1e9b5-241">Jeśli użytkownik wyłączył stan widoku GridView, GridView jest przełączany do bazowego magazynu danych na każdym ogłaszaniu zwrotnym i w związku z tym natychmiast zostanie zaktualizowany w celu odzwierciedlenia, że te dwa produkty są teraz wycofywane (patrz rysunek 17).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-241">If you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="1e9b5-242">Jeśli jednak w widoku GridView nie wyłączono stanu widoku, należy ręcznie ponownie powiązać dane z widokiem GridView po wprowadzeniu tej zmiany.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="1e9b5-243">Aby to osiągnąć, po wywołaniu metody `DiscontinueAllProductsForSupplier(supplierID)` po prostu wykonaj wywołanie do metody GridView `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-243">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>

<span data-ttu-id="1e9b5-244">[![po kliknięciu przycisku nie Kontynuuj wszystkie produkty produkty dostawcy zostaną odpowiednio zaktualizowane.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span></span>

<span data-ttu-id="1e9b5-245">**Ilustracja 17**. po kliknięciu przycisku nie Kontynuuj wszystkie produkty produkty dostawcy są odpowiednio aktualizowane ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span></span>

## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-product-s-price"></a><span data-ttu-id="1e9b5-246">Krok 6. Tworzenie przeciążenia UpdateProduct w warstwie logiki biznesowej w celu dostosowania ceny produktu</span><span class="sxs-lookup"><span data-stu-id="1e9b5-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product s Price</span></span>

<span data-ttu-id="1e9b5-247">Podobnie jak w przypadku przycisku Zastąp wszystkie produkty w widoku FormView, aby dodać przyciski do zwiększania i zmniejszania cen produktu w widoku GridView musimy najpierw dodać odpowiednią warstwę dostępu do danych i metody warstwy logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="1e9b5-248">Ponieważ mamy już metodę, która aktualizuje pojedynczy wiersz produktu w DAL, możemy zapewnić takie funkcje, tworząc nowe Przeciążenie dla metody `UpdateProduct` w LOGIKI biznesowej.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="1e9b5-249">Nasze przeciążenia `UpdateProduct` przeszły w kilka kombinacji pól produktu jako wartości wejściowe skalarne, a następnie zaktualizowali tylko te pola dla określonego produktu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="1e9b5-250">W przypadku tego przeciążenia różnimy się nieco od tego standardu, a zamiast tego przejdziemy do `ProductID` produktu i wartości procentowej, według której ma zostać dostosowany `UnitPrice` (w przeciwieństwie do przekazywania nowych, skorygowanych `UnitPrice` samego siebie).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-250">For this overload we'll vary slightly from this standard and instead pass in the product s `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="1e9b5-251">Takie podejście upraszcza kod, który musimy napisać w klasie z kodem ASP.NET strony, ponieważ my nie musimy bother, aby określić bieżący produkt `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don t have to bother with determining the current product s `UnitPrice`.</span></span>

<span data-ttu-id="1e9b5-252">Poniżej przedstawiono Przeciążenie `UpdateProduct` dla tego samouczka:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample8.vb)]

<span data-ttu-id="1e9b5-253">To Przeciążenie pobiera informacje o określonym produkcie za pomocą metody `GetProductByProductID(productID)` DAL s.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-253">This overload retrieves information about the specified product through the DAL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="1e9b5-254">Następnie sprawdza, czy `UnitPrice` produktu ma przypisaną `NULL` wartość bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-254">It then checks to see whether the product s `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="1e9b5-255">Jeśli tak jest, Cena pozostaje niezmieniona.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="1e9b5-256">Jeśli jednak istnieje`NULL` wartość `UnitPrice`, Metoda aktualizuje `UnitPrice` produktu o określoną wartość procentową (`unitPriceAdjustmentPercent`).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product s `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="1e9b5-257">Krok 7. Dodawanie przycisków Zwiększ i Zmniejsz do widoku GridView</span><span class="sxs-lookup"><span data-stu-id="1e9b5-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="1e9b5-258">Elementy GridView (i DetailsView) składają się z kolekcji pól.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="1e9b5-259">Oprócz BoundFields, CheckBoxFields i używanie TemplateField, ASP.NET zawiera ButtonField, który, jak jego nazwa oznacza, jest renderowany jako kolumna z przyciskiem, element LinkButton lub kliknięto element ImageButton dla każdego wiersza.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="1e9b5-260">Podobnie jak w widoku FormView, kliknięcie *dowolnego* przycisku w obszarze przyciski stronicowania GridView, przyciski Edytuj lub Usuń, przyciski sortowania i tak dalej powoduje wystąpienie zwrotne i wywołuje [zdarzenie GridView`RowCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView s [`RowCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="1e9b5-261">ButtonField ma właściwość `CommandName`, która przypisuje określoną wartość do poszczególnych przycisków `CommandName` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="1e9b5-262">Podobnie jak w przypadku widoku FormView wartość `CommandName` jest używana przez procedurę obsługi zdarzeń `RowCommand`, aby określić, który przycisk został kliknięty.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="1e9b5-263">Zezwól na dodanie dwóch nowych ButtonFields do widoku GridView, jeden z ceną tekstu przycisku + 10%, a drugą z ceną tekstu — 10%.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-263">Let s add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="1e9b5-264">Aby dodać te ButtonFields, kliknij link Edytuj kolumny w tagu inteligentnym GridView, wybierz typ pola ButtonField z listy w lewym górnym rogu, a następnie kliknij przycisk Dodaj.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-264">To add these ButtonFields, click on the Edit Columns link from the GridView s smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>

![Dodaj dwa ButtonFields do widoku GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image48.png)

<span data-ttu-id="1e9b5-266">**Ilustracja 18**. Dodawanie dwóch ButtonFields do widoku GridView</span><span class="sxs-lookup"><span data-stu-id="1e9b5-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>

<span data-ttu-id="1e9b5-267">Przenieś dwie ButtonFields tak, aby były wyświetlane jako pierwsze dwa pola GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="1e9b5-268">Następnie ustaw właściwości `Text` tych dwóch ButtonFields na cenę + 10% i cena-10%, a właściwości `CommandName` odpowiednio na IncreasePrice i DecreasePrice.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="1e9b5-269">Domyślnie ButtonField renderuje swoją kolumnę przycisków jako LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="1e9b5-270">Można to zmienić, jednak za pomocą [właściwości`ButtonType`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx)ButtonField s.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-270">This can be changed, however, through the ButtonField s [`ButtonType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="1e9b5-271">Niech s mają te dwa ButtonFields renderowane jako zwykłe przyciski push; w związku z tym ustaw właściwość `ButtonType` na `Button`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-271">Let s have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="1e9b5-272">Rysunek 19 pokazuje okno dialogowe pola po wprowadzeniu tych zmian; Poniżej znajduje się znacznik deklaratywny GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView s declarative markup.</span></span>

![Konfigurowanie właściwości ButtonFields, CommandName i ButtonType](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image49.png)

<span data-ttu-id="1e9b5-274">**Ilustracja 19**. konfigurowanie właściwości `Text`, `CommandName`i `ButtonType` ButtonFields</span><span class="sxs-lookup"><span data-stu-id="1e9b5-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample9.aspx)]

<span data-ttu-id="1e9b5-275">Po utworzeniu tych ButtonFields ostatnim krokiem jest utworzenie procedury obsługi zdarzeń dla zdarzenia GridView `RowCommand`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-275">With these ButtonFields created, the final step is to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="1e9b5-276">Ta procedura obsługi zdarzeń, jeśli została uruchomiona, ponieważ zostały kliknięte przyciski Price + 10% lub Price-10%, muszą określić `ProductID` dla wiersza, którego przycisk został kliknięty, a następnie wywołać metodę `ProductsBLL` klasy `UpdateProduct`, przekazując odpowiednie `UnitPrice` dopasowanie procentowe wraz z `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class s `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="1e9b5-277">Poniższy kod wykonuje następujące zadania:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-277">The following code performs these tasks:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample10.vb)]

<span data-ttu-id="1e9b5-278">Aby określić `ProductID` dla wiersza, którego kliknięto przycisk cena + 10% lub cena — 10%, należy zapoznać się z kolekcją `DataKeys` GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView s `DataKeys` collection.</span></span> <span data-ttu-id="1e9b5-279">Ta kolekcja zawiera wartości pól określonych we właściwości `DataKeyNames` dla każdego wiersza GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="1e9b5-280">Ponieważ właściwość GridView `DataKeyNames` była ustawiona na ProductID przez program Visual Studio podczas wiązania elementu ObjectDataSource z GridView, `DataKeys(rowIndex).Value` udostępnia `ProductID` dla określonego *RowIndex*.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-280">Since the GridView s `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="1e9b5-281">ButtonField jest automatycznie przekazywana w *RowIndex* wiersza, którego przycisk został kliknięty za pomocą parametru `e.CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="1e9b5-282">W związku z tym, aby określić `ProductID` dla wiersza, którego kliknięto przycisk cena + 10% lub cena — 10%, użyjemy opcji: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="1e9b5-283">Podobnie jak w przypadku przycisku Zakończ wszystkie produkty, jeśli stan widoku GridView jest wyłączony, element GridView jest przełączany do podstawowego magazynu danych na każdym ogłaszaniu zwrotnym i w związku z tym natychmiast zostanie zaktualizowany w celu odzwierciedlenia zmiany ceny, która wynika z kliknięcia jeden z przycisków.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-283">As with the Discontinue All Products button, if you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="1e9b5-284">Jeśli jednak w widoku GridView nie wyłączono stanu widoku, należy ręcznie ponownie powiązać dane z widokiem GridView po wprowadzeniu tej zmiany.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="1e9b5-285">Aby to osiągnąć, po wywołaniu metody `UpdateProduct` po prostu wykonaj wywołanie do metody GridView `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-285">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="1e9b5-286">Ilustracja 20 przedstawia stronę podczas wyświetlania produktów dostarczonych przez Homestead Grandma Kelly.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="1e9b5-287">Rysunek 21 pokazuje wyniki po dwukrotnym kliknięciu przycisku cena + 10% w przypadku rozprzestrzenienia Boysenberry Grandma oraz przycisku cena-10% raz dla Northwoods Cranberry.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>

<span data-ttu-id="1e9b5-288">[![GridView obejmuje cenę + 10% i cenę — 10% przycisków](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span></span>

<span data-ttu-id="1e9b5-289">**Ilustracja 20**. widok GridView obejmuje cenę + 10% i cenę — 10% przycisków ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span></span>

<span data-ttu-id="1e9b5-290">[![ceny pierwszego i trzeciego produktu zostały zaktualizowane za pomocą przycisków cena + 10% i cena — 10%](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span></span>

<span data-ttu-id="1e9b5-291">**Ilustracja 21**. ceny pierwszego i trzeciego produktu zostały zaktualizowane za pomocą przycisków cena + 10% i cena — 10% ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="1e9b5-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1e9b5-292">W widoku GridView (i DetailsView) mogą być również przypisane przyciski, LinkButtons lub ImageButtons do ich używanie TemplateField.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="1e9b5-293">Podobnie jak w przypadku BoundField, te przyciski, gdy kliknięto, spowodują wypadek od`RowCommand` świeżenia.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView s `RowCommand` event.</span></span> <span data-ttu-id="1e9b5-294">Podczas dodawania przycisków w TemplateField, jednak przycisk s `CommandArgument` nie jest automatycznie ustawiany na indeks wiersza, ponieważ jest używany ButtonFields.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-294">When adding buttons in a TemplateField, however, the Button s `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="1e9b5-295">Jeśli musisz określić indeks wiersza przycisku, który został kliknięty w ramach procedury obsługi zdarzeń `RowCommand`, musisz ręcznie ustawić właściwość `CommandArgument` przycisku w swojej składni deklaracyjnej w TemplateField, używając kodu takiego jak:</span><span class="sxs-lookup"><span data-stu-id="1e9b5-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button s `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="1e9b5-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span></span>

## <a name="summary"></a><span data-ttu-id="1e9b5-297">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="1e9b5-297">Summary</span></span>

<span data-ttu-id="1e9b5-298">Wszystkie kontrolki GridView, DetailsView i FormView mogą zawierać przyciski, LinkButtons lub ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="1e9b5-299">Takie przyciski po kliknięciu powodują wystąpienie zwrotne i wywołają zdarzenie `ItemCommand` w kontrolkach FormView i DetailsView oraz zdarzenia `RowCommand` w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="1e9b5-300">Te kontrolki sieci Web danych mają wbudowaną funkcję obsługi typowych akcji związanych z poleceniami, takich jak usuwanie i edytowanie rekordów.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="1e9b5-301">Można jednak również użyć przycisków, które po kliknięciu reagują na wykonywanie własnego niestandardowego kodu.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="1e9b5-302">Aby to osiągnąć, należy utworzyć procedurę obsługi zdarzeń dla zdarzenia `ItemCommand` lub `RowCommand`.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="1e9b5-303">W tym obsłudze zdarzeń najpierw sprawdzimy wartość przychodzącą `CommandName`, aby określić, który przycisk został kliknięty, a następnie podejmij odpowiednią akcję niestandardową.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="1e9b5-304">W tym samouczku przedstawiono sposób użycia przycisków i ButtonFields w celu zaniechania wszystkich produktów dla określonego dostawcy lub zwiększenia lub zmniejszenia ceny określonego produktu o 10%.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="1e9b5-305">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="1e9b5-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1e9b5-306">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="1e9b5-306">About the Author</span></span>

<span data-ttu-id="1e9b5-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1e9b5-308">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="1e9b5-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1e9b5-309">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1e9b5-310">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1e9b5-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1e9b5-311">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1e9b5-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="1e9b5-312">Ubiegł</span><span class="sxs-lookup"><span data-stu-id="1e9b5-312">Previous</span></span>](adding-and-responding-to-buttons-to-a-gridview-cs.md)
