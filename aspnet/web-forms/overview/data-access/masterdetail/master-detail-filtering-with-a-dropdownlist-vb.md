---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: Filtrowanie wzorców/szczegółów przy użyciu DropDownList (VB) | Microsoft Docs
author: rick-anderson
description: W tym samouczku zobaczymy, jak wyświetlać rekordy główne w kontrolce DropDownList oraz szczegóły wybranego elementu listy w widoku GridView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 62cd296a3f36e1779666a6b5db15b0ce2488d0e4
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78528722"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="0aec3-103">Filtrowanie rekordu głównego/szczegółów przy użyciu kontrolki DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="0aec3-103">Master/Detail Filtering With a DropDownList (VB)</span></span>

<span data-ttu-id="0aec3-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0aec3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0aec3-105">[Pobierz przykładową aplikację](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) lub [Pobierz plik PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0aec3-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="0aec3-106">W tym samouczku zobaczymy, jak wyświetlać rekordy główne w kontrolce DropDownList oraz szczegóły wybranego elementu listy w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0aec3-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="0aec3-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="0aec3-107">Introduction</span></span>

<span data-ttu-id="0aec3-108">Typowym typem raportu jest *raport wzorzec/szczegóły*, w którym raport rozpoczyna się od wyświetlania pewnego zestawu rekordów "Master".</span><span class="sxs-lookup"><span data-stu-id="0aec3-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="0aec3-109">Następnie użytkownik może przejść do szczegółów jednego z rekordów głównych, co spowoduje wyświetlenie "szczegółów" tego rekordu głównego.</span><span class="sxs-lookup"><span data-stu-id="0aec3-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="0aec3-110">Raporty wzorzec/szczegóły są idealnym wyborem w przypadku wizualizacji relacji jeden-do-wielu, takich jak raport pokazujący wszystkie kategorie, a następnie umożliwiający użytkownikowi wybranie określonej kategorii i wyświetlenie skojarzonych z nimi produktów.</span><span class="sxs-lookup"><span data-stu-id="0aec3-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="0aec3-111">Ponadto raporty wzorzec/szczegóły są przydatne do wyświetlania szczegółowych informacji z szczególnie "szerokich" tabel (z wieloma kolumnami).</span><span class="sxs-lookup"><span data-stu-id="0aec3-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="0aec3-112">Na przykład poziom "Master" w raporcie głównym/szczegółowym może zawierać tylko nazwę produktu i cenę jednostkową produktów w bazie danych, a przechodzenie do określonego produktu będzie zawierać dodatkowe pola produktu (kategorii, dostawcy, ilości na jednostkę itd.).</span><span class="sxs-lookup"><span data-stu-id="0aec3-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="0aec3-113">Istnieje wiele sposobów implementacji raportu wzorzec/szczegóły.</span><span class="sxs-lookup"><span data-stu-id="0aec3-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="0aec3-114">W ten sposób i następne trzy samouczki będą wyglądały na różnych raportach głównych/szczegółowych.</span><span class="sxs-lookup"><span data-stu-id="0aec3-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="0aec3-115">W tym samouczku zobaczymy, jak wyświetlać rekordy główne w [kontrolce DropDownList](https://msdn.microsoft.com/library/dtx91y0z.aspx) oraz szczegóły wybranego elementu listy w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0aec3-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="0aec3-116">W szczególności Raport główny/szczegółowy tego samouczka zawiera listę informacji o kategorii i o produkcie.</span><span class="sxs-lookup"><span data-stu-id="0aec3-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="0aec3-117">Krok 1. Wyświetlanie kategorii w DropDownList</span><span class="sxs-lookup"><span data-stu-id="0aec3-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="0aec3-118">Nasz Raport główny/szczegółowy wyświetli listę kategorii w DropDownList, z których produkty wybranego elementu listy są wyświetlane w dalszej części strony w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0aec3-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="0aec3-119">Pierwsze zadanie przed nami, a następnie, ma mieć kategorie wyświetlane w DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0aec3-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="0aec3-120">Otwórz stronę `FilterByDropDownList.aspx` w folderze `Filtering`, przeciągnij na DropDownList z przybornika do projektanta strony i ustaw jej Właściwość `ID` na `Categories`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="0aec3-121">Następnie kliknij link wybierz źródło danych z tagu inteligentnego DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0aec3-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="0aec3-122">Spowoduje to wyświetlenie Kreatora konfiguracji źródła danych.</span><span class="sxs-lookup"><span data-stu-id="0aec3-122">This will display the Data Source Configuration wizard.</span></span>

<span data-ttu-id="0aec3-123">[![określić źródła danych DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="0aec3-124">**Rysunek 1**. Określanie źródła danych DropDownList (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>

<span data-ttu-id="0aec3-125">Wybierz, aby dodać nowy element ObjectDataSource o nazwie `CategoriesDataSource`, który wywołuje metodę `GetCategories()` klasy `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="0aec3-126">[![dodać nowego elementu ObjectDataSource o nazwie CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="0aec3-127">**Rysunek 2**. Dodawanie nowego elementu ObjectDataSource o nazwie `CategoriesDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>

<span data-ttu-id="0aec3-128">[![wybrać użycie klasy CategoriesBLL](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="0aec3-129">**Rysunek 3**. wybór użycia klasy `CategoriesBLL` (kliknij,[Aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>

<span data-ttu-id="0aec3-130">[![skonfigurować element ObjectDataSource do korzystania z metody GetCategories ()](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="0aec3-131">**Ilustracja 4**. Konfigurowanie elementu ObjectDataSource do używania metody `GetCategories()` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>

<span data-ttu-id="0aec3-132">Po skonfigurowaniu elementu ObjectDataSource nadal musimy określić, jakie pole źródła danych ma być wyświetlane w DropDownList, a które należy skojarzyć z wartością dla elementu listy.</span><span class="sxs-lookup"><span data-stu-id="0aec3-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="0aec3-133">Pole `CategoryName`, które ma być wyświetlane i `CategoryID`, jako wartość dla każdego elementu listy.</span><span class="sxs-lookup"><span data-stu-id="0aec3-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="0aec3-134">[![wyświetlać DropDownList pole CategoryName i używać IDkategorii jako wartości](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="0aec3-135">**Rysunek 5**. DropDownList wyświetlić pola `CategoryName` i użyj `CategoryID` jako wartości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>

<span data-ttu-id="0aec3-136">W tym momencie mamy kontrolkę DropDownList, która jest wypełniana rekordami z tabeli `Categories` (wszystkie wykonane przez około 6 sekund).</span><span class="sxs-lookup"><span data-stu-id="0aec3-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="0aec3-137">Rysunek 6 przedstawia postęp z tego względu, gdy jest wyświetlany za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0aec3-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="0aec3-138">[![listy rozwijanej z bieżącymi kategoriami](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="0aec3-139">**Ilustracja 6**. Lista rozwijana z bieżącymi kategoriami ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>

## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="0aec3-140">Krok 2. Dodawanie produktu GridView</span><span class="sxs-lookup"><span data-stu-id="0aec3-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="0aec3-141">Ostatnim krokiem w naszym raporcie głównym/szczegółowym jest wyświetlenie listy produktów skojarzonych z wybraną kategorią.</span><span class="sxs-lookup"><span data-stu-id="0aec3-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="0aec3-142">Aby to osiągnąć, Dodaj widok GridView do strony i Utwórz nowy element ObjectDataSource o nazwie `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="0aec3-143">`productsDataSource` kontrolują dane wycofane z metody `GetProductsByCategoryID(categoryID)` klasy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="0aec3-144">[![wybrać metodę GetProductsByCategoryID (IDKategorii)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="0aec3-145">**Rysunek 7**. wybierz metodę `GetProductsByCategoryID(categoryID)` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>

<span data-ttu-id="0aec3-146">Po wybraniu tej metody Kreator ObjectDataSource poprosi nas o wartość parametru *`categoryID`* metody.</span><span class="sxs-lookup"><span data-stu-id="0aec3-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="0aec3-147">Aby użyć wartości wybranego `categories` elementu DropDownList Ustaw Źródło parametru na Control i ControlID, aby `Categories`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="0aec3-148">[![ustawić dla parametru IDKategorii wartości kategorii DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="0aec3-149">**Ilustracja 8**. ustaw parametr *`categoryID`* na wartość `Categories` DropDownList ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>

<span data-ttu-id="0aec3-150">Poświęć chwilę, aby zaewidencjonować nasz postęp w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0aec3-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="0aec3-151">Podczas pierwszego odwiedzania strony są wyświetlane te produkty należące do wybranej kategorii (napoje) (jak pokazano na rysunku 9), ale zmiana DropDownList nie aktualizuje danych.</span><span class="sxs-lookup"><span data-stu-id="0aec3-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="0aec3-152">Wynika to z faktu, że w celu zaktualizowania widoku GridView musi wystąpić ogłoszenie zwrotne.</span><span class="sxs-lookup"><span data-stu-id="0aec3-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="0aec3-153">Aby to osiągnąć, mamy dwie opcje (żadna z tych elementów nie wymaga pisania kodu):</span><span class="sxs-lookup"><span data-stu-id="0aec3-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="0aec3-154">**Ustaw**[Właściwość autoogłaszania](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)DropDownList kategorii**na wartość true.**</span><span class="sxs-lookup"><span data-stu-id="0aec3-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="0aec3-155">(Możesz to zrobić, zaznaczając opcję Włącz autoogłaszanie w tagu inteligentnym DropDownList). Spowoduje to wyzwolenie ogłaszania zwrotnego za każdym razem, gdy wybrany element DropDownList zostanie zmieniony przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0aec3-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="0aec3-156">W związku z tym, gdy użytkownik wybierze nową kategorię z DropDownList, nastąpi odświeżenie zwrotne, a widok GridView zostanie zaktualizowany o produkty dla nowo wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0aec3-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="0aec3-157">(To jest podejście, które zostało użyte w tym samouczku).</span><span class="sxs-lookup"><span data-stu-id="0aec3-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="0aec3-158">**Dodaj kontrolkę sieci Web przycisku obok DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="0aec3-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="0aec3-159">Ustaw jej Właściwość `Text` na wartość Refresh lub podobną.</span><span class="sxs-lookup"><span data-stu-id="0aec3-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="0aec3-160">W tym podejściu użytkownik będzie musiał wybrać nową kategorię, a następnie kliknąć przycisk.</span><span class="sxs-lookup"><span data-stu-id="0aec3-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="0aec3-161">Kliknięcie przycisku spowoduje odświeżenie i zaktualizowanie widoku GridView w celu wyświetlenia listy produktów wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0aec3-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="0aec3-162">Ilustracje 9 i 10 ilustrują Raport główny/szczegółowy w działaniu.</span><span class="sxs-lookup"><span data-stu-id="0aec3-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="0aec3-163">[![podczas pierwszego odwiedzania strony zostaną wyświetlone produkty napoje](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="0aec3-164">**Rysunek 9**. podczas pierwszego odwiedzania strony są wyświetlane produkty napoje ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>

<span data-ttu-id="0aec3-165">[![wybranie nowego produktu (produkt) automatycznie spowoduje odświeżenie, zaktualizowanie widoku GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="0aec3-166">**Ilustracja 10**: wybranie nowego produktu (produkt) powoduje automatyczne wypróbowanie ogłaszania zwrotnego, aktualizowanie widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="0aec3-167">Dodawanie elementu listy "--Wybierz kategorię--"</span><span class="sxs-lookup"><span data-stu-id="0aec3-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="0aec3-168">Gdy po raz pierwszy zostanie odwiedzana strona `FilterByDropDownList.aspx` kategorii (napoje) pierwszego elementu listy DropDownList są domyślnie zaznaczone, pokazując produkty napoje w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0aec3-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="0aec3-169">Zamiast wyświetlać produkty z pierwszej kategorii, możemy chcieć zamiast tego wybrać element DropDownList, który ma postać podobną do "--Wybierz kategorię--".</span><span class="sxs-lookup"><span data-stu-id="0aec3-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="0aec3-170">Aby dodać nowy element listy do DropDownList, przejdź do okno Właściwości i kliknij wielokropek we właściwości `Items`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="0aec3-171">Dodaj nowy element listy z `Text` "--Wybierz kategorię--" i `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>

<span data-ttu-id="0aec3-172">[![dodać--wybierz kategorię--element listy](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="0aec3-173">**Ilustracja 11**. Dodawanie elementu--wybierz kategorię--([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>

<span data-ttu-id="0aec3-174">Alternatywnie możesz dodać element listy, dodając następujący znacznik do DropDownList:</span><span class="sxs-lookup"><span data-stu-id="0aec3-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="0aec3-175">Ponadto musimy ustawić `AppendDataBoundItems` formantu DropDownList na wartość true, ponieważ w przypadku, gdy kategorie są powiązane z DropDownList z elementu ObjectDataSource, zastąpią wszystkie ręcznie dodane elementy listy, jeśli `AppendDataBoundItems` nie ma wartości true.</span><span class="sxs-lookup"><span data-stu-id="0aec3-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>

![Ustaw właściwość AppendDataBoundItems na wartość true](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="0aec3-177">**Ilustracja 12**. ustaw właściwość `AppendDataBoundItems` na wartość true</span><span class="sxs-lookup"><span data-stu-id="0aec3-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="0aec3-178">Po wprowadzeniu tych zmian podczas pierwszego odwiedzania strony wybrana jest opcja "--Wybierz kategorię--" i nie są wyświetlane żadne produkty.</span><span class="sxs-lookup"><span data-stu-id="0aec3-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>

<span data-ttu-id="0aec3-179">[![ładowania strony początkowej nie są wyświetlane żadne produkty](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="0aec3-180">**Ilustracja 13**. na początkowym załadowaniu strony nie są wyświetlane żadne produkty ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>

<span data-ttu-id="0aec3-181">Nie są wyświetlane żadne produkty, gdy jest wybrany element listy "--Wybierz kategorię--", ponieważ jego wartość jest `-1` i w bazie danych nie ma żadnych produktów z `CategoryID` `-1`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="0aec3-182">Jeśli jest to zachowanie, które chcesz wykonać, należy to zrobić.</span><span class="sxs-lookup"><span data-stu-id="0aec3-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="0aec3-183">Jeśli jednak chcesz wyświetlić *wszystkie* kategorie, gdy zostanie wybrany element listy "--Wybierz kategorię--", Wróć do klasy `ProductsBLL` i dostosuj metodę `GetProductsByCategoryID(categoryID)`, tak aby wywołuje metodę `GetProducts()`, jeśli wartość parametru przekazanie w *`categoryID`* jest mniejsza od zera:</span><span class="sxs-lookup"><span data-stu-id="0aec3-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>

[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="0aec3-184">Użyta technika jest podobna do metody, która została użyta w celu wyświetlenia wszystkich dostawców z powrotem w samouczku [parametrów deklaratywnych](../basic-reporting/declarative-parameters-cs.md) , ale w tym przykładzie używamy wartości `-1`, aby wskazać, że wszystkie rekordy mają być pobierane w przeciwieństwie do `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="0aec3-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="0aec3-185">Wynika to z faktu, że parametr *`categoryID`* metody `GetProductsByCategoryID(categoryID)` oczekuje, że przekazano liczbę całkowitą, podczas gdy w samouczku parametrów deklaratywnych podano parametr wejściowy ciągu.</span><span class="sxs-lookup"><span data-stu-id="0aec3-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="0aec3-186">Rysunek 14 przedstawia zrzut ekranu `FilterByDropDownList.aspx`, gdy zaznaczona jest opcja "--Wybierz kategorię--".</span><span class="sxs-lookup"><span data-stu-id="0aec3-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="0aec3-187">W tym miejscu wszystkie produkty są wyświetlane domyślnie, a użytkownik może zawęzić widok, wybierając określoną kategorię.</span><span class="sxs-lookup"><span data-stu-id="0aec3-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>

<span data-ttu-id="0aec3-188">[![wszystkie produkty są teraz wyświetlane domyślnie](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="0aec3-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="0aec3-189">**Ilustracja 14**. wszystkie produkty są teraz wyświetlane domyślnie ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="0aec3-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>

## <a name="summary"></a><span data-ttu-id="0aec3-190">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="0aec3-190">Summary</span></span>

<span data-ttu-id="0aec3-191">Podczas wyświetlania danych zależnych od hierarchii często pomocne jest prezentowanie danych przy użyciu raportów master/detail, z których użytkownik może rozpocząć Peru danych od góry hierarchii i przejść do szczegółów.</span><span class="sxs-lookup"><span data-stu-id="0aec3-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="0aec3-192">W tym samouczku sprawdzono Tworzenie prostego raportu głównego/szczegółów pokazującego produkty wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0aec3-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="0aec3-193">Zostało to osiągnięte przy użyciu DropDownList dla listy kategorii i widoku GridView dla produktów należących do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0aec3-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="0aec3-194">W [następnym samouczku](master-detail-filtering-with-two-dropdownlists-vb.md) interfejs DropDownList został jeszcze jeden krok, przy użyciu dwóch kontrolek DropDownList.</span><span class="sxs-lookup"><span data-stu-id="0aec3-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="0aec3-195">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="0aec3-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0aec3-196">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="0aec3-196">About the Author</span></span>

<span data-ttu-id="0aec3-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="0aec3-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0aec3-198">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0aec3-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0aec3-199">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0aec3-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0aec3-200">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0aec3-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0aec3-201">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0aec3-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0aec3-202">[Poprzednie](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
> [dalej](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0aec3-202">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>
