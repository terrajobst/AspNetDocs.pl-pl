---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Przekazywanie plików (VB) | Microsoft Docs
author: rick-anderson
description: Dowiedz się, jak zezwolić użytkownikom na przekazywanie plików binarnych (takich jak dokumenty programu Word lub PDF) do witryny sieci Web, gdzie mogą być przechowywane w systemie plików serwera...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: 6e0d57ef2f1e8132f19777a7d14e94611c68adcd
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78548567"
---
# <a name="uploading-files-vb"></a><span data-ttu-id="5e1c4-103">Przekazywanie plików (VB)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-103">Uploading Files (VB)</span></span>

<span data-ttu-id="5e1c4-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5e1c4-105">[Pobierz przykładową aplikację](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) lub [Pobierz plik PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="5e1c4-106">Dowiedz się, jak umożliwić użytkownikom przekazywanie plików binarnych (takich jak dokumenty programu Word lub PDF) do witryny sieci Web, gdzie mogą być przechowywane w systemie plików serwera lub w bazie danych programu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>

## <a name="introduction"></a><span data-ttu-id="5e1c4-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="5e1c4-107">Introduction</span></span>

<span data-ttu-id="5e1c4-108">Wszystkie samouczki, które chcielibyśmy zbadać, są przeznaczone wyłącznie dla danych tekstowych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="5e1c4-109">Jednak wiele aplikacji ma modele danych, które przechwytują dane tekstowe i binarne.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="5e1c4-110">Witryna Datowanie online może zezwalać użytkownikom na przekazywanie zdjęć w celu skojarzenia ich z ich profilem.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="5e1c4-111">Witryna internetowa rekrutacji może pozwolić użytkownikom na przekazywanie ich życiorysów jako dokumentu programu Microsoft Word lub PDF.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="5e1c4-112">Praca z danymi binarnymi dodaje nowy zestaw wyzwań.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="5e1c4-113">Należy zdecydować, jak dane binarne są przechowywane w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="5e1c4-114">Interfejs używany do wstawiania nowych rekordów należy zaktualizować, aby umożliwić użytkownikowi przekazanie pliku z komputera, a dodatkowe czynności muszą zostać wykonane, aby wyświetlić lub udostępnić metodę pobierania rekordu s skojarzonych danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="5e1c4-115">W tym samouczku i następnych trzech zapoznajemy się z tym, jak obsłużyć te wyzwania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="5e1c4-116">Na końcu tych samouczków zostanie utworzona w pełni funkcjonalna aplikacja, która kojarzy obraz i broszurę PDF z każdą kategorią.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="5e1c4-117">W tym konkretnym samouczku Przyjrzyjmy się różnym technikom do przechowywania danych binarnych i Dowiedz się, jak umożliwić użytkownikom przekazywanie plików z ich komputerów i zapisywanie ich w systemie plików serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="5e1c4-118">Dane binarne, które są częścią modelu danych aplikacji, są czasami określane jako [obiekt BLOB](http://en.wikipedia.org/wiki/Binary_large_object), akronim dla dużego obiektu binarnego.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="5e1c4-119">W tych samouczkach zostały wybrane użycie danych binarnych terminologii, chociaż termin BLOB jest synonimem.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>

## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="5e1c4-120">Krok 1. Tworzenie pracy z danymi binarnymi na stronach sieci Web</span><span class="sxs-lookup"><span data-stu-id="5e1c4-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="5e1c4-121">Przed rozpoczęciem eksplorowania wyzwań związanych z dodaniem obsługi danych binarnych Poświęć chwilę na utworzenie stron ASP.NET w naszym projekcie witryny sieci Web, które będziemy potrzebować do tego samouczka i trzech następnych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="5e1c4-122">Zacznij od dodania nowego folderu o nazwie `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="5e1c4-123">Następnie Dodaj następujące strony ASP.NET do tego folderu, aby upewnić się, że każda strona jest skojarzona z `Site.master` stroną wzorcową:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`

![Dodaj strony ASP.NET dla samouczków dotyczących danych binarnych](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="5e1c4-125">**Rysunek 1**. dodawanie stron ASP.NET dla samouczków dotyczących danych binarnych</span><span class="sxs-lookup"><span data-stu-id="5e1c4-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>

<span data-ttu-id="5e1c4-126">Podobnie jak w przypadku innych folderów, `Default.aspx` w folderze `BinaryData` wyświetli samouczki w sekcji.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="5e1c4-127">Odwołaj się do tego, że formant użytkownika `SectionLevelTutorialListing.ascx` udostępnia tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="5e1c4-128">W związku z tym należy dodać tę kontrolkę użytkownika do `Default.aspx`, przeciągając ją z Eksplorator rozwiązań na stronę widok Projekt strony.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="5e1c4-129">[![dodać kontrolkę użytkownika SectionLevelTutorialListing. ascx do default. aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span></span>

<span data-ttu-id="5e1c4-130">**Rysunek 2**. Dodawanie kontrolki użytkownika `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>

<span data-ttu-id="5e1c4-131">Na koniec Dodaj te strony jako wpisy do pliku `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="5e1c4-132">Przed zwiększeniem `<siteMapNode>`GridView należy dodać następujące znaczniki:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>

[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="5e1c4-133">Po aktualizacji `Web.sitemap`zapoznaj się z witryną internetową samouczków za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="5e1c4-134">Menu po lewej stronie zawiera teraz elementy do pracy z samouczkami danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>

![Mapa witryny zawiera teraz wpisy dotyczące pracy z samouczkami danych binarnych](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="5e1c4-136">**Rysunek 3**. Mapa witryny zawiera teraz wpisy dotyczące pracy z samouczkami danych binarnych</span><span class="sxs-lookup"><span data-stu-id="5e1c4-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>

## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="5e1c4-137">Krok 2. decydowanie o miejscu przechowywania danych binarnych</span><span class="sxs-lookup"><span data-stu-id="5e1c4-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="5e1c4-138">Dane binarne skojarzone z modelem danych aplikacji mogą być przechowywane w jednym z dwóch miejsc: w systemie plików serwera sieci Web z odwołaniem do pliku przechowywanego w bazie danych programu; lub bezpośrednio w samej bazie danych (zobacz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="5e1c4-139">Każde podejście ma swój własny zestaw informatyków i wad i zawiera bardziej szczegółowe omówienie.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>

<span data-ttu-id="5e1c4-140">[![dane binarne mogą być przechowywane w systemie plików lub bezpośrednio w bazie danych](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span></span>

<span data-ttu-id="5e1c4-141">**Rysunek 4**. dane binarne mogą być przechowywane w systemie plików lub bezpośrednio w bazie danych ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>

<span data-ttu-id="5e1c4-142">Załóżmy, że chcemy zwiększyć bazę danych Northwind, aby skojarzyć obraz z każdym produktem.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="5e1c4-143">Jedną z opcji jest zapisanie tych plików obrazów w systemie plików serwera sieci Web i zapisanie ścieżki w tabeli `Products`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="5e1c4-144">W tym podejściu d dodajemy kolumnę `ImagePath` do tabeli `Products` typu `varchar(200)`, być może.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="5e1c4-145">Gdy użytkownik przekazał zdjęcie do Chai, ten obraz może być przechowywany w systemie plików s serwera sieci Web w `~/Images/Tea.jpg`, gdzie `~` reprezentuje ścieżkę fizyczną aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="5e1c4-146">Oznacza to, że jeśli witryna sieci Web jest odblokowana przy użyciu ścieżki fizycznej `C:\Websites\Northwind\`, `~/Images/Tea.jpg` byłoby równoważne `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="5e1c4-147">Po przekazaniu pliku obrazu firma Microsoft aktualizuje rekord Chai w tabeli `Products` tak, aby jej `ImagePath` kolumna odwołuje się do ścieżki nowego obrazu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="5e1c4-148">Możemy użyć `~/Images/Tea.jpg` lub tylko `Tea.jpg`, jeśli postanowiono, że wszystkie obrazy produktów zostaną umieszczone w folderze `Images` aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="5e1c4-149">Główne zalety przechowywania danych binarnych w systemie plików są następujące:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="5e1c4-150">**Łatwość wdrażania** , ponieważ wkrótce zobaczymy, przechowywanie i pobieranie danych binarnych przechowywanych bezpośrednio w bazie danych programu obejmuje nieco więcej kodu niż podczas pracy z danymi w systemie plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="5e1c4-151">Ponadto, aby użytkownik mógł wyświetlać lub pobierać dane binarne, muszą być przedstawiane przy użyciu adresu URL dla tych danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="5e1c4-152">Jeśli dane znajdują się w systemie plików serwera sieci Web, adres URL jest prosty.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="5e1c4-153">Jeśli dane są przechowywane w bazie danych programu, należy utworzyć stronę sieci Web, która będzie pobierać i zwracać dane z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="5e1c4-154">**Szerszy dostęp do danych binarnych** może być konieczne udostępnienie danych binarnych innym usługom lub aplikacjom, które nie mogą pobierać danych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="5e1c4-155">Na przykład obrazy skojarzone z każdym produktem mogą również być dostępne dla użytkowników za pomocą [protokołu FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), w tym przypadku d chcemy przechowywać dane binarne w systemie plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="5e1c4-156">**Wydajność** Jeśli dane binarne są przechowywane w systemie plików, Przeciążenie popytu i sieci między serwerem bazy danych i serwerem sieci Web będzie mniejsze niż w przypadku przechowywania danych binarnych bezpośrednio w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="5e1c4-157">Główną wadą przechowywania danych binarnych w systemie plików jest oddzielenie danych z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="5e1c4-158">Jeśli rekord zostanie usunięty z tabeli `Products`, skojarzony plik w systemie plików serwera sieci Web nie zostanie automatycznie usunięty.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="5e1c4-159">Musimy napisać dodatkowy kod, aby usunąć plik lub system plików stanie się nieużywanymi, oddzielonymi plikami.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="5e1c4-160">Ponadto podczas tworzenia kopii zapasowej bazy danych należy koniecznie utworzyć kopie zapasowe skojarzonych danych binarnych w systemie plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="5e1c4-161">Przeniesienie bazy danych do innej lokacji lub serwera stwarza podobne wyzwania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="5e1c4-162">Alternatywnie dane binarne mogą być przechowywane bezpośrednio w bazie danych Microsoft SQL Server 2005 przez utworzenie kolumny typu `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="5e1c4-163">Podobnie jak w przypadku innych typów danych o zmiennej długości, można określić maksymalną długość danych binarnych, które mogą być przechowywane w tej kolumnie.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="5e1c4-164">Na przykład, aby zarezerwować maksymalnie 5 000 bajtów, użyj `varbinary(5000)`; `varbinary(MAX)` pozwala na maksymalny rozmiar magazynu (około 2 GB).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="5e1c4-165">Główną zaletą przechowywania danych binarnych bezpośrednio w bazie danych jest ścisłe sprzężenie między danymi binarnymi i rekordem bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="5e1c4-166">Znacznie upraszcza to zadania zarządzania bazami danych, takie jak kopie zapasowe lub przeniesienie bazy danych do innej lokacji lub serwera programu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="5e1c4-167">Ponadto usunięcie rekordu powoduje automatyczne usunięcie odpowiednich danych binarnych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="5e1c4-168">Istnieją również bardziej subtelne zalety przechowywania danych binarnych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="5e1c4-169">Więcej szczegółowych informacji można znaleźć w artykule [przechowywanie plików binarnych bezpośrednio w bazie danych przy użyciu ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="5e1c4-170">W Microsoft SQL Server 2000 i starszych wersjach typ danych `varbinary` miał maksymalny limit 8 000 bajtów.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="5e1c4-171">Aby przechowywać do 2 GB danych binarnych, należy zamiast tego użyć [typu danych`image`](https://msdn.microsoft.com/library/ms187993.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="5e1c4-172">Jednak dodanie `MAX` w SQL Server 2005 oznacza, że typ danych `image` został uznany za przestarzały.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="5e1c4-173">Jest ona nadal obsługiwana w celu zapewnienia zgodności z poprzednimi wersjami, ale firma Microsoft ogłosiła, że typ danych `image` zostanie usunięty w przyszłych wersjach SQL Server.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>

<span data-ttu-id="5e1c4-174">W przypadku korzystania z starszego modelu danych może zostać wyświetlony `image` typ danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="5e1c4-175">Tabela `Categories` bazy danych Northwind zawiera kolumnę `Picture`, która może służyć do przechowywania danych binarnych pliku obrazu dla kategorii.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="5e1c4-176">Ponieważ baza danych Northwind ma swoje elementy główne w programie Microsoft Access i starszych wersjach SQL Server, ta kolumna jest typu `image`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="5e1c4-177">Na potrzeby tego samouczka i następnych trzech będziemy używać obu tych metod.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="5e1c4-178">Tabela `Categories` ma już kolumnę `Picture` do przechowywania zawartości binarnej obrazu dla kategorii.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="5e1c4-179">Dodamy dodatkową kolumnę `BrochurePath`, aby przechowywać ścieżkę do pliku PDF w systemie plików serwera sieci Web, który może służyć do zapewnienia jakości wydruku i dopracowanych przeglądów kategorii.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="5e1c4-180">Krok 3. Dodawanie kolumny`BrochurePath`do tabeli`Categories`</span><span class="sxs-lookup"><span data-stu-id="5e1c4-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="5e1c4-181">Obecnie tabela kategorii ma tylko cztery kolumny: `CategoryID`, `CategoryName`, `Description`i `Picture`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="5e1c4-182">Oprócz tych pól należy dodać nową, która będzie wskazywała broszurę kategorii s (jeśli taka istnieje).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="5e1c4-183">Aby dodać tę kolumnę, przejdź do Eksplorator serwera, przechodzenie do szczegółów tabel, kliknij prawym przyciskiem myszy tabelę `Categories` i wybierz Otwórz definicję tabeli (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="5e1c4-184">Jeśli nie widzisz Eksplorator serwera, przenieś ją, wybierając opcję Eksplorator serwera z menu Widok lub naciśnij klawisze CTRL + ALT + S.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="5e1c4-185">Dodaj nową kolumnę `varchar(200)` do tabeli `Categories` o nazwie `BrochurePath` i umożliwi `NULL` s i kliknij ikonę Zapisz (lub naciśnij klawisze CTRL + S).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>

<span data-ttu-id="5e1c4-186">[![dodać kolumny BrochurePath do tabeli Categories](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span></span>

<span data-ttu-id="5e1c4-187">**Rysunek 5**. dodawanie kolumny `BrochurePath` do tabeli `Categories` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>

## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="5e1c4-188">Krok 4. aktualizowanie architektury w celu używania kolumn`Picture`i`BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="5e1c4-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="5e1c4-189">`CategoriesDataTable` w warstwie dostępu do danych (DAL) ma obecnie zdefiniowaną cztery `DataColumn` s: `CategoryID`, `CategoryName`, `Description`i `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="5e1c4-190">Po pierwotnie zaprojektowaniu tego elementu DataTable w samouczku [Tworzenie warstwy dostępu do danych](../introduction/creating-a-data-access-layer-vb.md) `CategoriesDataTable` miał tylko trzy pierwsze kolumny; kolumna `NumberOfProducts` została dodana w bazie danych [master/detail przy użyciu listy punktowanej rekordów głównych z szczegółowym samouczkiem elementu DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="5e1c4-191">Zgodnie z opisem w temacie *Tworzenie warstwy dostępu do danych*, dane tabel w określonym zestawie danych tworzą obiekty biznesowe.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="5e1c4-192">TableAdapters są odpowiedzialne za komunikowanie się z bazą danych i wypełnianie obiektów firmy wynikami zapytania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="5e1c4-193">`CategoriesDataTable` jest wypełniana przez `CategoriesTableAdapter`, która ma trzy metody pobierania danych:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="5e1c4-194">`GetCategories()` wykonuje głównego zapytania TableAdapter s i zwraca pola `CategoryID`, `CategoryName`i `Description` wszystkich rekordów w tabeli `Categories`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="5e1c4-195">Główne zapytanie jest używane przez automatycznie generowane metody `Insert` i `Update`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="5e1c4-196">`GetCategoryByCategoryID(categoryID)` zwraca pola `CategoryID`, `CategoryName`i `Description` kategorii, których `CategoryID` jest równa *IDkategorii*.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="5e1c4-197">`GetCategoriesAndNumberOfProducts()` — zwraca pola `CategoryID`, `CategoryName`i `Description` dla wszystkich rekordów w tabeli `Categories`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="5e1c4-198">Używa również podzapytania, aby zwrócić liczbę produktów skojarzonych z każdą kategorią.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="5e1c4-199">Zwróć uwagę, że żadna z tych zapytań nie zwróci kolumn `Categories` tabeli `Picture` lub `BrochurePath` nie `CategoriesDataTable` `DataColumn` s dla tych pól.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="5e1c4-200">Aby można było korzystać z właściwości obrazu i `BrochurePath`, należy najpierw dodać je do `CategoriesDataTable` a następnie zaktualizować klasę `CategoriesTableAdapter`, aby zwracała te kolumny.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="5e1c4-201">Dodawanie`Picture`i`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="5e1c4-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="5e1c4-202">Zacznij od dodania tych dwóch kolumn do `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="5e1c4-203">Kliknij prawym przyciskiem myszy nagłówek `CategoriesDataTable` s, wybierz polecenie Dodaj z menu kontekstowego, a następnie wybierz opcję kolumny.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="5e1c4-204">Spowoduje to utworzenie nowego `DataColumn` w elemencie DataTable o nazwie `Column1`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="5e1c4-205">Zmień nazwę tej kolumny na `Picture`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="5e1c4-206">Na okno Właściwości ustaw właściwość `DataType` `DataColumn` s na `System.Byte[]` (nie jest to opcja na liście rozwijanej, należy wpisać ją w).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>

<span data-ttu-id="5e1c4-207">[![utworzyć elementu DataColumn o nazwie Picture, którego typem danych jest system. Byte []](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span></span>

<span data-ttu-id="5e1c4-208">**Ilustracja 6**. Utwórz `DataColumn` o nazwie `Picture`, której `DataType` jest `System.Byte[]` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>

<span data-ttu-id="5e1c4-209">Dodaj kolejne `DataColumn` do elementu DataTable, nadając mu nazwę `BrochurePath` przy użyciu domyślnej wartości `DataType` (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="5e1c4-210">Zwracanie wartości`Picture`i`BrochurePath`z TableAdapter</span><span class="sxs-lookup"><span data-stu-id="5e1c4-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="5e1c4-211">Po dodaniu tych dwóch `DataColumn` s do `CategoriesDataTable`, będziemy gotowi do zaktualizowania `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="5e1c4-212">Możliwe, że obie te wartości kolumn zostały zwrócone w głównym zapytaniu TableAdapter, ale spowoduje to przywrócenie danych binarnych przy każdej wywołaniu metody `GetCategories()`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="5e1c4-213">Zamiast tego należy zaktualizować główne zapytanie TableAdapter, aby przywrócić `BrochurePath` i utworzyć dodatkową metodę pobierania danych zwracającą określoną kolumnę `Picture` kategorii.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="5e1c4-214">Aby zaktualizować główne zapytanie TableAdapter, kliknij prawym przyciskiem myszy nagłówek `CategoriesTableAdapter` s i wybierz opcję Konfiguruj z menu kontekstowego.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="5e1c4-215">Spowoduje to wyświetlenie Kreatora konfiguracji karty spisu, który został zaobserwowany w wielu wcześniejszych samouczkach.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="5e1c4-216">Zaktualizuj zapytanie, aby przywrócić `BrochurePath` i kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>

<span data-ttu-id="5e1c4-217">[![zaktualizować listę kolumn w instrukcji SELECT, aby zwracała również BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span></span>

<span data-ttu-id="5e1c4-218">**Rysunek 7**. Aktualizacja listy kolumn w instrukcji `SELECT`, aby zwracała również `BrochurePath` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>

<span data-ttu-id="5e1c4-219">W przypadku używania instrukcji SQL ad hoc dla TableAdapter, aktualizowanie listy kolumn w zapytaniu głównym aktualizuje listę kolumn dla wszystkich metod zapytań `SELECT` w TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="5e1c4-220">Oznacza to, że metoda `GetCategoryByCategoryID(categoryID)` została zaktualizowana w celu zwrócenia kolumny `BrochurePath`, co może być zamierzone.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="5e1c4-221">Jednak Zaktualizowano także listę kolumn w metodzie `GetCategoriesAndNumberOfProducts()`, usuwając podzapytanie zwracające liczbę produktów dla każdej kategorii.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="5e1c4-222">W związku z tym musimy zaktualizować tę metodę s `SELECT` Query.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="5e1c4-223">Kliknij prawym przyciskiem myszy metodę `GetCategoriesAndNumberOfProducts()`, wybierz polecenie Konfiguruj i Przywróć pierwotną wartość zapytania `SELECT`:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="5e1c4-224">Następnie utwórz nową metodę TableAdapter, która zwraca określoną kategorię `Picture` wartość kolumny.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="5e1c4-225">Kliknij prawym przyciskiem myszy nagłówek `CategoriesTableAdapter` s i wybierz opcję Dodaj zapytanie, aby uruchomić Kreatora konfiguracji zapytania TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="5e1c4-226">Pierwszy krok tego kreatora prosi nas, jeśli chcemy wysyłać zapytania o dane przy użyciu instrukcji SQL ad hoc, nowej procedury składowanej lub istniejącej.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="5e1c4-227">Wybierz pozycję Użyj instrukcji SQL i kliknij przycisk Dalej.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="5e1c4-228">Ponieważ zwrócimy wiersz, wybierz opcję Wybierz, która zwraca wiersze z drugiego kroku.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>

<span data-ttu-id="5e1c4-229">[![wybrać opcję Użyj instrukcji SQL](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-229">[![Select the Use SQL statements Option](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span></span>

<span data-ttu-id="5e1c4-230">**Ilustracja 8**. Wybierz opcję Użyj instrukcji SQL ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](uploading-files-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>

<span data-ttu-id="5e1c4-231">[![, ponieważ zapytanie zwróci rekord z tabeli Categories, wybierz pozycję Zaznacz, która zwraca wiersze](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span></span>

<span data-ttu-id="5e1c4-232">**Ilustracja 9**. ponieważ zapytanie zwróci rekord z tabeli Categories, wybierz pozycję Zaznacz, która zwraca wiersze ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>

<span data-ttu-id="5e1c4-233">W trzecim kroku wprowadź następujące zapytanie SQL i kliknij przycisk Dalej:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-233">In the third step, enter the following SQL query and click Next:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="5e1c4-234">Ostatnim krokiem jest wybranie nazwy nowej metody.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="5e1c4-235">Użyj `FillCategoryWithBinaryDataByCategoryID` i `GetCategoryWithBinaryDataByCategoryID` do wypełnienia elementu DataTable i zwrócenia odpowiednio wzorców DataTable.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="5e1c4-236">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-236">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="5e1c4-237">[![wybrać nazwy metod TableAdapter](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span></span>

<span data-ttu-id="5e1c4-238">**Ilustracja 10**. Wybieranie nazw metod TableAdapter ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](uploading-files-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>

> [!NOTE]
> <span data-ttu-id="5e1c4-239">Po zakończeniu działania Kreatora konfiguracji zapytania karty tabeli może zostać wyświetlone okno dialogowe z informacją o tym, że nowy tekst polecenia zwraca dane ze schematem innym niż schemat głównej kwerendy.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="5e1c4-240">W skrócie Kreator nie ma zanotowania, że główne `GetCategories()` zapytanie TableAdapter s zwróci inny schemat niż ten, który został właśnie utworzony.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="5e1c4-241">Jednak jest to co jest potrzebne, więc możesz zignorować ten komunikat.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-241">But this is what we want, so you can disregard this message.</span></span>

<span data-ttu-id="5e1c4-242">Należy również pamiętać, że jeśli używasz instrukcji SQL ad hoc i używasz Kreatora do zmiany głównego zapytania TableAdapter s w późniejszym czasie, spowoduje to Zmodyfikowanie listy kolumn `GetCategoryWithBinaryDataByCategoryID` Metoda s `SELECT` w celu uwzględnienia tylko tych kolumn z głównego zapytania (oznacza to, że usunie kolumnę `Picture` z zapytania).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="5e1c4-243">Konieczne będzie ręczne zaktualizowanie listy kolumn, aby zwracała `Picture` kolumnę, podobnie jak w przypadku metody `GetCategoriesAndNumberOfProducts()` wcześniej w tym kroku.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="5e1c4-244">Po dodaniu dwóch `DataColumn` s do `CategoriesDataTable` i metody `GetCategoryWithBinaryDataByCategoryID` do `CategoriesTableAdapter`, te klasy w projektancie zestawu danych powinny wyglądać podobnie jak zrzut ekranu na rysunku 11.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>

![Projektant obiektów DataSet zawiera nowe kolumny i metodę](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="5e1c4-246">**Ilustracja 11**. Projektant obiektów DataSet zawiera nowe kolumny i metodę</span><span class="sxs-lookup"><span data-stu-id="5e1c4-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>

## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="5e1c4-247">Aktualizowanie warstwy logiki biznesowej (LOGIKI biznesowej)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="5e1c4-248">Po zaktualizowaniu DAL wszystko to, co pozostanie, aby rozszerzyć warstwę logiki biznesowej (LOGIKI biznesowej) w celu uwzględnienia metody nowej metody `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="5e1c4-249">Dodaj następującą metodę do klasy `CategoriesBLL`:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-249">Add the following method to the `CategoriesBLL` class:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="5e1c4-250">Krok 5. Przekazywanie pliku z klienta na serwer sieci Web</span><span class="sxs-lookup"><span data-stu-id="5e1c4-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="5e1c4-251">Podczas zbierania danych binarnych często te dane są dostarczane przez użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="5e1c4-252">Aby przechwycić te informacje, użytkownik musi mieć możliwość przekazania pliku z komputera do serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="5e1c4-253">Przekazane dane muszą być zintegrowane z modelem danych, co może oznaczać zapisanie pliku w systemie plików serwera sieci Web i dodanie ścieżki do pliku w bazie danych lub zapisanie zawartości binarnej bezpośrednio w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="5e1c4-254">W tym kroku dowiesz się, jak zezwolić użytkownikowi na przekazywanie plików z komputera na serwer programu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="5e1c4-255">W następnym samouczku będziemy zachęcać do integracji przekazanego pliku z modelem danych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="5e1c4-256">ASP.NET 2,0 s New [FileUpload Web Control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) udostępnia mechanizm umożliwiający użytkownikom wysyłanie plików z komputera do serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="5e1c4-257">Formant FileUpload renderuje jako element `<input>`, którego atrybut `type` jest ustawiony na plik, które przeglądarki są wyświetlane jako pole tekstowe z przyciskiem przeglądania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="5e1c4-258">Kliknięcie przycisku Przeglądaj powoduje wyświetlenie okna dialogowego, w którym użytkownik może wybrać plik.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="5e1c4-259">Po opublikowaniu formularza zawartość wybranego pliku s jest wysyłana wraz z ogłaszaniem zwrotnym.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="5e1c4-260">Po stronie serwera informacje o przekazanym pliku są dostępne za pomocą właściwości kontrolki FileUpload s.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="5e1c4-261">Aby zademonstrować przekazywanie plików, Otwórz stronę `FileUpload.aspx` w folderze `BinaryData`, przeciągnij kontrolkę FileUpload z przybornika do projektanta i ustaw właściwość Control s `ID` na `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="5e1c4-262">Następnie Dodaj kontrolkę sieci Web przycisk Ustawienia `ID` i `Text` właściwości, aby `UploadButton` i przekazać wybrany plik odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="5e1c4-263">Na koniec Umieść kontrolkę sieci Web etykieta pod przyciskiem, wyczyść jej Właściwość `Text` i ustaw jej Właściwość `ID` na `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>

<span data-ttu-id="5e1c4-264">[![dodać kontrolkę FileUpload do strony ASP.NET](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span></span>

<span data-ttu-id="5e1c4-265">**Ilustracja 12**. Dodawanie kontrolki FileUpload do strony ASP.NET ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>

<span data-ttu-id="5e1c4-266">Na rysunku 13 przedstawiono Tę stronę, gdy oglądasz za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="5e1c4-267">Należy pamiętać, że kliknięcie przycisku Przeglądaj powoduje wyświetlenie okna dialogowego wyboru pliku, umożliwiające użytkownikowi wybranie pliku z komputera.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="5e1c4-268">Po wybraniu pliku kliknij przycisk Przekaż wybrany plik, co spowoduje wysłanie do serwera sieci Web wybranej zawartości binarnej plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>

<span data-ttu-id="5e1c4-269">[![użytkownik może wybrać plik do przekazania z komputera na serwer](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span></span>

<span data-ttu-id="5e1c4-270">**Ilustracja 13**. Użytkownik może wybrać plik do przekazania z komputera na serwer ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>

<span data-ttu-id="5e1c4-271">W przypadku ogłaszania zwrotnego przekazany plik może być zapisany w systemie plików lub jego dane binarne mogą pracować bezpośrednio za pomocą strumienia.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="5e1c4-272">Na potrzeby tego przykładu należy utworzyć folder `~/Brochures` i zapisać w nim przekazany plik.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="5e1c4-273">Zacznij od dodania folderu `Brochures` do lokacji jako podfolderu katalogu głównego.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="5e1c4-274">Następnie Utwórz procedurę obsługi zdarzeń dla zdarzenia `UploadButton` s `Click` i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="5e1c4-275">Formant FileUpload zawiera różne właściwości do pracy z przekazanymi danymi.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="5e1c4-276">Na przykład [właściwość`HasFile`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) wskazuje, czy plik został przekazany przez użytkownika, podczas gdy [Właściwość`FileBytes`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) zapewnia dostęp do przekazanych danych binarnych jako tablicę bajtów.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="5e1c4-277">Procedura obsługi zdarzeń `Click` uruchamia się, upewniając się, że plik został przekazany.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="5e1c4-278">Jeśli plik został przekazany, etykieta pokazuje nazwę przekazanego pliku, jego rozmiar w bajtach i jego typ zawartości.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="5e1c4-279">Aby upewnić się, że użytkownik przekazuje plik, możesz sprawdzić Właściwość `HasFile` i wyświetlić ostrzeżenie, jeśli `False`, lub zamiast tego można użyć [formantu RequiredFieldValidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>

<span data-ttu-id="5e1c4-280">FileUpload s `SaveAs(filePath)` zapisuje przekazany plik do określonej *ścieżki*pliku.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="5e1c4-281">*ścieżka pliku musi* być *ścieżką fizyczną* (`C:\Websites\Brochures\SomeFile.pdf`), a nie *ścieżką* *wirtualną* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="5e1c4-282">[Metoda`Server.MapPath(virtPath)`](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) przyjmuje ścieżkę wirtualną i zwraca odpowiadającą jej ścieżkę fizyczną.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="5e1c4-283">Tutaj ścieżka wirtualna jest `~/Brochures/fileName`, gdzie *filename* jest nazwą przekazanego pliku.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="5e1c4-284">Aby uzyskać więcej informacji na temat ścieżek wirtualnych i fizycznych przy użyciu `Server.MapPath`, zobacz temat [using Server. MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="5e1c4-285">Po zakończeniu procedury obsługi zdarzeń `Click` Poświęć chwilę na przetestowanie strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="5e1c4-286">Kliknij przycisk Przeglądaj i wybierz plik z dysku twardego, a następnie kliknij przycisk Przekaż wybrany plik.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="5e1c4-287">Ogłaszanie zwrotne wyśle zawartość wybranego pliku na serwer sieci Web, co spowoduje wyświetlenie informacji o pliku przed zapisaniem go w folderze `~/Brochures`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="5e1c4-288">Po przekazaniu pliku Wróć do programu Visual Studio i kliknij przycisk Odśwież w Eksplorator rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="5e1c4-289">Powinien zostać wyświetlony plik przekazany w folderze ~/Brochures.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>

<span data-ttu-id="5e1c4-290">[![plik EvolutionValley. jpg został przekazany do serwera sieci Web](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span></span>

<span data-ttu-id="5e1c4-291">**Ilustracja 14**: plik `EvolutionValley.jpg` został przekazany do serwera sieci Web ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](uploading-files-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="5e1c4-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>

![EvolutionValley. jpg zostało zapisane w folderze ~/Brochures](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="5e1c4-293">**Ilustracja 15**. `EvolutionValley.jpg` zostało zapisane w folderze `~/Brochures`</span><span class="sxs-lookup"><span data-stu-id="5e1c4-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>

## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="5e1c4-294">Subtleties z zapisywaniem przekazanych plików w systemie plików</span><span class="sxs-lookup"><span data-stu-id="5e1c4-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="5e1c4-295">Istnieje kilka subtleties, które należy rozwiązać podczas zapisywania przekazywania plików do systemu plików serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="5e1c4-296">Najpierw wystąpił problem z bezpieczeństwem.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-296">First, there s the issue of security.</span></span> <span data-ttu-id="5e1c4-297">Aby zapisać plik w systemie plików, kontekst zabezpieczeń, w którym jest wykonywana strona ASP.NET musi mieć uprawnienia do zapisu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="5e1c4-298">Serwer sieci Web ASP.NET Development działa w kontekście bieżącego konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="5e1c4-299">Jeśli używasz programu Microsoft s Internet Information Services (IIS) jako serwera sieci Web, kontekst zabezpieczeń zależy od wersji usług IIS i jej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="5e1c4-300">Inne wyzwanie związane z zapisywaniem plików w systemie plików są obracane wokół nazw plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="5e1c4-301">Obecnie nasza strona zapisuje wszystkie przekazane pliki do katalogu `~/Brochures` przy użyciu takiej samej nazwy, jak plik na komputerze klienta s.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="5e1c4-302">Jeśli użytkownik przekazuje broszurę o nazwie `Brochure.pdf`, plik zostanie zapisany jako `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="5e1c4-303">Ale co zrobić, jeśli później użytkownik B przekaże inny plik broszury, który ma taką samą nazwę pliku (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="5e1c4-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="5e1c4-304">W przypadku kodu mamy teraz plik A użytkownika zostanie nadpisany przy użyciu przekazywania użytkownika B s.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="5e1c4-305">Istnieje kilka technik rozwiązywania konfliktów nazw plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="5e1c4-306">Jedną z opcji jest Zabroń przekazywania pliku, jeśli istnieje już taki o tej samej nazwie.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="5e1c4-307">W ramach tego podejścia, gdy użytkownik B próbuje przekazać plik o nazwie `Brochure.pdf`, system nie zapisze pliku i zamiast tego wyświetli komunikat informujący użytkownika B o zmianie nazwy pliku i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="5e1c4-308">Innym podejściem jest zapisanie pliku przy użyciu unikatowej nazwy pliku, która może być [globalnie unikatowym identyfikatorem (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) lub wartością z odpowiednich kolumn klucza podstawowego rekordu bazy danych (przy założeniu, że przekazywanie jest skojarzone z określonym wierszem w modelu danych).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="5e1c4-309">W następnym samouczku opisano te opcje bardziej szczegółowo.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="5e1c4-310">Wyzwania związane z bardzo dużą ilością danych binarnych</span><span class="sxs-lookup"><span data-stu-id="5e1c4-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="5e1c4-311">W tych samouczkach przyjęto założenie, że przechwycone dane binarne mają Nieumiarkowany rozmiar.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="5e1c4-312">Praca z bardzo dużą ilością plików danych binarnych, które mają kilka megabajtów lub większa, wprowadza nowe wyzwania, które wykraczają poza zakres tych samouczków.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="5e1c4-313">Na przykład domyślnie ASP.NET będzie odrzucać operacje przekazywania większe niż 4 MB, chociaż można je skonfigurować za pomocą [elementu`<httpRuntime>`](https://msdn.microsoft.com/library/e1f13641.aspx) w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="5e1c4-314">Usługi IIS nakładają także własne ograniczenia rozmiaru przekazywania plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="5e1c4-315">Więcej informacji można znaleźć w temacie [przekazywanie plików przez usługi IIS](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) .</span><span class="sxs-lookup"><span data-stu-id="5e1c4-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="5e1c4-316">Ponadto czas poświęcony na przekazanie dużych plików może przekroczyć wartość domyślną 110 sekund ASP.NET na żądanie.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="5e1c4-317">Występują również problemy z pamięcią i wydajnością, które powstają podczas pracy z dużymi plikami.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="5e1c4-318">Formant FileUpload jest niepraktyczny w przypadku dużych operacji przekazywania plików.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="5e1c4-319">Gdy zawartość pliku jest publikowana na serwerze, użytkownik końcowy musi cierpliwie zaczekać bez potwierdzenia, że ich przekazywanie jest postępu.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="5e1c4-320">To nie jest to problem występujący w przypadku mniejszych plików, które można przekazać w ciągu kilku sekund, ale może to być problem związany z podawaniem większych plików, które mogą upłynąć do przeładowania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="5e1c4-321">Istnieją różne kontrolki przekazywania plików innych firm, które są lepiej dopasowane do obsługi dużych przeciążeń i wielu z tych dostawców zapewniają wskaźniki postępu i menedżerowie przekazywania ActiveX, które stanowią znacznie bardziej dopracowane środowisko użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="5e1c4-322">Jeśli aplikacja musi obsługiwać duże pliki, należy uważnie zbadać wyzwania i znaleźć odpowiednie rozwiązania dla konkretnych potrzeb.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="5e1c4-323">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="5e1c4-323">Summary</span></span>

<span data-ttu-id="5e1c4-324">Kompilowanie aplikacji, która musi przechwycić dane binarne, zawiera szereg wyzwań.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="5e1c4-325">W tym samouczku przedstawiono pierwsze dwa: Decydowanie o miejscu przechowywania danych binarnych i umożliwieniu użytkownikowi przekazywania zawartości binarnej za pomocą strony sieci Web.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="5e1c4-326">W ciągu następnych trzech samouczków zobaczymy, jak skojarzyć przekazane dane z rekordem w bazie danych, a także jak wyświetlać dane binarne obok pól danych tekstowych.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="5e1c4-327">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="5e1c4-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="5e1c4-328">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="5e1c4-328">Further Reading</span></span>

<span data-ttu-id="5e1c4-329">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="5e1c4-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5e1c4-330">Korzystanie z typów danych o dużej wartości</span><span class="sxs-lookup"><span data-stu-id="5e1c4-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="5e1c4-331">Przewodniki Szybki Start dotyczące kontrolek FileUpload</span><span class="sxs-lookup"><span data-stu-id="5e1c4-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="5e1c4-332">Kontrolka serwera ASP.NET 2,0 FileUpload</span><span class="sxs-lookup"><span data-stu-id="5e1c4-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="5e1c4-333">Ciemny bok przekazywania plików</span><span class="sxs-lookup"><span data-stu-id="5e1c4-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="5e1c4-334">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="5e1c4-334">About the Author</span></span>

<span data-ttu-id="5e1c4-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5e1c4-336">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5e1c4-337">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5e1c4-338">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5e1c4-339">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5e1c4-339">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5e1c4-340">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="5e1c4-340">Special Thanks To</span></span>

<span data-ttu-id="5e1c4-341">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-341">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5e1c4-342">Recenzenci liderzy dla tego samouczka to Teresa Murphy i Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="5e1c4-342">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="5e1c4-343">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="5e1c4-343">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5e1c4-344">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-344">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5e1c4-345">[Poprzednie](updating-and-deleting-existing-binary-data-cs.md)
> [dalej](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5e1c4-345">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>
