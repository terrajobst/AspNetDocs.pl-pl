---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Badanie zdarzeń skojarzonych z wstawianiem, aktualizowaniem i usuwaniem (VB) | Microsoft Docs
author: rick-anderson
description: W tym samouczku będziemy analizować dane przy użyciu zdarzeń występujących przed operacją INSERT, Update lub DELETE formantu sieci Web ASP.NET Data. W...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 35edb3cefc6fe23bb56e667c02d10dc7798f730d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633134"
---
# <a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="38ecc-104">Badanie zdarzeń powiązanych ze wstawianiem, aktualizowaniem i usuwaniem (VB)</span><span class="sxs-lookup"><span data-stu-id="38ecc-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>

<span data-ttu-id="38ecc-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="38ecc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="38ecc-106">[Pobierz przykładową aplikację](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) lub [Pobierz plik PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="38ecc-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="38ecc-107">W tym samouczku będziemy analizować dane przy użyciu zdarzeń występujących przed operacją INSERT, Update lub DELETE formantu sieci Web ASP.NET Data.</span><span class="sxs-lookup"><span data-stu-id="38ecc-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="38ecc-108">Zobaczymy również, jak dostosować interfejs edycji, aby zaktualizować podzestaw pól produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="introduction"></a><span data-ttu-id="38ecc-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="38ecc-109">Introduction</span></span>

<span data-ttu-id="38ecc-110">W przypadku korzystania z wbudowanych funkcji wstawiania, edytowania lub usuwania elementów sterujących GridView, DetailsView lub FormView, wiele kroków wykonywanych, gdy użytkownik końcowy ukończy proces dodawania nowego rekordu lub aktualizowania lub usuwania istniejącego rekordu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="38ecc-111">Zgodnie z opisem w [poprzednim samouczku](an-overview-of-inserting-updating-and-deleting-data-vb.md), gdy wiersz jest edytowany w widoku GridView, przycisk Edytuj jest zamieniany na przyciski Update i Cancel i BoundFields się na pola tekstowe.</span><span class="sxs-lookup"><span data-stu-id="38ecc-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="38ecc-112">Po zaktualizowaniu danych przez użytkownika końcowego i kliknięciu przycisku Aktualizuj na stronie ogłaszania zwrotnego wykonywane są następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="38ecc-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="38ecc-113">W widoku GridView są wypełniane `UpdateParameters` elementu ObjectDataSource przy użyciu unikatowych pól identyfikacyjnych rekordu (za pośrednictwem `DataKeyNames` właściwości) wraz z wartościami wprowadzonymi przez użytkownika</span><span class="sxs-lookup"><span data-stu-id="38ecc-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="38ecc-114">Widok GridView wywołuje metodę `Update()` elementu ObjectDataSource, która z kolei wywołuje odpowiednią metodę w obiekcie źródłowym (`ProductsDAL.UpdateProduct`, w naszym poprzednim samouczku)</span><span class="sxs-lookup"><span data-stu-id="38ecc-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="38ecc-115">Dane podstawowe, które zawierają teraz zaktualizowane zmiany, są ponownie powiązane z elementem GridView</span><span class="sxs-lookup"><span data-stu-id="38ecc-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="38ecc-116">W ramach tej sekwencji kroków jest wyzwalana liczba zdarzeń, dzięki czemu możemy utworzyć programy obsługi zdarzeń w celu dodania logiki niestandardowej w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="38ecc-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="38ecc-117">Na przykład przed wykonaniem kroku 1 zdarzenie `RowUpdating` GridView zostanie wyzwolone.</span><span class="sxs-lookup"><span data-stu-id="38ecc-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="38ecc-118">W tym momencie możemy anulować żądanie aktualizacji, jeśli wystąpił błąd sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="38ecc-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="38ecc-119">Po wywołaniu metody `Update()`, zdarzenie `Updating` elementu ObjectDataSource zostanie wyzwolone, co umożliwia dodanie lub dostosowanie wartości któregokolwiek z `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="38ecc-120">Po zakończeniu wykonywania metody obiektu bazowego elementu ObjectDataSource zostanie wywołane zdarzenie `Updated` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="38ecc-121">Program obsługi zdarzeń dla zdarzenia `Updated` może sprawdzić szczegóły operacji aktualizacji, takie jak liczba wierszy, których dotyczył, oraz czy wystąpił wyjątek.</span><span class="sxs-lookup"><span data-stu-id="38ecc-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="38ecc-122">Na koniec po kroku 2 zostanie wyzwolone zdarzenie `RowUpdated` GridView; Procedura obsługi zdarzeń dla tego zdarzenia może sprawdzać dodatkowe informacje o wykonywanej operacji aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="38ecc-123">Rysunek 1 przedstawia ten szereg zdarzeń i kroków podczas aktualizowania widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="38ecc-124">Wzorzec zdarzenia na rysunku 1 nie jest unikatowy do aktualizacji za pomocą widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="38ecc-125">Wstawianie, aktualizowanie lub usuwanie danych z obszaru GridView, DetailsView lub FormView ma taką samą sekwencję zdarzeń poprzedzających i po stronie, dla kontrolki sieci Web danych i elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>

<span data-ttu-id="38ecc-126">[![serię wyzwalania zdarzeń przed i po aktualizacji w przypadku aktualizowania danych w widoku GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="38ecc-127">**Rysunek 1**: szereg zdarzeń przed i po zdarzenia po aktualizacji danych w widoku GridView ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>

<span data-ttu-id="38ecc-128">W tym samouczku sprawdzimy użycie tych zdarzeń, aby zwiększyć wbudowane funkcje wstawiania, aktualizowania i usuwania danych w kontrolkach sieci Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="38ecc-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="38ecc-129">Zobaczymy również, jak dostosować interfejs edycji, aby zaktualizować podzestaw pól produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="38ecc-130">Krok 1: aktualizowanie pól`ProductName`i`UnitPrice`produktu</span><span class="sxs-lookup"><span data-stu-id="38ecc-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="38ecc-131">W interfejsach edycji z poprzedniego samouczka *wszystkie* pola produktu, które nie były tylko do odczytu, musiały zostać uwzględnione.</span><span class="sxs-lookup"><span data-stu-id="38ecc-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="38ecc-132">Jeśli firma Microsoft musiała usunąć pole z `QuantityPerUnit` GridView-aware — podczas aktualizowania danych formant sieci Web danych nie ustawi `QuantityPerUnit` wartości `UpdateParameters` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="38ecc-133">Element ObjectDataSource następnie przekaże wartość `Nothing` do metody `UpdateProduct` Business Logic Layer (LOGIKI biznesowej), która spowodowałaby zmianę kolumny `QuantityPerUnit` edytowanego rekordu bazy danych na wartość `NULL`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="38ecc-134">Analogicznie, jeśli wymagane pole, takie jak `ProductName`, zostanie usunięte z interfejsu edycji, aktualizacja zakończy się niepowodzeniem z powodu "*kolumna" ProductName "nie zezwala na*wyjątek" null ".</span><span class="sxs-lookup"><span data-stu-id="38ecc-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="38ecc-135">Przyczyną takiego zachowania jest fakt, że element ObjectDataSource został skonfigurowany tak, aby wywoływać metodę `UpdateProduct` klasy `ProductsBLL`, która oczekuje parametru wejściowego dla każdego pola produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="38ecc-136">W związku z tym, kolekcja `UpdateParameters` elementu ObjectDataSource zawiera parametr dla każdego parametru wejściowego metody.</span><span class="sxs-lookup"><span data-stu-id="38ecc-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="38ecc-137">Jeśli chcemy udostępnić formant sieci Web danych, który umożliwia użytkownikowi końcowemu aktualizowanie podzestawu pól, należy programowo ustawić brakujące wartości `UpdateParameters` w programie obsługi zdarzeń `Updating` elementu ObjectDataSource lub utworzyć i wywołać metodę LOGIKI biznesowej, która oczekuje tylko podzestawu pól.</span><span class="sxs-lookup"><span data-stu-id="38ecc-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="38ecc-138">Zapoznajmy się z tym ostatnim podejściem.</span><span class="sxs-lookup"><span data-stu-id="38ecc-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="38ecc-139">W celu utworzenia strony, która wyświetla tylko `ProductName` i `UnitPrice` pól w edytowalnym widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="38ecc-140">Ten interfejs edytowania widoku GridView zezwoli użytkownikowi na aktualizowanie dwóch wyświetlanych pól, `ProductName` i `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="38ecc-141">Ponieważ ten interfejs do edycji zawiera tylko podzestaw pól produktu, musimy utworzyć element ObjectDataSource, który używa metody `UpdateProduct` istniejącej i ma programowe wartości pola produkt ustawione programowo w jego `Updating` obsługi zdarzeń lub musimy utworzyć nową metodę LOGIKI biznesowej, która oczekuje tylko podzbioru pól zdefiniowanych w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="38ecc-142">Na potrzeby tego samouczka użyjemy tej ostatniej opcji i utworzysz Przeciążenie metody `UpdateProduct`, która przyjmuje tylko trzy parametry wejściowe: `productName`, `unitPrice`i `productID`:</span><span class="sxs-lookup"><span data-stu-id="38ecc-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="38ecc-143">Podobnie jak oryginalna Metoda `UpdateProduct`, to Przeciążenie rozpoczyna się od sprawdzenia, czy w bazie danych istnieje produkt z określoną `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="38ecc-144">W przeciwnym razie zwraca `False`, wskazując, że żądanie zaktualizowania informacji o produkcie nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="38ecc-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="38ecc-145">W przeciwnym razie Aktualizacja istniejącego rekordu produktu `ProductName` i `UnitPrice` pól odpowiednio i zostanie zatwierdzona przez wywołanie metody `Update()` TableAdapter, przekazując w wystąpieniu `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdapter's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="38ecc-146">Dodanie do naszej klasy `ProductsBLL` jest gotowe do utworzenia uproszczonego interfejsu GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="38ecc-147">Otwórz `DataModificationEvents.aspx` w folderze `EditInsertDelete` i Dodaj widok GridView do strony.</span><span class="sxs-lookup"><span data-stu-id="38ecc-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="38ecc-148">Utwórz nowy element ObjectDataSource i skonfiguruj go tak, aby używał klasy `ProductsBLL` z mapowaniem metody `Select()` do `GetProducts` i `Update()` mapowania metody do `UpdateProduct` przeciążenia, które pobiera tylko `productName`, `unitPrice`i `productID` parametry wejściowe.</span><span class="sxs-lookup"><span data-stu-id="38ecc-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="38ecc-149">Rysunek 2 przedstawia Kreatora tworzenia źródła danych podczas mapowania metody `Update()` elementu ObjectDataSource na nowe Przeciążenie metody `UpdateProduct` klasy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>

<span data-ttu-id="38ecc-150">[![zmapować metody Update () elementu ObjectDataSource na nowe Przeciążenie UpdateProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="38ecc-151">**Rysunek 2**. zamapuj metodę `Update()` elementu ObjectDataSource na nowe `UpdateProduct` Przeciążenie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>

<span data-ttu-id="38ecc-152">Ponieważ w naszym przykładzie początkowo potrzebna jest możliwość edytowania danych, ale nie do wstawiania ani usuwania rekordów, poświęć chwilę, aby jawnie wskazać, że `Insert()` i metody `Delete()` elementu ObjectDataSource nie powinny być mapowane do żadnej z metod klasy `ProductsBLL` przez przechodzenie do kart Wstawianie i usuwanie i wybieranie (brak) z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="38ecc-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>

<span data-ttu-id="38ecc-153">[![wybierz (brak) z listy rozwijanej dla kart Wstawianie i usuwanie](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="38ecc-154">**Rysunek 3**. Wybierz pozycję (brak) z listy rozwijanej dla kart Wstawianie i usuwanie ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>

<span data-ttu-id="38ecc-155">Po ukończeniu tego kreatora zaznacz pole wyboru Włącz edycję w tagu inteligentnym GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="38ecc-156">Po zakończeniu działania Kreatora tworzenia źródła danych i powiązania tego widoku GridView program Visual Studio utworzył składnię deklaratywną dla obu formantów.</span><span class="sxs-lookup"><span data-stu-id="38ecc-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="38ecc-157">Przejdź do widoku źródła, aby sprawdzić deklaratywne znaczniki elementu ObjectDataSource, które pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="38ecc-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="38ecc-158">Ponieważ nie istnieją żadne mapowania dla `Insert()` i metod `Delete()` elementu ObjectDataSource, nie ma `InsertParameters` ani `DeleteParameters` sekcji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="38ecc-159">Ponadto ponieważ metoda `Update()` jest mapowana na Przeciążenie metody `UpdateProduct`, która akceptuje tylko trzy parametry wejściowe, sekcja `UpdateParameters` ma tylko trzy wystąpienia `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="38ecc-160">Zauważ, że właściwość `OldValuesParameterFormatString` elementu ObjectDataSource ma wartość `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="38ecc-161">Ta właściwość jest ustawiana automatycznie przez program Visual Studio w przypadku korzystania z Kreatora konfiguracji źródła danych.</span><span class="sxs-lookup"><span data-stu-id="38ecc-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="38ecc-162">Jednak ponieważ nasze metody LOGIKI biznesowej nie oczekują, że oryginalna wartość `ProductID` do przekazania, usuń przypisanie tej właściwości całkowicie ze składni deklaracyjnej elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="38ecc-163">Jeśli po prostu wyczyścisz wartość właściwości `OldValuesParameterFormatString` z okno Właściwości w widok Projekt, właściwość będzie nadal istnieć w składni deklaracyjnej, ale zostanie ona ustawiona na pusty ciąg.</span><span class="sxs-lookup"><span data-stu-id="38ecc-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="38ecc-164">Usuń właściwość całkowicie ze składni deklaracyjnej lub z okno Właściwości ustaw wartość domyślną, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

<span data-ttu-id="38ecc-165">Chociaż element ObjectDataSource ma tylko `UpdateParameters` dla nazwy produktu, ceny i identyfikatora, Visual Studio dodał element BoundField lub CheckBoxField w widoku GridView dla każdego pola produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>

<span data-ttu-id="38ecc-166">[![GridView zawiera BoundField lub CheckBoxField dla każdego z pól produktu](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="38ecc-167">**Ilustracja 4**. element GridView zawiera BoundField lub CheckBoxField dla każdego z pól produktu ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>

<span data-ttu-id="38ecc-168">Gdy użytkownik końcowy edytuje produkt i klika przycisk Aktualizuj, w widoku GridView są wyliczane pola, które nie są tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="38ecc-169">Następnie ustawia wartość odpowiadającego parametru w kolekcji `UpdateParameters` elementu ObjectDataSource na wartość wprowadzoną przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="38ecc-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="38ecc-170">Jeśli nie ma odpowiedniego parametru, GridView dodaje jeden do kolekcji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="38ecc-171">W związku z tym, jeśli widok GridView zawiera BoundFields i CheckBoxFields dla wszystkich pól produktu, element ObjectDataSource zakończy wywoływanie `UpdateProduct` przeciążenia, które przyjmuje wszystkie te parametry, pomimo faktu, że deklaratywne znaczniki elementu ObjectDataSource określają tylko trzy parametry wejściowe (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="38ecc-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="38ecc-172">Analogicznie, jeśli w widoku GridView istnieje kilka kombinacji pól nieprzeznaczonych tylko do odczytu, które nie odpowiadają parametrom wejściowym przeciążenia `UpdateProduct`, podczas próby zaktualizowania zostanie zgłoszony wyjątek.</span><span class="sxs-lookup"><span data-stu-id="38ecc-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>

<span data-ttu-id="38ecc-173">[![GridView doda parametry do kolekcji UpdateParameters elementu ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="38ecc-174">**Rysunek 5**. widok GridView doda parametry do kolekcji `UpdateParameters` elementu ObjectDataSource ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>

<span data-ttu-id="38ecc-175">Aby upewnić się, że element ObjectDataSource wywołuje Przeciążenie `UpdateProduct`, które przyjmuje tylko nazwę produktu, cenę i identyfikator, musimy ograniczyć widok GridView, aby zawierał pola edytowalne tylko dla `ProductName` i `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="38ecc-176">Można to osiągnąć, usuwając inne BoundFields i CheckBoxFields, ustawiając te inne pola `ReadOnly` właściwość na `True`lub przez kilka kombinacji obu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="38ecc-177">Na potrzeby tego samouczka po prostu usuniemy wszystkie pola GridView, z wyjątkiem `ProductName` i `UnitPrice` BoundFields, po którym znaczniki deklaratywne GridView będą wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="38ecc-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="38ecc-178">Mimo że Przeciążenie `UpdateProduct` oczekuje trzech parametrów wejściowych, mamy tylko dwa BoundFields w naszym widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="38ecc-179">Jest to spowodowane tym, że parametr wejściowy `productID` jest wartością klucza podstawowego i przekazaną przez wartość właściwości `DataKeyNames` edytowanego wiersza.</span><span class="sxs-lookup"><span data-stu-id="38ecc-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="38ecc-180">Nasz widok GridView, wraz z przeciążeniem `UpdateProduct`, umożliwia użytkownikowi edytowanie samej nazwy i ceny produktu bez utraty jakichkolwiek innych pól produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>

<span data-ttu-id="38ecc-181">[![interfejs pozwala edytować tylko nazwę produktu i cenę](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="38ecc-182">**Ilustracja 6**. interfejs pozwala edytować tylko nazwę produktu i cenę ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="38ecc-183">Zgodnie z opisem w poprzednim samouczku ważne jest, aby włączyć stan widoku GridView (zachowanie domyślne).</span><span class="sxs-lookup"><span data-stu-id="38ecc-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="38ecc-184">Jeśli ustawisz właściwość GridView s `EnableViewState` na `false`, zostanie uruchomione ryzyko przypadkowego usunięcia lub edycji rekordów przez współbieżnych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="38ecc-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="38ecc-185">Zobacz [Ostrzeżenie: problem współbieżności z elementem ASP.NET 2,0 gridviews/DetailsView/FormView, który obsługuje edytowanie i/lub usuwanie stanu widoku,](http://scottonwriting.net/sowblog/posts/10054.aspx) Aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="38ecc-186">Ulepszanie formatowania`UnitPrice`</span><span class="sxs-lookup"><span data-stu-id="38ecc-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="38ecc-187">Chociaż przykład GridView przedstawiony na rysunku 6 działa, pole `UnitPrice` nie jest w ogóle formatowane, co powoduje wyświetlenie cennika, który nie ma żadnych symboli walutowych i ma cztery miejsca dziesiętne.</span><span class="sxs-lookup"><span data-stu-id="38ecc-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="38ecc-188">Aby zastosować formatowanie waluty dla nieedytowalnych wierszy, po prostu ustaw właściwość `DataFormatString` `UnitPrice` BoundField na `{0:c}`, a jej Właściwość `HtmlEncode` na `False`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>

<span data-ttu-id="38ecc-189">[![ustawić odpowiednio właściwości DataFormatString i HtmlEncode elementu CenaJednostkowa](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="38ecc-190">**Rysunek 7**: ustaw odpowiednio `DataFormatString` `UnitPrice`i właściwości `HtmlEncode` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>

<span data-ttu-id="38ecc-191">W przypadku tej zmiany wiersze, które nie są edytowalne, są formatowane jako waluta. jednak edytowany wiersz nadal wyświetla wartość bez symbolu waluty i z czterema miejscami dziesiętnymi.</span><span class="sxs-lookup"><span data-stu-id="38ecc-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>

<span data-ttu-id="38ecc-192">[![wiersze, które nie są edytowalne, są teraz sformatowane jako wartości walutowe](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="38ecc-193">**Ilustracja 8**. wiersze, które nie są edytowalne, są teraz sformatowane jako wartości walutowe ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>

<span data-ttu-id="38ecc-194">Instrukcje formatowania określone we właściwości `DataFormatString` mogą być stosowane do interfejsu edycji przez ustawienie właściwości `ApplyFormatInEditMode` BoundField na `True` (wartość domyślna to `False`).</span><span class="sxs-lookup"><span data-stu-id="38ecc-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="38ecc-195">Poświęć chwilę na ustawienie tej właściwości na `True`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-195">Take a moment to set this property to `True`.</span></span>

<span data-ttu-id="38ecc-196">[![ustawić dla właściwości ApplyFormatInEditMode elementu CenaJednostkowa BoundField wartość true](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="38ecc-197">**Rysunek 9**. ustaw właściwość `ApplyFormatInEditMode` `UnitPrice` BoundField na `True` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>

<span data-ttu-id="38ecc-198">W przypadku tej zmiany wartość `UnitPrice` wyświetlana w edytowanym wierszu jest również formatowana jako waluta.</span><span class="sxs-lookup"><span data-stu-id="38ecc-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>

<span data-ttu-id="38ecc-199">[![wartość CenaJednostkowa edytowanego wiersza jest teraz sformatowana jako waluta](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="38ecc-200">**Rysunek 10**: wartość `UnitPrice` edytowanego wiersza jest teraz sformatowana jako waluta (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>

<span data-ttu-id="38ecc-201">Jednak Aktualizacja produktu z symbolem waluty w polu tekstowym, takim jak $19,00 zgłasza `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="38ecc-202">Gdy GridView próbuje przypisać wartości dostarczone przez użytkownika do kolekcji `UpdateParameters` elementu ObjectDataSource, nie można przekonwertować ciągu `UnitPrice` "$19,00" na `Decimal` wymagane przez parametr (patrz rysunek 11).</span><span class="sxs-lookup"><span data-stu-id="38ecc-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="38ecc-203">Aby rozwiązać ten wyjątek, możemy utworzyć procedurę obsługi zdarzeń dla zdarzenia `RowUpdating` GridView i analizować `UnitPrice` dostarczone przez użytkownika jako `Decimal`sformatowane w walucie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="38ecc-204">Zdarzenie `RowUpdating` GridView akceptuje jako drugi parametr obiekt typu [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), który zawiera słownik `NewValues` jako jedną z właściwości, która zawiera wartości dostarczone przez użytkownika, które są gotowe do przypisania do kolekcji `UpdateParameters` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="38ecc-205">Można zastąpić istniejącą wartość `UnitPrice` w kolekcji `NewValues` wartością dziesiętną przeanalizowanej przy użyciu formatu waluty z następującymi wierszami kodu w programie obsługi zdarzeń `RowUpdating`:</span><span class="sxs-lookup"><span data-stu-id="38ecc-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="38ecc-206">Jeśli użytkownik podał wartość `UnitPrice` (taką jak "$19,00"), ta wartość jest zastępowana wartością dziesiętną obliczoną przez [ułamek dziesiętny. Przeanalizuj](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx)analizę wartości jako walutę.</span><span class="sxs-lookup"><span data-stu-id="38ecc-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="38ecc-207">Spowoduje to poprawne przeanalizowanie wartości dziesiętnej w przypadku wszelkich symboli walut, przecinków, cyfr dziesiętnych itd. i użycie [wyliczenia wyliczenia NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) w przestrzeni nazw [System. globalizacji](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="38ecc-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="38ecc-208">Rysunek 11 przedstawia problem spowodowany przez symbole walutowe w `UnitPrice`dostarczone przez użytkownika, a także sposób, w jaki można wykorzystać procedurę obsługi zdarzeń `RowUpdating` GridView, aby prawidłowo przeanalizować takie dane wejściowe.</span><span class="sxs-lookup"><span data-stu-id="38ecc-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>

<span data-ttu-id="38ecc-209">[![wartość CenaJednostkowa edytowanego wiersza jest teraz sformatowana jako waluta](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="38ecc-210">**Rysunek 11**: wartość `UnitPrice` edytowanego wiersza jest teraz sformatowana jako waluta (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>

## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="38ecc-211">Krok 2. Zabroń`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="38ecc-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="38ecc-212">W czasie, gdy baza danych jest skonfigurowana tak, aby zezwalała na `NULL` wartości w kolumnie `UnitPrice` tabeli `Products`, możemy chcieć uniemożliwić użytkownikom odwiedzającym tę konkretną stronę Określanie `NULL` `UnitPrice` wartości.</span><span class="sxs-lookup"><span data-stu-id="38ecc-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="38ecc-213">Oznacza to, że jeśli użytkownik nie będzie mógł wprowadzić wartości `UnitPrice` podczas edytowania wiersza produktu, zamiast zapisywać wyniki w bazie danych, chcemy wyświetlić komunikat informujący użytkownika, że na tej stronie wszystkie edytowane produkty muszą mieć określoną cenę.</span><span class="sxs-lookup"><span data-stu-id="38ecc-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="38ecc-214">Obiekt `GridViewUpdateEventArgs` przeszedł do programu obsługi zdarzeń `RowUpdating` GridView zawiera właściwość `Cancel`, która w przypadku wybrania wartości `True`kończy proces aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="38ecc-215">Rozwińmy procedurę obsługi zdarzeń `RowUpdating`, aby ustawić `e.Cancel` `True` i wyświetlić komunikat wyjaśniający, dlaczego wartość `UnitPrice` w kolekcji `NewValues` ma wartość `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="38ecc-216">Zacznij od dodania kontrolki sieci Web etykieta do strony o nazwie `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="38ecc-217">Ta kontrolka etykiety będzie wyświetlana, jeśli użytkownik nie będzie mógł określić wartości `UnitPrice` podczas aktualizowania produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="38ecc-218">Ustaw właściwość `Text` etykiety na "musisz podać cenę produktu".</span><span class="sxs-lookup"><span data-stu-id="38ecc-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="38ecc-219">Utworzono również nową klasę CSS w `Styles.css` o nazwie `Warning` z następującą definicją:</span><span class="sxs-lookup"><span data-stu-id="38ecc-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>

[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="38ecc-220">Na koniec ustaw właściwość `CssClass` etykiety na `Warning`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="38ecc-221">W tym momencie Projektant powinien pokazać komunikat ostrzegawczy w kolorze czerwonym, pogrubionym, kursywą, o bardzo dużym rozmiarze czcionki powyżej widoku GridView, jak pokazano na rysunku 12.</span><span class="sxs-lookup"><span data-stu-id="38ecc-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>

<span data-ttu-id="38ecc-222">[![dodano etykietę powyżej widoku GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="38ecc-223">**Rysunek 12**. etykieta została dodana powyżej widoku GridView (kliknij,[Aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>

<span data-ttu-id="38ecc-224">Domyślnie etykieta powinna być ukryta, więc ustaw jej Właściwość `Visible` na `False` w programie obsługi zdarzeń `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="38ecc-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="38ecc-225">Jeśli użytkownik spróbuje zaktualizować produkt bez określania `UnitPrice`, chce anulować aktualizację i wyświetlić etykietę ostrzeżenia.</span><span class="sxs-lookup"><span data-stu-id="38ecc-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="38ecc-226">Rozszerzanie programu obsługi zdarzeń `RowUpdating` GridView w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="38ecc-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="38ecc-227">Jeśli użytkownik próbuje zapisać produkt bez określenia ceny, aktualizacja zostanie anulowana i zostanie wyświetlony komunikat pomocny.</span><span class="sxs-lookup"><span data-stu-id="38ecc-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="38ecc-228">Podczas gdy baza danych (i logika biznesowa) zezwala na `NULL` `UnitPrice` s, ta strona ASP.NETa nie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>

<span data-ttu-id="38ecc-229">[![użytkownik nie może opuścić wartości pola CenaJednostkowa](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="38ecc-230">**Ilustracja 13**. użytkownik nie może opuścić `UnitPrice` pustego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>

<span data-ttu-id="38ecc-231">Do tej pory zaobserwowano, jak użyć zdarzenia `RowUpdating` GridView, aby programowo zmienić wartości parametrów przypisanych do kolekcji `UpdateParameters` elementu ObjectDataSource oraz jak całkowicie anulować proces aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="38ecc-232">Te koncepcje przenoszą się do kontrolek DetailsView i FormView, a także stosują się do wstawiania i usuwania.</span><span class="sxs-lookup"><span data-stu-id="38ecc-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="38ecc-233">Te zadania można także wykonać na poziomie elementu ObjectDataSource przy użyciu obsługi zdarzeń dla `Inserting`, `Updating`i `Deleting` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="38ecc-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="38ecc-234">Te zdarzenia są wyzwalane przed wywołaniem skojarzonej metody obiektu bazowego i zapewnienia ostatecznej szansy do zmodyfikowania kolekcji parametrów wejściowych lub anulowania operacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="38ecc-235">Procedury obsługi zdarzeń dla tych trzech zdarzeń są przesyłane do obiektu typu [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) , który ma dwie właściwości zainteresowania:</span><span class="sxs-lookup"><span data-stu-id="38ecc-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="38ecc-236">[Anuluj](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), co spowoduje, że jeśli zostanie ustawiona na `True`, anuluje wykonywane operacje</span><span class="sxs-lookup"><span data-stu-id="38ecc-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="38ecc-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), który jest kolekcją `InsertParameters`, `UpdateParameters`lub `DeleteParameters`, w zależności od tego, czy program obsługi zdarzeń jest przeznaczony dla zdarzenia `Inserting`, `Updating`lub `Deleting`</span><span class="sxs-lookup"><span data-stu-id="38ecc-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="38ecc-238">Aby zilustrować pracę z wartościami parametrów na poziomie elementu ObjectDataSource, na naszej stronie zostanie umieszczony element DetailsView, który umożliwi użytkownikom dodawanie nowego produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="38ecc-239">Ten DetailsView zostanie użyty w celu udostępnienia interfejsu umożliwiającego szybkie dodanie nowego produktu do bazy danych programu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="38ecc-240">Aby zachować spójny interfejs użytkownika podczas dodawania nowego produktu, Zezwól użytkownikowi na wprowadzanie wartości tylko dla `ProductName` i `UnitPrice` pól.</span><span class="sxs-lookup"><span data-stu-id="38ecc-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="38ecc-241">Domyślnie te wartości, które nie są podane w interfejsie wstawiania w widoku DetailsView, zostaną ustawione na wartość `NULL` bazy danych.</span><span class="sxs-lookup"><span data-stu-id="38ecc-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="38ecc-242">Można jednak użyć zdarzenia `Inserting` elementu ObjectDataSource, aby wprowadzić różne wartości domyślne, ponieważ wkrótce zobaczymy.</span><span class="sxs-lookup"><span data-stu-id="38ecc-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="38ecc-243">Krok 3. dostarczenie interfejsu umożliwiającego dodanie nowych produktów</span><span class="sxs-lookup"><span data-stu-id="38ecc-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="38ecc-244">Przeciągnij widok DetailsView z przybornika do projektanta nad GridView, wyczyść `Height` i `Width` właściwości i powiąż go z elementem ObjectDataSource już znajdującym się na stronie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="38ecc-245">Spowoduje to dodanie elementu BoundField lub CheckBoxField dla każdego z pól produktu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="38ecc-246">Ponieważ chcemy używać tego widoku DetailsView do dodawania nowych produktów, musimy sprawdzić opcję Włącz wstawianie z tagu inteligentnego. nie istnieje jednak taka opcja, ponieważ metoda `Insert()` elementu ObjectDataSource nie jest zamapowana na metodę w klasie `ProductsBLL` (odwołując się do ustawienia tego mapowania na (brak) podczas konfigurowania źródła danych, zobacz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="38ecc-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="38ecc-247">Aby skonfigurować element ObjectDataSource, wybierz łącze Konfiguruj źródło danych z taga inteligentnego, uruchamiając Kreatora.</span><span class="sxs-lookup"><span data-stu-id="38ecc-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="38ecc-248">Pierwszy ekran umożliwia zmianę podstawowego obiektu, z którym jest powiązany element ObjectDataSource; Pozostaw wartość ustawioną na `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="38ecc-249">Na następnym ekranie są wyświetlane mapowania z metod elementu ObjectDataSource do obiektu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="38ecc-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="38ecc-250">Mimo że jawnie wskazano, że metody `Insert()` i `Delete()` nie powinny być mapowane do żadnej metody, jeśli przejdziesz do kart Wstawianie i usuwanie zobaczysz, że jest tam mapowanie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="38ecc-251">Wynika to z faktu, że `ProductsBLL``AddProduct` i `DeleteProduct` metody używają atrybutu `DataObjectMethodAttribute`, aby wskazać, że są to domyślne metody odpowiednio dla `Insert()` i `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="38ecc-252">W związku z tym Kreator ObjectDataSource wybiera te za każdym razem, gdy zostanie uruchomiony Kreator, chyba że określono inną wartość.</span><span class="sxs-lookup"><span data-stu-id="38ecc-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="38ecc-253">Pozostaw metodę `Insert()` wskazującą metodę `AddProduct`, ale ponownie ustaw listę rozwijaną karty Usuń na (brak).</span><span class="sxs-lookup"><span data-stu-id="38ecc-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>

<span data-ttu-id="38ecc-254">[![ustawić listę rozwijaną karty Wstaw na metodę addproduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="38ecc-255">**Ilustracja 14**. Ustawianie listy rozwijanej karty Wstaw na metodę `AddProduct` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>

<span data-ttu-id="38ecc-256">[![ustawić listę rozwijaną karty Usuń na (brak)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="38ecc-257">**Ilustracja 15**. Ustaw listę rozwijaną karty Usuń na (brak) ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>

<span data-ttu-id="38ecc-258">Po wprowadzeniu tych zmian składnia deklaracyjnego elementu ObjectDataSource zostanie rozwinięta w celu uwzględnienia kolekcji `InsertParameters`, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="38ecc-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="38ecc-259">Ponowne uruchomienie Kreatora dodało `OldValuesParameterFormatString` właściwości.</span><span class="sxs-lookup"><span data-stu-id="38ecc-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="38ecc-260">Poświęć chwilę na wyczyszczenie tej właściwości, ustawiając ją na wartość domyślną (`{0}`) lub usuwając ją całkowicie ze składni deklaracyjnej.</span><span class="sxs-lookup"><span data-stu-id="38ecc-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="38ecc-261">Za pomocą elementu ObjectDataSource dostarczającego możliwości wstawiania, tag inteligentny DetailsView będzie teraz zawierać pole wyboru Włącz wstawianie; Wróć do projektanta i zaznacz tę opcję.</span><span class="sxs-lookup"><span data-stu-id="38ecc-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="38ecc-262">Następnie dostosowanie w górę widoku DetailsView, aby miał tylko dwa BoundFields-`ProductName` i `UnitPrice`-i CommandField.</span><span class="sxs-lookup"><span data-stu-id="38ecc-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="38ecc-263">W tym momencie składnia deklaratywna DetailsView powinna wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="38ecc-263">At this point the DetailsView's declarative syntax should look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="38ecc-264">Na rysunku 16 przedstawiono Tę stronę w przeglądarce w tym momencie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="38ecc-265">Jak widać, w widoku DetailsView wyświetlana jest nazwa i cena pierwszego produktu (Chai).</span><span class="sxs-lookup"><span data-stu-id="38ecc-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="38ecc-266">Jednak jest to interfejs wstawiania, który umożliwia użytkownikowi szybkie dodawanie nowego produktu do bazy danych programu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>

<span data-ttu-id="38ecc-267">[![DetailsView jest obecnie renderowany w trybie tylko do odczytu](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="38ecc-268">**Ilustracja 16**. widok DetailsView jest obecnie renderowany w trybie tylko do odczytu ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>

<span data-ttu-id="38ecc-269">Aby można było wyświetlić widok DetailsView w jego trybie wstawiania, należy ustawić właściwość `DefaultMode` na `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="38ecc-270">Renderuje to DetailsView w trybie wstawiania podczas pierwszej wizyty i utrzymuje po wstawieniu nowego rekordu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="38ecc-271">Jak pokazano na rysunku 17, taka DetailsView udostępnia szybki interfejs do dodawania nowego rekordu.</span><span class="sxs-lookup"><span data-stu-id="38ecc-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>

<span data-ttu-id="38ecc-272">[![DetailsView udostępnia interfejs umożliwiający szybkie dodanie nowego produktu](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="38ecc-273">**Ilustracja 17**. widok DetailsView udostępnia interfejs umożliwiający szybkie dodanie nowego produktu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>

<span data-ttu-id="38ecc-274">Gdy użytkownik wprowadzi nazwę produktu i cenę (na przykład "wody XYZ" i 1,99, jak na rysunku 17) i klika pozycję Wstaw, ogłaszanie zwrotne zostanie rozpoczęte i rozpocznie się Wstawianie przepływu pracy, culminating w nowym rekordzie produktu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="38ecc-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="38ecc-275">Widok DetailsView zachowuje swój interfejs, a GridView jest automatycznie ponownie powiązane ze źródłem danych w celu uwzględnienia nowego produktu, jak pokazano na rysunku 18.</span><span class="sxs-lookup"><span data-stu-id="38ecc-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>

![Produkt](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="38ecc-277">**Ilustracja 18**. produkt "woda XYZ" została dodana do bazy danych</span><span class="sxs-lookup"><span data-stu-id="38ecc-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>

<span data-ttu-id="38ecc-278">Chociaż widok GridView na rysunku 18 nie pokazuje go, pola produktu, które nie są w interfejsie DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`i tak dalej, są przypisane `NULL` wartości bazy danych.</span><span class="sxs-lookup"><span data-stu-id="38ecc-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="38ecc-279">Można to sprawdzić, wykonując następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="38ecc-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="38ecc-280">Przejdź do Eksplorator serwera w programie Visual Studio</span><span class="sxs-lookup"><span data-stu-id="38ecc-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="38ecc-281">Rozszerzanie węzła bazy danych `NORTHWND.MDF`</span><span class="sxs-lookup"><span data-stu-id="38ecc-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="38ecc-282">Kliknij prawym przyciskiem myszy węzeł tabeli bazy danych `Products`</span><span class="sxs-lookup"><span data-stu-id="38ecc-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="38ecc-283">Wybierz pozycję Pokaż dane tabeli</span><span class="sxs-lookup"><span data-stu-id="38ecc-283">Select Show Table Data</span></span>

<span data-ttu-id="38ecc-284">Spowoduje to wyświetlenie listy wszystkich rekordów w tabeli `Products`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="38ecc-285">Jak pokazano na rysunku 19, wszystkie kolumny nowego produktu inne niż `ProductID`, `ProductName`i `UnitPrice` mają `NULL` wartości.</span><span class="sxs-lookup"><span data-stu-id="38ecc-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>

<span data-ttu-id="38ecc-286">[![pola produktu, które nie zostały podane w widoku DetailsView, są przypisane wartości NULL](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="38ecc-287">**Ilustracja 19**. pola produktu, które nie zostały podane w widoku DetailsView, są przypisane do wartości `NULL` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>

<span data-ttu-id="38ecc-288">Firma Microsoft może chcieć podać wartość domyślną inną niż `NULL` dla co najmniej jednej z tych wartości kolumny, ponieważ `NULL` nie jest najlepszą opcją domyślną lub ponieważ sama kolumna bazy danych nie zezwala na `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="38ecc-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="38ecc-289">Aby to osiągnąć, można programowo ustawić wartości parametrów kolekcji `InputParameters` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="38ecc-290">To przypisanie można wykonać w procedurze obsługi zdarzeń dla zdarzenia `ItemInserting` DetailsView lub zdarzenia `Inserting` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="38ecc-291">Ze względu na to, że już korzystamy z zdarzeń przed i na poziomie na poziomie formantu sieci Web danych, poszukajmy w tym czasie za pomocą zdarzeń elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="38ecc-292">Krok 4. Przypisywanie wartości do`CategoryID`i`SupplierID`parametrów</span><span class="sxs-lookup"><span data-stu-id="38ecc-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="38ecc-293">Na potrzeby tego samouczka Wyobraź sobie, że dla naszej aplikacji podczas dodawania nowego produktu za pomocą tego interfejsu należy przypisać `CategoryID` i `SupplierID` wartość 1.</span><span class="sxs-lookup"><span data-stu-id="38ecc-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="38ecc-294">Jak wspomniano wcześniej, element ObjectDataSource ma parę zdarzeń przed i na poziomie, które są wyzwalane podczas procesu modyfikowania danych.</span><span class="sxs-lookup"><span data-stu-id="38ecc-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="38ecc-295">Po wywołaniu metody `Insert()` element ObjectDataSource najpierw wywołuje swoje zdarzenie `Inserting`, a następnie wywołuje metodę, do której zamapowana została Metoda `Insert()` i na koniec wywołuje zdarzenie `Inserted`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="38ecc-296">Program obsługi zdarzeń `Inserting` zapewnia nam jedną ostatnią szansę na dostosowanie parametrów wejściowych lub anulowanie operacji.</span><span class="sxs-lookup"><span data-stu-id="38ecc-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="38ecc-297">W rzeczywistej aplikacji prawdopodobnie chcesz zezwolić użytkownikowi na określenie kategorii i dostawcy albo wybrać dla nich tę wartość na podstawie niektórych kryteriów lub logiki biznesowej (zamiast odślepej próby wybrania identyfikatora 1).</span><span class="sxs-lookup"><span data-stu-id="38ecc-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="38ecc-298">Niezależnie od tego przykład ilustruje sposób programowo ustawić wartość parametru wejściowego z zdarzenia wstępnego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>

<span data-ttu-id="38ecc-299">Poświęć chwilę, aby utworzyć procedurę obsługi zdarzeń dla zdarzenia `Inserting` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="38ecc-300">Zwróć uwagę, że drugi parametr wejściowy programu obsługi zdarzeń jest obiektem typu `ObjectDataSourceMethodEventArgs`, który ma właściwość do uzyskiwania dostępu do kolekcji parametrów (`InputParameters`) i właściwość, aby anulować operację (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="38ecc-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="38ecc-301">W tym momencie Właściwość `InputParameters` zawiera kolekcję `InsertParameters` elementu ObjectDataSource z wartościami przypisanymi z widoku DetailsView.</span><span class="sxs-lookup"><span data-stu-id="38ecc-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="38ecc-302">Aby zmienić wartość jednego z tych parametrów, wystarczy użyć: `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="38ecc-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="38ecc-303">W związku z tym, aby ustawić `CategoryID` i `SupplierID` na wartości 1, Dostosuj procedurę obsługi zdarzeń `Inserting` w taki sposób, aby wyglądała następująco:</span><span class="sxs-lookup"><span data-stu-id="38ecc-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="38ecc-304">Tym razem, gdy dodajesz nowy produkt (na przykład do wykrycia Acme), `CategoryID` i `SupplierID` kolumny nowego produktu są ustawione na 1 (Zobacz Rysunek 20).</span><span class="sxs-lookup"><span data-stu-id="38ecc-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>

<span data-ttu-id="38ecc-305">[![nowe produkty mają teraz wartości IDKategorii i IDDostawcy ustawione na 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="38ecc-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="38ecc-306">**Ilustracja 20**. nowe produkty mają teraz `CategoryID` i `SupplierID` wartości ustawione na 1 ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="38ecc-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="38ecc-307">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="38ecc-307">Summary</span></span>

<span data-ttu-id="38ecc-308">Podczas edytowania, wstawiania i usuwania, zarówno kontrolka sieci Web danych, jak i element ObjectDataSource postępują przez wiele zdarzeń przed i na poziomie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="38ecc-309">W tym samouczku zbadamy zdarzenia na poziomie wstępnym i pokazano, jak za ich pomocą dostosować parametry wejściowe lub anulować operację modyfikacji danych całkowicie zarówno z poziomu formantu sieci Web danych, jak i z zdarzeń elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="38ecc-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="38ecc-310">W następnym samouczku przedstawiono tworzenie i używanie programów obsługi zdarzeń dla zdarzeń na poziomie.</span><span class="sxs-lookup"><span data-stu-id="38ecc-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="38ecc-311">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="38ecc-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="38ecc-312">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="38ecc-312">About the Author</span></span>

<span data-ttu-id="38ecc-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="38ecc-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="38ecc-314">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="38ecc-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="38ecc-315">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="38ecc-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="38ecc-316">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="38ecc-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="38ecc-317">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="38ecc-317">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="38ecc-318">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="38ecc-318">Special Thanks To</span></span>

<span data-ttu-id="38ecc-319">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="38ecc-319">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="38ecc-320">Recenzenci liderzy dla tego samouczka to Jackie Goor i Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="38ecc-320">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="38ecc-321">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="38ecc-321">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="38ecc-322">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="38ecc-322">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="38ecc-323">[Poprzednie](an-overview-of-inserting-updating-and-deleting-data-vb.md)
> [dalej](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="38ecc-323">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>
