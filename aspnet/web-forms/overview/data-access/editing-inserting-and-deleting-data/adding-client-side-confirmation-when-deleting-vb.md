---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Dodawanie potwierdzenia po stronie klienta podczas usuwania (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W interfejsach, którą utworzyliśmy, do tej pory użytkownik może przypadkowo usunąć dane, klikając przycisk Usuń, gdy są one przeznaczone do kliknij przycisk Edytuj. W tym t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: fc5c99ce6c5da7d004b95462a3338aefbed31b36
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59388715"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="7225a-104">Dodawanie potwierdzenia po stronie klienta podczas usuwania (VB)</span><span class="sxs-lookup"><span data-stu-id="7225a-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="7225a-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7225a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7225a-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) lub [Pobierz plik PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7225a-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="7225a-107">W interfejsach, którą utworzyliśmy, do tej pory użytkownik może przypadkowo usunąć dane, klikając przycisk Usuń, gdy są one przeznaczone do kliknij przycisk Edytuj.</span><span class="sxs-lookup"><span data-stu-id="7225a-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="7225a-108">W tym samouczku dodamy okno dialogowe potwierdzenia po stronie klienta, który pojawia się po kliknięciu przycisku usuwania.</span><span class="sxs-lookup"><span data-stu-id="7225a-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>


## <a name="introduction"></a><span data-ttu-id="7225a-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="7225a-109">Introduction</span></span>

<span data-ttu-id="7225a-110">W ciągu ostatnich kilku samouczków firma ve przedstawiono sposób korzystanie z naszej architektury aplikacji, danych kontrolki sieci Web i kontrolki ObjectDataSource z optymalizacją umożliwia wstawianie, edytowanie i usuwanie możliwości.</span><span class="sxs-lookup"><span data-stu-id="7225a-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="7225a-111">Usuwanie interfejsy możemy ve zbadanie tej pory były składa się z usunięciem przycisku, który kliknięto, powoduje odświeżenie strony i wywołuje s kontrolki ObjectDataSource `Delete()` metody.</span><span class="sxs-lookup"><span data-stu-id="7225a-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="7225a-112">`Delete()` Metoda następnie wywołuje metodę skonfigurowany z warstwy logiki biznesowej, która propaguje wywołania do warstwy dostępu do danych wystawianie rzeczywiste `DELETE` instrukcji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="7225a-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="7225a-113">Podczas tego interfejsu użytkownika umożliwia gości do usuwania rekordów za pomocą kontrolki GridView, DetailsView lub FormView, mu dowolny rodzaj potwierdzenie, gdy użytkownik kliknie przycisk Usuń.</span><span class="sxs-lookup"><span data-stu-id="7225a-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="7225a-114">Jeśli użytkownik przypadkowo kliknie przycisk usuwania, gdy są przeznaczone do kliknij przycisk Edytuj, zamiast tego zostanie usunięty rekord, który one przeznaczone do zaktualizowania.</span><span class="sxs-lookup"><span data-stu-id="7225a-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="7225a-115">Aby temu zapobiec, w tym samouczku dodamy okno dialogowe potwierdzenia po stronie klienta, który pojawia się po kliknięciu przycisku usuwania.</span><span class="sxs-lookup"><span data-stu-id="7225a-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="7225a-116">Kod JavaScript `confirm(string)` funkcja wyświetla własny parametr wejściowy ciągu jako tekst wewnątrz pola modalne okno dialogowe, który jest dostarczany za pomocą dwóch przycisków — OK i anulowania (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="7225a-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="7225a-117">`confirm(string)` Funkcja zwraca wartość logiczną, w zależności od tego, jakie przycisku (`true`, jeśli użytkownik kliknie przycisk OK, a `false` po kliknięciu przycisku Anuluj).</span><span class="sxs-lookup"><span data-stu-id="7225a-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>


![Confirm(string) JavaScript, metoda Wyświetla modalny Messagebox po stronie klienta](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="7225a-119">**Rysunek 1**: Kod JavaScript `confirm(string)` metoda wyświetla komunikat Messagebox modalne, po stronie klienta</span><span class="sxs-lookup"><span data-stu-id="7225a-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>


<span data-ttu-id="7225a-120">Podczas przesyłania formularza, jeśli wartość `false` jest zwracana z obsługi zdarzenia po stronie klienta, a następnie przesyłania formularza zostanie anulowana.</span><span class="sxs-lookup"><span data-stu-id="7225a-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="7225a-121">Dzięki tej funkcji można przygotować Usuń przycisk s po stronie klienta `onclick` programu obsługi zdarzeń, zwróć wartość wywołania `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="7225a-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="7225a-122">Jeśli użytkownik kliknie przycisk Anuluj, `confirm(string)` zwróci wartość false, co powoduje przesłanie formularza anulować.</span><span class="sxs-lookup"><span data-stu-id="7225a-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="7225a-123">Za pomocą nie zwrotu produkt został kliknięty przycisk Usuń, którego nie zostanie usunięty.</span><span class="sxs-lookup"><span data-stu-id="7225a-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="7225a-124">Jeśli jednak użytkownik kliknie przycisk OK w oknie dialogowym potwierdzenia, ogłaszania zwrotnego będzie nadal nieobniżone i produktu zostaną usunięte.</span><span class="sxs-lookup"><span data-stu-id="7225a-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="7225a-125">Zapoznaj się z [s przy użyciu języka JavaScript `confirm()` metodę przesyłania formularza kontrolki](http://www.webreference.com/programming/javascript/confirm/) Aby uzyskać więcej informacji na temat tej techniki.</span><span class="sxs-lookup"><span data-stu-id="7225a-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="7225a-126">Dodanie niezbędnych skryptu po stronie klienta różni się nieco Jeśli za pomocą szablonów niż przy użyciu CommandField.</span><span class="sxs-lookup"><span data-stu-id="7225a-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="7225a-127">W związku z tym w tym samouczku przyjrzymy się przykład FormView i GridView.</span><span class="sxs-lookup"><span data-stu-id="7225a-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="7225a-128">Przy użyciu technik potwierdzenia po stronie klienta, jak w powyższym omówionych w tym samouczku przyjęto założenie, odwiedzają użytkownicy z przeglądarki, które obsługuje języka JavaScript i mają włączoną obsługę języka JavaScript.</span><span class="sxs-lookup"><span data-stu-id="7225a-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="7225a-129">Jeśli nie są jedną z tych założeń są spełnione dla danego użytkownika, klikając przycisk Usuń natychmiast spowoduje odświeżenie strony (nie są wyświetlane messagebox Potwierdź).</span><span class="sxs-lookup"><span data-stu-id="7225a-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>


## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="7225a-130">Krok 1. Tworzenie widoku FormView, który obsługuje usuwania</span><span class="sxs-lookup"><span data-stu-id="7225a-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="7225a-131">Rozpocznij od dodania FormView do `ConfirmationOnDelete.aspx` strony w `EditInsertDelete` folderu, wiążące go do nowego elementu ObjectDataSource, ponownie pobierający informacje o produkcie za pośrednictwem `ProductsBLL` klasy s `GetProducts()` metody.</span><span class="sxs-lookup"><span data-stu-id="7225a-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="7225a-132">Również skonfigurować kontrolki ObjectDataSource tak, aby `ProductsBLL` klasy s `DeleteProduct(productID)` metody jest mapowany na ObjectDataSource s `Delete()` metody; upewnij się, że karty INSERT i UPDATE, listy rozwijane są ustawione na (Brak).</span><span class="sxs-lookup"><span data-stu-id="7225a-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="7225a-133">Koniec sprawdź, czy pole wyboru Włącz stronicowania w tagu inteligentnego s FormView.</span><span class="sxs-lookup"><span data-stu-id="7225a-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="7225a-134">Po wykonaniu tych kroków nowe oznaczeniu deklaracyjnym s ObjectDataSource będzie wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="7225a-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="7225a-135">Jak w naszych przykładach poprzednich, które nie używały optymistycznej współbieżności, Poświęć chwilę na wyczyszczenie ObjectDataSource s `OldValuesParameterFormatString` właściwości.</span><span class="sxs-lookup"><span data-stu-id="7225a-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="7225a-136">Ponieważ powiązano kontrolka ObjectDataSource, który obsługuje tylko usunięcie FormView s `ItemTemplate` oferuje tylko przycisk Usuń, zawiera przyciski New i Update.</span><span class="sxs-lookup"><span data-stu-id="7225a-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="7225a-137">Jednak FormView s oznaczeniu deklaracyjnym, obejmuje zbędny `EditItemTemplate` i `InsertItemTemplate`, który może zostać usunięty.</span><span class="sxs-lookup"><span data-stu-id="7225a-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="7225a-138">Poświęć chwilę, aby dostosować `ItemTemplate` tak oznacza to pokazuje tylko podzbiór produktu pola danych.</span><span class="sxs-lookup"><span data-stu-id="7225a-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="7225a-139">Czy mogę ve skonfigurowane, min, aby wyświetlić nazwę produktu s w `<h3>` nagłówka powyżej jego nazwy dostawcy i kategorii (wraz z przycisku Usuń).</span><span class="sxs-lookup"><span data-stu-id="7225a-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="7225a-140">Za pomocą tych zmian zostały w pełni funkcjonalne strony sieci web, który umożliwia użytkownikowi przełączać się między produktami, co w czasie, z możliwością Usuń produkt, wystarczy kliknąć przycisk Usuń.</span><span class="sxs-lookup"><span data-stu-id="7225a-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="7225a-141">Na rysunku 2 przedstawiono zrzut ekranu: nasz postęp tej pory, podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="7225a-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="7225a-142">[![FormView informacjami na temat jednego produktu](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="7225a-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="7225a-143">**Rysunek 2**: FormView przedstawia informacje o jednym produktu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="7225a-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>


## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="7225a-144">Krok 2. Wywoływanie confirm(string) funkcji z onclick usuń przyciski klienta zdarzeń</span><span class="sxs-lookup"><span data-stu-id="7225a-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="7225a-145">Za pomocą FormView utworzone, ostatnim krokiem jest skonfigurować przycisk Usuń takie że w przypadku jego s kliknięty przez obiekt odwiedzający JavaScript `confirm(string)` wywołaniu funkcji.</span><span class="sxs-lookup"><span data-stu-id="7225a-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="7225a-146">Dodawanie skryptu po stronie klienta do przycisku, element LinkButton lub ImageButton s klienta `onclick` zdarzenia może się odbywać za pośrednictwem `OnClientClick property`, który jest nowym składnikiem programu ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="7225a-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="7225a-147">Ponieważ chcemy wartość `confirm(string)` zwrócona przez funkcję, wystarczy ustawić dla tej właściwości: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="7225a-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="7225a-148">Po tej zmianie składni deklaratywnej s usunąć element LinkButton powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="7225a-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="7225a-149">Wszystkie dostępne tego s jest!</span><span class="sxs-lookup"><span data-stu-id="7225a-149">That s all there is to it!</span></span> <span data-ttu-id="7225a-150">Rysunek 3 przedstawia zrzut ekranu to potwierdzenie w działaniu.</span><span class="sxs-lookup"><span data-stu-id="7225a-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="7225a-151">Kliknięcie przycisku Usuń otwiera okno dialogowe Potwierdź.</span><span class="sxs-lookup"><span data-stu-id="7225a-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="7225a-152">Jeśli użytkownik kliknie przycisk Anuluj, zwrot zostanie anulowane i produktu nie zostanie usunięta.</span><span class="sxs-lookup"><span data-stu-id="7225a-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="7225a-153">Jeśli jednak użytkownik kliknie przycisk OK, nadal zwrotu i ObjectDataSource s `Delete()` metoda jest wywoływana, skutkując usunięciem rekordu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="7225a-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="7225a-154">Ciąg przekazany do `confirm(string)` rozdzielana funkcji języka JavaScript przy użyciu apostrofy (zamiast znaki cudzysłowu).</span><span class="sxs-lookup"><span data-stu-id="7225a-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="7225a-155">W języku JavaScript można ograniczać ciągi przy użyciu dowolnego znaku.</span><span class="sxs-lookup"><span data-stu-id="7225a-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="7225a-156">Możemy użyć apostrofów tutaj, aby ograniczników ciągu przekazany do `confirm(string)` powstanie niejednoznaczności z ogranicznikami umożliwiający `OnClientClick` wartości właściwości.</span><span class="sxs-lookup"><span data-stu-id="7225a-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>


<span data-ttu-id="7225a-157">[![Potwierdzenie jest teraz wyświetlany po kliknięciu przycisku przycisk Usuń](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7225a-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="7225a-158">**Rysunek 3**: Potwierdzenie jest teraz wyświetlany po kliknięciu przycisku przycisk Usuń ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="7225a-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>


## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="7225a-159">Krok 3. Konfigurowanie właściwość OnClientClick przycisk Usuń w CommandField</span><span class="sxs-lookup"><span data-stu-id="7225a-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="7225a-160">Podczas pracy z przycisku, element LinkButton lub ImageButton bezpośrednio w szablonie, okno dialogowe potwierdzenia można skojarzyć z nim, po prostu konfigurując jego `OnClientClick` właściwości zwracają kod JavaScript `confirm(string)` funkcji.</span><span class="sxs-lookup"><span data-stu-id="7225a-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="7225a-161">Jednak CommandField, -, który dodaje pole Usuń przycisków do kontrolki GridView lub DetailsView — nie ma `OnClientClick` właściwość, która może być ustawiona w sposób deklaratywny.</span><span class="sxs-lookup"><span data-stu-id="7225a-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="7225a-162">Zamiast tego należy programowo odwołujemy się przycisk Usuń w odpowiednich s GridView lub DetailsView `DataBound` programu obsługi zdarzeń, a następnie ustaw jego `OnClientClick` istnieje właściwość.</span><span class="sxs-lookup"><span data-stu-id="7225a-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="7225a-163">Podczas ustawiania przycisk Usuń s `OnClientClick` właściwości w odpowiedniej `DataBound` procedura obsługi zdarzeń, mamy dostęp do danych została powiązana z bieżącym rekordem.</span><span class="sxs-lookup"><span data-stu-id="7225a-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="7225a-164">Oznacza to, że teraz możemy rozszerzać komunikat potwierdzający obejmujący szczegółowe informacje dotyczące konkretnego rekordu, takie jak "Czy na pewno chcesz usunąć produkt Chai?"</span><span class="sxs-lookup"><span data-stu-id="7225a-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="7225a-165">Takie dostosowanie może się również w szablonach przy użyciu składni wiązania danych.</span><span class="sxs-lookup"><span data-stu-id="7225a-165">Such customization is also possible in templates using databinding syntax.</span></span>


<span data-ttu-id="7225a-166">Rozwiązaniem jest ustawienie `OnClientClick` właściwość przycisku(-ów) Delete w CommandField s pozwalają na stronie Dodaj GridView.</span><span class="sxs-lookup"><span data-stu-id="7225a-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="7225a-167">Skonfiguruj tego GridView, aby użyć tego samego kontrolka ObjectDataSource, który używa FormView.</span><span class="sxs-lookup"><span data-stu-id="7225a-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="7225a-168">Także ograniczać to s GridView BoundFields obejmujący tylko nazwa s produktu, kategorii i dostawcy.</span><span class="sxs-lookup"><span data-stu-id="7225a-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="7225a-169">Na koniec zaznacz pole wyboru Włącz usuwanie z tagu inteligentnego s GridView.</span><span class="sxs-lookup"><span data-stu-id="7225a-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="7225a-170">Spowoduje to dodanie CommandField s GridView `Columns` kolekcji z jego `ShowDeleteButton` właściwością `true`.</span><span class="sxs-lookup"><span data-stu-id="7225a-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="7225a-171">Po wprowadzeniu tych zmian, znaczników deklaratywne s GridView powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="7225a-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="7225a-172">CommandField zawiera pojedyncze wystąpienie LinkButton usuwania, które są dostępne programowo z GridView s `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7225a-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="7225a-173">Gdy przywoływane, możemy ustawić jej `OnClientClick` właściwość odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="7225a-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="7225a-174">Utwórz procedurę obsługi zdarzeń dla `RowDataBound` zdarzeń, używając następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="7225a-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="7225a-175">Ta procedura obsługi zdarzeń współpracuje z wierszy danych, (te, które będą miały przycisk Usuń) i rozpoczyna się od programowe odwoływanie się do przycisk Usuń.</span><span class="sxs-lookup"><span data-stu-id="7225a-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="7225a-176">Ogólnie rzecz biorąc należy użyć następującego wzorca:</span><span class="sxs-lookup"><span data-stu-id="7225a-176">In general use the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="7225a-177">*Właściwości ButtonType* jest typ używany przez CommandField — przycisk, element LinkButton lub ImageButton przycisku.</span><span class="sxs-lookup"><span data-stu-id="7225a-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="7225a-178">Domyślnie CommandField używa LinkButtons, ale to może być dostosowane za pośrednictwem CommandField s `ButtonType property`.</span><span class="sxs-lookup"><span data-stu-id="7225a-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="7225a-179">*CommandFieldIndex* jest indeksem porządkowym CommandField w ramach GridView s `Columns` kolekcji, natomiast *controlIndex* jest indeksem przycisk Usuń w ramach CommandField s `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="7225a-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="7225a-180">*ControlIndex* wartość zależy od pozycji przycisku s względem innych przycisków w CommandField.</span><span class="sxs-lookup"><span data-stu-id="7225a-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="7225a-181">Na przykład jeśli przycisk tylko wyświetlane w CommandField znajduje się przycisk Usuń, należy użyć indeks 0.</span><span class="sxs-lookup"><span data-stu-id="7225a-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="7225a-182">Jeśli jednak s tam przycisk edycji, który poprzedza przycisk Usuń użyć indeksu 2.</span><span class="sxs-lookup"><span data-stu-id="7225a-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="7225a-183">Przyczyną indeks 2 jest używany jest CommandField przed przycisk Usuń dodaje dwie kontrolki: przycisk Edytuj i LiteralControl tego s używane do dodawania odstępem pomiędzy przyciski edytowania i usuwania.</span><span class="sxs-lookup"><span data-stu-id="7225a-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="7225a-184">W naszym przykładzie określonego CommandField używa LinkButtons i zawiera on pole skrajnie po lewej *commandFieldIndex* 0.</span><span class="sxs-lookup"><span data-stu-id="7225a-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="7225a-185">Ponieważ istnieją inne przyciski, ale przycisk Usuń w CommandField, używamy *controlIndex* 0.</span><span class="sxs-lookup"><span data-stu-id="7225a-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="7225a-186">Po odwołujące się do przycisk Usuń w CommandField, firma Microsoft następnie Pobierz informacje o produkcie powiązane z bieżącego wiersza GridView.</span><span class="sxs-lookup"><span data-stu-id="7225a-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="7225a-187">Na koniec możemy ustawić przycisk Usuń s `OnClientClick` właściwość do odpowiedniego kodu JavaScript, który zawiera nazwę produktu s.</span><span class="sxs-lookup"><span data-stu-id="7225a-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="7225a-188">Ponieważ ciąg JavaScript przekazany do `confirm(string)` funkcji jest rozdzielany, przy użyciu apostrofy możemy przed nimi znak ucieczki wszelkie apostrofy, które są wyświetlane w nazwie produktu s.</span><span class="sxs-lookup"><span data-stu-id="7225a-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="7225a-189">W szczególności wszelkich apostrofy w nazwie produktu s będą miały zmienione znaczenie za pomocą "`\'`".</span><span class="sxs-lookup"><span data-stu-id="7225a-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="7225a-190">Za pomocą tych zmian ukończyć, klikając przycisk Usuń w Wyświetla GridView, okno dialogowe potwierdzenia niestandardowe pole (zobacz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="7225a-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="7225a-191">Jako z messagebox potwierdzenia z FormView, jeśli użytkownik kliknie przycisk Anuluj zwrotu zostało anulowane, zapobiegając w ten sposób usuwania występowaniu.</span><span class="sxs-lookup"><span data-stu-id="7225a-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="7225a-192">Tej techniki można również uzyskać programowy dostęp do przycisk Usuń w CommandField w DetailsView.</span><span class="sxs-lookup"><span data-stu-id="7225a-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="7225a-193">Dla DetailsView, jednak d utworzyć program obsługi zdarzeń dla `DataBound` zdarzenie, ponieważ nie ma DetailsView `RowDataBound` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="7225a-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>


<span data-ttu-id="7225a-194">[![Kliknięcie przycisku Usuń s GridView wyświetlane jest okno dialogowe potwierdzenia niestandardowe](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="7225a-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="7225a-195">**Rysunek 4**: Klikając s GridView przycisk Usuń przedstawia dostosowane okno dialogowe potwierdzenia ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="7225a-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>


## <a name="using-templatefields"></a><span data-ttu-id="7225a-196">Używanie kontrolek TemplateField</span><span class="sxs-lookup"><span data-stu-id="7225a-196">Using TemplateFields</span></span>

<span data-ttu-id="7225a-197">Jedną z wad CommandField jest, że jej przyciski muszą być dostępne za pośrednictwem indeksowania i że wynikowy obiekt musi być rzutowany na typ odpowiedni przycisk (przycisk, element LinkButton lub ImageButton).</span><span class="sxs-lookup"><span data-stu-id="7225a-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="7225a-198">Za pomocą "Magia" i ustaloną typy zaprasza problemy, które nie można odnaleźć aż do czasu.</span><span class="sxs-lookup"><span data-stu-id="7225a-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="7225a-199">Na przykład jeśli użytkownik lub innemu deweloperowi, dodaje nowe przyciski do CommandField w pewnym momencie w przyszłości (np. przycisk Edytuj) lub zmiany `ButtonType` właściwości istniejącego kodu nadal zostanie skompilowana bez błędów, ale odwiedzając stronę może spowodować wyjątek lub nieoczekiwanego zachowania, w zależności od tego, jak został napisany kod, i jakie zmiany zostały wprowadzone.</span><span class="sxs-lookup"><span data-stu-id="7225a-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="7225a-200">Alternatywnym podejściem jest aby przekonwertować s kontrolkami GridView i DetailsView CommandFields kontrolek TemplateField.</span><span class="sxs-lookup"><span data-stu-id="7225a-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="7225a-201">Spowoduje to wygenerowanie TemplateField z `ItemTemplate` zawierający element LinkButton (lub przycisku lub ImageButton) dla każdego przycisku w CommandField.</span><span class="sxs-lookup"><span data-stu-id="7225a-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="7225a-202">Przyciski te `OnClientClick` właściwości można przypisać w sposób deklaratywny, jak firma dostrzegła przy użyciu widoku FormView lub programowo jest możliwy w odpowiedniej `DataBound` obsługi zdarzeń przy użyciu następującego wzorca:</span><span class="sxs-lookup"><span data-stu-id="7225a-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="7225a-203">Gdzie *controlID* jest wartością przycisk s `ID` właściwości.</span><span class="sxs-lookup"><span data-stu-id="7225a-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="7225a-204">Podczas tego wzorca nadal wymaga typu ustaloną rzutowania, jej eliminuje potrzebę indeksowania, umożliwiając układu można zmienić bez spowodowało błąd w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="7225a-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="7225a-205">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="7225a-205">Summary</span></span>

<span data-ttu-id="7225a-206">Kod JavaScript `confirm(string)` funkcji to technika często używane do kontrolowania przepływu pracy przesyłania formularza.</span><span class="sxs-lookup"><span data-stu-id="7225a-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="7225a-207">Po wykonaniu funkcji Wyświetla okno dialogowe modalne, po stronie klienta, która zawiera dwa przyciski o OK i Anuluj.</span><span class="sxs-lookup"><span data-stu-id="7225a-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="7225a-208">Jeśli użytkownik kliknie przycisk OK, `confirm(string)` funkcja zwraca `true`; kliknięcie przycisku Anuluj zwraca `false`.</span><span class="sxs-lookup"><span data-stu-id="7225a-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="7225a-209">Ta funkcja jest sprzężona z zachowanie przeglądarki s, aby anulować przesłanie formularza, jeśli zwraca program obsługi zdarzeń w procesie przesyłania `false`, może służyć do wyświetlania messagebox potwierdzenie podczas usuwania rekordu.</span><span class="sxs-lookup"><span data-stu-id="7225a-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="7225a-210">`confirm(string)` Funkcja może być skojarzony z sieci Web przycisku sterowania s po stronie klienta `onclick` programu obsługi zdarzeń za pomocą formantu s `OnClientClick` właściwości.</span><span class="sxs-lookup"><span data-stu-id="7225a-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="7225a-211">Podczas pracy z przycisk usuwania szablonu — w jednym z szablonów s FormView lub w TemplateField w DetailsView lub GridView - tę właściwość można ustawić deklaratywne lub programowo, zgodnie z widzieliśmy w ramach tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="7225a-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="7225a-212">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="7225a-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7225a-213">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="7225a-213">About the Author</span></span>

<span data-ttu-id="7225a-214">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="7225a-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7225a-215">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="7225a-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7225a-216">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7225a-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7225a-217">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7225a-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7225a-218">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7225a-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7225a-219">[Poprzednie](implementing-optimistic-concurrency-vb.md)
> [dalej](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7225a-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
