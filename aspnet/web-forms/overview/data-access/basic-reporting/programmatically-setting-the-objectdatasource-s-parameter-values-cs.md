---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Programowe Ustawianie wartości parametrów elementu ObjectDataSource (C#) | Microsoft Docs
author: rick-anderson
description: W tym samouczku dowiesz się, jak dodać metodę do naszych DAL i LOGIKI biznesowej, która akceptuje pojedynczy parametr wejściowy i zwraca dane. Przykład ustawi ten parametr...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74602316"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="de2b9-104">Programowe ustawianie wartości parametrów elementu ObjectDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="de2b9-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="de2b9-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="de2b9-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="de2b9-106">[Pobierz przykładową aplikację](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) lub [Pobierz plik PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="de2b9-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="de2b9-107">W tym samouczku dowiesz się, jak dodać metodę do naszych DAL i LOGIKI biznesowej, która akceptuje pojedynczy parametr wejściowy i zwraca dane.</span><span class="sxs-lookup"><span data-stu-id="de2b9-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="de2b9-108">Przykład ustawia ten parametr programowo.</span><span class="sxs-lookup"><span data-stu-id="de2b9-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="de2b9-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="de2b9-109">Introduction</span></span>

<span data-ttu-id="de2b9-110">Jak zostało to opisane w [poprzednim samouczku](declarative-parameters-cs.md), dostępne są różne opcje umożliwiające deklaratywne przekazywanie wartości parametrów do metod elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="de2b9-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="de2b9-111">Jeśli wartość parametru jest zakodowana na stałe, pochodzi z kontrolki sieci Web na stronie lub znajduje się w innym źródle, które jest odczytywane przez źródło danych `Parameter` obiektu, na przykład ta wartość może być powiązana z parametrem wejściowym bez pisania wiersza kodu.</span><span class="sxs-lookup"><span data-stu-id="de2b9-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="de2b9-112">Mogą jednak wystąpić sytuacje, gdy wartość parametru pochodzi z niektórych źródeł, które nie są jeszcze uwzględniane przez jedno z wbudowanych źródeł danych `Parameter` obiektów.</span><span class="sxs-lookup"><span data-stu-id="de2b9-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="de2b9-113">Jeśli nasza witryna obsługuje konta użytkowników, warto ustawić parametr na podstawie identyfikatora użytkownika zalogowanego obecnie.</span><span class="sxs-lookup"><span data-stu-id="de2b9-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="de2b9-114">Może być również konieczne dostosowanie wartości parametru przed wysłaniem go do metody obiektu bazowego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="de2b9-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="de2b9-115">Za każdym razem, gdy metoda `Select` elementu ObjectDataSource jest wywoływana, element ObjectDataSource najpierw wywołuje jego [zdarzenie select](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="de2b9-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="de2b9-116">Metoda obiektu bazowego elementu ObjectDataSource jest następnie wywoływana.</span><span class="sxs-lookup"><span data-stu-id="de2b9-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="de2b9-117">Po zakończeniu tego procesu zostanie wyzwolone [wybrane zdarzenie](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) elementu ObjectDataSource (rysunek 1 ilustruje tę sekwencję zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="de2b9-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="de2b9-118">Wartości parametrów przesłane do metody obiektu bazowego elementu ObjectDataSource można ustawić lub dostosować w programie obsługi zdarzeń dla zdarzenia `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="de2b9-119">[![zaznaczonego elementu ObjectDataSource i wybierz zdarzenia wyzwalane przed i po wywołaniu metody obiektu źródłowego](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="de2b9-120">**Rysunek 1**: `Selected` i zdarzenia `Selecting` elementu ObjectDataSource przed wywołaniem i po wywołaniu metody obiektu źródłowego ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="de2b9-121">W tym samouczku dowiesz się, jak dodać metodę do naszych DAL i LOGIKI biznesowej, która akceptuje pojedynczy parametr wejściowy `Month`typu `int` i zwraca obiekt `EmployeesDataTable` wypełniony tym pracownikom, którzy mają rocznicę zatrudniania w określonym `Month`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="de2b9-122">Nasz przykład skonfiguruje ten parametr programowo na podstawie bieżącego miesiąca, pokazując listę "rocznice pracowników w tym miesiącu".</span><span class="sxs-lookup"><span data-stu-id="de2b9-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="de2b9-123">Zacznijmy!</span><span class="sxs-lookup"><span data-stu-id="de2b9-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="de2b9-124">Krok 1. Dodawanie metody do`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="de2b9-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="de2b9-125">Aby skorzystać z pierwszego przykładu, należy dodać metodę w celu pobrania tych pracowników, których `HireDate` wystąpiły w określonym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="de2b9-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="de2b9-126">Aby zapewnić tę funkcjonalność zgodnie z naszą architekturą, musimy najpierw utworzyć metodę w `EmployeesTableAdapter`, która mapuje do właściwej instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="de2b9-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="de2b9-127">Aby to osiągnąć, Zacznij od otworzenia zestawu danych Northwind.</span><span class="sxs-lookup"><span data-stu-id="de2b9-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="de2b9-128">Kliknij prawym przyciskiem myszy etykietę `EmployeesTableAdapter` i wybierz polecenie Dodaj zapytanie.</span><span class="sxs-lookup"><span data-stu-id="de2b9-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="de2b9-129">[![dodać nowego zapytania do EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="de2b9-130">**Rysunek 2**. Dodawanie nowego zapytania do `EmployeesTableAdapter` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="de2b9-131">Wybierz, aby dodać instrukcję SQL zwracającą wiersze.</span><span class="sxs-lookup"><span data-stu-id="de2b9-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="de2b9-132">Gdy zostanie osiągnięty ekran "Określanie `SELECT` instrukcji", domyślna instrukcja `SELECT` dla `EmployeesTableAdapter` zostanie już załadowana.</span><span class="sxs-lookup"><span data-stu-id="de2b9-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="de2b9-133">Po prostu Dodaj w klauzuli `WHERE`: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="de2b9-134">[DatePart](https://msdn.microsoft.com/library/ms174420.aspx) jest funkcją T-SQL, która zwraca określoną część daty typu `datetime`; w tym przypadku używamy `DATEPART`, aby zwrócić miesiąc `HireDate`j kolumny.</span><span class="sxs-lookup"><span data-stu-id="de2b9-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="de2b9-135">[![zwracać tylko wiersze, w których kolumna HireDate jest mniejsza lub równa parametrowi @HiredBeforeDate](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="de2b9-136">**Rysunek 3**. Zwracanie tylko tych wierszy, w których kolumna `HireDate` jest mniejsza lub równa parametrowi `@HiredBeforeDate` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="de2b9-137">Na koniec Zmień nazwy metod `FillBy` i `GetDataBy` na odpowiednio `FillByHiredDateMonth` i `GetEmployeesByHiredDateMonth`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="de2b9-138">[![wybrać bardziej odpowiednie nazwy metod niż FillBy i GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="de2b9-139">**Ilustracja 4**. Wybieranie bardziej odpowiednich nazw metod niż `FillBy` i `GetDataBy` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="de2b9-140">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora i powrócić do powierzchni projektowej zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="de2b9-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="de2b9-141">`EmployeesTableAdapter` powinien teraz zawierać nowy zestaw metod do uzyskiwania dostępu do pracowników zatrudnionych w określonym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="de2b9-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="de2b9-142">[![nowe metody są wyświetlane w Powierzchnia projektowa zestawu danych](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="de2b9-143">**Rysunek 5**. nowe metody są wyświetlane w powierzchnia projektowa zestawu danych ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="de2b9-144">Krok 2. Dodawanie metody`GetEmployeesByHiredDateMonth(month)`do warstwy logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="de2b9-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="de2b9-145">Ponieważ nasza architektura aplikacji korzysta z oddzielnej warstwy dla logiki biznesowej i logiki dostępu do danych, musimy dodać metodę do LOGIKI biznesowej, która wywołuje DAL, aby pobrać pracowników zatrudnionych przed określoną datą.</span><span class="sxs-lookup"><span data-stu-id="de2b9-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="de2b9-146">Otwórz plik `EmployeesBLL.cs` i Dodaj następującą metodę:</span><span class="sxs-lookup"><span data-stu-id="de2b9-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="de2b9-147">Podobnie jak w przypadku innych metod w tej klasie, `GetEmployeesByHiredDateMonth(month)` po prostu wywołuje do DAL i zwraca wyniki.</span><span class="sxs-lookup"><span data-stu-id="de2b9-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="de2b9-148">Krok 3. Wyświetlanie pracowników, których rocznica zatrudnienia jest w tym miesiącu</span><span class="sxs-lookup"><span data-stu-id="de2b9-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="de2b9-149">Ostatnim krokiem tego przykładu jest wyświetlenie pracowników, których rocznica zatrudnienia jest w tym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="de2b9-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="de2b9-150">Zacznij od dodania widoku GridView do strony `ProgrammaticParams.aspx` w folderze `BasicReporting` i dodania nowego elementu ObjectDataSource jako źródła danych.</span><span class="sxs-lookup"><span data-stu-id="de2b9-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="de2b9-151">Skonfiguruj element ObjectDataSource, aby używał klasy `EmployeesBLL` z `SelectMethod` ustawionym na `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="de2b9-152">[![użyć klasy EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="de2b9-153">**Ilustracja 6**. użyj klasy `EmployeesBLL` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="de2b9-154">[![wybierać z metody GetEmployeesByHiredDateMonth (miesiąc)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="de2b9-155">**Rysunek 7**: wybór z metody `GetEmployeesByHiredDateMonth(month)` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="de2b9-156">Na ostatnim ekranie poprosimy nas o podanie wartości parametru `month`.</span><span class="sxs-lookup"><span data-stu-id="de2b9-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="de2b9-157">Ponieważ ustawimy tę wartość programowo, pozostaw opcję Źródło parametru ustawioną Domyślnie none i kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="de2b9-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="de2b9-158">[![pozostawić Źródło parametru jako None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="de2b9-159">**Ilustracja 8**. Pozostaw Źródło parametru ustawione na None ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="de2b9-160">Spowoduje to utworzenie obiektu `Parameter` w kolekcji `SelectParameters` elementu ObjectDataSource, która nie ma określonej wartości.</span><span class="sxs-lookup"><span data-stu-id="de2b9-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="de2b9-161">Aby programowo ustawić tę wartość, musimy utworzyć procedurę obsługi zdarzeń dla zdarzenia `Selecting` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="de2b9-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="de2b9-162">Aby to osiągnąć, przejdź do widok Projekt i kliknij dwukrotnie element ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="de2b9-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="de2b9-163">Alternatywnie wybierz element ObjectDataSource, przejdź do okno Właściwości, a następnie kliknij ikonę błyskawicy.</span><span class="sxs-lookup"><span data-stu-id="de2b9-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="de2b9-164">Następnie kliknij dwukrotnie pole tekstowe obok zdarzenia `Selecting` lub wpisz nazwę programu obsługi zdarzeń, którego chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="de2b9-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![Kliknij ikonę pioruna w oknie właściwości, aby wyświetlić listę zdarzeń kontrolki sieci Web](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="de2b9-166">**Ilustracja 9**. Kliknij ikonę pioruna w oknie właściwości, aby wyświetlić listę zdarzeń kontrolki sieci Web</span><span class="sxs-lookup"><span data-stu-id="de2b9-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="de2b9-167">Oba podejścia umożliwiają dodanie nowego programu obsługi zdarzeń dla zdarzenia `Selecting` elementu ObjectDataSource do klasy powiązanej z kodem strony.</span><span class="sxs-lookup"><span data-stu-id="de2b9-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="de2b9-168">W tym obsłudze zdarzeń możemy odczytywać i zapisywać wartości parametrów przy użyciu `e.InputParameters[parameterName]`, gdzie *`parameterName`* jest wartością atrybutu `Name` w tagu `<asp:Parameter>` (kolekcja `InputParameters` może być również indeksowana w `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="de2b9-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="de2b9-169">Aby ustawić parametr `month` na bieżący miesiąc, Dodaj następujący kod do programu obsługi zdarzeń `Selecting`:</span><span class="sxs-lookup"><span data-stu-id="de2b9-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="de2b9-170">Podczas odwiedzania tej strony za pośrednictwem przeglądarki można zobaczyć, że tylko jeden pracownik został zatrudniony w tym miesiącu (marzec) Laura Callahan, który jest członkiem firmy od 1994.</span><span class="sxs-lookup"><span data-stu-id="de2b9-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="de2b9-171">[![tym pracownikom, których rocznice w tym miesiącu są wyświetlane](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="de2b9-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="de2b9-172">**Rysunek 10**. pracownicy, których rocznice w tym miesiącu są pokazywane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="de2b9-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="de2b9-173">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="de2b9-173">Summary</span></span>

<span data-ttu-id="de2b9-174">Chociaż wartości parametrów elementu ObjectDataSource mogą być zazwyczaj ustawiane w sposób deklaratywny, bez konieczności korzystania z wiersza kodu, można łatwo ustawiać wartości parametrów programowo.</span><span class="sxs-lookup"><span data-stu-id="de2b9-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="de2b9-175">Wystarczy utworzyć procedurę obsługi zdarzeń dla zdarzenia `Selecting` elementu ObjectDataSource, które zostanie wyzwolone przed wywołaniem metody obiektu źródłowego, i ręcznie ustawić wartości dla jednego lub kilku parametrów za pośrednictwem `InputParameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="de2b9-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="de2b9-176">Ten samouczek zawiera podstawową sekcję raportowania.</span><span class="sxs-lookup"><span data-stu-id="de2b9-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="de2b9-177">W [następnym samouczku](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) znajdują się sekcje filtrowanie i szczegółowe informacje o scenariuszach, w których zawarto informacje o metodach umożliwiających odwiedzającemu odfiltrowanie danych i przechodzenie do szczegółów raportu głównego.</span><span class="sxs-lookup"><span data-stu-id="de2b9-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="de2b9-178">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="de2b9-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="de2b9-179">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="de2b9-179">About the Author</span></span>

<span data-ttu-id="de2b9-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="de2b9-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="de2b9-181">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="de2b9-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="de2b9-182">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="de2b9-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="de2b9-183">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="de2b9-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="de2b9-184">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="de2b9-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="de2b9-185">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="de2b9-185">Special Thanks To</span></span>

<span data-ttu-id="de2b9-186">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="de2b9-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="de2b9-187">Recenzent potencjalnych klientów dla tego samouczka został Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="de2b9-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="de2b9-188">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="de2b9-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="de2b9-189">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="de2b9-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="de2b9-190">[Poprzednie](declarative-parameters-cs.md)
> [dalej](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="de2b9-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
