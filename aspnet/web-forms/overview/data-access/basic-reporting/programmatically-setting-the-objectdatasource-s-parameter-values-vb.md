---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: Programowe Ustawianie wartości parametrów elementu ObjectDataSource (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku Zapoznamy się dodanie metody do naszych DAL i LOGIKI, która przyjmuje jeden parametr wejściowy i zwraca dane. Ten parametr zostanie ustawiony przykład...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: f823d1db7f98dcbbef12d20df4a28e39fae0ac26
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57077366"
---
<a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="5c687-104">Programowe ustawianie wartości parametrów elementu ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="5c687-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>
====================
<span data-ttu-id="5c687-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5c687-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5c687-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) lub [Pobierz plik PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5c687-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="5c687-107">W tym samouczku Zapoznamy się dodanie metody do naszych DAL i LOGIKI, która przyjmuje jeden parametr wejściowy i zwraca dane.</span><span class="sxs-lookup"><span data-stu-id="5c687-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="5c687-108">Przykład będzie programowo ustawić ten parametr.</span><span class="sxs-lookup"><span data-stu-id="5c687-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="5c687-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="5c687-109">Introduction</span></span>

<span data-ttu-id="5c687-110">Jak widzieliśmy w [poprzedniego samouczka](declarative-parameters-vb.md), dla deklaratywne przekazywania wartości parametrów do metod ObjectDataSource dostępnych kilka opcji.</span><span class="sxs-lookup"><span data-stu-id="5c687-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="5c687-111">Jeśli wartość tego parametru jest ustalony, pochodzi z formantu sieci Web, na stronie lub znajduje się w innych źródeł, który odczyta przez źródło danych `Parameter` obiektu, na przykład, że wartość może być powiązana z parametru wejściowego, bez konieczności pisania nawet wiersza kodu.</span><span class="sxs-lookup"><span data-stu-id="5c687-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="5c687-112">Może to być sytuacji, gdy wartość parametru pochodzi z niektóre źródła nie jest już uwzględniony przez jedno źródło danych wbudowane `Parameter` obiektów.</span><span class="sxs-lookup"><span data-stu-id="5c687-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="5c687-113">Jeśli naszą witrynę obsługiwane konta użytkowników mogą chcemy ustawić parametr oparte na aktualnie zalogowanego użytkownika identyfikatora użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5c687-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="5c687-114">Lub firma Microsoft może być konieczne dostosowanie wartość parametru przed wysłaniem ich wzdłuż do obiektu źródłowego kontrolki ObjectDataSource metody.</span><span class="sxs-lookup"><span data-stu-id="5c687-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="5c687-115">Zawsze, gdy ObjectDataSource `Select` wywoływana jest metoda kontrolki ObjectDataSource najpierw wywołuje jego [wybranie event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c687-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="5c687-116">Następnie wywoływana jest metoda ObjectDataSource obiektu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="5c687-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="5c687-117">Gdy służący do ukończenia ObjectDataSource [wybrane zdarzenia](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) uruchamiany (rysunek 1 przedstawia następująca sekwencja zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="5c687-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="5c687-118">Wartości parametrów przekazywany do metody obiektu źródłowego kontrolki ObjectDataSource można ustawić lub dostosować w obsłudze zdarzeń dla `Selecting` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5c687-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="5c687-119">[![Wybrane ObjectDataSource i wybierając Fire zdarzenia przed i po jego podstawowego obiektu — metoda jest wywoływana.](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="5c687-120">**Rysunek 1**: ObjectDataSource `Selected` i `Selecting` wywoływana jest metoda zdarzenia Fire przed i po jego podstawowego obiektu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>


<span data-ttu-id="5c687-121">W tym samouczku Zapoznamy się dodanie metody do naszych DAL i LOGIKI, która przyjmuje jeden parametr wejściowy `Month`, typu `Integer` i zwraca `EmployeesDataTable` obiektu wypełniane przy użyciu tych pracowników, które mają ich rocznicy zatrudniania w określonym `Month`.</span><span class="sxs-lookup"><span data-stu-id="5c687-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="5c687-122">Nasz przykład ustawi tego parametru, programowo na podstawie bieżącego miesiąca pokazanie listy "Rocznice pracowników, w tym miesiącu."</span><span class="sxs-lookup"><span data-stu-id="5c687-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="5c687-123">Zaczynajmy!</span><span class="sxs-lookup"><span data-stu-id="5c687-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="5c687-124">Krok 1. Dodawanie metody do`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="5c687-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="5c687-125">W tym przykładzie pierwsze musimy dodać oznacza, że można pobrać pracowników, których `HireDate` wystąpił w określonym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="5c687-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="5c687-126">Do tej funkcji, zgodnie z naszej architektury, musimy najpierw utworzyć metody w `EmployeesTableAdapter` która jest mapowana do właściwego instrukcji SQL.</span><span class="sxs-lookup"><span data-stu-id="5c687-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="5c687-127">W tym celu należy uruchomić, otwierając zestaw Northwind wpisanych danych.</span><span class="sxs-lookup"><span data-stu-id="5c687-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="5c687-128">Kliknij prawym przyciskiem myszy `EmployeesTableAdapter` etykiety, a następnie wybierz polecenie Dodaj zapytanie.</span><span class="sxs-lookup"><span data-stu-id="5c687-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="5c687-129">[![Dodaj nowe zapytanie do EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="5c687-130">**Rysunek 2**: Dodaj nowe zapytanie w celu `EmployeesTableAdapter` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>


<span data-ttu-id="5c687-131">Wybierz dodać instrukcję SQL, która zwraca wiersze.</span><span class="sxs-lookup"><span data-stu-id="5c687-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="5c687-132">Po przejściu określ `SELECT` instrukcji ekran domyślny `SELECT` poufności informacji dotyczące `EmployeesTableAdapter` już zostanie załadowany.</span><span class="sxs-lookup"><span data-stu-id="5c687-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="5c687-133">Po prostu Dodaj w `WHERE` klauzuli: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="5c687-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="5c687-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) jest funkcją języka T-SQL, która zwraca określoną datę część `datetime` typu; w tym przypadku używamy `DATEPART` do zwrócenia w miesiącu `HireDate` kolumny.</span><span class="sxs-lookup"><span data-stu-id="5c687-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="5c687-135">[![Zwracany tylko te wiersze gdzie rekrutacji kolumna jest mniejsza niż lub równa @HiredBeforeDate parametru](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="5c687-136">**Rysunek 3**: Zwraca tylko te wiersze, dla których `HireDate` kolumna jest mniejsza niż lub równa `@HiredBeforeDate` parametru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>


<span data-ttu-id="5c687-137">Na koniec zmień `FillBy` i `GetDataBy` nazwy metody `FillByHiredDateMonth` i `GetEmployeesByHiredDateMonth`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="5c687-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="5c687-138">[![Wybierz bardziej odpowiednie nazwy metod niż FillBy i GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="5c687-139">**Rysunek 4**: Wybierz bardziej odpowiednie metody nazw niż `FillBy` i `GetDataBy` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>


<span data-ttu-id="5c687-140">Kliknij przycisk Zakończ, aby zakończyć pracę kreatora i powrócić do powierzchni projektowej typizowanego zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="5c687-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="5c687-141">`EmployeesTableAdapter` Powinny znajdować się teraz nowy zestaw metod dostępu do pracowników zatrudnionych w określonym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="5c687-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="5c687-142">[![Nowe metody są wyświetlane w powierzchni projektowej typizowanego zestawu danych](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="5c687-143">**Rysunek 5**: Nowe metody są wyświetlane w powierzchni projektowej typizowanego zestawu danych ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="5c687-144">Krok 2. Dodawanie`GetEmployeesByHiredDateMonth(month)`metody warstwy logiki biznesowej</span><span class="sxs-lookup"><span data-stu-id="5c687-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="5c687-145">Ponieważ naszej aplikacji architektura używa oddzielnego warstwy logiki biznesowej i danych uzyskać dostęp do logiki, musimy dodać metodę do naszych LOGIKI, która wywołania do warstwy DAL do pobrania pracowników zatrudnionych przed upływem określonego terminu.</span><span class="sxs-lookup"><span data-stu-id="5c687-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="5c687-146">Otwórz `EmployeesBLL.vb` pliku i dodaj następującą metodę:</span><span class="sxs-lookup"><span data-stu-id="5c687-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="5c687-147">Podobnie jak w przypadku naszych innych metod, w tej klasie `GetEmployeesByHiredDateMonth(month)` po prostu wywołuje widok w dół do warstwy DAL i zwraca wyniki.</span><span class="sxs-lookup"><span data-stu-id="5c687-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="5c687-148">Krok 3. Wyświetlanie pracowników, których rocznicy zatrudniania w tym miesiącu</span><span class="sxs-lookup"><span data-stu-id="5c687-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="5c687-149">Ostatnią czynnością, w tym przykładzie jest do wyświetlenia tych pracowników, których rocznicy zatrudniania w tym miesiącu.</span><span class="sxs-lookup"><span data-stu-id="5c687-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="5c687-150">Rozpocznij od dodania GridView do `ProgrammaticParams.aspx` stronie `BasicReporting` folder i dodać nowe kontrolki ObjectDataSource jako źródło danych.</span><span class="sxs-lookup"><span data-stu-id="5c687-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="5c687-151">Konfigurowanie kontrolki ObjectDataSource używać `EmployeesBLL` klasy `SelectMethod` równa `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="5c687-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="5c687-152">[![Korzystanie z klasy EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="5c687-153">**Rysunek 6**: Użyj `EmployeesBLL` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>


<span data-ttu-id="5c687-154">[![Wybierz z GetEmployeesByHiredDateMonth(month) — metoda](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="5c687-155">**Rysunek 7**: Wybierz z `GetEmployeesByHiredDateMonth(month)` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>


<span data-ttu-id="5c687-156">Ekran końcowy prosi nam zapewnić `month` źródła wartości parametru.</span><span class="sxs-lookup"><span data-stu-id="5c687-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="5c687-157">Ponieważ firma Microsoft będzie programowo ustawić tę wartość, pozostaw źródło parametru ustawionej na wartość domyślna Brak opcję i kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="5c687-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="5c687-158">[![Pozostaw Parametr źródłowy zestaw None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="5c687-159">**Rysunek 8**: Pozostaw Parametr źródłowy zestaw None ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>


<span data-ttu-id="5c687-160">Spowoduje to utworzenie `Parameter` obiektu w ObjectDataSource `SelectParameters` kolekcji, które nie mają określonej wartości.</span><span class="sxs-lookup"><span data-stu-id="5c687-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="5c687-161">Aby programowo ustawić tę wartość, należy utworzyć procedurę obsługi zdarzeń dla elementu ObjectDataSource `Selecting` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="5c687-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="5c687-162">Aby to zrobić, przejdź do widoku projektu, a następnie kliknij dwukrotnie ikonę kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="5c687-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="5c687-163">Alternatywnie zaznacz kontrolki ObjectDataSource, przejdź do okna właściwości i kliknij ikonę pioruna.</span><span class="sxs-lookup"><span data-stu-id="5c687-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="5c687-164">Następnie albo kliknij dwukrotnie pole tekstowe obok `Selecting` zdarzenia lub wpisz nazwę programu obsługi zdarzeń, którego chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="5c687-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="5c687-165">Trzecią możliwością, można utworzyć programu obsługi zdarzeń, wybierając kontrolki ObjectDataSource i jego `Selecting` zdarzenie z dwóch list rozwijanych w górnej części strony osobna klasa kodu.</span><span class="sxs-lookup"><span data-stu-id="5c687-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>


![Kliknij ikonę pioruna w oknie dialogowym właściwości, aby wyświetlić listę zdarzeń formantu sieci Web](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="5c687-167">**Rysunek 9**: Kliknij ikonę pioruna w oknie dialogowym właściwości, aby wyświetlić listę zdarzeń formantu sieci Web</span><span class="sxs-lookup"><span data-stu-id="5c687-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="5c687-168">Wszystkie trzy metody dodać nowy program obsługi zdarzeń dla ObjectDataSource `Selecting` zdarzeń do klasy CodeBehind strony.</span><span class="sxs-lookup"><span data-stu-id="5c687-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="5c687-169">Ta procedura obsługi zdarzeń firma Microsoft odczytu i zapisu wartości parametru za pomocą `e.InputParameters(parameterName)`, gdzie *`parameterName`* jest wartością `Name` atrybutu w `<asp:Parameter>` tag ( `InputParameters` kolekcji może być również indeksowane ordinally, podobnie jak w `e.InputParameters(index)`).</span><span class="sxs-lookup"><span data-stu-id="5c687-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="5c687-170">Aby ustawić `month` parametr do bieżącego miesiąca, Dodaj następujący kod do `Selecting` program obsługi zdarzeń:</span><span class="sxs-lookup"><span data-stu-id="5c687-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="5c687-171">Gdy użytkownik odwiedzi tę stronę za pośrednictwem przeglądarki widać tylko jednego pracownika został zatrudniony (marca) w tym miesiącu Kowalski Laura, kto pracuje w firmie od 1994 r.</span><span class="sxs-lookup"><span data-stu-id="5c687-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="5c687-172">[![Pracowników, u którego Rocznice są wyświetlane w tym miesiącu](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="5c687-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="5c687-173">**Na rysunku nr 10**: Tych pracowników Whose rocznice ten miesiąc są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="5c687-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="5c687-174">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="5c687-174">Summary</span></span>

<span data-ttu-id="5c687-175">Podczas gdy wartości parametrów elementu ObjectDataSource można zwykle ustawić deklaratywne, bez konieczności wiersz kodu, jest łatwe programowe Ustawianie wartości parametrów.</span><span class="sxs-lookup"><span data-stu-id="5c687-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="5c687-176">Musimy wystarczy utworzyć program obsługi zdarzeń dla elementu ObjectDataSource `Selecting` zdarzenie, które jest uruchamiany przed wywołana metoda obiektu źródłowego i ręcznie ustawić wartości dla jednego lub więcej parametrów za pomocą `InputParameters` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="5c687-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="5c687-177">W tym samouczku kończy się w sekcji podstawowe raportowanie.</span><span class="sxs-lookup"><span data-stu-id="5c687-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="5c687-178">[Następnego samouczka](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) dotyczącego sekcji Filtrowanie i głównych scenariuszy, w którym utworzymy Przyjrzyj się techniki umożliwiające obiektu odwiedzającego, aby filtrować dane i przejść do szczegółów z głównego raportu do raportu szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="5c687-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="5c687-179">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="5c687-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5c687-180">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="5c687-180">About the Author</span></span>

<span data-ttu-id="5c687-181">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="5c687-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5c687-182">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="5c687-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5c687-183">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5c687-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5c687-184">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5c687-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5c687-185">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5c687-185">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5c687-186">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="5c687-186">Special Thanks To</span></span>

<span data-ttu-id="5c687-187">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="5c687-187">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5c687-188">Weryfikacja potencjalnych klientów w ramach tego samouczka został Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="5c687-188">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="5c687-189">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="5c687-189">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5c687-190">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5c687-190">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="5c687-191">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="5c687-191">Previous</span></span>](declarative-parameters-vb.md)
