---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Tworzenie warstwy dostępu do danych (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku utworzymy zacząć od samego początku wymuszał i tworzenie danych warstwy dostępu (DAL), przy użyciu typizowanych zestawów danych, aby uzyskać dostęp do informacji w bazie danych.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: 4d8afd13fc693c828850bec53664a4db7d91dede
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59420604"
---
# <a name="creating-a-data-access-layer-c"></a><span data-ttu-id="b01db-103">Tworzenie warstwy dostępu do danych (C#)</span><span class="sxs-lookup"><span data-stu-id="b01db-103">Creating a Data Access Layer (C#)</span></span>

<span data-ttu-id="b01db-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b01db-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="b01db-105">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="b01db-105">Download PDF</span></span>](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)

> <span data-ttu-id="b01db-106">W tym samouczku utworzymy zacząć od samego początku wymuszał i tworzenie danych warstwy dostępu (DAL), przy użyciu typizowanych zestawów danych, aby uzyskać dostęp do informacji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="b01db-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="b01db-107">Introduction</span></span>

<span data-ttu-id="b01db-108">Jako projektantom sieci web nasze życie koncentrują się wokół pracy z danymi.</span><span class="sxs-lookup"><span data-stu-id="b01db-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="b01db-109">Możemy utworzyć bazy danych do przechowywania danych, kod, aby pobrać i zmodyfikować i stron sieci web do zbierania i podsumowaniu.</span><span class="sxs-lookup"><span data-stu-id="b01db-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="b01db-110">To jest pierwszy samouczek w długich serii, która będzie Poznaj techniki implementacji tych typowych wzorców w programie ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="b01db-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="b01db-111">Zaczniemy od utworzenia [architektury oprogramowania](http://en.wikipedia.org/wiki/Software_architecture) składa się z danych programu Access warstwy (DAL) przy użyciu wpisanych zestawów danych, warstwy logiki biznesowej (LOGIKI) który wymusza stosowanie niestandardowych reguł biznesowych, a warstwa prezentacji składa się z ASP.NET strony, która Udostępniaj wspólne układu strony.</span><span class="sxs-lookup"><span data-stu-id="b01db-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="b01db-112">Po sekcji tego podwaliny pod Projekt wdrożenia wewnętrznej bazy danych, zmienimy do raportowania, przedstawiający sposób wyświetlania, podsumować, zbieranie i sprawdzanie poprawności danych z aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="b01db-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="b01db-113">Te samouczki są dostosowane do być zwięzłe i zapewnić instrukcje krok po kroku z dużą ilością zrzuty ekranu wizualnie przeprowadzi Cię przez proces.</span><span class="sxs-lookup"><span data-stu-id="b01db-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="b01db-114">Każdy samouczek jest dostępny w C# i Visual Basic wersji i obejmuje pobieranie kompletny kod używany.</span><span class="sxs-lookup"><span data-stu-id="b01db-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="b01db-115">(Tego pierwszego samouczka dotyczącego jest bardzo długi, ale pozostałe są prezentowane w znacznie więcej fragmentów o wysokim strawności).</span><span class="sxs-lookup"><span data-stu-id="b01db-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="b01db-116">Te samouczki będziemy używać programu Microsoft SQL Server 2005 Express Edition wersję bazy danych Northwind, umieszczone w **aplikacji\_danych** katalogu.</span><span class="sxs-lookup"><span data-stu-id="b01db-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="b01db-117">Oprócz pliku bazy danych **aplikacji\_danych** folder zawiera także skrypty SQL do tworzenia baz danych, w przypadku, gdy chcesz użyć wersji innej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="b01db-118">Skrypty te mogą być również [pobrać bezpośrednio z witryny Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), jeśli chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="b01db-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="b01db-119">Jeśli używasz innej wersji programu SQL Server, bazy danych Northwind, należy zaktualizować **NORTHWNDConnectionString** ustawienia aplikacji w witrynie **Web.config** pliku.</span><span class="sxs-lookup"><span data-stu-id="b01db-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="b01db-120">Aplikacja sieci web został skompilowany przy użyciu programu Visual Studio 2005 Professional Edition jako projekt witryny sieci Web opartych na systemie plików.</span><span class="sxs-lookup"><span data-stu-id="b01db-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="b01db-121">Jednak wszystkie samouczki będzie działać równie dobrze z bezpłatnej wersji usługi Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="b01db-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="b01db-122">W tym samouczku utworzymy zacząć od samego początku wymuszał i tworzenie danych warstwy dostępu (DAL), Tworzenie warstwy logiki biznesowej (LOGIKI) w drugim samouczku, a nad układu strony i nawigacja w trzecim.</span><span class="sxs-lookup"><span data-stu-id="b01db-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="b01db-123">Samouczki, po trzecie będzie bazują na podstawę głosów pierwsze trzy.</span><span class="sxs-lookup"><span data-stu-id="b01db-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="b01db-124">Mamy wiele pokrycia w tym pierwszym samouczku, dlatego środowisko Visual Studio i zaczynajmy!</span><span class="sxs-lookup"><span data-stu-id="b01db-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="b01db-125">Krok 1. Tworzenie projektu sieci Web i połączenie z bazą danych</span><span class="sxs-lookup"><span data-stu-id="b01db-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="b01db-126">Zanim będziemy mogli utworzyć nasze warstwy dostępu do danych (DAL), najpierw należy utworzyć witrynę sieci web i skonfigurować w naszej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="b01db-127">Rozpocznij od utworzenia nowego pliku w oparciu o system ASP.NET witryny sieci web.</span><span class="sxs-lookup"><span data-stu-id="b01db-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="b01db-128">Aby to zrobić, przejdź do menu Plik, a następnie wybierz nową witrynę sieci Web w celu wyświetlania okna dialogowego nową witrynę sieci Web.</span><span class="sxs-lookup"><span data-stu-id="b01db-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="b01db-129">Wybierz szablon witryny sieci Web platformy ASP.NET, zmień wartość na liście rozwijanej lokalizacji w systemie plików, wybierz folder do umieszczenia w witrynie sieci web i ustaw języka C#.</span><span class="sxs-lookup"><span data-stu-id="b01db-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="b01db-130">[![Tworzenie nowego pliku w oparciu o System witryny sieci Web](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="b01db-131">**Rysunek 1**: Tworzenie witryny sieci Web New File System-Based ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="b01db-132">Spowoduje to utworzenie nowej witryny sieci web za pomocą **Default.aspx** strony ASP.NET i **aplikacji\_danych** folderu.</span><span class="sxs-lookup"><span data-stu-id="b01db-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="b01db-133">Witryny sieci web utworzone następnym krokiem jest dodać odwołanie do bazy danych w Eksploratorze serwera Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b01db-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="b01db-134">Dodając bazę danych do Eksploratora serwera można dodać tabel, procedur składowanych, widoków i itd. wszystko z poziomu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b01db-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="b01db-135">Można również wyświetlić dane w tabeli lub ręcznie lub graficznie tworzyć własne zapytania za pomocą konstruktora zapytań.</span><span class="sxs-lookup"><span data-stu-id="b01db-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="b01db-136">Ponadto gdy będziemy tworzyć wpisanych zestawów danych dla warstwy DAL musimy punktu Visual Studio do bazy danych, z którego powinien być konstruowany wpisanych zestawów danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="b01db-137">Gdy firma Microsoft może zapewnić informacje o połączeniu w danym momencie, Visual Studio spowoduje automatyczne wypełnienie listy rozwijanej, baz danych już jest zarejestrowany w Eksploratorze serwera.</span><span class="sxs-lookup"><span data-stu-id="b01db-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="b01db-138">Kroki umożliwiające dodawanie bazy danych Northwind do Eksploratora serwera zależą od tego, czy chcesz użyć bazy danych programu SQL Server 2005 Express Edition w **aplikacji\_danych** folderze lub w przypadku programu Microsoft SQL Server 2000 lub 2005 Konfigurowanie serwera bazy danych, którą chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="b01db-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="b01db-139">Korzystanie z bazy danych w theApp\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="b01db-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="b01db-140">Jeśli nie masz programu SQL Server 2000 lub serwer bazy danych 2005, aby nawiązać połączenie, lub po prostu chcesz uniknąć konieczności dodawania bazy danych do serwera bazy danych, można użyć wersji programu SQL Server 2005 Express Edition bazy danych Northwind, która znajduje się w pobranych websit e's **aplikacji\_danych** folder (**NORTHWND. MDF**).</span><span class="sxs-lookup"><span data-stu-id="b01db-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="b01db-141">Bazy danych są umieszczane w **aplikacji\_danych** folderu jest automatycznie dodawane do Eksploratora serwera.</span><span class="sxs-lookup"><span data-stu-id="b01db-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="b01db-142">Przy założeniu, że program SQL Server 2005 Express Edition, na maszynie zainstalowano powinny być widoczne węzła o nazwie NORTHWND. MDF w Eksploratorze serwera, które można rozwijać i zapoznaj się z jego tabele, widoki, procedury składowanej i tak dalej (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="b01db-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="b01db-143">**Aplikacji\_danych** folderu może też przechowywać Microsoft Access **.mdb** pliki, które podobnie jak ich odpowiedniki programu SQL Server, są automatycznie dodawane do Eksploratora serwera.</span><span class="sxs-lookup"><span data-stu-id="b01db-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="b01db-144">Jeśli nie chcesz używać żadnych opcji programu SQL Server, zawsze możesz [Pobierz program Microsoft Access wersję pliku bazy danych Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) i upuść na **aplikacji\_danych** katalogu.</span><span class="sxs-lookup"><span data-stu-id="b01db-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="b01db-145">Zwróć uwagę, jednak baz danych programu Access spoza jako wyposażonym w programie SQL Server i nie są przeznaczone do użytku w scenariuszach witryny sieci web.</span><span class="sxs-lookup"><span data-stu-id="b01db-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="b01db-146">Ponadto kilka samouczków ponad 35 będzie korzystać z niektórych funkcji poziomu bazy danych, które nie są obsługiwane przez funkcję dostępu.</span><span class="sxs-lookup"><span data-stu-id="b01db-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="b01db-147">Łączenie z bazą danych na serwerze bazy danych programu Microsoft SQL Server 2000 lub 2005</span><span class="sxs-lookup"><span data-stu-id="b01db-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="b01db-148">Alternatywnie możesz nawiązać bazy danych Northwind zainstalowane na serwerze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="b01db-149">Jeśli serwer bazy danych nie ma jeszcze zainstalowane bazy danych Northwind, użytkownik musi go najpierw dodać do serwera bazy danych, uruchamiając skrypt instalacyjny zawarte w tym samouczku pobierania lub przez [pobieranie wersji programu SQL Server 2000 bazy danych Northwind i skrypt instalacji](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) bezpośrednio z witryny sieci web firmy Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b01db-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="b01db-150">Po utworzeniu bazy danych, zainstalowane, przejdź do Eksploratora serwera w programie Visual Studio, kliknij prawym przyciskiem myszy węzła połączenia danych i wybierz polecenie Dodaj połączenie.</span><span class="sxs-lookup"><span data-stu-id="b01db-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="b01db-151">Jeśli nie widzisz Eksploratora serwera, przejdź do widoku / Server Explorer lub trafień Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="b01db-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="b01db-152">Okno dialogowe Dodawanie połączenia, w którym można określić serwer, aby nawiązać połączenie, spowoduje to wyświetlenie informacji o uwierzytelnianiu i nazwę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="b01db-153">Po pomyślnym skonfigurowanych informacji dotyczących połączenia bazy danych i kliknięciu przycisku OK, baza danych zostanie dodany jako węzeł poniżej tego węzła połączenia danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="b01db-154">Można rozwinąć węzeł bazy danych, aby eksplorować tabele, widoki, procedury składowane i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="b01db-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Dodawanie połączenia do bazy danych Northwind serwer bazy danych](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="b01db-156">**Rysunek 2**: Dodawanie połączenia do bazy danych Northwind serwer bazy danych</span><span class="sxs-lookup"><span data-stu-id="b01db-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="b01db-157">Krok 2. Tworzenie warstwy dostępu do danych</span><span class="sxs-lookup"><span data-stu-id="b01db-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="b01db-158">Podczas pracy z jedną z opcji danych jest osadzone logikę specyficzną dla danych bezpośrednio do warstwy prezentacji (aplikacja sieci web składają stron ASP.NET Warstwa prezentacji).</span><span class="sxs-lookup"><span data-stu-id="b01db-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="b01db-159">Może to potrwać postaci pisania kodu ADO.NET w części kodu strony ASP.NET lub przy użyciu kontrolki SqlDataSource z fragment kodu znaczników.</span><span class="sxs-lookup"><span data-stu-id="b01db-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="b01db-160">W obu przypadkach to podejście ściśle couples logiką dostępu do danych z warstwą prezentacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="b01db-161">Zalecanym podejściem jest jednak oddzielić logiką dostępu do danych z warstwy prezentacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="b01db-162">Ta warstwa oddzielne nazywa się warstwy dostępu do danych, warstwy DAL w skrócie i jest zwykle implementowany jako oddzielny projekt biblioteki klas.</span><span class="sxs-lookup"><span data-stu-id="b01db-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="b01db-163">Zalety tej architektury warstwowej są dobrze udokumentowane (zobacz sekcję "Dalsze odczytów" na końcu niniejszego samouczka, aby informacji na temat korzyści te) i jest rozwiązaniem podejmujemy w tej serii.</span><span class="sxs-lookup"><span data-stu-id="b01db-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="b01db-164">Cały kod, który zależy od bazowego źródła danych, takich jak tworzenie połączenia z bazą danych, wydawanie **wybierz**, **Wstaw**, **aktualizacji**, i  **Usuń** polecenia i tak dalej powinien znajdować się w warstwy DAL.</span><span class="sxs-lookup"><span data-stu-id="b01db-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="b01db-165">Warstwa prezentacji nie powinna zawierać żadnych odwołań do takiego kodu dostępu do danych, ale zamiast tego należy wykonywać wywołania do warstwy DAL wszystkie dane żądań.</span><span class="sxs-lookup"><span data-stu-id="b01db-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="b01db-166">Warstwy dostępu do danych zwykle zawierają metod dostępu do danych bazowych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="b01db-167">Bazy danych Northwind, na przykład ma **produktów** i **kategorie** tabel, służące do rejestrowania produktów, sprzedaż i kategorie, do których należą.</span><span class="sxs-lookup"><span data-stu-id="b01db-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="b01db-168">W naszym DAL mamy metod, takich jak:</span><span class="sxs-lookup"><span data-stu-id="b01db-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="b01db-169">**GetCategories(),** co spowoduje zwrócenie informacji na temat wszystkich kategorii</span><span class="sxs-lookup"><span data-stu-id="b01db-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="b01db-170">**GetProducts()**, co spowoduje zwrócenie informacji na temat wszystkich produktów</span><span class="sxs-lookup"><span data-stu-id="b01db-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="b01db-171">**GetProductsByCategoryID (*categoryID*)**, co spowoduje zwrócenie wszystkich produktów, które należą do określonej kategorii</span><span class="sxs-lookup"><span data-stu-id="b01db-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="b01db-172">**GetProductByProductID (*productID*)**, co spowoduje zwrócenie informacji na temat określonego produktu</span><span class="sxs-lookup"><span data-stu-id="b01db-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="b01db-173">Te metody, gdy wywoływany, będzie połączenia z bazą danych, wystawiał odpowiednie zapytanie, a następnie zwracają wyniki.</span><span class="sxs-lookup"><span data-stu-id="b01db-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="b01db-174">Ważne jest jak możemy zwrócić następujące wyniki.</span><span class="sxs-lookup"><span data-stu-id="b01db-174">How we return these results is important.</span></span> <span data-ttu-id="b01db-175">Metody te po prostu może zwrócić zestawu danych lub DataReader wprowadzona przez zapytanie bazy danych, ale najlepiej te wyniki powinny być zwracany za pomocą *silnie typizowanych obiektów*.</span><span class="sxs-lookup"><span data-stu-id="b01db-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="b01db-176">Obiekt silnie typizowane jest jednym którego schemat sztywno jest zdefiniowany w czasie kompilacji, i na odwrót obiekt typowaniem luźnym jest jedną którego schemat nie jest znany aż do czasu.</span><span class="sxs-lookup"><span data-stu-id="b01db-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="b01db-177">Na przykład elementu DataReader i zestaw danych (domyślnie) to typowaniem luźnym obiekty, ponieważ jego schemat jest definiowany przez kolumny zwracane przez zapytanie bazy danych, używanych do wypełniania je.</span><span class="sxs-lookup"><span data-stu-id="b01db-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="b01db-178">Dostęp do konkretnej kolumny z typowaniem luźnym DataTable, należy użyć składni, takich jak: <strong><em>DataTable</em>. Wiersze [<em>indeksu</em>] ["<em>columnName</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="b01db-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="b01db-179">Na obiekt DataTable nie będzie wpisując w tym przykładzie jest ujawnione przez fakt, że potrzebujemy dostęp do nazwy kolumny przy użyciu ciągu lub indeksem.</span><span class="sxs-lookup"><span data-stu-id="b01db-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="b01db-180">Silnie typizowane DataTable, z drugiej strony, będzie miał każdego z jego kolumn implementowane jako właściwości, co w kodzie, który wygląda następująco: <strong><em>DataTable</em>. Wiersze [<em>indeksu</em>]. *NazwaKolumny</strong>*.</span><span class="sxs-lookup"><span data-stu-id="b01db-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="b01db-181">Aby przywrócić silnie typizowanych obiektów, deweloperzy mogą tworzenie własnych obiektów niestandardowych biznesowych albo użyj wpisanych zestawów danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="b01db-182">Obiekt biznesowy jest implementowany przez dewelopera, ponieważ reprezentuje klasę, której właściwości zwykle odzwierciedla kolumny tabeli podstawowej bazy danych obiektu biznesowego.</span><span class="sxs-lookup"><span data-stu-id="b01db-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="b01db-183">Wpisany zestaw danych jest klasą wygenerowane automatycznie przez program Visual Studio na podstawie schematu bazy danych i której członkami są silnie typizowaną zgodnie z tym schemacie.</span><span class="sxs-lookup"><span data-stu-id="b01db-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="b01db-184">Wpisany zestaw danych sam składa się z klas, które rozszerzają klas ADO.NET DataSet, DataTable i DataRow.</span><span class="sxs-lookup"><span data-stu-id="b01db-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="b01db-185">Oprócz silnie typizowane DataTable wpisanych zestawów danych teraz także TableAdapters, w której przedstawiono klasy z metodami wypełnianie zestawu danych DataTables zmiany i propagowanie zmian w ramach DataTable w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="b01db-186">Aby uzyskać więcej informacji na temat zalet i wad przy użyciu wpisanych zestawów danych i obiektów niestandardowych biznesowych, zobacz [projektowanie składników warstwy danych i przekazywanie danych za pośrednictwem warstw](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="b01db-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="b01db-187">Użyjemy silnie typizowane zestawy danych dla tych samouczków architektury.</span><span class="sxs-lookup"><span data-stu-id="b01db-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="b01db-188">Rysunek 3 ilustruje przepływ pracy między różne warstwy aplikacji, która używa wpisanych zestawów danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="b01db-189">[![Cały kod dostępu do danych jest były odpowiedzialne warstwy DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="b01db-190">**Rysunek 3**: Cały kod dostępu do danych jest były odpowiedzialne z warstwą dal ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="b01db-191">Tworzenie zestawu danych i tabeli karty</span><span class="sxs-lookup"><span data-stu-id="b01db-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="b01db-192">Aby rozpocząć tworzenie naszej DAL, Zaczniemy od Dodawanie wpisany zestaw danych do naszego projektu.</span><span class="sxs-lookup"><span data-stu-id="b01db-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="b01db-193">W tym celu kliknij prawym przyciskiem myszy węzeł projektu w Eksploratorze rozwiązań i wybierz pozycję Dodaj nowy element.</span><span class="sxs-lookup"><span data-stu-id="b01db-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="b01db-194">Wybierz opcję zestaw danych z listy szablonów, a następnie nadaj mu nazwę **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="b01db-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="b01db-195">[![Wybierz dodać nowy zestaw danych do projektu](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="b01db-196">**Rysunek 4**: Wybierz dodać nowy zestaw danych do projektu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="b01db-197">Po kliknięciu przycisku Dodaj, po wyświetleniu monitu, aby dodać zestaw danych do **aplikacji\_kodu** folderu, kliknij przycisk Tak.</span><span class="sxs-lookup"><span data-stu-id="b01db-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="b01db-198">Projektant wpisany zestaw danych zostanie wyświetlony, a następnie uruchomi Kreator konfiguracji TableAdapter, umożliwiające dodanie Twojego pierwszego TableAdapter DataSet wpisane.</span><span class="sxs-lookup"><span data-stu-id="b01db-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="b01db-199">Wpisany zestaw danych jest zbiorem silnie typizowanych danych. składa się z silnie typizowane wystąpień elementu DataTable, z których każdy z kolei składa się z silnie typizowane wystąpień klasy DataRow.</span><span class="sxs-lookup"><span data-stu-id="b01db-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="b01db-200">Utworzymy tabelę DataTable silnie typizowane dla każdej z tabel bazy danych, potrzebne nam pracować w tej serii samouczków.</span><span class="sxs-lookup"><span data-stu-id="b01db-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="b01db-201">Zacznijmy od utworzenia elementu DataTable do **produktów** tabeli.</span><span class="sxs-lookup"><span data-stu-id="b01db-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="b01db-202">Należy pamiętać o tym, silnie typizowane DataTable nie dołączaj żadnych informacji o tym, jak uzyskać dostęp do danych z ich tabeli źródłowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="b01db-203">Aby pobrać dane w celu wypełnienia tabeli DataTable, należy użyć klasy TableAdapter, która działa jako nasze warstwy dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="b01db-204">Dla naszych **produktów** DataTable, TableAdapter będzie zawierać metod **GetProducts()**, **GetProductByCategoryID (*categoryID*)** i tak dalej, firma Microsoft będzie wywołania z warstwy prezentacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="b01db-205">Rola tabeli DataTable jest ma pełnić rolę silnie typizowanych obiektów, używany do przekazywania danych między warstwami.</span><span class="sxs-lookup"><span data-stu-id="b01db-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="b01db-206">Kreator konfiguracji TableAdapter rozpoczyna się od monit wybierz bazę danych, które chcesz pracować.</span><span class="sxs-lookup"><span data-stu-id="b01db-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="b01db-207">Na liście rozwijanej przedstawiono tych baz danych w Eksploratorze serwera.</span><span class="sxs-lookup"><span data-stu-id="b01db-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="b01db-208">Jeśli bazy danych Northwind nie zostały dodane do Eksploratora serwera, możesz kliknąć przycisk nowe połączenie, w tej chwili, aby to zrobić.</span><span class="sxs-lookup"><span data-stu-id="b01db-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="b01db-209">[![Z listy rozwijanej wybierz opcję bazy danych Northwind](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="b01db-210">**Rysunek 5**: Z listy rozwijanej wybierz opcję bazy danych Northwind ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="b01db-211">Po wybraniu bazy danych, a następnie klikając przycisk Dalej, użytkownik zostanie zapytany, czy chcesz zapisać parametry połączenia w **Web.config** pliku.</span><span class="sxs-lookup"><span data-stu-id="b01db-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="b01db-212">Zapisując parametry połączenia można będzie uniknąć go twardych kodowane w klasach TableAdapter, która upraszcza czynności, jeśli informacje o parametrach połączenia zmieni się w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="b01db-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="b01db-213">Jeśli wybierzesz opcję Zapisz parametry połączenia w pliku konfiguracji jest umieszczany w **&lt;connectionStrings&gt;** sekcję, co może być [opcjonalnie zaszyfrowanych](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) na lepsze zabezpieczeń lub zmodyfikowany później przy użyciu nowej strony właściwości w wersji 2.0 programu ASP.NET w narzędziu administracyjnym usług IIS graficznego interfejsu użytkownika, co jest bardziej idealnym rozwiązaniem dla administratorów.</span><span class="sxs-lookup"><span data-stu-id="b01db-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="b01db-214">[![Zapisz parametry połączenia do pliku Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="b01db-215">**Rysunek 6**: Zapisz ciąg połączeń do **Web.config** ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="b01db-216">Następnie należy zdefiniować schemat dla pierwszego elementu DataTable silnie typizowane i Udostępnij pierwszą metodę naszych TableAdapter do użycia podczas wypełniania zestawu danych silnie typizowane.</span><span class="sxs-lookup"><span data-stu-id="b01db-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="b01db-217">Następujące dwa kroki są wykonywane jednocześnie, tworząc kwerendę, która zwraca kolumny z tabeli, że chcemy znajduje odzwierciedlenie w naszym DataTable.</span><span class="sxs-lookup"><span data-stu-id="b01db-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="b01db-218">Po zakończeniu pracy z kreatorem przedstawimy Nazwa metody do tego zapytania.</span><span class="sxs-lookup"><span data-stu-id="b01db-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="b01db-219">Gdy który zostało zrobione, ta metoda może być wywoływany z naszych warstwy prezentacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="b01db-220">Metoda będzie wykonaj zapytanie zdefiniowane i wypełnij DataTable silnie typizowane.</span><span class="sxs-lookup"><span data-stu-id="b01db-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="b01db-221">Aby rozpocząć pracę, definiując kwerendy SQL musi najpierw wskazaliśmy jak chcemy TableAdapter do wysyłania kwerendy.</span><span class="sxs-lookup"><span data-stu-id="b01db-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="b01db-222">Możemy użyć instrukcji SQL zapytań ad-hoc, Utwórz nową procedurę składowaną lub użyj istniejącą procedurę składowaną.</span><span class="sxs-lookup"><span data-stu-id="b01db-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="b01db-223">Dla tych samouczkach użyjemy instrukcji SQL zapytań ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="b01db-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="b01db-224">Zapoznaj się [NieTak Brian](http://briannoyes.net/)użytkownika artykuł [Tworzenie warstwy dostępu do danych, za pomocą Projektanta obiektów DataSet 2005 Visual Studio](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) na przykład za pomocą procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="b01db-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="b01db-225">[![Wykonywanie zapytań o dane za pomocą instrukcji SQL zapytań Ad-Hoc](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="b01db-226">**Rysunek 7**: Wykonywanie zapytań o dane za pomocą instrukcji SQL zapytań Ad-Hoc ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="b01db-227">W tym momencie możemy można wpisać w kwerendzie SQL ręcznie.</span><span class="sxs-lookup"><span data-stu-id="b01db-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="b01db-228">Podczas tworzenia pierwszej metody w metodzie TableAdapter ma zazwyczaj kwerenda zwraca te kolumny, które muszą być wyrażone w odpowiedni DataTable.</span><span class="sxs-lookup"><span data-stu-id="b01db-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="b01db-229">Możemy to zrobić, tworząc zapytania zwracającego wszystkie kolumny i wszystkie wiersze z **produktów** tabeli:</span><span class="sxs-lookup"><span data-stu-id="b01db-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="b01db-230">[![Wprowadź zapytanie SQL do kontrolki Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="b01db-231">**Rysunek 8**: Wprowadź SQL zapytań w polu tekstowym ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="b01db-232">Alternatywnie użyj konstruktora zapytań i graficznie konstruowania zapytania, jak pokazano na rysunku 9.</span><span class="sxs-lookup"><span data-stu-id="b01db-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="b01db-233">[![Utwórz zapytanie w formie graficznej, za pomocą edytora zapytań](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="b01db-234">**Rysunek 9**: Utwórz zapytanie graficznie, za pomocą edytora zapytań ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="b01db-235">Po utworzeniu zapytania, ale przed przejściem do następnego ekranu kliknij przycisk Opcje zaawansowane.</span><span class="sxs-lookup"><span data-stu-id="b01db-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="b01db-236">W projektach witryny sieci Web "Generuj Insert, Update i Delete instrukcji" jest jedyną zaawansowana opcja jest zaznaczona domyślnie; Po uruchomieniu tego kreatora z biblioteki klas lub projektu Windows również zostanie wybrana opcja "Użyj optymistycznej współbieżności".</span><span class="sxs-lookup"><span data-stu-id="b01db-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="b01db-237">Zaznaczaj opcji "Użyj optymistycznej współbieżności" teraz.</span><span class="sxs-lookup"><span data-stu-id="b01db-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="b01db-238">W samouczkach przyszłych zajmiemy się optymistycznej współbieżności.</span><span class="sxs-lookup"><span data-stu-id="b01db-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="b01db-239">[![Wybierz tylko generowanie Insert, Update i Delete instrukcje opcji](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="b01db-240">**Na rysunku nr 10**: Wybierz tylko generowanie Insert, Update i Delete instrukcje opcji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="b01db-241">Po zweryfikowaniu opcje zaawansowane, kliknij przycisk Dalej, aby przejść do końcowej ekranu.</span><span class="sxs-lookup"><span data-stu-id="b01db-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="b01db-242">W tym miejscu są możemy proszony o wybranie metod, aby dodać do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="b01db-243">Istnieją dwa wzorce umożliwiający wypełnianie danych:</span><span class="sxs-lookup"><span data-stu-id="b01db-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="b01db-244">**Wypełnij DataTable** za pomocą tego podejścia, tworzona jest metoda, która przyjmuje jako parametr DataTable i wypełnia ją na podstawie wyników zapytania.</span><span class="sxs-lookup"><span data-stu-id="b01db-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="b01db-245">Klasa ADO.NET DataAdapter, na przykład implementuje tego wzorca z jego **Fill()** metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="b01db-246">**Zwraca DataTable** w przypadku tej metody metoda tworzy i wypełnia DataTable dla Ciebie i zwraca go jako metody zwracają wartość.</span><span class="sxs-lookup"><span data-stu-id="b01db-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="b01db-247">Może mieć TableAdapter, zaimplementuj jeden lub oba te wzorce.</span><span class="sxs-lookup"><span data-stu-id="b01db-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="b01db-248">Można również zmienić nazwę metody podane tutaj.</span><span class="sxs-lookup"><span data-stu-id="b01db-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="b01db-249">Pozostawmy oba pola wyboru zaznaczone, mimo że firma Microsoft będzie używać tylko ten drugi wzorzec w tych samouczkach.</span><span class="sxs-lookup"><span data-stu-id="b01db-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="b01db-250">Ponadto Zmieńmy nazwy zamiast ogólnych **GetData** metody **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="b01db-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="b01db-251">Jeśli zaznaczone, tworzy końcowej pola wyboru "GenerateDBDirectMethods," **Insert()**, **Update()**, i **Delete()** metody TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="b01db-252">Jeśli zaznaczaj tej opcji wszystkie aktualizacje należy wykonać za pomocą TableAdapter jedynej **Update()** metody, która przyjmuje wpisany zestaw danych, DataTable, pojedynczego elementu DataRow lub tablicę wierszy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="b01db-253">(Jeśli masz unchecked "Generuj Insert, Update i Delete instrukcje" w opcji Zaawansowane właściwości na rysunku 9 to pole wyboru ustawienia odniesie żadnego skutku.) Teraz należy pozostawić zaznaczone pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="b01db-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="b01db-254">[![Zmień nazwę metody z GetData GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="b01db-255">**Rysunek 11**: Zmień nazwę metody **GetData** do **GetProducts** ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="b01db-256">Ukończ pracę kreatora, klikając przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="b01db-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="b01db-257">Po zamknięciu kreatora możemy są zwracane do Projektanta obiektów DataSet, w której przedstawiono DataTable, którą właśnie utworzyliśmy.</span><span class="sxs-lookup"><span data-stu-id="b01db-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="b01db-258">Można wyświetlić listę kolumn w **produktów** DataTable (**ProductID**, **ProductName**i tak dalej), a także metody  **ProductsTableAdapter** (**Fill()** i **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="b01db-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="b01db-259">[![DataTable produktów i ProductsTableAdapter zostały dodane do wpisana zestawu danych](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="b01db-260">**Rysunek 12**: **Produktów** DataTable i **ProductsTableAdapter** zostały dodane do zestawu danych wpisane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="b01db-261">W tym momencie mamy wpisany zestaw danych z pojedynczej tabeli DataTable (**Northwind.Products**) i silnie typizowaną klasę DataAdapter (**NorthwindTableAdapters.ProductsTableAdapter**) przy użyciu  **GetProducts()** metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="b01db-262">Te obiekty mogą służyć dostęp do listy wszystkich produktów z kodu, takich jak:</span><span class="sxs-lookup"><span data-stu-id="b01db-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="b01db-263">Ten kod nie wymagała nam napisać jeden bit kodu specyficznego dla dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="b01db-264">Firma Microsoft nie ma do tworzenia wystąpień dowolnego klas ADO.NET, firma Microsoft nie będzie musiał odwoływać się do żadnych parametrów połączenia zapytania SQL lub procedur składowanych.</span><span class="sxs-lookup"><span data-stu-id="b01db-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="b01db-265">Zamiast tego TableAdapter zawiera kod dostępu do danych niskiego poziomu dla nas.</span><span class="sxs-lookup"><span data-stu-id="b01db-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="b01db-266">Każdy obiekt używany w tym przykładzie jest również silnie typizowaną, dzięki czemu Visual Studio, aby zapewnić funkcji IntelliSense i sprawdzanie typów w czasie kompilacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="b01db-267">A najlepsze cechy wszystkich DataTable, które są zwracane przez TableAdapter może być powiązana z formantów sieci Web, takich jak kontrolki GridView, DetailsView, DropDownList, CheckBoxList i kilka innych danych w programie ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b01db-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="b01db-268">W poniższym przykładzie pokazano powiązania tabeli DataTable zwróconej przez **GetProducts()** metody w kontrolce GridView po prostu krępowane trzech wierszy kodu w **strony\_obciążenia** programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="b01db-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="b01db-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="b01db-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="b01db-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="b01db-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="b01db-271">[![Lista produktów są wyświetlane w widoku GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="b01db-272">**Rysunek 13**: Lista produktów jest wyświetlany w kontrolce GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="b01db-273">W tym przykładzie wymagane, możemy napisać trzech wierszach kodu strony ASP.NET **strony\_obciążenia** program obsługi zdarzeń, w przyszłości zajmiemy się jak za pomocą kontrolki ObjectDataSource deklaratywne odbierać dane z samouczków WARSTWA DAL.</span><span class="sxs-lookup"><span data-stu-id="b01db-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="b01db-274">Za pomocą kontrolki ObjectDataSource firma Microsoft nie będziesz mieć do pisania kodu i otrzyma obsługi stronicowania i sortowania.</span><span class="sxs-lookup"><span data-stu-id="b01db-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="b01db-275">Krok 3. Dodawanie sparametryzowane metody służące do warstwy dostępu do danych</span><span class="sxs-lookup"><span data-stu-id="b01db-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="b01db-276">W tym momencie nasze **ProductsTableAdapter** klasa ma jednak jedną metodę **GetProducts()**, która zwraca wszystkich produktów w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="b01db-277">Możliwość pracy w przypadku pozostałych produktów jest zdecydowanie użyteczne, istnieją czasy, kiedy chcemy będzie można pobrać informacji na temat określonego produktu lub wszystkie produkty, które należą do określonej kategorii.</span><span class="sxs-lookup"><span data-stu-id="b01db-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="b01db-278">Aby dodać funkcjonalność do naszych warstwy dostępu do danych możemy dodać sparametryzowane metody do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="b01db-279">Dodajmy **GetProductsByCategoryID (*categoryID*)** metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="b01db-280">Aby dodać nową metodę do warstwy DAL, wróć do Projektanta obiektów DataSet, kliknij prawym przyciskiem myszy **ProductsTableAdapter** sekcji, a następnie wybierz polecenie Dodaj zapytanie.</span><span class="sxs-lookup"><span data-stu-id="b01db-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Kliknij prawym przyciskiem myszy na obiekt TableAdapter i wybierz polecenie Dodaj zapytanie](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="b01db-282">**Rysunek 14**: Kliknij prawym przyciskiem myszy na obiekt TableAdapter i wybierz polecenie Dodaj zapytanie</span><span class="sxs-lookup"><span data-stu-id="b01db-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="b01db-283">Firma Microsoft są najpierw pojawi się monit dotyczący tego, czy ma dostęp do bazy danych za pomocą instrukcji SQL zapytań ad-hoc lub nowej lub istniejącej procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="b01db-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="b01db-284">Wybierzmy użyć instrukcji SQL zapytań ad-hoc ponownie.</span><span class="sxs-lookup"><span data-stu-id="b01db-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="b01db-285">Są następnie proszeni jakiego typu zapytania SQL prosimy o poświęcenie do użycia.</span><span class="sxs-lookup"><span data-stu-id="b01db-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="b01db-286">Ponieważ chcemy zwrócić wszystkie produkty, które należą do określonej kategorii, chcemy napisać **wybierz** instrukcji, która zwraca wiersze.</span><span class="sxs-lookup"><span data-stu-id="b01db-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="b01db-287">[![Utwórz instrukcję SELECT, która zwraca wiersze](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="b01db-288">**Rysunek 15**: Możliwość tworzenia **wybierz** instrukcji która zwraca wiersze ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="b01db-289">Następnym krokiem jest określenie zapytania SQL używany do uzyskania dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="b01db-290">Ponieważ chcemy zwracać tylko te produkty, które należą do określonej kategorii, czy mogę używać tego samego <strong>wybierz</strong> instrukcji z <strong>GetProducts()</strong>, Dodaj następujący kod, ale <strong>gdzie</strong> Klauzula: <strong>GDZIE CategoryID = @CategoryID</strong> .</span><span class="sxs-lookup"><span data-stu-id="b01db-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="b01db-291"><strong>@CategoryID</strong> Parametr wskazuje kreatora TableAdapter, że metoda tworzymy będą wymagały parametr wejściowy odpowiedniego typu (to znaczy, integer dopuszczającego wartość null).</span><span class="sxs-lookup"><span data-stu-id="b01db-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="b01db-292">[![Wprowadź zapytanie, aby zwracać tylko produktów w określonej kategorii](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="b01db-293">**Rysunek 16**: Wprowadź kwerendę tylko zwrócić produktów w określonej kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="b01db-294">W ostatnim kroku możemy wybrać który wzorce do użycia, a także dostosować nazwy metody generowane dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="b01db-295">Deseń wypełnienia zmienimy nazwę aby <strong>FillByCategoryID</strong> i dotyczące zwracania DataTable zwracają wzorca ( <strong>uzyskać*X</strong>*  metod), użyjemy  <strong>GetProductsByCategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="b01db-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>


<span data-ttu-id="b01db-296">[![Wybierz nazwy dla metody TableAdapter](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="b01db-297">**Rysunek 17**: Wybierz nazwy dla metody TableAdapter ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="b01db-298">Po ukończeniu kreatora, Projektant obiektów DataSet zawiera nowe metody TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Produkty mogą teraz można wykonywać zapytania według kategorii](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="b01db-300">**Rysunek 18**: Produkty mogą teraz można wykonywać zapytania według kategorii</span><span class="sxs-lookup"><span data-stu-id="b01db-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="b01db-301">Poświęć chwilę, aby dodać **GetProductByProductID (*productID*)** metody przy użyciu tej samej techniki.</span><span class="sxs-lookup"><span data-stu-id="b01db-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="b01db-302">Można przetestować te zapytania parametrycznego bezpośrednio w Projektancie obiektów DataSet.</span><span class="sxs-lookup"><span data-stu-id="b01db-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="b01db-303">Kliknij prawym przyciskiem myszy na metodzie, w metodzie TableAdapter, a następnie wybierz Podgląd danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="b01db-304">Następnie wprowadź wartości dla parametrów i kliknij przycisk (wersja zapoznawcza).</span><span class="sxs-lookup"><span data-stu-id="b01db-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="b01db-305">[![Te należące produktów do kategorii Beverages są wyświetlane.](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="b01db-306">**Rysunek 19**: Są wyświetlane te należące produktów do kategorii Beverages ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="b01db-307">Za pomocą **GetProductsByCategoryID (*categoryID*)** metody w naszym DAL, teraz można utworzyć strony ASP.NET, która wyświetla tylko te produkty w określonej kategorii.</span><span class="sxs-lookup"><span data-stu-id="b01db-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="b01db-308">W poniższym przykładzie pokazano wszystkie produkty, które należą do kategorii Beverages, które mają **CategoryID** 1.</span><span class="sxs-lookup"><span data-stu-id="b01db-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="b01db-309">Beverages.asp</span><span class="sxs-lookup"><span data-stu-id="b01db-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="b01db-310">Beverages.aspx.CS</span><span class="sxs-lookup"><span data-stu-id="b01db-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="b01db-311">[![Tych produktów w należące do tej kategorii są wyświetlane.](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="b01db-312">**Rysunek 20**: Tych produktów w należące do tej kategorii są wyświetlane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="b01db-313">Krok 4. Wstawianie, aktualizowanie i usuwanie danych</span><span class="sxs-lookup"><span data-stu-id="b01db-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="b01db-314">Istnieją dwa wzorce często używane do wstawiania, aktualizowania i usuwania danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="b01db-315">Pierwszy wzorzec będzie wywoływany wzorzec bezpośrednie bazy danych obejmuje tworzenie metod, które po wywołaniu, problem **Wstaw**, **aktualizacji**, lub **Usuń** polecenia Baza danych, która operuje na rekord pojedynczej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="b01db-316">Takie metody zwykle są przekazywane w serii wartości skalarnych (liczby całkowite, ciągi, wartości logicznych, Data/Godzina i tak dalej), które odpowiadają wartościom do wstawiania, aktualizacji lub usuwania.</span><span class="sxs-lookup"><span data-stu-id="b01db-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="b01db-317">Na przykład, w ramach tego wzorca dla **produktów** tabeli metodę delete zajmie się parametru liczby całkowitej wskazujący **ProductID** rekordu, aby usunąć, gdy metoda Wstaw zajęłoby ciąg dla **ProductName**, dziesiętny dla **UnitPrice**, liczbę całkowitą dla **UnitsOnStock**i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="b01db-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="b01db-318">[![Każdy Insert, Update i Usuń żądania, które są wysyłane do bazy danych natychmiast](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="b01db-319">**Rysunek 21**: Każdy Insert, Update i Usuń żądania, które są wysyłane do bazy danych od razu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="b01db-320">Inne wzorzec, który mogę odnosić się do w partii aktualizacji wzorzec, jest aktualizacji całego zestawu danych, DataTable lub Kolekcja wierszy danych w jednego wywołania metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="b01db-321">W ramach tego wzorca Deweloper usuwa, wstawia modyfikuje wierszy danych w elemencie DataTable i następnie przekazuje do metody aktualizacji tych wierszy danych ani objekt DataTable.</span><span class="sxs-lookup"><span data-stu-id="b01db-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="b01db-322">Ta metoda następnie wylicza dotyczy to również utworzeń przekazanej, określa, czy są już został zmodyfikowany, dodane lub usunięty (za pośrednictwem elementu DataRow [właściwość RowState](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) wartość) i wystawia żądanie odpowiednią bazę danych dla każdego rekordu.</span><span class="sxs-lookup"><span data-stu-id="b01db-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="b01db-323">[![Wszystkie zmiany są synchronizowane z bazą danych, gdy wywoływana jest metoda aktualizacji](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="b01db-324">**Rysunek 22**: Wszystkie zmiany są synchronizowane z bazą danych, gdy wywoływana jest metoda aktualizacji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="b01db-325">TableAdapter domyślnie używa wzorca aktualizacji usługi batch, ale także obsługuje bezpośredni wzorcu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="b01db-326">Ponieważ wybrano opcję "Generuj Insert, Update i Delete instrukcji" we właściwościach Zaawansowane przy tworzeniu naszych TableAdapter **ProductsTableAdapter** zawiera **Update()** metody który implementuje wzorzec aktualizacji usługi batch.</span><span class="sxs-lookup"><span data-stu-id="b01db-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="b01db-327">W szczególności zawiera TableAdapter **Update()** metody, które mogą być przekazywane wpisane DataSet, DataTable silnie typizowane lub jeden lub więcej wierszy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="b01db-328">Jeśli pozostawiono zaznaczone pole wyboru "GenerateDBDirectMethods", gdy najpierw tworząc TableAdapter wzorzec bezpośrednie bazy danych będą wprowadzone za pośrednictwem **Insert()**, **Update()**, i **Delete()**  metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="b01db-329">Obu wzorców modyfikacji danych użyj TableAdapter **element InsertCommand**, **elementu UpdateCommand**, i **elementu DeleteCommand** właściwości do wysyłania ich **INSERT** , **Aktualizacji**, i **Usuń** poleceń w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="b01db-330">Możesz sprawdzić i modyfikować **element InsertCommand**, **elementu UpdateCommand**, i **elementu DeleteCommand** właściwości, klikając na obiekt TableAdapter w Projektancie obiektów DataSet, a następnie przechodząc w oknie właściwości.</span><span class="sxs-lookup"><span data-stu-id="b01db-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="b01db-331">(Pamiętaj, że wybrano TableAdapter oraz że **ProductsTableAdapter** obiekt jest zaznaczony na liście rozwijanej w oknie dialogowym właściwości.)</span><span class="sxs-lookup"><span data-stu-id="b01db-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="b01db-332">[![TableAdapter ma element InsertCommand, elementu UpdateCommand i właściwości elementu DeleteCommand](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="b01db-333">**Ilustracja 23**: TableAdapter ma **element InsertCommand**, **elementu UpdateCommand**, i **elementu DeleteCommand** właściwości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="b01db-334">Aby przejrzeć lub zmodyfikować dowolne z tych właściwości polecenia bazy danych, kliknij pozycję **CommandText** właściwości podrzędnej, co umożliwi wyświetlenie konstruktora zapytań.</span><span class="sxs-lookup"><span data-stu-id="b01db-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="b01db-335">[![Konfigurowanie INSERT, UPDATE i DELETE instrukcji w Konstruktorze zapytań](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="b01db-336">**Rysunek 24**: Konfigurowanie **Wstaw**, **aktualizacji**, i **Usuń** instrukcji w Konstruktorze zapytań ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="b01db-337">Poniższy przykład kodu pokazuje, jak użyć wzorca aktualizacji wsadowych dwukrotnie ceny wszystkich produktów, które nie są przerywane i mają 25 jednostek w magazynie lub mniej:</span><span class="sxs-lookup"><span data-stu-id="b01db-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="b01db-338">Poniższy kod ilustruje sposób użyć wzorca bezpośrednie DB programowo usunąć określonego produktu, a następnie zaktualizować co, a następnie dodaj nowy:</span><span class="sxs-lookup"><span data-stu-id="b01db-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="b01db-339">Tworzenie niestandardowego wstawiania, aktualizowania i usuwania metod</span><span class="sxs-lookup"><span data-stu-id="b01db-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="b01db-340">**Insert()**, **Update()**, i **Delete()** metody tworzone przez metodę bezpośrednie bazy danych może być nieco uciążliwe, szczególnie w przypadku tabel z wieloma kolumnami.</span><span class="sxs-lookup"><span data-stu-id="b01db-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="b01db-341">Wyszukiwanie w poprzednim przykładzie kodu bez funkcji IntelliSense w pomocy, nie jest szczególnie jasne co **produktów** mapuje kolumną tabeli każdego parametru wejściowego **Update()** i **Insert()**  metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="b01db-342">Mogą wystąpić sytuacje, kiedy ma być uruchamiany tylko zaktualizować pojedynczej kolumny lub dwóch, lub ma dostosowany **Insert()** metodę, która będzie, zwróć wartość rekordu nowo wstawionej **tożsamości** (automatycznego przyrostu) pole.</span><span class="sxs-lookup"><span data-stu-id="b01db-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="b01db-343">Aby utworzyć niestandardową metodę, wróć do Projektanta obiektów DataSet.</span><span class="sxs-lookup"><span data-stu-id="b01db-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="b01db-344">Kliknij prawym przyciskiem myszy na obiekt TableAdapter i wybierz polecenie Dodaj zapytanie powrotu do kreatora TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="b01db-345">Na drugim ekranie firma Microsoft może wskazywać typ zapytanie w celu utworzenia.</span><span class="sxs-lookup"><span data-stu-id="b01db-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="b01db-346">Utwórzmy metodę, która dodaje nowy produkt, a następnie zwraca wartość nowo dodanego rekordu **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="b01db-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="b01db-347">W związku z tym, wybrać opcję utworzenia **Wstaw** zapytania.</span><span class="sxs-lookup"><span data-stu-id="b01db-347">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="b01db-348">[![Utwórz metodę, aby dodać nowy wiersz do tabeli Produkty](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="b01db-349">**Rysunek 25**: Utwórz metodę, aby dodać nowy wiersz do **produktów** tabeli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="b01db-350">Na następnym ekranie **element InsertCommand**firmy **CommandText** pojawia się.</span><span class="sxs-lookup"><span data-stu-id="b01db-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="b01db-351">Rozszerzaj tego zapytania, dodając **wybierz zakres\_IDENTITY()** na końcu zapytania, co spowoduje zwrócenie ostatnią wartość tożsamości wstawiony **tożsamości** kolumny w tym samym zakresie.</span><span class="sxs-lookup"><span data-stu-id="b01db-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="b01db-352">(Zobacz [dokumentacji technicznej](https://msdn.microsoft.com/library/ms190315.aspx) Aby uzyskać więcej informacji na temat **zakres\_IDENTITY()** i dlaczego warto [Użyj zakresu\_IDENTITY() proceduralny @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Upewnij się, że końcowy **Wstaw** instrukcji za pomocą średnika przed dodaniem **wybierz** instrukcji.</span><span class="sxs-lookup"><span data-stu-id="b01db-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="b01db-353">[![Zapytanie, aby zwrócić wartość SCOPE_IDENTITY() rozszerzyć](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="b01db-354">**Rysunek 26**: Rozszerzyć zapytania do zwrócenia **zakres\_IDENTITY()** wartość ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="b01db-355">Na koniec, nadaj nazwę nowej metody **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="b01db-355">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="b01db-356">[![Ustaw nową nazwę metody InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="b01db-357">**Rysunek 27**: Ustaw nową nazwę metody **InsertProduct** ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="b01db-358">Po powrocie do Projektanta obiektów DataSet, zobaczysz **ProductsTableAdapter** zawiera nową metodę **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="b01db-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="b01db-359">Jeśli ta nowa metoda nie ma parametrów dla każdej kolumny w **produktów** tabeli, prawdopodobnie, że nie można zakończyć **Wstaw** instrukcji za pomocą średnika.</span><span class="sxs-lookup"><span data-stu-id="b01db-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="b01db-360">Konfigurowanie **InsertProduct** metody i upewnij się, że rozdzielający je średnikiem **Wstaw** i **wybierz** instrukcji.</span><span class="sxs-lookup"><span data-stu-id="b01db-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="b01db-361">Domyślnie Wstaw metody problem niebędącą zapytaniem metod, co oznacza, że zwracają one liczbę wierszy dotyczy.</span><span class="sxs-lookup"><span data-stu-id="b01db-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="b01db-362">Jednakże, chcemy **InsertProduct** metodę, aby zwrócić wartości zwracanej przez zapytanie, nie liczbę uwzględnionych wierszy.</span><span class="sxs-lookup"><span data-stu-id="b01db-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="b01db-363">Aby to osiągnąć, należy dostosować **InsertProduct** metody **tryb ExecuteMode** właściwości **skalarną**.</span><span class="sxs-lookup"><span data-stu-id="b01db-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="b01db-364">[![Zmień tryb ExecuteMode właściwość skalarną](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="b01db-365">**Rysunek 28**: Zmiana **tryb ExecuteMode** właściwości **skalarną** ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="b01db-366">Poniższy kod przedstawia nowy **InsertProduct** metody w akcji:</span><span class="sxs-lookup"><span data-stu-id="b01db-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="b01db-367">Krok 5. Korzystanie z warstwy dostępu do danych</span><span class="sxs-lookup"><span data-stu-id="b01db-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="b01db-368">Należy pamiętać, że **ProductsTableAdapters** klasy zwraca **CategoryID** i **IDDostawcy** wartości z kolekcji **produktów** tabeli, ale nie obejmuje **CategoryName** kolumny z **kategorie** tabeli lub **CompanyName** kolumny z **dostawców**tabeli, mimo że prawdopodobnie są kolumn, firma Microsoft ma być wyświetlana, gdy są wyświetlane informacje o produkcie.</span><span class="sxs-lookup"><span data-stu-id="b01db-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="b01db-369">Firma Microsoft może rozszerzyć początkowe metody TableAdapter, **GetProducts()**, aby uwzględnić obie **CategoryName** i **CompanyName** wartości kolumny, które zostaną zaktualizowane silnie typizowane DataTable, aby uwzględnić te nowe kolumny.</span><span class="sxs-lookup"><span data-stu-id="b01db-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="b01db-370">Może to spowodować problem, jednak jako metody TableAdapter do wstawiania, aktualizowania, i usuwanie danych opierają się poza tym metodę początkowej.</span><span class="sxs-lookup"><span data-stu-id="b01db-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="b01db-371">Na szczęście metody generowane automatycznie dla Wstawianie, aktualizowanie i usuwanie, nie są wpływ podzapytań w **wybierz** klauzuli.</span><span class="sxs-lookup"><span data-stu-id="b01db-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="b01db-372">Zwracając szczególną uwagę na naszych zapytania, aby dodać **kategorie** i **dostawców** jako podzapytań, zamiast **Dołącz** s, firma Microsoft będzie uniknąć konieczności przerabiać tych metod do modyfikowania danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="b01db-373">Kliknij prawym przyciskiem myszy **GetProducts()** method in Class metoda **ProductsTableAdapter** i wybierz opcję Konfiguruj.</span><span class="sxs-lookup"><span data-stu-id="b01db-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="b01db-374">Następnie Dostosuj **wybierz** klauzuli tak, aby wyglądał jak:</span><span class="sxs-lookup"><span data-stu-id="b01db-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="b01db-375">[![Aktualizacja instrukcji SELECT w metodzie GetProducts()](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="b01db-376">**Rysunek 29**: Aktualizacja **wybierz** poufności informacji dotyczące **GetProducts()** — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="b01db-377">Po zaktualizowaniu **GetProducts()** metodę, aby użyć tego nowego zapytania DataTable będzie zawierać dwie nowe kolumny: **CategoryName** i **NazwaDostawcy**.</span><span class="sxs-lookup"><span data-stu-id="b01db-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![DataTable produktów ma dwie nowe kolumny](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="b01db-379">**30 rysunek**: **Produktów** DataTable ma dwie nowe kolumny</span><span class="sxs-lookup"><span data-stu-id="b01db-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="b01db-380">Poświęć chwilę, aby zaktualizować **wybierz** w klauzuli **GetProductsByCategoryID (*categoryID*)** również metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="b01db-381">Jeśli zaktualizujesz **GetProducts()** **wybierz** przy użyciu **Dołącz** składni Projektanta obiektów DataSet nie będzie można automatycznie wygenerować metod wstawiania, aktualizowania i usuwania dane bazy danych przy użyciu wzorca bezpośrednie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="b01db-382">Zamiast tego należy ręcznie utworzyć je podobnie jak postępowanie z **InsertProduct** metoda we wcześniejszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="b01db-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="b01db-383">Ponadto ręcznie musisz podać **element InsertCommand**, **elementu UpdateCommand**, i **elementu DeleteCommand** wartości właściwości, jeśli chcesz używać usługi batch, aktualizowanie wzorca.</span><span class="sxs-lookup"><span data-stu-id="b01db-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="b01db-384">Dodawanie pozostałych TableAdapters</span><span class="sxs-lookup"><span data-stu-id="b01db-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="b01db-385">Pory tylko Opisaliśmy Praca z pojedynczy obiekt TableAdapter dla tabeli pojedynczej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="b01db-386">Jednak bazy danych Northwind zawiera kilka powiązanych tabel, które musisz pracować w naszej aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="b01db-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="b01db-387">Wpisany zestaw danych może zawierać wiele powiązanych DataTables.</span><span class="sxs-lookup"><span data-stu-id="b01db-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="b01db-388">W związku z tym aby ukończyć nasze warstwy DAL musimy dodać DataTable dla tabel, który będzie używany w tych samouczkach.</span><span class="sxs-lookup"><span data-stu-id="b01db-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="b01db-389">Aby dodać nowy obiekt TableAdapter wpisana zestawu danych, Otwórz Projektanta obiektów DataSet, kliknij prawym przyciskiem myszy w Projektancie i wybierz pozycję Dodaj / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="b01db-390">Spowoduje to utworzenie nowego elementu DataTable i TableAdapter i przeprowadzą Cię przez kreatora, który zbadaliśmy we wcześniejszej części tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="b01db-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="b01db-391">Potrwać kilka minut, aby utworzyć następujące TableAdapters i metod za pomocą następujących zapytań.</span><span class="sxs-lookup"><span data-stu-id="b01db-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="b01db-392">Należy pamiętać, że zapytania w **ProductsTableAdapter** obejmują podzapytania do pobrania nazwy kategorii i dostawcy każdego produktu.</span><span class="sxs-lookup"><span data-stu-id="b01db-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="b01db-393">Ponadto jeśli wykonywano, dodano już **ProductsTableAdapter** klasy **GetProducts()** i **GetProductsByCategoryID (*categoryID\* )*\* metody.</span><span class="sxs-lookup"><span data-stu-id="b01db-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="b01db-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="b01db-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="b01db-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="b01db-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="b01db-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="b01db-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="b01db-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="b01db-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="b01db-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="b01db-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="b01db-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="b01db-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="b01db-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="b01db-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="b01db-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="b01db-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="b01db-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="b01db-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="b01db-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="b01db-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="b01db-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="b01db-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="b01db-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="b01db-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="b01db-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="b01db-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="b01db-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="b01db-410">[![Projektant obiektów DataSet, po dodaniu cztery TableAdapters](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="b01db-411">**Rysunek 31**: Zestaw danych projektanta po czterech TableAdapters dodano ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="b01db-412">Dodawanie niestandardowego kodu do warstwy DAL</span><span class="sxs-lookup"><span data-stu-id="b01db-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="b01db-413">TableAdapters i dodane do obiektu DataSet wpisane DataTable są wyrażane jako plik definicji schematu XML (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="b01db-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="b01db-414">Te informacje schematu można wyświetlić, klikając prawym przyciskiem myszy **Northwind.xsd** plików w Eksploratorze rozwiązań i wybierając polecenie Pokaż kod.</span><span class="sxs-lookup"><span data-stu-id="b01db-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="b01db-415">[![Plik (XSD) definicji schematu XML dla Northwinds Typizowany zestaw danych](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="b01db-416">**Ilustracja 32**: Plik definicji schematu XML (XSD) dla zestawu danych wpisane Northwinds ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="b01db-417">Informacje o schemacie jest tłumaczona na kod C# lub Visual Basic w czasie projektowania, podczas kompilowania lub w czasie wykonywania (w razie potrzeby), w tym momencie możesz przejrzeć go za pomocą debugera.</span><span class="sxs-lookup"><span data-stu-id="b01db-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="b01db-418">Aby wyświetlić ten kod wygenerowany automatycznie przejdź do widoku klas i testowania odzyskiwania po awarii w dół do klasy TableAdapter lub wpisana zestawu danych.</span><span class="sxs-lookup"><span data-stu-id="b01db-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="b01db-419">Jeśli nie widzisz widoku klasy na ekranie, przejdź do menu widoku i wybierz go z tego miejsca lub naciśnij klawisze Ctrl + Shift + C.</span><span class="sxs-lookup"><span data-stu-id="b01db-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="b01db-420">W widoku klasy widać, właściwości, metod i zdarzeń klasy wpisany zestaw danych i TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="b01db-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="b01db-421">Aby wyświetlić kod dla konkretnej metody, kliknij dwukrotnie nazwę metody w widoku klas lub kliknij prawym przyciskiem myszy na nim, a następnie wybierz Przejdź do definicji.</span><span class="sxs-lookup"><span data-stu-id="b01db-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Sprawdź kod wygenerowany automatycznie po wybraniu polecenia przejdź do definicji z widoku klasy](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="b01db-423">**Ilustracja 33**: Sprawdź kod wygenerowany automatycznie po wybraniu polecenia przejdź do definicji z widoku klasy</span><span class="sxs-lookup"><span data-stu-id="b01db-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="b01db-424">Automatycznie wygenerowany kod może być wygaszacz doskonały moment, kod jest często bardzo ogólny i musi być dostosowane do spełnianie unikatowych potrzeb aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="b01db-425">Ryzyko rozszerzanie automatycznie wygenerowany kod jest jednak, że narzędzia, który wygenerował kod zdecydować, że nadszedł czas na "wygenerować ponownie", a następnie zastąpić dostosowania.</span><span class="sxs-lookup"><span data-stu-id="b01db-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="b01db-426">Za pomocą nowej koncepcji częściowej klasy .NET 2.0 jest łatwe do podział klasy na wiele plików.</span><span class="sxs-lookup"><span data-stu-id="b01db-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="b01db-427">Pozwala to nam dodać własne metody, właściwości i zdarzenia do automatycznie generowanej klasy bez konieczności martwienia się o programie Visual Studio, zastępując naszych dostosowania.</span><span class="sxs-lookup"><span data-stu-id="b01db-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="b01db-428">Aby zademonstrować sposobu dostosowywania warstwy DAL, dodamy **GetProducts()** metody **SuppliersRow** klasy.</span><span class="sxs-lookup"><span data-stu-id="b01db-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="b01db-429">**SuppliersRow** klasa reprezentuje pojedynczy rekord w **dostawców** Tabela; każdy dostawca może dostawca zero do wielu produktów, dzięki czemu **GetProducts()** zwróci te produkty określonego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="b01db-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="b01db-430">Aby wykonać to utworzenie nowego pliku klasy w **aplikacji\_kodu** folder o nazwie **SuppliersRow.cs** i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="b01db-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="b01db-431">Tej klasy częściowej instruuje kompilator, że w przypadku tworzenia **Northwind.SuppliersRow** klasy, aby uwzględnić **GetProducts()** metoda po prostu zdefiniowana.</span><span class="sxs-lookup"><span data-stu-id="b01db-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="b01db-432">Jeśli skompilowanie projektu, a następnie powróć do widoku klas zobaczysz **GetProducts()** teraz wymienione jako metoda **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="b01db-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![Metoda GetProducts() jest teraz częścią klasy Northwind.SuppliersRow](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="b01db-434">**Ilustracja 34**: **GetProducts()** metody jest teraz częścią **Northwind.SuppliersRow** klasy</span><span class="sxs-lookup"><span data-stu-id="b01db-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="b01db-435">**GetProducts()** metoda teraz może służyć do wyliczenia zestaw produktów dla określonego dostawcy, co ilustruje poniższy kod:</span><span class="sxs-lookup"><span data-stu-id="b01db-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="b01db-436">Dane te mogą także wyświetlane w dowolnej ASP. Dane firmy NET kontrolki sieci Web.</span><span class="sxs-lookup"><span data-stu-id="b01db-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="b01db-437">Następująca strona używa kontrolki widoku siatki z dwóch pól:</span><span class="sxs-lookup"><span data-stu-id="b01db-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="b01db-438">Wyświetla nazwę każdego z dostawców elementu BoundField i</span><span class="sxs-lookup"><span data-stu-id="b01db-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="b01db-439">TemplateField, który zawiera formant BulletedList, który jest powiązany z wyników zwróconych przez **GetProducts()** metody dla każdego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="b01db-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="b01db-440">Zajmiemy się sposób wyświetlania tych raportów wzorzec / szczegół w przyszłości samouczki.</span><span class="sxs-lookup"><span data-stu-id="b01db-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="b01db-441">Teraz, w tym przykładzie zaprojektowano w celu zilustrowania przy użyciu metody niestandardowe dodane do **Northwind.SuppliersRow** klasy.</span><span class="sxs-lookup"><span data-stu-id="b01db-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="b01db-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="b01db-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="b01db-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="b01db-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="b01db-444">[![Nazwa firmy dostawcy jest wyświetlana w kolumnie po lewej stronie, a ich produktów w prawo](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="b01db-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="b01db-445">**Ilustracja 35**: Nazwa firmy dostawcy jest wyświetlana w kolumnie po lewej stronie, a ich produktów w prawo ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="b01db-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b01db-446">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b01db-446">Summary</span></span>

<span data-ttu-id="b01db-447">Podczas tworzenia aplikacji sieci web, tworzenia warstwy DAL powinien być jednym z w ramach pierwszych kroków występuje przed rozpoczęciem tworzenia warstwą prezentacji.</span><span class="sxs-lookup"><span data-stu-id="b01db-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="b01db-448">Za pomocą programu Visual Studio tworzenie DAL, w oparciu o wpisanych zestawów danych jest zadanie, które można wykonywać w 10 – 15 minut bez konieczności pisania nawet wiersza kodu.</span><span class="sxs-lookup"><span data-stu-id="b01db-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="b01db-449">Samouczki, przenoszenie do przodu zostanie bazują na tym warstwy DAL.</span><span class="sxs-lookup"><span data-stu-id="b01db-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="b01db-450">W [następnego samouczka](creating-a-business-logic-layer-cs.md) utworzymy zdefiniować liczbę reguł biznesowych i zobacz, jak wdrożyć je w oddzielne warstwy logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="b01db-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="b01db-451">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="b01db-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="b01db-452">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="b01db-452">Further Reading</span></span>

<span data-ttu-id="b01db-453">Więcej informacji na tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="b01db-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b01db-454">Tworzenie warstwy, za pomocą silnie Typizowane TableAdapters i DataTable w programie VS 2005 i programu ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="b01db-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="b01db-455">Projektowanie składników warstwy danych i przekazywanie danych za pomocą warstw</span><span class="sxs-lookup"><span data-stu-id="b01db-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="b01db-456">Tworzenie warstwy dostępu do danych, za pomocą Projektanta obiektów DataSet 2005 Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b01db-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="b01db-457">Szyfrowanie informacji o konfiguracji w programie ASP.NET 2.0 aplikacji</span><span class="sxs-lookup"><span data-stu-id="b01db-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="b01db-458">TableAdapter — Przegląd</span><span class="sxs-lookup"><span data-stu-id="b01db-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="b01db-459">Praca z Typizowany zestaw danych</span><span class="sxs-lookup"><span data-stu-id="b01db-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="b01db-460">Przy użyciu dostępu do silnie Typizowanych danych w programie Visual Studio 2005 i platformy ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="b01db-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="b01db-461">Jak rozszerzyć metody TableAdapter</span><span class="sxs-lookup"><span data-stu-id="b01db-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="b01db-462">Pobieranie danych skalarną z procedury składowanej</span><span class="sxs-lookup"><span data-stu-id="b01db-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="b01db-463">Szkolenie wideo na tematy zawarte w tym samouczku</span><span class="sxs-lookup"><span data-stu-id="b01db-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="b01db-464">Warstwy dostępu do danych w aplikacjach ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b01db-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="b01db-465">Jak ręcznie powiązanie zestawu danych z elementem Datagrid</span><span class="sxs-lookup"><span data-stu-id="b01db-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="b01db-466">Jak pracować z zestawami danych i filtrami aplikacji ASP</span><span class="sxs-lookup"><span data-stu-id="b01db-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="b01db-467">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="b01db-467">About the Author</span></span>

<span data-ttu-id="b01db-468">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="b01db-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b01db-469">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="b01db-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b01db-470">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b01db-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b01db-471">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b01db-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b01db-472">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b01db-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b01db-473">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="b01db-473">Special Thanks To</span></span>

<span data-ttu-id="b01db-474">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="b01db-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b01db-475">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Piotr zielony, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez i Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="b01db-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="b01db-476">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="b01db-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b01db-477">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b01db-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="b01db-478">Next</span><span class="sxs-lookup"><span data-stu-id="b01db-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
