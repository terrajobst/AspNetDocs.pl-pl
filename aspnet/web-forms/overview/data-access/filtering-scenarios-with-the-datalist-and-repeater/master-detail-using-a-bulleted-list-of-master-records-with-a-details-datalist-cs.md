---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
title: Wzorzec/Szczegóły przy użyciu listy punktowanej rekordów głównych z szczegółami DataList (C#) | Microsoft Docs
author: rick-anderson
description: W tym samouczku będziemy kompresować raport wzorzec/szczegóły dwóch stron z poprzedniego samouczka do jednej strony, pokazując listę punktowaną nazw kategorii w t...
ms.author: riande
ms.date: 10/17/2006
ms.assetid: c727bb73-7b59-41a1-8dc3-623c6d69e7c2
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: 4549ab8e64599b09c300c158bedfd5d85efafc4d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78606282"
---
# <a name="masterdetail-using-a-bulleted-list-of-master-records-with-a-details-datalist-c"></a><span data-ttu-id="2adbd-103">Formularz rekord główny/szczegóły korzystający z listy punktowanej rekordów głównych z kontrolką DataList szczegółów (C#)</span><span class="sxs-lookup"><span data-stu-id="2adbd-103">Master/Detail Using a Bulleted List of Master Records with a Details DataList (C#)</span></span>

<span data-ttu-id="2adbd-104">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2adbd-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2adbd-105">[Pobierz przykładową aplikację](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe) lub [Pobierz plik PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2adbd-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe) or [Download PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span></span>

> <span data-ttu-id="2adbd-106">W tym samouczku będziemy kompresować raport wzorzec/szczegóły dwóch stron z poprzedniego samouczka do pojedynczej strony, pokazując listę punktowaną z nazwami kategorii po lewej stronie ekranu i produkty wybranej kategorii z prawej strony ekranu.</span><span class="sxs-lookup"><span data-stu-id="2adbd-106">In this tutorial we'll compress the two-page master/detail report of the previous tutorial into a single page, showing a bulleted list of category names on the left side of the screen and the selected category's products on the right of the screen.</span></span>

## <a name="introduction"></a><span data-ttu-id="2adbd-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="2adbd-107">Introduction</span></span>

<span data-ttu-id="2adbd-108">W [poprzednim samouczku](master-detail-filtering-acess-two-pages-datalist-cs.md) pokazano, jak rozdzielić Raport główny/szczegółowy na dwie strony.</span><span class="sxs-lookup"><span data-stu-id="2adbd-108">In the [preceding tutorial](master-detail-filtering-acess-two-pages-datalist-cs.md) we looked at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="2adbd-109">Na stronie wzorcowej użyto kontrolki wzmacniak do renderowania listy punktowanej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-109">In the master page we used a Repeater control to render a bulleted list of categories.</span></span> <span data-ttu-id="2adbd-110">Każda nazwa kategorii była hiperłączem, które po kliknięciu spowoduje przełączenie go do strony szczegółów, gdzie dwie kolumny DataList wskazują te produkty należące do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-110">Each category name was a hyperlink that, when clicked, would take the user to the details page, where a two-column DataList showed those products belonging to the selected category.</span></span>

<span data-ttu-id="2adbd-111">W tym samouczku będziemy kompresować samouczek dwustronicowy do jednej strony, pokazując listę punktowaną nazw kategorii po lewej stronie ekranu z każdą nazwą kategorii renderowaną jako element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="2adbd-111">In this tutorial we'll compress the two-page tutorial into a single page, showing a bulleted list of category names on the left side of the screen with each category name rendered as a LinkButton.</span></span> <span data-ttu-id="2adbd-112">Kliknięcie jednej z nazw kategorii LinkButtons wywołuje ogłaszanie zwrotne i wiąże wybrane produkty kategorii s z dwiema kolumnami DataList po prawej stronie ekranu.</span><span class="sxs-lookup"><span data-stu-id="2adbd-112">Clicking one of the category name LinkButtons induces a postback and binds the selected category s products to a two-column DataList on the right of the screen.</span></span> <span data-ttu-id="2adbd-113">Oprócz wyświetlania każdej kategorii, wzmacniak po lewej stronie pokazuje, ile łącznych produktów istnieje dla danej kategorii (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="2adbd-113">In addition to displaying each category s name, the Repeater on the left shows how many total products there are for a given category (see Figure 1).</span></span>

<span data-ttu-id="2adbd-114">[![nazwa kategorii i całkowita liczba produktów są wyświetlane po lewej stronie](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-114">[![The Category s Name and Total Number of Products are Displayed on the Left](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span></span>

<span data-ttu-id="2adbd-115">**Rysunek 1**: Nazwa kategorii i łączna liczba produktów są wyświetlane po lewej stronie ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-115">**Figure 1**: The Category s Name and Total Number of Products are Displayed on the Left ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span></span>

## <a name="step-1-displaying-a-repeater-in-the-left-portion-of-the-screen"></a><span data-ttu-id="2adbd-116">Krok 1. Wyświetlanie Wzmacniakka w lewej części ekranu</span><span class="sxs-lookup"><span data-stu-id="2adbd-116">Step 1: Displaying a Repeater in the Left Portion of the Screen</span></span>

<span data-ttu-id="2adbd-117">W tym samouczku musimy znajdować się lista punktowana kategorii z lewej strony wybranych produktów kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-117">For this tutorial we need to have the bulleted list of categories appear to the left of the selected category s products.</span></span> <span data-ttu-id="2adbd-118">Zawartość na stronie sieci Web można umieścić przy użyciu standardowych tagów akapitu w języku HTML, spacji rozmieszczonych, `<table>` s itd. lub za pośrednictwem technik kaskadowych arkuszy stylów (CSS).</span><span class="sxs-lookup"><span data-stu-id="2adbd-118">Content within a web page can be positioned using standard HTML elements paragraph tags, non-breaking spaces, `<table>` s, and so on or through cascading stylesheet (CSS) techniques.</span></span> <span data-ttu-id="2adbd-119">We wszystkich naszych samouczkach użyto technik CSS do pozycjonowania.</span><span class="sxs-lookup"><span data-stu-id="2adbd-119">All of our tutorials thus far have used CSS techniques for positioning.</span></span> <span data-ttu-id="2adbd-120">Po skompilowaniu interfejsu użytkownika nawigacji na naszej stronie wzorcowej na [stronach wzorcowych i](../introduction/master-pages-and-site-navigation-cs.md) w samouczku nawigacji witryny użyto *pozycjonowania bezwzględnego*, wskazując dokładne przesunięcie pikseli dla listy nawigacji i głównej zawartości.</span><span class="sxs-lookup"><span data-stu-id="2adbd-120">When we built the navigation user interface in our master page in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-cs.md) tutorial we used *absolute positioning*, indicating the precise pixel offset for the navigation list and the main content.</span></span> <span data-ttu-id="2adbd-121">Alternatywnie można użyć CSS do pozycjonowania jednego elementu w prawo lub w lewo od drugiego za pomocą wartości *zmiennoprzecinkowych*.</span><span class="sxs-lookup"><span data-stu-id="2adbd-121">Alternatively, CSS can be used to position one element to the right or left of another through *floating*.</span></span> <span data-ttu-id="2adbd-122">Lista punktowana kategorii pojawia się po lewej stronie wybranych produktów kategorii, przez przepływający wzmacniak z lewej strony elementu DataList</span><span class="sxs-lookup"><span data-stu-id="2adbd-122">We can have the bulleted list of categories appear to the left of the selected category s products by floating the Repeater to the left of the DataList</span></span>

<span data-ttu-id="2adbd-123">Otwórz stronę `CategoriesAndProducts.aspx` z folderu `DataListRepeaterFiltering` i Dodaj do strony jako wzmacniak i element DataList.</span><span class="sxs-lookup"><span data-stu-id="2adbd-123">Open the `CategoriesAndProducts.aspx` page from the `DataListRepeaterFiltering` folder and add to the page a Repeater and a DataList.</span></span> <span data-ttu-id="2adbd-124">Ustaw `ID` wzmacniak `Categories` i elementu DataList s, aby `CategoryProducts`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-124">Set the Repeater s `ID` to `Categories` and the DataList s to `CategoryProducts`.</span></span> <span data-ttu-id="2adbd-125">Przejdź do widoku źródła i umieść kontrolki wzmacniak i DataList we własnym `<div>` elementów.</span><span class="sxs-lookup"><span data-stu-id="2adbd-125">Go to the Source view and put the Repeater and DataList controls within their own `<div>` elements.</span></span> <span data-ttu-id="2adbd-126">Oznacza to, że najpierw należy umieścić wzmacniak w obrębie elementu `<div>`, a następnie element DataList we własnym elemencie `<div>` bezpośrednio po Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-126">That is, enclose the Repeater within a `<div>` element first and then the DataList in its own `<div>` element directly after the Repeater.</span></span> <span data-ttu-id="2adbd-127">Twoje znaczniki powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="2adbd-127">Your markup at this point should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample1.aspx)]

<span data-ttu-id="2adbd-128">Aby przestawić wzmacniak z lewej strony DataList, musimy użyć atrybutu stylu CSS `float`, takiego jak:</span><span class="sxs-lookup"><span data-stu-id="2adbd-128">To float the Repeater to the left of the DataList, we need to use the `float` CSS style attribute, like so:</span></span>

[!code-html[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample2.html)]

<span data-ttu-id="2adbd-129">`float: left;` powoduje przepływanie pierwszego elementu `<div>` z lewej strony drugiego.</span><span class="sxs-lookup"><span data-stu-id="2adbd-129">The `float: left;` floats the first `<div>` element to the left of the second one.</span></span> <span data-ttu-id="2adbd-130">Ustawienia `width` i `padding-right` wskazują pierwsze `<div>` s `width` i ilość dopełnienia między `<div>` zawartości elementu a jego prawego marginesu.</span><span class="sxs-lookup"><span data-stu-id="2adbd-130">The `width` and `padding-right` settings indicate the first `<div>` s `width` and how much padding is added between the `<div>` element s content and its right margin.</span></span> <span data-ttu-id="2adbd-131">Aby uzyskać więcej informacji na temat elementów zmiennoprzecinkowych w CSS, zapoznaj się z [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span><span class="sxs-lookup"><span data-stu-id="2adbd-131">For more information on floating elements in CSS check out the [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span></span>

<span data-ttu-id="2adbd-132">Zamiast określać ustawienie stylu bezpośrednio przy użyciu pierwszego `<p>` atrybutu `style` elementu, zezwól zamiast tego utworzyć nową klasę CSS w `Styles.css` o nazwie `FloatLeft`:</span><span class="sxs-lookup"><span data-stu-id="2adbd-132">Rather than specify the style setting directly through the first `<p>` element s `style` attribute, let s instead create a new CSS class in `Styles.css` named `FloatLeft`:</span></span>

[!code-css[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample3.css)]

<span data-ttu-id="2adbd-133">Następnie możemy zastąpić `<div>` z `<div class="FloatLeft">`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-133">Then we can replace the `<div>` with `<div class="FloatLeft">`.</span></span>

<span data-ttu-id="2adbd-134">Po dodaniu klasy CSS i skonfigurowaniu znaczników na stronie `CategoriesAndProducts.aspx` przejdź do projektanta.</span><span class="sxs-lookup"><span data-stu-id="2adbd-134">After adding the CSS class and configuring the markup in the `CategoriesAndProducts.aspx` page, go to the Designer.</span></span> <span data-ttu-id="2adbd-135">Powinieneś zobaczyć, że wzmacniak jest przepływany po lewej stronie elementu DataList (mimo że teraz po prostu pojawiają się szare pola, ponieważ jeszcze nie skonfigurowano ich źródeł danych lub szablonów).</span><span class="sxs-lookup"><span data-stu-id="2adbd-135">You should see the Repeater floating to the left of the DataList (although right now both just appear as gray boxes since we ve yet to configure their data sources or templates).</span></span>

<span data-ttu-id="2adbd-136">[![wzmacniak jest przestawiony z lewej strony elementu DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-136">[![The Repeater is Floated to the Left of the DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span></span>

<span data-ttu-id="2adbd-137">**Rysunek 2**. wzmacniak jest przepływany po lewej stronie elementu DataList ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-137">**Figure 2**: The Repeater is Floated to the Left of the DataList ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span></span>

## <a name="step-2-determining-the-number-of-products-for-each-category"></a><span data-ttu-id="2adbd-138">Krok 2. Określanie liczby produktów dla każdej kategorii</span><span class="sxs-lookup"><span data-stu-id="2adbd-138">Step 2: Determining the Number of Products for Each Category</span></span>

<span data-ttu-id="2adbd-139">Po zakończeniu adiustacji z Wzmacniaką i elementem DataList s, wszystko gotowe do powiązania danych kategorii z formantem wzmacniania.</span><span class="sxs-lookup"><span data-stu-id="2adbd-139">With the Repeater and DataList s surrounding markup complete, we re ready to bind the category data to the Repeater control.</span></span> <span data-ttu-id="2adbd-140">Jednak jako lista punktowana kategorii na rysunku 1 pokazuje, oprócz nazw kategorii s, należy również wyświetlić liczbę produktów skojarzonych z kategorią.</span><span class="sxs-lookup"><span data-stu-id="2adbd-140">However, as the bulleted list of categories in Figure 1 shows, in addition to each category s name we also need to display the number of products associated with the category.</span></span> <span data-ttu-id="2adbd-141">Aby uzyskać dostęp do tych informacji, możemy:</span><span class="sxs-lookup"><span data-stu-id="2adbd-141">To access this information we can either:</span></span>

- <span data-ttu-id="2adbd-142">**Należy określić te informacje z klasy ASP.NET strony powiązanej z kodem.**</span><span class="sxs-lookup"><span data-stu-id="2adbd-142">**Determine this information from the ASP.NET page s code-behind class.**</span></span> <span data-ttu-id="2adbd-143">Mając określoną *`categoryID`* , możemy określić liczbę skojarzonych produktów, wywołując metodę `ProductsBLL` klasy s `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-143">Given a particular *`categoryID`* we can determine the number of associated products by calling the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="2adbd-144">Ta metoda zwraca obiekt `ProductsDataTable`, którego właściwość `Count` wskazuje, ile `ProductsRow` s istnieje, czyli liczbę produktów dla określonego *`categoryID`* .</span><span class="sxs-lookup"><span data-stu-id="2adbd-144">This method returns a `ProductsDataTable` object whose `Count` property indicates how many `ProductsRow` s exists, which is the number of products for the specified *`categoryID`*.</span></span> <span data-ttu-id="2adbd-145">Możemy utworzyć procedurę obsługi zdarzeń `ItemDataBound` dla wzmacniak, która dla każdej kategorii powiązanej z wzmacniak wywoła metodę `ProductsBLL` klasy s `GetProductsByCategoryID(categoryID)` i zawiera jej liczbę w danych wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-145">We can create an `ItemDataBound` event handler for the Repeater that, for each category bound to the Repeater, calls the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and includes its count in the output.</span></span>
- <span data-ttu-id="2adbd-146">**Zaktualizuj `CategoriesDataTable` w określonym zestawie danych, aby dołączyć `NumberOfProducts` kolumnę.**</span><span class="sxs-lookup"><span data-stu-id="2adbd-146">**Update the `CategoriesDataTable` in the Typed DataSet to include a `NumberOfProducts` column.**</span></span> <span data-ttu-id="2adbd-147">Następnie możemy zaktualizować metodę `GetCategories()` w `CategoriesDataTable`, aby uwzględnić te informacje lub, Alternatywnie, pozostawić `GetCategories()` jako-is i utworzyć nową metodę `CategoriesDataTable` o nazwie `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-147">We can then update the `GetCategories()` method in the `CategoriesDataTable` to include this information or, alternatively, leave `GetCategories()` as-is and create a new `CategoriesDataTable` method called `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="2adbd-148">Poznanie obu tych technik.</span><span class="sxs-lookup"><span data-stu-id="2adbd-148">Let s explore both of these techniques.</span></span> <span data-ttu-id="2adbd-149">Pierwsze podejście jest prostsze do wdrożenia, ponieważ nie trzeba aktualizować warstwy dostępu do danych. jednak wymaga więcej komunikacji z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-149">The first approach is simpler to implement since we don t need to update the Data Access Layer; however, it requires more communications with the database.</span></span> <span data-ttu-id="2adbd-150">Wywołanie metody `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` w obsłudze zdarzeń `ItemDataBound` powoduje dodanie dodatkowego wywołania bazy danych dla każdej kategorii wyświetlanej w Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-150">The call to the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method in the `ItemDataBound` event handler adds an extra database call for each category displayed in the Repeater.</span></span> <span data-ttu-id="2adbd-151">W tej metodzie istnieją *n* + 1 wywołania bazy danych, gdzie *N* to liczba kategorii wyświetlanych w wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-151">With this technique there are *N* + 1 database calls, where *N* is the number of categories displayed in the Repeater.</span></span> <span data-ttu-id="2adbd-152">Drugim podejściem jest zwrócenie liczby produktów z informacjami o każdej kategorii z metody `CategoriesBLL` Class s `GetCategories()` (lub `GetCategoriesAndNumberOfProducts()`), co powoduje tylko jedną podróż do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-152">With the second approach, the product count is returned with information about each category from the `CategoriesBLL` class s `GetCategories()` (or `GetCategoriesAndNumberOfProducts()`) method, thereby resulting in just one trip to the database.</span></span>

## <a name="determining-the-number-of-products-in-the-itemdatabound-event-handler"></a><span data-ttu-id="2adbd-153">Określanie liczby produktów w programie obsługi zdarzeń ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="2adbd-153">Determining the Number of Products in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="2adbd-154">Określenie liczby produktów dla każdej kategorii w obsłudze zdarzeń `ItemDataBound` wzmacniak nie wymaga żadnych modyfikacji istniejącej warstwy dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-154">Determining the number of products for each category in the Repeater s `ItemDataBound` event handler does not require any modifications to our existing Data Access Layer.</span></span> <span data-ttu-id="2adbd-155">Wszystkie modyfikacje można wprowadzać bezpośrednio na stronie `CategoriesAndProducts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-155">All modifications can be made directly within the `CategoriesAndProducts.aspx` page.</span></span> <span data-ttu-id="2adbd-156">Zacznij od dodania nowego elementu ObjectDataSource o nazwie `CategoriesDataSource` za pośrednictwem tagu inteligentnego "wzmacniak s".</span><span class="sxs-lookup"><span data-stu-id="2adbd-156">Start by adding a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="2adbd-157">Następnie skonfiguruj `CategoriesDataSource` element ObjectDataSource, tak aby pobierał dane z metody `CategoriesBLL` klasy s `GetCategories()`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-157">Next, configure the `CategoriesDataSource` ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>

<span data-ttu-id="2adbd-158">[![skonfigurować element ObjectDataSource do używania metody GetCategories () klasy CategoriesBLL](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-158">[![Configure the ObjectDataSource to Use the CategoriesBLL class s GetCategories() Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span></span>

<span data-ttu-id="2adbd-159">**Rysunek 3**. Konfigurowanie elementu ObjectDataSource do używania metody `GetCategories()` `CategoriesBLL` Class (kliknij,[Aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-159">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` class s `GetCategories()` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span></span>

<span data-ttu-id="2adbd-160">Każdy element w Wzmacniake `Categories` musi być kliknięty i, po kliknięciu, spowodować, że `CategoryProducts` DataList wyświetla te produkty dla wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-160">Each item in the `Categories` Repeater needs to be clickable and, when clicked, cause the `CategoryProducts` DataList to display those products for the selected category.</span></span> <span data-ttu-id="2adbd-161">Można to zrobić, tworząc każdą kategorię hiperłącze, łącząc się z powrotem z tą samą stroną (`CategoriesAndProducts.aspx`), ale przekazując `CategoryID` za pomocą ciągu QueryString, podobnie jak pokazano w poprzednim samouczku.</span><span class="sxs-lookup"><span data-stu-id="2adbd-161">This can be accomplished by making each category a hyperlink, linking back to this same page (`CategoriesAndProducts.aspx`), but passing the `CategoryID` through the querystring, much like we saw in the previous tutorial.</span></span> <span data-ttu-id="2adbd-162">Zaletą tego podejścia jest to, że strona wyświetlająca konkretne produkty kategorii nie może być oznaczona zakładką i indeksowana przez wyszukiwarkę.</span><span class="sxs-lookup"><span data-stu-id="2adbd-162">The advantage of this approach is that a page displaying a particular category s products can be bookmarked and indexed by a search engine.</span></span>

<span data-ttu-id="2adbd-163">Alternatywnie możemy wprowadzić każdą kategorię a element LinkButton, która jest podejściem do użycia w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="2adbd-163">Alternatively, we can make each category a LinkButton, which is the approach we'll use for this tutorial.</span></span> <span data-ttu-id="2adbd-164">Element LinkButton renderuje w przeglądarce User s jako hiperłącze, ale po kliknięciu, wywołuje ogłaszanie zwrotne; na stronie ogłaszania zwrotnego element ObjectDataSource s musi zostać odświeżony, aby wyświetlić te produkty należące do wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-164">The LinkButton renders in the user s browser as a hyperlink but, when clicked, induces a postback; on postback, the DataList s ObjectDataSource needs to be refreshed to display those products belonging to the selected category.</span></span> <span data-ttu-id="2adbd-165">Na potrzeby tego samouczka użycie hiperłącza sprawia, że jest to element LinkButton; mogą jednak wystąpić inne scenariusze, w których użycie element LinkButton jest bardziej korzystne.</span><span class="sxs-lookup"><span data-stu-id="2adbd-165">For this tutorial, using a hyperlink makes more sense than using a LinkButton; however, there may be other scenarios where using a LinkButton is more advantageous.</span></span> <span data-ttu-id="2adbd-166">Mimo że podejście Hyperlink byłoby idealne dla tego przykładu, poczekaj, aż zostanie zbadane przy użyciu element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="2adbd-166">While the hyperlink approach would be ideal for this example, let s instead explore using the LinkButton.</span></span> <span data-ttu-id="2adbd-167">Jak zobaczymy, korzystanie z element LinkButton wprowadza pewne wyzwania, które w przeciwnym razie nie wystąpią z hiperłączem.</span><span class="sxs-lookup"><span data-stu-id="2adbd-167">As we'll see, using a LinkButton introduces some challenges that would not otherwise arise with a hyperlink.</span></span> <span data-ttu-id="2adbd-168">W związku z tym przy użyciu element LinkButton w tym samouczku zostaną wyróżnione te wyzwania i pomoc dotycząca rozwiązań dla tych scenariuszy, w których firma Microsoft może chcieć użyć element LinkButton zamiast hiperlinku.</span><span class="sxs-lookup"><span data-stu-id="2adbd-168">Therefore, using a LinkButton in this tutorial will highlight these challenges and help provide solutions for those scenarios where we may want to use a LinkButton instead of a hyperlink.</span></span>

> [!NOTE]
> <span data-ttu-id="2adbd-169">Zaleca się powtórzenie tego samouczka przy użyciu kontrolki HyperLink lub `<a>` elementu zamiast element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="2adbd-169">You are encouraged to repeat this tutorial using a HyperLink control or `<a>` element in lieu of the LinkButton.</span></span>

<span data-ttu-id="2adbd-170">W poniższym znaczniku przedstawiono składnię deklaratywną dla wzmacniak i element ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2adbd-170">The following markup shows the declarative syntax for the Repeater and the ObjectDataSource.</span></span> <span data-ttu-id="2adbd-171">Należy zauważyć, że szablony wzmacniak renderuje listę punktowaną z każdym elementem jako element LinkButton:</span><span class="sxs-lookup"><span data-stu-id="2adbd-171">Note that the Repeater s templates render a bulleted list with each item as a LinkButton:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="2adbd-172">W tym samouczku wzmacniak musi mieć włączony stan widoku (należy zwrócić uwagę na pominięcie `EnableViewState="False"` ze składni deklaracyjnej.</span><span class="sxs-lookup"><span data-stu-id="2adbd-172">For this tutorial the Repeater must have its view state enabled (note the omission of the `EnableViewState="False"` from the Repeater s declarative syntax).</span></span> <span data-ttu-id="2adbd-173">W kroku 3 utworzysz procedurę obsługi zdarzeń dla zdarzenia `ItemCommand`, w którym będziemy aktualizować kolekcję elementów ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-173">In step 3 we'll be creating an event handler for the Repeater s `ItemCommand` event in which we'll be updating the DataList s ObjectDataSource s `SelectParameters` collection.</span></span> <span data-ttu-id="2adbd-174">Niemniej, gdy stan widoku jest wyłączony, nie będzie on wyzwalany `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-174">The Repeater s `ItemCommand`, however, won't fire if view state is disabled.</span></span> <span data-ttu-id="2adbd-175">Aby uzyskać więcej informacji na temat sytuacji, w której stan widoku musi być włączony, aby można było uruchomić `ItemCommand`, zobacz temat [Stumper pytania ASP.NET](http://scottonwriting.net/sowblog/posts/1263.aspx) i [jego rozwiązanie](http://scottonwriting.net/sowBlog/posts/1268.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2adbd-175">See [A Stumper of an ASP.NET Question](http://scottonwriting.net/sowblog/posts/1263.aspx) and [its solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) for more information on why view state must be enabled for a Repeater s `ItemCommand` event to fire.</span></span>

<span data-ttu-id="2adbd-176">Element LinkButton z wartością właściwości `ID` `ViewCategory` nie ma ustawionej `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="2adbd-176">The LinkButton with the `ID` property value of `ViewCategory` does not have its `Text` property set.</span></span> <span data-ttu-id="2adbd-177">Jeśli udało Ci się wyświetlić nazwę kategorii, ustawimy właściwość Text w sposób deklaratywny za pomocą składni wiązania danych, na przykład:</span><span class="sxs-lookup"><span data-stu-id="2adbd-177">If we had just wanted to display the category name, we would have set the Text property declaratively, through databinding syntax, like so:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample5.aspx)]

<span data-ttu-id="2adbd-178">Jednak chcemy wyświetlić zarówno nazwę kategorii *, jak i* liczbę produktów należących do tej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-178">However, we want to show both the category s name *and* the number of products belonging to that category.</span></span> <span data-ttu-id="2adbd-179">Te informacje można pobrać z programu obsługi zdarzeń `ItemDataBound` wzmacniak, wykonując wywołanie do metody `ProductBLL` klasy s `GetCategoriesByProductID(categoryID)` i określając, ile rekordów jest zwracanych w wynikowym `ProductsDataTable`, jak ilustruje poniższy kod:</span><span class="sxs-lookup"><span data-stu-id="2adbd-179">This information can be retrieved from the Repeater s `ItemDataBound` event handler by making a call to the `ProductBLL` class s `GetCategoriesByProductID(categoryID)` method and determining how many records are returned in the resulting `ProductsDataTable`, as the following code illustrates:</span></span>

[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="2adbd-180">Firma Microsoft rozpoczyna pracę, upewniając się, że pracujemy nad elementem danych (który `ItemType` jest `Item` lub `AlternatingItem`), a następnie odwołuje się do wystąpienia `CategoriesRow`, które zostało właśnie powiązane z bieżącym `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-180">We start out by ensuring that we re working with a data item (one whose `ItemType` is `Item` or `AlternatingItem`) and then reference the `CategoriesRow` instance that has just been bound to the current `RepeaterItem`.</span></span> <span data-ttu-id="2adbd-181">Następnie określimy liczbę produktów dla tej kategorii, tworząc wystąpienie klasy `ProductsBLL`, wywołując metodę `GetCategoriesByProductID(categoryID)` i określając liczbę rekordów zwracanych przy użyciu właściwości `Count`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-181">Next, we determine the number of products for this category by creating an instance of the `ProductsBLL` class, calling its `GetCategoriesByProductID(categoryID)` method, and determining the number of records returned using the `Count` property.</span></span> <span data-ttu-id="2adbd-182">Wreszcie `ViewCategory` element LinkButton w ItemTemplate jest odwołaniem i jego właściwość `Text` jest ustawiona na *CategoryName* (*NumberOfProductsInCategory*), gdzie *NumberOfProductsInCategory* jest sformatowana jako liczba z zerowymi miejscami dziesiętnymi.</span><span class="sxs-lookup"><span data-stu-id="2adbd-182">Finally, the `ViewCategory` LinkButton in the ItemTemplate is references and its `Text` property is set to *CategoryName* (*NumberOfProductsInCategory*), where *NumberOfProductsInCategory* is formatted as a number with zero decimal places.</span></span>

> [!NOTE]
> <span data-ttu-id="2adbd-183">Alternatywnie możemy dodać *funkcję formatowania* do klasy ASP.NET strony z kodem, która akceptuje `CategoryName` i `CategoryID` wartości, i zwraca `CategoryName` połączony z liczbą produktów w kategorii (zgodnie z wywołaniem metody `GetCategoriesByProductID(categoryID)`).</span><span class="sxs-lookup"><span data-stu-id="2adbd-183">Alternatively, we could have added a *formatting function* to the ASP.NET page s code-behind class that accepts a category s `CategoryName` and `CategoryID` values and returns the `CategoryName` concatenated with the number of products in the category (as determined by calling the `GetCategoriesByProductID(categoryID)` method).</span></span> <span data-ttu-id="2adbd-184">Wyniki takiej funkcji formatowania można deklaratywnie przypisać do właściwości text element LinkButton s zastępującej potrzebę obsługi zdarzeń `ItemDataBound`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-184">The results of such a formatting function could be declaratively assigned to the LinkButton s Text property replacing the need for the `ItemDataBound` event handler.</span></span> <span data-ttu-id="2adbd-185">Aby uzyskać więcej informacji na temat korzystania z funkcji formatowania, zapoznaj się z tematem [using używanie TemplateField w formancie GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) lub [formatowaniem DataList oraz wzmacniak na podstawie](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) samouczków dotyczących danych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-185">Refer to the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) or [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) tutorials for more information on using formatting functions.</span></span>

<span data-ttu-id="2adbd-186">Po dodaniu tego programu obsługi zdarzeń Poświęć chwilę na przetestowanie strony za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="2adbd-186">After adding this event handler, take a moment to test the page through a browser.</span></span> <span data-ttu-id="2adbd-187">Zwróć uwagę na to, w jaki sposób każda kategoria jest wymieniona na liście punktowanej, wyświetlając kategorię s i liczbę produktów skojarzonych z kategorią (patrz rysunek 4).</span><span class="sxs-lookup"><span data-stu-id="2adbd-187">Note how each category is listed in a bulleted list, displaying the category s name and the number of products associated with the category (see Figure 4).</span></span>

<span data-ttu-id="2adbd-188">[zostanie wyświetlona ![każdej kategorii i liczbie produktów](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-188">[![Each Category s Name and Number of Products are Displayed](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span></span>

<span data-ttu-id="2adbd-189">**Rysunek 4**. wyświetlana jest Nazwa każdej kategorii i liczba produktów ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-189">**Figure 4**: Each Category s Name and Number of Products are Displayed ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span></span>

## <a name="updating-thecategoriesdatatableandcategoriestableadapterto-include-the-number-of-products-for-each-category"></a><span data-ttu-id="2adbd-190">Aktualizowanie`CategoriesDataTable`i`CategoriesTableAdapter`w celu uwzględnienia liczby produktów dla każdej kategorii</span><span class="sxs-lookup"><span data-stu-id="2adbd-190">Updating the`CategoriesDataTable`and`CategoriesTableAdapter`to Include the Number of Products for Each Category</span></span>

<span data-ttu-id="2adbd-191">Zamiast określania liczby produktów dla każdej kategorii jako s powiązanej z Wzmacniaką, możemy usprawnić ten proces przez dostosowanie `CategoriesDataTable` i `CategoriesTableAdapter` w warstwie dostępu do danych w celu dołączenia tych informacji natywnie.</span><span class="sxs-lookup"><span data-stu-id="2adbd-191">Rather than determining the number of products for each category as it s bound to the Repeater, we can streamline this process by adjusting the `CategoriesDataTable` and `CategoriesTableAdapter` in the Data Access Layer to include this information natively.</span></span> <span data-ttu-id="2adbd-192">Aby to osiągnąć, należy dodać nową kolumnę do `CategoriesDataTable`, aby pomieścić liczbę skojarzonych produktów.</span><span class="sxs-lookup"><span data-stu-id="2adbd-192">To achieve this, we must add a new column to `CategoriesDataTable` to hold the number of associated products.</span></span> <span data-ttu-id="2adbd-193">Aby dodać nową kolumnę do elementu DataTable, Otwórz wybrany zestaw danych (`App_Code\DAL\Northwind.xsd`), kliknij prawym przyciskiem myszy element DataTable do zmodyfikowania, a następnie wybierz polecenie Dodaj/kolumna.</span><span class="sxs-lookup"><span data-stu-id="2adbd-193">To add a new column to a DataTable, open the Typed DataSet (`App_Code\DAL\Northwind.xsd`), right-click on the DataTable to modify, and choose Add / Column.</span></span> <span data-ttu-id="2adbd-194">Dodaj nową kolumnę do `CategoriesDataTable` (patrz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="2adbd-194">Add a new column to the `CategoriesDataTable` (see Figure 5).</span></span>

<span data-ttu-id="2adbd-195">[![dodać nowej kolumny do CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-195">[![Add a New Column to the CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span></span>

<span data-ttu-id="2adbd-196">**Ilustracja 5**. Dodawanie nowej kolumny do `CategoriesDataSource` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-196">**Figure 5**: Add a New Column to the `CategoriesDataSource` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span></span>

<span data-ttu-id="2adbd-197">Spowoduje to dodanie nowej kolumny o nazwie `Column1`, którą można zmienić, wpisując inną nazwę.</span><span class="sxs-lookup"><span data-stu-id="2adbd-197">This will add a new column named `Column1`, which you can change by simply typing in a different name.</span></span> <span data-ttu-id="2adbd-198">Zmień nazwę tej nowej kolumny na `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-198">Rename this new column to `NumberOfProducts`.</span></span> <span data-ttu-id="2adbd-199">Następnie należy skonfigurować właściwości kolumny s.</span><span class="sxs-lookup"><span data-stu-id="2adbd-199">Next, we need to configure this column s properties.</span></span> <span data-ttu-id="2adbd-200">Kliknij nową kolumnę i przejdź do okno Właściwości.</span><span class="sxs-lookup"><span data-stu-id="2adbd-200">Click on the new column and go to the Properties window.</span></span> <span data-ttu-id="2adbd-201">Zmień Właściwość Column s `DataType` z `System.String` na `System.Int32` i ustaw właściwość `ReadOnly` na `True`, jak pokazano na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="2adbd-201">Change the column s `DataType` property from `System.String` to `System.Int32` and set the `ReadOnly` property to `True`, as shown in Figure 6.</span></span>

![Ustaw właściwości DataType i ReadOnly nowej kolumny](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image16.png)

<span data-ttu-id="2adbd-203">**Ilustracja 6**. ustawianie właściwości `DataType` i `ReadOnly` nowej kolumny</span><span class="sxs-lookup"><span data-stu-id="2adbd-203">**Figure 6**: Set the `DataType` and `ReadOnly` Properties of the New Column</span></span>

<span data-ttu-id="2adbd-204">Gdy `CategoriesDataTable` ma teraz kolumnę `NumberOfProducts`, jej wartość nie jest ustawiana przez żadną z odpowiednich zapytań TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="2adbd-204">While the `CategoriesDataTable` now has a `NumberOfProducts` column, its value is not set by any of the corresponding TableAdapter s queries.</span></span> <span data-ttu-id="2adbd-205">Możemy zaktualizować metodę `GetCategories()`, aby zwracała te informacje, jeśli chcesz, aby te informacje były zwracane za każdym razem, gdy są pobierane informacje o kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-205">We can update the `GetCategories()` method to return this information if we want such information returned every time category information is retrieved.</span></span> <span data-ttu-id="2adbd-206">Jeśli jednak potrzebujemy tylko, aby dowiedzieć się więcej o liczbie skojarzonych produktów dla kategorii w rzadkich wystąpieniach (na przykład tylko w tym samouczku), możemy pozostawić `GetCategories()` jako-is i utworzyć nową metodę zwracającą te informacje.</span><span class="sxs-lookup"><span data-stu-id="2adbd-206">If, however, we only need to grab the number of associated products for the categories in rare instances (such as just for this tutorial), then we can leave `GetCategories()` as-is and create a new method that returns this information.</span></span> <span data-ttu-id="2adbd-207">Zezwól na użycie tego ostatniego podejścia, tworząc nową metodę o nazwie `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-207">Let s use this latter approach, creating a new method named `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="2adbd-208">Aby dodać tę nową metodę `GetCategoriesAndNumberOfProducts()`, kliknij prawym przyciskiem myszy `CategoriesTableAdapter` i wybierz polecenie nowe zapytanie.</span><span class="sxs-lookup"><span data-stu-id="2adbd-208">To add this new `GetCategoriesAndNumberOfProducts()` method, right-click on the `CategoriesTableAdapter` and choose New Query.</span></span> <span data-ttu-id="2adbd-209">Spowoduje to wyświetlenie Kreatora konfiguracji zapytania TableAdapter, którego użyto wiele razy w poprzednich samouczkach.</span><span class="sxs-lookup"><span data-stu-id="2adbd-209">This brings up the TableAdapter Query Configuration Wizard, which we ve used numerous times in previous tutorials.</span></span> <span data-ttu-id="2adbd-210">W przypadku tej metody Uruchom kreatora, wskazując, że zapytanie używa instrukcji SQL ad hoc, która zwraca wiersze.</span><span class="sxs-lookup"><span data-stu-id="2adbd-210">For this method, start the wizard by indicating that the query uses an ad-hoc SQL statement that returns rows.</span></span>

<span data-ttu-id="2adbd-211">[![utworzyć metody przy użyciu instrukcji SQL ad hoc](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-211">[![Create the Method Using an Ad-Hoc SQL Statement](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span></span>

<span data-ttu-id="2adbd-212">**Rysunek 7**. Tworzenie metody przy użyciu instrukcji SQL ad hoc ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-212">**Figure 7**: Create the Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span></span>

<span data-ttu-id="2adbd-213">[![instrukcja SQL zwraca wiersze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-213">[![The SQL Statement Returns Rows](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span></span>

<span data-ttu-id="2adbd-214">**Ilustracja 8**. Instrukcja SQL zwraca wiersze ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-214">**Figure 8**: The SQL Statement Returns Rows ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span></span>

<span data-ttu-id="2adbd-215">Na następnym ekranie kreatora zostanie wyświetlony komunikat z prośbą o użycie zapytania.</span><span class="sxs-lookup"><span data-stu-id="2adbd-215">The next wizard screen prompts us for the query to use.</span></span> <span data-ttu-id="2adbd-216">Aby zwrócić każdą kategorię `CategoryID`, `CategoryName`i `Description` pola wraz z liczbą produktów skojarzonych z kategorią, należy użyć następującej instrukcji `SELECT`:</span><span class="sxs-lookup"><span data-stu-id="2adbd-216">To return each category s `CategoryID`, `CategoryName`, and `Description` fields, along with the number of products associated with the category, use the following `SELECT` statement:</span></span>

[!code-sql[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample7.sql)]

<span data-ttu-id="2adbd-217">[![określić zapytania do użycia](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-217">[![Specify the Query to Use](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span></span>

<span data-ttu-id="2adbd-218">**Ilustracja 9**. Określanie zapytania do użycia ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-218">**Figure 9**: Specify the Query to Use ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span></span>

<span data-ttu-id="2adbd-219">Należy zauważyć, że podzapytanie, które oblicza liczbę produktów skojarzonych z kategorią, jest aliasem jako `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-219">Note that the subquery that computes the number of products associated with the category is aliased as `NumberOfProducts`.</span></span> <span data-ttu-id="2adbd-220">Takie dopasowanie nazewnictwa powoduje, że wartość zwracana przez to podzapytanie ma być skojarzona z kolumną `CategoriesDataTable` s `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-220">This naming match causes the value returned by this subquery to be associated with the `CategoriesDataTable` s `NumberOfProducts` column.</span></span>

<span data-ttu-id="2adbd-221">Po wprowadzeniu tego zapytania, ostatnim krokiem jest wybranie nazwy nowej metody.</span><span class="sxs-lookup"><span data-stu-id="2adbd-221">After entering this query, the last step is to choose the name for the new method.</span></span> <span data-ttu-id="2adbd-222">Użyj `FillWithNumberOfProducts` i `GetCategoriesAndNumberOfProducts` do wypełnienia elementu DataTable i zwrócenia odpowiednio wzorców DataTable.</span><span class="sxs-lookup"><span data-stu-id="2adbd-222">Use `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span>

<span data-ttu-id="2adbd-223">[Nazwa ![nowe metody TableAdapter s FillWithNumberOfProducts i GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-223">[![Name the New TableAdapter s Methods FillWithNumberOfProducts and GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span></span>

<span data-ttu-id="2adbd-224">**Ilustracja 10**. Nazwij nowe metody TableAdapter `FillWithNumberOfProducts` i `GetCategoriesAndNumberOfProducts` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-224">**Figure 10**: Name the New TableAdapter s Methods `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span></span>

<span data-ttu-id="2adbd-225">W tym momencie Warstwa dostępu do danych została rozszerzona w celu uwzględnienia liczby produktów na kategorię.</span><span class="sxs-lookup"><span data-stu-id="2adbd-225">At this point the Data Access Layer has been extended to include the number of products per category.</span></span> <span data-ttu-id="2adbd-226">Ponieważ cała nasza warstwa prezentacji kieruje wszystkie wywołania do DAL za pomocą oddzielnej warstwy logiki biznesowej, należy dodać odpowiednią metodę `GetCategoriesAndNumberOfProducts` do klasy `CategoriesBLL`:</span><span class="sxs-lookup"><span data-stu-id="2adbd-226">Since all our presentation layer routes all calls to the DAL through a separate Business Logic Layer we need to add a corresponding `GetCategoriesAndNumberOfProducts` method to the `CategoriesBLL` class:</span></span>

[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample8.cs)]

<span data-ttu-id="2adbd-227">Po ukończeniu DAL i LOGIKI biznesowej wszystko gotowe do powiązania tych danych z Wzmacniaką `Categories` w `CategoriesAndProducts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-227">With the DAL and BLL complete, we re ready to bind this data to the `Categories` Repeater in `CategoriesAndProducts.aspx`!</span></span> <span data-ttu-id="2adbd-228">Jeśli został już utworzony element ObjectDataSource dla wzmacniak z określania liczby produktów w sekcji obsługi zdarzeń `ItemDataBound`, Usuń ten element ObjectDataSource i Usuń ustawienie właściwości wzmacniak-`DataSourceID`; Usuń także zdarzenie `ItemDataBound` wzmacniak z obsługi zdarzeń, usuwając składnię `Handles Categories.OnItemDataBound` w klasie z kodem ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="2adbd-228">If you ve already created an ObjectDataSource for the Repeater from the Determining the Number of Products in the `ItemDataBound` Event Handler section, delete this ObjectDataSource and remove the Repeater s `DataSourceID` property setting; also unwire the Repeater s `ItemDataBound` event from the event handler by removing the `Handles Categories.OnItemDataBound` syntax in the ASP.NET code-behind class.</span></span>

<span data-ttu-id="2adbd-229">Z powrotem w pierwotnym stanie, Dodaj nowy element ObjectDataSource o nazwie `CategoriesDataSource` za pośrednictwem tagu inteligentnego wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="2adbd-229">With the Repeater back in its original state, add a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="2adbd-230">Skonfiguruj element ObjectDataSource do używania klasy `CategoriesBLL`, ale zamiast używać metody `GetCategories()`, użyj `GetCategoriesAndNumberOfProducts()` zamiast tego (patrz rysunek 11).</span><span class="sxs-lookup"><span data-stu-id="2adbd-230">Configure the ObjectDataSource to use the `CategoriesBLL` class, but instead of having it use the `GetCategories()` method, have it use `GetCategoriesAndNumberOfProducts()` instead (see Figure 11).</span></span>

<span data-ttu-id="2adbd-231">[![skonfigurować element ObjectDataSource do korzystania z metody GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-231">[![Configure the ObjectDataSource to Use the GetCategoriesAndNumberOfProducts Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span></span>

<span data-ttu-id="2adbd-232">**Ilustracja 11**. Konfigurowanie elementu ObjectDataSource do używania metody `GetCategoriesAndNumberOfProducts` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-232">**Figure 11**: Configure the ObjectDataSource to Use the `GetCategoriesAndNumberOfProducts` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span></span>

<span data-ttu-id="2adbd-233">Następnie zaktualizuj `ItemTemplate` tak, aby właściwość element LinkButton s `Text` została deklaratywnie przypisana przy użyciu składni DataBinding i zawiera pola danych `CategoryName` i `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-233">Next, update the `ItemTemplate` so that the LinkButton s `Text` property is declaratively assigned using databinding syntax and includes both the `CategoryName` and `NumberOfProducts` data fields.</span></span> <span data-ttu-id="2adbd-234">Kompletny, deklaratywny znacznik dla wzmacniak i `CategoriesDataSource` ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="2adbd-234">The complete declarative markup for the Repeater and the `CategoriesDataSource` ObjectDataSource follow:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample9.aspx)]

<span data-ttu-id="2adbd-235">Dane wyjściowe renderowane przez aktualizację DAL w celu uwzględnienia kolumny `NumberOfProducts` są takie same jak przy użyciu metody obsługi zdarzeń `ItemDataBound` (zapoznaj się z powrotem do rysunku 4, aby wyświetlić zrzut ekranu przedstawiający kod kategorii i liczbę produktów).</span><span class="sxs-lookup"><span data-stu-id="2adbd-235">The output rendered by updating the DAL to include a `NumberOfProducts` column is the same as using the `ItemDataBound` event handler approach (refer back to Figure 4 to see a screen shot of the Repeater showing the category names and number of products).</span></span>

## <a name="step-3-displaying-the-selected-category-s-products"></a><span data-ttu-id="2adbd-236">Krok 3. Wyświetlanie wybranych produktów kategorii s</span><span class="sxs-lookup"><span data-stu-id="2adbd-236">Step 3: Displaying the Selected Category s Products</span></span>

<span data-ttu-id="2adbd-237">W tym momencie mamy `Categories` wzmacniak wyświetlający listę kategorii wraz z liczbą produktów w każdej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-237">At this point we have the `Categories` Repeater displaying the list of categories along with the number of products in each category.</span></span> <span data-ttu-id="2adbd-238">Wzmacniak używa elementu element LinkButton dla każdej kategorii, która po kliknięciu powoduje odświeżenie. w tym momencie musimy wyświetlić te produkty dla wybranej kategorii na `CategoryProducts` DataList.</span><span class="sxs-lookup"><span data-stu-id="2adbd-238">The Repeater uses a LinkButton for each category that, when clicked, causes a postback, at which point we need to display those products for the selected category in the `CategoryProducts` DataList.</span></span>

<span data-ttu-id="2adbd-239">Jedną z wyzwań skierowanych do nas jest sposób wyświetlania tylko tych produktów dla wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-239">One challenge facing us is how to have the DataList display just those products for the selected category.</span></span> <span data-ttu-id="2adbd-240">W obszarze [wzorzec/szczegóły przy użyciu dostępnego do wyboru wzorca GridView z szczegółowym](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) samouczkiem DetailsView znaleźliśmy, w jaki sposób utworzyć widok GridView, którego wiersze mogą być zaznaczone, a szczegóły wybranego wiersza s są wyświetlane w widoku DetailsView na tej samej stronie.</span><span class="sxs-lookup"><span data-stu-id="2adbd-240">In the [Master/Detail Using a Selectable Master GridView with a Details DetailsView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial we saw how to build a GridView whose rows could be selected, with the selected row s details being displayed in a DetailsView on the same page.</span></span> <span data-ttu-id="2adbd-241">Element GridView. ObjectDataSource s zwrócił informacje o wszystkich produktach korzystających z metody `ProductsBLL` s `GetProducts()`, podczas gdy element ObjectDataSource s w widoku DetailsView pobrał informacje o wybranym produkcie przy użyciu metody `GetProductsByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-241">The GridView s ObjectDataSource returned information about all products using the `ProductsBLL` s `GetProducts()` method while the DetailsView s ObjectDataSource retrieved information about the selected product using the `GetProductsByProductID(productID)` method.</span></span> <span data-ttu-id="2adbd-242">Wartość parametru *`productID`* podano deklaratywnie, kojarząc ją z wartością właściwości GridView s `SelectedValue`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-242">The *`productID`* parameter value was provided declaratively by associating it with the value of the GridView s `SelectedValue` property.</span></span> <span data-ttu-id="2adbd-243">Niestety, wzmacniak nie ma właściwości `SelectedValue` i nie może stanowić źródła parametru.</span><span class="sxs-lookup"><span data-stu-id="2adbd-243">Unfortunately, the Repeater does not have a `SelectedValue` property and cannot serve as a parameter source.</span></span>

> [!NOTE]
> <span data-ttu-id="2adbd-244">Jest to jedno z wyzwań, które pojawiają się podczas korzystania z element LinkButton w Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-244">This is one of those challenges that appear when using the LinkButton in a Repeater.</span></span> <span data-ttu-id="2adbd-245">Czy użyto hiperłącza do przekazania `CategoryID` za pomocą ciągu QueryString zamiast tego, możemy użyć tego pola QueryString jako źródła dla wartości parametru s.</span><span class="sxs-lookup"><span data-stu-id="2adbd-245">Had we used a hyperlink to pass in the `CategoryID` through the querystring instead, we could use that QueryString field as the source for the parameter s value.</span></span>

<span data-ttu-id="2adbd-246">Zanim będziemy obawiać się o braku `SelectedValue` właściwości dla Wzmacniakka, należy najpierw popowiązać element DataList z elementem ObjectDataSource i określić jego `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-246">Before we worry about the lack of a `SelectedValue` property for the Repeater, though, let s first bind the DataList to an ObjectDataSource and specify its `ItemTemplate`.</span></span>

<span data-ttu-id="2adbd-247">W tagu inteligentnym DataList s Dodaj nowy element ObjectDataSource o nazwie `CategoryProductsDataSource` i skonfiguruj go tak, aby korzystał z metody `GetProductsByCategoryID(categoryID)` klasy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-247">From the DataList s smart tag, opt to add a new ObjectDataSource named `CategoryProductsDataSource` and configure it to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="2adbd-248">Ponieważ element DataList w tym samouczku oferuje interfejs tylko do odczytu, możesz bezpłatnie ustawić listę rozwijaną na kartach Wstawianie, aktualizowanie i usuwanie do (brak).</span><span class="sxs-lookup"><span data-stu-id="2adbd-248">Since the DataList in this tutorial offers a read-only interface, feel free to set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="2adbd-249">[![skonfigurować element ObjectDataSource do używania metody ProductsBLL Class s GetProductsByCategoryID (IDKategorii)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-249">[![Configure the ObjectDataSource to Use ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span></span>

<span data-ttu-id="2adbd-250">**Ilustracja 12**. Skonfiguruj element ObjectDataSource, aby używał metody `GetProductsByCategoryID(categoryID)` `ProductsBLL` klasy s ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-250">**Figure 12**: Configure the ObjectDataSource to Use `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span></span>

<span data-ttu-id="2adbd-251">Ponieważ metoda `GetProductsByCategoryID(categoryID)` oczekuje parametru wejściowego ( *`categoryID`* ), Kreator konfiguracji źródła danych pozwala nam określić źródło parametru s.</span><span class="sxs-lookup"><span data-stu-id="2adbd-251">Since the `GetProductsByCategoryID(categoryID)` method expects an input parameter (*`categoryID`*), the Configure Data Source wizard allows us to specify the parameter s source.</span></span> <span data-ttu-id="2adbd-252">Kategorie zostały wymienione w widoku GridView lub DataList, ale ustawimy listę rozwijaną Źródło parametru na kontrolkę i ControlID do `ID` formantu sieci Web danych.</span><span class="sxs-lookup"><span data-stu-id="2adbd-252">Had the categories been listed in a GridView or a DataList, we d set the Parameter source drop-down list to Control and the ControlID to the `ID` of the data Web control.</span></span> <span data-ttu-id="2adbd-253">Jednakże, ponieważ wzmacniak nie ma właściwości `SelectedValue`, nie można jej użyć jako źródła parametru.</span><span class="sxs-lookup"><span data-stu-id="2adbd-253">However, since the Repeater lacks a `SelectedValue` property it cannot be used as a parameter source.</span></span> <span data-ttu-id="2adbd-254">W przypadku sprawdzenia, że lista rozwijana ControlID zawiera tylko jedną kontrolkę `ID``CategoryProducts`, `ID` elementu DataList.</span><span class="sxs-lookup"><span data-stu-id="2adbd-254">If you check, you'll find that the ControlID drop-down list only contains one control `ID``CategoryProducts`, the `ID` of the DataList.</span></span>

<span data-ttu-id="2adbd-255">Na razie Ustaw listę rozwijaną Źródło parametru na wartość Brak.</span><span class="sxs-lookup"><span data-stu-id="2adbd-255">For now, set the Parameter source drop-down list to None.</span></span> <span data-ttu-id="2adbd-256">Będziemy w stanie programowo przypisywać tę wartość parametru, gdy element LinkButton kategorii zostanie kliknięty w Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-256">We'll end up programmatically assigning this parameter value when a category LinkButton is clicked in the Repeater.</span></span>

<span data-ttu-id="2adbd-257">[![nie określać źródła parametrów dla parametru IDKategorii](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-257">[![Do Not Specify a Parameter Source for the categoryID Parameter](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span></span>

<span data-ttu-id="2adbd-258">**Ilustracja 13**. nie określaj źródła parametrów dla parametru *`categoryID`* ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-258">**Figure 13**: Do Not Specify a Parameter Source for the *`categoryID`* Parameter ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span></span>

<span data-ttu-id="2adbd-259">Po zakończeniu działania Kreatora konfiguracji źródła danych program Visual Studio automatycznie generuje `ItemTemplate`DataList s.</span><span class="sxs-lookup"><span data-stu-id="2adbd-259">After completing the Configure Data Source wizard, Visual Studio auto-generates the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="2adbd-260">Zastąp to domyślne `ItemTemplate` szablonem użytym w poprzednim samouczku; Ponadto ustaw Właściwość DataList s `RepeatColumns` na 2.</span><span class="sxs-lookup"><span data-stu-id="2adbd-260">Replace this default `ItemTemplate` with the template we used in the preceding tutorial; also, set the DataList s `RepeatColumns` property to 2.</span></span> <span data-ttu-id="2adbd-261">Po wprowadzeniu tych zmian znaczniki deklaratywne dla elementu DataList i skojarzony z nim element ObjectDataSource powinny wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="2adbd-261">After making these changes the declarative markup for your DataList and its associated ObjectDataSource should look like the following:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample10.aspx)]

<span data-ttu-id="2adbd-262">Obecnie parametr *`categoryID`* `CategoryProductsDataSource` ObjectDataSource nie jest nigdy ustawiony, więc żadne produkty nie są wyświetlane podczas wyświetlania strony.</span><span class="sxs-lookup"><span data-stu-id="2adbd-262">Currently, the `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* parameter is never set, so no products are displayed when viewing the page.</span></span> <span data-ttu-id="2adbd-263">Ta wartość parametru musi być ustawiona na podstawie `CategoryID` klikniętej kategorii w Wzmacniake.</span><span class="sxs-lookup"><span data-stu-id="2adbd-263">What we need to do is have this parameter value set based on the `CategoryID` of the clicked category in the Repeater.</span></span> <span data-ttu-id="2adbd-264">W ten sposób wprowadzono dwa wyzwania: najpierw, jak określić, kiedy element LinkButton się w `ItemTemplate` Wzmacniake. i sekundę, jak możemy określić `CategoryID` odpowiedniej kategorii, której kliknięto element LinkButton?</span><span class="sxs-lookup"><span data-stu-id="2adbd-264">This introduces two challenges: first, how do we determine when a LinkButton in the Repeater s `ItemTemplate` has been clicked; and second, how can we determine the `CategoryID` of the corresponding category whose LinkButton was clicked?</span></span>

<span data-ttu-id="2adbd-265">Element LinkButton, podobnie jak przyciski i kontrolki kliknięto element ImageButton, mają zdarzenie `Click` i [zdarzenie`Command`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span><span class="sxs-lookup"><span data-stu-id="2adbd-265">The LinkButton like the Button and ImageButton controls has a `Click` event and a [`Command` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span></span> <span data-ttu-id="2adbd-266">Zdarzenie `Click` zostało zaprojektowane w taki sposób, aby po kliknięciu element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="2adbd-266">The `Click` event is designed to simply note that the LinkButton has been clicked.</span></span> <span data-ttu-id="2adbd-267">Czasami jednak oprócz tego, że element LinkButton został kliknięty, konieczne jest również przekazanie pewnych dodatkowych informacji do programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="2adbd-267">At times, however, in addition to noting that the LinkButton has been clicked we also need to pass some extra information to the event handler.</span></span> <span data-ttu-id="2adbd-268">W takim przypadku element LinkButton [`CommandName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) i właściwości [`CommandArgument`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) można przypisać do tych dodatkowych informacji.</span><span class="sxs-lookup"><span data-stu-id="2adbd-268">If this is the case, the LinkButton s [`CommandName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) and [`CommandArgument`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) properties can be assigned this extra information.</span></span> <span data-ttu-id="2adbd-269">Następnie po kliknięciu element LinkButton zostanie wyzwolone jego zdarzenie `Command` (zamiast zdarzenia `Click`), a program obsługi zdarzeń przekazał wartości `CommandName` i `CommandArgument` właściwości.</span><span class="sxs-lookup"><span data-stu-id="2adbd-269">Then, when the LinkButton is clicked, its `Command` event fires (instead of its `Click` event) and the event handler is passed the values of the `CommandName` and `CommandArgument` properties.</span></span>

<span data-ttu-id="2adbd-270">Gdy zdarzenie `Command` jest wywoływane z poziomu szablonu w Wzmacniake, wyzwolone zostało [zdarzenie`ItemCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) wzmacniak i zostanie przeniesiona `CommandName` i `CommandArgument` wartości klikniętego element LinkButton (lub kliknięto element ImageButton).</span><span class="sxs-lookup"><span data-stu-id="2adbd-270">When a `Command` event is raised from within a template in the Repeater, the Repeater s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) fires and is passed the `CommandName` and `CommandArgument` values of the clicked LinkButton (or Button or ImageButton).</span></span> <span data-ttu-id="2adbd-271">W związku z tym, aby określić, kiedy kliknięto kategorię element LinkButton w Wzmacniake, musimy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="2adbd-271">Therefore, to determine when a category LinkButton in the Repeater has been clicked, we need to do the following:</span></span>

1. <span data-ttu-id="2adbd-272">Ustaw właściwość `CommandName` element LinkButton w `ItemTemplate` wzmacniaka na inną wartość (chcę użyć ListProducts).</span><span class="sxs-lookup"><span data-stu-id="2adbd-272">Set the `CommandName` property of the LinkButton in the Repeater s `ItemTemplate` to some value (I ve used ListProducts ).</span></span> <span data-ttu-id="2adbd-273">Ustawiając tę wartość `CommandName`, zdarzenie element LinkButton s `Command` wyzwalane po kliknięciu element LinkButton.</span><span class="sxs-lookup"><span data-stu-id="2adbd-273">By setting this `CommandName` value, the LinkButton s `Command` event fires when the LinkButton is clicked.</span></span>
2. <span data-ttu-id="2adbd-274">Ustaw właściwość element LinkButton s `CommandArgument` na wartość bieżącego elementu `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-274">Set the LinkButton s `CommandArgument` property to the value of the current item s `CategoryID`.</span></span>
3. <span data-ttu-id="2adbd-275">Utwórz procedurę obsługi zdarzeń dla zdarzenia `ItemCommand` wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="2adbd-275">Create an event handler for the Repeater s `ItemCommand` event.</span></span> <span data-ttu-id="2adbd-276">W programie obsługi zdarzeń ustaw parametr `CategoryProductsDataSource` ObjectDataSource s `CategoryID` na wartość przekazaną `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-276">In the event handler, set the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span>

<span data-ttu-id="2adbd-277">Następujące `ItemTemplate` znaczniki dla wzmacniania kategorii implementują kroki 1 i 2.</span><span class="sxs-lookup"><span data-stu-id="2adbd-277">The following `ItemTemplate` markup for the Categories Repeater implements steps 1 and 2.</span></span> <span data-ttu-id="2adbd-278">Zwróć uwagę na to, w jaki sposób wartość `CommandArgument` jest przypisywana do `CategoryID` elementu danych przy użyciu składni DataBinding:</span><span class="sxs-lookup"><span data-stu-id="2adbd-278">Note how the `CommandArgument` value is assigned the data item s `CategoryID` using databinding syntax:</span></span>

[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample11.aspx)]

<span data-ttu-id="2adbd-279">Za każdym razem, gdy tworzony jest program obsługi zdarzeń `ItemCommand`, należy zawsze sprawdzić wartość przychodzącej `CommandName`, ponieważ *każde* zdarzenie `Command` wywołane przez *dowolny* przycisk, element LinkButton lub kliknięto element ImageButton w ramach tego wzmacniak spowoduje wyzwolenie zdarzenia `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-279">Whenever creating an `ItemCommand` event handler it is prudent to always first check the incoming `CommandName` value because *any* `Command` event raised by *any* Button, LinkButton, or ImageButton within the Repeater will cause the `ItemCommand` event to fire.</span></span> <span data-ttu-id="2adbd-280">Obecnie mamy teraz tylko jeden taki element LinkButton, w przyszłości (lub inny deweloper w naszym zespole) może dodać dodatkowe kontrolki sieci Web przycisków do wzmacniak, który po kliknięciu wywołuje ten sam `ItemCommand` obsługę zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="2adbd-280">While we currently only have one such LinkButton now, in the future we (or another developer on our team) might add additional button Web controls to the Repeater that, when clicked, raises the same `ItemCommand` event handler.</span></span> <span data-ttu-id="2adbd-281">W związku z tym najlepszym rozwiązaniem jest upewnienie się, że jest sprawdzana Właściwość `CommandName` i kontynuuje pracę tylko z logiką programistyczną, jeśli jest ona zgodna z oczekiwaną wartością.</span><span class="sxs-lookup"><span data-stu-id="2adbd-281">Therefore, it s best to always make sure you check the `CommandName` property and only proceed with your programmatic logic if it matches up to the value expected.</span></span>

<span data-ttu-id="2adbd-282">Po upewnieniu się, że wartość `CommandName` przekazanie jest równa ListProducts, program obsługi zdarzeń przypisze parametr `CategoryProductsDataSource` ObjectDataSource s `CategoryID` do wartości przekazaną `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="2adbd-282">After ensuring that the passed-in `CommandName` value equals ListProducts, the event handler then assigns the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span> <span data-ttu-id="2adbd-283">Ta modyfikacja `SelectParameters` ObjectDataSource s automatycznie powoduje, że element DataList może ponownie powiązać siebie ze źródłem danych, pokazując produkty dla nowo wybranej kategorii.</span><span class="sxs-lookup"><span data-stu-id="2adbd-283">This modification to the ObjectDataSource s `SelectParameters` automatically causes the DataList to rebind itself to the data source, showing the products for the newly selected category.</span></span>

[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample12.cs)]

<span data-ttu-id="2adbd-284">Dzięki tym dodatkom nasz samouczek jest gotowy!</span><span class="sxs-lookup"><span data-stu-id="2adbd-284">With these additions, our tutorial is complete!</span></span> <span data-ttu-id="2adbd-285">Poświęć chwilę na przetestowanie go w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="2adbd-285">Take a moment to test it out in a browser.</span></span> <span data-ttu-id="2adbd-286">Ilustracja 14 przedstawia ekran podczas pierwszego odwiedzania strony.</span><span class="sxs-lookup"><span data-stu-id="2adbd-286">Figure 14 shows the screen when first visiting the page.</span></span> <span data-ttu-id="2adbd-287">Ponieważ kategoria jest jeszcze zaznaczona, nie są wyświetlane żadne produkty.</span><span class="sxs-lookup"><span data-stu-id="2adbd-287">Since a category has yet to be selected, no products are displayed.</span></span> <span data-ttu-id="2adbd-288">Kliknięcie kategorii, takiej jak produkt, wyświetla te produkty w kategorii produkt w widoku dwóch kolumn (patrz rysunek 15).</span><span class="sxs-lookup"><span data-stu-id="2adbd-288">Clicking on a category, such as Produce, displays those products in the Product category in a two-column view (see Figure 15).</span></span>

<span data-ttu-id="2adbd-289">[![podczas pierwszego odwiedzania strony nie są wyświetlane żadne produkty](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-289">[![No Products are Displayed When First Visiting the Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span></span>

<span data-ttu-id="2adbd-290">**Ilustracja 14**. podczas pierwszego odwiedzania strony nie są wyświetlane żadne produkty ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-290">**Figure 14**: No Products are Displayed When First Visiting the Page ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span></span>

<span data-ttu-id="2adbd-291">[![kliknięciu kategorii producent wyświetla listę pasujących produktów po prawej stronie](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="2adbd-291">[![Clicking the Produce Category Lists the Matching Products to the Right](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span></span>

<span data-ttu-id="2adbd-292">**Ilustracja 15**. kliknięcie kategorii produkcji powoduje wyświetlenie listy pasujących produktów z prawej strony ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="2adbd-292">**Figure 15**: Clicking the Produce Category Lists the Matching Products to the Right ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2adbd-293">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="2adbd-293">Summary</span></span>

<span data-ttu-id="2adbd-294">Jak wspomniano w tym samouczku, a poprzedni, główny/szczegółowy raport można rozłożyć na dwie strony lub skonsolidować na jednym z nich.</span><span class="sxs-lookup"><span data-stu-id="2adbd-294">As we saw in this tutorial and the preceding one, master/detail reports can be spread out across two pages, or consolidated on one.</span></span> <span data-ttu-id="2adbd-295">Jednak wyświetlanie raportu wzorzec/szczegóły na pojedynczej stronie zawiera pewne wyzwania dotyczące sposobu układu wzorca i rekordów szczegółowych na stronie.</span><span class="sxs-lookup"><span data-stu-id="2adbd-295">Displaying a master/details report on a single page, however, introduces some challenges on how best to layout the master and details records on the page.</span></span> <span data-ttu-id="2adbd-296">We *wzorcu/szczegółach przy użyciu selektora w widoku szczegółowym, w którym szczegółowo* przedstawiono szczegółowe informacje, są wyświetlane nad rekordami głównymi. w tym samouczku użyto technik CSS, aby rekordy główne były przepływające z lewej strony szczegółów.</span><span class="sxs-lookup"><span data-stu-id="2adbd-296">In the *Master/Detail Using a Selectable Master GridView with a Details DetailsView* tutorial we had the details records appear above the master records; in this tutorial we used CSS techniques to have the master records float to the left of the details.</span></span>

<span data-ttu-id="2adbd-297">Wraz z wyświetlaniem raportów Master/Details mogliśmy poznać, jak pobrać liczbę produktów skojarzonych z każdą kategorią, a także jak wykonać logikę po stronie serwera, gdy element LinkButton (lub Button lub kliknięto element ImageButton) jest kliknięty w obrębie Wzmacniakka.</span><span class="sxs-lookup"><span data-stu-id="2adbd-297">Along with displaying master/details reports, we also had the opportunity to explore how to retrieve the number of products associated with each category as well as how to perform server-side logic when a LinkButton (or Button or ImageButton) is clicked from within a Repeater.</span></span>

<span data-ttu-id="2adbd-298">Ten samouczek wykonuje nasze badanie raportów master/detail za pomocą elementu DataList i wzmacniak.</span><span class="sxs-lookup"><span data-stu-id="2adbd-298">This tutorial completes our examination of master/detail reports with the DataList and Repeater.</span></span> <span data-ttu-id="2adbd-299">Nasz następny zestaw samouczków pokazuje, jak dodać możliwości edytowania i usuwania do formantu DataList.</span><span class="sxs-lookup"><span data-stu-id="2adbd-299">Our next set of tutorials will illustrate how to add editing and deleting capabilities to the DataList control.</span></span>

<span data-ttu-id="2adbd-300">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="2adbd-300">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="2adbd-301">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="2adbd-301">Further Reading</span></span>

<span data-ttu-id="2adbd-302">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="2adbd-302">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="2adbd-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) samouczek dotyczący elementów zmiennoprzecinkowych CSS z CSS</span><span class="sxs-lookup"><span data-stu-id="2adbd-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) a tutorial on floating CSS elements with CSS</span></span>
- <span data-ttu-id="2adbd-304">[CSS pozycjonowanie](http://www.brainjar.com/css/positioning/) więcej informacji na temat pozycjonowania elementów za pomocą CSS</span><span class="sxs-lookup"><span data-stu-id="2adbd-304">[CSS Positioning](http://www.brainjar.com/css/positioning/) more information on positioning elements with CSS</span></span>
- <span data-ttu-id="2adbd-305">[Układanie zawartości za pomocą kodu HTML](http://www.w3schools.com/html/html_layout.asp) przy użyciu `<table>` s i innych elementów HTML do pozycjonowania</span><span class="sxs-lookup"><span data-stu-id="2adbd-305">[Laying Out Content with HTML](http://www.w3schools.com/html/html_layout.asp) using `<table>` s and other HTML elements for positioning</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2adbd-306">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="2adbd-306">About the Author</span></span>

<span data-ttu-id="2adbd-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="2adbd-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2adbd-308">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="2adbd-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2adbd-309">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2adbd-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2adbd-310">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2adbd-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2adbd-311">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2adbd-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2adbd-312">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="2adbd-312">Special Thanks To</span></span>

<span data-ttu-id="2adbd-313">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="2adbd-313">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2adbd-314">Recenzent potencjalnych klientów dla tego samouczka został Zack Nowak.</span><span class="sxs-lookup"><span data-stu-id="2adbd-314">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="2adbd-315">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="2adbd-315">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2adbd-316">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2adbd-316">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2adbd-317">[Poprzednie](master-detail-filtering-acess-two-pages-datalist-cs.md)
> [dalej](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2adbd-317">[Previous](master-detail-filtering-acess-two-pages-datalist-cs.md)
[Next](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span></span>
