---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Tworzenie dostosowanego interfejsu użytkownika sortowania (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Podczas wyświetlania długą listę posortowanych danych, może być bardzo przydatny do grupowania powiązanych danych dzięki zastosowaniu separator wierszy. W tym samouczku zobaczymy, jak poświadczeń...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 571e34a8c87bf54b8dd71c912f16ebcdab3c87a7
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/09/2019
ms.locfileid: "59383450"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="1054d-104">Tworzenie dostosowanego interfejsu użytkownika sortowania (VB)</span><span class="sxs-lookup"><span data-stu-id="1054d-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="1054d-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1054d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1054d-106">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) lub [Pobierz plik PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1054d-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="1054d-107">Podczas wyświetlania długą listę posortowanych danych, może być bardzo przydatny do grupowania powiązanych danych dzięki zastosowaniu separator wierszy.</span><span class="sxs-lookup"><span data-stu-id="1054d-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="1054d-108">W tym samouczku opisano sposób tworzenia takiego sortowania interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="1054d-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="1054d-109">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="1054d-109">Introduction</span></span>

<span data-ttu-id="1054d-110">Podczas wyświetlania długą listę posortowanych danych w przypadku zaledwie kilku różnych wartości w kolumnie posortowany, użytkownik końcowy może okazać się trudne do wykrycia, where, dokładnie granice różnica wystąpić.</span><span class="sxs-lookup"><span data-stu-id="1054d-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="1054d-111">Na przykład istnieją 81 produktów w bazie danych, ale tylko dziewięć inną kategorię opcji (osiem kategorii unikatowy plus `NULL` opcji).</span><span class="sxs-lookup"><span data-stu-id="1054d-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="1054d-112">Rozważmy przypadek użytkownika, który jest zainteresowany badanie produktów, które należą do kategorii owoce morza.</span><span class="sxs-lookup"><span data-stu-id="1054d-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="1054d-113">Ze strony zawierającej zestawienie *wszystkich* produktów w jednym widoku GridView, użytkownik może zrezygnować jej najlepiej sortować wyniki według kategorii, które zostaną zgrupowane wszystkich produktów owoce morza razem.</span><span class="sxs-lookup"><span data-stu-id="1054d-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="1054d-114">Po sortowaniu według kategorii, użytkownik musi możliwe za pośrednictwem listy, wyszukiwanie, dla których produkty pogrupowane owoce morza rozpoczęcia i zakończenia.</span><span class="sxs-lookup"><span data-stu-id="1054d-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="1054d-115">Ponieważ wyniki są uporządkowane alfabetycznie według nazwy kategorii znajdowanie produktów owoce morza nie jest trudne, ale nadal wymaga ściśle przeszukaniu listy elementów w siatce.</span><span class="sxs-lookup"><span data-stu-id="1054d-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="1054d-116">Aby wyróżnić granice między grupami posortowany, wiele witryn sieci Web używają interfejsu użytkownika, który dodaje znak oddzielający takich grup.</span><span class="sxs-lookup"><span data-stu-id="1054d-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="1054d-117">Separatory, jak w powyższym przedstawionej na rysunku 1 umożliwia użytkownikowi szybciej znaleźć określonej grupy i zidentyfikować jego granice, a także upewnić się, jakie różne grupy istnieje w danych.</span><span class="sxs-lookup"><span data-stu-id="1054d-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


[![E<span data-ttu-id="1054d-118">stacje grupy kategorii są jasno określone]</span><span class="sxs-lookup"><span data-stu-id="1054d-118">ach Category Group is Clearly Identified]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)

<span data-ttu-id="1054d-119">**Rysunek 1**: Każda kategoria grupa jest jasno określone ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="1054d-120">W tym samouczku opisano sposób tworzenia takiego sortowania interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="1054d-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="1054d-121">Krok 1. Tworzenie GridView standardowe, sortowanie</span><span class="sxs-lookup"><span data-stu-id="1054d-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="1054d-122">Zanim omówimy sposób rozszerzyć GridView zapewnia rozszerzoną interfejs sortowania, chętnie s GridView standardowe, sortowania, która zawiera listę produktów należy najpierw utworzyć.</span><span class="sxs-lookup"><span data-stu-id="1054d-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="1054d-123">Zacznij od otwarcia `CustomSortingUI.aspx` stronie `PagingAndSorting` folderu.</span><span class="sxs-lookup"><span data-stu-id="1054d-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="1054d-124">Na stronie Dodaj GridView, ustaw jego `ID` właściwości `ProductList`i powiąż go do nowego elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="1054d-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="1054d-125">Konfigurowanie kontrolki ObjectDataSource używać `ProductsBLL` klasy s `GetProducts()` metoda wybierania rekordów.</span><span class="sxs-lookup"><span data-stu-id="1054d-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="1054d-126">Następnie skonfiguruj widoku GridView w taki sposób, że zawiera on tylko `ProductName`, `CategoryName`, `SupplierName`, i `UnitPrice` BoundFields i CheckBoxField wycofane.</span><span class="sxs-lookup"><span data-stu-id="1054d-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="1054d-127">Na koniec skonfiguruj GridView do obsługi sortowania, zaznaczając pole wyboru Włącz sortowanie w tagu inteligentnego s kontrolki GridView (lub przez ustawienie jego `AllowSorting` właściwość `true`).</span><span class="sxs-lookup"><span data-stu-id="1054d-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="1054d-128">Po wprowadzeniu te dodatki do `CustomSortingUI.aspx` stronie oznaczeniu deklaracyjnym powinien wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="1054d-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="1054d-129">Poświęć chwilę, aby wyświetlić nasz postęp tej pory w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="1054d-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="1054d-130">Rysunek 2 przedstawia sortowanie GridView po jego dane są sortowane według kategorii w kolejności alfabetycznej.</span><span class="sxs-lookup"><span data-stu-id="1054d-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


[![T<span data-ttu-id="1054d-131">jest on s GridView Sortowalna Data uporządkowane według kategorii]</span><span class="sxs-lookup"><span data-stu-id="1054d-131">he Sortable GridView s Data is Ordered by Category]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)

<span data-ttu-id="1054d-132">**Rysunek 2**: S GridView można sortować dane są uporządkowane według kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="1054d-133">Krok 2. Dodawanie wierszy Separator eksplorowania techniki</span><span class="sxs-lookup"><span data-stu-id="1054d-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="1054d-134">Za pomocą rodzajowego, sortowania widoku GridView pełną pozostaje aby można było dodać separator wierszy w widoku GridView przed każdej unikatowej grupy posortowany.</span><span class="sxs-lookup"><span data-stu-id="1054d-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="1054d-135">Ale jak można te wiersze wstrzyknięte do kontrolki GridView?</span><span class="sxs-lookup"><span data-stu-id="1054d-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="1054d-136">Zasadniczo firma Microsoft należy do iterowania po GridView wierszy s, określić, gdzie występują różnice między wartościami w kolumna posortowanego, a następnie dodaj odpowiedni separator wiersza.</span><span class="sxs-lookup"><span data-stu-id="1054d-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="1054d-137">Rozważania na temat tego problemu, wygląda na to fizyczne, czy rozwiązanie znajduje się gdzieś w GridView s `RowDataBound` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1054d-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="1054d-138">Tak jak Omówiliśmy to w [niestandardowe formatowanie oparte na danych](../custom-formatting/custom-formatting-based-upon-data-vb.md) samouczków, ta procedura obsługi zdarzeń jest często stosowany podczas stosowania formatowanie na poziomie wierszy na podstawie wiersza s danych.</span><span class="sxs-lookup"><span data-stu-id="1054d-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="1054d-139">Jednak `RowDataBound` program obsługi zdarzeń nie jest rozwiązanie, w tym miejscu, ponieważ wierszy nie można dodać do widoku GridView programowo z tej obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1054d-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="1054d-140">GridView s `Rows` kolekcji, w rzeczywistości jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="1054d-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="1054d-141">Aby dodać dodatkowe wiersze do kontrolki GridView mamy trzy opcje:</span><span class="sxs-lookup"><span data-stu-id="1054d-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="1054d-142">Dodaj te wiersze separator metadanych do rzeczywistych danych, który jest powiązany z widoku GridView</span><span class="sxs-lookup"><span data-stu-id="1054d-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="1054d-143">Po widoku GridView została powiązana z danymi, Dodaj dodatkowe `TableRow` wystąpień GridView s kontrolować zbieranie</span><span class="sxs-lookup"><span data-stu-id="1054d-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="1054d-144">Utwórz niestandardowy formant serwera w kontrolce GridView i zastępuje te metody, które są odpowiedzialne za konstruowanie struktury s GridView</span><span class="sxs-lookup"><span data-stu-id="1054d-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="1054d-145">Tworzenie formantu niestandardowego serwera będzie najlepszym rozwiązaniem, w razie potrzeby ta funkcja została na wielu stronach sieci web lub w kilku witryn sieci Web.</span><span class="sxs-lookup"><span data-stu-id="1054d-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="1054d-146">Jednak pociąga znacznej kodu i dokładnego badań do odnajdywanie ukrytych wewnętrzne działanie s GridView.</span><span class="sxs-lookup"><span data-stu-id="1054d-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="1054d-147">W związku z tym firma Microsoft będzie należy traktować tę opcję na potrzeby tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="1054d-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="1054d-148">Pozostałe dwie opcje Dodawanie wierszy separator do bycia w rzeczywistych danych powiązany z kontrolki GridView i manipulowanie nimi kolekcji kontrolki GridView s, po jego został powiązany — inaczej ataki problem i że opiszemy je w dyskusji.</span><span class="sxs-lookup"><span data-stu-id="1054d-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="1054d-149">Dodawanie wierszy do danych powiązany z widoku GridView</span><span class="sxs-lookup"><span data-stu-id="1054d-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="1054d-150">Gdy widoku GridView jest powiązana ze źródłem danych, tworzy `GridViewRow` dla każdego rekordu zwrócony przez źródło danych.</span><span class="sxs-lookup"><span data-stu-id="1054d-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="1054d-151">W związku z tym firma Microsoft wstrzyknąć wierszy separator wymagane przez dodanie separator rekordów do źródła danych przed wiążące go do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="1054d-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="1054d-152">Rysunek 3 ilustruje tę koncepcję.</span><span class="sxs-lookup"><span data-stu-id="1054d-152">Figure 3 illustrates this concept.</span></span>


![Jedna z technik polega na dodawaniu Separator wierszy do źródła danych](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="1054d-154">**Rysunek 3**: Jedna z technik polega na dodawaniu Separator wierszy do źródła danych</span><span class="sxs-lookup"><span data-stu-id="1054d-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="1054d-155">Korzystam z rekordów separator termin w cudzysłowie, ponieważ nie istnieje rekord specjalny separator; przeciwnie firma Microsoft musi jakiś sposób flagi, które określonego rekordu w źródle danych służy jako separator, a nie wiersz zwykłych danych.</span><span class="sxs-lookup"><span data-stu-id="1054d-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="1054d-156">Dla naszych przykładach, możemy ponownie powiązania `ProductsDataTable` wystąpienie GridView, który składa się z `ProductRows`.</span><span class="sxs-lookup"><span data-stu-id="1054d-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="1054d-157">Firma Microsoft może Flaga rekordu jako wiersz separatora, ustawiając jego `CategoryID` właściwość `-1` (ponieważ jest to wartość ta nie istnieje zazwyczaj).</span><span class="sxs-lookup"><span data-stu-id="1054d-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="1054d-158">Korzystanie z tej techniki d należy wykonać następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="1054d-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="1054d-159">Programowe pobieranie danych do powiązania do kontrolki GridView ( `ProductsDataTable` wystąpienia)</span><span class="sxs-lookup"><span data-stu-id="1054d-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="1054d-160">Sortowanie danych w oparciu GridView s `SortExpression` i `SortDirection` właściwości</span><span class="sxs-lookup"><span data-stu-id="1054d-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="1054d-161">Iteracyjne przeglądanie `ProductsRows` w `ProductsDataTable`poszukiwaniu gdzie znajdują się różnice w posortowanej kolumny</span><span class="sxs-lookup"><span data-stu-id="1054d-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="1054d-162">Na każdej granicy grupy wstawić rekordu separator `ProductsRow` wystąpienie do elementu DataTable, taki, który ma ona s `CategoryID` równa `-1` (lub dowolnych oznaczenia została podjęta podczas do oznaczania rekordu jako separator rekordu)</span><span class="sxs-lookup"><span data-stu-id="1054d-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="1054d-163">Po wstawianie wierszy separatora, programowo powiązać dane widoku GridView</span><span class="sxs-lookup"><span data-stu-id="1054d-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="1054d-164">Oprócz tych pięciu krokach d również należy podać program obsługi zdarzeń dla GridView s `RowDataBound` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="1054d-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="1054d-165">W tym miejscu d sprawdzenie każdego `DataRow` i określenie, czy separator wierszy jeden którego `CategoryID` ustawienie zostało `-1`.</span><span class="sxs-lookup"><span data-stu-id="1054d-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="1054d-166">Jeśli tak, możemy d prawdopodobnie chcesz dostosować formatowanie lub tekst wyświetlany w komórkach.</span><span class="sxs-lookup"><span data-stu-id="1054d-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="1054d-167">Ta technika wstrzykiwania sortowania granicami grupy wymaga nieco więcej pracy niż opisane powyżej, jak należy również podać program obsługi zdarzeń dla GridView s `Sorting` zdarzeń i zachować prowadnicy `SortExpression` i `SortDirection` wartości.</span><span class="sxs-lookup"><span data-stu-id="1054d-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="1054d-168">Manipulowanie GridView s kontrolować zbieranie po nim s została powiązana z danymi</span><span class="sxs-lookup"><span data-stu-id="1054d-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="1054d-169">Zamiast wiadomości dane przed wiążące go do widoku GridView, możemy dodać wiersze separator *po* danych została powiązana z kontrolki GridView.</span><span class="sxs-lookup"><span data-stu-id="1054d-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="1054d-170">Proces wiązania danych są gromadzone hierarchii kontrolki GridView s, który w rzeczywistości jest po prostu `Table` wystąpienia składa się z kolekcji wierszy, każdy z nich składa się z kolekcji komórek.</span><span class="sxs-lookup"><span data-stu-id="1054d-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="1054d-171">W szczególności zawiera kolekcję kontrolki GridView s `Table` obiektu w jego katalogu głównego, `GridViewRow` (który jest tworzony na podstawie `TableRow` klasy) dla każdego rekordu w `DataSource` powiązany z GridView i `TableCell` obiektu w każdym `GridViewRow` wystąpienia dla każdego pola danych w `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="1054d-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="1054d-172">Aby dodać separator wierszy między poszczególnymi grupami sortowania, firma Microsoft bezpośrednio manipulować tej hierarchii kontroli po jego utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="1054d-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="1054d-173">Firma Microsoft mieć pewność, że utworzono hierarchii kontroli s GridView po raz ostatni przez razem, gdy strona jest renderowany.</span><span class="sxs-lookup"><span data-stu-id="1054d-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="1054d-174">W związku z tym, ta metoda zastępuje `Page` klasy s `Render` metody, w tym momencie hierarchii kontroli końcowego s GridView została zaktualizowana do wymaganych separatora wierszy.</span><span class="sxs-lookup"><span data-stu-id="1054d-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="1054d-175">Rysunek 4 przedstawia ten proces.</span><span class="sxs-lookup"><span data-stu-id="1054d-175">Figure 4 illustrates this process.</span></span>


[![A<span data-ttu-id="1054d-176">n technika alternatywne manipuluje hierarchii kontroli GridView s]</span><span class="sxs-lookup"><span data-stu-id="1054d-176">n Alternate Technique Manipulates the GridView s Control Hierarchy]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)

<span data-ttu-id="1054d-177">**Rysunek 4**: Technikę alternatywne manipuluje s GridView hierarchii kontroli ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="1054d-178">W tym samouczku użyjemy to drugie podejście do dostosowywania interfejsu użytkownika sortowania.</span><span class="sxs-lookup"><span data-stu-id="1054d-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="1054d-179">Kod I m prezentować w ramach tego samouczka jest oparta na przykład podany w [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) wpis w blogu s [odtwarzanie bitowej przy użyciu GridView sortowania grupowania](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="1054d-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="1054d-180">Krok 3. Dodawanie wierszy Separator do hierarchii kontroli s GridView</span><span class="sxs-lookup"><span data-stu-id="1054d-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="1054d-181">Ponieważ chcemy dodać separator wierszy do hierarchii kontroli s GridView, po utworzeniu hierarchii kontroli i utworzony po raz ostatni w tym odwiedź stronę, chcemy wykonać to dodawanie na koniec cyklu życia strony, ale przed rzeczywiste c GridView Hierarchia ontrola zostało wyrenderowane w kodzie HTML.</span><span class="sxs-lookup"><span data-stu-id="1054d-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="1054d-182">Najnowszy punkt możliwe, w którym firma Microsoft można to zrobić jest `Page` klasy s `Render` zdarzenie, które firma Microsoft może zastąpić w naszych osobna klasa kodu za pomocą następujący podpis metody:</span><span class="sxs-lookup"><span data-stu-id="1054d-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="1054d-183">Gdy `Page` klasy s, oryginalnym `Render` wywoływana jest metoda `base.Render(writer)` każdej kontrolki na stronie będzie renderowana, generowanie kodu znaczników na podstawie ich hierarchii kontroli.</span><span class="sxs-lookup"><span data-stu-id="1054d-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="1054d-184">W związku z tym należy bezwzględnie o obu rozmowę `base.Render(writer)`, dzięki czemu wyrenderowaniu strony i możemy manipulować nimi GridView s kontrolować hierarchii przed wywołaniem `base.Render(writer)`, dzięki czemu separator wierszy zostały dodane do hierarchii kontroli s GridView przed nią s został renderowane.</span><span class="sxs-lookup"><span data-stu-id="1054d-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="1054d-185">Można wstrzyknąć nagłówków grup sortowania najpierw należy upewnić się, że użytkownik zażądał, czy dane można sortować.</span><span class="sxs-lookup"><span data-stu-id="1054d-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="1054d-186">Domyślnie zawartość widoku GridView s nie są sortowane i w związku z tym firma Microsoft don t musisz wprowadzić dowolną grupę sortowanie nagłówków.</span><span class="sxs-lookup"><span data-stu-id="1054d-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="1054d-187">GridView ma zostać posortowana według określonej kolumny, po pierwszym załadowaniu strony należy wywołać metodę GridView `Sort` metoda pierwszej wizyty strony (ale nie kolejnych ogłaszania zwrotnego).</span><span class="sxs-lookup"><span data-stu-id="1054d-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="1054d-188">Aby to osiągnąć, należy dodać to wywołanie w `Page_Load` programu obsługi zdarzeń w ramach `if (!Page.IsPostBack)` warunkowe.</span><span class="sxs-lookup"><span data-stu-id="1054d-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="1054d-189">Odwołaj się do [stronicowanie i sortowanie danych raportu](paging-and-sorting-report-data-vb.md) informacji samouczka, aby uzyskać więcej informacji na temat `Sort` metody.</span><span class="sxs-lookup"><span data-stu-id="1054d-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="1054d-190">Przy założeniu, że dane zostały posortowane, naszym kolejnym krokiem jest określenie kolumny danych posortowano według, a następnie skanowania wierszy szukasz różnice w tej kolumnie s wartości.</span><span class="sxs-lookup"><span data-stu-id="1054d-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="1054d-191">Poniższy kod gwarantuje, że dane została posortowana i umożliwia znalezienie kolumny za pomocą którego została posortowana danych:</span><span class="sxs-lookup"><span data-stu-id="1054d-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="1054d-192">Jeśli ma widoku GridView jeszcze być sortowane, GridView s `SortExpression` właściwość będzie nie ustawiono.</span><span class="sxs-lookup"><span data-stu-id="1054d-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="1054d-193">W związku z tym tylko chcemy dodać separator wierszy, jeśli ta właściwość ma kilka wartości.</span><span class="sxs-lookup"><span data-stu-id="1054d-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="1054d-194">Jeśli tak jest, następnie należy określić indeks kolumny za pomocą którego została posortowana danych.</span><span class="sxs-lookup"><span data-stu-id="1054d-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="1054d-195">Jest to osiągane przez pętli GridView s `Columns` kolekcji, wyszukując kolumny, których `SortExpression` właściwości jest równa GridView s `SortExpression` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1054d-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="1054d-196">Oprócz indeksu kolumny s, możemy również Pobierz `HeaderText` właściwość, która jest używana podczas wyświetlania separatora wierszy.</span><span class="sxs-lookup"><span data-stu-id="1054d-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="1054d-197">Indeks kolumny, według której dane są sortowane ostatnim krokiem jest wyliczanie wierszy GridView.</span><span class="sxs-lookup"><span data-stu-id="1054d-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="1054d-198">Dla każdego wiersza należy ustalić, czy wartość s kolumna posortowanego różni się od poprzedniej wartości s kolumny s posortowanych wierszy.</span><span class="sxs-lookup"><span data-stu-id="1054d-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="1054d-199">Jeśli tak więc należy wstawić nową `GridViewRow` wystąpienia w hierarchii kontroli.</span><span class="sxs-lookup"><span data-stu-id="1054d-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="1054d-200">Jest to realizowane przy użyciu następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="1054d-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="1054d-201">Ten kod uruchamia programowo odwołując `Table` obiektu znalezione w folderze głównym hierarchii kontroli s GridView i utworzenie zmiennej ciągu o nazwie `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="1054d-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> `lastValue` <span data-ttu-id="1054d-202">Służy do porównywania wartości bieżącego wiersza s sortowane kolumny z poprzedniej wartości wiersza s.</span><span class="sxs-lookup"><span data-stu-id="1054d-202">is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="1054d-203">Następnie, GridView s `Rows` kolekcji są wyliczane dla każdego wiersza wartości kolumna posortowanego jest ona przechowywana w `currentValue` zmiennej.</span><span class="sxs-lookup"><span data-stu-id="1054d-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="1054d-204">Do określenia wartości kolumny określonego wiersza s sortowane używam komórki s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1054d-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="1054d-205">To działa dobrze w przypadku BoundFields, ale będzie nie działa zgodnie z potrzebami, w przypadku kontrolek TemplateField, CheckBoxFields i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="1054d-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="1054d-206">Omówimy sposób konta alternatywne pól GridView wkrótce.</span><span class="sxs-lookup"><span data-stu-id="1054d-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="1054d-207">`currentValue` i `lastValue` zmienne są porównywane.</span><span class="sxs-lookup"><span data-stu-id="1054d-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="1054d-208">Jeśli będą się różnić musimy dodać nowy wiersz separator do hierarchii kontroli.</span><span class="sxs-lookup"><span data-stu-id="1054d-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="1054d-209">Jest to realizowane poprzez określenie indeks `GridViewRow` w `Table` obiektu s `Rows` kolekcji, tworzenie nowych `GridViewRow` i `TableCell` wystąpień, a następnie dodając `TableCell` i `GridViewRow` do hierarchii kontroli.</span><span class="sxs-lookup"><span data-stu-id="1054d-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="1054d-210">Należy pamiętać, że separator wierszy s pojedynczy `TableCell` jest sformatowany w taki sposób, że obejmuje całą szerokość GridView, jest formatowana przy użyciu `SortHeaderRowStyle` klasy CSS i jego `Text` takie pokazuje grupy sortowania nazwa właściwości (na przykład kategoria) i Wartość s grupy (na przykład Beverages).</span><span class="sxs-lookup"><span data-stu-id="1054d-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="1054d-211">Na koniec `lastValue` został zaktualizowany do wartości `currentValue`.</span><span class="sxs-lookup"><span data-stu-id="1054d-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="1054d-212">Klasy CSS, używany do formatowania sortowania wiersz nagłówka grupy `SortHeaderRowStyle` musi być określona w `Styles.css` pliku.</span><span class="sxs-lookup"><span data-stu-id="1054d-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="1054d-213">Możesz skorzystać, niezależnie od ustawienia stylu odwołania się do Ciebie; Czy mogę używane następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="1054d-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="1054d-214">Przy użyciu bieżącego kodu interfejsu sortowania dodaje nagłówków grup sortowania, gdy sortowanie według dowolnego elementu BoundField (zobacz rysunek 5, która zawiera zrzut ekranu podczas sortowania przez dostawcę).</span><span class="sxs-lookup"><span data-stu-id="1054d-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="1054d-215">Jednak podczas sortowania przez inny typ pola (na przykład CheckBoxField lub TemplateField) sortowania grupy nagłówki są nigdzie nie można odnaleźć (patrz rysunek 6).</span><span class="sxs-lookup"><span data-stu-id="1054d-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


[![T<span data-ttu-id="1054d-216">ADAM sortowanie interfejsu obejmuje sortowania grupy nagłówki sortowanie według BoundFields]</span><span class="sxs-lookup"><span data-stu-id="1054d-216">he Sorting Interface Includes Sort Group Headers When Sorting by BoundFields]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)

<span data-ttu-id="1054d-217">**Rysunek 5**: Sortowanie interfejsu obejmuje sortowania grupy nagłówków podczas sortowania przez BoundFields ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


[![T<span data-ttu-id="1054d-218">HE sortowania grupy nagłówki są Brak podczas sortowania CheckBoxField]</span><span class="sxs-lookup"><span data-stu-id="1054d-218">he Sort Group Headers are Missing When Sorting a CheckBoxField]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)

<span data-ttu-id="1054d-219">**Rysunek 6**: Nagłówki grupy sortowania są, Brak podczas sortowania CheckBoxField ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="1054d-220">Przyczyną nagłówków grup sortowania występują, gdy sortowanie według CheckBoxField jest kod aktualnie używa tylko `TableCell` s `Text` właściwości w celu określenia wartości posortowanej kolumny dla każdego wiersza.</span><span class="sxs-lookup"><span data-stu-id="1054d-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="1054d-221">Dla CheckBoxFields `TableCell` s `Text` właściwości jest ciągiem pustym; zamiast tego wartość jest dostępna za pośrednictwem formant pola wyboru w sieci Web, który znajduje się w obrębie `TableCell` s `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="1054d-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="1054d-222">Do obsługi pola typów innych niż BoundFields, należy rozszerzyć kod gdzie `currentValue` zmienna jest przypisywana do sprawdzenia istnienia pola wyboru w `TableCell` s `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="1054d-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="1054d-223">Zamiast używania `currentValue = gvr.Cells(sortColumnIndex).Text`, Zastąp kod następującym kodem:</span><span class="sxs-lookup"><span data-stu-id="1054d-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="1054d-224">Ten kod sprawdza, czy kolumna posortowanego `TableCell` dla bieżącego wiersza w celu określenia, czy formanty w `Controls` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="1054d-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="1054d-225">Jeśli istnieją, a pierwszy formant jest to pole wyboru, `currentValue` zmienna jest ustawiona tak lub nie, w zależności od s wyboru `Checked` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1054d-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="1054d-226">W przeciwnym razie wartość jest pobierana z `TableCell` s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1054d-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="1054d-227">Tę logikę można replikować do obsługi sortowania dla wszelkich kontrolek TemplateField, który może znajdować się w widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="1054d-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="1054d-228">Dodając kod powyżej, nagłówków grup sortowania są teraz, gdy sortowanie według CheckBoxField zakończona (zobacz rysunek 7).</span><span class="sxs-lookup"><span data-stu-id="1054d-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


[![T<span data-ttu-id="1054d-229">HE sortowania grupy nagłówki są teraz obecny podczas sortowania CheckBoxField]</span><span class="sxs-lookup"><span data-stu-id="1054d-229">he Sort Group Headers are Now Present When Sorting a CheckBoxField]</span></span>(creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)

<span data-ttu-id="1054d-230">**Rysunek 7**: Nagłówki grupy sortowania są teraz obecny podczas sortowania CheckBoxField ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="1054d-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1054d-231">W przypadku produktów dzięki `NULL` bazy danych wartości `CategoryID`, `SupplierID`, lub `UnitPrice` pól, te wartości będą wyświetlane jako puste ciągi w widoku GridView domyślnie, co oznacza separator tekst wiersza s dla tych produktów z `NULL`odczyta wartości takich jak kategoria: (czyli tam s Brak nazwy po kategorii: za pomocą kategorii, takich jak: Beverages).</span><span class="sxs-lookup"><span data-stu-id="1054d-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="1054d-232">Jeśli chcesz użyć wartości wyświetlane w tym miejscu można ustawić BoundFields [ `NullDisplayText` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) tekstu mają być wyświetlane lub Dodaj instrukcję warunkową w metodzie renderowania podczas przypisywania `currentValue` do separatora Wiersz s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="1054d-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="1054d-233">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="1054d-233">Summary</span></span>

<span data-ttu-id="1054d-234">Kontrolki GridView nie zawiera wiele wbudowanych opcji dostosowywania interfejsu sortowania.</span><span class="sxs-lookup"><span data-stu-id="1054d-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="1054d-235">Jednak w przypadku znacznej liczby niskiego poziomu kodu go s umożliwia dostosowanie hierarchię GridView s kontroli w celu utworzenia bardziej dostosowanego interfejsu.</span><span class="sxs-lookup"><span data-stu-id="1054d-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="1054d-236">Jak dodać wiersz separatora grupy sortowania dla GridView można sortować, łatwiej identyfikuje różne grupy i tych grup granic widzieliśmy w ramach tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="1054d-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="1054d-237">Aby uzyskać więcej przykładów niestandardowych interfejsów sortowania, zapoznaj się [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [kilka ASP.NET 2.0 GridView sortowanie porady i wskazówki](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) wpis w blogu.</span><span class="sxs-lookup"><span data-stu-id="1054d-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="1054d-238">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="1054d-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1054d-239">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="1054d-239">About the Author</span></span>

<span data-ttu-id="1054d-240">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="1054d-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1054d-241">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="1054d-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1054d-242">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1054d-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1054d-243">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1054d-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1054d-244">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1054d-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="1054d-245">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="1054d-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
