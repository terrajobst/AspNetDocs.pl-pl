---
uid: web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
title: Używanie zależności pamięci podręcznej SQL (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: Najprostsza strategii buforowania jest umożliwienie dane w pamięci podręcznej wygasa po upływie określonego czasu. Jednak takie proste podejście oznacza, że maintai dane w pamięci podręcznej...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: bd347d93-4251-4532-801c-a36f2dfa7f96
msc.legacyurl: /web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
msc.type: authoredcontent
ms.openlocfilehash: b1660c0d20b76d97ee00acf1080c3eca1f596be2
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/17/2019
ms.locfileid: "59412674"
---
# <a name="using-sql-cache-dependencies-vb"></a><span data-ttu-id="378a3-104">Używanie zależności pamięci podręcznej SQL (VB)</span><span class="sxs-lookup"><span data-stu-id="378a3-104">Using SQL Cache Dependencies (VB)</span></span>

<span data-ttu-id="378a3-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="378a3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="378a3-106">[Pobierz program Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) lub [Pobierz plik PDF](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="378a3-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) or [Download PDF](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span></span>

> <span data-ttu-id="378a3-107">Najprostsza strategii buforowania jest umożliwienie dane w pamięci podręcznej wygasa po upływie określonego czasu.</span><span class="sxs-lookup"><span data-stu-id="378a3-107">The simplest caching strategy is to allow cached data to expire after a specified period of time.</span></span> <span data-ttu-id="378a3-108">Ale to proste podejście oznacza, że dane w pamięci podręcznej przechowuje żaden związek z jego źródle danych, co nieaktualnych danych, które odbywa się za długa lub bieżących danych, który wygasł zbyt szybko.</span><span class="sxs-lookup"><span data-stu-id="378a3-108">But this simple approach means that the cached data maintains no association with its underlying data source, resulting in stale data that is held too long or current data that is expired too soon.</span></span> <span data-ttu-id="378a3-109">Lepszym rozwiązaniem jest korzystanie z klasy SqlCacheDependency, tak aby danych pozostaje w pamięci podręcznej do momentu jego danych źródłowych został zmodyfikowany w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-109">A better approach is to use the SqlCacheDependency class so that data remains cached until its underlying data has been modified in the SQL database.</span></span> <span data-ttu-id="378a3-110">Ten samouczek pokazuje sposób.</span><span class="sxs-lookup"><span data-stu-id="378a3-110">This tutorial shows you how.</span></span>


## <a name="introduction"></a><span data-ttu-id="378a3-111">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="378a3-111">Introduction</span></span>

<span data-ttu-id="378a3-112">Techniki buforowania badany w [buforowanie danych za pomocą kontrolki ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) i [buforowania danych w architekturze](caching-data-in-the-architecture-vb.md) samouczki umożliwia wykluczenie danych z pamięci podręcznej po określonym na podstawie czasu wygaśnięcia okres.</span><span class="sxs-lookup"><span data-stu-id="378a3-112">The caching techniques examined in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) and [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorials used a time-based expiry to evict the data from the cache after a specified period.</span></span> <span data-ttu-id="378a3-113">To podejście jest najprostszym sposobem równoważyć wzrosła wydajność takich buforowania względem nieaktualność danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-113">This approach is the simplest way to balance the performance gains of caching against data staleness.</span></span> <span data-ttu-id="378a3-114">Wybierając czas wygaśnięcia *x* (w sekundach), deweloper strony concedes do korzystania z zalet wydajności buforowanie tylko *x* (w sekundach), ale umieścić proste czy jej dane nigdy nie będą nieaktualne dłuższy niż maksimum z *x* sekund.</span><span class="sxs-lookup"><span data-stu-id="378a3-114">By selecting a time expiry of *x* seconds, a page developer concedes to enjoy the performance benefits of caching for only *x* seconds, but can rest easy that her data will never be stale longer than a maximum of *x* seconds.</span></span> <span data-ttu-id="378a3-115">Oczywiście w przypadku danych statycznych *x* może zostać rozszerzony do cyklu życia aplikacji sieci web, jak zostały sprawdzone w [buforowanie danych przy uruchamianiu aplikacji](caching-data-at-application-startup-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="378a3-115">Of course, for static data, *x* can be extended to the lifetime of the web application, as was examined in the [Caching Data at Application Startup](caching-data-at-application-startup-vb.md) tutorial.</span></span>

<span data-ttu-id="378a3-116">Podczas buforowania danych bazy danych, na podstawie czasu wygaśnięcia często jest wybierany w celu ułatwienia jej, ale często jest niewystarczająca rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="378a3-116">When caching database data, a time-based expiry is often chosen for its ease of use but is frequently an inadequate solution.</span></span> <span data-ttu-id="378a3-117">W idealnym przypadku danych w bazie danych może pozostać w pamięci podręcznej aż danych bazowych został zmodyfikowany w bazie danych. dopiero wtedy będzie można wykluczyć pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-117">Ideally, the database data would remain cached until the underlying data has been modified in the database; only then would the cache be evicted.</span></span> <span data-ttu-id="378a3-118">To podejście zapewnia korzyści w zakresie wydajności buforowania i minimalizuje czas trwania nieaktualnych danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-118">This approach maximizes the performance benefits of caching and minimizes the duration of stale data.</span></span> <span data-ttu-id="378a3-119">Jednakże aby móc korzystać z tych korzyści, musi być system w miejscu, który wie, kiedy podstawowych danych w bazie danych została zmodyfikowana i wyklucza mogą odpowiednie elementy z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-119">However, in order to enjoy these benefits there must be some system in place that knows when the underlying database data has been modified and evicts the corresponding items from the cache.</span></span> <span data-ttu-id="378a3-120">Przed ASP.NET 2.0 programistom stron były odpowiedzialne za wykonanie tego systemu.</span><span class="sxs-lookup"><span data-stu-id="378a3-120">Prior to ASP.NET 2.0, page developers were responsible for implementing this system.</span></span>

<span data-ttu-id="378a3-121">Program ASP.NET 2.0 zapewnia [ `SqlCacheDependency` klasy](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) i infrastruktury wymaganej do określenia, kiedy nastąpiła zmiana w bazie danych, aby odpowiednie pamięci podręcznej elementów może zostać wykluczony.</span><span class="sxs-lookup"><span data-stu-id="378a3-121">ASP.NET 2.0 provides a [`SqlCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) and the necessary infrastructure to determine when a change has occurred in the database so that the corresponding cached items can be evicted.</span></span> <span data-ttu-id="378a3-122">Istnieją dwie techniki do określania, kiedy zmienił danych bazowych: powiadomienie i sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-122">There are two techniques for determining when the underlying data has changed: notification and polling.</span></span> <span data-ttu-id="378a3-123">Po omówieniu różnice między powiadomień, jak i sondowanie, utworzymy infrastruktury niezbędnych do obsługi sondowania i zobacz, jak możesz używać `SqlCacheDependency` klasy w deklaracyjne i programowe scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="378a3-123">After discussing the differences between notification and polling, we'll create the infrastructure necessary to support polling and then explore how to use the `SqlCacheDependency` class in declarative and programmatically scenarios.</span></span>

## <a name="understanding-notification-and-polling"></a><span data-ttu-id="378a3-124">Opis powiadomienia i sondowania</span><span class="sxs-lookup"><span data-stu-id="378a3-124">Understanding Notification and Polling</span></span>

<span data-ttu-id="378a3-125">Istnieją dwie techniki, które mogą służyć do określenia, kiedy dane w bazie danych zostały zmodyfikowane: powiadomienie i sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-125">There are two techniques that can be used to determine when the data in a database has been modified: notification and polling.</span></span> <span data-ttu-id="378a3-126">Z zastrzeżeniem bazy danych automatycznie powiadamia środowiska uruchomieniowego programu ASP.NET, gdy wyniki zapytania określonego zostały zmienione od czasu ostatniego wykonania zapytania, w tym momencie obrazuje elementy pamięci podręcznej skojarzonej z zapytaniem.</span><span class="sxs-lookup"><span data-stu-id="378a3-126">With notification, the database automatically alerts the ASP.NET runtime when the results of a particular query have been changed since the query was last executed, at which point the cached items associated with the query are evicted.</span></span> <span data-ttu-id="378a3-127">Za pomocą sondowania, serwer bazy danych przechowuje informacje o kiedy konkretne tabele mają miejsce ostatnia aktualizacja.</span><span class="sxs-lookup"><span data-stu-id="378a3-127">With polling, the database server maintains information about when particular tables have last been updated.</span></span> <span data-ttu-id="378a3-128">Środowisko uruchomieniowe ASP.NET okresowo sonduje bazy danych, aby sprawdzić, jakie tabele zostały zmienione od momentu ich wprowadzenia do pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-128">The ASP.NET runtime periodically polls the database to check what tables have changed since they were entered into the cache.</span></span> <span data-ttu-id="378a3-129">Te tabele, których dane zostały zmodyfikowane ma ich elementów pamięci podręcznej skojarzonych wykluczona.</span><span class="sxs-lookup"><span data-stu-id="378a3-129">Those tables whose data has been modified have their associated cache items evicted.</span></span>

<span data-ttu-id="378a3-130">Opcja powiadomienie wymaga mniej konfiguracji niż sondowania i jest bardziej szczegółowego, ponieważ śledzi zmiany na poziomie zapytania, a nie na poziomie tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-130">The notification option requires less setup than polling and is more granular since it tracks changes at the query level rather than at the table level.</span></span> <span data-ttu-id="378a3-131">Niestety powiadomienia są dostępne tylko w pełne wersje programu Microsoft SQL Server 2005 (tj. wersje non-Express).</span><span class="sxs-lookup"><span data-stu-id="378a3-131">Unfortunately, notifications are only available in the full editions of Microsoft SQL Server 2005 (i.e., the non-Express editions).</span></span> <span data-ttu-id="378a3-132">Jednak opcja sondowania może służyć dla wszystkich wersji programu Microsoft SQL Server w wersji 7.0 do 2005.</span><span class="sxs-lookup"><span data-stu-id="378a3-132">However, the polling option can be used for all versions of Microsoft SQL Server from 7.0 to 2005.</span></span> <span data-ttu-id="378a3-133">Ponieważ te samouczki używać wydaniu Express programu SQL Server 2005, skupimy się na konfigurowaniu i przy użyciu opcji sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-133">Since these tutorials use the Express edition of SQL Server 2005, we will focus on setting up and using the polling option.</span></span> <span data-ttu-id="378a3-134">Na końcu niniejszego samouczka, aby dalsze zasoby przy użyciu funkcji programu SQL Server 2005 s powiadomień, zapoznaj się w sekcji dalszego czytania.</span><span class="sxs-lookup"><span data-stu-id="378a3-134">Consult the Further Reading section at the end of this tutorial for further resources on SQL Server 2005 s notification capabilities.</span></span>

<span data-ttu-id="378a3-135">Za pomocą sondowania, baza danych musi być skonfigurowany do zawierać tabelę o nazwie `AspNet_SqlCacheTablesForChangeNotification` zawierający trzy kolumny — `tableName`, `notificationCreated`, i `changeId`.</span><span class="sxs-lookup"><span data-stu-id="378a3-135">With polling, the database must be configured to include a table named `AspNet_SqlCacheTablesForChangeNotification` that has three columns - `tableName`, `notificationCreated`, and `changeId`.</span></span> <span data-ttu-id="378a3-136">Ta tabela zawiera wiersz dla każdej tabeli, która zawiera dane, w których konieczna może być używany w pamięci podręcznej zależności SQL w aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="378a3-136">This table contains a row for each table that has data that might need to be used in a SQL cache dependency in the web application.</span></span> <span data-ttu-id="378a3-137">`tableName` Kolumna określa nazwę tabeli podczas `notificationCreated` określa datę i godzinę wiersz został dodany do tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-137">The `tableName` column specifies the name of the table while `notificationCreated` indicates the date and time the row was added to the table.</span></span> <span data-ttu-id="378a3-138">`changeId` Kolumna jest kolumną typu `int` i ma początkowa wartość 0.</span><span class="sxs-lookup"><span data-stu-id="378a3-138">The `changeId` column is of type `int` and has an initial value of 0.</span></span> <span data-ttu-id="378a3-139">Jego wartość jest zwiększany po każdej modyfikacji do tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-139">Its value is incremented with each modification to the table.</span></span>

<span data-ttu-id="378a3-140">Oprócz `AspNet_SqlCacheTablesForChangeNotification` tabeli bazy danych również musi zawierać Wyzwalacze w każdej z tabel, które mogą się pojawić w pamięci podręcznej zależność SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-140">In addition to the `AspNet_SqlCacheTablesForChangeNotification` table, the database also needs to include triggers on each of the tables that may appear in a SQL cache dependency.</span></span> <span data-ttu-id="378a3-141">Te wyzwalacze są wykonywane zawsze, gdy wstawione, zaktualizowane lub usunięte wiersz i zwiększ tabeli s `changeId` wartość w `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="378a3-141">These triggers are executed whenever a row is inserted, updated, or deleted and increment the table s `changeId` value in `AspNet_SqlCacheTablesForChangeNotification`.</span></span>

<span data-ttu-id="378a3-142">Środowisko uruchomieniowe ASP.NET śledzi bieżącą `changeId` dla tabeli, gdy buforowanie danych przy użyciu `SqlCacheDependency` obiektu.</span><span class="sxs-lookup"><span data-stu-id="378a3-142">The ASP.NET runtime tracks the current `changeId` for a table when caching data using a `SqlCacheDependency` object.</span></span> <span data-ttu-id="378a3-143">Okresowo zaznaczono opcję bazy danych oraz wszelką `SqlCacheDependency` obiekty, których `changeId` różni się od wartości w bazie danych obrazuje od różniących się `changeId` wartość wskazuje, czy wprowadzono zmiany do tabeli, ponieważ dane był buforowany.</span><span class="sxs-lookup"><span data-stu-id="378a3-143">The database is periodically checked and any `SqlCacheDependency` objects whose `changeId` differs from the value in the database are evicted since a differing `changeId` value indicates that there has been a change to the table since the data was cached.</span></span>

## <a name="step-1-exploring-theaspnetregsqlexecommand-line-program"></a><span data-ttu-id="378a3-144">Krok 1. Eksplorowanie`aspnet_regsql.exe`wiersza polecenia</span><span class="sxs-lookup"><span data-stu-id="378a3-144">Step 1: Exploring the`aspnet_regsql.exe`Command Line Program</span></span>

<span data-ttu-id="378a3-145">Dzięki podejściu sondowania bazy danych musi być skonfigurowany zawierać infrastruktury opisane powyżej: wstępnie zdefiniowanej tabeli (`AspNet_SqlCacheTablesForChangeNotification`), kilka procedur składowanych i wyzwalaczy w każdej z tabel, które mogą być używane w zależności pamięci podręcznej SQL w sieci web aplikacja.</span><span class="sxs-lookup"><span data-stu-id="378a3-145">With the polling approach the database must be setup to contain the infrastructure described above: a predefined table (`AspNet_SqlCacheTablesForChangeNotification`), a handful of stored procedures, and triggers on each of the tables that may be used in SQL cache dependencies in the web application.</span></span> <span data-ttu-id="378a3-146">Tych tabel, procedur składowanych i wyzwalaczy można utworzyć za pomocą wiersza polecenia programu `aspnet_regsql.exe`, który znajduje się w `$WINDOWS$\Microsoft.NET\Framework\version` folderu.</span><span class="sxs-lookup"><span data-stu-id="378a3-146">These tables, stored procedures, and triggers can be created through the command line program `aspnet_regsql.exe`, which is found in the `$WINDOWS$\Microsoft.NET\Framework\version` folder.</span></span> <span data-ttu-id="378a3-147">Aby utworzyć `AspNet_SqlCacheTablesForChangeNotification` tabeli i skojarzone procedur składowanych, uruchom następujące polecenie w wierszu polecenia:</span><span class="sxs-lookup"><span data-stu-id="378a3-147">To create the `AspNet_SqlCacheTablesForChangeNotification` table and associated stored procedures, run the following from the command line:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="378a3-148">Aby wykonać te polecenia logowania określona baza danych musi znajdować się w [ `db_securityadmin` ](https://msdn.microsoft.com/library/ms188685.aspx) i [ `db_ddladmin` ](https://msdn.microsoft.com/library/ms190667.aspx) ról.</span><span class="sxs-lookup"><span data-stu-id="378a3-148">To execute these commands the specified database login must be in the [`db_securityadmin`](https://msdn.microsoft.com/library/ms188685.aspx) and [`db_ddladmin`](https://msdn.microsoft.com/library/ms190667.aspx) roles.</span></span> <span data-ttu-id="378a3-149">Aby zbadać języka T-SQL wysyłane do bazy danych przez `aspnet_regsql.exe` program wiersza polecenia, zobacz [ten wpis w blogu](http://scottonwriting.net/sowblog/posts/10709.aspx).</span><span class="sxs-lookup"><span data-stu-id="378a3-149">To examine the T-SQL sent to the database by the `aspnet_regsql.exe` command line program, refer to [this blog entry](http://scottonwriting.net/sowblog/posts/10709.aspx).</span></span>


<span data-ttu-id="378a3-150">Na przykład, aby dodać infrastruktury do sondowania z bazą danych programu Microsoft SQL Server o nazwie `pubs` na serwerze bazy danych o nazwie `ScottsServer` przy użyciu uwierzytelniania Windows, przejdź do odpowiedniego katalogu i, w wierszu polecenia wpisz:</span><span class="sxs-lookup"><span data-stu-id="378a3-150">For example, to add the infrastructure for polling to a Microsoft SQL Server database named `pubs` on a database server named `ScottsServer` using Windows Authentication, navigate to the appropriate directory and, from the command line, enter:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample2.cmd)]

<span data-ttu-id="378a3-151">Po dodaniu infrastruktury poziomu bazy danych należy dodać wyzwalacze do tych tabel, które będą używane w zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-151">After the database-level infrastructure has been added, we need to add the triggers to those tables that will be used in SQL cache dependencies.</span></span> <span data-ttu-id="378a3-152">Użyj `aspnet_regsql.exe` wiersza polecenia programu ponownie, ale określ za pomocą nazwy tabeli `-t` przełącznika i zamiast `-ed` Przełącz użyj `-et`, w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="378a3-152">Use the `aspnet_regsql.exe` command line program again, but specify the table name using the `-t` switch and instead of using the `-ed` switch use `-et`, like so:</span></span>


[!code-html[Main](using-sql-cache-dependencies-vb/samples/sample3.html)]

<span data-ttu-id="378a3-153">Aby dodać wyzwalaczy, aby `authors` i `titles` tabel na `pubs` bazy danych na `ScottsServer`, użyj:</span><span class="sxs-lookup"><span data-stu-id="378a3-153">To add the triggers to the `authors` and `titles` tables on the `pubs` database on `ScottsServer`, use:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample4.cmd)]

<span data-ttu-id="378a3-154">W tym samouczku dodane wyzwalaczy, aby `Products`, `Categories`, i `Suppliers` tabel.</span><span class="sxs-lookup"><span data-stu-id="378a3-154">For this tutorial add the triggers to the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="378a3-155">Omówimy składni konkretnego wiersza polecenia w kroku 3.</span><span class="sxs-lookup"><span data-stu-id="378a3-155">We'll look at the particular command line syntax in Step 3.</span></span>

## <a name="step-2-referencing-a-microsoft-sql-server-2005-express-edition-database-inappdata"></a><span data-ttu-id="378a3-156">Krok 2. Odwoływanie się do programu Microsoft SQL Server 2005 Express Edition bazy danych w`App_Data`</span><span class="sxs-lookup"><span data-stu-id="378a3-156">Step 2: Referencing a Microsoft SQL Server 2005 Express Edition Database in`App_Data`</span></span>

<span data-ttu-id="378a3-157">`aspnet_regsql.exe` Wiersza polecenia programu wymaga nazwy bazy danych i serwera, aby można było dodać infrastruktury niezbędnych sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-157">The `aspnet_regsql.exe` command line program requires the database and server name in order to add the necessary polling infrastructure.</span></span> <span data-ttu-id="378a3-158">Ale co to jest nazwa bazy danych i serwera dla programu Microsoft SQL Server 2005 Express bazy danych, która znajduje się w `App_Data` folder?</span><span class="sxs-lookup"><span data-stu-id="378a3-158">But what is the database and server name for a Microsoft SQL Server 2005 Express database that resides in the `App_Data` folder?</span></span> <span data-ttu-id="378a3-159">Zamiast konieczności Odkryj, jakie są nazwy bazy danych i serwera, czy ve wykrył, że najprostszą metodą jest się można dołączyć bazy danych do `localhost\SQLExpress` bazy danych wystąpienia, a następnie zmień nazwę dane za pomocą [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span><span class="sxs-lookup"><span data-stu-id="378a3-159">Rather than having to discover what the database and server names are, I ve found that the simplest approach is to attach the database to the `localhost\SQLExpress` database instance and rename the data using [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span></span> <span data-ttu-id="378a3-160">Jeśli masz pełne wersje zainstalowane na komputerze programu SQL Server 2005, następnie prawdopodobnie masz już zainstalowany na tym komputerze program SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="378a3-160">If you have one of the full versions of SQL Server 2005 installed on your machine, then you likely already have SQL Server Management Studio installed on your computer.</span></span> <span data-ttu-id="378a3-161">Jeśli masz tylko wersji Express edition, możesz pobrać bezpłatną [programu Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span><span class="sxs-lookup"><span data-stu-id="378a3-161">If you only have the Express edition, you can download the free [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span></span>

<span data-ttu-id="378a3-162">Rozpocznij od zamknięcia programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="378a3-162">Start by closing Visual Studio.</span></span> <span data-ttu-id="378a3-163">Następnie otwórz program SQL Server Management Studio i wybierz opcję nawiązać połączenie `localhost\SQLExpress` serwera przy użyciu uwierzytelniania Windows.</span><span class="sxs-lookup"><span data-stu-id="378a3-163">Next, open SQL Server Management Studio and choose to connect to the `localhost\SQLExpress` server using Windows Authentication.</span></span>


![Dołącz do localhost\SQLExpress serwera](using-sql-cache-dependencies-vb/_static/image1.gif)

<span data-ttu-id="378a3-165">**Rysunek 1**: Dołącz do `localhost\SQLExpress` serwera</span><span class="sxs-lookup"><span data-stu-id="378a3-165">**Figure 1**: Attach to the `localhost\SQLExpress` Server</span></span>


<span data-ttu-id="378a3-166">Po nawiązaniu połączenia z serwerem Management Studio Pokaż serwera i podfoldery dla baz danych, zabezpieczeń i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="378a3-166">After connecting to the server, Management Studio will show the server and have subfolders for the databases, security, and so forth.</span></span> <span data-ttu-id="378a3-167">Kliknij prawym przyciskiem myszy na folder baz danych i wybierz opcję Dołącz.</span><span class="sxs-lookup"><span data-stu-id="378a3-167">Right-click on the Databases folder and choose the Attach option.</span></span> <span data-ttu-id="378a3-168">Zostanie wyświetlone okno dialogowe dołączanie bazy danych (zobacz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="378a3-168">This will bring up the Attach Databases dialog box (see Figure 2).</span></span> <span data-ttu-id="378a3-169">Kliknij przycisk Dodaj, a następnie wybierz pozycję `NORTHWND.MDF` folder bazy danych w sieci web aplikacji s `App_Data` folderu.</span><span class="sxs-lookup"><span data-stu-id="378a3-169">Click the Add button and select the `NORTHWND.MDF` database folder in your web application s `App_Data` folder.</span></span>


<span data-ttu-id="378a3-170">[![Dołącz NORTHWND. MDF bazy danych, z folderu App_Data](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-170">[![Attach the NORTHWND.MDF Database from the App_Data Folder](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span></span>

<span data-ttu-id="378a3-171">**Rysunek 2**: Dołącz `NORTHWND.MDF` bazy danych z `App_Data` Folder ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-171">**Figure 2**: Attach the `NORTHWND.MDF` Database from the `App_Data` Folder ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image2.png))</span></span>


<span data-ttu-id="378a3-172">Spowoduje to dodanie bazy danych do folderu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-172">This will add the database to the Databases folder.</span></span> <span data-ttu-id="378a3-173">Nazwa bazy danych może być pełna ścieżka do pliku bazy danych lub pełną ścieżkę poprzedzonej ciągiem [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span><span class="sxs-lookup"><span data-stu-id="378a3-173">The database name might be the full path to the database file or the full path prepended with a [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span></span> <span data-ttu-id="378a3-174">Aby uniknąć konieczności wpisywania w tej nazwie długich bazy danych, korzystając z aspnet\_regsql.exe narzędzia wiersza polecenia, Zmień nazwę dołączyć bazy danych do nazwy bardziej przyjaznego dla człowieka, klikając prawym przyciskiem myszy bazę danych po prostu i wybierając opcję zmiany nazwy.</span><span class="sxs-lookup"><span data-stu-id="378a3-174">To avoid having to type in this lengthy database name when using the aspnet\_regsql.exe command line tool, rename the database to a more human-friendly name by right-clicking on database just attached and choosing Rename.</span></span> <span data-ttu-id="378a3-175">Czy mogę ve zmieniona Moja baza danych na DataTutorials.</span><span class="sxs-lookup"><span data-stu-id="378a3-175">I ve renamed my database to DataTutorials .</span></span>


![Zmień nazwę dołączonej bazie danych nazwę bardziej przyjaznego dla człowieka](using-sql-cache-dependencies-vb/_static/image3.gif)

<span data-ttu-id="378a3-177">**Rysunek 3**: Zmień nazwę dołączonej bazie danych nazwę bardziej przyjaznego dla człowieka</span><span class="sxs-lookup"><span data-stu-id="378a3-177">**Figure 3**: Rename the Attached Database to a More Human-Friendly Name</span></span>


## <a name="step-3-adding-the-polling-infrastructure-to-the-northwind-database"></a><span data-ttu-id="378a3-178">Krok 3. Dodawanie infrastruktury sondowania z bazą danych Northwind</span><span class="sxs-lookup"><span data-stu-id="378a3-178">Step 3: Adding the Polling Infrastructure to the Northwind Database</span></span>

<span data-ttu-id="378a3-179">Teraz, gdy będziemy mieć dołączone `NORTHWND.MDF` bazy danych z `App_Data` folderu, możemy ponownie gotowe do dodania infrastruktury sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-179">Now that we have attached the `NORTHWND.MDF` database from the `App_Data` folder, we re ready to add the polling infrastructure.</span></span> <span data-ttu-id="378a3-180">Przy założeniu, że był zmianie bazy danych na DataTutorials, uruchom następujące polecenia, cztery:</span><span class="sxs-lookup"><span data-stu-id="378a3-180">Assuming that you ve renamed the database to DataTutorials, run the following four commands:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample5.cmd)]

<span data-ttu-id="378a3-181">Po uruchomieniu tych poleceń cztery, kliknij prawym przyciskiem myszy nazwę bazy danych w programie Management Studio, przejdź do menu zadania, a następnie wybierz odłączania.</span><span class="sxs-lookup"><span data-stu-id="378a3-181">After running these four commands, right-click on the database name in Management Studio, go to the Tasks submenu, and choose Detach.</span></span> <span data-ttu-id="378a3-182">Następnie zamknij program Management Studio i otwórz ponownie program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="378a3-182">Then close Management Studio and reopen Visual Studio.</span></span>

<span data-ttu-id="378a3-183">Gdy program Visual Studio zawiera otwarte ponownie, należy przejść do bazy danych za pomocą Eksploratora serwera.</span><span class="sxs-lookup"><span data-stu-id="378a3-183">Once Visual Studio has reopened, drill into the database through the Server Explorer.</span></span> <span data-ttu-id="378a3-184">Należy pamiętać, nowa tabela (`AspNet_SqlCacheTablesForChangeNotification`), nowy przechowywane procedury składowane i wyzwalacze na `Products`, `Categories`, i `Suppliers` tabel.</span><span class="sxs-lookup"><span data-stu-id="378a3-184">Note the new table (`AspNet_SqlCacheTablesForChangeNotification`), the new stored procedures, and the triggers on the `Products`, `Categories`, and `Suppliers` tables.</span></span>


![Baza danych zawiera teraz infrastruktury niezbędnych sondowania](using-sql-cache-dependencies-vb/_static/image4.gif)

<span data-ttu-id="378a3-186">**Rysunek 4**: Baza danych zawiera teraz infrastruktury niezbędnych sondowania</span><span class="sxs-lookup"><span data-stu-id="378a3-186">**Figure 4**: The Database Now Includes the Necessary Polling Infrastructure</span></span>


## <a name="step-4-configuring-the-polling-service"></a><span data-ttu-id="378a3-187">Krok 4. Konfigurowanie usługi sondowania</span><span class="sxs-lookup"><span data-stu-id="378a3-187">Step 4: Configuring the Polling Service</span></span>

<span data-ttu-id="378a3-188">Po utworzeniu wymagane tabele, wyzwalaczy i procedur składowanych w bazie danych, ostatnim krokiem jest skonfigurować usługi sondowania, w którym odbywa się za pośrednictwem `Web.config` , określając baz danych i częstotliwość sondowania (w milisekundach).</span><span class="sxs-lookup"><span data-stu-id="378a3-188">After creating the needed tables, triggers, and stored procedures in the database, the final step is to configure the polling service, which is done through `Web.config` by specifying the databases to use and the polling frequency in milliseconds.</span></span> <span data-ttu-id="378a3-189">Następujące znaczniki sonduje bazy danych Northwind, co sekundę.</span><span class="sxs-lookup"><span data-stu-id="378a3-189">The following markup polls the Northwind database once every second.</span></span>


[!code-xml[Main](using-sql-cache-dependencies-vb/samples/sample6.xml)]

<span data-ttu-id="378a3-190">`name` Wartość w `<add>` — element (NorthwindDB) kojarzy nazwę zrozumiałą dla użytkownika z określoną bazą danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-190">The `name` value in the `<add>` element ( NorthwindDB ) associates a human-readable name with a particular database.</span></span> <span data-ttu-id="378a3-191">Podczas pracy z zależności pamięci podręcznej SQL, będziemy potrzebować do odwoływania się do nazwy bazy danych, zdefiniowane w tym miejscu oraz tabeli, w oparciu o dane w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-191">When working with SQL cache dependencies, we'll need to refer to the database name defined here as well as the table that the cached data is based on.</span></span> <span data-ttu-id="378a3-192">Zobaczymy, jak używać `SqlCacheDependency` klasy programowe kojarzenie zależności pamięci podręcznej SQL przy użyciu buforowanych danych w kroku 6.</span><span class="sxs-lookup"><span data-stu-id="378a3-192">We'll see how to use the `SqlCacheDependency` class to programmatically associate SQL cache dependencies with cached data in Step 6.</span></span>

<span data-ttu-id="378a3-193">Po ustanowieniu zależności pamięci podręcznej SQL, system sondowania połączy się z bazami danych zdefiniowanych w `<databases>` elementów co `pollTime` milisekund, a następnie wykonaj `AspNet_SqlCachePollingStoredProcedure` procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="378a3-193">Once a SQL cache dependency has been established, the polling system will connect to the databases defined in the `<databases>` elements every `pollTime` milliseconds and execute the `AspNet_SqlCachePollingStoredProcedure` stored procedure.</span></span> <span data-ttu-id="378a3-194">Tę procedurę składowaną — który został dodany z powrotem w kroku 3 przy użyciu `aspnet_regsql.exe` narzędzie wiersza polecenia — zwraca `tableName` i `changeId` wartości dla każdego rekordu w `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="378a3-194">This stored procedure - which was added back in Step 3 using the `aspnet_regsql.exe` command line tool - returns the `tableName` and `changeId` values for each record in `AspNet_SqlCacheTablesForChangeNotification`.</span></span> <span data-ttu-id="378a3-195">Nieaktualne zależności pamięci podręcznej SQL jest wykluczony z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-195">Outdated SQL cache dependencies are evicted from the cache.</span></span>

<span data-ttu-id="378a3-196">`pollTime` Ustawienie wprowadza zależność między wydajnością a nieaktualność danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-196">The `pollTime` setting introduces a tradeoff between performance and data staleness.</span></span> <span data-ttu-id="378a3-197">Niewielki `pollTime` wartość zwiększa się liczba żądań w bazie danych, ale więcej szybko wyklucza mogą nieaktualnych danych z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-197">A small `pollTime` value increases the number of requests to the database, but more quickly evicts stale data from the cache.</span></span> <span data-ttu-id="378a3-198">Większy `pollTime` wartość zmniejsza liczbę żądań bazy danych, ale zwiększa opóźnienia między po zmianie danych zaplecza, a kiedy obrazuje elementy pokrewne pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-198">A larger `pollTime` value reduces the number of database requests, but increases the delay between when the backend data changes and when the related cache items are evicted.</span></span> <span data-ttu-id="378a3-199">Na szczęście żądania bazy danych wykonuje prostą procedurę składowaną tego s zwracanie tylko kilka wierszy z tabeli proste, uproszczone.</span><span class="sxs-lookup"><span data-stu-id="378a3-199">Fortunately, the database request is executing a simple stored procedure that s returning just a few rows from a simple, lightweight table.</span></span> <span data-ttu-id="378a3-200">Ale eksperymentować z różnymi `pollTime` wartości, aby znaleźć idealne równowagę między bazą danych nieaktualność dostępu danych i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="378a3-200">But do experiment with different `pollTime` values to find an ideal balance between database access and data staleness for your application.</span></span> <span data-ttu-id="378a3-201">Najmniejsza `pollTime` dozwolona wartość to 500.</span><span class="sxs-lookup"><span data-stu-id="378a3-201">The smallest `pollTime` value allowed is 500.</span></span>

> [!NOTE]
> <span data-ttu-id="378a3-202">Powyższy przykład zawiera pojedynczy `pollTime` wartość w `<sqlCacheDependency>` element, ale można opcjonalnie określić `pollTime` wartość w `<add>` elementu.</span><span class="sxs-lookup"><span data-stu-id="378a3-202">The above example provides a single `pollTime` value in the `<sqlCacheDependency>` element, but you can optionally specify the `pollTime` value in the `<add>` element.</span></span> <span data-ttu-id="378a3-203">Jest to przydatne, jeśli masz wiele określonych baz danych i chcesz dostosować częstotliwość sondowania na bazę danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-203">This is useful if you have multiple databases specified and want to customize the polling frequency per database.</span></span>


## <a name="step-5-declaratively-working-with-sql-cache-dependencies"></a><span data-ttu-id="378a3-204">Krok 5. Deklaratywne Praca z zależności pamięci podręcznej SQL</span><span class="sxs-lookup"><span data-stu-id="378a3-204">Step 5: Declaratively Working with SQL Cache Dependencies</span></span>

<span data-ttu-id="378a3-205">W krokach 1 – 4 przyjrzeliśmy się instrukcje konfiguracji infrastruktury niezbędnych bazy danych i konfiguracji systemu sondowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-205">In Steps 1 through 4 we looked at how to setup the necessary database infrastructure and configure the polling system.</span></span> <span data-ttu-id="378a3-206">Za pomocą tej infrastruktury w miejscu możemy teraz Dodaj elementy do pamięci podręcznej danych z skojarzone zależności pamięci podręcznej SQL przy użyciu techniki programistyczne lub deklaratywne.</span><span class="sxs-lookup"><span data-stu-id="378a3-206">With this infrastructure in place, we can now add items to the data cache with an associated SQL cache dependency using either programmatic or declarative techniques.</span></span> <span data-ttu-id="378a3-207">W tym kroku zajmiemy się, jak deklaratywne pracować z zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-207">In this step we'll examine how to declaratively work with SQL cache dependencies.</span></span> <span data-ttu-id="378a3-208">W kroku 6 przyjrzymy rozwiązania programowego.</span><span class="sxs-lookup"><span data-stu-id="378a3-208">In Step 6 we'll look at the programmatic approach.</span></span>

<span data-ttu-id="378a3-209">[Buforowanie danych za pomocą kontrolki ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) samouczek zbadano deklaratywnych buforowania kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="378a3-209">The [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial explored the declarative caching capabilities of the ObjectDataSource.</span></span> <span data-ttu-id="378a3-210">Wystarczy ustawić `EnableCaching` właściwości `True` i `CacheDuration` właściwość pewnego interwału czasu, kontrolki ObjectDataSource zostanie automatycznie w pamięci podręcznej danych zwracanych przez jego obiekt źródłowy dla określonego interwału.</span><span class="sxs-lookup"><span data-stu-id="378a3-210">By simply setting the `EnableCaching` property to `True` and the `CacheDuration` property to some time interval, the ObjectDataSource will automatically cache the data returned from its underlying object for the specified interval.</span></span> <span data-ttu-id="378a3-211">Kontrolki ObjectDataSource można również użyć co najmniej jeden zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-211">The ObjectDataSource can also use one or more SQL cache dependencies.</span></span>

<span data-ttu-id="378a3-212">Aby zademonstrować, używanie zależności pamięci podręcznej SQL w sposób deklaratywny, otwórz `SqlCacheDependencies.aspx` stronie `Caching` folder i przeciągnij GridView z przybornika do projektanta.</span><span class="sxs-lookup"><span data-stu-id="378a3-212">To demonstrate using SQL cache dependencies declaratively, open the `SqlCacheDependencies.aspx` page in the `Caching` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="378a3-213">Ustaw GridView s `ID` do `ProductsDeclarative` i z jego tag inteligentny chcesz powiązać nowe kontrolki ObjectDataSource, o nazwie `ProductsDataSourceDeclarative`.</span><span class="sxs-lookup"><span data-stu-id="378a3-213">Set the GridView s `ID` to `ProductsDeclarative` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSourceDeclarative`.</span></span>


<span data-ttu-id="378a3-214">[![Tworzenie nowego elementu ObjectDataSource, o nazwie ProductsDataSourceDeclarative](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-214">[![Create a New ObjectDataSource Named ProductsDataSourceDeclarative](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span></span>

<span data-ttu-id="378a3-215">**Rysunek 5**: Utwórz nowy o nazwie elementu ObjectDataSource `ProductsDataSourceDeclarative` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-215">**Figure 5**: Create a New ObjectDataSource Named `ProductsDataSourceDeclarative` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image4.png))</span></span>


<span data-ttu-id="378a3-216">Konfigurowanie kontrolki ObjectDataSource używać `ProductsBLL` klasy i zmień wartość na liście rozwijanej na karcie Wybierz `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="378a3-216">Configure the ObjectDataSource to use the `ProductsBLL` class and set the drop-down list in the SELECT tab to `GetProducts()`.</span></span> <span data-ttu-id="378a3-217">Na karcie aktualizacji, wybierz opcję `UpdateProduct` przeciążenia z trzema parametrami wejściowymi - `productName`, `unitPrice`, i `productID`.</span><span class="sxs-lookup"><span data-stu-id="378a3-217">In the UPDATE tab, choose the `UpdateProduct` overload with three input parameters - `productName`, `unitPrice`, and `productID`.</span></span> <span data-ttu-id="378a3-218">Ustaw list rozwijanych (Brak), znajdujące się na kartach INSERT i DELETE.</span><span class="sxs-lookup"><span data-stu-id="378a3-218">Set the drop-down lists to (None) in the INSERT and DELETE tabs.</span></span>


<span data-ttu-id="378a3-219">[![Użyj przeciążenia UpdateProduct trzech parametrów wejściowych](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-219">[![Use the UpdateProduct Overload with Three Input Parameters](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span></span>

<span data-ttu-id="378a3-220">**Rysunek 6**: Trzy parametry wejściowe za pomocą przeciążenia UpdateProduct ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-220">**Figure 6**: Use the UpdateProduct Overload with Three Input Parameters ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image6.png))</span></span>


<span data-ttu-id="378a3-221">[![Zmień wartość na liście rozwijanej na (Brak) do WSTAWIANIA i usuwania karty](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-221">[![Set the Drop-Down List to (None) for the INSERT and DELETE Tabs](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span></span>

<span data-ttu-id="378a3-222">**Rysunek 7**: Zmień wartość na liście rozwijanej na (Brak) dla Wstawianie i usuwanie kart ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-222">**Figure 7**: Set the Drop-Down List to (None) for the INSERT and DELETE Tabs ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image8.png))</span></span>


<span data-ttu-id="378a3-223">Po zakończeniu pracy kreatora Konfigurowanie źródła danych, program Visual Studio utworzy BoundFields i CheckBoxFields w widoku GridView dla każdego pola danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-223">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="378a3-224">Usuń wszystkie pola, ale `ProductName`, `CategoryName`, i `UnitPrice`i sformatuj te pola, zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="378a3-224">Remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="378a3-225">Za pomocą tagu inteligentnego s GridView zaznacz pola wyboru włączone stronicowanie, włączyć sortowanie i Włącz edytowanie.</span><span class="sxs-lookup"><span data-stu-id="378a3-225">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="378a3-226">Program Visual Studio ustawi ObjectDataSource s `OldValuesParameterFormatString` właściwość `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="378a3-226">Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="378a3-227">Aby zapewnić poprawne działanie funkcji edycji s GridView, albo Usuń tę właściwość całkowicie w składni deklaratywnej lub ustaw go z powrotem na jego wartość domyślną `{0}`.</span><span class="sxs-lookup"><span data-stu-id="378a3-227">In order for the GridView s edit feature to work properly, either remove this property entirely from the declarative syntax or set it back to its default value, `{0}`.</span></span>

<span data-ttu-id="378a3-228">Na koniec Dodaj kontrolkę etykieta Web powyżej GridView i ustaw jego `ID` właściwości `ODSEvents` i jego `EnableViewState` właściwość `False`.</span><span class="sxs-lookup"><span data-stu-id="378a3-228">Finally, add a Label Web control above the GridView and set its `ID` property to `ODSEvents` and its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="378a3-229">Po wprowadzeniu tych zmian, znaczniki deklaratywne s strony powinien wyglądać podobnie do poniższej.</span><span class="sxs-lookup"><span data-stu-id="378a3-229">After making these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="378a3-230">Należy pamiętać, ve wprowadzone liczby estetycznych dostosowań do pola kontrolki GridView, które nie są konieczne do zademonstrowania funkcji zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-230">Note that I ve made a number of aesthetic customizations to the GridView fields that are not necessary to demonstrate the SQL cache dependency functionality.</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample7.aspx)]

<span data-ttu-id="378a3-231">Następnie należy utworzyć program obsługi zdarzeń dla ObjectDataSource s `Selecting` zdarzeń i w jego Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="378a3-231">Next, create an event handler for the ObjectDataSource s `Selecting` event and in it add the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample8.vb)]

<span data-ttu-id="378a3-232">Pamiętamy ObjectDataSource s `Selecting` zdarzeń jest uruchamiana tylko wtedy, gdy trwa pobieranie danych z jego obiekt źródłowy.</span><span class="sxs-lookup"><span data-stu-id="378a3-232">Recall that the ObjectDataSource s `Selecting` event fires only when retrieving data from its underlying object.</span></span> <span data-ttu-id="378a3-233">Jeśli kontrolki ObjectDataSource uzyskuje dostęp do danych z własnej pamięci podręcznej, to zdarzenie nie jest uruchamiany.</span><span class="sxs-lookup"><span data-stu-id="378a3-233">If the ObjectDataSource accesses the data from its own cache, this event is not fired.</span></span>

<span data-ttu-id="378a3-234">Teraz odwiedź tę stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="378a3-234">Now, visit this page through a browser.</span></span> <span data-ttu-id="378a3-235">Ponieważ firma Microsoft ve jeszcze w celu implementacji wszelkich buforowania, każdym razem, strony, sortowanie lub edytowanie strony siatki powinien być wyświetlany tekst, wybranie event uruchamiane, jak pokazano na rysunku 8.</span><span class="sxs-lookup"><span data-stu-id="378a3-235">Since we ve yet to implement any caching, each time you page, sort, or edit the grid the page should display the text, �Selecting event fired, as Figure 8 shows.</span></span>


<span data-ttu-id="378a3-236">[![S ObjectDataSource wybranie Event uruchamia każdego czasu stronicowanej widoku GridView, edytować, lub posortowane](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-236">[![The ObjectDataSource s Selecting Event Fires Each Time the GridView is Paged, Edited, or Sorted](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span></span>

<span data-ttu-id="378a3-237">**Rysunek 8**: ObjectDataSource s `Selecting` czas każdej generowane zdarzenia jest stronicowanej widoku GridView, edytowana lub posortowane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-237">**Figure 8**: The ObjectDataSource s `Selecting` Event Fires Each Time the GridView is Paged, Edited, or Sorted ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image10.png))</span></span>


<span data-ttu-id="378a3-238">Jak widzieliśmy w [buforowanie danych za pomocą kontrolki ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) samouczek, ustawienie `EnableCaching` właściwości `True` powoduje, że ObjectDataSource do jego dane z pamięci podręcznej przez czas określony przez jego `CacheDuration` właściwości.</span><span class="sxs-lookup"><span data-stu-id="378a3-238">As we saw in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial, setting the `EnableCaching` property to `True` causes the ObjectDataSource to cache its data for the duration specified by its `CacheDuration` property.</span></span> <span data-ttu-id="378a3-239">Ma również kontrolki ObjectDataSource [ `SqlCacheDependency` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), która dodaje co najmniej jeden zależności pamięci podręcznej SQL buforowanych danych przy użyciu wzorca:</span><span class="sxs-lookup"><span data-stu-id="378a3-239">The ObjectDataSource also has a [`SqlCacheDependency` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), which adds one or more SQL cache dependencies to the cached data using the pattern:</span></span>


[!code-css[Main](using-sql-cache-dependencies-vb/samples/sample9.css)]

<span data-ttu-id="378a3-240">Gdzie *databaseName* to nazwa bazy danych, jak to określono w `name` atrybutu `<add>` element `Web.config`, i *tableName* to nazwa tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-240">Where *databaseName* is the name of the database as specified in the `name` attribute of the `<add>` element in `Web.config`, and *tableName* is the name of the database table.</span></span> <span data-ttu-id="378a3-241">Na przykład do utworzenia elementu ObjectDataSource, która przechowuje dane bezterminowo na podstawie zależności pamięci podręcznej SQL względem Northwind s `Products` tabeli, należy ustawić ObjectDataSource s `EnableCaching` właściwości `True` i jego `SqlCacheDependency` właściwości NorthwindDB:Products.</span><span class="sxs-lookup"><span data-stu-id="378a3-241">For example, to create an ObjectDataSource that caches data indefinitely based on a SQL cache dependency against the Northwind s `Products` table, set the ObjectDataSource s `EnableCaching` property to `True` and its `SqlCacheDependency` property to NorthwindDB:Products .</span></span>

> [!NOTE]
> <span data-ttu-id="378a3-242">Możesz użyć zależności pamięci podręcznej SQL *i* na podstawie czasu wygaśnięcia, ustawiając `EnableCaching` do `True`, `CacheDuration` przedziału czasu i `SqlCacheDependency` do nazwy bazy danych i tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-242">You can use a SQL cache dependency *and* a time-based expiry by setting `EnableCaching` to `True`, `CacheDuration` to the time interval, and `SqlCacheDependency` to the database and table name(s).</span></span> <span data-ttu-id="378a3-243">Kontrolki ObjectDataSource Wyklucz swoje dane, po osiągnięciu na podstawie czasu wygaśnięcia lub gdy system sondowania zauważa, że danych bazowych bazy danych została zmieniona, zaznajomisz się stanie, najpierw.</span><span class="sxs-lookup"><span data-stu-id="378a3-243">The ObjectDataSource will evict its data when the time-based expiry is reached or when the polling system notes that the underlying database data has changed, whichever happens first.</span></span>


<span data-ttu-id="378a3-244">GridView w `SqlCacheDependencies.aspx` wyświetla dane z dwóch tabel - `Products` i `Categories` (produkt s `CategoryName` pola są pobierane za pośrednictwem `JOIN` na `Categories`).</span><span class="sxs-lookup"><span data-stu-id="378a3-244">The GridView in `SqlCacheDependencies.aspx` displays data from two tables - `Products` and `Categories` (the product s `CategoryName` field is retrieved via a `JOIN` on `Categories`).</span></span> <span data-ttu-id="378a3-245">W związku z tym chcemy określić dwie zależności pamięci podręcznej SQL: NorthwindDB:Products;NorthwindDB:Categories .</span><span class="sxs-lookup"><span data-stu-id="378a3-245">Therefore, we want to specify two SQL cache dependencies: NorthwindDB:Products;NorthwindDB:Categories .</span></span>


<span data-ttu-id="378a3-246">[![Konfigurowanie kontrolki ObjectDataSource do obsługi pamięci podręcznej używanie zależności pamięci podręcznej SQL na temat produktów i kategorii](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-246">[![Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on Products and Categories](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span></span>

<span data-ttu-id="378a3-247">**Rysunek 9**: Konfigurowanie kontrolki ObjectDataSource do obsługi pamięci podręcznej przy użyciu pamięci podręcznej zależności SQL na `Products` i `Categories` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-247">**Figure 9**: Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on `Products` and `Categories` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image12.png))</span></span>


<span data-ttu-id="378a3-248">Po skonfigurowaniu ObjectDataSource do obsługi pamięci podręcznej, należy ponownie stronę za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="378a3-248">After configuring the ObjectDataSource to support caching, revisit the page through a browser.</span></span> <span data-ttu-id="378a3-249">Ponownie zdarzenie wybranie tekstu, które są wywoływane powinny pojawić się na pierwszej wizyty strony, ale powinien zniknąć po stronicowania, sortowanie lub naciskać przycisków edycji, lub przycisk Anuluj.</span><span class="sxs-lookup"><span data-stu-id="378a3-249">Again, the text �Selecting event fired should appear on the first page visit, but should go away when paging, sorting, or clicking the Edit or Cancel buttons.</span></span> <span data-ttu-id="378a3-250">Jest to spowodowane po załadowaniu danych w pamięci podręcznej s ObjectDataSource nawet do momentu `Products` lub `Categories` tabele są modyfikowane lub dane są aktualizowane przy użyciu widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="378a3-250">This is because after the data is loaded into the ObjectDataSource s cache, it remains there until the `Products` or `Categories` tables are modified or the data is updated through the GridView.</span></span>

<span data-ttu-id="378a3-251">Po stronicowanie siatki i zapisując braku zdarzeń wybranie wyzwolone tekst, Otwórz nowe okno przeglądarki i przejdź do samouczka podstawy w edytowanie, wstawianie i usuwanie sekcji (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="378a3-251">After paging through the grid and noting the lack of the �Selecting event fired text, open a new browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="378a3-252">Zaktualizuj nazwę lub cena produktu.</span><span class="sxs-lookup"><span data-stu-id="378a3-252">Update the name or price of a product.</span></span> <span data-ttu-id="378a3-253">Następnie z pierwszego okna przeglądarki, Wyświetl innej strony danych, sortowania siatki lub kliknij przycisk Edytuj wiersz s.</span><span class="sxs-lookup"><span data-stu-id="378a3-253">Then, from to the first browser window, view a different page of data, sort the grid, or click a row s Edit button.</span></span> <span data-ttu-id="378a3-254">Tym razem wybranie zdarzenia wywoływane powinno się ponownie, podstawowej bazy danych, których dane zostały zmienione (zobacz rysunek 10).</span><span class="sxs-lookup"><span data-stu-id="378a3-254">This time, the �Selecting event fired should reappear, as the underlying database data has been modified (see Figure 10).</span></span> <span data-ttu-id="378a3-255">Jeśli tekst nie jest widoczny, poczekaj chwilę i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="378a3-255">If the text does not appear, wait a few moments and try again.</span></span> <span data-ttu-id="378a3-256">Należy pamiętać, że usługa sondowania sprawdza zmiany `Products` tabeli co `pollTime` milisekund, więc istnieje opóźnienie między po zaktualizowaniu danych bazowych i kiedy zostanie wykluczony dane w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-256">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>


<span data-ttu-id="378a3-257">[![Modyfikowanie tabeli Produkty wyklucza mogą dane buforowane produktu](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-257">[![Modifying the Products Table Evicts the Cached Product Data](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span></span>

<span data-ttu-id="378a3-258">**Na rysunku nr 10**: Modyfikowanie tabeli Produkty wyklucza mogą danych produktu pamięci podręcznej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-258">**Figure 10**: Modifying the Products Table Evicts the Cached Product Data ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image14.png))</span></span>


## <a name="step-6-programmatically-working-with-thesqlcachedependencyclass"></a><span data-ttu-id="378a3-259">Krok 6. Programowe pracę`SqlCacheDependency`klasy</span><span class="sxs-lookup"><span data-stu-id="378a3-259">Step 6: Programmatically Working with the`SqlCacheDependency`Class</span></span>

<span data-ttu-id="378a3-260">[Buforowania danych w architekturze](caching-data-in-the-architecture-vb.md) samouczek przyjrzano się korzyści z używania oddzielnych warstwy pamięci podręcznej w ramach architektury, w przeciwieństwie sprzęganiu pamięci podręcznej za pomocą kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="378a3-260">The [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial looked at the benefits of using a separate Caching Layer in the architecture as opposed to tightly coupling the caching with the ObjectDataSource.</span></span> <span data-ttu-id="378a3-261">W tym samouczku utworzyliśmy `ProductsCL` klasę wykazać programowo Praca z pamięci podręcznej danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-261">In that tutorial we created a `ProductsCL` class to demonstrate programmatically working with the data cache.</span></span> <span data-ttu-id="378a3-262">Używanie zależności pamięci podręcznej SQL w warstwie pamięci podręcznej, użyj `SqlCacheDependency` klasy.</span><span class="sxs-lookup"><span data-stu-id="378a3-262">To utilize SQL cache dependencies in the Caching Layer, use the `SqlCacheDependency` class.</span></span>

<span data-ttu-id="378a3-263">W systemie sondowania `SqlCacheDependency` obiekt musi być skojarzone z określoną parą bazy danych i tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-263">With the polling system, a `SqlCacheDependency` object must be associated with a particular database and table pair.</span></span> <span data-ttu-id="378a3-264">Poniższy kod przykładowy tworzy `SqlCacheDependency` obiektu oparte na bazie danych Northwind s `Products` tabeli:</span><span class="sxs-lookup"><span data-stu-id="378a3-264">The following code, for example, creates a `SqlCacheDependency` object based on the Northwind database s `Products` table:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample10.vb)]

<span data-ttu-id="378a3-265">Wprowadź dwa parametry `SqlCacheDependency` Konstruktor s są odpowiednio nazwy bazy danych i tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-265">The two input parameters to the `SqlCacheDependency` s constructor are the database and table names, respectively.</span></span> <span data-ttu-id="378a3-266">Za pomocą ObjectDataSource s `SqlCacheDependency` Właściwość Nazwa bazy danych, używane jest taka sama jak wartość określoną w `name` atrybutu `<add>` elementu w `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="378a3-266">Like with the ObjectDataSource s `SqlCacheDependency` property, the database name used is the same as the value specified in the `name` attribute of the `<add>` element in `Web.config`.</span></span> <span data-ttu-id="378a3-267">Nazwa tabeli jest rzeczywista nazwa tabeli bazy danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-267">The table name is the actual name of the database table.</span></span>

<span data-ttu-id="378a3-268">Aby skojarzyć `SqlCacheDependency` za pomocą elementu dodane do pamięci podręcznej danych, użyj jednej z `Insert` przeciążenia metody, które akceptuje zależności.</span><span class="sxs-lookup"><span data-stu-id="378a3-268">To associate a `SqlCacheDependency` with an item added to the data cache, use one of the `Insert` method overloads that accepts a dependency.</span></span> <span data-ttu-id="378a3-269">Poniższy kod dodaje *wartość* do pamięci podręcznej danych na nieokreślony czas, ale kojarzy ją z `SqlCacheDependency` na `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-269">The following code adds *value* to the data cache for an indefinite duration, but associates it with a `SqlCacheDependency` on the `Products` table.</span></span> <span data-ttu-id="378a3-270">Krótko mówiąc *wartość* pozostaną w pamięci podręcznej, dopóki nie zostanie usunięty z powodu ograniczeń pamięci, lub ponieważ sondowania system wykrył, że `Products` tabeli zmieniła się od jego był buforowany.</span><span class="sxs-lookup"><span data-stu-id="378a3-270">In short, *value* will remain in the cache until it is evicted due to memory constraints or because the polling system has detected that the `Products` table has changed since it was cached.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample11.vb)]

<span data-ttu-id="378a3-271">S warstwy buforowania `ProductsCL` klasy obecnie buforuje dane z `Products` tabeli, używając na podstawie czasu wygaśnięcia 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="378a3-271">The Caching Layer s `ProductsCL` class currently caches data from the `Products` table using a time-based expiry of 60 seconds.</span></span> <span data-ttu-id="378a3-272">Pozwól s aktualizacji tej klasy, tak aby używał zależności pamięci podręcznej SQL zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="378a3-272">Let s update this class so that it uses SQL cache dependencies instead.</span></span> <span data-ttu-id="378a3-273">`ProductsCL` Klasy s `AddCacheItem` metody, która jest odpowiedzialny za dodawanie danych do pamięci podręcznej, obecnie zawiera następujący kod:</span><span class="sxs-lookup"><span data-stu-id="378a3-273">The `ProductsCL` class s `AddCacheItem` method, which is responsible for adding the data to the cache, currently contains the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample12.vb)]

<span data-ttu-id="378a3-274">Zaktualizuj kod w celu użycia `SqlCacheDependency` zamiast obiektu `MasterCacheKeyArray` zależności w pamięci podręcznej:</span><span class="sxs-lookup"><span data-stu-id="378a3-274">Update this code to use a `SqlCacheDependency` object instead of the `MasterCacheKeyArray` cache dependency:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample13.vb)]

<span data-ttu-id="378a3-275">Aby przetestować tę funkcję, należy dodać GridView do strony poniżej istniejącego `ProductsDeclarative` GridView.</span><span class="sxs-lookup"><span data-stu-id="378a3-275">To test this functionality, add a GridView to the page beneath the existing `ProductsDeclarative` GridView.</span></span> <span data-ttu-id="378a3-276">Ustaw ten nowy s GridView `ID` do `ProductsProgrammatic` i za pośrednictwem tagu inteligentnego powiązać go do nowego elementu ObjectDataSource, o nazwie `ProductsDataSourceProgrammatic`.</span><span class="sxs-lookup"><span data-stu-id="378a3-276">Set this new GridView s `ID` to `ProductsProgrammatic` and, through its smart tag, bind it to a new ObjectDataSource named `ProductsDataSourceProgrammatic`.</span></span> <span data-ttu-id="378a3-277">Konfigurowanie kontrolki ObjectDataSource używać `ProductsCL` klasy, listy rozwijane w polu Wybierz i aktualizacji karty, aby `GetProducts` i `UpdateProduct`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="378a3-277">Configure the ObjectDataSource to use the `ProductsCL` class, setting the drop-down lists in the SELECT and UPDATE tabs to `GetProducts` and `UpdateProduct`, respectively.</span></span>


<span data-ttu-id="378a3-278">[![Konfigurowanie kontrolki ObjectDataSource na korzystanie z klasy ProductsCL](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-278">[![Configure the ObjectDataSource to Use the ProductsCL Class](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span></span>

<span data-ttu-id="378a3-279">**Rysunek 11**: Konfigurowanie kontrolki ObjectDataSource do użycia `ProductsCL` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-279">**Figure 11**: Configure the ObjectDataSource to Use the `ProductsCL` Class ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image16.png))</span></span>


<span data-ttu-id="378a3-280">[![Wybierz metodę GetProducts z listy rozwijanej wybierz kartę s](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-280">[![Select the GetProducts Method from the SELECT Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span></span>

<span data-ttu-id="378a3-281">**Rysunek 12**: Wybierz `GetProducts` metodę z listy rozwijanej s Wybierz kartę ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-281">**Figure 12**: Select the `GetProducts` Method from the SELECT Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image18.png))</span></span>


<span data-ttu-id="378a3-282">[![Wybierz metodę UpdateProduct z listy rozwijanej s kartę aktualizacji](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="378a3-282">[![Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span></span>

<span data-ttu-id="378a3-283">**Rysunek 13**: Wybierz metodę UpdateProduct s kartę aktualizacji listy rozwijanej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](using-sql-cache-dependencies-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="378a3-283">**Figure 13**: Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image20.png))</span></span>


<span data-ttu-id="378a3-284">Po zakończeniu pracy kreatora Konfigurowanie źródła danych, program Visual Studio utworzy BoundFields i CheckBoxFields w widoku GridView dla każdego pola danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-284">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="378a3-285">Tak, jak przy użyciu GridView pierwszy dodane do tej strony, Usuń wszystkie pola, ale `ProductName`, `CategoryName`, i `UnitPrice`i sformatuj te pola, zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="378a3-285">Like with the first GridView added to this page, remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="378a3-286">Za pomocą tagu inteligentnego s GridView zaznacz pola wyboru włączone stronicowanie, włączyć sortowanie i Włącz edytowanie.</span><span class="sxs-lookup"><span data-stu-id="378a3-286">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="378a3-287">Podobnie jak w przypadku `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio ustawi `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` właściwość `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="378a3-287">As with the `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio will set the `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="378a3-288">Funkcja Edytuj s GridView działało poprawnie, ustaw tę właściwość z powrotem do `{0}` (lub całkowicie usunąć przypisania właściwości z składni deklaratywnej).</span><span class="sxs-lookup"><span data-stu-id="378a3-288">In order for the GridView s edit feature to work properly, set this property back to `{0}` (or remove the property assignment from the declarative syntax altogether).</span></span>

<span data-ttu-id="378a3-289">Po zakończeniu tych zadań, wynikowy kontrolkami GridView i kontrolki ObjectDataSource oznaczeniu deklaracyjnym powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="378a3-289">After completing these tasks, the resulting GridView and ObjectDataSource declarative markup should look like the following:</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample14.aspx)]

<span data-ttu-id="378a3-290">Aby przetestować SQL zależności pamięci podręcznej w warstwie buforowania Ustaw punkt przerwania `ProductCL` klasy s `AddCacheItem` metody i następnie debugowania rozpoczęcia.</span><span class="sxs-lookup"><span data-stu-id="378a3-290">To test the SQL cache dependency in the Caching Layer set a breakpoint in the `ProductCL` class s `AddCacheItem` method and then start debugging.</span></span> <span data-ttu-id="378a3-291">Podczas pierwszej wizyty w witrynie `SqlCacheDependencies.aspx`, trafiony punkt przerwania, ponieważ dane są żądane po raz pierwszy i umieszczane w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-291">When you first visit `SqlCacheDependencies.aspx`, the breakpoint should be hit as the data is requested for the first time and placed into the cache.</span></span> <span data-ttu-id="378a3-292">Następnie przenieść do innej strony w widoku GridView lub jedna z kolumn sortowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-292">Next, move to another page in the GridView or sort one of the columns.</span></span> <span data-ttu-id="378a3-293">Powoduje to, że GridView zostać ponowiona swoje dane, ale dane powinny znajdować się w pamięci podręcznej od momentu `Products` tabeli bazy danych nie zostały zmodyfikowane.</span><span class="sxs-lookup"><span data-stu-id="378a3-293">This causes the GridView to requery its data, but the data should be found in the cache since the `Products` database table has not been modified.</span></span> <span data-ttu-id="378a3-294">Jeśli dane wielokrotnie nie zostanie znaleziony w pamięci podręcznej, upewnij się, że na komputerze jest dostępna wystarczająca ilość pamięci i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="378a3-294">If the data is repeatedly not found in the cache, make sure there is sufficient memory available on your computer and try again.</span></span>

<span data-ttu-id="378a3-295">Po stronicować na kilku stronach GridView, Otwórz drugie okno przeglądarki i przejdź do samouczka podstawy w edytowanie, wstawianie i usuwanie sekcji (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="378a3-295">After paging through a few pages of the GridView, open a second browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="378a3-296">Zaktualizuj rekord z tabeli Produkty i następnie w pierwszym oknie przeglądarki, Wyświetl nowej strony lub kliknij jeden z nagłówków sortowania.</span><span class="sxs-lookup"><span data-stu-id="378a3-296">Update a record from the Products table and then, from the first browser window, view a new page or click on one of the sorting headers.</span></span>

<span data-ttu-id="378a3-297">W tym scenariuszu zostanie wyświetlony jeden z dwóch kwestii: albo punkt przerwania zostanie uruchomiona, wskazujący, że dane w pamięci podręcznej została wykluczona z powodu zmiany w bazie danych. lub, punkt przerwania nie są osiągane, co oznacza, że `SqlCacheDependencies.aspx` pokazywany nieaktualnych danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-297">In this scenario you will see one of two things: either the breakpoint will be hit, indicating that the cached data was evicted due to the change in the database; or, the breakpoint will not be hit, meaning that `SqlCacheDependencies.aspx` is now showing stale data.</span></span> <span data-ttu-id="378a3-298">Jeśli nie zostanie osiągnięty punkt przerwania, prawdopodobnie ponieważ usługi sondowania nie zostało jeszcze uruchomione od zmiany danych.</span><span class="sxs-lookup"><span data-stu-id="378a3-298">If the breakpoint is not hit, it is likely because the polling service has not yet fired since the data was changed.</span></span> <span data-ttu-id="378a3-299">Należy pamiętać, że usługa sondowania sprawdza zmiany `Products` tabeli co `pollTime` milisekund, więc istnieje opóźnienie między po zaktualizowaniu danych bazowych i kiedy zostanie wykluczony dane w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-299">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>

> [!NOTE]
> <span data-ttu-id="378a3-300">To opóźnienie jest bardziej prawdopodobne, które będą wyświetlane po edycji produktów dzięki GridView w `SqlCacheDependencies.aspx`.</span><span class="sxs-lookup"><span data-stu-id="378a3-300">This delay is more likely to appear when editing one of the products through the GridView in `SqlCacheDependencies.aspx`.</span></span> <span data-ttu-id="378a3-301">W [buforowania danych w architekturze](caching-data-in-the-architecture-vb.md) samouczek dodaliśmy `MasterCacheKeyArray` pamięci podręcznej zależności, aby potwierdzić, że dane edytowany przy użyciu `ProductsCL` klasy s `UpdateProduct` metoda została wykluczona z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-301">In the [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial we added the `MasterCacheKeyArray` cache dependency to ensure that the data being edited through the `ProductsCL` class s `UpdateProduct` method was evicted from the cache.</span></span> <span data-ttu-id="378a3-302">Jednak zastąpiliśmy tej zależności pamięci podręcznej podczas modyfikowania `AddCacheItem` metoda wcześniej w tym kroku i w związku z tym `ProductsCL` klasy będą w dalszym ciągu Pokaż dane w pamięci podręcznej do momentu zmiany — informacje o systemie sondowania `Products` tabeli.</span><span class="sxs-lookup"><span data-stu-id="378a3-302">However, we replaced this cache dependency when modifying the `AddCacheItem` method earlier in this step and therefore the `ProductsCL` class will continue to show the cached data until the polling system notes the change to the `Products` table.</span></span> <span data-ttu-id="378a3-303">Zobaczymy, jak ponownie wprowadzić `MasterCacheKeyArray` zależności w kroku 7 w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-303">We'll see how to reintroduce the `MasterCacheKeyArray` cache dependency in Step 7.</span></span>


## <a name="step-7-associating-multiple-dependencies-with-a-cached-item"></a><span data-ttu-id="378a3-304">Krok 7. Kojarzenie wiele zależności z elementu w pamięci podręcznej</span><span class="sxs-lookup"><span data-stu-id="378a3-304">Step 7: Associating Multiple Dependencies with a Cached Item</span></span>

<span data-ttu-id="378a3-305">Pamiętamy `MasterCacheKeyArray` zależności pamięci podręcznej służy do upewnij się, że *wszystkich* dane dotyczące produktu zostanie usunięty z pamięci podręcznej po zaktualizowaniu dowolnego pojedynczego elementu skojarzone znajdujący się w nim.</span><span class="sxs-lookup"><span data-stu-id="378a3-305">Recall that the `MasterCacheKeyArray` cache dependency is used to ensure that *all* product-related data is evicted from the cache when any single item associated within it is updated.</span></span> <span data-ttu-id="378a3-306">Na przykład `GetProductsByCategoryID(categoryID)` pamięci podręczne metody `ProductsDataTables` wystąpień dla każdego unikatowy *categoryID* wartość.</span><span class="sxs-lookup"><span data-stu-id="378a3-306">For example, the `GetProductsByCategoryID(categoryID)` method caches `ProductsDataTables` instances for each unique *categoryID* value.</span></span> <span data-ttu-id="378a3-307">Jeśli jeden z tych obiektów zostanie usunięty, `MasterCacheKeyArray` zależności pamięci podręcznej zapewnia także inne usunięte.</span><span class="sxs-lookup"><span data-stu-id="378a3-307">If one of these objects is evicted, the `MasterCacheKeyArray` cache dependency ensures that the others are also removed.</span></span> <span data-ttu-id="378a3-308">Bez tej zależności pamięci podręcznej po zmodyfikowaniu dane w pamięci podręcznej istnieje możliwość, że inne dane w pamięci podręcznej produktu mogą być nieaktualne.</span><span class="sxs-lookup"><span data-stu-id="378a3-308">Without this cache dependency, when the cached data is modified the possibility exists that other cached product data may be out of date.</span></span> <span data-ttu-id="378a3-309">W związku z tym, jego s pamiętać, że firma Microsoft zachowuje `MasterCacheKeyArray` przechowują w pamięci podręcznej zależności używanie zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-309">Consequently, it s important that we maintain the `MasterCacheKeyArray` cache dependency when using SQL cache dependencies.</span></span> <span data-ttu-id="378a3-310">Jednak dane w pamięci podręcznej s `Insert` metoda zezwala tylko dla obiektu jednej zależności.</span><span class="sxs-lookup"><span data-stu-id="378a3-310">However, the data cache s `Insert` method only allows for a single dependency object.</span></span>

<span data-ttu-id="378a3-311">Ponadto podczas pracy z zależności pamięci podręcznej SQL firma Microsoft może być konieczne do skojarzenia z wielu tabel bazy danych jako zależności.</span><span class="sxs-lookup"><span data-stu-id="378a3-311">Furthermore, when working with SQL cache dependencies we may need to associate multiple database tables as dependencies.</span></span> <span data-ttu-id="378a3-312">Na przykład `ProductsDataTable` pamięci podręcznej w `ProductsCL` klasa zawiera nazwy kategorii i dostawcy dla każdego produktu, ale `AddCacheItem` metoda wykorzystuje tylko zależności w `Products`.</span><span class="sxs-lookup"><span data-stu-id="378a3-312">For example, the `ProductsDataTable` cached in the `ProductsCL` class contains the category and supplier names for each product, but the `AddCacheItem` method only uses a dependency on `Products`.</span></span> <span data-ttu-id="378a3-313">W takiej sytuacji, jeśli użytkownik aktualizuje nazwę kategorii lub dostawcy, produktu pamięci podręcznej danych zostanie pozostają w pamięci podręcznej i być nieaktualne.</span><span class="sxs-lookup"><span data-stu-id="378a3-313">In this situation, if the user updates the name of a category or supplier, the cached product data will remain in the cache and be out of date.</span></span> <span data-ttu-id="378a3-314">W związku z tym, chcemy dane buforowane produktu zależy nie tylko `Products` tabeli, ale na `Categories` i `Suppliers` także tabele.</span><span class="sxs-lookup"><span data-stu-id="378a3-314">Therefore, we want to make the cached product data dependent on not only the `Products` table, but on the `Categories` and `Suppliers` tables as well.</span></span>

<span data-ttu-id="378a3-315">[ `AggregateCacheDependency` Klasy](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) umożliwia kojarzenie wielu zależności z elementu pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-315">The [`AggregateCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) provides a means for associating multiple dependencies with a cache item.</span></span> <span data-ttu-id="378a3-316">Rozpocznij od utworzenia `AggregateCacheDependency` wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="378a3-316">Start by creating an `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="378a3-317">Następnie dodaj zestaw zależności za pomocą `AggregateCacheDependency` s `Add` metody.</span><span class="sxs-lookup"><span data-stu-id="378a3-317">Next, add the set of dependencies using the `AggregateCacheDependency` s `Add` method.</span></span> <span data-ttu-id="378a3-318">Podczas wstawiania elementu do pamięci podręcznej danych po tej dacie, Przekaż `AggregateCacheDependency` wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="378a3-318">When inserting the item into the data cache thereafter, pass in the `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="378a3-319">Gdy *wszelkie* z `AggregateCacheDependency` wystąpienia s zależności zmienią się, zostanie wykluczona element pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-319">When *any* of the `AggregateCacheDependency` instance s dependencies change, the cached item will be evicted.</span></span>

<span data-ttu-id="378a3-320">Poniżej pokazano zaktualizowany kod dla `ProductsCL` klasy s `AddCacheItem` metody.</span><span class="sxs-lookup"><span data-stu-id="378a3-320">The following shows the updated code for the `ProductsCL` class s `AddCacheItem` method.</span></span> <span data-ttu-id="378a3-321">Ta metoda tworzy `MasterCacheKeyArray` pamięci podręcznej zależności wraz z `SqlCacheDependency` obiektów dla `Products`, `Categories`, i `Suppliers` tabel.</span><span class="sxs-lookup"><span data-stu-id="378a3-321">The method creates the `MasterCacheKeyArray` cache dependency along with `SqlCacheDependency` objects for the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="378a3-322">Te są wszystkie połączone w jedną `AggregateCacheDependency` obiektu o nazwie `aggregateDependencies`, który jest następnie przekazywany do `Insert` metody.</span><span class="sxs-lookup"><span data-stu-id="378a3-322">These are all combined into one `AggregateCacheDependency` object named `aggregateDependencies`, which is then passed into the `Insert` method.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample15.vb)]

<span data-ttu-id="378a3-323">Testowanie nowego kodu out. Teraz zmienia się na `Products`, `Categories`, lub `Suppliers` tabele spowodować, że dane w pamięci podręcznej zostać wykluczony.</span><span class="sxs-lookup"><span data-stu-id="378a3-323">Test this new code out. Now changes to the `Products`, `Categories`, or `Suppliers` tables cause the cached data to be evicted.</span></span> <span data-ttu-id="378a3-324">Ponadto `ProductsCL` klasy s `UpdateProduct` metody, która jest wywoływana podczas edytowania produktu za pośrednictwem widoku GridView, wyklucza mogą `MasterCacheKeyArray` zależności, co powoduje, że buforowane w pamięci podręcznej `ProductsDataTable` wykluczenie i ponowne pobranie na następnej danych żądanie.</span><span class="sxs-lookup"><span data-stu-id="378a3-324">Moreover, the `ProductsCL` class s `UpdateProduct` method, which is called when editing a product through the GridView, evicts the `MasterCacheKeyArray` cache dependency, which causes the cached `ProductsDataTable` to be evicted and the data to be re-retrieved on the next request.</span></span>

> [!NOTE]
> <span data-ttu-id="378a3-325">Zależności pamięci podręcznej SQL może również służyć za pomocą [buforowania danych wyjściowych](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span><span class="sxs-lookup"><span data-stu-id="378a3-325">SQL cache dependencies can also be used with [output caching](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span></span> <span data-ttu-id="378a3-326">Do pokazania tej funkcji zobacz: [Za pomocą programu ASP.NET buforowania danych wyjściowych z programem SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="378a3-326">For a demonstration of this functionality, see: [Using ASP.NET Output Caching with SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="378a3-327">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="378a3-327">Summary</span></span>

<span data-ttu-id="378a3-328">Podczas buforowania danych bazy danych, dopóki nie zostanie zmodyfikowany w bazie danych najlepiej pozostanie w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="378a3-328">When caching database data, the data will ideally remain in the cache until it is modified in the database.</span></span> <span data-ttu-id="378a3-329">Za pomocą programu ASP.NET 2.0 można tworzyć i używane w scenariuszach zarówno deklaracyjne i programowe zależności pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="378a3-329">With ASP.NET 2.0, SQL cache dependencies can be created and used in both declarative and programmatic scenarios.</span></span> <span data-ttu-id="378a3-330">Jednym z wyzwań w tym podejściu Trwa odnajdywanie, gdy dane zostały zmodyfikowane.</span><span class="sxs-lookup"><span data-stu-id="378a3-330">One of the challenges with this approach is in discovering when the data has been modified.</span></span> <span data-ttu-id="378a3-331">Pełne wersje programu Microsoft SQL Server 2005 oferują możliwości powiadomień, które może generować alerty aplikacji, gdy wynik zapytania został zmieniony.</span><span class="sxs-lookup"><span data-stu-id="378a3-331">The full versions of Microsoft SQL Server 2005 provide notification capabilities that can alert an application when a query result has changed.</span></span> <span data-ttu-id="378a3-332">Express Edition programu SQL Server 2005 i starsze wersje programu SQL Server system sondowania należy użyć zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="378a3-332">For the Express Edition of SQL Server 2005 and older versions of SQL Server, a polling system must be used instead.</span></span> <span data-ttu-id="378a3-333">Na szczęście konfigurowania infrastruktury wymaganych sondowania jest dość prosta.</span><span class="sxs-lookup"><span data-stu-id="378a3-333">Fortunately, setting up the necessary polling infrastructure is fairly straightforward.</span></span>

<span data-ttu-id="378a3-334">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="378a3-334">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="378a3-335">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="378a3-335">Further Reading</span></span>

<span data-ttu-id="378a3-336">Więcej informacji na tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="378a3-336">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="378a3-337">Przy użyciu powiadomienia o zapytaniach w programie Microsoft SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="378a3-337">Using Query Notifications in Microsoft SQL Server 2005</span></span>](https://msdn.microsoft.com/library/ms175110.aspx)
- [<span data-ttu-id="378a3-338">Tworzenie powiadomień o zapytaniach</span><span class="sxs-lookup"><span data-stu-id="378a3-338">Creating a Query Notification</span></span>](https://msdn.microsoft.com/library/ms188669.aspx)
- <span data-ttu-id="378a3-339">[Buforowanie w technologii ASP.NET za pomocą `SqlCacheDependency` klasy](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="378a3-339">[Caching in ASP.NET with the `SqlCacheDependency` Class](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span></span>
- <span data-ttu-id="378a3-340">[Narzędzie rejestracji serwera SQL platformy ASP.NET (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="378a3-340">[ASP.NET SQL Server Registration Tool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span></span>
- [<span data-ttu-id="378a3-341">Omówienie `SqlCacheDependency`</span><span class="sxs-lookup"><span data-stu-id="378a3-341">Overview of `SqlCacheDependency`</span></span>](http://www.aspnetresources.com/blog/sql_cache_depedency_overview.aspx)

## <a name="about-the-author"></a><span data-ttu-id="378a3-342">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="378a3-342">About the Author</span></span>

<span data-ttu-id="378a3-343">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="378a3-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="378a3-344">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="378a3-344">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="378a3-345">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="378a3-345">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="378a3-346">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="378a3-346">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="378a3-347">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="378a3-347">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="378a3-348">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="378a3-348">Special Thanks To</span></span>

<span data-ttu-id="378a3-349">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="378a3-349">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="378a3-350">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Marko Rangel Teresa Murphy i Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="378a3-350">Lead reviewers for this tutorial were Marko Rangel, Teresa Murphy, and Hilton Giesenow.</span></span> <span data-ttu-id="378a3-351">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="378a3-351">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="378a3-352">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="378a3-352">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="378a3-353">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="378a3-353">Previous</span></span>](caching-data-at-application-startup-vb.md)
