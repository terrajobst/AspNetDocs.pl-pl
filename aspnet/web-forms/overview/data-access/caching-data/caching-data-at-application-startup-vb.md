---
uid: web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
title: Buforowanie danych przy uruchamianiu aplikacji (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W dowolnej aplikacji sieci Web niektórych danych często posłuży, a niektóre dane będą rzadko używane. Firma Microsoft może poprawić wydajność naszych b aplikacji ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 84afe4ac-cc53-4f2e-a867-27eaf692c2df
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c07b565329ab17496d2436f4c35bc4507694ed8
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/06/2019
ms.locfileid: "65119668"
---
# <a name="caching-data-at-application-startup-vb"></a><span data-ttu-id="f9cf4-104">Buforowanie danych przy uruchamianiu aplikacji (VB)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-104">Caching Data at Application Startup (VB)</span></span>

<span data-ttu-id="f9cf4-105">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="f9cf4-106">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="f9cf4-106">Download PDF</span></span>](caching-data-at-application-startup-vb/_static/datatutorial60vb1.pdf)

> <span data-ttu-id="f9cf4-107">W dowolnej aplikacji sieci Web niektórych danych często posłuży, a niektóre dane będą rzadko używane.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-107">In any Web application some data will be frequently used and some data will be infrequently used.</span></span> <span data-ttu-id="f9cf4-108">Firma Microsoft może zwiększyć wydajność naszej aplikacji ASP.NET, ładując wcześniej często używane dane, to technika, znana jako.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-108">We can improve the performance of our ASP.NET application by loading in advance the frequently-used data, a technique known as.</span></span> <span data-ttu-id="f9cf4-109">Ten samouczek przedstawia jedno z podejść do aktywnego ładowania, która umożliwia ładowanie danych do pamięci podręcznej podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-109">This tutorial demonstrates one approach to proactive loading, which is to load data into the cache at application startup.</span></span>

## <a name="introduction"></a><span data-ttu-id="f9cf4-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="f9cf4-110">Introduction</span></span>

<span data-ttu-id="f9cf4-111">Dwóch poprzednich samouczkach przyjrzano się buforowanie danych w prezentacji i warstwy pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-111">The two previous tutorials looked at caching data in the Presentation and Caching Layers.</span></span> <span data-ttu-id="f9cf4-112">W [buforowanie danych za pomocą kontrolki ObjectDataSource](caching-data-with-the-objectdatasource-vb.md), przyjrzeliśmy się za pomocą kontrolki ObjectDataSource s, buforowanie funkcji buforowania danych w warstwie prezentacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-112">In [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md), we looked at using the ObjectDataSource s caching features to cache data in the Presentation Layer.</span></span> <span data-ttu-id="f9cf4-113">[Buforowanie danych w architekturze](caching-data-in-the-architecture-vb.md) zbadane, buforowanie w nowy, oddzielny warstwy pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-113">[Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) examined caching in a new, separate Caching Layer.</span></span> <span data-ttu-id="f9cf4-114">Obu tych samouczków używany *reaktywne ładowania* w pracy z pamięcią podręczną danych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-114">Both of these tutorials used *reactive loading* in working with the data cache.</span></span> <span data-ttu-id="f9cf4-115">Za pomocą reaktywne ładowania każdorazowo, wymagane są dane, system najpierw sprawdza, czy jego s w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-115">With reactive loading, each time the data is requested, the system first checks if it s in the cache.</span></span> <span data-ttu-id="f9cf4-116">W przeciwnym razie go bierze danych ze źródłowego źródła, takich jak bazy danych, a następnie przechowuje je w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-116">If not, it grabs the data from the originating source, such as the database, and then stores it in the cache.</span></span> <span data-ttu-id="f9cf4-117">Główną zaletą reaktywne ładowania jest łatwość implementacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-117">The main advantage to reactive loading is its ease of implementation.</span></span> <span data-ttu-id="f9cf4-118">Jednym z jej wady jest realizowaniem nierównomierny żądań.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-118">One of its disadvantages is its uneven performance across requests.</span></span> <span data-ttu-id="f9cf4-119">Wyobraź sobie stronę, która używa warstwy pamięci podręcznej z poprzedniego samouczka, aby wyświetlić informacje o produkcie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-119">Imagine a page that uses the Caching Layer from the preceding tutorial to display product information.</span></span> <span data-ttu-id="f9cf4-120">Gdy ta strona po raz pierwszy odwiedzony lub odwiedzony po raz pierwszy po dane w pamięci podręcznej został wykluczony z powodu ograniczeń pamięci lub po upływie określonego osiągnięte, danych musi zostać pobrany z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-120">When this page is visited for the first time, or visited for the first time after the cached data has been evicted due to memory constraints or the specified expiry having been reached, the data must be retrieved from the database.</span></span> <span data-ttu-id="f9cf4-121">W związku z tym te żądania użytkowników będzie trwać dłużej niż żądań użytkowników, które mogą być obsługiwane przez pamięć podręczną.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-121">Therefore, these users requests will take longer than users requests that can be served by the cache.</span></span>

<span data-ttu-id="f9cf4-122">*Aktywne ładowanie* zapewnia strategię zarządzania pamięcią podręczną w alternatywnej tego wygładza wydajność wszystkich żądań, ładując potrzebne dane w pamięci podręcznej przed nią.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-122">*Proactive loading* provides an alternative cache management strategy that smoothes out the performance across requests by loading the cached data before it s needed.</span></span> <span data-ttu-id="f9cf4-123">Zazwyczaj aktywne ładowanie używa niektóre procesy, która okresowo sprawdza lub powiadomienie w przypadku, gdy został aktualizacji z danymi źródłowymi.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-123">Typically, proactive loading uses some process that either periodically checks or is notified when there has been an update to the underlying data.</span></span> <span data-ttu-id="f9cf4-124">Ten proces aktualizuje następnie pamięci podręcznej, aby utrzymać ją od nowa.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-124">This process then updates the cache to keep it fresh.</span></span> <span data-ttu-id="f9cf4-125">Aktywne ładowanie jest szczególnie przydatne, jeśli dane pochodzą z połączenia z bazą danych powolne, usługi sieci Web lub z innego źródła danych szczególnie wolna.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-125">Proactive loading is especially useful if the underlying data comes from a slow database connection, a Web service, or some other particularly sluggish data source.</span></span> <span data-ttu-id="f9cf4-126">Jednak takie podejście do aktywnego ładowania jest trudniejsze do zaimplementowania, ponieważ wymaga ona tworzenia, zarządzania i wdrażania procesów do wyszukania zmian i aktualizowanie pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-126">But this approach to proactive loading is more difficult to implement, as it requires creating, managing, and deploying a process to check for changes and update the cache.</span></span>

<span data-ttu-id="f9cf4-127">Inną wersję aktywne ładowanie i typu, w których firma Microsoft będzie eksplorowania w ramach tego samouczka, trwa ładowanie danych w pamięci podręcznej podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-127">Another flavor of proactive loading, and the type we'll be exploring in this tutorial, is loading data into the cache at application startup.</span></span> <span data-ttu-id="f9cf4-128">To podejście jest szczególnie przydatne w przypadku buforowania danych statycznych, takich jak rekordy z tabel odnośników bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-128">This approach is especially useful for caching static data, such as the records in database lookup tables.</span></span>

> [!NOTE]
> <span data-ttu-id="f9cf4-129">Więcej informacji na temat przyjrzeć różnice między proaktywne i reaktywne ładowanie, a także listę informatykami, wadach i zalecenia dotyczące wdrożenia, można znaleźć [Zarządzanie zawartość pamięci podręcznej](https://msdn.microsoft.com/library/ms978503.aspx) części [ Buforowanie w aplikacjach .NET Framework w Przewodniku dotyczącym architektury](https://msdn.microsoft.com/library/ms978498.aspx).</span><span class="sxs-lookup"><span data-stu-id="f9cf4-129">For a more in-depth look at the differences between proactive and reactive loading, as well as lists of pros, cons, and implementation recommendations, refer to the [Managing the Contents of a Cache](https://msdn.microsoft.com/library/ms978503.aspx) section of the [Caching Architecture Guide for .NET Framework Applications](https://msdn.microsoft.com/library/ms978498.aspx).</span></span>

## <a name="step-1-determining-what-data-to-cache-at-application-startup"></a><span data-ttu-id="f9cf4-130">Krok 1. Określenie, jakie dane do pamięci podręcznej podczas uruchamiania aplikacji</span><span class="sxs-lookup"><span data-stu-id="f9cf4-130">Step 1: Determining What Data to Cache at Application Startup</span></span>

<span data-ttu-id="f9cf4-131">Przykłady buforowania przy użyciu ładowania reaktywne zbadaliśmy poprzedniego pracy dwóch samouczki dobrze z danymi, które okresowo mogą ulec zmianie, a nie długo exorbitantly do wygenerowania.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-131">The caching examples using reactive loading that we examined in the previous two tutorials work well with data that may periodically change and does not take exorbitantly long to generate.</span></span> <span data-ttu-id="f9cf4-132">Ale jeśli nigdy nie zmieni się dane w pamięci podręcznej, po upływie posługują się ładowanie reaktywne jest zbędny.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-132">But if the cached data never changes, the expiry used by reactive loading is superfluous.</span></span> <span data-ttu-id="f9cf4-133">Podobnie jeśli dane są buforowane przyjmuje nadmiernie dużo czasu, aby wygenerować, następnie tych użytkowników, których żądania Znajdź pustą pamięć podręczna będzie musiał zmieścić długiego oczekiwania podczas danych bazowych są pobierane.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-133">Likewise, if the data being cached takes an exceedingly long time to generate, then those users whose requests find the cache empty will have to endure a lengthy wait while the underlying data is retrieved.</span></span> <span data-ttu-id="f9cf4-134">Należy wziąć pod uwagę buforowanie danych statycznych i danych, która przyjmuje wyjątkowo dużo czasu, można wygenerować przy uruchamianiu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-134">Consider caching static data and data that takes an exceptionally long time to generate at application startup.</span></span>

<span data-ttu-id="f9cf4-135">Gdy bazy danych mają wiele dynamiczny, często Zmienianie wartości większość również mieć ilość danych statycznych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-135">While databases have many dynamic, frequently-changing values, most also have a fair amount of static data.</span></span> <span data-ttu-id="f9cf4-136">Na przykład praktycznie wszystkich modeli danych może mieć jedną lub więcej kolumn zawierających określoną wartość z zakresu od stały zestaw opcji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-136">For example, virtually all data models have one or more columns that contain a particular value from a fixed set of choices.</span></span> <span data-ttu-id="f9cf4-137">A `Patients` tabeli bazy danych może być `PrimaryLanguage` kolumny, w których zestaw wartości może być język angielski, hiszpański, francuski, rosyjski, japoński i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-137">A `Patients` database table might have a `PrimaryLanguage` column, whose set of values could be English, Spanish, French, Russian, Japanese, and so on.</span></span> <span data-ttu-id="f9cf4-138">Często, następujące typy kolumn są implementowane za pomocą *tabel odnośników*.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-138">Oftentimes, these types of columns are implemented using *lookup tables*.</span></span> <span data-ttu-id="f9cf4-139">Zamiast przechowywania ciągu angielski lub francuski w `Patients` tabeli drugiej tabeli zostanie utworzone, zwykle dwóch kolumn — Unikatowy identyfikator i opis ciągu — przy użyciu rekordu dla wszystkich możliwych wartości.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-139">Rather than storing the string English or French in the `Patients` table, a second table is created that has, commonly, two columns - a unique identifier and a string description - with a record for each possible value.</span></span> <span data-ttu-id="f9cf4-140">`PrimaryLanguage` Kolumny w `Patients` odpowiedni identyfikator unikatowy w tabeli są przechowywane w tabeli odnośników.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-140">The `PrimaryLanguage` column in the `Patients` table stores the corresponding unique identifier in the lookup table.</span></span> <span data-ttu-id="f9cf4-141">Na rysunku 1 pacjenta Jan Nowak s podstawowy język jest angielski, podczas Ed Johnson s ma wartość Rosyjska.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-141">In Figure 1, patient John Doe s primary language is English, while Ed Johnson s is Russian.</span></span>

![Tabela językach znajduje się tabela odnośników używana w tabeli pacjentów](caching-data-at-application-startup-vb/_static/image1.png)

<span data-ttu-id="f9cf4-143">**Rysunek 1**: `Languages` Tabela znajduje się tabela odnośników używane przez `Patients` tabeli</span><span class="sxs-lookup"><span data-stu-id="f9cf4-143">**Figure 1**: The `Languages` Table is a Lookup Table Used by the `Patients` Table</span></span>

<span data-ttu-id="f9cf4-144">Interfejs użytkownika do edytowania lub tworzenia nowego pacjenta obejmuje listę rozwijaną listę języków dopuszczalny rozmiar, wypełniony przez rekordów w `Languages` tabeli.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-144">The user interface for editing or creating a new patient would include a drop-down list of allowable languages populated by the records in the `Languages` table.</span></span> <span data-ttu-id="f9cf4-145">Bez buforowania, każdym razem, ten interfejs jest odwiedzone system musi wykonać zapytanie `Languages` tabeli.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-145">Without caching, each time this interface is visited the system must query the `Languages` table.</span></span> <span data-ttu-id="f9cf4-146">Jest to marnotrawstwa i niepotrzebnych ponieważ wartości tabeli odnośników zmianie w bardzo rzadko, jeśli kiedykolwiek.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-146">This is wasteful and unnecessary since lookup table values change very infrequently, if ever.</span></span>

<span data-ttu-id="f9cf4-147">Firma Microsoft może w pamięci podręcznej `Languages` danych przy użyciu tych samych technik reaktywne ładowania badany w poprzednich samouczkach.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-147">We could cache the `Languages` data using the same reactive loading techniques examined in the previous tutorials.</span></span> <span data-ttu-id="f9cf4-148">Jednak reaktywne ładowania używa wygaśnięcia na podstawie czasu, który nie jest wymagany dla statycznych tabeli danych wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-148">Reactive loading, however, uses a time-based expiry, which is not needed for static lookup table data.</span></span> <span data-ttu-id="f9cf4-149">Podczas buforowania przy użyciu ładowania reaktywne byłoby lepsze niż Brak buforowania na wszystkich, najlepszym rozwiązaniem jest aktywnie ładowania danych tabeli wyszukiwania w pamięci podręcznej podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-149">While caching using reactive loading would be better than no caching at all, the best approach would be to proactively load the lookup table data into the cache at application startup.</span></span>

<span data-ttu-id="f9cf4-150">W tym samouczku przedstawiony zostanie sposób dane tabeli wyszukiwania w pamięci podręcznej i innych informacji statycznych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-150">In this tutorial we will look at how to cache lookup table data and other static information.</span></span>

## <a name="step-2-examining-the-different-ways-to-cache-data"></a><span data-ttu-id="f9cf4-151">Krok 2. Badanie różnych sposobów dane z pamięci podręcznej</span><span class="sxs-lookup"><span data-stu-id="f9cf4-151">Step 2: Examining the Different Ways to Cache Data</span></span>

<span data-ttu-id="f9cf4-152">Informacje mogą być buforowane programowo w aplikacji ASP.NET przy użyciu różnych metod.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-152">Information can be programmatically cached in an ASP.NET application using a variety of approaches.</span></span> <span data-ttu-id="f9cf4-153">Firma Microsoft ve już już, jak używać pamięci podręcznej danych w poprzednich samouczkach.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-153">We ve already seen how to use the data cache in previous tutorials.</span></span> <span data-ttu-id="f9cf4-154">Alternatywnie obiekty mogą być programowo buforowane przy użyciu *statyczne elementy członkowskie* lub *stan aplikacji*.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-154">Alternatively, objects can be programmatically cached using *static members* or *application state*.</span></span>

<span data-ttu-id="f9cf4-155">Podczas pracy z klasą, zazwyczaj należy najpierw można utworzyć wystąpienia klasy przed jej składowych jest możliwy.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-155">When working with a class, typically the class must first be instantiated before its members can be accessed.</span></span> <span data-ttu-id="f9cf4-156">Na przykład aby można było wywołać metodę z jednej z klas w naszym warstwy logiki biznesowej, firma Microsoft musi najpierw utworzyć wystąpienia klasy:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-156">For example, in order to invoke a method from one of the classes in our Business Logic Layer, we must first create an instance of the class:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample1.vb)]

<span data-ttu-id="f9cf4-157">Zanim firma Microsoft może wywołać *SomeMethod* i pracować z *SomeProperty*, firma Microsoft musi najpierw utworzyć wystąpienie klasy przy użyciu `New` — słowo kluczowe.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-157">Before we can invoke *SomeMethod* or work with *SomeProperty*, we must first create an instance of the class using the `New` keyword.</span></span> <span data-ttu-id="f9cf4-158">*SomeMethod* i *SomeProperty* są skojarzone z określonym wystąpieniem.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-158">*SomeMethod* and *SomeProperty* are associated with a particular instance.</span></span> <span data-ttu-id="f9cf4-159">Okres istnienia tych elementów członkowskich jest powiązany z okresem istnienia ich skojarzonego obiektu.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-159">The lifetime of these members is tied to the lifetime of their associated object.</span></span> <span data-ttu-id="f9cf4-160">*Statyczne elementy członkowskie*, z drugiej strony są zmiennych, właściwości i metod, które są współużytkowane przez *wszystkich* wystąpienia klasy i w związku z tym, mają tak długo, jak klasa okres istnienia.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-160">*Static members*, on the other hand, are variables, properties, and methods that are shared among *all* instances of the class and, consequently, have a lifetime as long as the class.</span></span> <span data-ttu-id="f9cf4-161">Statyczne elementy członkowskie są oznaczone przez słowo kluczowe `Shared`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-161">Static members are denoted by the keyword `Shared`.</span></span>

<span data-ttu-id="f9cf4-162">Oprócz statycznych składowych danych mogą być buforowane, przy użyciu stanu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-162">In addition to static members, data can be cached using application state.</span></span> <span data-ttu-id="f9cf4-163">Każda aplikacja ASP.NET obsługuje kolekcji nazwa/wartość tego s współużytkowane przez wszystkich użytkowników i stron aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-163">Each ASP.NET application maintains a name/value collection that s shared across all users and pages of the application.</span></span> <span data-ttu-id="f9cf4-164">Ta kolekcja jest możliwy za pomocą [ `HttpContext` klasy](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) s [ `Application` właściwość](https://msdn.microsoft.com/library/system.web.httpcontext.application.aspx)i użyty z komputera z kodem klasę ASP.NET strony s w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-164">This collection can be accessed using the [`HttpContext` class](https://msdn.microsoft.com/library/system.web.httpcontext.aspx) s [`Application` property](https://msdn.microsoft.com/library/system.web.httpcontext.application.aspx), and used from an ASP.NET page s code-behind class like so:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample2.vb)]

<span data-ttu-id="f9cf4-165">Pamięć podręczna danych udostępnia znacznie bogatszy interfejs API do buforowania danych, dzięki czemu mechanizmów expiries na podstawie czasu i zależności, priorytetów element pamięci podręcznej i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-165">The data cache provides a much richer API for caching data, providing mechanisms for time- and dependency-based expiries, cache item priorities, and so forth.</span></span> <span data-ttu-id="f9cf4-166">Statyczne elementy członkowskie i stan aplikacji takich funkcji, należy dodać ręcznie przez dewelopera strony.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-166">With static members and application state, such features must be manually added by the page developer.</span></span> <span data-ttu-id="f9cf4-167">Gdy buforowanie danych przy uruchamianiu aplikacji dla cyklu życia aplikacji, jednak korzyści wynikające z pamięci podręcznej s danych są moot.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-167">When caching data at application startup for the lifetime of the application, however, the data cache s advantages are moot.</span></span> <span data-ttu-id="f9cf4-168">W tym samouczku Zapoznamy się kod, który używa wszystkich trzech metod do buforowania danych statycznych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-168">In this tutorial we'll look at code that uses all three techniques for caching static data.</span></span>

## <a name="step-3-caching-thesupplierstable-data"></a><span data-ttu-id="f9cf4-169">Krok 3. Buforowanie`Suppliers`tabeli danych</span><span class="sxs-lookup"><span data-stu-id="f9cf4-169">Step 3: Caching the`Suppliers`Table Data</span></span>

<span data-ttu-id="f9cf4-170">Northwind bazy danych tabel, firma Microsoft ve zaimplementowane data nie zawierają żadnych tabel odnośników tradycyjnych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-170">The Northwind database tables we ve implemented to date do not include any traditional lookup tables.</span></span> <span data-ttu-id="f9cf4-171">Cztery DataTables zaimplementowany w naszej DAL wszystkie tabele modelu, w których wartości są niestatycznych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-171">The four DataTables implemented in our DAL all model tables whose values are non-static.</span></span> <span data-ttu-id="f9cf4-172">Zamiast poświęcania czasu, aby dodać nową tabelę DataTable warstwy DAL nowej klasy i metody służące do LOGIKI dla właśnie w tym samouczku umożliwiają s poudawać, `Suppliers` tabeli s danych jest statyczna.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-172">Rather than spending the time to add a new DataTable to the DAL and then a new class and methods to the BLL, for this tutorial let s just pretend that the `Suppliers` table s data is static.</span></span> <span data-ttu-id="f9cf4-173">W związku z tym firma Microsoft może buforować tych danych, podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-173">Therefore, we could cache this data at application startup.</span></span>

<span data-ttu-id="f9cf4-174">Aby rozpocząć, Utwórz nową klasę o nazwie `StaticCache.cs` w `CL` folderu.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-174">To start, create a new class named `StaticCache.cs` in the `CL` folder.</span></span>

![Utwórz klasę StaticCache.vb w folderze CL](caching-data-at-application-startup-vb/_static/image2.png)

<span data-ttu-id="f9cf4-176">**Rysunek 2**: Tworzenie `StaticCache.vb` klasy w `CL` folderu</span><span class="sxs-lookup"><span data-stu-id="f9cf4-176">**Figure 2**: Create the `StaticCache.vb` Class in the `CL` Folder</span></span>

<span data-ttu-id="f9cf4-177">Musimy dodać metodę, która służy do ładowania danych przy uruchamianiu w magazynie odpowiedniej pamięci podręcznej, a także metody, które zwracają dane z tej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-177">We need to add a method that loads the data at startup into the appropriate cache store, as well as methods that return data from this cache.</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample3.vb)]

<span data-ttu-id="f9cf4-178">Powyższy kod używa zmienną statyczną składową `suppliers`, do przechowywania wyników z `SuppliersBLL` klasy s `GetSuppliers()` metody, która jest wywoływana z `LoadStaticCache()` metody.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-178">The above code uses a static member variable, `suppliers`, to hold the results from the `SuppliersBLL` class s `GetSuppliers()` method, which is called from the `LoadStaticCache()` method.</span></span> <span data-ttu-id="f9cf4-179">`LoadStaticCache()` Metoda jest przeznaczona do wywołania podczas uruchamiania s aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-179">The `LoadStaticCache()` method is meant to be called during the application s start.</span></span> <span data-ttu-id="f9cf4-180">Po załadowaniu tych danych przy uruchamianiu aplikacji stronę, którą musi współpracować z dostawcą danych może wywołać `StaticCache` klasy s `GetSuppliers()` metody.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-180">Once this data has been loaded at application startup, any page that needs to work with supplier data can call the `StaticCache` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="f9cf4-181">W związku z tym wywołanie do bazy danych w celu uzyskania dostawców odbywa się tylko raz, podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-181">Therefore, the call to the database to get the suppliers only happens once, at application start.</span></span>

<span data-ttu-id="f9cf4-182">Zamiast używania zmienną statycznej składowej jako magazynu pamięci podręcznej, można też użyliśmy stan aplikacji lub pamięci podręcznej danych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-182">Rather than using a static member variable as the cache store, we could have alternatively used application state or the data cache.</span></span> <span data-ttu-id="f9cf4-183">Poniższy kod pokazuje klasy retooled do wartości stanu aplikacji:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-183">The following code shows the class retooled to use application state:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample4.vb)]

<span data-ttu-id="f9cf4-184">W `LoadStaticCache()`, informacji o dostawcy jest przechowywany w zmiennej aplikacji *klucz*.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-184">In `LoadStaticCache()`, the supplier information is stored to the application variable *key*.</span></span> <span data-ttu-id="f9cf4-185">Jego s zwracane jako odpowiedniego typu (`Northwind.SuppliersDataTable`) z `GetSuppliers()`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-185">It s returned as the appropriate type (`Northwind.SuppliersDataTable`) from `GetSuppliers()`.</span></span> <span data-ttu-id="f9cf4-186">Gdy stan aplikacji jest możliwy w klasach związanym z kodem stron programu ASP.NET przy użyciu `Application("key")`, w ramach architektury, trzeba użyć `HttpContext.Current.Application("key")` Aby uzyskać bieżącą `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-186">While application state can be accessed in the code-behind classes of ASP.NET pages using `Application("key")`, in the architecture we must use `HttpContext.Current.Application("key")` in order to get the current `HttpContext`.</span></span>

<span data-ttu-id="f9cf4-187">Podobnie pamięć podręczną danych może służyć do przechowywania w pamięci podręcznej, co ilustruje poniższy kod:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-187">Likewise, the data cache can be used as a cache store, as the following code shows:</span></span>

[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample5.vb)]

<span data-ttu-id="f9cf4-188">Aby dodać element do pamięci podręcznej danych przez nieograniczony czas na podstawie czasu, należy użyć `System.Web.Caching.Cache.NoAbsoluteExpiration` i `System.Web.Caching.Cache.NoSlidingExpiration` wartości jako parametry wejściowe.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-188">To add an item to the data cache with no time-based expiry, use the `System.Web.Caching.Cache.NoAbsoluteExpiration` and `System.Web.Caching.Cache.NoSlidingExpiration` values as input parameters.</span></span> <span data-ttu-id="f9cf4-189">Tego określonego przeciążenia pamięci podręcznej danych s `Insert` została wybrana metoda, tak aby można było podać *priorytet* elementu pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-189">This particular overload of the data cache s `Insert` method was selected so that we could specify the *priority* of the cache item.</span></span> <span data-ttu-id="f9cf4-190">Priorytet jest używany do określenia, jakie elementy, aby oczyścić z pamięci podręcznej, kiedy jest za mało dostępnej pamięci.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-190">The priority is used to determine what items to scavenge from the cache when available memory runs low.</span></span> <span data-ttu-id="f9cf4-191">W tym miejscu użyjemy priorytet `NotRemovable`, dzięki któremu nie będzie oczyszczanie tego elementu w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-191">Here we use the priority `NotRemovable`, which ensures that this cache item won't be scavenged.</span></span>

> [!NOTE]
> <span data-ttu-id="f9cf4-192">Implementuje ten plik do pobrania samouczek s `StaticCache` klasy przy użyciu podejścia zmiennej członka statycznego.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-192">This tutorial s download implements the `StaticCache` class using the static member variable approach.</span></span> <span data-ttu-id="f9cf4-193">Kod technik pamięci podręcznej stanu i danych aplikacji jest dostępna w komentarzach w pliku klasy.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-193">The code for the application state and data cache techniques is available in the comments in the class file.</span></span>

## <a name="step-4-executing-code-at-application-startup"></a><span data-ttu-id="f9cf4-194">Krok 4. Wykonywanie kodu przy uruchamianiu aplikacji</span><span class="sxs-lookup"><span data-stu-id="f9cf4-194">Step 4: Executing Code at Application Startup</span></span>

<span data-ttu-id="f9cf4-195">Aby wykonać kod, po pierwszym uruchomieniu aplikacji sieci web, należy utworzyć specjalny plik o nazwie `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-195">To execute code when a web application first starts, we need to create a special file named `Global.asax`.</span></span> <span data-ttu-id="f9cf4-196">Ten plik może zawierać programy obsługi zdarzeń dla aplikacji-, sesja- i zdarzeń na poziomie żądania i jest w tym miejscu gdzie można dodać kod, który będzie wykonywany przy każdym uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-196">This file can contain event handlers for application-, session-, and request-level events, and it is here where we can add code that will be executed whenever the application starts.</span></span>

<span data-ttu-id="f9cf4-197">Dodaj `Global.asax` plik do katalogu głównego s aplikacji sieci web, kliknij prawym przyciskiem myszy nazwę projektu witryny sieci Web w programie Visual Studio s Eksploratora rozwiązań i wybierając pozycję Dodaj nowy element.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-197">Add the `Global.asax` file to your web application s root directory by right-clicking on the website project name in Visual Studio s Solution Explorer and choosing Add New Item.</span></span> <span data-ttu-id="f9cf4-198">W oknie dialogowym Dodaj nowy element wybierz typ elementu globalna klasa aplikacji, a następnie kliknij przycisk Dodaj.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-198">From the Add New Item dialog box, select the Global Application Class item type and then click the Add button.</span></span>

> [!NOTE]
> <span data-ttu-id="f9cf4-199">Jeśli masz już `Global.asax` plik w projekcie, globalna klasa aplikacji typu elementu nie będzie wyświetlane w oknie dialogowym Dodaj nowy element.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-199">If you already have a `Global.asax` file in your project, the Global Application Class item type will not be listed in the Add New Item dialog box.</span></span>

<span data-ttu-id="f9cf4-200">[![Dodaj plik Global.asax do katalogu głównego s aplikacji sieci Web](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-200">[![Add the Global.asax File to Your Web Application s Root Directory](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span></span>

<span data-ttu-id="f9cf4-201">**Rysunek 3**: Dodaj `Global.asax` plik, aby Twoja aplikacja sieci Web s katalogu głównego ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-at-application-startup-vb/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="f9cf4-201">**Figure 3**: Add the `Global.asax` File to Your Web Application s Root Directory ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image5.png))</span></span>

<span data-ttu-id="f9cf4-202">Wartość domyślna `Global.asax` szablon pliku zawiera pięć metod, w ramach po stronie serwera `<script>` tag:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-202">The default `Global.asax` file template includes five methods within a server-side `<script>` tag:</span></span>

- <span data-ttu-id="f9cf4-203">**`Application_Start`** wykonuje podczas pierwszego uruchomienia aplikacji sieci web</span><span class="sxs-lookup"><span data-stu-id="f9cf4-203">**`Application_Start`** executes when the web application first starts</span></span>
- <span data-ttu-id="f9cf4-204">**`Application_End`** jest uruchamiany, gdy dana aplikacja jest zamykana.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-204">**`Application_End`** runs when the application is shutting down</span></span>
- <span data-ttu-id="f9cf4-205">**`Application_Error`** wykonywana zawsze, gdy wystąpił nieobsługiwany wyjątek dotrze do aplikacji</span><span class="sxs-lookup"><span data-stu-id="f9cf4-205">**`Application_Error`** executes whenever an unhandled exception reaches the application</span></span>
- <span data-ttu-id="f9cf4-206">**`Session_Start`** wykonuje, gdy zostanie utworzona nowa sesja</span><span class="sxs-lookup"><span data-stu-id="f9cf4-206">**`Session_Start`** executes when a new session is created</span></span>
- <span data-ttu-id="f9cf4-207">**`Session_End`** jest uruchamiany, gdy wygasł lub porzucony sesji</span><span class="sxs-lookup"><span data-stu-id="f9cf4-207">**`Session_End`** runs when a session is expired or abandoned</span></span>

<span data-ttu-id="f9cf4-208">`Application_Start` Program obsługi zdarzeń jest wywoływana tylko raz podczas cyklu życia aplikacji s.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-208">The `Application_Start` event handler is called only once during an application s life cycle.</span></span> <span data-ttu-id="f9cf4-209">Aplikacja rozpoczyna się po raz pierwszy zasobu ASP.NET żądania od aplikacji i będzie kontynuowane do czasu ponownego uruchomienia aplikacji, która może się zdarzyć, modyfikując zawartość `/Bin` folderu, modyfikując `Global.asax`, modyfikowania zawartość w `App_Code` folderu lub modyfikowanie `Web.config` pliku wśród innych przyczyn.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-209">The application starts the first time an ASP.NET resource is requested from the application and continues to run until the application is restarted, which can happen by modifying the contents of the `/Bin` folder, modifying `Global.asax`, modifying the contents in the `App_Code` folder, or modifying the `Web.config` file, among other causes.</span></span> <span data-ttu-id="f9cf4-210">Zapoznaj się [Przegląd cyklu życia aplikacji ASP.NET](https://msdn.microsoft.com/library/ms178473.aspx) bardziej szczegółowe omówienie dotyczące cyklu życia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-210">Refer to [ASP.NET Application Life Cycle Overview](https://msdn.microsoft.com/library/ms178473.aspx) for a more detailed discussion on the application life cycle.</span></span>

<span data-ttu-id="f9cf4-211">Te samouczki tylko musimy dodać kod, aby `Application_Start` metody, więc możesz usunąć pozostałe.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-211">For these tutorials we only need to add code to the `Application_Start` method, so feel free to remove the others.</span></span> <span data-ttu-id="f9cf4-212">W `Application_Start`, wystarczy wywołać `StaticCache` klasy s `LoadStaticCache()` metody, która będzie załadować i buforowania informacji o dostawcy:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-212">In `Application_Start`, simply call the `StaticCache` class s `LoadStaticCache()` method, which will load and cache the supplier information:</span></span>

[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample6.aspx)]

<span data-ttu-id="f9cf4-213">Wszystkie dostępne tego s jest!</span><span class="sxs-lookup"><span data-stu-id="f9cf4-213">That s all there is to it!</span></span> <span data-ttu-id="f9cf4-214">Przy uruchamianiu aplikacji `LoadStaticCache()` metoda pobrania informacji o dostawcy z LOGIKI i go przechowywać w zmiennej członka statycznego (lub niezależnie od pamięci podręcznej przechowywanie możesz zakończył się przy użyciu w `StaticCache` klasy).</span><span class="sxs-lookup"><span data-stu-id="f9cf4-214">At application startup, the `LoadStaticCache()` method will grab the supplier information from the BLL, and store it in a static member variable (or whatever cache store you ended up using in the `StaticCache` class).</span></span> <span data-ttu-id="f9cf4-215">Aby sprawdzić to zachowanie, ustaw punkt przerwania `Application_Start` metody i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-215">To verify this behavior, set a breakpoint in the `Application_Start` method and run your application.</span></span> <span data-ttu-id="f9cf4-216">Należy pamiętać, że punkt przerwania zostaje trafiony po uruchomieniu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-216">Note that the breakpoint is hit upon the application starting.</span></span> <span data-ttu-id="f9cf4-217">Kolejne żądania, jednak nie powodują `Application_Start` wykonać metodę.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-217">Subsequent requests, however, do not cause the `Application_Start` method to execute.</span></span>

<span data-ttu-id="f9cf4-218">[![Użyj punkt przerwania, aby Sprawdź, czy program obsługi zdarzeń Application_Start jest wykonywana.](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-218">[![Use a Breakpoint to Verify that the Application_Start Event Handler is Being Executed](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span></span>

<span data-ttu-id="f9cf4-219">**Rysunek 4**: Użyj punkt przerwania, aby upewnij się, `Application_Start` procedura obsługi zdarzeń jest wykonywane ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-at-application-startup-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f9cf4-219">**Figure 4**: Use a Breakpoint to Verify that the `Application_Start` Event Handler is Being Executed ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image8.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f9cf4-220">Jeśli nie zostanie osiągnięty `Application_Start` przerwania podczas uruchamiania debugowania, oznacza to, że aplikacja została już uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-220">If you do not hit the `Application_Start` breakpoint when you first start debugging, it is because your application has already started.</span></span> <span data-ttu-id="f9cf4-221">Wymuś ponowne uruchomienie, modyfikując swoje `Global.asax` lub `Web.config` pliki, a następnie spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-221">Force the application to restart by modifying your `Global.asax` or `Web.config` files and then try again.</span></span> <span data-ttu-id="f9cf4-222">Można po prostu Dodaj (lub usuń) pusty wiersz na końcu jednego z tych plików, aby szybko uruchomić ponownie aplikację.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-222">You can simply add (or remove) a blank line at the end of one of these files to quickly restart the application.</span></span>

## <a name="step-5-displaying-the-cached-data"></a><span data-ttu-id="f9cf4-223">Krok 5. Wyświetlanie danych pamięci podręcznej</span><span class="sxs-lookup"><span data-stu-id="f9cf4-223">Step 5: Displaying the Cached Data</span></span>

<span data-ttu-id="f9cf4-224">W tym momencie `StaticCache` klasa ma wersję dostawcy danych, pamięci podręcznej podczas uruchamiania aplikacji, który jest możliwy za pośrednictwem jego `GetSuppliers()` metody.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-224">At this point the `StaticCache` class has a version of the supplier data cached at application startup that can be accessed through its `GetSuppliers()` method.</span></span> <span data-ttu-id="f9cf4-225">Aby pracować z danymi z warstwy prezentacji, możemy użyć kontrolki ObjectDataSource lub programowo wywołania `StaticCache` klasy s `GetSuppliers()` metody z klasy związane z kodem strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-225">To work with this data from the Presentation Layer, we can use an ObjectDataSource or programmatically invoke the `StaticCache` class s `GetSuppliers()` method from an ASP.NET page s code-behind class.</span></span> <span data-ttu-id="f9cf4-226">Pozwól, s, Przyjrzyj się za pomocą kontrolki ObjectDataSource i GridView do wyświetlania informacji o dostawcy pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-226">Let s look at using the ObjectDataSource and GridView controls to display the cached supplier information.</span></span>

<span data-ttu-id="f9cf4-227">Zacznij od otwarcia `AtApplicationStartup.aspx` stronie `Caching` folderu.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-227">Start by opening the `AtApplicationStartup.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="f9cf4-228">Przeciągnij GridView z przybornika w projektancie, ustawiając jego `ID` właściwość `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-228">Drag a GridView from the Toolbox onto the designer, setting its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="f9cf4-229">Następnie z widoku GridView tagu inteligentnego s zdecydować się na utworzenie nowego elementu ObjectDataSource, o nazwie `SuppliersCachedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-229">Next, from the GridView s smart tag choose to create a new ObjectDataSource named `SuppliersCachedDataSource`.</span></span> <span data-ttu-id="f9cf4-230">Konfigurowanie kontrolki ObjectDataSource używać `StaticCache` klasy s `GetSuppliers()` metody.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-230">Configure the ObjectDataSource to use the `StaticCache` class s `GetSuppliers()` method.</span></span>

<span data-ttu-id="f9cf4-231">[![Konfigurowanie kontrolki ObjectDataSource na korzystanie z klasy StaticCache](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-231">[![Configure the ObjectDataSource to use the StaticCache Class](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span></span>

<span data-ttu-id="f9cf4-232">**Rysunek 5**: Konfigurowanie kontrolki ObjectDataSource używać `StaticCache` klasy ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-at-application-startup-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f9cf4-232">**Figure 5**: Configure the ObjectDataSource to use the `StaticCache` Class ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image11.png))</span></span>

<span data-ttu-id="f9cf4-233">[![Pobieranie danych dostawcy pamięci podręcznej przy użyciu metody GetSuppliers()](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-233">[![Use the GetSuppliers() Method to Retrieve the Cached Supplier Data](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span></span>

<span data-ttu-id="f9cf4-234">**Rysunek 6**: Użyj `GetSuppliers()` metody do pobierania danych dostawcy pamięci podręcznej ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-at-application-startup-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f9cf4-234">**Figure 6**: Use the `GetSuppliers()` Method to Retrieve the Cached Supplier Data ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image14.png))</span></span>

<span data-ttu-id="f9cf4-235">Po zakończeniu działania kreatora programu Visual Studio automatycznie doda BoundFields dla każdego pola danych w `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-235">After completing the wizard, Visual Studio will automatically add BoundFields for each of the data fields in `SuppliersDataTable`.</span></span> <span data-ttu-id="f9cf4-236">Z kontrolkami GridView i kontrolki ObjectDataSource s oznaczeniu deklaracyjnym powinien wyglądać podobnie do następującego:</span><span class="sxs-lookup"><span data-stu-id="f9cf4-236">Your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample7.aspx)]

<span data-ttu-id="f9cf4-237">Rysunek nr 7 przedstawia stronę po wyświetleniu za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-237">Figure 7 shows the page when viewed through a browser.</span></span> <span data-ttu-id="f9cf4-238">Dane wyjściowe są, niż było możemy ściągnąć dane z s LOGIKI `SuppliersBLL` klasy, ale przy użyciu `StaticCache` klasy zwraca dane dostawcy jako pamięci podręcznej podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-238">The output is the same had we pulled the data from the BLL s `SuppliersBLL` class, but using the `StaticCache` class returns the supplier data as cached at application startup.</span></span> <span data-ttu-id="f9cf4-239">Możesz ustawić punkty przerwania w `StaticCache` klasy s `GetSuppliers()` metodę, aby sprawdzić to zachowanie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-239">You can set breakpoints in the `StaticCache` class s `GetSuppliers()` method to verify this behavior.</span></span>

<span data-ttu-id="f9cf4-240">[![Dane dostawcy pamięci podręcznej są wyświetlane w widoku GridView](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-240">[![The Cached Supplier Data is Displayed in a GridView](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span></span>

<span data-ttu-id="f9cf4-241">**Rysunek 7**: Dane dostawcy pamięci podręcznej są wyświetlane w widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-at-application-startup-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f9cf4-241">**Figure 7**: The Cached Supplier Data is Displayed in a GridView ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image17.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f9cf4-242">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="f9cf4-242">Summary</span></span>

<span data-ttu-id="f9cf4-243">Większość każdy model danych zawiera ilość danych statycznych, zwykle implementowany w postaci tabel odnośników.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-243">Most every data model contains a fair amount of static data, usually implemented in the form of lookup tables.</span></span> <span data-ttu-id="f9cf4-244">Ponieważ te informacje są statyczne, s tam nie ma powodu do stale dostęp do bazy danych za każdym razem, te informacje mają być wyświetlone.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-244">Since this information is static, there s no reason to continually access the database each time this information needs to be displayed.</span></span> <span data-ttu-id="f9cf4-245">Ponadto ze względu na charakter statycznego, gdy buforowanie danych w miejscu s nie konieczności wygaśnięcia.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-245">Furthermore, due to its static nature, when caching the data there s no need for an expiry.</span></span> <span data-ttu-id="f9cf4-246">W tym samouczku będziemy pokazaliśmy, jak przyjmują takie dane i buforowanie w pamięci podręcznej danych stanu aplikacji i za pośrednictwem zmiennej członka statycznego.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-246">In this tutorial we saw how to take such data and cache it in the data cache, application state, and through a static member variable.</span></span> <span data-ttu-id="f9cf4-247">Te informacje są buforowane przy uruchamianiu aplikacji i pozostaje w pamięci podręcznej w okresie istnienia aplikacji s.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-247">This information is cached at application startup and remains in the cache throughout the application s lifetime.</span></span>

<span data-ttu-id="f9cf4-248">W tym samouczku i w ciągu ostatnich dwóch możemy ve przyjrzano się buforowanie danych na czas trwania okresu istnienia s aplikacji, a także przy użyciu expiries oparte na czasie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-248">In this tutorial and the past two, we ve looked at caching data for the duration of the application s lifetime as well as using time-based expiries.</span></span> <span data-ttu-id="f9cf4-249">Podczas buforowania danych bazy danych, jednak na podstawie czasu wygaśnięcia może być mniej niż idealne rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-249">When caching database data, though, a time-based expiry may be less than ideal.</span></span> <span data-ttu-id="f9cf4-250">Zamiast okresowo opróżniania pamięci podręcznej, jest optymalna do tylko wykluczać element pamięci podręcznej po zmodyfikowaniu podstawowych danych w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-250">Rather than periodically flushing the cache, it would be optimal to only evict the cached item when the underlying database data is modified.</span></span> <span data-ttu-id="f9cf4-251">Możliwe przy użyciu zależności pamięci podręcznej SQL, które zostaną omówione w naszym następnym samouczku jest to idealne rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-251">This ideal is possible through the use of SQL cache dependencies, which we'll examine in our next tutorial.</span></span>

<span data-ttu-id="f9cf4-252">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="f9cf4-252">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f9cf4-253">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="f9cf4-253">About the Author</span></span>

<span data-ttu-id="f9cf4-254">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-254">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f9cf4-255">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-255">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f9cf4-256">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f9cf4-256">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f9cf4-257">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-257">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f9cf4-258">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f9cf4-258">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f9cf4-259">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="f9cf4-259">Special Thanks To</span></span>

<span data-ttu-id="f9cf4-260">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-260">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f9cf4-261">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Teresa Murphy i Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="f9cf4-261">Lead reviewers for this tutorial were Teresa Murphy and Zack Jones.</span></span> <span data-ttu-id="f9cf4-262">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="f9cf4-262">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f9cf4-263">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-263">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f9cf4-264">[Poprzednie](caching-data-in-the-architecture-vb.md)
> [dalej](using-sql-cache-dependencies-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f9cf4-264">[Previous](caching-data-in-the-architecture-vb.md)
[Next](using-sql-cache-dependencies-vb.md)</span></span>
