---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-cs
title: Buforowanie danych za pomocą elementu ObjectDataSourceC#() | Microsoft Docs
author: rick-anderson
description: Buforowanie może oznaczać różnicę między powolną i szybką aplikacją sieci Web. Ten samouczek to pierwsze z czterech, które szczegółowo zaobserwują buforowanie w ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: bd87413c-8160-4520-a8a2-43b555c4183a
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: c9883314d6153b9816d9bad2a281ab3c0a816448
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612623"
---
# <a name="caching-data-with-the-objectdatasource-c"></a><span data-ttu-id="0fdd9-104">Buforowanie danych za pomocą kontrolki ObjectDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-104">Caching Data with the ObjectDataSource (C#)</span></span>

<span data-ttu-id="0fdd9-105">przez [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0fdd9-106">[Pobierz przykładową aplikację](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_CS.exe) lub [Pobierz plik PDF](caching-data-with-the-objectdatasource-cs/_static/datatutorial58cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_CS.exe) or [Download PDF](caching-data-with-the-objectdatasource-cs/_static/datatutorial58cs1.pdf)</span></span>

> <span data-ttu-id="0fdd9-107">Buforowanie może oznaczać różnicę między powolną i szybką aplikacją sieci Web.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="0fdd9-108">Ten samouczek to pierwsze z czterech, które szczegółowo zaobserwują buforowanie w ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="0fdd9-109">Zapoznaj się z kluczowymi założeniami buforowania i sposobem zastosowania buforowania do warstwy prezentacji za pomocą kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="0fdd9-110">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="0fdd9-110">Introduction</span></span>

<span data-ttu-id="0fdd9-111">W nauce komputerowej *buforowanie* jest procesem pozyskiwania danych lub informacji, które są kosztowne do uzyskania i przechowywania kopii w lokalizacji, do której jest szybszy dostęp.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="0fdd9-112">W przypadku aplikacji opartych na danych duże i złożone zapytania często zużywają większość czasu wykonywania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="0fdd9-113">Taka wydajność aplikacji s, a następnie, często można zwiększyć, przechowując wyniki kosztownych zapytań bazy danych w pamięci aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="0fdd9-114">ASP.NET 2,0 oferuje różne opcje buforowania.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="0fdd9-115">*W pamięci podręcznej*wyrenderowana cała strona sieci Web lub kontrolka użytkownika.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="0fdd9-116">Formanty ObjectDataSource i kontrolki SqlDataSource zapewniają również możliwości buforowania, co pozwala na przechowywanie danych w pamięci podręcznej na poziomie kontroli.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="0fdd9-117">I ASP.NET s *pamięć podręczna danych* oferuje bogaty interfejs API pamięci podręcznej, który umożliwia deweloperom stron programistyczne buforowanie obiektów.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="0fdd9-118">W tym samouczku i następnych trzech będziemy analizować przy użyciu funkcji buforowania elementów ObjectDataSource oraz pamięci podręcznej danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="0fdd9-119">Dowiesz się również, jak buforować dane w całej aplikacji przy uruchamianiu i jak przechowywać dane w pamięci podręcznej w sposób świeży przy użyciu zależności w przypadku bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="0fdd9-120">Te samouczki nie eksplorują wyjściowej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="0fdd9-121">Aby zapoznać się ze szczegółowymi informacjami na temat buforowania danych wyjściowych, zobacz [buforowanie danych wyjściowych w ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="0fdd9-122">Buforowanie może być stosowane w dowolnym miejscu architektury, od warstwy dostępu do danych za pośrednictwem warstwy prezentacji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="0fdd9-123">W tym samouczku Przyjrzyjmy się zastosowaniu buforowania do warstwy prezentacji za pomocą kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="0fdd9-124">W następnym samouczku będziemy analizować dane z pamięci podręcznej w warstwie logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="0fdd9-125">Pojęcia dotyczące buforowania kluczy</span><span class="sxs-lookup"><span data-stu-id="0fdd9-125">Key Caching Concepts</span></span>

<span data-ttu-id="0fdd9-126">Buforowanie może znacznie poprawić ogólną wydajność i skalowalność aplikacji dzięki wykorzystaniu danych, które są kosztowne do generowania i przechowywania kopii w lokalizacji, do której można uzyskać bardziej wydajny dostęp.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="0fdd9-127">Ponieważ pamięć podręczna zawiera tylko kopię rzeczywistych danych, dane bazowe mogą stać się nieaktualne lub *przestarzałe*, jeśli dane podstawowe ulegną zmianie.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="0fdd9-128">Aby to zwalczać, deweloper strony może wskazać kryteria, za pomocą których element pamięci podręcznej zostanie *wykluczony* z pamięci podręcznej przy użyciu:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="0fdd9-129">**Kryteria oparte na czasie** element można dodać do pamięci podręcznej przez czas bezwzględny lub ruchomy.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="0fdd9-130">Na przykład deweloper strony może wskazywać czas trwania, powiedzmy, 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="0fdd9-131">Po absolutnym czasie trwania buforowany element jest wykluczony 60 sekund po dodaniu go do pamięci podręcznej, niezależnie od tego, jak często uzyskano dostęp.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="0fdd9-132">Po przejściu w tryb buforowany element jest wykluczany 60 sekund od ostatniego dostępu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="0fdd9-133">Zależne od **zależności kryteria** , które można skojarzyć z elementem po dodaniu do pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="0fdd9-134">Gdy zmienia się zależność elementu, jest on wykluczony z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="0fdd9-135">Zależność może być plikiem, innym elementem pamięci podręcznej lub kombinacją dwóch.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="0fdd9-136">ASP.NET 2,0 umożliwia również zależności pamięci podręcznej SQL, które umożliwiają deweloperom dodanie elementu do pamięci podręcznej i wykluczenie go po zmianie danych źródłowych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="0fdd9-137">W nadchodzącym samouczku dotyczącym obsługi pamięci podręcznej SQL zostaną przeszukane zależności dotyczące usługi SQL [cache](using-sql-cache-dependencies-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="0fdd9-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-cs.md) tutorial.</span></span>

<span data-ttu-id="0fdd9-138">Niezależnie od określonych kryteriów wykluczenia, element w pamięci podręcznej może być *oczyszczany* przed spełnieniem kryteriów opartych na czasie lub w zależności od czasu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="0fdd9-139">Jeśli pamięć podręczna osiągnęła pojemność, istniejące elementy muszą zostać usunięte, aby można było dodać nowe.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="0fdd9-140">W związku z tym podczas programistycznego pracy z pamięcią podręczną, ważne jest, aby zawsze założyć, że dane buforowane mogą nie być obecne.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="0fdd9-141">Zobaczymy wzorzec, który będzie używany podczas programistycznego uzyskiwania dostępu do danych z pamięci podręcznej w następnym samouczku, *buforowanie danych w architekturze*.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="0fdd9-142">Buforowanie zapewnia ekonomiczny sposób na ściskanie większej wydajności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="0fdd9-143">Jako [Steven Smith](http://aspadvice.com/blogs/ssmith/) przegubs w swoim artykule [ASP.NET buforowanie: techniki i najlepsze rozwiązania](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="0fdd9-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="0fdd9-144">Buforowanie może być dobrym sposobem na uzyskanie odpowiedniej wydajności bez konieczności długiego czasu i analizy.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="0fdd9-145">Pamięć jest w stanie taniej, więc jeśli możesz uzyskać wymaganą wydajność, buforując dane wyjściowe przez 30 sekund zamiast spędzać dzień lub tydzień próbujący zoptymalizować kod lub bazę danych, wykonaj rozwiązanie buforowania (przy założeniu, że 30-sekundowe stare dane jest prawidłowe) i przejdź do.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="0fdd9-146">Na koniec niewłaściwy projekt prawdopodobnie zostanie wystawiony do Ciebie, dlatego należy spróbować prawidłowo zaprojektować aplikacje.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="0fdd9-147">Ale jeśli musisz już dzisiaj uzyskać wystarczającą wydajność, buforowanie może być doskonałym [podejściem], kupowanie czasu do refaktoryzacji aplikacji w późniejszym czasie, gdy będzie to możliwe.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="0fdd9-148">Chociaż buforowanie może zapewnić znaczne udoskonalenia wydajności, nie dotyczy to wszystkich sytuacji, takich jak aplikacje korzystające z czasu rzeczywistego, często aktualizowane dane lub, gdzie nawet wkrótce nie występują stare dane.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="0fdd9-149">Jednak w przypadku większości aplikacji buforowanie powinno być używane.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="0fdd9-150">Aby uzyskać więcej informacji na temat buforowania w ASP.NET 2,0, zapoznaj się z sekcją [buforowanie dla wydajności](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) w [samouczkach szybki start](https://quickstarts.asp.net/QuickStartv20/aspnet/)dotyczącej usługi ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="0fdd9-151">Krok 1. Tworzenie stron sieci Web pamięci podręcznej</span><span class="sxs-lookup"><span data-stu-id="0fdd9-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="0fdd9-152">Przed rozpoczęciem eksplorowania funkcji buforowania elementów ObjectDataSource, poświęć chwilę na utworzenie stron ASP.NET w naszym projekcie witryny sieci Web, które będziemy potrzebować do tego samouczka i trzech następnych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="0fdd9-153">Zacznij od dodania nowego folderu o nazwie `Caching`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="0fdd9-154">Następnie Dodaj następujące strony ASP.NET do tego folderu, aby upewnić się, że każda strona jest skojarzona z `Site.master` stroną wzorcową:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Dodaj strony ASP.NET dla samouczków dotyczących buforowania](caching-data-with-the-objectdatasource-cs/_static/image1.png)

<span data-ttu-id="0fdd9-156">**Rysunek 1**. dodawanie stron ASP.NET dla samouczków dotyczących buforowania</span><span class="sxs-lookup"><span data-stu-id="0fdd9-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="0fdd9-157">Podobnie jak w przypadku innych folderów, `Default.aspx` w folderze `Caching` wyświetli samouczki w sekcji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="0fdd9-158">Odwołaj się do tego, że formant użytkownika `SectionLevelTutorialListing.ascx` udostępnia tę funkcję.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="0fdd9-159">W związku z tym należy dodać tę kontrolkę użytkownika do `Default.aspx`, przeciągając ją z Eksplorator rozwiązań na stronę widok Projekt strony.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="0fdd9-160">[![rysunek 2: Dodawanie kontrolki użytkownika SectionLevelTutorialListing. ascx do default. aspx](caching-data-with-the-objectdatasource-cs/_static/image3.png)](caching-data-with-the-objectdatasource-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-cs/_static/image3.png)](caching-data-with-the-objectdatasource-cs/_static/image2.png)</span></span>

<span data-ttu-id="0fdd9-161">**Rysunek 2**. rysunek 2: Dodawanie kontrolki użytkownika `SectionLevelTutorialListing.ascx` do `Default.aspx` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image4.png))</span></span>

<span data-ttu-id="0fdd9-162">Na koniec Dodaj te strony jako wpisy do pliku `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="0fdd9-163">W tym celu Dodaj następujące znaczniki po pracy z danymi binarnymi `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-cs/samples/sample1.xml)]

<span data-ttu-id="0fdd9-164">Po aktualizacji `Web.sitemap`zapoznaj się z witryną internetową samouczków za pomocą przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="0fdd9-165">Menu po lewej stronie zawiera teraz elementy dla samouczków buforowania.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-165">The menu on the left now includes items for the caching tutorials.</span></span>

![Mapa witryny zawiera teraz wpisy dotyczące samouczków buforowania](caching-data-with-the-objectdatasource-cs/_static/image5.png)

<span data-ttu-id="0fdd9-167">**Rysunek 3**. Mapa witryny zawiera teraz wpisy dotyczące samouczków buforowania</span><span class="sxs-lookup"><span data-stu-id="0fdd9-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="0fdd9-168">Krok 2. Wyświetlanie listy produktów na stronie sieci Web</span><span class="sxs-lookup"><span data-stu-id="0fdd9-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="0fdd9-169">W tym samouczku przedstawiono sposób użycia wbudowanych funkcji pamięci podręcznej formantów ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="0fdd9-170">Zanim będziemy mogli zapoznać się z tymi funkcjami, najpierw potrzebujemy strony, z której korzystamy.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="0fdd9-171">Pozwól usłudze s utworzyć stronę sieci Web, która używa widoku GridView do wyświetlania informacji o produkcie pobieranych przez element ObjectDataSource z klasy `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="0fdd9-172">Zacznij od otwarcia strony `ObjectDataSource.aspx` w folderze `Caching`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="0fdd9-173">Przeciągnij widok GridView z przybornika do projektanta, ustaw jego właściwość `ID` na `Products`, a następnie z tagu inteligentnego Wybierz powiązanie go z nową kontrolką ObjectDataSource o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="0fdd9-174">Skonfiguruj element ObjectDataSource do pracy z klasą `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="0fdd9-175">[![skonfigurować element ObjectDataSource do używania klasy ProductsBLL](caching-data-with-the-objectdatasource-cs/_static/image7.png)](caching-data-with-the-objectdatasource-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-cs/_static/image7.png)](caching-data-with-the-objectdatasource-cs/_static/image6.png)</span></span>

<span data-ttu-id="0fdd9-176">**Ilustracja 4**. Konfigurowanie elementu ObjectDataSource do używania klasy `ProductsBLL` ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image8.png))</span></span>

<span data-ttu-id="0fdd9-177">Na tej stronie poczekaj, aż utworzysz edytowalny widok GridView, aby można było ocenić, co się dzieje, gdy dane w pamięci podręcznej w elemencie ObjectDataSource są modyfikowane za pomocą interfejsu GridView.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="0fdd9-178">Pozostaw listę rozwijaną na karcie Wybierz ustawioną na domyślną, `GetProducts()`, ale Zmień wybrany element na karcie aktualizacja na wartość przeciążenia `UpdateProduct`, która akceptuje `productName`, `unitPrice`i `productID` jako parametry wejściowe.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="0fdd9-179">[![ustawić listę rozwijaną kart Aktualizuj na odpowiednie Przeciążenie UpdateProduct](caching-data-with-the-objectdatasource-cs/_static/image10.png)](caching-data-with-the-objectdatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-cs/_static/image10.png)](caching-data-with-the-objectdatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="0fdd9-180">**Rysunek 5**. Ustawianie listy rozwijanej kart aktualizacji na odpowiednie Przeciążenie `UpdateProduct` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image11.png))</span></span>

<span data-ttu-id="0fdd9-181">Na koniec Ustaw listę rozwijaną na kartach Wstaw i Usuń na (brak), a następnie kliknij przycisk Zakończ.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="0fdd9-182">Po zakończeniu działania Kreatora konfiguracji źródła danych program Visual Studio ustawia właściwość `OldValuesParameterFormatString` ObjectDataSource s na `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="0fdd9-183">Zgodnie z opisem w temacie [Omówienie wstawiania, aktualizowania i usuwania danych](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) , ta właściwość musi zostać usunięta ze składni deklaratywnej lub ustawiona z powrotem na wartość domyślną `{0}`, aby nasz przepływ pracy aktualizacji kontynuował pracę bez błędu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="0fdd9-184">Ponadto po zakończeniu pracy kreatora program Visual Studio dodaje pole do widoku GridView dla każdego z pól danych produktu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="0fdd9-185">Usuń wszystkie oprócz `ProductName`, `CategoryName`i `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="0fdd9-186">Następnie zaktualizuj właściwości `HeaderText` każdego z BoundFields odpowiednio do produktu, kategorii i ceny.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="0fdd9-187">Ponieważ pole `ProductName` jest wymagane, przekonwertuj BoundField na TemplateField i Dodaj RequiredFieldValidator do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="0fdd9-188">Podobnie przekonwertuj `UnitPrice` BoundField na TemplateField i Dodaj CompareValidator, aby upewnić się, że wartość wprowadzona przez użytkownika jest prawidłową wartością waluty równą zero lub większą.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="0fdd9-189">Oprócz tych modyfikacji można korzystać z dowolnych zmian estetycznych, takich jak wyrównanie wartości `UnitPrice` lub określanie formatowania tekstu `UnitPrice` w interfejsach tylko do odczytu i edytowania.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="0fdd9-190">Przekształć element GridView w edytowalny, zaznaczając pole wyboru Włącz edycję w tagu inteligentnym GridView.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="0fdd9-191">Zaznacz również pole wyboru Włącz stronicowanie i Włącz sortowanie.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="0fdd9-192">Potrzebujesz przeglądu, jak dostosować interfejs edytowania GridView</span><span class="sxs-lookup"><span data-stu-id="0fdd9-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="0fdd9-193">Jeśli tak, zapoznaj się z artykułem [Dostosowywanie interfejsu modyfikacji danych](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="0fdd9-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span>

<span data-ttu-id="0fdd9-194">[![włączyć obsługę widoku GridView do edycji, sortowania i stronicowania](caching-data-with-the-objectdatasource-cs/_static/image13.png)](caching-data-with-the-objectdatasource-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-cs/_static/image13.png)](caching-data-with-the-objectdatasource-cs/_static/image12.png)</span></span>

<span data-ttu-id="0fdd9-195">**Ilustracja 6**. Włączanie obsługi widoku GridView do edycji, sortowania i stronicowania ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image14.png))</span></span>

<span data-ttu-id="0fdd9-196">Po dokonaniu tych modyfikacji GridView, znaczniki deklaracyjne i ObjectDataSource nie powinny wyglądać podobnie do następujących:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="0fdd9-197">Jak pokazano na rysunku 7, edytowalny widok GridView wyświetla nazwę, kategorię i cenę każdego produktu w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="0fdd9-198">Poświęć chwilę na przetestowanie funkcji strony, Sortuj wyniki, przechodząc do nich stronę i edytuj rekord.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="0fdd9-199">[![każdą nazwę produktu, kategorię i cenę są wyświetlane w obszarze Sortowanie, stronicowanie i edytowanie widoku GridView](caching-data-with-the-objectdatasource-cs/_static/image16.png)](caching-data-with-the-objectdatasource-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-cs/_static/image16.png)](caching-data-with-the-objectdatasource-cs/_static/image15.png)</span></span>

<span data-ttu-id="0fdd9-200">**Rysunek 7**. Każda nazwa produktu, Kategoria i cena są wymienione w obszarze Sortowanie, stronicowanie i edytowanie widoku GridView ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="0fdd9-201">Krok 3. Sprawdzanie, czy element ObjectDataSource żąda danych</span><span class="sxs-lookup"><span data-stu-id="0fdd9-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="0fdd9-202">`Products` GridView pobiera dane do wyświetlenia przez wywołanie metody `Select` `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="0fdd9-203">Ten element ObjectDataSource tworzy wystąpienie klasy logiki biznesowej `ProductsBLL` klasie i wywołuje metodę `GetProducts()`, która z kolei wywołuje metodę dostępu do danych s `ProductsTableAdapter` s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="0fdd9-204">Metoda DAL nawiązuje połączenie z bazą danych Northwind i wystawia skonfigurowaną kwerendę `SELECT`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="0fdd9-205">Te dane są następnie zwracane do DAL, które pakują je w `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="0fdd9-206">Obiekt DataTable jest zwracany do LOGIKI biznesowej, który zwraca go do elementu ObjectDataSource, który zwraca go do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="0fdd9-207">Następnie GridView tworzy obiekt `GridViewRow` dla każdego `DataRow` w elemencie DataTable, a każdy `GridViewRow` jest ostatecznie renderowany w kodzie HTML, który jest zwracany do klienta i wyświetlany w przeglądarce odwiedzających.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="0fdd9-208">Ta sekwencja zdarzeń występuje każdego, a za każdym razem, gdy GridView musi powiązać dane bazowe.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="0fdd9-209">Dzieje się tak, gdy strona jest po raz pierwszy odwiedzana podczas przechodzenia z jednej strony danych do innej, podczas sortowania GridView lub modyfikowania danych GridView za pośrednictwem wbudowanej edycji lub usuwania interfejsów.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="0fdd9-210">Jeśli stan widoku GridView jest wyłączony, element GridView zostanie Przewiązany na każdym i każdym ogłaszaniu zwrotnym.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="0fdd9-211">Widok GridView można również jawnie powiązać ze swoimi danymi, wywołując metodę `DataBind()`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="0fdd9-212">Aby w pełni uzyskać częstotliwość, z jaką dane są pobierane z bazy danych, pozwól na wyświetlenie komunikatu wskazującego, kiedy dane są pobierane ponownie.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="0fdd9-213">Dodaj kontrolkę sieci Web etykieta powyżej widoku GridView o nazwie `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="0fdd9-214">Wyczyść Właściwość `Text` i ustaw jej Właściwość `EnableViewState` na `false`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-214">Clear out its `Text` property and set its `EnableViewState` property to `false`.</span></span> <span data-ttu-id="0fdd9-215">Poniżej etykiety Dodaj kontrolkę sieci Web przycisk i ustaw jej Właściwość `Text` na zwrotne.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="0fdd9-216">[![dodać etykietę i przycisk do strony powyżej widoku GridView](caching-data-with-the-objectdatasource-cs/_static/image19.png)](caching-data-with-the-objectdatasource-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-cs/_static/image19.png)](caching-data-with-the-objectdatasource-cs/_static/image18.png)</span></span>

<span data-ttu-id="0fdd9-217">**Ilustracja 8**. Dodawanie etykiety i przycisku do strony nad widokiem GridView ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image20.png))</span></span>

<span data-ttu-id="0fdd9-218">Podczas przepływu pracy dostępu do danych zdarzenie ObjectDataSource s `Selecting` generowane przed utworzeniem obiektu źródłowego i wywołaniem jego skonfigurowanej metody.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="0fdd9-219">Utwórz procedurę obsługi zdarzeń dla tego zdarzenia i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-219">Create an event handler for this event and add the following code:</span></span>

[!code-csharp[Main](caching-data-with-the-objectdatasource-cs/samples/sample3.cs)]

<span data-ttu-id="0fdd9-220">Za każdym razem, gdy element ObjectDataSource wykonuje żądanie do architektury danych, w etykiecie zostanie wyświetlone zdarzenie wybierania tekstu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="0fdd9-221">Odwiedź Tę stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-221">Visit this page in a browser.</span></span> <span data-ttu-id="0fdd9-222">Po pierwszym odwiedzeniu strony zostanie wyświetlone zdarzenie z wybieraniem tekstu.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="0fdd9-223">Kliknij przycisk ogłaszania zwrotnego i Zauważ, że tekst znika (przy założeniu, że właściwość GridView `EnableViewState` jest ustawiona na `true`, wartość domyślna).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `true`, the default).</span></span> <span data-ttu-id="0fdd9-224">Jest to spowodowane tym, że w przypadku ogłaszania wstecznego widok GridView jest ponownie skonstruowany ze stanu widoku, dlatego nie jest on przełączany do elementu ObjectDataSource dla swoich danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="0fdd9-225">Jednak sortowanie, stronicowanie lub edytowanie danych powoduje, że widok GridView zostanie ponownie powiązany ze źródłem danych, a w związku z tym zostanie wyświetlony tekst wygenerowanego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="0fdd9-226">[![zawsze, gdy widok GridView zostanie odwiązany ze źródłem danych, zostanie wyświetlona opcja Wyzwalanie zdarzeń](caching-data-with-the-objectdatasource-cs/_static/image22.png)](caching-data-with-the-objectdatasource-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-cs/_static/image22.png)](caching-data-with-the-objectdatasource-cs/_static/image21.png)</span></span>

<span data-ttu-id="0fdd9-227">**Rysunek 9**. zawsze, gdy widok GridView zostanie Przewiązany ze źródłem danych, zostanie wyświetlona opcja wygenerowane zdarzenie ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image23.png))</span></span>

<span data-ttu-id="0fdd9-228">[![kliknięcie przycisku ogłaszania zwrotnego powoduje odbudowanie widoku GridView ze stanu widoku](caching-data-with-the-objectdatasource-cs/_static/image25.png)](caching-data-with-the-objectdatasource-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-cs/_static/image25.png)](caching-data-with-the-objectdatasource-cs/_static/image24.png)</span></span>

<span data-ttu-id="0fdd9-229">**Ilustracja 10**. kliknięcie przycisku ogłaszania zwrotnego powoduje odtworzenie widoku GridView ze stanu widoku ([kliknij, aby wyświetlić obraz o pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image26.png))</span></span>

<span data-ttu-id="0fdd9-230">Może się wydawać, że wasteful pobrać dane bazy danych za każdym razem, gdy dane są stronicowane lub sortowane.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="0fdd9-231">Ze względu na to, że od momentu ponownego użycia domyślnego stronicowania, element ObjectDataSource pobrał wszystkie rekordy podczas wyświetlania pierwszej strony.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="0fdd9-232">Nawet jeśli GridView nie zapewnia obsługi sortowania i stronicowania, dane muszą zostać pobrane z bazy danych za każdym razem, gdy strona jest najpierw odwiedzana przez dowolnego użytkownika (i na każdym odświeżeniu, jeśli stan widoku jest wyłączony).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="0fdd9-233">Ale jeśli GridView pokazuje te same dane dla wszystkich użytkowników, te dodatkowe żądania bazy danych są zbędne.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="0fdd9-234">Dlaczego nie można buforować wyników zwróconych z metody `GetProducts()` i powiązać widoku GridView z tymi, które są w nich buforowane?</span><span class="sxs-lookup"><span data-stu-id="0fdd9-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="0fdd9-235">Krok 4. buforowanie danych przy użyciu elementu ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="0fdd9-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="0fdd9-236">Po prostu ustawiając kilka właściwości, element ObjectDataSource można skonfigurować w taki sposób, aby automatycznie buforuł pobrane dane w pamięci podręcznej danych ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="0fdd9-237">Poniższa lista zawiera podsumowanie właściwości elementów ObjectDataSource związanych z pamięcią podręczną:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="0fdd9-238">Aby włączyć buforowanie, [EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) musi być ustawiona na wartość `true`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `true` to enable caching.</span></span> <span data-ttu-id="0fdd9-239">Wartość domyślna to `false`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-239">The default is `false`.</span></span>
- <span data-ttu-id="0fdd9-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) ilość czasu (w sekundach), przez który dane są buforowane.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="0fdd9-241">Wartość domyślna to 0.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-241">The default is 0.</span></span> <span data-ttu-id="0fdd9-242">Element ObjectDataSource będzie buforować dane tylko wtedy, gdy `EnableCaching` jest `true` i `CacheDuration` jest ustawiona na wartość większą od zera.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-242">The ObjectDataSource will only cache data if `EnableCaching` is `true` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="0fdd9-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) można ustawić na `Absolute` lub `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="0fdd9-244">W przypadku `Absolute`element ObjectDataSource zapisuje w pamięci podręcznej pobrane dane przez `CacheDuration` sekund; w przypadku `Sliding`dane wygasną dopiero po upływie `CacheDuration` sekund.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="0fdd9-245">Wartość domyślna to `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="0fdd9-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) ta właściwość służy do kojarzenia wpisów pamięci podręcznej ObjectDataSource s z istniejącą zależnością pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="0fdd9-247">Wpisy danych ObjectDataSource s można przedwcześnie wykluczyć z pamięci podręcznej, tracąc skojarzone `CacheKeyDependency`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="0fdd9-248">Ta właściwość jest najczęściej używana do kojarzenia zależności pamięci podręcznej SQL z pamięcią podręczną programu ObjectDataSources, a temat zostanie wyświetlony w przyszłości [przy użyciu samouczka zależności pamięci podręcznej SQL](using-sql-cache-dependencies-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="0fdd9-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-cs.md) tutorial.</span></span>

<span data-ttu-id="0fdd9-249">Zezwól usłudze s na skonfigurowanie `ProductsDataSource` elementu ObjectDataSource do buforowania danych przez 30 sekund na bezwzględnej skali.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="0fdd9-250">Ustaw właściwość `EnableCaching` ObjectDataSource s na `true` i jej Właściwość `CacheDuration` na wartość 30.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-250">Set the ObjectDataSource s `EnableCaching` property to `true` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="0fdd9-251">Pozostaw domyślną właściwość `CacheExpirationPolicy`, `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="0fdd9-252">[![skonfigurować element ObjectDataSource do buforowania danych przez 30 sekund](caching-data-with-the-objectdatasource-cs/_static/image28.png)](caching-data-with-the-objectdatasource-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-cs/_static/image28.png)](caching-data-with-the-objectdatasource-cs/_static/image27.png)</span></span>

<span data-ttu-id="0fdd9-253">**Ilustracja 11**. Konfigurowanie elementu ObjectDataSource do buforowania danych przez 30 sekund ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](caching-data-with-the-objectdatasource-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="0fdd9-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-cs/_static/image29.png))</span></span>

<span data-ttu-id="0fdd9-254">Zapisz zmiany i ponownie odwiedź tę stronę w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="0fdd9-255">Tekst, który zostanie wywołany, zostanie wyświetlony podczas pierwszej wizyty strony, jak początkowo dane nie znajdują się w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="0fdd9-256">Ale kolejne ogłaszanie zwrotne wyzwalane przez kliknięcie przycisku ogłaszania zwrotnego, sortowanie, stronicowanie lub kliknięcie przycisków Edytuj lub Anuluj *nie powoduje ponowne* wyświetlenia tekstu uruchomienia zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="0fdd9-257">Wynika to z faktu, że zdarzenie `Selecting` wyzwalane tylko wtedy, gdy element ObjectDataSource pobiera swoje dane z obiektu źródłowego; zdarzenie `Selecting` nie zostanie wywołane, jeśli dane są pobierane z pamięci podręcznej danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="0fdd9-258">Po 30 sekundach dane zostaną wykluczone z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="0fdd9-259">Dane zostaną również wykluczone z pamięci podręcznej, jeśli są wywoływane metody `Insert`, `Update`lub `Delete` elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="0fdd9-260">W związku z tym po upływie 30 sekund lub kliknięciu przycisku Aktualizuj, sortowaniu, stronicowaniu lub kliknięciu przycisków Edytuj lub Anuluj spowoduje to, że element ObjectDataSource ma pobrać dane z obiektu bazowego, co spowoduje wyświetlenie tekstu wywoływanego po zdarzeniu `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="0fdd9-261">Zwrócone wyniki są umieszczane w pamięci podręcznej danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="0fdd9-262">Jeśli widzisz częste zdarzenie wybierania tekstu, nawet jeśli oczekujesz, że element ObjectDataSource ma pracować z danymi buforowanymi, może to być spowodowane ograniczeniami pamięci.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="0fdd9-263">Jeśli nie ma wystarczającej ilości wolnej pamięci, dane dodane do pamięci podręcznej przez element ObjectDataSource mogły zostać oczyszczone.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="0fdd9-264">Jeśli element ObjectDataSource nie będzie prawidłowo buforujący danych lub tylko buforuje dane, Zamknij niektóre aplikacje, aby zwolnić pamięć, i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="0fdd9-265">Rysunek 12 ilustruje przepływ pracy buforowania elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="0fdd9-266">Gdy na ekranie pojawi się tekst wywoływanego zdarzenia wyboru, jest to spowodowane tym, że dane nie były w pamięci podręcznej i musiały zostać pobrane z obiektu źródłowego.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="0fdd9-267">Gdy ten tekst nie zostanie utracony, ponieważ dane były dostępne z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="0fdd9-268">Gdy dane są zwracane z pamięci podręcznej, nie są wywoływane z obiektem źródłowym, dlatego nie wykonano zapytania do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![Element ObjectDataSource przechowuje i pobiera dane z pamięci podręcznej danych](caching-data-with-the-objectdatasource-cs/_static/image30.png)

<span data-ttu-id="0fdd9-270">**Ilustracja 12**. Element ObjectDataSource przechowuje i pobiera dane z pamięci podręcznej danych</span><span class="sxs-lookup"><span data-stu-id="0fdd9-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="0fdd9-271">Każda aplikacja ASP.NET ma swoje własne wystąpienie pamięci podręcznej danych, które jest udostępniane na wszystkich stronach i odwiedzających.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="0fdd9-272">Oznacza to, że dane przechowywane w pamięci podręcznej danych przez element ObjectDataSource są również współużytkowane przez wszystkich użytkowników, którzy odwiedzają stronę.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="0fdd9-273">Aby to sprawdzić, Otwórz stronę `ObjectDataSource.aspx` w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="0fdd9-274">Podczas pierwszego odwiedzania strony zostanie wyświetlony tekst, który zostanie wywołany podczas wybierania zdarzenia (przy założeniu, że dane dodane do pamięci podręcznej przez poprzednie testy mają teraz wykluczone).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="0fdd9-275">Otwórz drugie wystąpienie przeglądarki i skopiuj i wklej adres URL z pierwszego wystąpienia przeglądarki do drugiego.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="0fdd9-276">W drugim wystąpieniu przeglądarki tekst, który został wywołany, nie jest wyświetlany, ponieważ s używa tych samych danych w pamięci podręcznej co pierwszy.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="0fdd9-277">Podczas wstawiania pobranych danych do pamięci podręcznej element ObjectDataSource używa wartości klucza pamięci podręcznej, która zawiera: wartości właściwości `CacheDuration` i `CacheExpirationPolicy`; Typ bazowego obiektu biznesowego używany przez element ObjectDataSource, który jest określany za pomocą [właściwości`TypeName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, w tym przykładzie); wartość właściwości `SelectMethod` i nazwy i wartości parametrów w kolekcji `SelectParameters`; i wartości właściwości `StartRowIndex` i `MaximumRows`, które są używane podczas implementowania [stronicowania niestandardowego.](../paging-and-sorting/paging-and-sorting-report-data-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging.](../paging-and-sorting/paging-and-sorting-report-data-cs.md)</span></span>

<span data-ttu-id="0fdd9-278">Ponosząc wartość klucza pamięci podręcznej jako kombinację tych właściwości, zapewnia unikatowy wpis pamięci podręcznej w miarę zmiany tych wartości.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="0fdd9-279">Na przykład w poprzednich samouczkach, które zostały przeszukane przy użyciu `GetProductsByCategoryID(categoryID)`klasy `ProductsBLL`, która zwraca wszystkie produkty z określonej kategorii.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="0fdd9-280">Jeden użytkownik może przechodzić do strony i wyświetlać napoje, które mają `CategoryID` 1.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="0fdd9-281">Jeśli element ObjectDataSource w pamięci podręcznej nie ma wpływu na wartości `SelectParameters`, gdy inny użytkownik przeprowadził do strony, aby wyświetlić przyprawy, podczas gdy produkty napoje znajdowały się w pamięci podręcznej, widzą produkty z pamięci podręcznej napoje zamiast przypraw.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="0fdd9-282">Przez zróżnicowanie klucza pamięci podręcznej przez te właściwości, które obejmują wartości `SelectParameters`, element ObjectDataSource utrzymuje oddzielny wpis pamięci podręcznej dla napojów i przypraw.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="0fdd9-283">Nieodświeżone zagadnienia dotyczące danych</span><span class="sxs-lookup"><span data-stu-id="0fdd9-283">Stale Data Concerns</span></span>

<span data-ttu-id="0fdd9-284">Element ObjectDataSource automatycznie wyklucza jego elementy z pamięci podręcznej w przypadku wywołania jednej z jej metod `Insert`, `Update`lub `Delete`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="0fdd9-285">Pomaga to chronić przed nieodświeżonymi danymi przez wyczyszczenie wpisów pamięci podręcznej, gdy dane są modyfikowane za pomocą strony.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="0fdd9-286">Jednak jest możliwe, że element ObjectDataSource używający buforowania, aby nadal wyświetlał nieodświeżone dane.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="0fdd9-287">W najprostszym przypadku może to być spowodowane zmianą danych bezpośrednio w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="0fdd9-288">Być może administrator bazy danych właśnie uruchomił skrypt, który modyfikuje niektóre rekordy w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="0fdd9-289">Ten scenariusz może również unfold w bardziej subtelny sposób.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="0fdd9-290">Gdy element ObjectDataSource wyklucza swoje elementy z pamięci podręcznej, gdy zostanie wywołana jedna z metod modyfikacji danych, elementy w pamięci podręcznej są usuwane dla kombinacji wartości właściwości (`CacheDuration`, `TypeName`, `SelectMethod`itd.).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="0fdd9-291">Jeśli istnieją dwa elementy ObjectDataSource, które używają różnych `SelectMethods` lub `SelectParameters`, ale nadal mogą aktualizować te same dane, jeden element ObjectDataSource może zaktualizować wiersz i unieważniać jego własne wpisy w pamięci podręcznej, ale odpowiedni wiersz dla drugiego elementu ObjectDataSource nadal będzie obsługiwany z pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="0fdd9-292">Zachęcam do tworzenia stron w celu wystawiania tej funkcji.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="0fdd9-293">Utwórz stronę wyświetlającą edytowalny widok GridView, który pobiera dane z elementu ObjectDataSource, który używa buforowania i jest skonfigurowany do pobierania danych z metody `GetProducts()` `ProductsBLL` Class.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="0fdd9-294">Dodaj kolejny edytowalny element GridView i element ObjectDataSource do tej strony (lub innego), ale dla tego drugiego elementu ObjectDataSource Użyj metody `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="0fdd9-295">Ponieważ dwa Właściwości ObjectDataSource `SelectMethod` różnią się, wszystkie one mają swoje własne wartości pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="0fdd9-296">Jeśli edytujesz produkt w jednej siatce, następnym razem, gdy powiążesz dane z powrotem z inną siatką (według stronicowania, sortowania itd.), nadal będzie on obsługiwał stare, buforowane dane i nie odzwierciedlają zmiany wprowadzonej z drugiej siatki.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="0fdd9-297">W skrócie Wykorzystaj tylko wygaśnięcia czasu, jeśli wolisz mieć potencjalną liczbę starych danych i używasz krótszych wygaśnięcia dla scenariuszy, w których aktualność danych jest ważna.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="0fdd9-298">Jeśli stare dane nie są akceptowalne, buforowanie forgo lub użycie zależności pamięci podręcznej SQL (przy założeniu, że dane są ponownie buforowane).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="0fdd9-299">Zapoznajemy zależności pamięci podręcznej SQL w przyszłym samouczku.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="0fdd9-300">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="0fdd9-300">Summary</span></span>

<span data-ttu-id="0fdd9-301">W tym samouczku zbadano wbudowane możliwości buforowania elementu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="0fdd9-302">Po prostu ustawiając kilka właściwości, możemy nakazać elementowi ObjectDataSource Buforowanie wyników zwróconych z określonego `SelectMethod` do pamięci podręcznej danych ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="0fdd9-303">Właściwości `CacheDuration` i `CacheExpirationPolicy` wskazują czas trwania przechowywania elementu w pamięci podręcznej oraz to, czy jest to bezwzględne czy ruchome.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="0fdd9-304">Właściwość `CacheKeyDependency` kojarzy wszystkie wpisy pamięci podręcznej ObjectDataSource s z istniejącą zależnością pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="0fdd9-305">Można go użyć do wykluczenia wpisów ObjectDataSource s z pamięci podręcznej przed osiągnięciem wygaśnięcia na podstawie czasu i jest zazwyczaj używany z zależnościami pamięci podręcznej SQL.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="0fdd9-306">Ponieważ element ObjectDataSource po prostu zapisuje swoje wartości w pamięci podręcznej danych, można programowo replikować wbudowane funkcje programu ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="0fdd9-307">Nie ma sensu t należy to zrobić w warstwie prezentacji, ponieważ element ObjectDataSource oferuje tę funkcję, ale można zaimplementować możliwości buforowania w oddzielnej warstwie architektury.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="0fdd9-308">Aby to zrobić, należy powtórzyć tę samą logikę używaną przez element ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="0fdd9-309">Dowiesz się, jak programowo współpracować z pamięcią podręczną danych z poziomu architektury w naszym następnym samouczku.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="0fdd9-310">Szczęśliwe programowanie!</span><span class="sxs-lookup"><span data-stu-id="0fdd9-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="0fdd9-311">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="0fdd9-311">Further Reading</span></span>

<span data-ttu-id="0fdd9-312">Aby uzyskać więcej informacji na temat tematów omówionych w tym samouczku, zapoznaj się z następującymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="0fdd9-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0fdd9-313">Buforowanie ASP.NET: techniki i najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="0fdd9-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="0fdd9-314">Przewodnik po architekturze buforowania dla aplikacji .NET Framework</span><span class="sxs-lookup"><span data-stu-id="0fdd9-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="0fdd9-315">Buforowanie danych wyjściowych w ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="0fdd9-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="0fdd9-316">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="0fdd9-316">About the Author</span></span>

<span data-ttu-id="0fdd9-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedmiu grup ASP/ASP. NET Books i założyciel of [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował z technologiami sieci Web firmy Microsoft od czasu 1998.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0fdd9-318">Scott działa jako niezależny konsultant, trainer i składnik zapisywania.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0fdd9-319">Jego Najnowsza książka to [*Sams ASP.NET 2,0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0fdd9-320">Można go osiągnąć w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0fdd9-321">lub za pośrednictwem swojego blogu, który można znaleźć w [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0fdd9-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0fdd9-322">Specjalne podziękowania</span><span class="sxs-lookup"><span data-stu-id="0fdd9-322">Special Thanks To</span></span>

<span data-ttu-id="0fdd9-323">Ta seria samouczków została sprawdzona przez wielu przydatnych recenzentów.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0fdd9-324">Recenzent potencjalnych klientów dla tego samouczka został Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="0fdd9-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="0fdd9-325">Chcesz przeglądać moje nadchodzące artykuły MSDN?</span><span class="sxs-lookup"><span data-stu-id="0fdd9-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0fdd9-326">Jeśli tak, upuść mi linię w [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0fdd9-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="0fdd9-327">Next</span><span class="sxs-lookup"><span data-stu-id="0fdd9-327">Next</span></span>](caching-data-in-the-architecture-cs.md)
