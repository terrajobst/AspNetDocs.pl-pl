---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: Formatowanie elementów DataList i Repeater na podstawie danych (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku będziemy czynności przykładów jak możemy formatowanie wyglądu kontrolki DataList i Repeater, albo za pomocą funkcji formatowania za pomocą...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 8955e37aa084f339665bbd4dc0475f7be74f3b26
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 04/09/2019
ms.locfileid: "59421605"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="12eb1-103">Formatowanie elementów DataList i Repeater na podstawie danych (VB)</span><span class="sxs-lookup"><span data-stu-id="12eb1-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>

<span data-ttu-id="12eb1-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="12eb1-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="12eb1-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) lub [Pobierz plik PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="12eb1-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="12eb1-106">W tym samouczku będziemy czynności przykładów jak możemy formatowanie wyglądu kontrolki DataList i Repeater, za pomocą funkcji formatowania w szablonach lub dzięki obsłudze zdarzeń powiązanych z danymi.</span><span class="sxs-lookup"><span data-stu-id="12eb1-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>


## <a name="introduction"></a><span data-ttu-id="12eb1-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="12eb1-107">Introduction</span></span>

<span data-ttu-id="12eb1-108">Jak widzieliśmy w poprzednim samouczku kontrolki DataList oferuje szereg właściwości stylu związane, które wpływają na jego wyglądu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="12eb1-109">W szczególności widzieliśmy jak przypisać domyślnej klasy CSS do DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, i `SelectedItemStyle` właściwości.</span><span class="sxs-lookup"><span data-stu-id="12eb1-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="12eb1-110">Oprócz tych czterech właściwości kontrolki DataList obejmuje szereg innych właściwości stylu związane, takie jak `Font`, `ForeColor`, `BackColor`, i `BorderWidth`, kilka.</span><span class="sxs-lookup"><span data-stu-id="12eb1-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="12eb1-111">W kontrolce elementu powtarzanego nie zawiera żadnych właściwości stylu związane.</span><span class="sxs-lookup"><span data-stu-id="12eb1-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="12eb1-112">Takie ustawienia stylu muszą być wykonane bezpośrednio z poziomu kodu znaczników w szablonach s elementu powtarzanego.</span><span class="sxs-lookup"><span data-stu-id="12eb1-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="12eb1-113">Często jednak sposób formatowania danych zależy od samych danych.</span><span class="sxs-lookup"><span data-stu-id="12eb1-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="12eb1-114">Na przykład podczas wyświetlania listy produktów firma Microsoft może mają być wyświetlane informacje o produkcie koloru światła szara czcionka jest ona obsługiwana, czy może chcesz wyróżnić `UnitsInStock` wartość, gdy jest równa 0.</span><span class="sxs-lookup"><span data-stu-id="12eb1-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="12eb1-115">Jak widzieliśmy w poprzednich samouczkach GridView DetailsView i FormView oferuje dwa odrębne sposoby formatowania ich występowania na podstawie swoich danych:</span><span class="sxs-lookup"><span data-stu-id="12eb1-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="12eb1-116">**`DataBound` Zdarzeń** utworzyć program obsługi zdarzeń dla odpowiedniego `DataBound` zdarzenie, które są generowane po danych została powiązana z każdego elementu (dla widoku GridView był `RowDataBound` zdarzenia; DataList i Repeater jest `ItemDataBound`zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="12eb1-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="12eb1-117">W takim przypadku program obsługi, po prostu dane powiązane można zbadać i formatowanie decyzje wprowadzone.</span><span class="sxs-lookup"><span data-stu-id="12eb1-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="12eb1-118">Zbadaliśmy tej techniki w [niestandardowe formatowanie oparte na danych](../custom-formatting/custom-formatting-based-upon-data-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="12eb1-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="12eb1-119">**Formatowanie funkcji w szablonach** po używanie kontrolek TemplateField w DetailsView lub GridView formantów lub szablonu w kontrolce FormView, możemy dodać funkcję formatowania do klasy związane z kodem strony ASP.NET, warstwy logiki biznesowej lub dowolny inne biblioteki klas, który jest dostępny z poziomu aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="12eb1-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="12eb1-120">Ta funkcja formatowania może akceptować dowolnej liczby parametrów wejściowych, ale musi zwracać HTML do renderowania w szablonie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="12eb1-121">Najpierw zostały poddane funkcji formatowania [za pomocą kontrolek TemplateField w kontrolce GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) samouczka.</span><span class="sxs-lookup"><span data-stu-id="12eb1-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="12eb1-122">Obie te metody formatowania są dostępne za pomocą kontrolek DataList i Repeater.</span><span class="sxs-lookup"><span data-stu-id="12eb1-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="12eb1-123">W tym samouczku będziemy czynności przykłady użycia obu tych technik dla obu kontrolek.</span><span class="sxs-lookup"><span data-stu-id="12eb1-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="12eb1-124">Za pomocą`ItemDataBound`program obsługi zdarzeń</span><span class="sxs-lookup"><span data-stu-id="12eb1-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="12eb1-125">Gdy powiązania danych z kontrolką DataList z kontroli źródła danych lub za pośrednictwem programowo przypisywania danych do kontrolki s `DataSource` właściwości i wywoływania jego `DataBind()` metody DataList s `DataBinding` wyzwala zdarzenia, źródło danych, wyliczenia, a każdy rekord danych jest powiązany z kontrolki DataList.</span><span class="sxs-lookup"><span data-stu-id="12eb1-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="12eb1-126">Dla każdego rekordu w źródle danych tworzy kontrolki DataList [ `DataListItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) obiekt, a następnie powiązane z bieżącym rekordem.</span><span class="sxs-lookup"><span data-stu-id="12eb1-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="12eb1-127">W trakcie tego procesu w elemencie DataList zgłasza dwa zdarzenia:</span><span class="sxs-lookup"><span data-stu-id="12eb1-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="12eb1-128">**`ItemCreated`** generowane po `DataListItem` została utworzona</span><span class="sxs-lookup"><span data-stu-id="12eb1-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="12eb1-129">**`ItemDataBound`** generowane po bieżącego rekordu została powiązana z</span><span class="sxs-lookup"><span data-stu-id="12eb1-129">**`ItemDataBound`** fires after the current record has been bound to the</span></span> `DataListItem`

<span data-ttu-id="12eb1-130">Poniższe kroki wchodzą w skład procesu powiązanie danych kontrolki DataList.</span><span class="sxs-lookup"><span data-stu-id="12eb1-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="12eb1-131">DataList s [ `DataBinding` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) generowane</span><span class="sxs-lookup"><span data-stu-id="12eb1-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="12eb1-132">Powiązania danych do kontrolki DataList</span><span class="sxs-lookup"><span data-stu-id="12eb1-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="12eb1-133">Dla każdego rekordu w źródle danych</span><span class="sxs-lookup"><span data-stu-id="12eb1-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="12eb1-134">Utwórz `DataListItem` obiektu</span><span class="sxs-lookup"><span data-stu-id="12eb1-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="12eb1-135">Ogień [ `ItemCreated` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="12eb1-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="12eb1-136">Rekord do powiązania</span><span class="sxs-lookup"><span data-stu-id="12eb1-136">Bind the record to the</span></span> `DataListItem`
    4. <span data-ttu-id="12eb1-137">Ogień [ `ItemDataBound` zdarzeń](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="12eb1-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="12eb1-138">Dodaj `DataListItem` do `Items` kolekcji</span><span class="sxs-lookup"><span data-stu-id="12eb1-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="12eb1-139">Powiązanie danych z kontrolką elementu powtarzanego, jej postępu przy użyciu dokładnie tych samych sekwencji kroków.</span><span class="sxs-lookup"><span data-stu-id="12eb1-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="12eb1-140">Jedyną różnicą jest to, że zamiast `DataListItem` używa powtarzanego wystąpień tworzonych [ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span><span class="sxs-lookup"><span data-stu-id="12eb1-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="12eb1-141">Uważni czytnika, być może zauważono nieznaczne anomalii między sekwencję czynności, które orzeczona podczas DataList i Repeater są powiązane z danymi, a gdy widoku GridView jest powiązana z danymi.</span><span class="sxs-lookup"><span data-stu-id="12eb1-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="12eb1-142">Na końcu tail proces wiązania danych, zgłasza widoku GridView `DataBound` zdarzenia; jednak kontrolki DataList ani elementu powtarzanego mają takie zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="12eb1-143">Jest to spowodowane kontrolek DataList i Repeater zostały utworzone w przedziale czasu 1.x ASP.NET, zanim wzorzec procedury obsługi zdarzeń przed i po poziomu stało się typowe.</span><span class="sxs-lookup"><span data-stu-id="12eb1-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>


<span data-ttu-id="12eb1-144">Tak, jak przy użyciu GridView, jedną z opcji formatowania, na podstawie danych jest utworzenie zdarzenia obsługi dla `ItemDataBound` zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="12eb1-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="12eb1-145">Ta procedura obsługi zdarzeń może sprawdzić dane, które było po prostu została powiązana z `DataListItem` lub `RepeaterItem` i wpływają na formatowanie kontrolki, zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="12eb1-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="12eb1-146">Kontrolki DataList zmiany formatowania dla całego elementu można zaimplementować przy użyciu `DataListItem` s stylu związane właściwości, które zawierają standardowe `Font`, `ForeColor`, `BackColor`, `CssClass`i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="12eb1-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="12eb1-147">Wpływ na formatowanie określonej kontrolki sieci Web w szablonie s DataList, musimy programowo uzyskać dostęp i zmodyfikować styl te kontrolki sieci Web.</span><span class="sxs-lookup"><span data-stu-id="12eb1-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="12eb1-148">Widzieliśmy sposób wykonania tego ponownie w *niestandardowe formatowanie oparte na danych* samouczka.</span><span class="sxs-lookup"><span data-stu-id="12eb1-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="12eb1-149">Kontrolce elementu powtarzanego, takich jak `RepeaterItem` klasa nie ma stylu związane właściwości; w związku z tym, wszystkie zmiany dotyczące stylu wprowadzone `RepeaterItem` w `ItemDataBound` programu obsługi zdarzeń musi odbywać się przez programowo dostęp i aktualizowanie formantów sieci Web w ciągu szablon.</span><span class="sxs-lookup"><span data-stu-id="12eb1-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="12eb1-150">Ponieważ `ItemDataBound` formatowanie elementów DataList i Repeater są niemal identyczne, nasz przykład koncentruje się na za pomocą kontrolki DataList techniki.</span><span class="sxs-lookup"><span data-stu-id="12eb1-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="12eb1-151">Krok 1. Wyświetlanie informacji o produkcie w elemencie DataList</span><span class="sxs-lookup"><span data-stu-id="12eb1-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="12eb1-152">Zanim będziemy zajmować formatowania, umożliwiają s najpierw utworzyć stronę, która korzysta z kontrolką DataList do wyświetlania informacji o produkcie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="12eb1-153">W [poprzedniego samouczka](displaying-data-with-the-datalist-and-repeater-controls-vb.md) utworzyliśmy kontrolką DataList którego `ItemTemplate` wyświetlana każda nazwa produktu s, kategorii, dostawcy, ilość na jednostkę, a cena.</span><span class="sxs-lookup"><span data-stu-id="12eb1-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="12eb1-154">Pozwól, s, powtórz tę funkcję, w tym miejscu, w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="12eb1-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="12eb1-155">Aby to osiągnąć, albo można odtworzyć kontrolki DataList i jego ObjectDataSource od podstaw, możesz także skopiować za pośrednictwem tych kontrolek ze strony utworzony w poprzednim samouczku (`Basics.aspx`) i wklej je do strony, w tym samouczku (`Formatting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="12eb1-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="12eb1-156">Gdy zostały zreplikowane funkcji kontrolek DataList i kontrolki ObjectDataSource `Basics.aspx` do `Formatting.aspx`, Poświęć chwilę, aby zmienić DataList s `ID` właściwość `DataList1` na bardziej opisową `ItemDataBoundFormattingExample`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="12eb1-157">Następnie Wyświetl kontrolki DataList w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="12eb1-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="12eb1-158">Jak pokazano na rysunku 1, formatowania jedyną różnicą między każdego produktu jest, że kolor tła alternatywne.</span><span class="sxs-lookup"><span data-stu-id="12eb1-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>


[![T<span data-ttu-id="12eb1-159">używane produkty są wymienione w kontrolce DataList]</span><span class="sxs-lookup"><span data-stu-id="12eb1-159">he Products are Listed in the DataList Control]</span></span>(formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)

<span data-ttu-id="12eb1-160">**Rysunek 1**: Produkty są wymienione w kontrolce DataList ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="12eb1-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>


<span data-ttu-id="12eb1-161">W tym samouczku umożliwiają s formatowanie kontrolki DataList w taki sposób, że wszystkie produkty z ceną mniejszą niż 20,00 USD za będą mieć zarówno jego nazwy i Jednostka ceny wyróżniony żółtym.</span><span class="sxs-lookup"><span data-stu-id="12eb1-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="12eb1-162">Krok 2. Programowe określanie wartości danych w obsłudze zdarzeń ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="12eb1-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="12eb1-163">Ponieważ tylko te produkty z ceną w obszarze 20,00 USD za będą mieć niestandardowe formatowanie zastosowane, firma Microsoft musi być możliwe ustalenie, w każdej cenie s produktu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="12eb1-164">Podczas wiązania danych z kontrolką DataList, kontrolki DataList wylicza rekordy źródła danych i dla każdego rekordu tworzy `DataListItem` wystąpienia rekordu źródła danych do powiązania `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="12eb1-165">Po określonemu rekordowi s danych została powiązana z bieżącego `DataListItem` obiektu DataList s `ItemDataBound` jest wyzwalane zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="12eb1-166">Można utworzyć program obsługi zdarzeń dla tego zdarzenia sprawdzić wartości danych dla bieżącego `DataListItem` i na podstawie tych wartości, wprowadź niezbędne zmiany formatowania.</span><span class="sxs-lookup"><span data-stu-id="12eb1-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="12eb1-167">Utwórz `ItemDataBound` zdarzenia dla kontrolki DataList i Dodaj następujący kod:</span><span class="sxs-lookup"><span data-stu-id="12eb1-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="12eb1-168">While koncepcji i semantyka za DataList s `ItemDataBound` programu obsługi zdarzeń są takie same jak dla GridView s `RowDataBound` programu obsługi zdarzeń w *niestandardowe formatowanie oparte na danych* różni się składni w samouczku nieco.</span><span class="sxs-lookup"><span data-stu-id="12eb1-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="12eb1-169">Gdy `ItemDataBound` generowane zdarzenie `DataListItem` tylko powiązane z danymi jest przekazywana do odpowiedniego programu obsługi zdarzeń za pośrednictwem `e.Item` (zamiast `e.Row`, podobnie jak w przypadku GridView s `RowDataBound` program obsługi zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="12eb1-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="12eb1-170">DataList s `ItemDataBound` obsługi zdarzenia generowane dla *każdego* wiersz dodany do DataList, w tym wiersze nagłówka, stopki i separatora wierszy.</span><span class="sxs-lookup"><span data-stu-id="12eb1-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="12eb1-171">Jednak informacje o produkcie jest tylko powiązane wiersze danych.</span><span class="sxs-lookup"><span data-stu-id="12eb1-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="12eb1-172">W związku z tym korzystając z `ItemDataBound` zdarzenie, aby sprawdzić dane powiązane z kontrolki DataList, musimy najpierw upewnij się, że firma Microsoft odnośnie do pracy z elementu danych.</span><span class="sxs-lookup"><span data-stu-id="12eb1-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="12eb1-173">Można to osiągnąć, sprawdzając `DataListItem` s [ `ItemType` właściwość](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), która może mieć jedną z [następujące wartości osiem](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="12eb1-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="12eb1-174">Zarówno `Item` i `AlternatingItem``DataListItem` elementy danych korzeń DataList s s.</span><span class="sxs-lookup"><span data-stu-id="12eb1-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="12eb1-175">Zakładając, że firma Microsoft odnośnie do pracy z `Item` lub `AlternatingItem`, dostępu do rzeczywistego `ProductsRow` wystąpienia, która została powiązana z bieżącego `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="12eb1-176">`DataListItem` s [ `DataItem` właściwość](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) zawiera odwołanie do `DataRowView` obiektu, którego `Row` właściwość zawiera odwołanie do rzeczywistego `ProductsRow` obiektu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="12eb1-177">Następnie możemy sprawdzić `ProductsRow` wystąpienia s `UnitPrice` właściwości.</span><span class="sxs-lookup"><span data-stu-id="12eb1-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="12eb1-178">Od tabeli Produkty s `UnitPrice` pole umożliwia `NULL` wartości przed podjęciem próby uzyskania dostępu `UnitPrice` właściwość możemy powinny najpierw sprawdzić, czy ma `NULL` wartości przy użyciu `IsUnitPriceNull()` metody.</span><span class="sxs-lookup"><span data-stu-id="12eb1-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="12eb1-179">Jeśli `UnitPrice` wartość nie jest `NULL`, możemy następnie sprawdź, czy jego s mniejszą niż 20,00 USD za.</span><span class="sxs-lookup"><span data-stu-id="12eb1-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="12eb1-180">Jeśli tak jest rzeczywiście w obszarze 20,00 USD za, następnie należy zastosować niestandardowe formatowanie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="12eb1-181">Krok 3. Wyróżnianie Nazwa s produktu i cenę</span><span class="sxs-lookup"><span data-stu-id="12eb1-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="12eb1-182">Gdy wiemy, że cena produktu s jest mniejsza niż 20,00 USD za pozostaje aby wyróżnić jego nazwa i cena.</span><span class="sxs-lookup"><span data-stu-id="12eb1-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="12eb1-183">Aby to osiągnąć, należy najpierw programowo odwołujemy się formantów etykiet w `ItemTemplate` , wyświetlanie, nazwa produktu s i ceny.</span><span class="sxs-lookup"><span data-stu-id="12eb1-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="12eb1-184">Następnie należy je wyświetlić żółte tło.</span><span class="sxs-lookup"><span data-stu-id="12eb1-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="12eb1-185">Informacje o formatowaniu tego mogą być stosowane przez bezpośrednie zmodyfikowanie etykiet `BackColor` właściwości (`LabelID.BackColor = Color.Yellow`); najlepiej, jeśli jednak wszystkich kwestii związanych z ekranu powinny być wyrażone za pomocą kaskadowych arkuszy stylów.</span><span class="sxs-lookup"><span data-stu-id="12eb1-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="12eb1-186">W rzeczywistości mamy już arkusza stylów, zapewniająca żądanego formatowania zdefiniowane w `Styles.css`  -  `AffordablePriceEmphasis`, która została utworzona i omówione w *niestandardowe formatowanie oparte na danych* samouczek.</span><span class="sxs-lookup"><span data-stu-id="12eb1-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="12eb1-187">Aby zastosować formatowanie, wystarczy ustawić dwóch formantów Web etykiety `CssClass` właściwości `AffordablePriceEmphasis`, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="12eb1-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="12eb1-188">Za pomocą `ItemDataBound` zakończona programu obsługi zdarzeń, ponownie `Formatting.aspx` strony w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="12eb1-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="12eb1-189">Tak jak pokazano na rysunku 2, tych produktów z ceną w obszarze 20,00 USD za ma ich nazwy i ceny wyróżnione.</span><span class="sxs-lookup"><span data-stu-id="12eb1-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>


[![T<span data-ttu-id="12eb1-190">gumowy przewód produktów w mniej niż wyróżniono 20,00 USD za]</span><span class="sxs-lookup"><span data-stu-id="12eb1-190">hose Products Less than $20.00 are Highlighted]</span></span>(formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)

<span data-ttu-id="12eb1-191">**Rysunek 2**: Te produkty mniej niż 20,00 USD za wyróżniono ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="12eb1-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="12eb1-192">Ponieważ kontrolki DataList jest renderowany jako kod HTML `<table>`, jego `DataListItem` wystąpienia mają właściwości stylu związane, które można ustawić dotyczą konkretnego stylu cały element.</span><span class="sxs-lookup"><span data-stu-id="12eb1-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="12eb1-193">Załóżmy, że Chcieliśmy, aby wyróżnić *całego* elementu żółty, gdy jej miesięczna cena był mniejszy niż 20,00 USD za, firma Microsoft może zastąpiono kod, do której odwołanie etykiety i ustaw ich `CssClass` właściwości za pomocą następującego kodu: `e.Item.CssClass = "AffordablePriceEmphasis"` (patrz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="12eb1-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>


<span data-ttu-id="12eb1-194">`RepeaterItem` S, wchodzące w skład kontrolce elementu powtarzanego jednak don t oferują takie właściwości stylu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="12eb1-195">W związku z tym stosując formatowanie niestandardowe do powtarzanego wymaga od aplikacji ponownego obliczenia właściwości stylu kontrolki sieci Web w szablonach Repeater s, tak samo, jak zrobiliśmy na rysunku 2.</span><span class="sxs-lookup"><span data-stu-id="12eb1-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>


[![T<span data-ttu-id="12eb1-196">jest on cały element produktu wyróżniony dla produktów w obszarze 20,00 USD za]</span><span class="sxs-lookup"><span data-stu-id="12eb1-196">he Entire Product Item is Highlighted for Products Under $20.00]</span></span>(formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)

<span data-ttu-id="12eb1-197">**Rysunek 3**: Cały element produktu jest wyróżniona na produkty w ramach 20,00 USD za ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="12eb1-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>


## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="12eb1-198">Za pomocą funkcji formatowania w szablonie</span><span class="sxs-lookup"><span data-stu-id="12eb1-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="12eb1-199">W *za pomocą kontrolek TemplateField w kontrolce GridView* samouczek widzieliśmy jak zastosować niestandardowe formatowanie na podstawie danych za pomocą funkcji formatowania w kontrolce GridView TemplateField powiązanych z wierszami s GridView.</span><span class="sxs-lookup"><span data-stu-id="12eb1-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="12eb1-200">Funkcja formatowania jest metodą, która może być wywołana z szablonu i zwraca kod HTML, który był emitowany w jego miejscu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="12eb1-201">Funkcji formatowania może znajdować się w klasie CodeBehind strony s ASP.NET lub być scentralizowane w plikach klas w `App_Code` folderze lub w osobnym projekcie biblioteki klas.</span><span class="sxs-lookup"><span data-stu-id="12eb1-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="12eb1-202">Przenoszenie funkcji formatowania poza klasy CodeBehind s strony ASP.NET jest idealnym rozwiązaniem, jeśli zamierzasz korzystać z tej samej funkcji formatowania na wielu stronach ASP.NET lub w innych aplikacjach sieci web platformy ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12eb1-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="12eb1-203">Aby zademonstrować funkcje formatowania, umożliwiają s ma informacje o produkcie, które zawierają tekst [WYCOFANY] obok nazwy produktu s, jeśli jego s wycofane.</span><span class="sxs-lookup"><span data-stu-id="12eb1-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="12eb1-204">Umożliwiają s są także jeśli żółty wyróżnione cena go s mniejszą niż 20,00 USD za (jak robiliśmy `ItemDataBound` przykład program obsługi zdarzeń); Jeśli cena jest 20,00 USD za lub nowszej, który pozwala s nie wyświetlają rzeczywista cena, ale zamiast tego tekstu, należy wywołać dla oferty ceny.</span><span class="sxs-lookup"><span data-stu-id="12eb1-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="12eb1-205">Rysunek 4 przedstawiono zrzut ekranu produktów, wyświetlanie za te reguły formatowania, które zostały zastosowane.</span><span class="sxs-lookup"><span data-stu-id="12eb1-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>


[![F<span data-ttu-id="12eb1-206">lub kosztowne produktów, cena zostanie zastąpiony tekst, wywołaj oferty cen]</span><span class="sxs-lookup"><span data-stu-id="12eb1-206">or Expensive Products, the Price is Replaced with the Text, Please call for a price quote]</span></span>(formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)

<span data-ttu-id="12eb1-207">**Rysunek 4**: Kosztowne produktów, cena zostanie zastąpiony tekst, wywołaj oferty cen ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="12eb1-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>


## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="12eb1-208">Krok 1. Tworzenie funkcji formatowania</span><span class="sxs-lookup"><span data-stu-id="12eb1-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="12eb1-209">W tym przykładzie potrzebujemy dwóch funkcji formatowania, taki, który wyświetla nazwę produktu, wraz z tekstu [WYCOFANY], jeśli to konieczne i innym wyświetlającą wyróżnione ceny, jeśli jego s mniejszej niż 20,00 USD za lub tekstu, wywołaj oferty cen, w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="12eb1-210">Pozwól s tworzenia tych funkcji w klasie CodeBehind strony s ASP.NET i nazwij je `DisplayProductNameAndDiscontinuedStatus` i `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="12eb1-211">Obie metody musi zwracać HTML do renderowania jako ciąg i oba muszą być oznaczone `Protected` (lub `Public`) w celu można wywołać z część składni deklaratywnej strony ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12eb1-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="12eb1-212">Następujący kod dla tych dwóch metod:</span><span class="sxs-lookup"><span data-stu-id="12eb1-212">The code for these two methods follows:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="12eb1-213">Należy pamiętać, że `DisplayProductNameAndDiscontinuedStatus` metoda akceptuje wartości `productName` i `discontinued` danych pól jako wartości skalarnych, natomiast `DisplayPrice` metoda przyjmuje `ProductsRow` wystąpienia (zamiast `unitPrice` wartość skalarna).</span><span class="sxs-lookup"><span data-stu-id="12eb1-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="12eb1-214">Każda z tych metod będzie działać; Jednak jeśli przy użyciu wartości skalarnych, które mogą zawierać bazy danych działa funkcja formatowania `NULL` wartości (takie jak `UnitPrice`; ani `ProductName` ani `Discontinued` Zezwalaj na `NULL` wartości), specjalne należy zachować ostrożność podczas obsługi tych dane wejściowe skalarne.</span><span class="sxs-lookup"><span data-stu-id="12eb1-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="12eb1-215">W szczególności, parametr wejściowy musi być typu `Object` ponieważ przychodzące wartość może być `DBNull` wystąpieniem, a nie oczekiwany typ danych.</span><span class="sxs-lookup"><span data-stu-id="12eb1-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="12eb1-216">Ponadto należy sprawdzić, aby ustalić, czy wartość przychodzącego jest bazą danych `NULL` wartość.</span><span class="sxs-lookup"><span data-stu-id="12eb1-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="12eb1-217">Oznacza to jeśli Chcieliśmy `DisplayPrice` metodę, aby akceptować cena jako wartość skalarną, możemy d trzeba użyć następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="12eb1-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="12eb1-218">Należy pamiętać, że `unitPrice` parametr wejściowy jest typu `Object` oraz że instrukcji warunkowej została zmodyfikowana, aby upewnić się, jeśli `unitPrice` jest `DBNull` czy nie.</span><span class="sxs-lookup"><span data-stu-id="12eb1-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="12eb1-219">Ponadto, ponieważ `unitPrice` parametr wejściowy jest przekazywany jako `Object`, należy zrzutować na wartość dziesiętną.</span><span class="sxs-lookup"><span data-stu-id="12eb1-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="12eb1-220">Krok 2. Wywoływanie funkcji formatowania z właściwości ItemTemplate DataList s</span><span class="sxs-lookup"><span data-stu-id="12eb1-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="12eb1-221">Za pomocą funkcji formatowania, dodany do naszych ASP.NET strony s osobna klasa kodu pozostaje tylko do wywołania funkcji z DataList s formatowania `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="12eb1-222">Aby wywołać funkcję formatowania z szablonu, Umieść wywołanie funkcji w ramach składnia wiązania z danymi:</span><span class="sxs-lookup"><span data-stu-id="12eb1-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="12eb1-223">W elemencie DataList s `ItemTemplate` `ProductNameLabel` formant etykiety w sieci Web obecnie Wyświetla nazwę produktu s, przypisując jej `Text` właściwości wyniku z `<%# Eval("ProductName") %>`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="12eb1-224">W celu jej służy do wyświetlania nazwy oraz tekst [WYCOFANY], jeśli to konieczne, zaktualizuj składni deklaratywnej tak, aby zamiast tego przypisuje `Text` wartości właściwości z `DisplayProductNameAndDiscontinuedStatus` metody.</span><span class="sxs-lookup"><span data-stu-id="12eb1-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="12eb1-225">Po wykonaniu tej czynności firma Microsoft musi przekazać nazwę produktu s i nieobsługiwane wartości za pomocą `Eval("columnName")` składni.</span><span class="sxs-lookup"><span data-stu-id="12eb1-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> `Eval` <span data-ttu-id="12eb1-226">Zwraca wartość typu `Object`, ale `DisplayProductNameAndDiscontinuedStatus` metoda oczekuje parametrów wejściowych typu `String` i `Boolean`; w związku z tym, firma Microsoft rzutować wartości zwracanych przez `Eval` metodę, aby typy oczekiwanym parametrem wejściowym, w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="12eb1-226">returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="12eb1-227">Aby wyświetlić ceny, możemy po prostu ustaw `UnitPriceLabel` etykiety s `Text` właściwości do wartości zwracanej przez `DisplayPrice` metodę, tak samo, jak firma Microsoft została do wyświetlania nazwy produktu s i [WYCOFANE] tekstu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="12eb1-228">Jednak zamiast w `UnitPrice` jako skalarna parametr wejściowy, zamiast tego przekazanie całego `ProductsRow` wystąpienie:</span><span class="sxs-lookup"><span data-stu-id="12eb1-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="12eb1-229">Przy użyciu wywołania do funkcji formatowania w miejscu Poświęć chwilę, aby wyświetlić postępach w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="12eb1-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="12eb1-230">Ekran powinien wyglądać podobnie jak rysunek 5 za pomocą uwzględniałyby produkty, łącznie z tekstem [WYCOFANY] i tych produktów wyceny ponad 20,00 USD za posiadające ich ceny zastąpione tekstem, wywołanie oferty ceny.</span><span class="sxs-lookup"><span data-stu-id="12eb1-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>


[![F<span data-ttu-id="12eb1-231">lub kosztowne produktów, cena zostanie zastąpiony tekst, wywołaj oferty cen]</span><span class="sxs-lookup"><span data-stu-id="12eb1-231">or Expensive Products, the Price is Replaced with the Text, Please call for a price quote]</span></span>(formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)

<span data-ttu-id="12eb1-232">**Rysunek 5**: Kosztowne produktów, cena zostanie zastąpiony tekst, wywołaj oferty cen ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="12eb1-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>


## <a name="summary"></a><span data-ttu-id="12eb1-233">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="12eb1-233">Summary</span></span>

<span data-ttu-id="12eb1-234">Formatowanie zawartości w kontrolce DataList lub Repeater na podstawie danych można wykonywać przy użyciu dwóch technik.</span><span class="sxs-lookup"><span data-stu-id="12eb1-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="12eb1-235">Pierwszą techniką jest utworzenie zdarzenia obsługi dla `ItemDataBound` zdarzenie, które uruchamia się, ponieważ każdy rekord w źródle danych jest powiązany z nową `DataListItem` lub `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="12eb1-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="12eb1-236">W `ItemDataBound` procedura obsługi zdarzeń, można sprawdzić bieżące dane element s i formatowanie, mogą być stosowane do zawartości, szablonu lub, w przypadku `DataListItem` s danego całego elementu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="12eb1-237">Alternatywnie niestandardowe formatowanie można realizować za pomocą funkcji formatowania.</span><span class="sxs-lookup"><span data-stu-id="12eb1-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="12eb1-238">Funkcja formatowania jest metodą, która może być wywoływany w kontrolce DataList lub Repeater s szablonów, które zwraca kod HTML do emitowania w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="12eb1-239">Często zwrócona przez funkcję formatowania kodu HTML jest ustalany wartości związania z bieżącego elementu.</span><span class="sxs-lookup"><span data-stu-id="12eb1-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="12eb1-240">Te wartości mogą być przekazywane do funkcji formatowania, jako wartości skalarne lub przez przekazanie całego obiektu, który jest powiązany z elementem (takie jak `ProductsRow` wystąpienie).</span><span class="sxs-lookup"><span data-stu-id="12eb1-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="12eb1-241">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="12eb1-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="12eb1-242">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="12eb1-242">About the Author</span></span>

<span data-ttu-id="12eb1-243">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="12eb1-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="12eb1-244">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="12eb1-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="12eb1-245">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="12eb1-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="12eb1-246">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="12eb1-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="12eb1-247">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="12eb1-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="12eb1-248">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="12eb1-248">Special Thanks To</span></span>

<span data-ttu-id="12eb1-249">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="12eb1-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="12eb1-250">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Yaakov Ellis Randy Schmidt i Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="12eb1-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="12eb1-251">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="12eb1-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="12eb1-252">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="12eb1-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="12eb1-253">[Poprzednie](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [dalej](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="12eb1-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
