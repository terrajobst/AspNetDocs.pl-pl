---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-cs
title: Obsługa wyjątków LOGIKI i poziom warstwy DAL (C#) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku opisano jak przeczucie obsługiwać wyjątki zgłoszone podczas aktualizowania przepływu pracy można edytować DataList.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: f8fd58e2-f932-4f08-ab3d-fbf8ff3295d2
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-cs
msc.type: authoredcontent
ms.openlocfilehash: ebaca5ea34fabe3fcd4979eab2e3f684e8e221be
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57070151"
---
<a name="handling-bll--and-dal-level-exceptions-c"></a><span data-ttu-id="d4f84-103">Obsługa wyjątków na poziomie warstwy logiki biznesowej i warstwy dostępu do danych (C#)</span><span class="sxs-lookup"><span data-stu-id="d4f84-103">Handling BLL- and DAL-Level Exceptions (C#)</span></span>
====================
<span data-ttu-id="d4f84-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d4f84-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d4f84-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_CS.exe) lub [Pobierz plik PDF](handling-bll-and-dal-level-exceptions-cs/_static/datatutorial38cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d4f84-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_CS.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-cs/_static/datatutorial38cs1.pdf)</span></span>

> <span data-ttu-id="d4f84-106">W tym samouczku opisano jak przeczucie obsługiwać wyjątki zgłoszone podczas aktualizowania przepływu pracy można edytować DataList.</span><span class="sxs-lookup"><span data-stu-id="d4f84-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="d4f84-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="d4f84-107">Introduction</span></span>

<span data-ttu-id="d4f84-108">W [omówienie edytowania i usuwania danych w kontrolce DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) samouczku utworzyliśmy DataList, oferowane proste edytowanie i usuwanie możliwości.</span><span class="sxs-lookup"><span data-stu-id="d4f84-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="d4f84-109">Podczas, gdy jest to w pełni funkcjonalny, było bardzo trudno czytelne jak jakikolwiek błąd, który wystąpił podczas edycji lub usuwania procesu spowodowała nieobsługiwany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d4f84-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="d4f84-110">Na przykład, pomijając nazwę produktu s lub edytując produktu, wprowadzenie wartości cen bardzo przystępne cenowo!, zgłasza wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d4f84-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="d4f84-111">Ponieważ ten wyjątek nie zostanie przechwycony w kodzie, rozpropagowany środowiska uruchomieniowego programu ASP.NET, który następnie wyświetla szczegóły wyjątku s na stronie sieci web.</span><span class="sxs-lookup"><span data-stu-id="d4f84-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="d4f84-112">Jak widzieliśmy w [obsługi LOGIKI i wyjątki DAL na poziomie strony ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) samouczek, jeśli wyjątek jest zgłaszany z głębokości logiki biznesowej i warstwy dostępu do danych, szczegóły wyjątku są zwracane do kontrolki ObjectDataSource i następnie do widoku GridView.</span><span class="sxs-lookup"><span data-stu-id="d4f84-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="d4f84-113">Firma Microsoft pokazaliśmy, jak bezpiecznie obsługiwać te wyjątki, tworząc `Updated` lub `RowUpdated` programy obsługi zdarzeń dla elementu ObjectDataSource lub GridView, sprawdzanie, dla wyjątku i wskazującą, czy wyjątek został obsłużony.</span><span class="sxs-lookup"><span data-stu-id="d4f84-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="d4f84-114">DataList samouczków, jednak t konto za pomocą kontrolki ObjectDataSource, aktualizowania i usuwania danych.</span><span class="sxs-lookup"><span data-stu-id="d4f84-114">Our DataList tutorials, however, aren t using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="d4f84-115">Zamiast tego pracujemy bezpośrednio w odniesieniu do LOGIKI.</span><span class="sxs-lookup"><span data-stu-id="d4f84-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="d4f84-116">W celu wykrycia wyjątki pochodzące z LOGIKI lub warstwy DAL, musimy zaimplementować obsługę kodu w ramach kodem naszą stronę ASP.NET wyjątków.</span><span class="sxs-lookup"><span data-stu-id="d4f84-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="d4f84-117">W tym samouczku opisano jak bardziej przeczucie obsługiwać wyjątki zgłoszone podczas edycji s DataList aktualizowanie przepływu pracy.</span><span class="sxs-lookup"><span data-stu-id="d4f84-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="d4f84-118">W *omówienie edytowania i usuwania danych w kontrolce DataList* samouczku Omówiliśmy różne techniki edytowania i usuwania danych w kontrolce DataList kilka technik bierze udziału za pomocą kontrolki ObjectDataSource aktualizacji i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="d4f84-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="d4f84-119">Jeśli te techniki zostanie zastosowana, może obsługiwać wyjątki od LOGIKI lub warstwy DAL za pośrednictwem ObjectDataSource s `Updated` lub `Deleted` procedury obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d4f84-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="d4f84-120">Krok 1. Tworzenie można edytować DataList</span><span class="sxs-lookup"><span data-stu-id="d4f84-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="d4f84-121">Zanim będziemy zajmować obsługi wyjątków, które występują podczas aktualizowania przepływu pracy, chętnie s, należy najpierw utworzyć DataList można edytować.</span><span class="sxs-lookup"><span data-stu-id="d4f84-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="d4f84-122">Otwórz `ErrorHandling.aspx` strony w `EditDeleteDataList` folderu, Dodaj kontrolką DataList do projektanta, ustaw jego `ID` właściwości `Products`, i dodać nowe kontrolki ObjectDataSource, o nazwie `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d4f84-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="d4f84-123">Konfigurowanie kontrolki ObjectDataSource używać `ProductsBLL` klasy s `GetProducts()` Metoda służąca do wybierania rekordów; Ustawianie list rozwijanych w INSERT, UPDATE i usuwanie kart (Brak).</span><span class="sxs-lookup"><span data-stu-id="d4f84-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="d4f84-124">[![Zwraca informacje o produkcie przy użyciu metody GetProducts()](handling-bll-and-dal-level-exceptions-cs/_static/image2.png)](handling-bll-and-dal-level-exceptions-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d4f84-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-cs/_static/image2.png)](handling-bll-and-dal-level-exceptions-cs/_static/image1.png)</span></span>

<span data-ttu-id="d4f84-125">**Rysunek 1**: Zwraca informacje o produkt za pomocą `GetProducts()` — metoda ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](handling-bll-and-dal-level-exceptions-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d4f84-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image3.png))</span></span>


<span data-ttu-id="d4f84-126">Po zakończeniu pracy Kreatora ObjectDataSource programu Visual Studio będzie automatycznie tworzył `ItemTemplate` dla kontrolki DataList.</span><span class="sxs-lookup"><span data-stu-id="d4f84-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="d4f84-127">Zastąp tę wartość ciągiem `ItemTemplate` , wyświetla każdy produkt s nazwy i ceny i zawiera przycisk Edytuj.</span><span class="sxs-lookup"><span data-stu-id="d4f84-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="d4f84-128">Następnie należy utworzyć `EditItemTemplate` za pomocą kontrolki TextBox w sieci Web dla nazwy i ceny i przyciski aktualizacji i Anuluj.</span><span class="sxs-lookup"><span data-stu-id="d4f84-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="d4f84-129">Wreszcie, ustaw DataList s `RepeatColumns` właściwość 2.</span><span class="sxs-lookup"><span data-stu-id="d4f84-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="d4f84-130">Po wprowadzeniu tych zmian znaczniki deklaratywne s strony powinien wyglądać podobnie do poniższej.</span><span class="sxs-lookup"><span data-stu-id="d4f84-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="d4f84-131">Dokładnie, czy upewnij się, że edytowanie, anulowanie, i aktualizacji przyciski powinny mieć ich `CommandName` właściwości ustawione do edytowania, Anuluj i zaktualizuj odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="d4f84-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="d4f84-132">W tym samouczku kontrolki DataList stan widoku s musi być włączona.</span><span class="sxs-lookup"><span data-stu-id="d4f84-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="d4f84-133">Poświęć chwilę, aby wyświetlić postępach za pośrednictwem przeglądarki (patrz rysunek 2).</span><span class="sxs-lookup"><span data-stu-id="d4f84-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="d4f84-134">[![Każdy produkt zawiera przycisk Edytuj](handling-bll-and-dal-level-exceptions-cs/_static/image5.png)](handling-bll-and-dal-level-exceptions-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d4f84-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-cs/_static/image5.png)](handling-bll-and-dal-level-exceptions-cs/_static/image4.png)</span></span>

<span data-ttu-id="d4f84-135">**Rysunek 2**: Każdy produkt zawiera przycisk Edytuj ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](handling-bll-and-dal-level-exceptions-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d4f84-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image6.png))</span></span>


<span data-ttu-id="d4f84-136">Obecnie przycisk Edytuj tylko powoduje odświeżenie strony jej t jeszcze sprawiają, że można edytować.</span><span class="sxs-lookup"><span data-stu-id="d4f84-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="d4f84-137">Aby umożliwić edytowanie, musimy utworzyć procedury obsługi zdarzeń dla kontrolek DataList s `EditCommand`, `CancelCommand`, i `UpdateCommand` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="d4f84-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="d4f84-138">`EditCommand` i `CancelCommand` zdarzenia po prostu zaktualizuj DataList s `EditItemIndex` właściwość i ponowne wiązanie danych do kontrolki DataList:</span><span class="sxs-lookup"><span data-stu-id="d4f84-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample2.cs)]

<span data-ttu-id="d4f84-139">`UpdateCommand` Procedura obsługi zdarzeń jest nieco bardziej skomplikowane.</span><span class="sxs-lookup"><span data-stu-id="d4f84-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="d4f84-140">Musi odczytać edytowanego produktu s `ProductID` z `DataKeys` kolekcji wraz z nazwą produktu s i ceny na podstawie pola tekstowe w `EditItemTemplate`, a następnie wywołać `ProductsBLL` klasy s `UpdateProduct` metoda przed zwróceniem kontrolki DataList Stan wstępnie edycji.</span><span class="sxs-lookup"><span data-stu-id="d4f84-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="d4f84-141">Na razie umożliwiają s wystarczy użyć dokładnie tego samego kodu z `UpdateCommand` programu obsługi zdarzeń w *omówienie edytowania i usuwania danych w kontrolce DataList* samouczka.</span><span class="sxs-lookup"><span data-stu-id="d4f84-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="d4f84-142">Dodamy kod, aby bezpiecznie obsługiwać wyjątki w kroku 2.</span><span class="sxs-lookup"><span data-stu-id="d4f84-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample3.cs)]

<span data-ttu-id="d4f84-143">Nieprawidłowe dane wejściowe w przypadku której może być w formie cena jednostkowa sformatowany, wartością cena jednostki niedozwolony następująco — $5.00 lub pominięcie Nazwa s produktu, który będzie zgłaszany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d4f84-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="d4f84-144">Ponieważ `UpdateCommand` program obsługi zdarzeń nie zawiera każdy wyjątek, kod obsługi w tym momencie, wyjątek zostanie będą się pojawiać do środowiska uruchomieniowego programu ASP.NET, której będzie on wyświetlana użytkownikowi końcowemu (zobacz rysunek 3).</span><span class="sxs-lookup"><span data-stu-id="d4f84-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![Po wystąpieniu nieobsługiwanego wyjątku, użytkownik końcowy widzi stronę błędu](handling-bll-and-dal-level-exceptions-cs/_static/image7.png)

<span data-ttu-id="d4f84-146">**Rysunek 3**: Po wystąpieniu nieobsługiwanego wyjątku, użytkownik końcowy widzi stronę błędu</span><span class="sxs-lookup"><span data-stu-id="d4f84-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="d4f84-147">Krok 2. Bez problemu zmieniała obsługi wyjątków w obsłudze zdarzeń elementu UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="d4f84-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="d4f84-148">Podczas aktualizowania przepływu pracy, mogą wystąpić wyjątki w `UpdateCommand` programu obsługi zdarzeń, LOGIKI lub warstwy DAL.</span><span class="sxs-lookup"><span data-stu-id="d4f84-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="d4f84-149">Na przykład, jeśli użytkownik wprowadzi cenie zbyt kosztowne, `Decimal.Parse` instrukcji w `UpdateCommand` zgłosi programu obsługi zdarzeń `FormatException` wyjątku.</span><span class="sxs-lookup"><span data-stu-id="d4f84-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="d4f84-150">Jeśli użytkownik pomija Nazwa s produktu lub cena ma wartość ujemną, warstwy DAL zgłosi wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d4f84-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="d4f84-151">Gdy wystąpi wyjątek, chcemy wyświetlić komunikat informacyjny w samej strony.</span><span class="sxs-lookup"><span data-stu-id="d4f84-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="d4f84-152">Dodaj etykietę w sieci Web formant do strony, którego `ID` ustawiono `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="d4f84-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="d4f84-153">Skonfiguruj tekst etykiety s do wyświetlenia w kolorze czerwonym, bardzo duży, pogrubionego oraz pochylonego czcionki, przypisując jej `CssClass` właściwości `Warning` klasy CSS, która jest zdefiniowana w `Styles.css` pliku.</span><span class="sxs-lookup"><span data-stu-id="d4f84-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="d4f84-154">Gdy wystąpi błąd, ma być uruchamiany tylko etykiety, które mają być wyświetlane na raz.</span><span class="sxs-lookup"><span data-stu-id="d4f84-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="d4f84-155">Oznacza to, że na kolejne ogłaszania zwrotnego, komunikat ostrzegawczy etykiety s powinien zniknąć.</span><span class="sxs-lookup"><span data-stu-id="d4f84-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="d4f84-156">Można to osiągnąć przez albo wyczyszczenie się etykiety s `Text` właściwości lub ustawienia jej `Visible` właściwości `False` w `Page_Load` programu obsługi zdarzeń (jak robiliśmy ponownie [obsługi LOGIKI i poziom warstwy DAL wyjątków w ASP Strony .NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) samouczka) lub przez wyłączenie obsługi stanu widoku etykiety s.</span><span class="sxs-lookup"><span data-stu-id="d4f84-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="d4f84-157">Pozwól s tę druga opcję.</span><span class="sxs-lookup"><span data-stu-id="d4f84-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample4.aspx)]

<span data-ttu-id="d4f84-158">Gdy wyjątek jest zgłaszany, przypiszemy szczegółów wyjątku do `ExceptionDetails` etykiety formantu s `Text` właściwości.</span><span class="sxs-lookup"><span data-stu-id="d4f84-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="d4f84-159">Ponieważ swój stan widoku jest wyłączona, kolejne ogłaszania zwrotnego `Text` właściwości s programowe zmiany zostaną utracone, przywrócenie domyślny tekst (ciągiem pustym), a tym samym ukrywanie komunikat ostrzegawczy.</span><span class="sxs-lookup"><span data-stu-id="d4f84-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="d4f84-160">Aby określić, gdy zgłoszono błąd w celu wyświetlania komunikatu przydatne na stronie, musimy dodać `Try ... Catch` za pomocą bloku `UpdateCommand` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d4f84-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="d4f84-161">`Try` Część zawiera kod, który może prowadzić do wyjątku, gdy `Catch` blok zawiera kod, który jest wykonywany w przypadku wyjątku.</span><span class="sxs-lookup"><span data-stu-id="d4f84-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="d4f84-162">Zapoznaj się z [podstawowe informacje dotyczące obsługi wyjątków](https://msdn.microsoft.com/library/2w8f0bss.aspx) sekcji w dokumentacji programu .NET Framework, aby uzyskać więcej informacji na `Try ... Catch` bloku.</span><span class="sxs-lookup"><span data-stu-id="d4f84-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample5.cs)]

<span data-ttu-id="d4f84-163">Kiedy jest zgłaszany wyjątek dowolnego typu przez kod w ramach `Try` bloku, `Catch` kodu w bloku s rozpocznie się wykonywanie.</span><span class="sxs-lookup"><span data-stu-id="d4f84-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="d4f84-164">Typ wyjątku, który jest generowany `DbException`, `NoNullAllowedException`, `ArgumentException`i tak dalej, zależy, co dokładnie wytrącane błędu w pierwszej kolejności.</span><span class="sxs-lookup"><span data-stu-id="d4f84-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="d4f84-165">Jeśli tam s problemem na poziomie bazy danych, `DbException` zostanie zgłoszony.</span><span class="sxs-lookup"><span data-stu-id="d4f84-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="d4f84-166">Jeśli niedozwoloną wartość jest wprowadzana do `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, lub `ReorderLevel` pól `ArgumentException` zostanie zgłoszony, ponieważ dodaliśmy kod do sprawdzania poprawności tych wartości pól w `ProductsDataTable` klasy (zobacz [ Tworzenie warstwy logiki biznesowej](../introduction/creating-a-business-logic-layer-cs.md) samouczka).</span><span class="sxs-lookup"><span data-stu-id="d4f84-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-cs.md) tutorial).</span></span>

<span data-ttu-id="d4f84-167">Firma Microsoft zapewnia bardziej użyteczne wyjaśnienie użytkownikowi końcowemu użycie tekst komunikatu w typie Wystąpił wyjątek.</span><span class="sxs-lookup"><span data-stu-id="d4f84-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="d4f84-168">Poniższy kod, który został użyty w postaci niemal identyczne w [obsługi LOGIKI i wyjątki DAL na poziomie strony ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) samouczek zawiera taki poziom szczegółowości:</span><span class="sxs-lookup"><span data-stu-id="d4f84-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial provides this level of detail:</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample6.cs)]

<span data-ttu-id="d4f84-169">Do ukończenia tego samouczka, wystarczy wywołać `DisplayExceptionDetails` metody z `Catch` bloku, przekazując przechwycony `Exception` wystąpienia (`ex`).</span><span class="sxs-lookup"><span data-stu-id="d4f84-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="d4f84-170">Za pomocą `Try ... Catch` blokowanie w miejscu, użytkownicy są przedstawione przy użyciu bardziej szczegółowy komunikat o błędzie jako rysunki 4 i 5 show.</span><span class="sxs-lookup"><span data-stu-id="d4f84-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="d4f84-171">Należy zauważyć, że w przypadku wyjątku kontrolki DataList pozostaje w trybie edycji.</span><span class="sxs-lookup"><span data-stu-id="d4f84-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="d4f84-172">To dlatego, gdy wystąpi wyjątek, przepływ sterowania od razu zostanie przekierowana do `Catch` bloku, pomijając kod, który zwraca kontrolki DataList stan wstępnie edycji.</span><span class="sxs-lookup"><span data-stu-id="d4f84-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="d4f84-173">[![Komunikat o błędzie jest wyświetlany, jeśli użytkownik pomija pole wymagane](handling-bll-and-dal-level-exceptions-cs/_static/image9.png)](handling-bll-and-dal-level-exceptions-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="d4f84-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-cs/_static/image9.png)](handling-bll-and-dal-level-exceptions-cs/_static/image8.png)</span></span>

<span data-ttu-id="d4f84-174">**Rysunek 4**: Komunikat o błędzie jest wyświetlany, jeśli użytkownik pomija wymagane pola ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](handling-bll-and-dal-level-exceptions-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="d4f84-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image10.png))</span></span>


<span data-ttu-id="d4f84-175">[![Komunikat o błędzie jest wyświetlany podczas wprowadzania ceny](handling-bll-and-dal-level-exceptions-cs/_static/image12.png)](handling-bll-and-dal-level-exceptions-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d4f84-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-cs/_static/image12.png)](handling-bll-and-dal-level-exceptions-cs/_static/image11.png)</span></span>

<span data-ttu-id="d4f84-176">**Rysunek 5**: Komunikat o błędzie jest wyświetlany podczas wprowadzania ujemna cena ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](handling-bll-and-dal-level-exceptions-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="d4f84-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d4f84-177">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="d4f84-177">Summary</span></span>

<span data-ttu-id="d4f84-178">GridView i kontrolki ObjectDataSource zapewniają obsługi zdarzeń po poziomu, które zawierają informacje o wszelkich wyjątków, które zostały zgłoszone podczas aktualizowania i usuwania przepływu pracy, a także właściwości, które można ustawić, aby wskazać, czy wyjątek został obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="d4f84-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="d4f84-179">Te funkcje, jednak są niedostępne podczas pracy z kontrolki DataList i bezpośrednio przy użyciu LOGIKI.</span><span class="sxs-lookup"><span data-stu-id="d4f84-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="d4f84-180">Zamiast tego odpowiadamy za Implementowanie obsługi wyjątków.</span><span class="sxs-lookup"><span data-stu-id="d4f84-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="d4f84-181">W tym samouczku widzieliśmy sposób dodawania obsługi wyjątków, aby można edytować s DataList aktualizowanie przepływu pracy, dodając `Try ... Catch` za pomocą bloku `UpdateCommand` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="d4f84-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="d4f84-182">Jeśli wyjątek jest zgłaszany podczas aktualizowania przepływu pracy, `Catch` bloku s Kod jest wykonywany, wyświetlania informacji pomocnych w `ExceptionDetails` etykiety.</span><span class="sxs-lookup"><span data-stu-id="d4f84-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="d4f84-183">W tym momencie kontrolki DataList nie podejmuje żadnych działań zapobiegające wyjątki od dzieje się w pierwszej kolejności.</span><span class="sxs-lookup"><span data-stu-id="d4f84-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="d4f84-184">Mimo że wiemy, że ceny spowodują wyjątek, że firma Microsoft t dodać jeszcze żadnej funkcji, aby aktywnie uniemożliwić użytkownikowi wprowadzanie takich nieprawidłowe dane wejściowe.</span><span class="sxs-lookup"><span data-stu-id="d4f84-184">Even though we know that a negative price will result in an exception, we haven t yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="d4f84-185">W naszym samouczku dalej zobaczymy, jak zmniejszyć wyjątki spowodowane przez nieprawidłowy użytkownik danych wejściowych przez dodawanie kontrolek weryfikacji w `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d4f84-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="d4f84-186">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="d4f84-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="d4f84-187">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="d4f84-187">Further Reading</span></span>

<span data-ttu-id="d4f84-188">Więcej informacji na tematów omówionych w tym samouczku można znaleźć w następujących zasobach:</span><span class="sxs-lookup"><span data-stu-id="d4f84-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d4f84-189">Wyjątki — zalecenia dotyczące projektowania</span><span class="sxs-lookup"><span data-stu-id="d4f84-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="d4f84-190">[Moduły rejestrowania błędów i obsługi (ELMAH)](http://workspaces.gotdotnet.com/elmah) (biblioteka typu open source dla rejestrowanie błędów)</span><span class="sxs-lookup"><span data-stu-id="d4f84-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="d4f84-191">[Biblioteka przedsiębiorstwa dla programu .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (w tym bloku aplikacji zarządzania wyjątków)</span><span class="sxs-lookup"><span data-stu-id="d4f84-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d4f84-192">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="d4f84-192">About the Author</span></span>

<span data-ttu-id="d4f84-193">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="d4f84-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d4f84-194">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="d4f84-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d4f84-195">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d4f84-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d4f84-196">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d4f84-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d4f84-197">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d4f84-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d4f84-198">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="d4f84-198">Special Thanks To</span></span>

<span data-ttu-id="d4f84-199">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="d4f84-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d4f84-200">Weryfikacja potencjalnych klientów w ramach tego samouczka został Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="d4f84-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="d4f84-201">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="d4f84-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d4f84-202">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d4f84-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d4f84-203">[Poprzednie](performing-batch-updates-cs.md)
> [dalej](adding-validation-controls-to-the-datalist-s-editing-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d4f84-203">[Previous](performing-batch-updates-cs.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-cs.md)</span></span>
