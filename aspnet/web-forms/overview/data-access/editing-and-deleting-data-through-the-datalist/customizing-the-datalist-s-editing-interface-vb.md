---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: Dostosowywanie kontrolki DataList jego edytowania interfejsu (VB) | Dokumentacja firmy Microsoft
author: rick-anderson
description: W tym samouczku utworzymy bogatsze interfejsu edycji kontrolki DataList, zawierającej kontrolek DROPDOWNLIST i pola wyboru.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 8105d2d118bdaa7e6c826479fbd8ed18f5aeaac1
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57070169"
---
<a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="baf8c-103">Dostosowywanie interfejsu edycji kontrolki DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="baf8c-103">Customizing the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="baf8c-104">przez [Bento Scott](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="baf8c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="baf8c-105">[Pobierz przykładową aplikację](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) lub [Pobierz plik PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="baf8c-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="baf8c-106">W tym samouczku utworzymy bogatsze interfejsu edycji kontrolki DataList, zawierającej kontrolek DROPDOWNLIST i pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="baf8c-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>


## <a name="introduction"></a><span data-ttu-id="baf8c-107">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="baf8c-107">Introduction</span></span>

<span data-ttu-id="baf8c-108">Znaczniki i kontrolki sieci Web w elemencie DataList s `EditItemTemplate` zdefiniowanie własnego interfejsu można edytować.</span><span class="sxs-lookup"><span data-stu-id="baf8c-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="baf8c-109">We wszystkich można edytować przykłady DataList możemy ve zbadanie tej pory, można edytować interfejsu ma został złożony z formantów sieci Web w polu tekstowym.</span><span class="sxs-lookup"><span data-stu-id="baf8c-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="baf8c-110">W [poprzedni Samouczek](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) poprawiliśmy środowisko użytkownika w czasie edycji przez dodawanie kontrolek weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="baf8c-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="baf8c-111">`EditItemTemplate` Można rozwinąć, aby uwzględnić kontrolki sieci Web innych niż pola tekstowego, takich jak kontrolek DropDownList, RadioButtonLists, kalendarze i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="baf8c-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="baf8c-112">Podobnie jak w przypadku pól tekstowych, gdy Dostosowywanie interfejsu edycji, aby uwzględnić inne kontrolki sieci Web, należy stosować następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="baf8c-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="baf8c-113">Dodawanie kontrolki sieci Web do `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="baf8c-114">Aby przypisać odpowiednie wartości pola danych do odpowiedniej właściwości, należy użyć składni wiązania danych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="baf8c-115">W `UpdateCommand` programu obsługi zdarzeń, programowego dostępu do sieci Web kontroli wartość i przekaż go do odpowiedniej metody LOGIKI.</span><span class="sxs-lookup"><span data-stu-id="baf8c-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="baf8c-116">W tym samouczku utworzymy bogatsze interfejsu edycji kontrolki DataList, zawierającej kontrolek DROPDOWNLIST i pola wyboru.</span><span class="sxs-lookup"><span data-stu-id="baf8c-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="baf8c-117">W szczególności, utworzymy DataList, który zawiera informacje o produkcie i zezwala na nazwy produktu s, dostawca, kategoria i nieobsługiwane stan do zaktualizowania (patrz rysunek 1).</span><span class="sxs-lookup"><span data-stu-id="baf8c-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>


<span data-ttu-id="baf8c-118">[![Interfejs edytowania zawiera pole tekstowe, dwóch kontrolek DROPDOWNLIST i pola wyboru](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="baf8c-119">**Rysunek 1**: Interfejs edycji zawiera pole tekstowe, dwóch kontrolek DROPDOWNLIST i pola wyboru ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


## <a name="step-1-displaying-product-information"></a><span data-ttu-id="baf8c-120">Krok 1. Wyświetlanie informacji o produkcie</span><span class="sxs-lookup"><span data-stu-id="baf8c-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="baf8c-121">Zanim będziemy mogli utworzyć interfejsu można edytować s DataList, najpierw należy tworzyć interfejsu tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="baf8c-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="baf8c-122">Zacznij od otwarcia `CustomizedUI.aspx` strony `EditDeleteDataList` folder i ustawienia na stronie, Dodaj kontrolką DataList przy użyciu projektanta, jego `ID` właściwość `Products`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="baf8c-123">W tagu inteligentnego s DataList należy utworzyć nowe kontrolki ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="baf8c-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="baf8c-124">Nazwa tej nowej kontrolki ObjectDataSource `ProductsDataSource` i skonfiguruj ją, aby pobrać dane z `ProductsBLL` klasy s `GetProducts` metody.</span><span class="sxs-lookup"><span data-stu-id="baf8c-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="baf8c-125">Jak z poprzednich samouczków DataList można edytować, zaktualizujemy informacje o s edytowanych produktu, przechodząc bezpośrednio do warstwy logiki biznesowej.</span><span class="sxs-lookup"><span data-stu-id="baf8c-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="baf8c-126">W związku z tym zestawu list rozwijanych w UPDATE, INSERT i usuwanie kart (Brak).</span><span class="sxs-lookup"><span data-stu-id="baf8c-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>


<span data-ttu-id="baf8c-127">[![Ustawianie list rozwijanych AKTUALIZOWANIA, WSTAWIANIA i usuwania karty (Brak)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="baf8c-128">**Rysunek 2**: Ustaw AKTUALIZOWANIA, WSTAWIANIA i usuwania listy rozwijane karty (Brak) ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


<span data-ttu-id="baf8c-129">Po skonfigurowaniu kontrolki ObjectDataSource, Visual Studio utworzy domyślną `ItemTemplate` dla zwrócił DataList, zawierający listę nazw i wartości dla każdego pola danych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="baf8c-130">Modyfikowanie `ItemTemplate` tak, aby ten szablon zawiera nazwy produktu w `<h4>` element wraz z nazwa kategorii, nazwa dostawcy, ceny i stan nieobsługiwane.</span><span class="sxs-lookup"><span data-stu-id="baf8c-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="baf8c-131">Ponadto, Dodaj przycisk edycji, upewniając się, że jego `CommandName` właściwość jest ustawiona na edycji.</span><span class="sxs-lookup"><span data-stu-id="baf8c-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="baf8c-132">Oznaczeniu deklaracyjnym dla mojego `ItemTemplate` poniżej:</span><span class="sxs-lookup"><span data-stu-id="baf8c-132">The declarative markup for my `ItemTemplate` follows:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="baf8c-133">Powyższe znaczników wychodzi poza przy użyciu informacji o produkcie &lt;h4&gt; nagłówka dla nazwy produktu s i cztery kolumny `<table>` dla pozostałych pól.</span><span class="sxs-lookup"><span data-stu-id="baf8c-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="baf8c-134">`ProductPropertyLabel` i `ProductPropertyValue` klas CSS, zdefiniowanych w `Styles.css`, zostały omówione w poprzednich samouczkach.</span><span class="sxs-lookup"><span data-stu-id="baf8c-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="baf8c-135">Rysunek 3 pokazuje nasz postęp, podczas wyświetlania za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="baf8c-135">Figure 3 shows our progress when viewed through a browser.</span></span>


<span data-ttu-id="baf8c-136">[![Jest wyświetlana nazwa, dostawca, kategorii, przerywane, stan i cena każdego produktu](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="baf8c-137">**Rysunek 3**: Jest wyświetlana nazwa, dostawca, kategorii, przerywane, stan i cena każdego produktu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="baf8c-138">Krok 2. Dodawanie formantów sieci Web do interfejsu edycji</span><span class="sxs-lookup"><span data-stu-id="baf8c-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="baf8c-139">Pierwszym krokiem tworzenia dostosowanego interfejsu edycji to dodanie wymaganych formantów sieci Web do kontrolki DataList `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="baf8c-140">W szczególności należy kontrolki DropDownList dla kategorii, drugi dla dostawcy, a pola wyboru dla stanu nieobsługiwane.</span><span class="sxs-lookup"><span data-stu-id="baf8c-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="baf8c-141">Ponieważ cena s produktu nie można edytować w tym przykładzie, można w dalszym ciągu wyświetlania go za pomocą formantu sieci Web etykiety.</span><span class="sxs-lookup"><span data-stu-id="baf8c-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="baf8c-142">Dostosowywanie interfejsu edycji, kliknij link Edytuj szablony z tagu inteligentnego DataList s, a następnie wybierz `EditItemTemplate` opcję z listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="baf8c-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="baf8c-143">Dodawanie do kontrolki DropDownList `EditItemTemplate` i ustaw jego `ID` do `Categories`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>


<span data-ttu-id="baf8c-144">[![Dodawanie kontrolki DropDownList dla kategorii](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="baf8c-145">**Rysunek 4**: Dodawanie kontrolki DropDownList dla kategorii ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="baf8c-146">Następnie za pomocą tagu inteligentnego s DropDownList opcję Wybierz źródło danych i utworzyć nowe kontrolki ObjectDataSource, o nazwie `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="baf8c-147">Konfigurowanie tej kontrolki ObjectDataSource używać `CategoriesBLL` klasy s `GetCategories()` — metoda (zobacz rysunek 5).</span><span class="sxs-lookup"><span data-stu-id="baf8c-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="baf8c-148">Następnie DropDownList s Data Source Configuration Wizard wyświetla monit dotyczący pola danych, które będą używane dla każdego `ListItem` s `Text` i `Value` właściwości.</span><span class="sxs-lookup"><span data-stu-id="baf8c-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="baf8c-149">Ma ekran DropDownList `CategoryName` pola danych i użyj `CategoryID` jako wartość, jak pokazano na rysunku 6.</span><span class="sxs-lookup"><span data-stu-id="baf8c-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>


<span data-ttu-id="baf8c-150">[![Tworzenie nowego elementu ObjectDataSource, o nazwie CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="baf8c-151">**Rysunek 5**: Utwórz nowy o nazwie elementu ObjectDataSource `CategoriesDataSource` ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="baf8c-152">[![Konfigurowanie wyświetlania s DropDownList i wartości pól](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="baf8c-153">**Rysunek 6**: Konfigurowanie kontrolki DropDownList s wyświetlania i pola wartości ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


<span data-ttu-id="baf8c-154">Powtórz kroki umożliwiające utworzenie kontrolki DropDownList dla dostawców w tej serii.</span><span class="sxs-lookup"><span data-stu-id="baf8c-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="baf8c-155">Ustaw `ID` dla tej metody DropDownList do `Suppliers` i nadaj jej ObjectDataSource `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="baf8c-156">Po dodaniu dwóch kontrolek DropDownList, Dodaj pole wyboru dla stanu nieobsługiwane i pole tekstowe Nazwa s produktu.</span><span class="sxs-lookup"><span data-stu-id="baf8c-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="baf8c-157">Ustaw `ID` pole wyboru i w polu tekstowym pod kątem `Discontinued` i `ProductName`, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="baf8c-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="baf8c-158">Dodaj RequiredFieldValidator, aby upewnić się, że użytkownik udostępnia wartość dla nazwy produktu s.</span><span class="sxs-lookup"><span data-stu-id="baf8c-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="baf8c-159">Na koniec Dodaj przyciski aktualizacji i Anuluj.</span><span class="sxs-lookup"><span data-stu-id="baf8c-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="baf8c-160">Należy pamiętać, że dla tych dwóch przycisków należy bezwzględnie, ich `CommandName` właściwości są ustawione na aktualizowanie i anulować, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="baf8c-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="baf8c-161">Możesz określić układ edycji interfejs w dowolny sposób.</span><span class="sxs-lookup"><span data-stu-id="baf8c-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="baf8c-162">Czy mogę ve zgody użyto tych samych cztery kolumny `<table>` układu przy użyciu interfejsu tylko do odczytu, jak poniższej składni deklaratywnej i odpowiednio zmienić zrzut ekranu przedstawia:</span><span class="sxs-lookup"><span data-stu-id="baf8c-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]


<span data-ttu-id="baf8c-163">[![Edytowanie interfejsu jest określone w poziomie, takich jak interfejs tylko do odczytu](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="baf8c-164">**Rysunek 7**: Edytowanie interfejsu jest określone w poziomie, takich jak interfejs tylko do odczytu ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>


## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="baf8c-165">Krok 3. Tworzenie EditCommand i procedury obsługi zdarzeń CancelCommand</span><span class="sxs-lookup"><span data-stu-id="baf8c-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="baf8c-166">Obecnie nie ma powiązań danych składni w `EditItemTemplate` (z wyjątkiem `UnitPriceLabel`, który został skopiowany przez verbatim z `ItemTemplate`).</span><span class="sxs-lookup"><span data-stu-id="baf8c-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="baf8c-167">Chwilowo dodamy składnia wiązania danych, ale pierwszym umożliwiają s tworzenie obsługi zdarzeń dla DataList s `EditCommand` i `CancelCommand` zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="baf8c-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="baf8c-168">Pamiętamy odpowiedzialność `EditCommand` procedura obsługi zdarzeń jest do renderowania interfejsu edycji elementu DataList został kliknięty przycisk Edytuj, którego, natomiast `CancelCommand` s zadaniem jest przywrócić stan wstępnie edycji kontrolki DataList.</span><span class="sxs-lookup"><span data-stu-id="baf8c-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="baf8c-169">Tworzenie dwóch programów obsługi i je, użyj następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="baf8c-169">Create these two event handlers and have them use the following code:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="baf8c-170">Za pomocą tych dwóch programów obsługi zdarzeń w miejscu, klikając przycisk Edytuj umożliwia wyświetlanie interfejsu edycji, a następnie kliknięcie przycisku Anuluj zwraca edytowany element do trybu tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="baf8c-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="baf8c-171">Rysunek 8 zawiera kontrolki DataList po kliknięciu przycisk Edytuj s Jacka Chef Gumbo mieszanego.</span><span class="sxs-lookup"><span data-stu-id="baf8c-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="baf8c-172">Ponieważ firma Microsoft ve jeszcze, aby dodać wszelkie składnia wiązania danych do interfejsu edycji `ProductName` pole tekstowe jest puste, `Discontinued` pole wyboru jest nie zaznaczone, a pierwsze elementy wybrana w zaufanym `Categories` i `Suppliers` kontrolek DROPDOWNLIST.</span><span class="sxs-lookup"><span data-stu-id="baf8c-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>


<span data-ttu-id="baf8c-173">[![Kliknięcie przycisku Wyświetla przycisk Edytuj interfejsu edycji](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="baf8c-174">**Rysunek 8**: Klikając przycisk Edytuj wyświetla interfejsu edycji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>


## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="baf8c-175">Krok 4. Dodawanie składnia wiązania danych do edytowania interfejsu</span><span class="sxs-lookup"><span data-stu-id="baf8c-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="baf8c-176">Aby interfejs edytowania wyświetlić bieżące wartości s produktu, musimy można przypisać wartości pól danych odpowiednie wartości kontrolki sieci Web ze składnią wiązania danych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="baf8c-177">Składnia wiązania danych mogą być stosowane za pomocą projektanta, przechodząc do ekranu edytowania szablonów i wybierając link Edytuj powiązania danych z sieci Web formanty tagów inteligentnych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="baf8c-178">Alternatywnie można dodać bezpośrednio w oznaczeniu deklaracyjnym składnia wiązania danych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="baf8c-179">Przypisz `ProductName` wartość do pola danych `ProductName` TextBox s `Text` właściwości `CategoryID` i `SupplierID` wartości do pola danych `Categories` i `Suppliers` kontrolek DROPDOWNLIST `SelectedValue` właściwości i `Discontinued` wartość do pola danych `Discontinued` s wyboru `Checked` właściwości.</span><span class="sxs-lookup"><span data-stu-id="baf8c-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="baf8c-180">Po wprowadzeniu tych zmian za pomocą projektanta lub bezpośrednio w oznaczeniu deklaracyjnym ponownie stronę za pośrednictwem przeglądarki, a następnie kliknij przycisk Edytuj s Jacka Chef Gumbo mieszanego.</span><span class="sxs-lookup"><span data-stu-id="baf8c-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="baf8c-181">Jak pokazano na rysunku nr 9, składnia wiązania danych został dodany bieżące wartości w polu tekstowym, kontrolek DROPDOWNLIST i zaznacz pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="baf8c-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>


<span data-ttu-id="baf8c-182">[![Kliknięcie przycisku Wyświetla przycisk Edytuj interfejsu edycji](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="baf8c-183">**Rysunek 9**: Klikając przycisk Edytuj wyświetla interfejsu edycji ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>


## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="baf8c-184">Krok 5. Zapisywanie zmian s użytkownika w obsłudze zdarzeń elementu UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="baf8c-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="baf8c-185">Gdy użytkownik edytuje produktu i kliknie przycisk Aktualizuj występuje odświeżenie strony i kontrolki DataList s `UpdateCommand` generowane zdarzenie.</span><span class="sxs-lookup"><span data-stu-id="baf8c-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="baf8c-186">W przypadku obsługi, musimy odczytywania wartości z kontrolek w sieci Web w `EditItemTemplate` i interfejs za pomocą LOGIKI, aby zaktualizować produkt w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="baf8c-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="baf8c-187">Ponieważ ve w poprzednich samouczkach `ProductID` zaktualizowanego produktu jest dostępny za pośrednictwem `DataKeys` kolekcji.</span><span class="sxs-lookup"><span data-stu-id="baf8c-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="baf8c-188">Pól wprowadzonych przez użytkownika są dostępne programowo odwołujące się do formantów sieci Web przy użyciu `FindControl("controlID")`, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="baf8c-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="baf8c-189">Kod uruchamia przez consulting `Page.IsValid` właściwości, aby upewnić się, że wszystkie formanty sprawdzania poprawności na tej stronie są prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="baf8c-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="baf8c-190">Jeśli `Page.IsValid` jest `True`, edytowany produkt s `ProductID` wartości są odczytywane z `DataKeys` kolekcji i wprowadzanie danych, sieci Web kontrolki w `EditItemTemplate` programowo odwołują.</span><span class="sxs-lookup"><span data-stu-id="baf8c-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="baf8c-191">Następnie wartości z tych formantów sieci Web są odczytywane w zmiennych, które są następnie przekazywane do odpowiedniego `UpdateProduct` przeciążenia.</span><span class="sxs-lookup"><span data-stu-id="baf8c-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="baf8c-192">Po zaktualizowaniu danych, kontrolki DataList jest zwracany stan wstępnie edycji.</span><span class="sxs-lookup"><span data-stu-id="baf8c-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="baf8c-193">Czy mogę ve pominięcia logiki dodany do programu obsługi wyjątków [obsługi LOGIKI i wyjątków na poziomie warstwy DAL](handling-bll-and-dal-level-exceptions-vb.md) samouczka, aby zachować kod i ten przykład koncentruje się.</span><span class="sxs-lookup"><span data-stu-id="baf8c-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="baf8c-194">W charakterze ćwiczenia należy dodać tę funkcjonalność po ukończeniu tego samouczka.</span><span class="sxs-lookup"><span data-stu-id="baf8c-194">As an exercise, add this functionality after completing this tutorial.</span></span>


## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="baf8c-195">Krok 6. Obsługa CategoryID o wartości NULL i wartości IDDostawcy</span><span class="sxs-lookup"><span data-stu-id="baf8c-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="baf8c-196">Umożliwia bazy danych Northwind `NULL` wartości `Products` tabeli s `CategoryID` i `SupplierID` kolumn.</span><span class="sxs-lookup"><span data-stu-id="baf8c-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="baf8c-197">Jednak obecnie obsłużyć nasz edycji t interfejsu `NULL` wartości.</span><span class="sxs-lookup"><span data-stu-id="baf8c-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="baf8c-198">Jeśli firma Microsoft podejmie próbę edytowania produktu, który ma `NULL` wartość albo jego `CategoryID` lub `SupplierID` kolumn, przejdziemy `ArgumentOutOfRangeException` komunikat o błędzie podobny do: *"Kategorie" ma SelectedValue, która jest nieprawidłowa, ponieważ nie istnieje na liście elementów.*</span><span class="sxs-lookup"><span data-stu-id="baf8c-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="baf8c-199">Ponadto s występują obecnie nie możliwości zmiany Kategoria produktu s lub dostawcę z wartości innej niż`NULL` wartość `NULL` jeden.</span><span class="sxs-lookup"><span data-stu-id="baf8c-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="baf8c-200">Aby obsługiwać `NULL` wartości kategorii i dostawcy kontrolek DropDownList, należy dodać dodatkowy `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="baf8c-201">Czy mogę ve wybranego do użycia (Brak) jako `Text` wartość to `ListItem`, ale można zmienić ją na coś innego (na przykład ciągiem pustym) po d chcesz.</span><span class="sxs-lookup"><span data-stu-id="baf8c-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="baf8c-202">Na koniec należy pamiętać o ustawieniu kontrolek DROPDOWNLIST `AppendDataBoundItems` do `True`; Jeśli zapomnisz to zrobić, kategorie i dostawców powiązany z metody DropDownList spowoduje zastąpienie-dodawane statycznie `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="baf8c-203">Po wprowadzeniu tych zmian, znaczniki kontrolek DROPDOWNLIST w elemencie DataList s `EditItemTemplate` powinien wyglądać podobnie do poniższego:</span><span class="sxs-lookup"><span data-stu-id="baf8c-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>


[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="baf8c-204">Statyczne `ListItem` s mogą być dodawane do kontrolki DropDownList za pomocą projektanta lub bezpośrednio za pomocą składni deklaratywnej.</span><span class="sxs-lookup"><span data-stu-id="baf8c-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="baf8c-205">Podczas dodawania elementu DropDownList do bazy danych do reprezentowania `NULL` wartość, należy je dodać `ListItem` za pomocą składni deklaratywnej.</span><span class="sxs-lookup"><span data-stu-id="baf8c-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="baf8c-206">Jeśli używasz `ListItem` Edytor kolekcji w projektancie, wygenerowany składni deklaratywnej zostaną pominięte `Value` całkowicie ustawienie, jeśli przypisany ciąg pusty, tworzenie oznaczeniu deklaracyjnym, takich jak: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="baf8c-207">Chociaż może to wyglądać nieszkodliwe, brakujący `Value` powoduje, że metody DropDownList używać `Text` wartości właściwości w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="baf8c-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="baf8c-208">Oznacza to, że jeśli to `NULL` `ListItem` jest zaznaczone, wartość (Brak) zostanie podjęta próba ma być przypisane do pola danych produktu (`CategoryID` lub `SupplierID`, w tym samouczku), co spowoduje wyjątek.</span><span class="sxs-lookup"><span data-stu-id="baf8c-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="baf8c-209">Poprzez jawne ustawienie `Value=""`, `NULL` produktu zostanie przypisana wartość pola danych, gdy `NULL` `ListItem` jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="baf8c-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>


<span data-ttu-id="baf8c-210">Poświęć chwilę, aby wyświetlić postępach za pośrednictwem przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="baf8c-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="baf8c-211">Podczas edytowania produktu, należy pamiętać, że `Categories` i `Suppliers` kontrolek DROPDOWNLIST zarówno mają (Brak) opcja na początku metody DropDownList.</span><span class="sxs-lookup"><span data-stu-id="baf8c-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>


<span data-ttu-id="baf8c-212">[![Kategorie i dostawców kontrolek DROPDOWNLIST (Brak) opcja obejmują](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="baf8c-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="baf8c-213">**Na rysunku nr 10**: `Categories` i `Suppliers` kontrolek DROPDOWNLIST obejmują (Brak) opcja ([kliknij, aby wyświetlić obraz w pełnym rozmiarze](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="baf8c-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>


<span data-ttu-id="baf8c-214">Można zapisać opcji (Brak) jako bazy danych `NULL` wartości, należy powrócić do `UpdateCommand` programu obsługi zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="baf8c-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="baf8c-215">Zmiana `categoryIDValue` i `supplierIDValue` zmiennych całkowitych dopuszcza wartości null i przypisać im wartości innych niż `Nothing` tylko wtedy, gdy DropDownList s `SelectedValue` nie jest pusty ciąg:</span><span class="sxs-lookup"><span data-stu-id="baf8c-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>


[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="baf8c-216">Dzięki tej zmianie wartości `Nothing` zostaną przekazane do `UpdateProduct` LOGIKI metody, jeśli użytkownik wybrał (Brak) opcję z dowolnej z list rozwijanych, które odpowiada `NULL` bazy danych wartości.</span><span class="sxs-lookup"><span data-stu-id="baf8c-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="baf8c-217">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="baf8c-217">Summary</span></span>

<span data-ttu-id="baf8c-218">W tym samouczku będziemy pokazaliśmy, jak utworzyć bardziej złożone DataList interfejs edycji, który zawierał trzech różnych danych wejściowych kontrolki sieci Web, pole tekstowe, dwóch kontrolek DROPDOWNLIST i pola wyboru wraz z kontrolkami walidacji.</span><span class="sxs-lookup"><span data-stu-id="baf8c-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="baf8c-219">Podczas kompilowania interfejsu edycji, kroki są takie same, niezależnie od tego, kontrolki sieci Web używane: Rozpocznij, dodając kontrolki sieci Web do DataList s `EditItemTemplate`; użyj składni wiązania danych, aby przypisać odpowiednie wartości pól danych z odpowiednią siecią Web właściwości kontrolek; Ponadto w `UpdateCommand` programu obsługi zdarzeń programowy dostęp do formantów sieci Web i ich odpowiednie właściwości i przekazanie wartości do LOGIKI.</span><span class="sxs-lookup"><span data-stu-id="baf8c-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="baf8c-220">Podczas tworzenia interfejsu edycji tego, czy jego s składa się tylko pól tekstowych lub zbiór innej kontrolki sieci Web, należy poprawnie obsługiwać bazy danych `NULL` wartości.</span><span class="sxs-lookup"><span data-stu-id="baf8c-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="baf8c-221">Gdy dla `NULL` s, jest konieczne, aby tylko prawidłowo wyświetlana istniejące `NULL` wartość w interfejsie edycji, ale również tej oferty oznacza, że do oznaczania wartości jako `NULL`.</span><span class="sxs-lookup"><span data-stu-id="baf8c-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="baf8c-222">Dla kontrolek DROPDOWNLIST w DataLists, zwykle oznacza to, dodawanie statycznego `ListItem` którego `Value` jest jawnie ustawioną na pusty ciąg (`Value=""`) i aby dodać kod do `UpdateCommand` program obsługi zdarzeń, aby określić, czy `NULL``ListItem` został wybrany.</span><span class="sxs-lookup"><span data-stu-id="baf8c-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="baf8c-223">Wszystkiego najlepszego programowania!</span><span class="sxs-lookup"><span data-stu-id="baf8c-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="baf8c-224">Informacje o autorze</span><span class="sxs-lookup"><span data-stu-id="baf8c-224">About the Author</span></span>

<span data-ttu-id="baf8c-225">[Scott Bento](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor siedem ASP/ASP.NET książek i założycielem [4GuysFromRolla.com](http://www.4guysfromrolla.com), pracował nad przy użyciu technologii Microsoft Web od 1998 r.</span><span class="sxs-lookup"><span data-stu-id="baf8c-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="baf8c-226">Scott działa jako niezależny Konsultant, trainer i składnika zapisywania.</span><span class="sxs-lookup"><span data-stu-id="baf8c-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="baf8c-227">Jego najnowszą książkę Stephena [ *Sams uczyć się ASP.NET 2.0 w ciągu 24 godzin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="baf8c-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="baf8c-228">ADAM można z Tobą skontaktować w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="baf8c-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="baf8c-229">lub za pośrednictwem jego blogu, który znajduje się w temacie [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="baf8c-229">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="baf8c-230">Specjalne podziękowania dla</span><span class="sxs-lookup"><span data-stu-id="baf8c-230">Special Thanks To</span></span>

<span data-ttu-id="baf8c-231">W tej serii samouczków został zrecenzowany przez wielu recenzentów pomocne.</span><span class="sxs-lookup"><span data-stu-id="baf8c-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="baf8c-232">Wiodące osób dokonujących przeglądu, w tym samouczku zostały Dennis Patterson, David Suru i Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="baf8c-232">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="baf8c-233">Zainteresowani zapoznaniem Moje kolejnych artykułów MSDN?</span><span class="sxs-lookup"><span data-stu-id="baf8c-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="baf8c-234">Jeśli tak, Porzuć mnie linii w [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="baf8c-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="baf8c-235">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="baf8c-235">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
