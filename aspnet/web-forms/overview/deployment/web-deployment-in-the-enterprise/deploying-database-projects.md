---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
title: Wdrażanie projektów bazy danych | Microsoft Docs
author: jrjlee
description: 'Uwaga: w wielu scenariuszach wdrażania w przedsiębiorstwie potrzebna jest możliwość publikowania aktualizacji przyrostowych w wdrożonej bazie danych. Alternatywą jest ponowne utworzenie...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 832f226a-1aa3-4093-8c29-ce4196793259
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-database-projects
msc.type: authoredcontent
ms.openlocfilehash: 221808758492aedb8e8329364e511df28fd11105
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78634268"
---
# <a name="deploying-database-projects"></a><span data-ttu-id="6ec4a-104">Wdrażanie projektów baz danych</span><span class="sxs-lookup"><span data-stu-id="6ec4a-104">Deploying Database Projects</span></span>

<span data-ttu-id="6ec4a-105">Autor [Jason Lewandowski](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="6ec4a-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="6ec4a-106">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="6ec4a-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> [!NOTE]
> <span data-ttu-id="6ec4a-107">W wielu scenariuszach wdrażania w przedsiębiorstwie potrzebna jest możliwość publikowania aktualizacji przyrostowych w wdrożonej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-107">In lots of enterprise deployment scenarios, you need the ability to publish incremental updates to a deployed database.</span></span> <span data-ttu-id="6ec4a-108">Alternatywą jest ponowne utworzenie bazy danych na każdym wdrożeniu, co oznacza utratę wszystkich danych w istniejącej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-108">The alternative is to recreate the database on every deployment, which means you lose any data in the existing database.</span></span> <span data-ttu-id="6ec4a-109">Podczas pracy z programem Visual Studio 2010 Zalecanym podejściem do przyrostowej publikacji bazy danych jest użycie VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-109">When you work with Visual Studio 2010, using VSDBCMD is the recommended approach to incremental database publishing.</span></span> <span data-ttu-id="6ec4a-110">Jednak Następna wersja programu Visual Studio i potok publikowania w sieci Web (WPP) zawierają narzędzia obsługujące publikowanie przyrostowe bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-110">However, the next version of Visual Studio and the Web Publishing Pipeline (WPP) will include tooling that supports incremental publishing directly.</span></span>

<span data-ttu-id="6ec4a-111">Jeśli otworzysz przykładowe rozwiązanie Contact Manager w programie Visual Studio 2010, zobaczysz, że projekt bazy danych zawiera folder właściwości zawierający cztery pliki.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-111">If you open the Contact Manager sample solution in Visual Studio 2010, you'll see that the database project includes a Properties folder that contains four files.</span></span>

![](deploying-database-projects/_static/image1.png)

<span data-ttu-id="6ec4a-112">Wraz z plikiem projektu (*ContactManager. Database. DBPROJ* w tym przypadku) te pliki kontrolują różne aspekty procesu kompilowania i wdrażania:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-112">Together with the project file (*ContactManager.Database.dbproj* in this case), these files control various aspects of the build and deployment process:</span></span>

- <span data-ttu-id="6ec4a-113">Plik *Database. sqlcmdvars* zawiera wartości dla dowolnych zmiennych narzędzia sqlcmd, które są używane podczas wdrażania projektu.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-113">The *Database.sqlcmdvars* file provides values for any SQLCMD variables you use when you deploy the project.</span></span> <span data-ttu-id="6ec4a-114">Każda konfiguracja rozwiązania (na przykład Debug i Release) może określić inny plik. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-114">Each solution configuration (for example, debug and release) can specify a different .sqlcmdvars file.</span></span>
- <span data-ttu-id="6ec4a-115">Plik *Database. sqldeployment* zawiera ustawienia specyficzne dla wdrożenia, takie jak użycie sortowania zdefiniowanego w projekcie lub sortowanie serwera docelowego, czy należy ponownie utworzyć docelową bazę danych za każdym razem, czy po prostu zmienić istniejącą bazę danych w taki sposób, aby była ona aktualna i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-115">The *Database.sqldeployment* file provides deployment-specific settings, like whether to use the collation defined in your project or the collation of the destination server, whether to recreate the destination database every time or simply amend the existing database to bring it up to date, and so on.</span></span> <span data-ttu-id="6ec4a-116">Każda konfiguracja rozwiązania może określać inny plik. sqldeployment.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-116">Each solution configuration can specify a different .sqldeployment file.</span></span>
- <span data-ttu-id="6ec4a-117">Plik *Database. sqlpermissionss* to dokument XML, którego można użyć do zdefiniowania wszelkich uprawnień, które mają zostać dodane do docelowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-117">The *Database.sqlpermissions* file is an XML document that you can use to define any permissions you want to add to the target database.</span></span> <span data-ttu-id="6ec4a-118">Wszystkie konfiguracje rozwiązania mają ten sam plik. sqlpermissionss.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-118">All solution configurations share the same .sqlpermissions file.</span></span>
- <span data-ttu-id="6ec4a-119">Plik *Database. sqlsettings* określa właściwości na poziomie bazy danych, które mają być używane podczas tworzenia bazy danych, takie jak sortowanie do użycia, zachowanie operatorów porównania i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-119">The *Database.sqlsettings* file specifies the database-level properties to use when creating the database, like the collation to use, the behavior of comparison operators, and so on.</span></span> <span data-ttu-id="6ec4a-120">Wszystkie konfiguracje rozwiązania korzystają z tego samego pliku. sqlsettings.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-120">All solution configurations share the same .sqlsettings file.</span></span>

<span data-ttu-id="6ec4a-121">Warto otworzyć te pliki w programie Visual Studio i zaznajomić się z zawartością.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-121">It's worth taking a moment to open these files in Visual Studio and familiarize yourself with the contents.</span></span>

<span data-ttu-id="6ec4a-122">Podczas kompilowania projektu bazy danych proces kompilacji tworzy dwa pliki:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-122">When you build a database project, the build process creates two files:</span></span>

- <span data-ttu-id="6ec4a-123">*Schemat bazy danych* (plik. DbSchema).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-123">A *database schema* (.dbschema file).</span></span> <span data-ttu-id="6ec4a-124">W tym artykule opisano schemat bazy danych, która ma zostać utworzona w formacie XML.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-124">This describes the schema of the database you want to create in XML format.</span></span>
- <span data-ttu-id="6ec4a-125">*Manifest wdrożenia* (plik. deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-125">A *deployment manifest* (.deploymanifest file).</span></span> <span data-ttu-id="6ec4a-126">Zawiera wszystkie informacje wymagane do utworzenia i wdrożenia bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-126">This contains all the information required to create and deploy your database.</span></span> <span data-ttu-id="6ec4a-127">Odwołuje się do pliku schematu. dboraz innych zasobów, takich jak instrukcje wdrożenia (plik. sqldeployment) i wszystkie skrypty SQL przed wdrożeniem lub po wdrożeniu.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-127">It references the .dbschema file along with other resources, like the deployment instructions (the .sqldeployment file) and any pre-deployment or post-deployment SQL scripts.</span></span>

<span data-ttu-id="6ec4a-128">Spowoduje to wyświetlenie relacji między tymi zasobami:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-128">This shows the relationship between these resources:</span></span>

![](deploying-database-projects/_static/image2.png)

<span data-ttu-id="6ec4a-129">Jak widać, plik. sqlsettings i plik. sqlpermissionss są danymi wejściowymi do procesu kompilacji.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-129">As you can see, the .sqlsettings file and the .sqlpermissions file are inputs to the build process.</span></span> <span data-ttu-id="6ec4a-130">Wraz z plikiem projektu bazy danych te pliki są używane do tworzenia pliku schematu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-130">Along with the database project file, these files are used to create the database schema file.</span></span> <span data-ttu-id="6ec4a-131">Plik. sqldeployment i plik. sqlcmdvars są przekazywane przez proces kompilacji bez zmian.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-131">The .sqldeployment file and the .sqlcmdvars file pass through the build process unchanged.</span></span> <span data-ttu-id="6ec4a-132">Manifest wdrożenia wskazuje lokalizację schematu bazy danych, plik. sqldeployment, plik. sqlcmdvars oraz wszystkie skrypty SQL przed wdrożeniem lub po wdrożeniu.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-132">The deployment manifest indicates the location of the database schema, the .sqldeployment file, the .sqlcmdvars file, and any pre-deployment or post-deployment SQL scripts.</span></span>

## <a name="why-use-vsdbcmd-to-deploy-a-database-project"></a><span data-ttu-id="6ec4a-133">Dlaczego warto używać VSDBCMD do wdrożenia projektu bazy danych?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-133">Why Use VSDBCMD to Deploy a Database Project?</span></span>

<span data-ttu-id="6ec4a-134">Istnieją różne podejścia do wdrażania projektów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-134">There are various different approaches to deploying database projects.</span></span> <span data-ttu-id="6ec4a-135">Jednak nie wszystkie z nich są odpowiednie do wdrożenia projektu bazy danych na serwerach zdalnych w środowisku przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-135">However, not all of them are suitable for deploying a database project to remote servers in an enterprise environment.</span></span> <span data-ttu-id="6ec4a-136">Zastanów się nad wdrożeniem projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-136">Consider what you want from a database project deployment.</span></span> <span data-ttu-id="6ec4a-137">W scenariuszach wdrażania w przedsiębiorstwie można chcieć:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-137">In enterprise deployment scenarios, you're likely to want:</span></span>

- <span data-ttu-id="6ec4a-138">Możliwość wdrażania projektu bazy danych z lokalizacji zdalnej.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-138">The ability to deploy the database project from a remote location.</span></span>
- <span data-ttu-id="6ec4a-139">Możliwość wprowadzania aktualizacji przyrostowych do istniejącej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-139">The ability to make incremental updates to an existing database.</span></span>
- <span data-ttu-id="6ec4a-140">Możliwość dołączania skryptów przed wdrożeniem lub skryptów po wdrożeniu.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-140">The ability to include pre-deployment scripts or post-deployment scripts.</span></span>
- <span data-ttu-id="6ec4a-141">Możliwość dostosowywania wdrożenia do wielu środowisk docelowych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-141">The ability to tailor the deployment to multiple destination environments.</span></span>
- <span data-ttu-id="6ec4a-142">Możliwość wdrażania projektu bazy danych w ramach większego, typowego wdrożenia z jednym etapem.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-142">The ability to deploy the database project as part of a larger, typically scripted, single-step solution deployment.</span></span>

<span data-ttu-id="6ec4a-143">Istnieją trzy główne podejścia, których można użyć do wdrożenia projektu bazy danych:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-143">There are three main approaches you can use to deploy a database project:</span></span>

- <span data-ttu-id="6ec4a-144">Możesz użyć funkcji wdrażania z typem projektu bazy danych w programie Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-144">You can use the deployment functionality with the database project type in Visual Studio 2010.</span></span> <span data-ttu-id="6ec4a-145">Podczas kompilowania i wdrażania projektu bazy danych w programie Visual Studio 2010 proces wdrażania używa manifestu wdrażania do wygenerowania pliku wdrożenia opartego na języku SQL, który jest specyficzny dla konfiguracji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-145">When you build and deploy a database project in Visual Studio 2010, the deployment process uses the deployment manifest to generate a SQL-based deployment file specific to the build configuration.</span></span> <span data-ttu-id="6ec4a-146">Spowoduje to utworzenie bazy danych, jeśli jeszcze nie istnieje, lub wprowadzić niezbędne zmiany w bazie danych, jeśli już istnieją.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-146">This will create the database if it doesn't already exist or make any necessary changes to the database if it does already exist.</span></span> <span data-ttu-id="6ec4a-147">Do uruchomienia tego pliku na serwerze docelowym można użyć narzędzia SQLCMD. exe lub można ustawić program Visual Studio w celu utworzenia i uruchomienia pliku.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-147">You can use SQLCMD.exe to run this file on your destination server, or you can set Visual Studio to create and run the file.</span></span> <span data-ttu-id="6ec4a-148">Wadą tego podejścia jest to, że masz ograniczoną kontrolę nad ustawieniami wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-148">The disadvantage of this approach is that you have only limited control over the deployment settings.</span></span> <span data-ttu-id="6ec4a-149">Często trzeba również zmodyfikować plik wdrożenia SQL, aby zapewnić wartości zmiennych specyficznych dla środowiska.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-149">You may often also need to modify the SQL deployment file to provide environment-specific variable values.</span></span> <span data-ttu-id="6ec4a-150">Tego podejścia można używać tylko na komputerze z zainstalowanym programem Visual Studio 2010, a Deweloper musi znać i podać parametry połączenia oraz poświadczenia dla wszystkich środowisk docelowych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-150">You can only use this approach from a computer with Visual Studio 2010 installed, and the developer would need to know and provide connection strings and credentials for all destination environments.</span></span>
- <span data-ttu-id="6ec4a-151">Korzystając z Internet Information Services (IIS) narzędzia do wdrażania w sieci Web (Web Deploy) [, można wdrożyć bazę danych w ramach projektu aplikacji sieci Web](https://msdn.microsoft.com/library/dd465343.aspx).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-151">You can use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to [deploy a database as part of a web application project](https://msdn.microsoft.com/library/dd465343.aspx).</span></span> <span data-ttu-id="6ec4a-152">Jednak takie podejście jest znacznie bardziej złożone, jeśli chcesz wdrożyć projekt bazy danych, a nie po prostu replikacja istniejącej lokalnej bazy danych na serwerze docelowym.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-152">However, this approach is a lot more complex if you want to deploy a database project rather than simply replicate an existing local database on a destination server.</span></span> <span data-ttu-id="6ec4a-153">Można skonfigurować Web Deploy do uruchamiania skryptu wdrożenia SQL utworzonego przez projekt bazy danych, ale w tym celu należy utworzyć niestandardowy plik obiektów docelowych WPP dla projektu aplikacji sieci Web.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-153">You can configure Web Deploy to run the SQL deployment script that the database project generates, but in order to do this, you need to create a custom WPP targets file for your web application project.</span></span> <span data-ttu-id="6ec4a-154">Spowoduje to dodanie znacznej złożoności procesu wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-154">This adds a substantial amount of complexity to the deployment process.</span></span> <span data-ttu-id="6ec4a-155">Ponadto Web Deploy nie obsługuje bezpośrednio aktualizacji przyrostowych istniejących baz danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-155">In addition, Web Deploy does not directly support incremental updates to existing databases.</span></span> <span data-ttu-id="6ec4a-156">Aby uzyskać więcej informacji na temat tego podejścia, zobacz [rozszerzanie potoku publikowania w sieci Web do wdrożonego projektu bazy danych SQL](https://go.microsoft.com/?linkid=9805121).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-156">For more information on this approach, see [Extending the Web Publishing Pipeline to package database project deployed SQL file](https://go.microsoft.com/?linkid=9805121).</span></span>
- <span data-ttu-id="6ec4a-157">Narzędzia VSDBCMD można użyć do wdrożenia bazy danych przy użyciu schematu bazy danych lub manifestu wdrażania.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-157">You can use the VSDBCMD utility to deploy the database, using either the database schema or the deployment manifest.</span></span> <span data-ttu-id="6ec4a-158">Można wywołać VSDBCMD. exe z elementu docelowego programu MSBuild, który umożliwia publikowanie baz danych w ramach większego procesu wdrażania skryptowego.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-158">You can call VSDBCMD.exe from an MSBuild target, which lets you publish databases as part of a larger, scripted deployment process.</span></span> <span data-ttu-id="6ec4a-159">Można zastąpić zmienne w pliku. sqlcmdvars i wiele innych właściwości bazy danych z polecenia VSDBCMD, co pozwala na dostosowanie wdrożenia dla różnych środowisk bez tworzenia wielu konfiguracji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-159">You can override the variables in your .sqlcmdvars file and lots of other database properties from a VSDBCMD command, which allows you to customize your deployment for different environments without creating multiple build configurations.</span></span> <span data-ttu-id="6ec4a-160">VSDBCMD zapewnia funkcję rozróżniania, co oznacza, że będzie wprowadzać tylko niezbędne zmiany w celu dopasowania docelowej bazy danych do schematu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-160">VSDBCMD provides differentiation functionality, which means it will make only the necessary changes to align a destination database with your database schema.</span></span> <span data-ttu-id="6ec4a-161">VSDBCMD oferuje także szeroką gamę opcji wiersza polecenia, które zapewniają szczegółową kontrolę nad procesem wdrażania.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-161">VSDBCMD also offers a wide range of command-line options, which give you fine-grained control over the deployment process.</span></span>

<span data-ttu-id="6ec4a-162">Z tego omówienia można zobaczyć, że użycie VSDBCMD z programem MSBuild jest najlepszym rozwiązaniem w typowym scenariuszu wdrażania przedsiębiorstwa:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-162">From this overview, you can see that using VSDBCMD with MSBuild is the approach best suited to a typical enterprise deployment scenario:</span></span>

|  | <span data-ttu-id="6ec4a-163">Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="6ec4a-163">Visual Studio 2010</span></span> | <span data-ttu-id="6ec4a-164">Wdrożenie w sieci Web 2.0</span><span class="sxs-lookup"><span data-stu-id="6ec4a-164">Web Deploy 2.0</span></span> | <span data-ttu-id="6ec4a-165">VSDBCMD.exe</span><span class="sxs-lookup"><span data-stu-id="6ec4a-165">VSDBCMD.exe</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="6ec4a-166">Obsługuje zdalne wdrażanie?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-166">Supports remote deployment?</span></span> | <span data-ttu-id="6ec4a-167">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-167">Yes</span></span> | <span data-ttu-id="6ec4a-168">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-168">Yes</span></span> | <span data-ttu-id="6ec4a-169">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-169">Yes</span></span> |
| <span data-ttu-id="6ec4a-170">Obsługuje aktualizacje przyrostowe?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-170">Supports incremental updates?</span></span> | <span data-ttu-id="6ec4a-171">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-171">Yes</span></span> | <span data-ttu-id="6ec4a-172">Nie</span><span class="sxs-lookup"><span data-stu-id="6ec4a-172">No</span></span> | <span data-ttu-id="6ec4a-173">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-173">Yes</span></span> |
| <span data-ttu-id="6ec4a-174">Obsługuje skrypty pre-Deployment?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-174">Supports pre/post-deployment scripts?</span></span> | <span data-ttu-id="6ec4a-175">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-175">Yes</span></span> | <span data-ttu-id="6ec4a-176">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-176">Yes</span></span> | <span data-ttu-id="6ec4a-177">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-177">Yes</span></span> |
| <span data-ttu-id="6ec4a-178">Obsługuje wdrożenie wiele środowisk?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-178">Supports multi-environment deployment?</span></span> | <span data-ttu-id="6ec4a-179">Separator</span><span class="sxs-lookup"><span data-stu-id="6ec4a-179">Limited</span></span> | <span data-ttu-id="6ec4a-180">Separator</span><span class="sxs-lookup"><span data-stu-id="6ec4a-180">Limited</span></span> | <span data-ttu-id="6ec4a-181">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-181">Yes</span></span> |
| <span data-ttu-id="6ec4a-182">Obsługuje wdrożenie skryptowe?</span><span class="sxs-lookup"><span data-stu-id="6ec4a-182">Supports scripted deployment?</span></span> | <span data-ttu-id="6ec4a-183">Separator</span><span class="sxs-lookup"><span data-stu-id="6ec4a-183">Limited</span></span> | <span data-ttu-id="6ec4a-184">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-184">Yes</span></span> | <span data-ttu-id="6ec4a-185">Tak</span><span class="sxs-lookup"><span data-stu-id="6ec4a-185">Yes</span></span> |

<span data-ttu-id="6ec4a-186">W pozostałej części tego tematu opisano użycie VSDBCMD z programem MSBuild do wdrażania projektów bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-186">The remainder of this topic describes the use of VSDBCMD with MSBuild to deploy database projects.</span></span>

## <a name="understanding-the-deployment-process"></a><span data-ttu-id="6ec4a-187">Informacje na temat procesu wdrażania</span><span class="sxs-lookup"><span data-stu-id="6ec4a-187">Understanding the Deployment Process</span></span>

<span data-ttu-id="6ec4a-188">Narzędzie VSDBCMD umożliwia wdrażanie bazy danych przy użyciu schematu bazy danych (plik. DbSchema) lub manifestu wdrażania (plik. deploymanifest).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-188">The VSDBCMD utility lets you deploy a database using either the database schema (the .dbschema file) or the deployment manifest (the .deploymanifest file).</span></span> <span data-ttu-id="6ec4a-189">W ćwiczeniu niemal zawsze będziesz używać manifestu wdrożenia, ponieważ manifest wdrożenia umożliwia podanie wartości domyślnych dla różnych właściwości wdrożenia i zidentyfikowanie wszelkich skryptów SQL przed wdrożeniem lub po wdrożeniu, które mają być uruchamiane.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-189">In practice, you'll almost always use the deployment manifest, as the deployment manifest lets you provide default values for various deployment properties and identify any pre-deployment or post-deployment SQL scripts you want to run.</span></span> <span data-ttu-id="6ec4a-190">Na przykład to polecenie VSDBCMD służy do wdrażania bazy danych **ContactManager** na serwerze bazy danych w środowisku testowym:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-190">For example, this VSDBCMD command is used to deploy the **ContactManager** database to a database server in a test environment:</span></span>

[!code-console[Main](deploying-database-projects/samples/sample1.cmd)]

<span data-ttu-id="6ec4a-191">W takim przypadku:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-191">In this case:</span></span>

- <span data-ttu-id="6ec4a-192">Przełącznik **/a** (lub **/Action**) określa, co ma być VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-192">The **/a** (or **/Action**) switch specifies what you want VSDBCMD to do.</span></span> <span data-ttu-id="6ec4a-193">Można ustawić tę wartość na **Import** lub **wdrożenie**.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-193">You can set this to **Import** or **Deploy**.</span></span> <span data-ttu-id="6ec4a-194">Opcja **Importuj** służy do generowania pliku. DbSchema z istniejącej bazy danych, a opcja **Deploy** służy do wdrażania pliku. DbSchema w docelowej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-194">The **Import** option is used to generate a .dbschema file from an existing database, and the **Deploy** option is used to deploy a .dbschema file to a target database.</span></span>
- <span data-ttu-id="6ec4a-195">Przełącznik **/manifest** (lub **/MANIFESTFILE**) identyfikuje plik. deploymanifest, który ma zostać wdrożony.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-195">The **/manifest** (or **/ManifestFile**) switch identifies the .deploymanifest file you want to deploy.</span></span> <span data-ttu-id="6ec4a-196">Jeśli zamiast tego chcesz użyć pliku. DbSchema, użyj przełącznika **/model** (lub **/ModelFile**).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-196">If you wanted to use the .dbschema file instead, you'd use the **/model** (or **/ModelFile**) switch.</span></span>
- <span data-ttu-id="6ec4a-197">Przełącznik **/CS** (lub **/ConnectionString**) zawiera parametry połączenia dla docelowego serwera bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-197">The **/cs** (or **/ConnectionString**) switch provides the connection string for the target database server.</span></span> <span data-ttu-id="6ec4a-198">Należy pamiętać, że nie obejmuje to nazwy bazy danych&#x2014;VSDBCMD, która musi nawiązać połączenie z serwerem w celu utworzenia bazy danych; nie trzeba łączyć się z pojedynczą bazą danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-198">Note that this doesn't include the name of the database&#x2014;VSDBCMD needs to connect to the server to create the database; it doesn't need to connect to an individual database.</span></span> <span data-ttu-id="6ec4a-199">Jeśli plik. deploymanifest zawiera parametry połączenia, można pominąć ten przełącznik.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-199">If your .deploymanifest file includes a connection string, you can omit this switch.</span></span> <span data-ttu-id="6ec4a-200">Jeśli użyjesz przełącznika mimo to, wartość przełącznika zostanie zastąpiona wartością. deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-200">If you use the switch anyway, the switch value will override the .deploymanifest value.</span></span>
- <span data-ttu-id="6ec4a-201">Właściwość <strong>/p: TargetDatabase</strong> zawiera nazwę, która ma zostać przypisana do docelowej bazy danych podczas tworzenia.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-201">The <strong>/p:TargetDatabase</strong> property provides the name you want to assign to the target database on creation.</span></span> <span data-ttu-id="6ec4a-202">Spowoduje to zastąpienie wartości właściwości <strong>TargetDatabase</strong> w pliku. deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-202">This overrides the value of the <strong>TargetDatabase</strong> property in the .deploymanifest file.</span></span> <span data-ttu-id="6ec4a-203">Można użyć składni <strong>/p:</strong> <em>[nazwa właściwości]</em>, aby ustawić szeroką gamę właściwości wdrożenia i zastąpić wszystkie zmienne sqlcmd zadeklarowane w pliku. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-203">You can use the <strong>/p:</strong> <em>[property name]</em>syntax to set a wide variety of deployment properties and to override any SQLCMD variables declared in your .sqlcmdvars file.</span></span>
- <span data-ttu-id="6ec4a-204">Przełącznik **/DD +** (lub **/DeployToDatabase +** ) wskazuje, że chcesz utworzyć wdrożenie i wdrożyć je w środowisku docelowym.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-204">The **/dd+** (or **/DeployToDatabase+**) switch indicates that you want to create a deployment and deploy it to the target environment.</span></span> <span data-ttu-id="6ec4a-205">Jeśli określisz **/DD-** lub pominięto przełącznik, VSDBCMD wygeneruje skrypt wdrożenia, ale nie zostanie wdrożony w środowisku docelowym.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-205">If you specify **/dd-**, or omit the switch, VSDBCMD will generate a deployment script but will not deploy it to the target environment.</span></span> <span data-ttu-id="6ec4a-206">Ten przełącznik jest często źródłem pomyłek i wyjaśniono bardziej szczegółowo w następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-206">This switch is often the source of confusion and is explained in more detail in the next section.</span></span>
- <span data-ttu-id="6ec4a-207">Przełącznik **/Script** (lub **/DeploymentScriptFile**) określa, gdzie ma być generowany skrypt wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-207">The **/script** (or **/DeploymentScriptFile**) switch specifies where you want to generate the deployment script.</span></span> <span data-ttu-id="6ec4a-208">Ta wartość nie ma wpływu na proces wdrażania.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-208">This value does not affect the deployment process.</span></span>

<span data-ttu-id="6ec4a-209">Aby uzyskać więcej informacji na temat VSDBCMD, zobacz [informacje dotyczące wiersza polecenia dla VSDBCMD. EXE (wdrożenie i importowanie schematu)](https://msdn.microsoft.com/library/dd193283.aspx) i [instrukcje: Przygotowywanie bazy danych do wdrożenia z wiersza polecenia przy użyciu VSDBCMD. Plik EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-209">For more information on VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE](https://msdn.microsoft.com/library/dd193258.aspx).</span></span>

<span data-ttu-id="6ec4a-210">Przykład użycia VSDBCMD z pliku projektu programu MSBuild można znaleźć w temacie [Opis procesu kompilacji](understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-210">For an example of how you can use VSDBCMD from an MSBuild project file, see [Understanding the Build Process](understanding-the-build-process.md).</span></span> <span data-ttu-id="6ec4a-211">Aby zapoznać się z przykładami konfigurowania ustawień wdrażania bazy danych dla wielu środowisk, zobacz [Dostosowywanie wdrożeń baz danych w wielu środowiskach](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-211">For examples of how to configure database deployment settings for multiple environments, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="understanding-the-deploytodatabase-switch"></a><span data-ttu-id="6ec4a-212">Informacje o przełączniku DeployToDatabase</span><span class="sxs-lookup"><span data-stu-id="6ec4a-212">Understanding the DeployToDatabase Switch</span></span>

<span data-ttu-id="6ec4a-213">Zachowanie metody **/DD** lub **/DeployToDatabase** jest zależne od tego, czy używasz VSDBCMD z plikiem. DbSchema czy plikiem. deploymanifest.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-213">The behavior of the **/dd** or **/DeployToDatabase** switch depends on whether you're using VSDBCMD with a .dbschema file or a .deploymanifest file.</span></span> <span data-ttu-id="6ec4a-214">Jeśli używasz pliku ze schematem. DB, zachowanie jest dość proste:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-214">If you're using a .dbschema file, the behavior is fairly straightforward:</span></span>

- <span data-ttu-id="6ec4a-215">Jeśli określisz polecenie **/DD +** lub **/DD**, VSDBCMD wygeneruje skrypt wdrożenia i przeprowadzi wdrożenie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-215">If you specify **/dd+** or **/dd**, VSDBCMD will generate a deployment script and deploy the database.</span></span>
- <span data-ttu-id="6ec4a-216">Jeśli określisz **/DD-** lub pominięto przełącznik, VSDBCMD wygeneruje tylko skrypt wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-216">If you specify **/dd-** or omit the switch, VSDBCMD will generate a deployment script only.</span></span>

<span data-ttu-id="6ec4a-217">Jeśli używasz pliku. deploymanifest, zachowanie jest znacznie bardziej skomplikowane.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-217">If you're using a .deploymanifest file, the behavior is a lot more complicated.</span></span> <span data-ttu-id="6ec4a-218">Wynika to z faktu, że plik. deploymanifest zawiera nazwę właściwości **DeployToDatabase** , która określa, czy baza danych została wdrożona.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-218">This is because the .deploymanifest file contains a property name **DeployToDatabase** that also determines whether the database is deployed.</span></span>

[!code-xml[Main](deploying-database-projects/samples/sample2.xml)]

<span data-ttu-id="6ec4a-219">Wartość tej właściwości jest ustawiana zgodnie z właściwościami projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-219">The value of this property is set according to the properties of the database project.</span></span> <span data-ttu-id="6ec4a-220">Jeśli ustawisz **akcję Wdróż** w celu **utworzenia skryptu wdrożenia (. SQL)** , wartość będzie równa **false**.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-220">If you set the **Deploy action** to **Create a deployment script (.sql)**, the value will be **False**.</span></span> <span data-ttu-id="6ec4a-221">Jeśli ustawisz **akcję Wdróż** , aby **utworzyć skrypt wdrożenia (. SQL) i wdrożyć ją w bazie danych**, wartość będzie **równa true**.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-221">If you set the **Deploy action** to **Create a deployment script (.sql) and deploy to the database**, the value will be **True**.</span></span>

> [!NOTE]
> <span data-ttu-id="6ec4a-222">Te ustawienia są skojarzone z określoną konfiguracją kompilacji i platformą.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-222">These settings are associated with a specific build configuration and platform.</span></span> <span data-ttu-id="6ec4a-223">Na przykład jeśli skonfigurujesz ustawienia konfiguracji **debugowania** , a następnie opublikujesz przy użyciu konfiguracji **wydania** , Twoje ustawienia nie będą używane.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-223">For example, if you configure settings for the **Debug** configuration and then publish using the **Release** configuration, your settings will not be used.</span></span>

![](deploying-database-projects/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="6ec4a-224">W tym scenariuszu **Akcja Wdróż** powinna zawsze być ustawiona, aby **utworzyć skrypt wdrożenia (. SQL)** , ponieważ nie chcesz, aby program Visual Studio 2010 został wdrożony.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-224">In this scenario, the **Deploy action** should always be set to **Create a deployment script (.sql)**, because you don't want Visual Studio 2010 to deploy your database.</span></span> <span data-ttu-id="6ec4a-225">Innymi słowy Właściwość **DeployToDatabase** powinna zawsze mieć **wartość false**.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-225">In other words, the **DeployToDatabase** property should always be **False**.</span></span>

<span data-ttu-id="6ec4a-226">Gdy właściwość **DeployToDatabase** jest określona, przełącznik **/DD** przesłoni właściwość tylko wtedy, gdy wartość właściwości jest **równa false**:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-226">When a **DeployToDatabase** property is specified, the **/dd** switch will only override the property if the property value is **false**:</span></span>

- <span data-ttu-id="6ec4a-227">Jeśli właściwość **DeployToDatabase** ma **wartość false**, a określono polecenie **/DD +** lub **/DD**, VSDBCMD będzie przesłaniał Właściwość **DeployToDatabase** i wdrożyć bazę danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-227">If the **DeployToDatabase** property is **False**, and you specify **/dd+** or **/dd**, VSDBCMD will override the **DeployToDatabase** property and deploy the database.</span></span>
- <span data-ttu-id="6ec4a-228">Jeśli właściwość **DeployToDatabase** ma **wartość false**, a określono opcję **/DD-** lub Pomiń przełącznik, VSDBCMD nie będzie wdrażać bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-228">If the **DeployToDatabase** property is **False**, and you specify **/dd-** or omit the switch, VSDBCMD will not deploy the database.</span></span>
- <span data-ttu-id="6ec4a-229">Jeśli właściwość **DeployToDatabase** ma **wartość true**, VSDBCMD zignoruje przełącznik i Wdróż bazę danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-229">If the **DeployToDatabase** property is **True**, VSDBCMD will ignore the switch and deploy the database.</span></span>
- <span data-ttu-id="6ec4a-230">Skrypt wdrożenia jest generowany w każdym przypadku, niezależnie od tego, czy jest również wdrażana baza danych.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-230">A deployment script is generated in each case, regardless of whether you're deploying the database as well.</span></span>

## <a name="conclusion"></a><span data-ttu-id="6ec4a-231">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="6ec4a-231">Conclusion</span></span>

<span data-ttu-id="6ec4a-232">Ten temat zawiera omówienie procesu kompilowania i wdrażania projektów bazy danych w programie Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-232">This topic provided an overview of the build and deployment process for database projects in Visual Studio 2010.</span></span> <span data-ttu-id="6ec4a-233">Opisano w nim również, jak można użyć programu VSDBCMD. exe z programem MSBuild do obsługi wdrożenia bazy danych w skali przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="6ec4a-233">It also described how you can use VSDBCMD.exe with MSBuild to support enterprise-scale database deployment.</span></span>

<span data-ttu-id="6ec4a-234">Aby uzyskać więcej informacji na temat tego, jak to działa, zobacz [Dostosowywanie wdrożeń baz danych w wielu środowiskach](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-234">For more information on how this works in practice, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="6ec4a-235">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="6ec4a-235">Further Reading</span></span>

<span data-ttu-id="6ec4a-236">Aby uzyskać informacje na temat sposobu dostosowywania wdrożeń baz danych przez utworzenie oddzielnego pliku konfiguracji wdrożenia dla każdego środowiska, zobacz [Dostosowywanie wdrożeń baz danych w wielu środowiskach](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-236">For information on how to customize database deployments by creating a separate deployment configuration file for each environment, see [Customizing Database Deployments for Multiple Environments](../advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="6ec4a-237">Aby uzyskać wskazówki dotyczące sposobu konfigurowania członkostw roli bazy danych, uruchamiając skrypt powdrożeniowy, zobacz [wdrażanie członkostw roli bazy danych w środowiskach testowych](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-237">For guidance on how to configure database role memberships by running a post-deployment script, see [Deploying Database Role Memberships to Test Environments](../advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments.md).</span></span> <span data-ttu-id="6ec4a-238">Aby uzyskać wskazówki dotyczące zarządzania niektórymi unikatowymi wyzwaniami dotyczącymi nakładania się baz danych, zobacz [wdrażanie baz danych członkostwa w środowiskach przedsiębiorstw](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span><span class="sxs-lookup"><span data-stu-id="6ec4a-238">For guidance on managing some of the unique challenges that membership databases impose, see [Deploying Membership Databases to Enterprise Environments](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).</span></span>

<span data-ttu-id="6ec4a-239">Te tematy w witrynie MSDN zapewniają szersze wskazówki i ogólne informacje dotyczące projektów baz danych programu Visual Studio i procesu wdrażania bazy danych:</span><span class="sxs-lookup"><span data-stu-id="6ec4a-239">These topics on MSDN provide broader guidance and background information on Visual Studio database projects and the database deployment process:</span></span>

- [<span data-ttu-id="6ec4a-240">Projekty bazy danych programu Visual Studio 2010 SQL Server</span><span class="sxs-lookup"><span data-stu-id="6ec4a-240">Visual Studio 2010 SQL Server Database Projects</span></span>](https://msdn.microsoft.com/library/ff678491.aspx)
- [<span data-ttu-id="6ec4a-241">Zarządzanie zmianą bazy danych</span><span class="sxs-lookup"><span data-stu-id="6ec4a-241">Managing Database Change</span></span>](https://msdn.microsoft.com/library/aa833404.aspx)
- [<span data-ttu-id="6ec4a-242">Instrukcje: Przygotowywanie bazy danych do wdrożenia z wiersza polecenia przy użyciu VSDBCMD. EXE</span><span class="sxs-lookup"><span data-stu-id="6ec4a-242">How to: Prepare a Database for Deployment From a Command Prompt by Using VSDBCMD.EXE</span></span>](https://msdn.microsoft.com/library/dd193258.aspx)
- [<span data-ttu-id="6ec4a-243">Omówienie Kompilowanie i wdrażanie bazy danych</span><span class="sxs-lookup"><span data-stu-id="6ec4a-243">An Overview of Database Build and Deployment</span></span>](https://msdn.microsoft.com/library/aa833165.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="6ec4a-244">[Poprzednie](deploying-web-packages.md)
> [dalej](creating-and-running-a-deployment-command-file.md)</span><span class="sxs-lookup"><span data-stu-id="6ec4a-244">[Previous](deploying-web-packages.md)
[Next](creating-and-running-a-deployment-command-file.md)</span></span>
