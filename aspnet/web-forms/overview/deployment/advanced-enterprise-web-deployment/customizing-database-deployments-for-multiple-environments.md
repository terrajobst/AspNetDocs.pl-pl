---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
title: Dostosowywanie wdrożeń baz danych dla wielu środowisk | Microsoft Docs
author: jrjlee
description: 'W tym temacie opisano sposób dostosowywania właściwości bazy danych do określonych środowisk docelowych w ramach procesu wdrażania. Uwaga: w temacie założono, że...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: a172979a-1318-4318-a9c6-4f9560d26267
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
msc.type: authoredcontent
ms.openlocfilehash: 8ae8cb1a322afb95c5d2e8d5e73c7825c7b2fe5a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78604028"
---
# <a name="customizing-database-deployments-for-multiple-environments"></a><span data-ttu-id="e3b6f-104">Dostosowywanie wdrożeń bazy danych dla wielu środowisk</span><span class="sxs-lookup"><span data-stu-id="e3b6f-104">Customizing Database Deployments for Multiple Environments</span></span>

<span data-ttu-id="e3b6f-105">Autor [Jason Lewandowski](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="e3b6f-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="e3b6f-106">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="e3b6f-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="e3b6f-107">W tym temacie opisano sposób dostosowywania właściwości bazy danych do określonych środowisk docelowych w ramach procesu wdrażania.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-107">This topic describes how to tailor the properties of a database to specific target environments as part of the deployment process.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="e3b6f-108">W temacie przyjęto założenie, że jest wdrażany projekt bazy danych programu Visual Studio 2010 przy użyciu programu MSBuild. exe i VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-108">The topic assumes that you're deploying a Visual Studio 2010 database project using MSBuild.exe and VSDBCMD.exe.</span></span> <span data-ttu-id="e3b6f-109">Aby uzyskać więcej informacji na temat przyczyn tego podejścia, zobacz [wdrażanie w sieci Web w przedsiębiorstwie](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) i [wdrażanie projektów bazy danych](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-109">For more information on why you might choose this approach, see [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) and [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span>
> 
> 
> <span data-ttu-id="e3b6f-110">Podczas wdrażania projektu bazy danych w wielu miejscach docelowych często chcesz dostosować właściwości wdrażania bazy danych dla każdego środowiska docelowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-110">When you deploy a database project to multiple destinations, you'll often want to customize the database deployment properties for each target environment.</span></span> <span data-ttu-id="e3b6f-111">Na przykład w środowiskach testowych zwykle ponownie utworzysz bazę danych w każdym wdrożeniu, podczas gdy w środowisku przejściowym lub produkcyjnym znacznie bardziej zachodzi potrzeba przeprowadzenia aktualizacji przyrostowych w celu zachowania danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-111">For example, in test environments you'd typically recreate the database on every deployment, whereas in staging or production environments you'd be a lot more likely to make incremental updates to preserve your data.</span></span>
> 
> <span data-ttu-id="e3b6f-112">W projekcie bazy danych programu Visual Studio 2010 ustawienia wdrożenia są zawarte w pliku konfiguracji wdrożenia (. sqldeployment).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-112">In a Visual Studio 2010 database project, deployment settings are contained within a deployment configuration (.sqldeployment) file.</span></span> <span data-ttu-id="e3b6f-113">W tym temacie pokazano, jak utworzyć pliki konfiguracji wdrożenia specyficzne dla środowiska i określić, który ma być używany jako parametr VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-113">This topic will show you how to create environment-specific deployment configuration files and specify the one you want to use as a VSDBCMD parameter.</span></span>

<span data-ttu-id="e3b6f-114">Ten temat stanowi część szeregu samouczków opartych na wymaganiach dotyczących wdrażania w przedsiębiorstwie fikcyjnej firmy o nazwie Fabrikam, Inc. W tej serii samouczków jest stosowane&#x2014;przykładowe rozwiązanie&#x2014;do reprezentowania aplikacji sieci Web, [które ma](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)realistyczny poziom złożoności, w tym aplikacji ASP.NET MVC 3, usługi Windows Communication Foundation (WCF) i projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-114">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="e3b6f-115">Metoda wdrażania w tym samouczku jest oparta na rozłożeniu pliku projektu dzielonego opisanym w artykule [Omówienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), w którym proces kompilacji jest kontrolowany przez dwa pliki&#x2014;projektu, zawierający instrukcje kompilacji, które mają zastosowanie do każdego środowiska docelowego, oraz jeden zawierający ustawienia kompilacji i wdrożenia specyficznego dla środowiska.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-115">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="e3b6f-116">W czasie kompilacji plik projektu specyficzny dla środowiska jest scalany z plikiem projektu Environment-niezależny od w celu utworzenia kompletnego zestawu instrukcji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-116">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="e3b6f-117">Przegląd zadania</span><span class="sxs-lookup"><span data-stu-id="e3b6f-117">Task Overview</span></span>

<span data-ttu-id="e3b6f-118">W tym temacie założono, że:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-118">This topic assumes that:</span></span>

- <span data-ttu-id="e3b6f-119">Należy użyć podejścia Rozdziel plik projektu do wdrożenia rozwiązania, zgodnie z opisem w artykule [Omówienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-119">You use the split project file approach to solution deployment, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="e3b6f-120">Należy wywołać VSDBCMD z pliku projektu, aby wdrożyć projekt bazy danych, zgodnie z opisem w [opisie procesu kompilacji](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-120">You call VSDBCMD from the project file to deploy your database project, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="e3b6f-121">Aby utworzyć system wdrażania, który obsługuje Zmienianie właściwości wdrożenia bazy danych między środowiskami docelowymi, należy wykonać następujące:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-121">To create a deployment system that supports varying the database deployment properties between target environments, you'll need to:</span></span>

- <span data-ttu-id="e3b6f-122">Utwórz plik konfiguracji wdrożenia (. sqldeployment) dla każdego środowiska docelowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-122">Create a deployment configuration (.sqldeployment) file for each target environment.</span></span>
- <span data-ttu-id="e3b6f-123">Utwórz polecenie VSDBCMD, które określa plik konfiguracji wdrożenia jako przełącznik wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-123">Create a VSDBCMD command that specifies the deployment configuration file as a command-line switch.</span></span>
- <span data-ttu-id="e3b6f-124">Sparametryzuj polecenie VSDBCMD w pliku projektu Microsoft Build Engine (MSBuild), tak aby opcje VSDBCMD były odpowiednie dla środowiska docelowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-124">Parameterize the VSDBCMD command in a Microsoft Build Engine (MSBuild) project file, so that the VSDBCMD options are appropriate to the target environment.</span></span>

<span data-ttu-id="e3b6f-125">W tym temacie przedstawiono sposób wykonywania każdej z tych procedur.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-125">This topic will show you how to perform each of these procedures.</span></span>

## <a name="creating-environment-specific-deployment-configuration-files"></a><span data-ttu-id="e3b6f-126">Tworzenie plików konfiguracji wdrożenia specyficznych dla środowiska</span><span class="sxs-lookup"><span data-stu-id="e3b6f-126">Creating Environment-Specific Deployment Configuration Files</span></span>

<span data-ttu-id="e3b6f-127">Domyślnie projekt bazy danych zawiera plik konfiguracji o pojedynczym wdrożeniu o nazwie *Database. sqldeployment*.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-127">By default, a database project contains a single deployment configuration file named *Database.sqldeployment*.</span></span> <span data-ttu-id="e3b6f-128">Jeśli otworzysz ten plik w programie Visual Studio 2010, możesz zobaczyć różne dostępne opcje wdrażania:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-128">If you open this file in Visual Studio 2010, you can see the different deployment options that are available to you:</span></span>

- <span data-ttu-id="e3b6f-129">**Sortowanie porównania wdrożenia**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-129">**Deployment comparison collation**.</span></span> <span data-ttu-id="e3b6f-130">Pozwala to zdecydować, czy należy użyć sortowania bazy danych projektu (sortowania *źródła* ) czy sortowania bazy danych serwera docelowego (sortowanie *docelowe* ).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-130">This lets you choose whether to use the database collation of your project (the *source* collation) or the database collation of your destination server (the *target* collation).</span></span> <span data-ttu-id="e3b6f-131">W większości przypadków podczas wdrażania programu w środowisku deweloperskim lub testowym warto użyć sortowania źródłowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-131">In most cases, you'll want to use the source collation when you deploy to a development or test environment.</span></span> <span data-ttu-id="e3b6f-132">Podczas wdrażania w środowisku przejściowym lub produkcyjnym zwykle warto pozostawić sortowanie docelowe bez zmian, aby uniknąć problemów ze współdziałaniem.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-132">When you deploy to a staging or production environment, you'll usually want to leave the target collation unchanged to avoid any interoperability issues.</span></span>
- <span data-ttu-id="e3b6f-133">**Wdróż właściwości bazy danych**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-133">**Deploy database properties**.</span></span> <span data-ttu-id="e3b6f-134">Dzięki temu można wybrać, czy mają być stosowane właściwości bazy danych, zgodnie z definicją w pliku *Database. sqlsettings* .</span><span class="sxs-lookup"><span data-stu-id="e3b6f-134">This lets you choose whether to apply the database properties, as defined in the *Database.sqlsettings* file.</span></span> <span data-ttu-id="e3b6f-135">Podczas wdrażania bazy danych po raz pierwszy należy wdrożyć właściwości bazy danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-135">When you deploy a database for the first time, you should deploy the database properties.</span></span> <span data-ttu-id="e3b6f-136">W przypadku aktualizowania istniejącej bazy danych właściwości powinny być już na miejscu i nie trzeba ich wdrażać ponownie.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-136">If you're updating an existing database, the properties should already be in place, and you shouldn't need to deploy them again.</span></span>
- <span data-ttu-id="e3b6f-137">**Zawsze należy ponownie utworzyć bazę danych**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-137">**Always re-create database**.</span></span> <span data-ttu-id="e3b6f-138">Dzięki temu można zdecydować, czy należy ponownie utworzyć docelową bazę danych przy każdym wdrożeniu lub wprowadzić przyrostowe zmiany, aby zapewnić aktualność docelowej bazy danych ze schematem.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-138">This lets you choose whether to re-create the target database every time you deploy or make incremental changes to bring the target database up to date with your schema.</span></span> <span data-ttu-id="e3b6f-139">Jeśli utworzysz ponownie bazę danych, utracisz wszystkie dane w istniejącej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-139">If you re-create the database, you'll lose any data in the existing database.</span></span> <span data-ttu-id="e3b6f-140">W związku z tym należy zwykle ustawić **wartość false** dla wdrożeń w środowisku przejściowym lub produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-140">As such, you should usually set this to **false** for deployments to staging or production environments.</span></span>
- <span data-ttu-id="e3b6f-141">**Blokuj wdrożenie przyrostowe, jeśli może wystąpić utrata danych**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-141">**Block incremental deployment if data loss might occur**.</span></span> <span data-ttu-id="e3b6f-142">Dzięki temu można określić, czy wdrożenie ma zostać zatrzymane, jeśli zmiana schematu bazy danych spowoduje utratę danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-142">This lets you choose whether deployment should stop if a change to the database schema will cause the loss of data.</span></span> <span data-ttu-id="e3b6f-143">Zwykle to ustawienie ma **wartość true** w przypadku wdrożenia w środowisku produkcyjnym, co daje możliwość interwencji i ochrony wszelkich ważnych danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-143">You typically set this to **true** for a deployment to a production environment, to give you the opportunity to intervene and protect any important data.</span></span> <span data-ttu-id="e3b6f-144">Jeśli ustawiono opcję **zawsze ponownie utwórz bazę danych** na **wartość false**, to ustawienie nie będzie miało żadnego efektu.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-144">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="e3b6f-145">**Wykonaj wdrożenie w trybie jednego użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-145">**Execute deployment in single-user mode**.</span></span> <span data-ttu-id="e3b6f-146">Nie jest to zwykle problemem w środowiskach deweloperskich i testowych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-146">This is not usually an issue in development or test environments.</span></span> <span data-ttu-id="e3b6f-147">Należy jednak zazwyczaj ustawić **wartość true** dla wdrożeń w środowisku przejściowym lub produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-147">However, you should typically set this to **true** for deployments to staging or production environments.</span></span> <span data-ttu-id="e3b6f-148">Uniemożliwia to użytkownikom wprowadzanie zmian w bazie danych w czasie trwania wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-148">This prevents users from making changes to the database while the deployment is underway.</span></span>
- <span data-ttu-id="e3b6f-149">**Wykonaj kopię zapasową bazy danych przed wdrożeniem**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-149">**Back up database before deployment**.</span></span> <span data-ttu-id="e3b6f-150">Zazwyczaj ta wartość jest ustawiona na **true** podczas wdrażania w środowisku produkcyjnym, jako środek ostrożności przed utratą danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-150">You typically set this to **true** when you deploy to a production environment, as a precaution against data loss.</span></span> <span data-ttu-id="e3b6f-151">Można również ustawić **wartość true** podczas wdrażania w środowisku przejściowym, jeśli Tymczasowa baza danych zawiera dużą ilość danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-151">You may also want to set it to **true** when you deploy to a staging environment, if your staging database contains a lot of data.</span></span>
- <span data-ttu-id="e3b6f-152">**Generuj instrukcje drop dla obiektów, które znajdują się w docelowej bazie danych, ale nie znajdują się w projekcie bazy danych**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-152">**Generate DROP statements for objects that are in the target database but that are not in the database project**.</span></span> <span data-ttu-id="e3b6f-153">W większości przypadków jest to integralna i istotna część tworzenia przyrostowych zmian w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-153">In most cases, this is an integral and essential part of making incremental changes to a database.</span></span> <span data-ttu-id="e3b6f-154">Jeśli ustawiono opcję **zawsze ponownie utwórz bazę danych** na **wartość false**, to ustawienie nie będzie miało żadnego efektu.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-154">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="e3b6f-155">**Nie należy używać instrukcji ALTER Assembly do aktualizowania typów CLR**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-155">**Do not use ALTER ASSEMBLY statements to update CLR types**.</span></span> <span data-ttu-id="e3b6f-156">To ustawienie określa, w jaki sposób SQL Server ma aktualizować typy środowiska uruchomieniowego języka wspólnego (CLR) do nowszych wersji zestawu.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-156">This setting determines how SQL Server should update common language runtime (CLR) types to newer assembly versions.</span></span> <span data-ttu-id="e3b6f-157">Ta wartość powinna być ustawiona na **false** w większości scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-157">This should be set to **false** in most scenarios.</span></span>

<span data-ttu-id="e3b6f-158">W tej tabeli przedstawiono typowe ustawienia wdrażania dla różnych środowisk docelowych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-158">This table shows typical deployment settings for different destination environments.</span></span> <span data-ttu-id="e3b6f-159">Jednak Twoje ustawienia mogą się różnić w zależności od konkretnych wymagań.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-159">However, your settings may be different depending on your exact requirements.</span></span>

|  | <span data-ttu-id="e3b6f-160">Programowanie/testowanie</span><span class="sxs-lookup"><span data-stu-id="e3b6f-160">Developer/Test</span></span> | <span data-ttu-id="e3b6f-161">Przemieszczanie/integracja</span><span class="sxs-lookup"><span data-stu-id="e3b6f-161">Staging/Integration</span></span> | <span data-ttu-id="e3b6f-162">Produkcja</span><span class="sxs-lookup"><span data-stu-id="e3b6f-162">Production</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e3b6f-163">**Sortowanie porównania wdrożenia**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-163">**Deployment comparison collation**</span></span> | <span data-ttu-id="e3b6f-164">Element źródłowy</span><span class="sxs-lookup"><span data-stu-id="e3b6f-164">Source</span></span> | <span data-ttu-id="e3b6f-165">Środowisko docelowe</span><span class="sxs-lookup"><span data-stu-id="e3b6f-165">Target</span></span> | <span data-ttu-id="e3b6f-166">Środowisko docelowe</span><span class="sxs-lookup"><span data-stu-id="e3b6f-166">Target</span></span> |
| <span data-ttu-id="e3b6f-167">**Wdróż właściwości bazy danych**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-167">**Deploy database properties**</span></span> | <span data-ttu-id="e3b6f-168">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-168">True</span></span> | <span data-ttu-id="e3b6f-169">Tylko raz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-169">First time only</span></span> | <span data-ttu-id="e3b6f-170">Tylko raz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-170">First time only</span></span> |
| <span data-ttu-id="e3b6f-171">**Zawsze ponownie Twórz bazę danych**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-171">**Always re-create database**</span></span> | <span data-ttu-id="e3b6f-172">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-172">True</span></span> | <span data-ttu-id="e3b6f-173">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-173">False</span></span> | <span data-ttu-id="e3b6f-174">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-174">False</span></span> |
| <span data-ttu-id="e3b6f-175">**Blokuj wdrożenie przyrostowe, jeśli może wystąpić utrata danych**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-175">**Block incremental deployment if data loss might occur**</span></span> | <span data-ttu-id="e3b6f-176">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-176">False</span></span> | <span data-ttu-id="e3b6f-177">Może</span><span class="sxs-lookup"><span data-stu-id="e3b6f-177">Maybe</span></span> | <span data-ttu-id="e3b6f-178">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-178">True</span></span> |
| <span data-ttu-id="e3b6f-179">**Wykonaj skrypt wdrażania w trybie jednego użytkownika**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-179">**Execute deployment script in single-user mode**</span></span> | <span data-ttu-id="e3b6f-180">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-180">False</span></span> | <span data-ttu-id="e3b6f-181">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-181">True</span></span> | <span data-ttu-id="e3b6f-182">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-182">True</span></span> |
| <span data-ttu-id="e3b6f-183">**Tworzenie kopii zapasowej bazy danych przed wdrożeniem**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-183">**Back up database before deployment**</span></span> | <span data-ttu-id="e3b6f-184">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-184">False</span></span> | <span data-ttu-id="e3b6f-185">Może</span><span class="sxs-lookup"><span data-stu-id="e3b6f-185">Maybe</span></span> | <span data-ttu-id="e3b6f-186">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-186">True</span></span> |
| <span data-ttu-id="e3b6f-187">**Generuj instrukcje DROP dla obiektów, które znajdują się w docelowej bazie danych, ale nie znajdują się w projekcie bazy danych**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-187">**Generate DROP statements for objects that are in the target database but that are not in the database project**</span></span> | <span data-ttu-id="e3b6f-188">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-188">False</span></span> | <span data-ttu-id="e3b6f-189">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-189">True</span></span> | <span data-ttu-id="e3b6f-190">True</span><span class="sxs-lookup"><span data-stu-id="e3b6f-190">True</span></span> |
| <span data-ttu-id="e3b6f-191">**Nie używaj instrukcji ALTER ASSEMBLY do aktualizowania typów CLR**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-191">**Do not use ALTER ASSEMBLY statements to update CLR types**</span></span> | <span data-ttu-id="e3b6f-192">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-192">False</span></span> | <span data-ttu-id="e3b6f-193">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-193">False</span></span> | <span data-ttu-id="e3b6f-194">Fałsz</span><span class="sxs-lookup"><span data-stu-id="e3b6f-194">False</span></span> |

> [!NOTE]
> <span data-ttu-id="e3b6f-195">Aby uzyskać więcej informacji na temat właściwości wdrażania bazy danych i zagadnień dotyczących środowiska, zobacz [Omówienie ustawień projektu bazy danych](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [instrukcje: Konfigurowanie właściwości szczegółów wdrożenia](https://msdn.microsoft.com/library/dd172125.aspx), [Kompilowanie i wdrażanie bazy danych w izolowanym środowisku programistycznym](https://msdn.microsoft.com/library/dd193409.aspx)oraz [Tworzenie i wdrażanie baz danych w środowisku przejściowym lub produkcyjnym](https://msdn.microsoft.com/library/dd193413.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-195">For more information on database deployment properties and environment considerations, see [An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [How to: Configure Properties for Deployment Details](https://msdn.microsoft.com/library/dd172125.aspx), [Build and Deploy Database to an Isolated Development Environment](https://msdn.microsoft.com/library/dd193409.aspx), and [Build and Deploy Databases to a Staging or Production Environment](https://msdn.microsoft.com/library/dd193413.aspx).</span></span>

<span data-ttu-id="e3b6f-196">Aby zapewnić obsługę wdrożenia projektu bazy danych w wielu miejscach docelowych, należy utworzyć plik konfiguracji wdrożenia dla każdego środowiska docelowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-196">To support the deployment of a database project to multiple destinations, you should create a deployment configuration file for each target environment.</span></span>

<span data-ttu-id="e3b6f-197">**Aby utworzyć plik konfiguracji specyficzny dla środowiska**</span><span class="sxs-lookup"><span data-stu-id="e3b6f-197">**To create an environment-specific configuration file**</span></span>

1. <span data-ttu-id="e3b6f-198">W programie Visual Studio 2010, w oknie **Eksplorator rozwiązań** kliknij prawym przyciskiem myszy projekt bazy danych, a następnie kliknij polecenie **Właściwości**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-198">In Visual Studio 2010, in the **Solution Explorer** window, right-click your database project, and then click **Properties**.</span></span>
2. <span data-ttu-id="e3b6f-199">Na stronie właściwości projektu bazy danych na karcie **wdrażanie** w wierszu **plik konfiguracji wdrożenia** kliknij pozycję **Nowy**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-199">On the database project properties page, on the **Deploy** tab, in the **Deployment configuration file** row, click **New**.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image1.png)
3. <span data-ttu-id="e3b6f-200">W oknie dialogowym **nowy plik konfiguracji wdrożenia** Nadaj plikowi zrozumiałą nazwę (na przykład **TestEnvironment. sqldeployment**), a następnie kliknij przycisk **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-200">In the **New Deployment Configuration File** dialog box, give the file a meaningful name (for example, **TestEnvironment.sqldeployment**), and then click **Save**.</span></span>
4. <span data-ttu-id="e3b6f-201">Na stronie *[filename] \* \* *. sqldeployment** ustaw właściwości wdrożenia zgodne z wymaganiami środowiska docelowego, a następnie Zapisz plik.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-201">On the *[Filename]\*\*\*.sqldeployment*\* page, set the deployment properties to match the requirements of your destination environment, and then save the file.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image2.png)
5. <span data-ttu-id="e3b6f-202">Zwróć uwagę, że nowy plik zostanie dodany do folderu właściwości w projekcie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-202">Notice that the new file is added to the Properties folder in your database project.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image3.png)

## <a name="specifying-the-deployment-configuration-file-in-vsdbcmd"></a><span data-ttu-id="e3b6f-203">Określanie pliku konfiguracji wdrożenia w VSDBCMD</span><span class="sxs-lookup"><span data-stu-id="e3b6f-203">Specifying the Deployment Configuration File in VSDBCMD</span></span>

<span data-ttu-id="e3b6f-204">W przypadku używania konfiguracji rozwiązania (takich jak debugowanie i wydawanie) w programie Visual Studio 2010 można skojarzyć plik konfiguracji wdrożenia z każdą konfiguracją.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-204">When you use solution configurations (like Debug and Release) within Visual Studio 2010, you can associate a deployment configuration file with each configuration.</span></span> <span data-ttu-id="e3b6f-205">Podczas kompilowania określonej konfiguracji proces kompilacji generuje plik manifestu wdrożenia specyficzny dla konfiguracji, który wskazuje plik konfiguracyjny wdrożenia specyficzny dla konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-205">When you build a particular configuration, the build process generates a configuration-specific deployment manifest file that points to the configuration-specific deployment configuration file.</span></span> <span data-ttu-id="e3b6f-206">Jednym z głównych celów podejścia do wdrożenia opisanego w tych samouczkach jest jednak umożliwienie użytkownikom kontrolowania procesu wdrażania bez korzystania z programu Visual Studio 2010 i konfiguracji rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-206">However, one of the main aims of the approach to deployment described in these tutorials is to give people the ability to control the deployment process without using Visual Studio 2010 and solution configurations.</span></span> <span data-ttu-id="e3b6f-207">W tym podejściu Konfiguracja rozwiązania jest taka sama, niezależnie od docelowego środowiska wdrażania.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-207">In this approach, the solution configuration is the same regardless of the target deployment environment.</span></span> <span data-ttu-id="e3b6f-208">Aby dostosować wdrożenie bazy danych do określonego środowiska docelowego, można użyć opcji wiersza polecenia VSDBCMD, aby określić plik konfiguracji wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-208">To tailor your database deployment to a specific destination environment, you can use the VSDBCMD command-line options to specify your deployment configuration file.</span></span>

<span data-ttu-id="e3b6f-209">Aby określić plik konfiguracji wdrożenia w VSDBCMD, użyj przełącznika **p:/DeploymentConfigurationFile** i podaj pełną ścieżkę do pliku.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-209">To specify a deployment configuration file in your VSDBCMD, use the **p:/DeploymentConfigurationFile** switch and provide the full path to your file.</span></span> <span data-ttu-id="e3b6f-210">Spowoduje to zastąpienie pliku konfiguracji wdrożenia, który identyfikuje manifest wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-210">This will override the deployment configuration file that the deployment manifest identifies.</span></span> <span data-ttu-id="e3b6f-211">Na przykład można użyć tego polecenia VSDBCMD do wdrożenia bazy danych **ContactManager** w środowisku testowym:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-211">For example, you could use this VSDBCMD command to deploy the **ContactManager** database to a test environment:</span></span>

[!code-console[Main](customizing-database-deployments-for-multiple-environments/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="e3b6f-212">Należy pamiętać, że proces kompilacji może zmienić nazwę pliku wdrożenia. sqldeployment, gdy plik jest kopiowany do katalogu wyjściowego.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-212">Note that the build process may rename your .sqldeployment file when it copies the file to the output directory.</span></span>

<span data-ttu-id="e3b6f-213">Jeśli używasz zmiennych poleceń SQL w skryptach SQL przed wdrożeniem lub po wdrożeniu, możesz użyć podobnej metody, aby skojarzyć plik sqlcmdvars specyficzny dla środowiska ze wdrożeniem.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-213">If you use SQL command variables in your pre-deployment or post-deployment SQL scripts, you can use a similar approach to associate an environment-specific .sqlcmdvars file with your deployment.</span></span> <span data-ttu-id="e3b6f-214">W takim przypadku należy użyć przełącznika **p:/SqlCommandVariablesFile** , aby zidentyfikować plik. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-214">In this case, you use the **p:/SqlCommandVariablesFile** switch to identify your .sqlcmdvars file.</span></span>

## <a name="running-the-vsdbcmd-command-from-an-msbuild-project-file"></a><span data-ttu-id="e3b6f-215">Uruchamianie polecenia VSDBCMD z pliku projektu programu MSBuild</span><span class="sxs-lookup"><span data-stu-id="e3b6f-215">Running the VSDBCMD Command from an MSBuild Project File</span></span>

<span data-ttu-id="e3b6f-216">Można wywołać polecenie VSDBCMD z pliku projektu programu MSBuild przy użyciu zadania **exec** w elemencie docelowym programu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-216">You can invoke a VSDBCMD command from an MSBuild project file by using an **Exec** task within an MSBuild target.</span></span> <span data-ttu-id="e3b6f-217">W najprostszej postaci będzie wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-217">In its simplest form, it would look like this:</span></span>

[!code-xml[Main](customizing-database-deployments-for-multiple-environments/samples/sample2.xml)]

- <span data-ttu-id="e3b6f-218">W ćwiczeniu, aby ułatwić odczytywanie i ponowne używanie plików projektu, należy utworzyć właściwości do przechowywania różnych parametrów wiersza polecenia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-218">In practice, to make your project files easy to read and reuse, you'll want to create properties to store the various command-line parameters.</span></span> <span data-ttu-id="e3b6f-219">Ułatwia to użytkownikom udostępnianie wartości właściwości w pliku projektu specyficznym dla środowiska lub przesłonięcie wartości domyślnych z wiersza polecenia programu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-219">This makes it easier for users to provide property values in an environment-specific project file or to override default values from the MSBuild command line.</span></span> <span data-ttu-id="e3b6f-220">Jeśli używasz podejścia do rozdzielnego pliku projektu opisanego w artykule [Omówienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), należy podzielić instrukcje kompilacji i właściwości między tymi dwoma plikami odpowiednio:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-220">If you use the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), you should divide your build instructions and properties between the two files accordingly:</span></span>
- <span data-ttu-id="e3b6f-221">Ustawienia specyficzne dla środowiska, takie jak nazwa pliku konfiguracji wdrożenia, parametry połączenia z bazą danych i Nazwa docelowej bazy danych, powinny przejść do pliku projektu specyficznego dla środowiska.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-221">Environment-specific settings, like the deployment configuration filename, the database connection string, and the target database name, should go in the environment-specific project file.</span></span>
- <span data-ttu-id="e3b6f-222">Obiekt docelowy programu MSBuild, który uruchamia polecenie VSDBCMD, wraz ze wszystkimi właściwościami uniwersalnymi, takimi jak lokalizacja pliku wykonywalnego VSDBCMD, powinien znajdować się w pliku uniwersalnego projektu.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-222">The MSBuild target that runs the VSDBCMD command, together with any universal properties like the location of the VSDBCMD executable, should go in the universal project file.</span></span>

<span data-ttu-id="e3b6f-223">Należy również upewnić się, że projekt bazy danych został utworzony przed wywołaniem VSDBCMD w celu utworzenia pliku deploymanifest i gotowości do użycia.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-223">You should also ensure that you build the database project before you invoke VSDBCMD so that the .deploymanifest file is created and ready to use.</span></span> <span data-ttu-id="e3b6f-224">Możesz zobaczyć pełny przykład tego podejścia w temacie [opisującym proces kompilowania](../web-deployment-in-the-enterprise/understanding-the-build-process.md), który przeprowadzi Cię przez pliki projektu w [przykładowym rozwiązaniu Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-224">You can see a full example of this approach in the topic [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), which walks you through the project files in the [Contact Manager sample solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="e3b6f-225">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="e3b6f-225">Conclusion</span></span>

<span data-ttu-id="e3b6f-226">W tym temacie opisano, jak można dopasować właściwości bazy danych do różnych środowisk docelowych podczas wdrażania projektów bazy danych za pomocą programu MSBuild i VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-226">This topic described how you can tailor database properties to different destination environments when you deploy database projects using MSBuild and VSDBCMD.</span></span> <span data-ttu-id="e3b6f-227">Takie podejście jest przydatne, gdy trzeba wdrożyć projekty bazy danych w ramach większych rozwiązań w skali korporacyjnej.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-227">This approach is useful when you need to deploy database projects as part of larger, enterprise-scale solutions.</span></span> <span data-ttu-id="e3b6f-228">Te rozwiązania są często wdrażane w wielu miejscach docelowych, takich jak środowiska deweloperskie lub testowe w trybie piaskownicy, platformy przygotowywania lub integracji oraz środowiska produkcyjne lub na żywo.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-228">These solutions are often deployed to multiple destinations, like sandboxed development or test environments, staging or integration platforms, and production or live environments.</span></span> <span data-ttu-id="e3b6f-229">Każdy z tych środowisk docelowych zazwyczaj wymaga unikatowego zestawu właściwości wdrożenia bazy danych.</span><span class="sxs-lookup"><span data-stu-id="e3b6f-229">Each of these target environments typically requires a unique set of database deployment properties.</span></span>

## <a name="further-reading"></a><span data-ttu-id="e3b6f-230">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="e3b6f-230">Further Reading</span></span>

<span data-ttu-id="e3b6f-231">Aby uzyskać więcej informacji na temat wdrażania projektów bazy danych przy użyciu programu VSDBCMD. exe, zobacz [wdrażanie projektów bazy danych](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-231">For more information on deploying database projects using VSDBCMD.exe, see [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span> <span data-ttu-id="e3b6f-232">Aby uzyskać więcej informacji na temat używania niestandardowych plików projektów programu MSBuild do kontrolowania procesu wdrażania, zobacz [Omówienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md) i [zrozumienie procesu kompilacji](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="e3b6f-232">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="e3b6f-233">Te artykuły w witrynie MSDN zawierają bardziej ogólne wskazówki dotyczące wdrażania bazy danych:</span><span class="sxs-lookup"><span data-stu-id="e3b6f-233">These articles on MSDN provide more general guidance on database deployment:</span></span>

- <span data-ttu-id="e3b6f-234">[Omówienie ustawień projektu bazy danych](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="e3b6f-234">[An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span></span>
- [<span data-ttu-id="e3b6f-235">Instrukcje: Konfigurowanie właściwości szczegółów wdrożenia</span><span class="sxs-lookup"><span data-stu-id="e3b6f-235">How to: Configure Properties for Deployment Details</span></span>](https://msdn.microsoft.com/library/dd172125.aspx)
- [<span data-ttu-id="e3b6f-236">Kompiluj i wdrażaj bazy danych w izolowanym środowisku programistycznym</span><span class="sxs-lookup"><span data-stu-id="e3b6f-236">Build and Deploy Databases to an Isolated Development Environment</span></span>](https://msdn.microsoft.com/library/dd193409.aspx)
- [<span data-ttu-id="e3b6f-237">Kompilowanie i wdrażanie baz danych w środowisku przejściowym lub produkcyjnym</span><span class="sxs-lookup"><span data-stu-id="e3b6f-237">Build and Deploy Databases to a Staging or Production Environment</span></span>](https://msdn.microsoft.com/library/dd193413.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="e3b6f-238">[Poprzednie](performing-a-what-if-deployment.md)
> [dalej](deploying-database-role-memberships-to-test-environments.md)</span><span class="sxs-lookup"><span data-stu-id="e3b6f-238">[Previous](performing-a-what-if-deployment.md)
[Next](deploying-database-role-memberships-to-test-environments.md)</span></span>
