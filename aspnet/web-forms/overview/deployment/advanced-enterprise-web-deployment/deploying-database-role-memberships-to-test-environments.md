---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments
title: Wdrażanie członkostw roli bazy danych w środowiskach testowych | Dokumentacja firmy Microsoft
author: jrjlee
description: W tym temacie opisano sposób dodawania kont użytkowników do ról bazy danych jako część wdrożenia rozwiązania w środowisku testowym. Podczas wdrażania rozwiązania zawierającego...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 9b2af539-7ad9-47aa-b66e-873bd9906e79
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-database-role-memberships-to-test-environments
msc.type: authoredcontent
ms.openlocfilehash: a15f5bf5f659d151e91ef9e53c5ad55bcd8e2b01
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 05/06/2019
ms.locfileid: "65130406"
---
# <a name="deploying-database-role-memberships-to-test-environments"></a><span data-ttu-id="1a47e-104">Wdrażanie członkostw ról bazy danych w środowiskach testowych</span><span class="sxs-lookup"><span data-stu-id="1a47e-104">Deploying Database Role Memberships to Test Environments</span></span>

<span data-ttu-id="1a47e-105">przez [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="1a47e-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="1a47e-106">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="1a47e-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="1a47e-107">W tym temacie opisano sposób dodawania kont użytkowników do ról bazy danych jako część wdrożenia rozwiązania w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="1a47e-107">This topic describes how to add user accounts to database roles as part of a solution deployment to a test environment.</span></span>
> 
> <span data-ttu-id="1a47e-108">Podczas wdrażania rozwiązania zawierającego projekt bazy danych w środowisku tymczasowym lub produkcyjnym zwykle nie chcesz dla deweloperów, aby zautomatyzować dodawanie kont użytkowników do ról bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-108">When you deploy a solution containing a database project to a staging or production environment, you typically don't want the developer to automate the addition of user accounts to database roles.</span></span> <span data-ttu-id="1a47e-109">W większości przypadków deweloper nie będzie wiadomo, które konta użytkowników, należy dodać do ról bazy danych, a tych wymagań można zmienić w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="1a47e-109">In most cases, the developer won't know which user accounts need to be added to which database roles, and these requirements could change at any time.</span></span> <span data-ttu-id="1a47e-110">Jednak podczas wdrażania rozwiązania zawierającego projekt bazy danych do rozwoju lub środowiska testowego, ta sytuacja jest zazwyczaj zamiast innego:</span><span class="sxs-lookup"><span data-stu-id="1a47e-110">However, when you deploy a solution containing a database project to a development or test environment, the situation is usually rather different:</span></span>
> 
> - <span data-ttu-id="1a47e-111">Deweloper zazwyczaj ponownie wdraża rozwiązanie na bieżąco, często kilka razy dziennie.</span><span class="sxs-lookup"><span data-stu-id="1a47e-111">The developer typically re-deploys the solution on a regular basis, often several times a day.</span></span>
> - <span data-ttu-id="1a47e-112">Bazy danych ponownie jest zwykle tworzony przy każdym wdrożeniu, co oznacza, że użytkownicy bazy danych muszą być tworzone i dodawane do ról po każdym wdrożeniu.</span><span class="sxs-lookup"><span data-stu-id="1a47e-112">The database is typically re-created on every deployment, which means that database users must be created and added to roles after every deployment.</span></span>
> - <span data-ttu-id="1a47e-113">Deweloper zazwyczaj ma pełną kontrolę nad środowiska deweloperskie lub testowe docelowego.</span><span class="sxs-lookup"><span data-stu-id="1a47e-113">The developer typically has full control over the target development or test environment.</span></span>
> 
> <span data-ttu-id="1a47e-114">W tym scenariuszu jest często korzystne automatycznie utworzyć bazy danych użytkowników i przypisywanie członkostw roli bazy danych jako część procesu wdrażania.</span><span class="sxs-lookup"><span data-stu-id="1a47e-114">In this scenario, it's often beneficial to automatically create database users and assign database role memberships as part of the deployment process.</span></span>
> 
> <span data-ttu-id="1a47e-115">Kluczowym czynnikiem jest to, że ta operacja musi być warunkowych opartych na środowisku docelowym.</span><span class="sxs-lookup"><span data-stu-id="1a47e-115">The key factor is that this operation needs to be conditional based on the target environment.</span></span> <span data-ttu-id="1a47e-116">Jeśli wdrażasz tymczasowym lub w środowisku produkcyjnym, należy pominąć operację.</span><span class="sxs-lookup"><span data-stu-id="1a47e-116">If you're deploying to a staging or a production environment, you want to skip the operation.</span></span> <span data-ttu-id="1a47e-117">Jeśli jest wdrażany z deweloperem lub środowiska testowego, którą chcesz wdrożyć członkostwa w roli bez dalszej interwencji.</span><span class="sxs-lookup"><span data-stu-id="1a47e-117">If you're deploying to a developer or test environment, you want to deploy role memberships without further intervention.</span></span> <span data-ttu-id="1a47e-118">W tym temacie opisano jeden podejścia, którego można użyć, aby rozwiązać ten problem.</span><span class="sxs-lookup"><span data-stu-id="1a47e-118">This topic describes one approach you can use to address this challenge.</span></span>

<span data-ttu-id="1a47e-119">Ten temat jest częścią serii samouczków na podstawie wymagania dotyczące wdrażania enterprise fikcyjnej firmy o nazwie firmy Fabrikam, Inc. Przykładowe rozwiązanie korzysta z tej serii samouczków&#x2014; [rozwiązania Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;do reprezentowania aplikacji sieci web przy użyciu realistycznej stopień złożoności, łącznie z aplikacją ASP.NET MVC 3 komunikacji Windows Usługa Foundation (WCF), a projekt bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-119">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="1a47e-120">Metody wdrażania w ramach tego samouczka opiera się na podejście pliku projektu Podziel opisane w [objaśnienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), w którym proces kompilacji jest kontrolowana przez dwa pliki projektu&#x2014;jeden zawierający Tworzenie instrukcji, które mają zastosowanie do każdego środowiska docelowego i jeden zawierający ustawienia specyficzne dla środowiska kompilacji i wdrażania.</span><span class="sxs-lookup"><span data-stu-id="1a47e-120">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="1a47e-121">W czasie kompilacji pliku projektu specyficznymi dla środowiska jest scalana w pliku projektu niezależnego od środowiska w celu utworzenia kompletny zestaw instrukcji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="1a47e-121">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="1a47e-122">Omówienie zadań</span><span class="sxs-lookup"><span data-stu-id="1a47e-122">Task Overview</span></span>

<span data-ttu-id="1a47e-123">W tym temacie założono, że:</span><span class="sxs-lookup"><span data-stu-id="1a47e-123">This topic assumes that:</span></span>

- <span data-ttu-id="1a47e-124">Użyj podejście split projektu plików do wdrożenia rozwiązania, zgodnie z opisem w [objaśnienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="1a47e-124">You use the split project file approach to solution deployment, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="1a47e-125">Wywoływanie VSDBCMD z pliku projektu, aby wdrożyć projekt bazy danych, zgodnie z opisem w [objaśnienie procesu kompilacji](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="1a47e-125">You call VSDBCMD from the project file to deploy your database project, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="1a47e-126">Tworzenie użytkowników bazy danych i przypisywanie członkostw roli podczas wdrażania projektu bazy danych w środowisku testowym, należy:</span><span class="sxs-lookup"><span data-stu-id="1a47e-126">To create database users and assign role memberships when you deploy a database project to a test environment, you'll need to:</span></span>

- <span data-ttu-id="1a47e-127">Utwórz skrypt Transact Structured Query Language (język Transact-SQL), który sprawia, że zmiany w bazie danych to konieczne.</span><span class="sxs-lookup"><span data-stu-id="1a47e-127">Create a Transact Structured Query Language (Transact-SQL) script that makes the necessary database changes.</span></span>
- <span data-ttu-id="1a47e-128">Utwórz obiekt docelowy aparatu Microsoft Build Engine (MSBuild), który używa narzędzia sqlcmd.exe, aby uruchomić skrypt SQL.</span><span class="sxs-lookup"><span data-stu-id="1a47e-128">Create a Microsoft Build Engine (MSBuild) target that uses the sqlcmd.exe utility to run the SQL script.</span></span>
- <span data-ttu-id="1a47e-129">Konfigurowanie plików projektu, aby wywołać element docelowy podczas wdrażania rozwiązania w środowisku testowym.</span><span class="sxs-lookup"><span data-stu-id="1a47e-129">Configure your project files to invoke the target when you're deploying your solution to a test environment.</span></span>

<span data-ttu-id="1a47e-130">W tym temacie pokazują sposób wykonywania każdego z tych procedur.</span><span class="sxs-lookup"><span data-stu-id="1a47e-130">This topic will show you how to perform each of these procedures.</span></span>

## <a name="scripting-the-database-role-memberships"></a><span data-ttu-id="1a47e-131">Obsługa skryptów członkostw roli bazy danych</span><span class="sxs-lookup"><span data-stu-id="1a47e-131">Scripting the Database Role Memberships</span></span>

<span data-ttu-id="1a47e-132">Wiele różnych sposobów, można utworzyć skrypt języka Transact-SQL i w dowolnym miejscu możesz wybrać.</span><span class="sxs-lookup"><span data-stu-id="1a47e-132">You can create a Transact-SQL script in a lot of different ways, and in any location you choose.</span></span> <span data-ttu-id="1a47e-133">Jest to najłatwiejsza metoda do tworzenia skryptów w ramach rozwiązania usługi w programie Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="1a47e-133">The easiest approach is to create the script within your solution in Visual Studio 2010.</span></span>

<span data-ttu-id="1a47e-134">**Aby utworzyć skrypt SQL**</span><span class="sxs-lookup"><span data-stu-id="1a47e-134">**To create a SQL script**</span></span>

1. <span data-ttu-id="1a47e-135">W **Eksploratora rozwiązań** oknie rozwinięciu węzła projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-135">In the **Solution Explorer** window, expand your database project node.</span></span>
2. <span data-ttu-id="1a47e-136">Kliknij prawym przyciskiem myszy **skrypty** folderu, wskaż **Dodaj**, a następnie kliknij przycisk **nowy Folder**.</span><span class="sxs-lookup"><span data-stu-id="1a47e-136">Right-click the **Scripts** folder, point to **Add**, and then click **New Folder**.</span></span>
3. <span data-ttu-id="1a47e-137">Typ **testu** jako nazwa folderu, a następnie naciśnij klawisz Enter.</span><span class="sxs-lookup"><span data-stu-id="1a47e-137">Type **Test** as the folder name, and then press Enter.</span></span>
4. <span data-ttu-id="1a47e-138">Kliknij prawym przyciskiem myszy **testu** folderu, wskaż **Dodaj**, a następnie kliknij przycisk **skryptu**.</span><span class="sxs-lookup"><span data-stu-id="1a47e-138">Right-click the **Test** folder, point to **Add**, and then click **Script**.</span></span>
5. <span data-ttu-id="1a47e-139">W **Dodaj nowy element** okna dialogowego pole, nadaj nazwę opisową skryptu (na przykład **AddRoleMemberships.sql**), a następnie kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="1a47e-139">In the **Add New Item** dialog box, give your script a meaningful name (for example, **AddRoleMemberships.sql**), and then click **Add**.</span></span>

    ![](deploying-database-role-memberships-to-test-environments/_static/image1.png)
6. <span data-ttu-id="1a47e-140">W *AddRoleMemberships.sql* plików, Dodawanie instrukcji języka Transact-SQL:</span><span class="sxs-lookup"><span data-stu-id="1a47e-140">In the *AddRoleMemberships.sql* file, add Transact-SQL statements that:</span></span>

    1. <span data-ttu-id="1a47e-141">Utwórz użytkownika bazy danych dla identyfikatora logowania programu SQL Server, który będzie miał dostęp bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-141">Create a database user for the SQL Server login that will access your database.</span></span>
    2. <span data-ttu-id="1a47e-142">Dodaj użytkownika bazy danych do żadnej roli wymaganej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-142">Add the database user to any required database roles.</span></span>
7. <span data-ttu-id="1a47e-143">Plik powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="1a47e-143">The file should resemble this:</span></span>

    [!code-sql[Main](deploying-database-role-memberships-to-test-environments/samples/sample1.sql)]
8. <span data-ttu-id="1a47e-144">Zapisz plik.</span><span class="sxs-lookup"><span data-stu-id="1a47e-144">Save the file.</span></span>

## <a name="executing-the-script-on-the-target-database"></a><span data-ttu-id="1a47e-145">Wykonanie skryptu do docelowej bazy danych</span><span class="sxs-lookup"><span data-stu-id="1a47e-145">Executing the Script on the Target Database</span></span>

<span data-ttu-id="1a47e-146">W idealnym przypadku należy uruchomić wszystkie wymagane skrypty języka Transact-SQL w ramach skryptu powdrożeniowego podczas wdrażania projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-146">Ideally, you'd run any required Transact-SQL scripts as part of a post-deployment script when you deploy your database project.</span></span> <span data-ttu-id="1a47e-147">Jednak skrypty powdrożeniowe nie pozwalają na wykonywanie logiki warunkowe na podstawie konfiguracje rozwiązania lub właściwości kompilacji.</span><span class="sxs-lookup"><span data-stu-id="1a47e-147">However, post-deployment scripts don't allow you to execute logic conditionally based on solution configurations or build properties.</span></span> <span data-ttu-id="1a47e-148">Alternatywą jest uruchamiać skrypty SQL bezpośrednio w pliku projektu MSBuild, tworząc **docelowej** element, który wykonuje polecenie sqlcmd.exe.</span><span class="sxs-lookup"><span data-stu-id="1a47e-148">The alternative is to run your SQL scripts directly from the MSBuild project file, by creating a **Target** element that executes a sqlcmd.exe command.</span></span> <span data-ttu-id="1a47e-149">Można użyć tego polecenia, aby uruchomić skrypt do docelowej bazy danych:</span><span class="sxs-lookup"><span data-stu-id="1a47e-149">You can use this command to run your script on the target database:</span></span>

[!code-console[Main](deploying-database-role-memberships-to-test-environments/samples/sample2.cmd)]

> [!NOTE]
> <span data-ttu-id="1a47e-150">Aby uzyskać więcej informacji na temat opcji wiersza polecenia sqlcmd, zobacz [Narzędzie sqlcmd](https://msdn.microsoft.com/library/ms162773.aspx).</span><span class="sxs-lookup"><span data-stu-id="1a47e-150">For more information on sqlcmd command-line options, see [sqlcmd Utility](https://msdn.microsoft.com/library/ms162773.aspx).</span></span>

<span data-ttu-id="1a47e-151">Zanim to polecenie można osadzić w obiekt docelowy programu MSBuild, należy wziąć pod uwagę pod jakimi warunkami ma skrypt do uruchomienia:</span><span class="sxs-lookup"><span data-stu-id="1a47e-151">Before you embed this command in an MSBuild target, you need to consider under what conditions you want the script to run:</span></span>

- <span data-ttu-id="1a47e-152">Docelowa baza danych musi istnieć przed zmianą jego członkostwa w roli.</span><span class="sxs-lookup"><span data-stu-id="1a47e-152">The target database must exist before you change its role memberships.</span></span> <span data-ttu-id="1a47e-153">Jako takie, musisz uruchomić ten skrypt *po* wdrożenie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-153">As such, you need to run this script *after* the database deployment.</span></span>
- <span data-ttu-id="1a47e-154">Musisz obejmują warunku, dlatego, że skrypt jest wykonywane tylko dla środowisk testowych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-154">You need to include a condition so that the script is only executed for test environments.</span></span>
- <span data-ttu-id="1a47e-155">Jeśli korzystasz z wdrożenia "what if"&#x2014;innymi słowy, jeśli masz generowania skryptów wdrażania, ale nie uruchomione ich&#x2014;nie należy uruchomić skrypt SQL.</span><span class="sxs-lookup"><span data-stu-id="1a47e-155">If you're running a "what if" deployment&#x2014;in other words, if you're generating deployment scripts but not actually running them&#x2014;you shouldn't run the SQL script.</span></span>

<span data-ttu-id="1a47e-156">Jeśli używasz podziału podejście pliku projektu, opisane w [objaśnienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), jak pokazano w przykładowe rozwiązanie Contact Manager, można podzielić instrukcje kompilacji skryptu SQL następująco:</span><span class="sxs-lookup"><span data-stu-id="1a47e-156">If you're using the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), as demonstrated by the Contact Manager sample solution, you can split the build instructions for your SQL script like this:</span></span>

- <span data-ttu-id="1a47e-157">Wszystkie wymagane właściwości specyficzne dla środowiska, wraz z właściwość, która określa, czy mają zostać wdrożone uprawnień, należy go w pliku projektu specyficznymi dla środowiska (na przykład *Env Dev.proj*).</span><span class="sxs-lookup"><span data-stu-id="1a47e-157">Any required environment-specific properties, together with the property that determines whether to deploy permissions, should go in the environment-specific project file (for example, *Env-Dev.proj*).</span></span>
- <span data-ttu-id="1a47e-158">Element docelowy programu MSBuild, wraz z dowolnej właściwości, które nie zmieni się między środowiskami docelowy powinien przeprowadzić w pliku projektu uniwersalnej (na przykład *Publish.proj*).</span><span class="sxs-lookup"><span data-stu-id="1a47e-158">The MSBuild target itself, together with any properties that will not change between destination environments, should go in the universal project file (for example, *Publish.proj*).</span></span>

<span data-ttu-id="1a47e-159">W pliku projektu specyficznymi dla środowiska należy zdefiniować nazwę serwera bazy danych, nazwa docelowej bazy danych i właściwość typu Boolean, która umożliwia użytkownikowi określenie, czy mają zostać wdrożone członkostwa w roli.</span><span class="sxs-lookup"><span data-stu-id="1a47e-159">In the environment-specific project file, you need to define the database server name, the target database name, and a Boolean property that lets the user specify whether to deploy role memberships.</span></span>

[!code-xml[Main](deploying-database-role-memberships-to-test-environments/samples/sample3.xml)]

<span data-ttu-id="1a47e-160">W pliku projektu uniwersalnej należy podać lokalizację pliku wykonywalnym sqlcmd i lokalizację skryptu SQL, który chcesz uruchomić.</span><span class="sxs-lookup"><span data-stu-id="1a47e-160">In the universal project file, you need to provide the location of the sqlcmd executable and the location of the SQL script you want to run.</span></span> <span data-ttu-id="1a47e-161">Te właściwości pozostaną takie same, niezależnie od tego, w środowisku docelowym.</span><span class="sxs-lookup"><span data-stu-id="1a47e-161">These properties will remain the same regardless of the destination environment.</span></span> <span data-ttu-id="1a47e-162">Należy również utworzyć obiekt docelowy programu MSBuild do wykonania polecenia sqlcmd.</span><span class="sxs-lookup"><span data-stu-id="1a47e-162">You also need to create an MSBuild target to execute the sqlcmd command.</span></span>

[!code-xml[Main](deploying-database-role-memberships-to-test-environments/samples/sample4.xml)]

<span data-ttu-id="1a47e-163">Zwróć uwagę, Dodaj lokalizację pliku wykonywalnym sqlcmd jako właściwość statyczna, ponieważ może to być przydatne do innych celów.</span><span class="sxs-lookup"><span data-stu-id="1a47e-163">Notice that you add the location of the sqlcmd executable as a static property, as this could be useful to other targets.</span></span> <span data-ttu-id="1a47e-164">Z kolei należy zdefiniować lokalizację skryptu SQL i składnia polecenia sqlcmd jako właściwości dynamicznych w ciągu docelowym, ponieważ nie będą wymagane przed docelowy jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="1a47e-164">In contrast, you define the location of your SQL script and the syntax of the sqlcmd command as dynamic properties within the target, as they will not be required before the target is executed.</span></span> <span data-ttu-id="1a47e-165">W tym przypadku **DeployTestDBPermissions** docelowy będzie można wykonać tylko, jeśli te warunki są spełnione:</span><span class="sxs-lookup"><span data-stu-id="1a47e-165">In this case, the **DeployTestDBPermissions** target will only be executed if these conditions are met:</span></span>

- <span data-ttu-id="1a47e-166">**DeployTestDBRoleMemberships** właściwość jest ustawiona na **true**.</span><span class="sxs-lookup"><span data-stu-id="1a47e-166">The **DeployTestDBRoleMemberships** property is set to **true**.</span></span>
- <span data-ttu-id="1a47e-167">Użytkownik nie określił **WhatIf = true** flagi.</span><span class="sxs-lookup"><span data-stu-id="1a47e-167">The user hasn't specified a **WhatIf=true** flag.</span></span>

<span data-ttu-id="1a47e-168">Na koniec nie zapomnij wywołać element docelowy.</span><span class="sxs-lookup"><span data-stu-id="1a47e-168">Finally, don't forget to invoke the target.</span></span> <span data-ttu-id="1a47e-169">W *Publish.proj* pliku, można to zrobić, dodając element docelowy do listy zależności dla domyślnej **FullPublish** docelowej.</span><span class="sxs-lookup"><span data-stu-id="1a47e-169">In the *Publish.proj* file, you can do this by adding the target to the dependency list for the default **FullPublish** target.</span></span> <span data-ttu-id="1a47e-170">Należy upewnić się, że **DeployTestDBPermissions** docelowy nie jest wykonywany do momentu **PublishDbPackages** został on wykonany.</span><span class="sxs-lookup"><span data-stu-id="1a47e-170">You need to ensure that the **DeployTestDBPermissions** target is not executed until the **PublishDbPackages** target has been executed.</span></span>

[!code-xml[Main](deploying-database-role-memberships-to-test-environments/samples/sample5.xml)]

## <a name="conclusion"></a><span data-ttu-id="1a47e-171">Wniosek</span><span class="sxs-lookup"><span data-stu-id="1a47e-171">Conclusion</span></span>

<span data-ttu-id="1a47e-172">W tym temacie opisano jeden ze sposobów, w którym można dodać użytkowników bazy danych i członkostwo w rolach jako akcję powdrożeniową podczas wdrażania projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-172">This topic described one way in which you can add database users and role memberships as a post-deployment action when you deploy a database project.</span></span> <span data-ttu-id="1a47e-173">Jest to zazwyczaj przydatne w przypadku, gdy regularnie ponownie utworzyć bazę danych w środowisku testowym, ale należy ich unikać zazwyczaj, gdy wdrażanie baz danych w środowiskach przejściowych lub produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="1a47e-173">This is typically useful when you regularly re-create a database in a test environment, but it should usually be avoided when you deploy databases to staging or production environments.</span></span> <span data-ttu-id="1a47e-174">Jako takie należy upewnić się, że używasz niezbędne logikę warunkową tak, aby użytkownicy bazy danych i członkostwo w rolach są tworzone tylko moment jest właściwy to zrobić.</span><span class="sxs-lookup"><span data-stu-id="1a47e-174">As such, you should ensure that you use the necessary conditional logic so that database users and role memberships are only created when it's appropriate to do so.</span></span>

## <a name="further-reading"></a><span data-ttu-id="1a47e-175">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="1a47e-175">Further Reading</span></span>

<span data-ttu-id="1a47e-176">Aby uzyskać więcej informacji na temat używania VSDBCMD wdrażania projektów bazy danych, zobacz [wdrażanie projektów baz danych](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="1a47e-176">For more information on using VSDBCMD to deploy database projects, see [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span> <span data-ttu-id="1a47e-177">Aby uzyskać wskazówki dotyczące Dostosowywanie wdrożeń bazy danych dla środowisk inną docelową, zobacz [Dostosowywanie wdrożeń bazy danych dla wielu środowisk](customizing-database-deployments-for-multiple-environments.md).</span><span class="sxs-lookup"><span data-stu-id="1a47e-177">For guidance on customizing database deployments for different target environments, see [Customizing Database Deployments for Multiple Environments](customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="1a47e-178">Aby uzyskać więcej informacji na temat korzystania z niestandardowych plików projektu MSBuild do kontrolowania procesu wdrażania, zobacz [objaśnienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md) i [objaśnienie procesu kompilacji](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="1a47e-178">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span> <span data-ttu-id="1a47e-179">Aby uzyskać więcej informacji na temat opcji wiersza polecenia sqlcmd, zobacz [Narzędzie sqlcmd](https://msdn.microsoft.com/library/ms162773.aspx).</span><span class="sxs-lookup"><span data-stu-id="1a47e-179">For more information on sqlcmd command-line options, see [sqlcmd Utility](https://msdn.microsoft.com/library/ms162773.aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1a47e-180">[Poprzednie](customizing-database-deployments-for-multiple-environments.md)
> [dalej](deploying-membership-databases-to-enterprise-environments.md)</span><span class="sxs-lookup"><span data-stu-id="1a47e-180">[Previous](customizing-database-deployments-for-multiple-environments.md)
[Next](deploying-membership-databases-to-enterprise-environments.md)</span></span>
