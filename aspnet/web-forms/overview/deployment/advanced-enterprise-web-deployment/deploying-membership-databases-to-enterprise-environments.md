---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
title: Wdrażanie baz danych członkostwa w środowiskach korporacyjnych | Microsoft Docs
author: jrjlee
description: W tym temacie wyjaśniono kluczowe zagadnienia i wyzwania, które należy wziąć pod uwagę w przypadku udostępniania baz danych usług aplikacji ASP.NET (części wspólną...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 3cf765df-d311-4f68-a295-c9685ceea830
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
msc.type: authoredcontent
ms.openlocfilehash: 50f49af502b75aa5ad52756a76a5e7340aca53f7
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78526006"
---
# <a name="deploying-membership-databases-to-enterprise-environments"></a><span data-ttu-id="78a5b-103">Wdrażanie baz danych członkostwa w środowiskach przedsiębiorstw</span><span class="sxs-lookup"><span data-stu-id="78a5b-103">Deploying Membership Databases to Enterprise Environments</span></span>

<span data-ttu-id="78a5b-104">Autor [Jason Lewandowski](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="78a5b-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="78a5b-105">Pobierz plik PDF</span><span class="sxs-lookup"><span data-stu-id="78a5b-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="78a5b-106">W tym temacie wyjaśniono kluczowe zagadnienia i wyzwania, które należy wziąć pod uwagę podczas udostępniania baz danych usług aplikacji ASP.NET (nazywanych najczęściej bazami danych członkostwa) w środowiskach testowych, przejściowych lub produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-106">This topic explains the key considerations and challenges you'll need to overcome when you provision ASP.NET application services databases (more commonly referred to as membership databases) in test, staging, or production environments.</span></span> <span data-ttu-id="78a5b-107">Opisano w nim również podejścia, których można użyć w celu spełnienia tych wyzwań.</span><span class="sxs-lookup"><span data-stu-id="78a5b-107">It also describes approaches you can use to meet these challenges.</span></span>

<span data-ttu-id="78a5b-108">Ten temat stanowi część szeregu samouczków opartych na wymaganiach dotyczących wdrażania w przedsiębiorstwie fikcyjnej firmy o nazwie Fabrikam, Inc. W tej serii samouczków jest stosowane&#x2014;przykładowe rozwiązanie&#x2014;do reprezentowania aplikacji sieci Web, [które ma](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)realistyczny poziom złożoności, w tym aplikacji ASP.NET MVC 3, usługi Windows Communication Foundation (WCF) i projektu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="78a5b-109">Metoda wdrażania w tym samouczku jest oparta na rozłożeniu pliku projektu dzielonego opisanym w artykule [Omówienie pliku projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), w którym proces kompilacji jest kontrolowany przez dwa pliki&#x2014;projektu, zawierający instrukcje kompilacji, które mają zastosowanie do każdego środowiska docelowego, oraz jeden zawierający ustawienia kompilacji i wdrożenia specyficznego dla środowiska.</span><span class="sxs-lookup"><span data-stu-id="78a5b-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="78a5b-110">W czasie kompilacji plik projektu specyficzny dla środowiska jest scalany z plikiem projektu Environment-niezależny od w celu utworzenia kompletnego zestawu instrukcji kompilacji.</span><span class="sxs-lookup"><span data-stu-id="78a5b-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="what-are-the-issues-when-you-deploy-a-membership-database"></a><span data-ttu-id="78a5b-111">Jakie problemy występują podczas wdrażania bazy danych członkostwa?</span><span class="sxs-lookup"><span data-stu-id="78a5b-111">What Are the Issues When You Deploy a Membership Database?</span></span>

<span data-ttu-id="78a5b-112">W większości przypadków podczas opracowywania strategii wdrażania bazy danych najpierw należy rozważyć, jakie dane mają zostać wdrożone.</span><span class="sxs-lookup"><span data-stu-id="78a5b-112">In most cases, when you devise a deployment strategy for a database, the first thing you need to consider is what data you want to deploy.</span></span> <span data-ttu-id="78a5b-113">W środowisku deweloperskim lub testowym można wdrożyć dane konta użytkownika w celu ułatwienia szybkiego i łatwego testowania.</span><span class="sxs-lookup"><span data-stu-id="78a5b-113">In a development or test environment, you might want to deploy user account data to facilitate quick and easy testing.</span></span> <span data-ttu-id="78a5b-114">W środowisku przejściowym lub produkcyjnym bardzo mało prawdopodobne jest, że chcesz wdrożyć dane konta użytkownika.</span><span class="sxs-lookup"><span data-stu-id="78a5b-114">In a staging or production environment, it's very unlikely that you'd want to deploy user account data.</span></span>

<span data-ttu-id="78a5b-115">Niestety, ASP.NET bazy danych członkostwa zawierają pewne konkretne wyzwania, które czynią tę decyzję znacznie bardziej skomplikowaną:</span><span class="sxs-lookup"><span data-stu-id="78a5b-115">Unfortunately, ASP.NET membership databases introduce some specific challenges that make this decision a lot more complex:</span></span>

- <span data-ttu-id="78a5b-116">Wdrożenie tylko do schematu spowoduje pozostawienie bazy danych członkostwa w stanie nieoperacyjnym.</span><span class="sxs-lookup"><span data-stu-id="78a5b-116">A schema-only deployment will leave the membership database in a non-operational state.</span></span> <span data-ttu-id="78a5b-117">Wynika to z faktu, że baza danych członkostwa zawiera dane konfiguracji (w tabeli **aspnet\_SchemaVersions** ), które są wymagane do działania bazy danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-117">This is because the membership database includes some configuration data (in the **aspnet\_SchemaVersions** table) that the database requires in order to function.</span></span> <span data-ttu-id="78a5b-118">W związku z tym w przypadku wykonywania wdrożenia tylko schematu bazy danych członkostwa w celu wykluczania danych konta użytkownika należy uruchomić skrypt po wdrożeniu, aby dodać podstawowe dane konfiguracyjne.</span><span class="sxs-lookup"><span data-stu-id="78a5b-118">As such, if you perform a schema-only deployment of your membership database in order to exclude user account data, you'll need to run a post-deployment script to add the essential configuration data.</span></span>
- <span data-ttu-id="78a5b-119">W zależności od sposobu skonfigurowania bazy danych członkostwa dostawca członkostwa może użyć klucza komputera do szyfrowania haseł i przechowywania ich w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-119">Depending on how your membership database is configured, the membership provider may use the machine key to encrypt passwords and store them in the database.</span></span> <span data-ttu-id="78a5b-120">W takim przypadku wszystkie dane konta użytkownika wdrażane za pomocą bazy danych staną się niedostępne na serwerze docelowym.</span><span class="sxs-lookup"><span data-stu-id="78a5b-120">In this case, any user account data you deploy with the database will become unusable on the destination server.</span></span> <span data-ttu-id="78a5b-121">Z tego powodu wdrażanie danych konta użytkownika nie jest obsługiwanym scenariuszem.</span><span class="sxs-lookup"><span data-stu-id="78a5b-121">For this reason, deploying user account data is not a supported scenario.</span></span>

## <a name="choosing-a-membership-database-strategy"></a><span data-ttu-id="78a5b-122">Wybieranie strategii bazy danych członkostwa</span><span class="sxs-lookup"><span data-stu-id="78a5b-122">Choosing a Membership Database Strategy</span></span>

<span data-ttu-id="78a5b-123">Te wskazówki należy stosować podczas wybierania sposobu aprowizacji bazy danych członkostwa w środowisku serwera przedsiębiorstwa:</span><span class="sxs-lookup"><span data-stu-id="78a5b-123">Use these guidelines when you choose how to provision a membership database in an enterprise server environment:</span></span>

- <span data-ttu-id="78a5b-124">Gdy jest to możliwe, nie należy wdrażać baz danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="78a5b-124">Wherever possible, do not deploy membership databases.</span></span> <span data-ttu-id="78a5b-125">Zamiast tego Utwórz bazę danych członkostwa ręcznie na docelowym serwerze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-125">Instead, create the membership database manually on the target database server.</span></span> <span data-ttu-id="78a5b-126">Jeśli schemat bazy danych członkostwa nie został dostosowany, można po prostu utworzyć nowe miejsce w miejscu docelowym przy użyciu [narzędzia rejestracji SQL Server ASP.NET (aspnet\_regsql. exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-126">If you haven't customized your membership database schema, you can simply create a new one in situ at the destination using the [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span>
- <span data-ttu-id="78a5b-127">Jeśli nie ma opcji, ale do wdrożenia bazy danych&#x2014;członkostwa na przykład, jeśli wprowadzono liczne modyfikacje schematu&#x2014;bazy danych, należy wykonać wdrożenie tylko do schematu bazy danych członkostwa, aby wykluczyć dane konta użytkownika, a następnie uruchomić skrypt po wdrożeniu w celu dodania wymaganych danych konfiguracyjnych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-127">If you have no option but to deploy a membership database&#x2014;for example, if you've made extensive modifications to the database schema&#x2014;you should perform a schema-only deployment of the membership database, to exclude user account data, and then run a post-deployment script to add any required configuration data.</span></span> <span data-ttu-id="78a5b-128">Wskazówki dotyczące tych metod można znaleźć w następujących [tematach: Wdrażanie bazy danych ASP.NET Membership bez uwzględnienia kont użytkowników](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-128">You can find broad guidance on these approaches in [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

<span data-ttu-id="78a5b-129">Należy pamiętać, że *schemat bazy danych członkostwa może być dość statyczny*.</span><span class="sxs-lookup"><span data-stu-id="78a5b-129">It's important to remember that *the schema of your membership database is likely to be fairly static*.</span></span> <span data-ttu-id="78a5b-130">Nawet jeśli dostosowano bazę danych członkostwa, nie jest mało prawdopodobne, że należy zaktualizować schemat regularnie,&#x2014;ale nie będzie on zmieniany z taką samą częstotliwością jak kod w aplikacji sieci Web lub projekt bazy danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-130">Even if you've customized the membership database, it's unlikely that you'll need to update the schema on a regular basis&#x2014;it's not going to change with the same frequency as the code in a web application or a database project.</span></span> <span data-ttu-id="78a5b-131">W związku z tym nie trzeba uwzględniać bazy danych członkostwa w żadnym zautomatyzowanym lub jednoetapowym procesie wdrażania.</span><span class="sxs-lookup"><span data-stu-id="78a5b-131">As such, you shouldn't need to include the membership database in any automated or single-step deployment processes.</span></span>

## <a name="using-vsdbcmd-to-update-a-membership-database-schema"></a><span data-ttu-id="78a5b-132">Aktualizowanie schematu bazy danych członkostwa przy użyciu VSDBCMD</span><span class="sxs-lookup"><span data-stu-id="78a5b-132">Using VSDBCMD to Update a Membership Database Schema</span></span>

<span data-ttu-id="78a5b-133">Jeśli zmodyfikujesz strukturę bazy danych członkostwa po pierwszym wdrożeniu, możesz nie chcieć używać narzędzia do wdrażania w sieci Web (Web Deploy) Internet Information Services (IIS), aby ponownie wdrożyć bazę danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-133">If you modify the structure of your membership database after your first deployment, you may not want to use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to redeploy the database.</span></span> <span data-ttu-id="78a5b-134">Funkcja wdrażania bazy danych w Web Deploy nie obejmuje możliwości wprowadzania różnicowych aktualizacji do docelowej bazy danych&#x2014;, Web Deploy musi porzucić i ponownie utworzyć bazę danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-134">The database deployment functionality in Web Deploy doesn't include the capability to make differential updates to a destination database&#x2014;instead, Web Deploy must drop and re-create the database.</span></span> <span data-ttu-id="78a5b-135">Oznacza to utratę wszelkich istniejących danych konta użytkownika, które zwykle są niepożądane w środowisku przejściowym lub produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="78a5b-135">This means that you lose any existing user account data, which is typically undesirable in staging or production environments.</span></span>

<span data-ttu-id="78a5b-136">Alternatywą jest użycie narzędzia VSDBCMD w celu zaktualizowania schematu docelowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-136">The alternative is to use the VSDBCMD utility to update the schema of your destination database.</span></span> <span data-ttu-id="78a5b-137">VSDBCMD obejmuje dwie ważne funkcje.</span><span class="sxs-lookup"><span data-stu-id="78a5b-137">VSDBCMD includes two important capabilities.</span></span> <span data-ttu-id="78a5b-138">Najpierw można zaimportować schemat istniejącej bazy danych do pliku. DbSchema.</span><span class="sxs-lookup"><span data-stu-id="78a5b-138">First, it can import the schema of an existing database into a .dbschema file.</span></span> <span data-ttu-id="78a5b-139">Następnie może wdrożyć plik. DbSchema w istniejącej bazie danych jako aktualizację różnicową, co oznacza, że tylko zmiany wymagane do przeprowadzenia aktualnej docelowej bazy danych i nie zostaną utracone żadne dane.</span><span class="sxs-lookup"><span data-stu-id="78a5b-139">Second, it can deploy a .dbschema file to an existing database as a differential update, which means that it only makes the changes required to bring the target database up to date and you don't lose any data.</span></span>

<span data-ttu-id="78a5b-140">Aby zaktualizować schemat bazy danych członkostwa, można użyć tych kroków wysokiego poziomu:</span><span class="sxs-lookup"><span data-stu-id="78a5b-140">You can use these high-level steps to update a membership database schema:</span></span>

1. <span data-ttu-id="78a5b-141">Użyj akcji **importu** VSDBCMD, aby wygenerować plik. DbSchema dla źródłowej bazy danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="78a5b-141">Use the VSDBCMD **Import** action to generate a .dbschema file for your source membership database.</span></span> <span data-ttu-id="78a5b-142">Ta procedura została opisana w artykule [jak: importowanie schematu z wiersza polecenia](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-142">This procedure is described in [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span>
2. <span data-ttu-id="78a5b-143">Użyj akcji **Wdróż** VSDBCMD, aby wdrożyć plik. DbSchema w docelowej bazie danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="78a5b-143">Use the VSDBCMD **Deploy** action to deploy the .dbschema file to your destination membership database.</span></span> <span data-ttu-id="78a5b-144">Ta procedura jest opisana w [wierszu polecenia Reference for VSDBCMD. EXE (wdrożenie i importowanie schematu)](https://msdn.microsoft.com/library/dd193283.aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-144">This procedure is described in [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="78a5b-145">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="78a5b-145">Conclusion</span></span>

<span data-ttu-id="78a5b-146">W tym temacie opisano niektóre problemy, które mogą wystąpić w przypadku konieczności aprowizacji baz danych członkostwa ASP.NET w różnych środowiskach docelowych.</span><span class="sxs-lookup"><span data-stu-id="78a5b-146">This topic described some of the challenges you may face when you need to provision ASP.NET membership databases in various target environments.</span></span> <span data-ttu-id="78a5b-147">W szczególności wyjaśniono, dlaczego wdrożenia tylko do schematu pozostawiają bazę danych członkostwa w stanie nieoperacyjnym i dlaczego wdrażanie danych konta użytkownika nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="78a5b-147">In particular, it explained why schema-only deployments will leave the membership database in a non-operational state and why deploying user account data is not supported.</span></span> <span data-ttu-id="78a5b-148">Temat zawiera również wskazówki dotyczące udostępniania, wdrażania i aktualizowania baz danych członkostwa w różnych scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="78a5b-148">The topic also presented guidance on how to provision, deploy, and update membership databases in different scenarios.</span></span>

## <a name="further-reading"></a><span data-ttu-id="78a5b-149">Dalsze informacje</span><span class="sxs-lookup"><span data-stu-id="78a5b-149">Further Reading</span></span>

<span data-ttu-id="78a5b-150">Aby uzyskać więcej wskazówek i przykłady korzystania z VSDBCMD, zobacz [informacje dotyczące wiersza polecenia dla VSDBCMD. EXE (wdrożenie i importowanie schematu)](https://msdn.microsoft.com/library/dd193283.aspx) i [instrukcje: importowanie schematu z wiersza polecenia](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-150">For more guidance and examples of how to use VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span> <span data-ttu-id="78a5b-151">Aby uzyskać więcej informacji na temat używania ASPNET\_regsql. exe do tworzenia baz danych członkostwa, zobacz [ASP.NET SQL Server Registration Tool (aspnet\_regsql. exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-151">For more information on using aspnet\_regsql.exe to create membership databases, see [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span> <span data-ttu-id="78a5b-152">Aby uzyskać ogólne wskazówki dotyczące wdrażania baz danych członkostwa, zobacz [How to: Deploy the ASP.NET Membership Database bez uwzględnienia kont użytkowników](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="78a5b-152">For more general guidance on deploying membership databases, see [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="78a5b-153">[Poprzednie](deploying-database-role-memberships-to-test-environments.md)
> [dalej](excluding-files-and-folders-from-deployment.md)</span><span class="sxs-lookup"><span data-stu-id="78a5b-153">[Previous](deploying-database-role-memberships-to-test-environments.md)
[Next](excluding-files-and-folders-from-deployment.md)</span></span>
