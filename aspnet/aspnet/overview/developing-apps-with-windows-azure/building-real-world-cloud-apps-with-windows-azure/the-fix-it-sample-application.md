---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/the-fix-it-sample-application
title: 'Załącznik: Poprawka przykładowy Application (Tworzenie aplikacji w chmurze w rzeczywistych warunkach Dzięki platformie Azure) | Dokumentacja firmy Microsoft'
author: MikeWasson
description: Tworzenie rzeczywistych aplikacji w chmurze za pomocą platformy Azure Książka elektroniczna jest oparta na prezentacji, opracowane przez Scotta Guthrie. Wyjaśniono 13 wzorców i praktyk, które może on...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 1bc333c5-f096-4ea7-b170-779accc21c1a
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/the-fix-it-sample-application
msc.type: authoredcontent
ms.openlocfilehash: de3c8ea29f2c271136f58d8165bb92f4ab28ce83
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57068885"
---
<a name="appendix-the-fix-it-sample-application-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="8d391-104">Załącznik: Poprawka przykładowy Application (Tworzenie aplikacji w chmurze w rzeczywistych warunkach Dzięki platformie Azure)</span><span class="sxs-lookup"><span data-stu-id="8d391-104">Appendix: The Fix It Sample Application (Building Real-World Cloud Apps with Azure)</span></span>
====================
<span data-ttu-id="8d391-105">przez [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="8d391-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="8d391-106">Pobierz poprawkę go projektu</span><span class="sxs-lookup"><span data-stu-id="8d391-106">Download The Fix It Project</span></span>](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)

> <span data-ttu-id="8d391-107">**Tworzenie rzeczywistych aplikacji w chmurze dzięki platformie Azure** Książka elektroniczna jest oparta na prezentacji opracowany przez Scotta Guthrie.</span><span class="sxs-lookup"><span data-stu-id="8d391-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="8d391-108">Wyjaśniono 13 wzorców i praktyk, które mogą pomóc Ci odnieść sukces, tworzenie aplikacji sieci web w chmurze.</span><span class="sxs-lookup"><span data-stu-id="8d391-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="8d391-109">Aby uzyskać informacji o książce elektronicznej, zobacz [pierwszy rozdział](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="8d391-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="8d391-110">Ten dodatek do tworzenia rzeczywistych aplikacji w chmurze za pomocą platformy Azure e-book, zawiera następujące sekcje, które zapewniają dodatkowe informacje na temat rozwiązać go przykładową aplikację, którą można pobrać:</span><span class="sxs-lookup"><span data-stu-id="8d391-110">This appendix to the Building Real World Cloud Apps with Azure e-book contains the following sections that provide additional information about the Fix It sample application that you can download:</span></span>

- [<span data-ttu-id="8d391-111">Znane problemy</span><span class="sxs-lookup"><span data-stu-id="8d391-111">Known issues</span></span>](#knownissues)
- [<span data-ttu-id="8d391-112">Najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="8d391-112">Best practices</span></span>](#bestpractices)
- [<span data-ttu-id="8d391-113">Jak uruchomić aplikację w programie Visual Studio na komputerze lokalnym</span><span class="sxs-lookup"><span data-stu-id="8d391-113">How to run the app from Visual Studio on your local computer</span></span>](#run-in-vs)
- [<span data-ttu-id="8d391-114">Sposób wdrażania podstawowej aplikacji w usłudze Azure App Service Web Apps za pomocą skryptów środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d391-114">How to deploy the base app to Azure App Service Web Apps by using the Windows PowerShell scripts</span></span>](#deploybase)
- [<span data-ttu-id="8d391-115">Rozwiązywanie problemów z skryptów programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d391-115">Troubleshooting the Windows PowerShell scripts</span></span>](#troubleshooting)
- [<span data-ttu-id="8d391-116">Jak wdrożyć aplikację za pomocą kolejki przetwarzania do usługi Azure App Service Web Apps i usługi w chmurze platformy Azure</span><span class="sxs-lookup"><span data-stu-id="8d391-116">How to deploy the app with queue processing to Azure App Service Web Apps and an Azure Cloud Service</span></span>](#deployqueues)

<a id="knownissues"></a>
## <a name="known-issues"></a><span data-ttu-id="8d391-117">Znane problemy</span><span class="sxs-lookup"><span data-stu-id="8d391-117">Known issues</span></span>

<span data-ttu-id="8d391-118">Aplikacja naprawić pierwotnie został opracowany w celu zilustrowania ułatwianiu niektóre wzorce znajdujące się w tej książce elektronicznej.</span><span class="sxs-lookup"><span data-stu-id="8d391-118">The Fix It app was originally developed in order to illustrate as simply as possible some of the patterns presented in this e-book.</span></span> <span data-ttu-id="8d391-119">Jednak ponieważ książki elektronicznej dotyczących tworzenia aplikacji w rzeczywistych warunkach, firma Microsoft poddane kodu naprawić przeglądu i proces testowania, podobnie jak co możemy jak w przypadku wydania oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="8d391-119">However, since the e-book is about building real-world apps, we subjected the Fix It code to a review and testing process similar to what we'd do for released software.</span></span> <span data-ttu-id="8d391-120">Znaleźliśmy wiele problemów i podobnie jak w przypadku dowolnej aplikacji w rzeczywistych warunkach, niektóre z nich naprawiliśmy, a niektóre z nich, firma Microsoft odroczone do nowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="8d391-120">We found a number of issues, and as with any real-world application, some of them we fixed and some of them we deferred to a later release.</span></span>

<span data-ttu-id="8d391-121">Poniższa lista zawiera problemy, które powinny być kierowane w aplikacji produkcyjnej, ale w jednym z powodów lub innym, który firma zrezygnowała z adresu w początkowym wydaniu rozwiązać go przykładowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8d391-121">The following list includes issues that should be addressed in a production application, but for one reason or another we decided not to address in the initial release of the Fix It sample application.</span></span>

### <a name="security"></a><span data-ttu-id="8d391-122">Zabezpieczenia</span><span class="sxs-lookup"><span data-stu-id="8d391-122">Security</span></span>

- <span data-ttu-id="8d391-123">Upewnij się, że nie można przypisać zadanie do właściciela nieistniejące.</span><span class="sxs-lookup"><span data-stu-id="8d391-123">Ensure that you can't assign a task to a non-existent owner.</span></span>
- <span data-ttu-id="8d391-124">Upewnij się, że można jedynie wyświetlać i modyfikować zadania utworzone lub są przypisane do użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8d391-124">Ensure that you can only view and modify tasks that you created or are assigned to you.</span></span>
- <span data-ttu-id="8d391-125">Używać protokołu HTTPS dla stron logowania i pliki cookie uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="8d391-125">Use HTTPS for sign-in pages and authentication cookies.</span></span>
- <span data-ttu-id="8d391-126">Określ limit czasu plików cookie uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="8d391-126">Specify a time limit for authentication cookies.</span></span>

### <a name="input-validation"></a><span data-ttu-id="8d391-127">Walidacja danych wejściowych</span><span class="sxs-lookup"><span data-stu-id="8d391-127">Input validation</span></span>

<span data-ttu-id="8d391-128">Ogólnie rzecz biorąc, jak w aplikacji produkcyjnej weryfikacji więcej wejściowych niż aplikacja naprawić.</span><span class="sxs-lookup"><span data-stu-id="8d391-128">In general, a production app would do more input validation than the Fix It app.</span></span> <span data-ttu-id="8d391-129">Przykładowo rozmiar obrazu / image rozmiar pliku dozwolona w przypadku przekazywania powinny być ograniczone.</span><span class="sxs-lookup"><span data-stu-id="8d391-129">For example, the image size / image file size allowed for upload should be limited.</span></span>

### <a name="administrator-functionality"></a><span data-ttu-id="8d391-130">Administrator funkcji</span><span class="sxs-lookup"><span data-stu-id="8d391-130">Administrator functionality</span></span>

<span data-ttu-id="8d391-131">Administrator powinien móc zmienić własności dla istniejących zadań.</span><span class="sxs-lookup"><span data-stu-id="8d391-131">An administrator should be able to change ownership on existing tasks.</span></span> <span data-ttu-id="8d391-132">Na przykład osoba, która utworzyła zadanie może odejść z firmy, nie pozostawiając do dyspozycji urząd, aby obsługiwać zadania, jeśli nie włączono dostępu administracyjnego.</span><span class="sxs-lookup"><span data-stu-id="8d391-132">For example, the creator of a task might leave the company, leaving no one with authority to maintain the task unless administrative access is enabled.</span></span>

### <a name="queue-message-processing"></a><span data-ttu-id="8d391-133">Przetwarzanie komunikatów w kolejce</span><span class="sxs-lookup"><span data-stu-id="8d391-133">Queue message processing</span></span>

<span data-ttu-id="8d391-134">Kolejki przetwarzania komunikatów w aplikacji naprawić zostało zaprojektowane jako prosty, aby zilustrować wzorzec pracy skoncentrowany na kolejkach, za pomocą minimalnej ilości kodu.</span><span class="sxs-lookup"><span data-stu-id="8d391-134">Queue message processing in the Fix It app was designed to be simple in order to illustrate the queue-centric work pattern with a minimum amount of code.</span></span> <span data-ttu-id="8d391-135">Ten prosty kod nie będzie odpowiednia dla aplikacji rzeczywistej produkcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-135">This simple code would not be adequate for an actual production application.</span></span>

- <span data-ttu-id="8d391-136">Kod nie gwarantuje co najwyżej raz przetwarzania każdego komunikatu w kolejce.</span><span class="sxs-lookup"><span data-stu-id="8d391-136">The code does not guarantee that each queue message will be processed at most once.</span></span> <span data-ttu-id="8d391-137">Gdy zostanie wyświetlony komunikat z kolejki, istnieje okres limitu czasu, przez który komunikat jest niewidoczne dla innych nasłuchujących kolejki.</span><span class="sxs-lookup"><span data-stu-id="8d391-137">When you get a message from the queue, there is a timeout period, during which the message is invisible to other queue listeners.</span></span> <span data-ttu-id="8d391-138">Limit czasu upłynie, zanim komunikat jest usuwany, komunikat staje się widoczna ponownie.</span><span class="sxs-lookup"><span data-stu-id="8d391-138">If the timeout expires before the message is deleted, the message becomes visible again.</span></span> <span data-ttu-id="8d391-139">W związku z tym jeśli wystąpienie roli procesu roboczego spędzony przez długi czas przetwarzania komunikatu, użytkownik może teoretycznie dla tej samej wiadomości są przetwarzane dwa razy, skutkuje zduplikowane zadania w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-139">Therefore, if a worker role instance spends a long time processing a message, it is theoretically possible for the same message to get processed twice, resulting in a duplicate task in the database.</span></span> <span data-ttu-id="8d391-140">Aby uzyskać więcej informacji na temat tego problemu, zobacz [za pomocą kolejek usługi Azure Storage](https://msdn.microsoft.com/library/ff803365.aspx#sec7).</span><span class="sxs-lookup"><span data-stu-id="8d391-140">For more information about this issue, see [Using Azure Storage Queues](https://msdn.microsoft.com/library/ff803365.aspx#sec7).</span></span>
- <span data-ttu-id="8d391-141">Logika sondowania kolejki może być bardziej ekonomiczne, przetwarzanie wsadowe odebrania komunikatu.</span><span class="sxs-lookup"><span data-stu-id="8d391-141">The queue polling logic could be more cost-effective, by batching message retrieval.</span></span> <span data-ttu-id="8d391-142">Za każdym razem, gdy wywołujesz [CloudQueue.GetMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessageasync.aspx), istnieje koszt transakcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-142">Every time you call [CloudQueue.GetMessageAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessageasync.aspx), there is a transaction cost.</span></span> <span data-ttu-id="8d391-143">Zamiast tego możesz wywołać [CloudQueue.GetMessagesAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessagesasync.aspx) (należy pamiętać, plural "), która pobiera wiele komunikatów w ramach jednej transakcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-143">Instead, you can call [CloudQueue.GetMessagesAsync](https://msdn.microsoft.com/library/microsoft.windowsazure.storage.queue.cloudqueue.getmessagesasync.aspx) (note the plural 's'), which gets multiple messages in a single transaction.</span></span> <span data-ttu-id="8d391-144">Koszty transakcji dla kolejek usługi Azure Storage są bardzo niskie, więc nie jest istotne w większości przypadków negatywny wpływ na koszty.</span><span class="sxs-lookup"><span data-stu-id="8d391-144">The transaction costs for Azure Storage Queues are very low, so the impact on costs is not substantial in most scenarios.</span></span>
- <span data-ttu-id="8d391-145">Pętli w kodzie przetwarzanie komunikatów kolejki powoduje, że koligacje Procesora, który nie używa maszyn wirtualnych w wielordzeniowych wydajnie.</span><span class="sxs-lookup"><span data-stu-id="8d391-145">The tight loop in the queue message-processing code causes CPU affinity, which does not utilize multi-core VMs efficiently.</span></span> <span data-ttu-id="8d391-146">Projekt lepiej użyć równoległość zadań do równoległego uruchamiania wielu zadań asynchronicznych.</span><span class="sxs-lookup"><span data-stu-id="8d391-146">A better design would use task parallelism to run several async tasks in parallel.</span></span>
- <span data-ttu-id="8d391-147">Przetwarzanie komunikatów w kolejce ma tylko podstawowe wyjątków.</span><span class="sxs-lookup"><span data-stu-id="8d391-147">Queue message-processing has only rudimentary exception handling.</span></span> <span data-ttu-id="8d391-148">Na przykład, kod nie obsługuje [skażonymi komunikatami](https://msdn.microsoft.com/library/ms789028.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-148">For example, the code doesn't handle [poison messages](https://msdn.microsoft.com/library/ms789028.aspx).</span></span> <span data-ttu-id="8d391-149">(Podczas przetwarzania komunikatu, powoduje wyjątek, będzie konieczne błąd i usuwanie wiadomości, lub roli procesu roboczego podejmie próbę przetwarzać go ponownie i pętli będzie kontynuowane bez ograniczenia czasowego.)</span><span class="sxs-lookup"><span data-stu-id="8d391-149">(When message processing causes an exception, you have to log the error and delete the message, or the worker role will try to process it again, and the loop will continue indefinitely.)</span></span>

### <a name="sql-queries-are-unbounded"></a><span data-ttu-id="8d391-150">Zapytania SQL są nieograniczone</span><span class="sxs-lookup"><span data-stu-id="8d391-150">SQL queries are unbounded</span></span>

<span data-ttu-id="8d391-151">Poprawka kod bieżącej umieszcza bez ograniczeń na liczbę wierszy, które może zwrócić zapytania dotyczące strony indeksu.</span><span class="sxs-lookup"><span data-stu-id="8d391-151">Current Fix It code places no limit on how many rows the queries for Index pages might return.</span></span> <span data-ttu-id="8d391-152">W przypadku dużej liczby zadań jest wprowadzany do bazy danych, rozmiar listy wynikowy otrzymane może spowodować problemy z wydajnością.</span><span class="sxs-lookup"><span data-stu-id="8d391-152">If a large volume of tasks is entered into the database, the size of the resulting lists received could cause performance issues.</span></span> <span data-ttu-id="8d391-153">To rozwiązanie jest implementowanie stronicowania.</span><span class="sxs-lookup"><span data-stu-id="8d391-153">The solution is to implement paging.</span></span> <span data-ttu-id="8d391-154">Aby uzyskać przykład, zobacz [sortowanie, filtrowanie i stronicowanie za pomocą programu Entity Framework w aplikacji ASP.NET MVC](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="8d391-154">For an example, see [Sorting, Filtering, and Paging with the Entity Framework in an ASP.NET MVC Application](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span></span>

### <a name="view-models-recommended"></a><span data-ttu-id="8d391-155">Wyświetl modele zalecane</span><span class="sxs-lookup"><span data-stu-id="8d391-155">View models recommended</span></span>

<span data-ttu-id="8d391-156">Aplikacja naprawić używa klasy jednostki FixItTask do przekazywania informacji między kontrolerem a widokiem.</span><span class="sxs-lookup"><span data-stu-id="8d391-156">The Fix It app uses the FixItTask entity class to pass information between the controller and the view.</span></span> <span data-ttu-id="8d391-157">Najlepszym rozwiązaniem jest używanie modeli w widoku.</span><span class="sxs-lookup"><span data-stu-id="8d391-157">A best practice is to use view models.</span></span> <span data-ttu-id="8d391-158">Model domeny (np. Klasa jednostki FixItTask) została zaprojektowana wokół co jest potrzebne do stanu trwałego danych, gdy model widoku można zaprojektować tak, aby obejrzeć prezentację danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-158">The domain model (e.g., the FixItTask entity class) is designed around what is needed for data persistence, while a view model can be designed for data presentation.</span></span> <span data-ttu-id="8d391-159">Aby uzyskać więcej informacji, zobacz [12 platformy ASP.NET MVC: najlepsze rozwiązania](http://codeclimber.net.nz/archive/2009/10/27/12-asp.net-mvc-best-practices.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-159">For more information, see [12 ASP.NET MVC Best Practices](http://codeclimber.net.nz/archive/2009/10/27/12-asp.net-mvc-best-practices.aspx).</span></span>

### <a name="secure-image-blob-recommended"></a><span data-ttu-id="8d391-160">Obiekt blob obrazu bezpieczny, zaleca się</span><span class="sxs-lookup"><span data-stu-id="8d391-160">Secure image blob recommended</span></span>

<span data-ttu-id="8d391-161">Napraw go sklepów z aplikacjami przekazane obrazy jako publiczne, co oznacza, że każda osoba, która znajdzie adres URL mają dostęp do obrazów.</span><span class="sxs-lookup"><span data-stu-id="8d391-161">The Fix It app stores uploaded images as public, meaning that anyone who finds the URL can access the images.</span></span> <span data-ttu-id="8d391-162">Obrazy może zostać zabezpieczony zamiast publicznego.</span><span class="sxs-lookup"><span data-stu-id="8d391-162">The images could be secured instead of public.</span></span>

### <a name="no-powershell-automation-scripts-for-queues"></a><span data-ttu-id="8d391-163">Brak skryptów automatyzacji programu PowerShell dla kolejek</span><span class="sxs-lookup"><span data-stu-id="8d391-163">No PowerShell automation scripts for queues</span></span>

<span data-ttu-id="8d391-164">Przykładowe skrypty automatyzacji programu PowerShell zostały napisane tylko w przypadku wersji podstawowy napraw go, uruchamiana całkowite w usłudze Azure App Service Web Apps.</span><span class="sxs-lookup"><span data-stu-id="8d391-164">Sample PowerShell automation scripts were written only for the base version of Fix It that runs entirely in Azure App Service Web Apps.</span></span> <span data-ttu-id="8d391-165">Firma Microsoft nie zapewniały skrypty do konfigurowania i wdrażania aplikacji sieci web oraz usługi w chmurze środowisko wymaganej do kolejki przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="8d391-165">We haven't provided scripts for setting up and deploying to the web app plus Cloud Service environment required for queue processing.</span></span>

### <a name="special-handling-for-html-codes-in-user-input"></a><span data-ttu-id="8d391-166">Specjalna obsługa kody HTML w danych wejściowych użytkownika</span><span class="sxs-lookup"><span data-stu-id="8d391-166">Special handling for HTML codes in user input</span></span>

<span data-ttu-id="8d391-167">Program ASP.NET automatycznie zapobiega wiele sposobów, w których złośliwych użytkowników może podejmować ataki z użyciem skryptów między witrynami, wprowadzając skryptu w polach tekstowych danych wejściowych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8d391-167">ASP.NET automatically prevents many ways in which malicious users might attempt cross-site scripting attacks by entering script in user input text boxes.</span></span> <span data-ttu-id="8d391-168">I MVC `DisplayFor` pomocnika używany do wyświetlania zadań tytułów i informacje o automatycznie koduje HTML wartości, które wysyła do przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="8d391-168">And the MVC `DisplayFor` helper used to display task titles and notes automatically HTML-encodes values that it sends to the browser.</span></span> <span data-ttu-id="8d391-169">Ale w aplikacji produkcyjnej warto zastosować dodatkowe środki.</span><span class="sxs-lookup"><span data-stu-id="8d391-169">But in a production app you might want to take additional measures.</span></span> <span data-ttu-id="8d391-170">Aby uzyskać więcej informacji, zobacz [żądania weryfikacji w programie ASP.NET:](https://msdn.microsoft.com/library/hh882339.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-170">For more information, see [Request Validation in ASP.NET](https://msdn.microsoft.com/library/hh882339.aspx).</span></span>

<a id="bestpractices"></a>
## <a name="best-practices"></a><span data-ttu-id="8d391-171">Najlepsze rozwiązania</span><span class="sxs-lookup"><span data-stu-id="8d391-171">Best practices</span></span>

<span data-ttu-id="8d391-172">Poniżej przedstawiono niektóre problemy, które zostały rozwiązane po odnalezione w przeglądzie kodu i testowanie oryginalnej wersji aplikacji naprawić.</span><span class="sxs-lookup"><span data-stu-id="8d391-172">Following are some issues that were fixed after being discovered in code review and testing of the original version of the Fix It app.</span></span> <span data-ttu-id="8d391-173">Niektóre zostały spowodowane przez koder oryginalnej, nie wiedziały określonego najlepszych praktyk, niektóre po prostu ponieważ kod został napisany w szybko, a nie był przeznaczony dla wydania oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="8d391-173">Some were caused by the original coder not being aware of a particular best practice, some simply because the code was written quickly and wasn't intended for released software.</span></span> <span data-ttu-id="8d391-174">Firma Microsoft jest lista problemów, w tym miejscu, w przypadku, gdy jest coś, czego dowiedzieliśmy się z tym przeglądzie, a testy, które mogą być pomocne dla innych użytkowników, którzy tworzą aplikacje sieci web.</span><span class="sxs-lookup"><span data-stu-id="8d391-174">We're listing the issues here in case there's something we learned from this review and testing that might be helpful to others who are also developing web apps.</span></span>

### <a name="dispose-the-database-repository"></a><span data-ttu-id="8d391-175">Usuń bazę danych repozytorium</span><span class="sxs-lookup"><span data-stu-id="8d391-175">Dispose the database repository</span></span>

<span data-ttu-id="8d391-176">`FixItTaskRepository` Klasy musi dysponować Entity Framework `DbContext` wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="8d391-176">The `FixItTaskRepository` class must dispose the Entity Framework `DbContext` instance.</span></span> <span data-ttu-id="8d391-177">Zrobiliśmy to zaimplementowanie `IDisposable` w `FixItTaskRepository` klasy:</span><span class="sxs-lookup"><span data-stu-id="8d391-177">We did this by implementing `IDisposable` in the `FixItTaskRepository` class:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample1.cs)]

<span data-ttu-id="8d391-178">Należy zauważyć, że automatycznie zlikwiduje AutoFac `FixItTaskRepository` wystąpienia, więc nie trzeba jawnie usuń go.</span><span class="sxs-lookup"><span data-stu-id="8d391-178">Note that AutoFac will automatically dispose the `FixItTaskRepository` instance, so we don't need to explicitly dispose it.</span></span>

<span data-ttu-id="8d391-179">Innym rozwiązaniem jest usunięcie `DbContext` zmienną elementu członkowskiego z `FixItTaskRepository`i zamiast tego utworzyć lokalną `DbContext` zmiennej w ramach każdej metody repozytorium wewnątrz `using` instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-179">Another option is to remove the `DbContext` member variable from `FixItTaskRepository`, and instead create a local `DbContext` variable within each repository method, inside a `using` statement.</span></span> <span data-ttu-id="8d391-180">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="8d391-180">For example:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample2.cs)]

### <a name="register-singletons-as-such-with-di"></a><span data-ttu-id="8d391-181">Zarejestrowanie pojedynczych elementów jako takie DI</span><span class="sxs-lookup"><span data-stu-id="8d391-181">Register singletons as such with DI</span></span>

<span data-ttu-id="8d391-182">Ponieważ tylko jedno wystąpienie `PhotoService` klasy i `Logger` klasy jest wymagana, te klasy powinny być [zarejestrowany jako pojedynczego wystąpienia do wstrzykiwania zależności](https://code.google.com/p/autofac/wiki/InstanceScope) w *DependenciesConfig.cs*:</span><span class="sxs-lookup"><span data-stu-id="8d391-182">Since only one instance of the `PhotoService` class and `Logger` class is needed, these classes should be [registered as single instances for dependency injection](https://code.google.com/p/autofac/wiki/InstanceScope) in *DependenciesConfig.cs*:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample3.cs?highlight=1,3)]

### <a name="security-dont-show-error-details-to-users"></a><span data-ttu-id="8d391-183">Zabezpieczenia: Nie pokazuj więcej szczegółów błędu dla użytkowników</span><span class="sxs-lookup"><span data-stu-id="8d391-183">Security: Don't show error details to users</span></span>

<span data-ttu-id="8d391-184">Oryginalnej poprawka aplikacji nie mają strony ogólny błąd i po prostu umożliwiają wszystkich bąbelków wyjątków do interfejsu użytkownika, więc niektóre wyjątki, takie jak błędy połączenia bazy danych może spowodować pełen ślad stosu są wyświetlane w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="8d391-184">The original Fix It app didn't have a generic error page and just let all exceptions bubble up to the UI, so some exceptions such as database connection errors could result in a full stack trace being displayed to the browser.</span></span> <span data-ttu-id="8d391-185">Szczegółowe informacje o błędzie czasami mogą ułatwić atakami złośliwych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="8d391-185">Detailed error information can sometimes facilitate attacks by malicious users.</span></span> <span data-ttu-id="8d391-186">Rozwiązanie jest rejestrować szczegóły wyjątku i wyświetlić stronę błędu dla użytkownika, nie dołączaj szczegóły błędu.</span><span class="sxs-lookup"><span data-stu-id="8d391-186">The solution is to log the exception details and display an error page to the user that doesn't include error details.</span></span> <span data-ttu-id="8d391-187">Aplikacja naprawić został już rejestrowanie i aby wyświetlić stronę błędu, dodaliśmy `<customErrors mode=On>` w pliku Web.config.</span><span class="sxs-lookup"><span data-stu-id="8d391-187">The Fix It app was already logging, and in order to display an error page, we added `<customErrors mode=On>` in the Web.config file.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample4.xml?highlight=2)]

<span data-ttu-id="8d391-188">Domyślnie powoduje to, że *Views\Shared\Error.cshtml* ma być wyświetlany dla błędów.</span><span class="sxs-lookup"><span data-stu-id="8d391-188">By default this causes *Views\Shared\Error.cshtml* to be displayed for errors.</span></span> <span data-ttu-id="8d391-189">Można dostosować *Error.cshtml* lub utworzyć własny widok strony błędów i dodanie `defaultRedirect` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="8d391-189">You can customize *Error.cshtml* or create your own error page view and add a `defaultRedirect` attribute.</span></span> <span data-ttu-id="8d391-190">Można również określić strony różnych błędów dla określonych błędów.</span><span class="sxs-lookup"><span data-stu-id="8d391-190">You can also specify different error pages for specific errors.</span></span>

### <a name="security-only-allow-a-task-to-be-edited-by-its-creator"></a><span data-ttu-id="8d391-191">Zabezpieczenia: Zezwalaj tylko na zadania do edycji przez jej twórcę</span><span class="sxs-lookup"><span data-stu-id="8d391-191">Security: only allow a task to be edited by its creator</span></span>

<span data-ttu-id="8d391-192">Strony indeksu pulpitu nawigacyjnego przedstawia tylko zadania utworzone przez zalogowanego użytkownika, ale złośliwy użytkownik może utworzyć adres URL o identyfikatorze zadania przez innego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="8d391-192">The Dashboard Index page only shows tasks created by the logged-on user, but a malicious user could create a URL with an ID to another user's task.</span></span> <span data-ttu-id="8d391-193">Dodaliśmy kod w *DashboardController.cs* zwrócić błąd 404 — w takiej sytuacji:</span><span class="sxs-lookup"><span data-stu-id="8d391-193">We added code in *DashboardController.cs* to return a 404 in that case:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample5.cs?highlight=9-14,24-29)]

### <a name="dont-swallow-exceptions"></a><span data-ttu-id="8d391-194">Nie wchłonąć wyjątków</span><span class="sxs-lookup"><span data-stu-id="8d391-194">Don't swallow exceptions</span></span>

<span data-ttu-id="8d391-195">Oryginalny poprawka aplikacji po prostu zwróciła wartość null po zalogowaniu się wyjątek, który jest wynikiem zapytania SQL:</span><span class="sxs-lookup"><span data-stu-id="8d391-195">The original Fix It app just returned null after logging an exception that resulted from a SQL query:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample6.cs?highlight=4)]

<span data-ttu-id="8d391-196">Dzięki temu upewnisz się to do użytkownika tak, jakby zapytania zakończyło się pomyślnie, ale po prostu nie zwróciła żadnych wierszy.</span><span class="sxs-lookup"><span data-stu-id="8d391-196">This would make it look to the user as if the query succeeded but just didn't return any rows.</span></span> <span data-ttu-id="8d391-197">Rozwiązaniem jest ponownie zgłosić wyjątek po przechwytywanie i rejestrowanie:</span><span class="sxs-lookup"><span data-stu-id="8d391-197">Solution is to re-throw the exception after catching and logging:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample7.cs)]

### <a name="catch-all-exceptions-in-worker-roles"></a><span data-ttu-id="8d391-198">Przechwytuj wszystkie wyjątki w ról procesów roboczych</span><span class="sxs-lookup"><span data-stu-id="8d391-198">Catch all exceptions in worker roles</span></span>

<span data-ttu-id="8d391-199">Nieobsłużone wyjątki w roli procesu roboczego spowoduje, że maszyna wirtualna może zostać odtworzone, dlatego powinna opakować wszystko, co zrobić w bloku try / catch i obsługiwać wszystkie wyjątki.</span><span class="sxs-lookup"><span data-stu-id="8d391-199">Any unhandled exceptions in a worker role will cause the VM to be recycled, so you want to wrap everything you do in a try-catch block and handle all exceptions.</span></span>

### <a name="specify-length-for-string-properties-in-entity-classes"></a><span data-ttu-id="8d391-200">Określ długość właściwości ciągów w klas jednostek</span><span class="sxs-lookup"><span data-stu-id="8d391-200">Specify length for string properties in entity classes</span></span>

<span data-ttu-id="8d391-201">W celu wyświetlenia prostego kodu, oryginalną wersję aplikacji naprawić nie określił długości dla pól jednostki FixItTask, a w rezultacie zostały zdefiniowane jako varchar(max) w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-201">In order to display simple code, the original version of the Fix It app didn't specify lengths for the fields of the FixItTask entity, and as a result they were defined as varchar(max) in the database.</span></span> <span data-ttu-id="8d391-202">W rezultacie interfejsu użytkownika będzie akceptować niemal dowolnej ilości danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="8d391-202">As a result, the UI would accept almost any amount of input.</span></span> <span data-ttu-id="8d391-203">Określanie limitów zestawy długości, które mają zastosowanie zarówno do użytkownika danych wejściowych w stronę sieci web i rozmiar kolumny w bazie danych:</span><span class="sxs-lookup"><span data-stu-id="8d391-203">Specifying lengths sets limits that apply both to user input in the web page and column size in the database:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample8.cs?highlight=4,7,10,12,14)]

### <a name="mark-private-members-as-readonly-when-they-arent-expected-to-change"></a><span data-ttu-id="8d391-204">Oznacz prywatnych elementów członkowskich jako tylko do odczytu, gdy nie są one powinna się zmienić</span><span class="sxs-lookup"><span data-stu-id="8d391-204">Mark private members as readonly when they aren't expected to change</span></span>

<span data-ttu-id="8d391-205">Na przykład w `DashboardController` wystąpienia klasy `FixItTaskRepository` jest tworzony i nie powinien zmienić, więc go jako zdefiniowaliśmy [tylko do odczytu](https://msdn.microsoft.com/library/acdd6hb7.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-205">For example, in the `DashboardController` class an instance of `FixItTaskRepository` is created and isn't expected to change, so we defined it as [readonly](https://msdn.microsoft.com/library/acdd6hb7.aspx).</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample9.cs?highlight=3)]

### <a name="use-listany-instead-of-listcount-gt-0"></a><span data-ttu-id="8d391-206">Użyj listy. Funkcja any() zamiast listy. Count() &gt; 0</span><span class="sxs-lookup"><span data-stu-id="8d391-206">Use list.Any() instead of list.Count() &gt; 0</span></span>

<span data-ttu-id="8d391-207">Jeśli należy zadbać o to czy co najmniej jeden element na liście dopasować określone kryteria, użyj [wszelkie](https://msdn.microsoft.com/library/bb534972.aspx) metody, ponieważ zwraca ono wartość zaraz zostanie znaleziony element, który pasuje do kryteriów, natomiast `Count` metoda ma zawsze do iteracji za pomocą każdego elementu.</span><span class="sxs-lookup"><span data-stu-id="8d391-207">If you all you care about is whether one or more items in a list fit the specified criteria, use the [Any](https://msdn.microsoft.com/library/bb534972.aspx) method, because it returns as soon as an item fitting the criteria is found, whereas the `Count` method always has to iterate through every item.</span></span> <span data-ttu-id="8d391-208">Pulpit nawigacyjny *Index.cshtml* pliku pierwotnie miały ten kod:</span><span class="sxs-lookup"><span data-stu-id="8d391-208">The Dashboard *Index.cshtml* file originally had this code:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample10.cshtml)]

<span data-ttu-id="8d391-209">Zmieniliśmy go do poniższego:</span><span class="sxs-lookup"><span data-stu-id="8d391-209">We changed it to this:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample11.cshtml?highlight=1)]

### <a name="generate-urls-in-mvc-views-using-mvc-helpers"></a><span data-ttu-id="8d391-210">Generowania adresów URL w widoków MVC za pomocą pomocników MVC</span><span class="sxs-lookup"><span data-stu-id="8d391-210">Generate URLs in MVC views using MVC helpers</span></span>

<span data-ttu-id="8d391-211">Dla **rozwiązać go utworzyć** przycisk na stronie głównej poprawka aplikacji twardych kodowanego elementu zakotwiczenia:</span><span class="sxs-lookup"><span data-stu-id="8d391-211">For the **Create a Fix It** button on the home page, the Fix It app hard coded an anchor element:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample12.cshtml)]

<span data-ttu-id="8d391-212">Łączy widoku/Akcja tak jest lepiej używać [Url.Action](https://msdn.microsoft.com/library/system.web.mvc.urlhelper.action.aspx) pomocnika kodu HTML, na przykład:</span><span class="sxs-lookup"><span data-stu-id="8d391-212">For View/Action links like this it's better to use the [Url.Action](https://msdn.microsoft.com/library/system.web.mvc.urlhelper.action.aspx) HTML helper, for example:</span></span>

[!code-cshtml[Main](the-fix-it-sample-application/samples/sample13.cshtml)]

### <a name="use-taskdelay-instead-of-threadsleep-in-worker-role"></a><span data-ttu-id="8d391-213">Użyj Task.Delay zamiast Thread.Sleep w roli procesu roboczego</span><span class="sxs-lookup"><span data-stu-id="8d391-213">Use Task.Delay instead of Thread.Sleep in worker role</span></span>

<span data-ttu-id="8d391-214">Szablon nowego projektu umieszcza `Thread.Sleep` w przykładzie kodu dla roli procesu roboczego, ale powoduje wątku w tryb uśpienia, może spowodować puli wątków zduplikować dodatkowe wątki niepotrzebne.</span><span class="sxs-lookup"><span data-stu-id="8d391-214">The new-project template puts `Thread.Sleep` in the sample code for a worker role, but causing the thread to sleep can cause the thread pool to spawn additional unnecessary threads.</span></span> <span data-ttu-id="8d391-215">Można uniknąć, za pomocą [Task.Delay](https://msdn.microsoft.com/library/hh139096.aspx) zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="8d391-215">You can avoid that by using [Task.Delay](https://msdn.microsoft.com/library/hh139096.aspx) instead.</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample14.cs?highlight=11)]

### <a name="avoid-async-void"></a><span data-ttu-id="8d391-216">Należy unikać async void</span><span class="sxs-lookup"><span data-stu-id="8d391-216">Avoid async void</span></span>

<span data-ttu-id="8d391-217">Jeśli metoda asynchroniczna nie musi zwracać wartość, zwracają `Task` typu zamiast `void`.</span><span class="sxs-lookup"><span data-stu-id="8d391-217">If an async method doesn't need to return a value, return a `Task` type rather than `void`.</span></span>

<span data-ttu-id="8d391-218">W tym przykładzie pochodzi z `FixItQueueManager` klasy:</span><span class="sxs-lookup"><span data-stu-id="8d391-218">This example is from the `FixItQueueManager` class:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample15.cs)]

<span data-ttu-id="8d391-219">Należy używać `async void` tylko dla programów obsługi zdarzeń najwyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="8d391-219">You should use `async void` only for top-level event handlers.</span></span> <span data-ttu-id="8d391-220">Jeśli zdefiniujesz metodę jako `async void`, obiekt wywołujący nie **await** metody lub przechwycić wyjątki, które metoda wygeneruje.</span><span class="sxs-lookup"><span data-stu-id="8d391-220">If you define a method as `async void`, the caller cannot **await** the method or catch any exceptions the method throws.</span></span> <span data-ttu-id="8d391-221">Aby uzyskać więcej informacji, zobacz [najlepszych rozwiązań dotyczących Asynchronous Programming](https://msdn.microsoft.com/magazine/jj991977.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-221">For more information, see [Best Practices in Asynchronous Programming](https://msdn.microsoft.com/magazine/jj991977.aspx).</span></span>

### <a name="use-a-cancellation-token-to-break-from-worker-role-loop"></a><span data-ttu-id="8d391-222">Użycia tokenu anulowania, aby przerwać z pętli roli procesu roboczego</span><span class="sxs-lookup"><span data-stu-id="8d391-222">Use a cancellation token to break from worker role loop</span></span>

<span data-ttu-id="8d391-223">Zazwyczaj **Uruchom** metody w roli procesu roboczego zawiera wejścia w nieskończoną pętlę.</span><span class="sxs-lookup"><span data-stu-id="8d391-223">Typically, the **Run** method on a worker role contains an infinite loop.</span></span> <span data-ttu-id="8d391-224">Gdy rola procesu roboczego jest zatrzymywane, [RoleEntryPoint.OnStop](https://msdn.microsoft.com/library/windowsazure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) metoda jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="8d391-224">When the worker role is stopping, the [RoleEntryPoint.OnStop](https://msdn.microsoft.com/library/windowsazure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) method is called.</span></span> <span data-ttu-id="8d391-225">Należy używać tej metody można anulować pracy, która jest wykonywana w ramach **Uruchom** metody i wyjścia bezpiecznie.</span><span class="sxs-lookup"><span data-stu-id="8d391-225">You should use this method to cancel the work that is being done inside the **Run** method and exit gracefully.</span></span> <span data-ttu-id="8d391-226">W przeciwnym razie proces może być zakończony w trakcie wykonywania operacji.</span><span class="sxs-lookup"><span data-stu-id="8d391-226">Otherwise, the process might be terminated in the middle of an operation.</span></span>

### <a name="opt-out-of-automatic-mime-sniffing-procedure"></a><span data-ttu-id="8d391-227">Zrezygnować z procedury automatyczne wykrywanie MIME</span><span class="sxs-lookup"><span data-stu-id="8d391-227">Opt out of Automatic MIME Sniffing Procedure</span></span>

<span data-ttu-id="8d391-228">W niektórych przypadkach program Internet Explorer raporty typ MIME, różni się od typu określonego przez serwer sieci web.</span><span class="sxs-lookup"><span data-stu-id="8d391-228">In some cases, Internet Explorer reports a MIME type different than the type specified by the web server.</span></span> <span data-ttu-id="8d391-229">Na przykład jeśli program Internet Explorer znajdzie HTML zawartości w pliku dostarczane z nagłówka odpowiedzi HTTP Content-Type: text/plain programu Internet Explorer określa, czy zawartość ma być renderowany jako kod HTML.</span><span class="sxs-lookup"><span data-stu-id="8d391-229">For instance, if Internet Explorer finds HTML content in a file delivered with the HTTP response header Content-Type: text/plain, Internet Explorer determines that the content should be rendered as HTML.</span></span> <span data-ttu-id="8d391-230">Niestety to "— Wykrywanie MIME" może także prowadzić do problemów z zabezpieczeniami dla serwerów hostujących niezaufaną zawartość.</span><span class="sxs-lookup"><span data-stu-id="8d391-230">Unfortunately, this "MIME-sniffing" can also lead to security problems for servers hosting untrusted content.</span></span> <span data-ttu-id="8d391-231">Aby walczyć ten problem, Internet Explorer 8 wprowadził szereg zmian do kodu określenie typu MIME i umożliwia deweloperom [zrezygnować z wykrywanie MIME](https://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d391-231">To combat this problem, Internet Explorer 8 has made a number of changes to MIME-type determination code and allows application developers to [opt out of MIME-sniffing](https://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx).</span></span> <span data-ttu-id="8d391-232">Następujący kod został dodany do *Web.config* pliku.</span><span class="sxs-lookup"><span data-stu-id="8d391-232">The following code was added to the *Web.config* file.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample16.xml?highlight=2-7)]

### <a name="enable-bundling-and-minification"></a><span data-ttu-id="8d391-233">Włącz tworzenie pakietów i minimalizowanie</span><span class="sxs-lookup"><span data-stu-id="8d391-233">Enable bundling and minification</span></span>

<span data-ttu-id="8d391-234">Gdy program Visual Studio tworzy nowy projekt sieci web, tworzenie pakietów i minimalizowanie plików JavaScript nie włączono domyślnie.</span><span class="sxs-lookup"><span data-stu-id="8d391-234">When Visual Studio creates a new web project, bundling and minification of JavaScript files is not enabled by default.</span></span> <span data-ttu-id="8d391-235">Dodaliśmy wiersza kodu w BundleConfig.cs:</span><span class="sxs-lookup"><span data-stu-id="8d391-235">We added a line of code in BundleConfig.cs:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample17.cs?highlight=9)]

### <a name="set-an-expiration-time-out-for-authentication-cookies"></a><span data-ttu-id="8d391-236">Ustawianie limitu czasu wygaśnięcia uwierzytelniania plików cookie</span><span class="sxs-lookup"><span data-stu-id="8d391-236">Set an expiration time-out for authentication cookies</span></span>

<span data-ttu-id="8d391-237">Domyślnie pliki cookie uwierzytelniania wygasa w ciągu dwóch tygodni.</span><span class="sxs-lookup"><span data-stu-id="8d391-237">By default, authentication cookies expire in two weeks.</span></span> <span data-ttu-id="8d391-238">Krótszy czas jest bezpieczniejszy.</span><span class="sxs-lookup"><span data-stu-id="8d391-238">A shorter time is more secure.</span></span> <span data-ttu-id="8d391-239">Możesz zmienić to ustawienie w *StartupAuth.cs*:</span><span class="sxs-lookup"><span data-stu-id="8d391-239">You can change this setting in *StartupAuth.cs*:</span></span>

[!code-csharp[Main](the-fix-it-sample-application/samples/sample18.cs?highlight=4-5)]

<a id="run-in-vs"></a>
## <a name="how-to-run-the-app-from-visual-studio-on-your-local-computer"></a><span data-ttu-id="8d391-240">Jak uruchomić aplikację w programie Visual Studio na komputerze lokalnym</span><span class="sxs-lookup"><span data-stu-id="8d391-240">How to run the app from Visual Studio on your local computer</span></span>

<span data-ttu-id="8d391-241">Istnieją dwa sposoby uruchamiania aplikacji napraw:</span><span class="sxs-lookup"><span data-stu-id="8d391-241">There are two ways to run the Fix It app:</span></span>

- <span data-ttu-id="8d391-242">Uruchom aplikację podstawowy, który zapisuje nowe zadania bezpośrednio do bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="8d391-242">Run the base application that writes new tasks directly to the SQL database.</span></span>
- <span data-ttu-id="8d391-243">Uruchom aplikację za pomocą kolejki, a także usługi zaplecza do utworzenia zadania.</span><span class="sxs-lookup"><span data-stu-id="8d391-243">Run the application using a queue plus a backend service to create tasks.</span></span> <span data-ttu-id="8d391-244">Wzorzec kolejki jest opisany w rozdziale [wzorzec pracy skoncentrowany na kolejkach](queue-centric-work-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="8d391-244">The queue pattern is described in the chapter [Queue-Centric Work Pattern](queue-centric-work-pattern.md).</span></span>

<a id="runbase"></a>
### <a name="run-the-base-application"></a><span data-ttu-id="8d391-245">Uruchamianie podstawowych aplikacji</span><span class="sxs-lookup"><span data-stu-id="8d391-245">Run the base application</span></span>

1. <span data-ttu-id="8d391-246">Zainstaluj [programu Visual Studio 2017](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017).</span><span class="sxs-lookup"><span data-stu-id="8d391-246">Install [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017).</span></span>
2. <span data-ttu-id="8d391-247">Zainstaluj [zestaw Azure SDK dla platformy .NET dla programu Visual Studio](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="8d391-247">Install the [Azure SDK for .NET for Visual Studio](https://azure.microsoft.com/downloads/).</span></span>
3. <span data-ttu-id="8d391-248">Pobierz plik zip z [galerii kodu MSDN](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4).</span><span class="sxs-lookup"><span data-stu-id="8d391-248">Download the .zip file from the [MSDN Code Gallery](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4).</span></span>
4. <span data-ttu-id="8d391-249">W Eksploratorze plików kliknij prawym przyciskiem myszy plik zip i kliknij polecenie Właściwości, a następnie w oknie dialogowym właściwości kliknij odblokowania.</span><span class="sxs-lookup"><span data-stu-id="8d391-249">In File Explorer, right-click the .zip file and click Properties, then in the Properties window click Unblock.</span></span>
5. <span data-ttu-id="8d391-250">Rozpakuj plik.</span><span class="sxs-lookup"><span data-stu-id="8d391-250">Unzip the file.</span></span>
6. <span data-ttu-id="8d391-251">Kliknij dwukrotnie plik SLN, aby uruchomić program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8d391-251">Double-click the .sln file to launch Visual Studio.</span></span>
7. <span data-ttu-id="8d391-252">Z **narzędzia** menu, kliknij przycisk **Menedżera pakietów NuGet**, następnie **Konsola Menedżera pakietów**.</span><span class="sxs-lookup"><span data-stu-id="8d391-252">From the **Tools** menu, click **NuGet Package Manager**, then **Package Manager Console**.</span></span>
8. <span data-ttu-id="8d391-253">W konsoli Menedżera pakietów (PMC), kliknij przycisk Przywróć.</span><span class="sxs-lookup"><span data-stu-id="8d391-253">In the Package Manager Console (PMC), click Restore.</span></span>
9. <span data-ttu-id="8d391-254">Zamknij program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8d391-254">Exit Visual Studio.</span></span>
10. <span data-ttu-id="8d391-255">Rozpocznij [emulatora usługi Azure storage](/azure/storage/common/storage-use-emulator).</span><span class="sxs-lookup"><span data-stu-id="8d391-255">Start the [Azure storage emulator](/azure/storage/common/storage-use-emulator).</span></span>
11. <span data-ttu-id="8d391-256">Uruchom ponownie program Visual Studio, otwierając plik rozwiązania zamknięte w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="8d391-256">Restart Visual Studio, opening the solution file you closed in the previous step.</span></span>
12. <span data-ttu-id="8d391-257">Upewnij się, że projekt automatyczne jest ustawiony jako projekt startowy, a następnie naciśnij klawisze CTRL + F5, aby uruchomić projekt.</span><span class="sxs-lookup"><span data-stu-id="8d391-257">Make sure the FixIt project is set as the startup project, and then press CTRL+F5 to run the project.</span></span>

<a id="queueslocal"></a>
### <a name="run-the-application-with-queue-processing"></a><span data-ttu-id="8d391-258">Uruchamianie aplikacji z przetwarzaniem kolejki</span><span class="sxs-lookup"><span data-stu-id="8d391-258">Run the application with queue processing</span></span>

1. <span data-ttu-id="8d391-259">Postępuj zgodnie ze wskazówkami dotyczącymi [uruchamiania podstawowej aplikacji](#runbase), a następnie zamknij przeglądarkę i zamknij program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8d391-259">Follow the directions for [Run the base application](#runbase), and then close the browser and close Visual Studio.</span></span>
2. <span data-ttu-id="8d391-260">Uruchom program Visual Studio z uprawnieniami administratora.</span><span class="sxs-lookup"><span data-stu-id="8d391-260">Start Visual Studio with administrator privileges.</span></span> <span data-ttu-id="8d391-261">(Będziesz korzystać z emulatora obliczeń platformy Azure, i która wymaga uprawnień administratora).</span><span class="sxs-lookup"><span data-stu-id="8d391-261">(You'll be using the Azure compute emulator, and that requires administrator privileges.)</span></span>
3. <span data-ttu-id="8d391-262">W aplikacji *Web.config* w pliku *MyFixIt* projektu (projekt sieci web), zmień wartość właściwości `appSettings/UseQueues` na wartość "true":</span><span class="sxs-lookup"><span data-stu-id="8d391-262">In the application *Web.config* file in the *MyFixIt* project (the web project), change the value of `appSettings/UseQueues` to "true":</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample19.cmd?highlight=3)]
4. <span data-ttu-id="8d391-263">Jeśli [emulatora usługi Azure storage](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx) nie jest nadal uruchomione, uruchom go ponownie.</span><span class="sxs-lookup"><span data-stu-id="8d391-263">If the [Azure storage emulator](https://msdn.microsoft.com/library/windowsazure/hh403989.aspx) isn't still running, start it again.</span></span>
5. <span data-ttu-id="8d391-264">Uruchom projekt sieci web automatyczne i projekt MyFixItCloudService jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="8d391-264">Run the FixIt web project and the MyFixItCloudService project simultaneously.</span></span>

    <span data-ttu-id="8d391-265">Za pomocą programu Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="8d391-265">Using Visual Studio:</span></span>

   1. <span data-ttu-id="8d391-266">Naciśnij klawisz **F5** Aby uruchomić projekt automatyczne rozwiązywanie problemu.</span><span class="sxs-lookup"><span data-stu-id="8d391-266">Press **F5** to run the FixIt project.</span></span>
   2. <span data-ttu-id="8d391-267">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt MyFixItCloudService, a następnie kliknij **debugowania** > **Uruchom nowe wystąpienie**.</span><span class="sxs-lookup"><span data-stu-id="8d391-267">In **Solution Explorer**, right-click the MyFixItCloudService project, and then click **Debug** > **Start New Instance**.</span></span>

    <span data-ttu-id="8d391-268">Using Visual Studio 2013 Express for Web:</span><span class="sxs-lookup"><span data-stu-id="8d391-268">Using Visual Studio 2013 Express for Web:</span></span>

   3. <span data-ttu-id="8d391-269">W Eksploratorze rozwiązań kliknij prawym przyciskiem myszy rozwiązanie automatyczne, a następnie wybierz **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="8d391-269">In Solution Explorer, right-click the FixIt solution and select **Properties**.</span></span>
   4. <span data-ttu-id="8d391-270">Wybierz **wiele projektów startowych**.</span><span class="sxs-lookup"><span data-stu-id="8d391-270">Select **Multiple Startup Projects**.</span></span>
   5. <span data-ttu-id="8d391-271">W **akcji** wybierz z listy rozwijanej w obszarze MyFixIt i MyFixItCloudService, **Start**.</span><span class="sxs-lookup"><span data-stu-id="8d391-271">In the **Action** dropdown list under MyFixIt and MyFixItCloudService, select **Start**.</span></span>
   6. <span data-ttu-id="8d391-272">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="8d391-272">Click **OK**.</span></span>
   7. <span data-ttu-id="8d391-273">Naciśnij klawisz **F5** Aby uruchomić oba projekty.</span><span class="sxs-lookup"><span data-stu-id="8d391-273">Press **F5** to run both projects.</span></span>

      <span data-ttu-id="8d391-274">Po uruchomieniu projektu MyFixItCloudService uruchomieniu programu Visual Studio emulator obliczeń platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-274">When you run the MyFixItCloudService project, Visual Studio starts the Azure compute emulator.</span></span> <span data-ttu-id="8d391-275">W zależności od konfiguracji zapory konieczne może być Zezwalaj na emulator przez zaporę.</span><span class="sxs-lookup"><span data-stu-id="8d391-275">Depending on your firewall configuration, you might need to allow the emulator through the firewall.</span></span>

<a id="deploybase"></a>
## <a name="how-to-deploy-the-base-app-to-azure-app-service-web-apps-by-using-the-windows-powershell-scripts"></a><span data-ttu-id="8d391-276">Sposób wdrażania podstawowej aplikacji w usłudze Azure App Service Web Apps za pomocą skryptów środowiska Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d391-276">How to deploy the base app to Azure App Service Web Apps by using the Windows PowerShell scripts</span></span>

<span data-ttu-id="8d391-277">Aby zilustrować [Automatyzowanie wszystkiego](automate-everything.md) wzorca aplikacji naprawić jest dostarczany za pomocą skryptów, które konfigurowania środowiska na platformie Azure i wdrażanie projektu do nowego środowiska.</span><span class="sxs-lookup"><span data-stu-id="8d391-277">To illustrate the [Automate Everything](automate-everything.md) pattern, the Fix It app is supplied with scripts that set up an environment in Azure and deploy the project to the new environment.</span></span> <span data-ttu-id="8d391-278">Poniższe instrukcje wyjaśniają, jak za pomocą skryptów.</span><span class="sxs-lookup"><span data-stu-id="8d391-278">The following instructions explain how to use the scripts.</span></span>

<span data-ttu-id="8d391-279">Jeśli chcesz uruchomić na platformie Azure bez przy użyciu funkcji kolejek i zostały wprowadzone zmiany, aby uruchomić lokalnie za pomocą kolejek, upewnij się, że wartość UseQueues appSetting ponownie na wartość false, przed dalszym wykonywaniem poniższych instrukcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-279">If you want to run in Azure without using queues, and you made the changes to run locally with queues, make sure you set the UseQueues appSetting value back to false before proceeding with the following instructions.</span></span>

<span data-ttu-id="8d391-280">W poniższych instrukcjach przyjęto zostały już pobrane i rozwiązanie naprawić lokalnie, i czy masz Azure konta lub subskrypcji platformy Azure, masz uprawnienia do zarządzania.</span><span class="sxs-lookup"><span data-stu-id="8d391-280">These instructions assume you have already downloaded and run the Fix It solution locally, and that you have an Azure account or have an Azure subscription that you are authorized to manage.</span></span>

1. <span data-ttu-id="8d391-281">Zainstaluj **programu Azure PowerShell** konsoli.</span><span class="sxs-lookup"><span data-stu-id="8d391-281">Install the **Azure PowerShell** console.</span></span> <span data-ttu-id="8d391-282">Aby uzyskać instrukcje, zobacz [jak zainstalować i skonfigurować program Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.3.1).</span><span class="sxs-lookup"><span data-stu-id="8d391-282">For instructions, see [How to install and configure Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.3.1).</span></span>

    <span data-ttu-id="8d391-283">Ta konsola dostosowane jest skonfigurowane do pracy z subskrypcją platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-283">This customized console is configured to work with your Azure subscription.</span></span> <span data-ttu-id="8d391-284">Moduł usługi Azure jest zainstalowany w *Program Files* katalogu i jest importowany automatycznie co korzystający z konsoli programu Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8d391-284">The Azure module is installed in the *Program Files* directory and is automatically imported on every use of the Azure PowerShell console.</span></span>

    <span data-ttu-id="8d391-285">Jeśli wolisz pracować w programie do innego hosta, takich jak Windows PowerShell ISE, należy użyć [Import-Module](https://go.microsoft.com/fwlink/?LinkID=141553) polecenia cmdlet, aby zaimportować moduł platformy Azure lub użyj polecenia modułu usługi Azure do wyzwolenia automatycznego importowania modułu.</span><span class="sxs-lookup"><span data-stu-id="8d391-285">If you prefer to work in a different host program, such as Windows PowerShell ISE, be sure to use the [Import-Module](https://go.microsoft.com/fwlink/?LinkID=141553) cmdlet to import the Azure module or use a command in the Azure module to trigger automatic importing of the module.</span></span>
2. <span data-ttu-id="8d391-286">Uruchom program Azure PowerShell za pomocą **Uruchom jako administrator** opcji.</span><span class="sxs-lookup"><span data-stu-id="8d391-286">Start Azure PowerShell with the **Run as administrator** option.</span></span>
3. <span data-ttu-id="8d391-287">Uruchom [Set-ExecutionPolicy](https://go.microsoft.com/fwlink/p/?linkid=293941) polecenia cmdlet, aby ustawić zasady wykonywania programu Azure PowerShell `RemoteSigned`.</span><span class="sxs-lookup"><span data-stu-id="8d391-287">Run the [Set-ExecutionPolicy](https://go.microsoft.com/fwlink/p/?linkid=293941) cmdlet to set the Azure PowerShell execution policy to `RemoteSigned`.</span></span> <span data-ttu-id="8d391-288">Wprowadź **Y** (dla tak) do ukończenia zmiany zasad.</span><span class="sxs-lookup"><span data-stu-id="8d391-288">Enter **Y** (for Yes) to complete the policy change.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample20.cmd)]

    <span data-ttu-id="8d391-289">To ustawienie umożliwia uruchamianie skryptów lokalnych, które nie są podpisane cyfrowo.</span><span class="sxs-lookup"><span data-stu-id="8d391-289">This setting enables you to run local scripts that aren't digitally signed.</span></span> <span data-ttu-id="8d391-290">(Można również ustawić zasady wykonywania `Unrestricted`, który może wyeliminować konieczność stosowania kroku odblokowanie później, ale nie jest to zalecane ze względów bezpieczeństwa.)</span><span class="sxs-lookup"><span data-stu-id="8d391-290">(You can also set the execution policy to `Unrestricted`, which would eliminate the need for the unblock step later, but this is not recommended for security reasons.)</span></span>
4. <span data-ttu-id="8d391-291">Uruchom `Add-AzureAccount` polecenia cmdlet i konfigurowanie programu PowerShell przy użyciu poświadczeń dla konta usługi.</span><span class="sxs-lookup"><span data-stu-id="8d391-291">Run the `Add-AzureAccount` cmdlet to set up PowerShell with credentials for your account.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample21.cmd)]

    <span data-ttu-id="8d391-292">Te poświadczenia tracą ważność po upływie pewnego czasu i ponownie uruchom `Add-AzureAccount` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8d391-292">These credentials expire after a period of time and you have to re-run the `Add-AzureAccount` cmdlet.</span></span> <span data-ttu-id="8d391-293">Jak ta Książka elektroniczna jest zapisywana, limit czasu wygaśnięcia poświadczeń jest 12 godzin.</span><span class="sxs-lookup"><span data-stu-id="8d391-293">As this e-book is being written, the time limit before credentials expire is 12 hours.</span></span>
5. <span data-ttu-id="8d391-294">Jeśli masz wiele subskrypcji, należy użyć polecenia cmdlet Select-AzureSubscription, aby określić subskrypcję, której chcesz utworzyć środowisko testowe w.</span><span class="sxs-lookup"><span data-stu-id="8d391-294">If you have multiple subscriptions, use the Select-AzureSubscription cmdlet to specify the subscription you want to create the test environment in.</span></span>
6. <span data-ttu-id="8d391-295">Zaimportuj certyfikat zarządzania dla tej samej subskrypcji platformy Azure przy użyciu `Get-AzurePublishSettingsFile` i `Import-AzurePublishSettingsFile` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8d391-295">Import a management certificate for the same Azure subscription by using the `Get-AzurePublishSettingsFile` and `Import-AzurePublishSettingsFile` cmdlets.</span></span> <span data-ttu-id="8d391-296">Pierwsza z tych poleceń cmdlet spowoduje pobranie pliku certyfikatu, a w drugim określisz lokalizacja tego pliku, aby można było go zaimportować.</span><span class="sxs-lookup"><span data-stu-id="8d391-296">The first of these cmdlets downloads a certificate file, and in the second one you specify the location of that file in order to import it.</span></span> > [!IMPORTANT]
   > <span data-ttu-id="8d391-297">Zachowaj pobrany plik w bezpiecznym miejscu, lub usuwasz, gdy wszystko będzie gotowe, ponieważ zawiera on certyfikat, który może służyć do zarządzania usługami platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-297">Keep the downloaded file in a safe location or delete it when you're done with it, because it contains a certificate that can be used to manage your Azure services.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample22.cmd)]

    <span data-ttu-id="8d391-298">Certyfikat jest używany do wywołania interfejsu API REST, który wykrywa adres IP na komputerze deweloperskim, aby ustawić regułę zapory na serwerze bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="8d391-298">The certificate is used for a REST API call that detects the development machine's IP address in order to set a firewall rule on the SQL Database server.</span></span>
7. <span data-ttu-id="8d391-299">Uruchom [Ustawianie lokalizacji](https://go.microsoft.com/fwlink/p/?linkid=293912) polecenia cmdlet (aliasy `cd`, `chdir`, i `sl`) przejdź do katalogu, który zawiera skrypty.</span><span class="sxs-lookup"><span data-stu-id="8d391-299">Run the [Set-Location](https://go.microsoft.com/fwlink/p/?linkid=293912) cmdlet (aliases are `cd`, `chdir`, and `sl`) to navigate to the directory that contains the scripts.</span></span> <span data-ttu-id="8d391-300">(Znajdują się one w *automatyzacji* folderu w folderze rozwiązania rozwiązać go.) Jeśli którakolwiek z nazwy katalogów zawiera spacje, umieść ścieżkę w cudzysłowie.</span><span class="sxs-lookup"><span data-stu-id="8d391-300">(They're located in the *Automation* folder in the Fix It solution folder.) Put the path in quotes if any of the directory names contain spaces.</span></span> <span data-ttu-id="8d391-301">Na przykład, aby przejść do `c:\Sample Apps\FixIt\Automation` katalogu można wprowadzić następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="8d391-301">For example, to navigate to the `c:\Sample Apps\FixIt\Automation` directory you could enter the following command:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample23.cmd)]
8. <span data-ttu-id="8d391-302">Aby umożliwić programu Windows PowerShell, aby uruchamiać te skrypty, należy użyć [odblokowanie pliku](https://go.microsoft.com/fwlink/p/?linkid=294021) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8d391-302">To allow Windows PowerShell to run these scripts, use the [Unblock-File](https://go.microsoft.com/fwlink/p/?linkid=294021) cmdlet.</span></span> <span data-ttu-id="8d391-303">(Skrypty są blokowane, ponieważ zostały one pobrane z Internetu.)</span><span class="sxs-lookup"><span data-stu-id="8d391-303">(The scripts are blocked because they were downloaded from the Internet.)</span></span>

    > [!WARNING]
    > <span data-ttu-id="8d391-304">Zabezpieczenia — przed uruchomieniem `Unblock-File` na dowolny skrypt lub plik wykonywalny, otwórz plik w programie Notatnik, sprawdź polecenia i sprawdź, czy nie zawierają złośliwego kodu.</span><span class="sxs-lookup"><span data-stu-id="8d391-304">Security - Before running `Unblock-File` on any script or executable file, open the file in Notepad, examine the commands, and verify that they do not contain any malicious code.</span></span>

    <span data-ttu-id="8d391-305">Na przykład następujące polecenie uruchamia `Unblock-File` polecenie cmdlet na wszystkie skrypty w bieżącym katalogu.</span><span class="sxs-lookup"><span data-stu-id="8d391-305">For example, the following command runs the `Unblock-File` cmdlet on all scripts in the current directory.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample24.cmd)]
9. <span data-ttu-id="8d391-306">Aby utworzyć aplikację sieci web dla podstawy (nie kolejki przetwarzania) go naprawić aplikację, uruchom skrypt tworzenia środowiska.</span><span class="sxs-lookup"><span data-stu-id="8d391-306">To create the web app for the base (no queues processing) Fix It app, run the environment creation script.</span></span>

    <span data-ttu-id="8d391-307">Wymagane `Name` parametr określa nazwę bazy danych, a także jest używane dla konta magazynu, który tworzy skrypt.</span><span class="sxs-lookup"><span data-stu-id="8d391-307">The required `Name` parameter specifies the name of the database and is also used for the storage account that the script creates.</span></span> <span data-ttu-id="8d391-308">Nazwa musi być globalnie unikatowa w domenie azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="8d391-308">The name must be globally unique within the azurewebsites.net domain.</span></span> <span data-ttu-id="8d391-309">Jeśli określisz nazwę, która nie jest unikatowa, takich jak automatyczne lub testów (lub nawet tak jak w przykładzie fixitdemo) `New-AzureWebsite` polecenie cmdlet kończy się niepowodzeniem z powodu błędu wewnętrznego, zgłosi konflikt.</span><span class="sxs-lookup"><span data-stu-id="8d391-309">If you specify a name that is not unique, like Fixit or Test (or even as in the example, fixitdemo), the `New-AzureWebsite` cmdlet fails with an Internal Error that reports a conflict.</span></span> <span data-ttu-id="8d391-310">Skrypt konwertuje nazwę literami, aby spełnić wymagania dotyczące nazw dla aplikacji sieci web, kont magazynu i baz danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-310">The script converts the name to all lower-case to comply with name requirements for web apps, storage accounts, and databases.</span></span>

    <span data-ttu-id="8d391-311">Wymagane `SqlDatabasePassword` parametr określa hasło dla konta administratora, który zostanie utworzony dla usługi SQL Database.</span><span class="sxs-lookup"><span data-stu-id="8d391-311">The required `SqlDatabasePassword` parameter specifies the password for the admin account that will be created for SQL Database.</span></span> <span data-ttu-id="8d391-312">Nie dołączaj specjalne znaki XML w haśle (&amp; &lt; &gt; ;).</span><span class="sxs-lookup"><span data-stu-id="8d391-312">Don't include special XML characters in the password (&amp; &lt; &gt; ;).</span></span> <span data-ttu-id="8d391-313">Jest to ograniczenie sposobu, w jaki skrypty zostały napisane, nie ograniczenia platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-313">This is a limitation of the way the scripts were written, not a limitation of Azure.</span></span>

    <span data-ttu-id="8d391-314">Na przykład jeśli chcesz utworzyć aplikację sieci web o nazwie "fixitdemo" i użyć "Passw0rd1" hasło administratora programu SQL Server, można wprowadzić następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="8d391-314">For example, if you want to create a web app named "fixitdemo" and use a SQL Server administrator password of "Passw0rd1", you could enter the following command:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample25.cmd)]

    <span data-ttu-id="8d391-315">Nazwa musi być unikatowa w domenie azurewebsites.net, a hasło musi spełniać wymagania bazy danych SQL dla złożoności hasła.</span><span class="sxs-lookup"><span data-stu-id="8d391-315">The name must be unique in the azurewebsites.net domain, and the password must meet SQL Database requirements for password complexity.</span></span> <span data-ttu-id="8d391-316">(Przykład Passw0rd1 spełnia wymagań).</span><span class="sxs-lookup"><span data-stu-id="8d391-316">(The example Passw0rd1 does meet the requirements.)</span></span>

    <span data-ttu-id="8d391-317">Należy zauważyć, że polecenie rozpoczyna się od ". \".</span><span class="sxs-lookup"><span data-stu-id="8d391-317">Note that the command begins with ".\".</span></span> <span data-ttu-id="8d391-318">Aby zapobiec wykonania złośliwych skryptów, programu Windows PowerShell wymaga podać pełną ścieżkę do pliku skryptu w przypadku uruchamiania skryptu.</span><span class="sxs-lookup"><span data-stu-id="8d391-318">To help prevent malicious execution of scripts, Windows PowerShell requires that you provide the fully qualified path to the script file when you run a script.</span></span> <span data-ttu-id="8d391-319">Można użyć pojedynczego znaku kropki wskazuje bieżący katalog (".\") lub podaj pełną ścieżkę, taką jak:</span><span class="sxs-lookup"><span data-stu-id="8d391-319">You can use a dot to indicate the current directory (".\") or provide the fully qualified path, such as:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample26.cmd)]

    <span data-ttu-id="8d391-320">Aby uzyskać więcej informacji na temat skryptu użyj `Get-Help` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="8d391-320">For more information about the script, use the `Get-Help` cmdlet.</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample27.cmd)]

    <span data-ttu-id="8d391-321">Możesz użyć `Detailed`, `Full`, `Parameters`, i `Examples` parametry polecenia cmdlet Get-Help, aby filtrować pomocy, która jest zwracana.</span><span class="sxs-lookup"><span data-stu-id="8d391-321">You can use the `Detailed`, `Full`, `Parameters`, and `Examples` parameters of the Get-Help cmdlet to filter the help that is returned.</span></span>

    <span data-ttu-id="8d391-322">Jeśli skrypt zakończy się niepowodzeniem lub generuje błędy, takie jak "New-AzureWebsite: Wywołaj najpierw, Set-AzureSubscription i Select-AzureSubscription"nie może być ukończono konfigurację programu Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8d391-322">If the script fails or generates errors, such as "New-AzureWebsite : Call Set-AzureSubscription and Select-AzureSubscription first," you might not have completed the configuration of Azure PowerShell.</span></span>

    <span data-ttu-id="8d391-323">Po zakończeniu działania skryptu można użyć portalu zarządzania systemu Azure, aby wyświetlić zasoby, które zostały utworzone, jak pokazano na [Automatyzowanie wszystkiego](automate-everything.md) rozdziale.</span><span class="sxs-lookup"><span data-stu-id="8d391-323">After the script finishes, you can use the Azure Management Portal to see the resources that were created, as shown in the [Automate Everything](automate-everything.md) chapter.</span></span>
10. <span data-ttu-id="8d391-324">Aby wdrożyć projekt automatyczne do nowego środowiska platformy Azure, użyj *AzureWebsite.ps1* skryptu.</span><span class="sxs-lookup"><span data-stu-id="8d391-324">To deploy the FixIt project to the new Azure environment, use the *AzureWebsite.ps1* script.</span></span> <span data-ttu-id="8d391-325">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="8d391-325">For example:</span></span>

    [!code-console[Main](the-fix-it-sample-application/samples/sample28.cmd)]

    <span data-ttu-id="8d391-326">Po zakończeniu wdrażania przeglądarki zostanie otwarta z napraw go, działające na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-326">When deployment is done, the browser opens with Fix It running in Azure.</span></span>

<a id="troubleshooting"></a>
## <a name="troubleshooting-the-windows-powershell-scripts"></a><span data-ttu-id="8d391-327">Rozwiązywanie problemów z skryptów programu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="8d391-327">Troubleshooting the Windows PowerShell scripts</span></span>

<span data-ttu-id="8d391-328">Typowe błędy występujące podczas uruchamiania tych skryptów są powiązane uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="8d391-328">The most common errors encountered when running these scripts are related to permissions.</span></span> <span data-ttu-id="8d391-329">Upewnij się, że `Add-AzureAccount` i `Import-AzurePublishSettingsFile` zakończyły się pomyślnie, a używany dla tej samej subskrypcji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-329">Make sure that `Add-AzureAccount` and `Import-AzurePublishSettingsFile` were successful and that you used them for the same Azure subscription.</span></span> <span data-ttu-id="8d391-330">Nawet wtedy, gdy `Add-AzureAccount` został pomyślnie trzeba będzie uruchomić go ponownie.</span><span class="sxs-lookup"><span data-stu-id="8d391-330">Even if `Add-AzureAccount` was successful you might have to run it again.</span></span> <span data-ttu-id="8d391-331">Uprawnienia dodane przez `Add-AzureAccount` wygaśnie w ciągu 12 godzin.</span><span class="sxs-lookup"><span data-stu-id="8d391-331">The permissions added by `Add-AzureAccount` expire in 12 hours.</span></span>

### <a name="object-reference-not-set-to-an-instance-of-an-object"></a><span data-ttu-id="8d391-332">Odwołanie do obiektu nie zostały ustawione na wystąpienie obiektu.</span><span class="sxs-lookup"><span data-stu-id="8d391-332">Object reference not set to an instance of an object.</span></span>

<span data-ttu-id="8d391-333">Jeśli skrypt zwraca informacje o błędach, takie jak "Odwołanie do obiektu nie ustawione na wystąpienie obiektu" oznacza to, że program Windows PowerShell nie można odnaleźć obiektu, do procesu (jest to wyjątek odwołania o wartości null), uruchom `Add-AzureAccount` polecenia cmdlet, a następnie ponownie spróbuj skryptu.</span><span class="sxs-lookup"><span data-stu-id="8d391-333">If the script returns errors, such as "Object reference not set to an instance of an object," which means that Windows PowerShell can't find an object to process (this is a null reference exception), run the `Add-AzureAccount` cmdlet and try the script again.</span></span>

[!code-console[Main](the-fix-it-sample-application/samples/sample29.cmd)]

### <a name="internalerror-the-server-encountered-an-internal-error"></a><span data-ttu-id="8d391-334">InternalError: Serwer napotkał błąd wewnętrzny.</span><span class="sxs-lookup"><span data-stu-id="8d391-334">InternalError: The server encountered an internal error.</span></span>

<span data-ttu-id="8d391-335">`New-AzureWebsite` Polecenie cmdlet zwraca błąd wewnętrzny, gdy nazwa nie jest unikatowa w domenie azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="8d391-335">The `New-AzureWebsite` cmdlet returns an internal error when the name is not unique in the azurewebsites.net domain.</span></span> <span data-ttu-id="8d391-336">Aby naprawić błąd, należy użyć innej wartości dla nazwy, która znajduje się w parametrze Name *New AzureWebsiteEnv.ps1*.</span><span class="sxs-lookup"><span data-stu-id="8d391-336">To resolve the error, use a different value for the name, which is in the Name parameter of *New-AzureWebsiteEnv.ps1*.</span></span>

[!code-console[Main](the-fix-it-sample-application/samples/sample30.cmd)]

### <a name="restarting-the-script"></a><span data-ttu-id="8d391-337">Ponowne uruchamianie skryptu</span><span class="sxs-lookup"><span data-stu-id="8d391-337">Restarting the script</span></span>

<span data-ttu-id="8d391-338">Jeśli zachodzi potrzeba ponownego uruchomienia *New AzureWebsiteEnv.ps1* skryptu ponieważ nie powiodło się, zanim ją wydrukowana komunikat "Skrypt będzie gotowy", możesz chcieć usunąć zasoby, które zatrzymane skrypt utworzony przed.</span><span class="sxs-lookup"><span data-stu-id="8d391-338">If you need to restart the *New-AzureWebsiteEnv.ps1* script because it failed before it printed the "Script is complete" message, you might want to delete resources that the script created before it stopped.</span></span> <span data-ttu-id="8d391-339">Na przykład skrypt już utworzono ContosoFixItDemo aplikacji sieci web i następnie ponownie uruchom skrypt o takiej samej nazwie, skrypt zakończy się niepowodzeniem, ponieważ nazwa jest używana.</span><span class="sxs-lookup"><span data-stu-id="8d391-339">For example, if the script already created the ContosoFixItDemo web app and you run the script again with the same name, the script will fail because the name is in use.</span></span>

<span data-ttu-id="8d391-340">Aby określić, które zasoby skrypt utworzony przed ona zatrzymana, użyj następujących poleceń cmdlet:</span><span class="sxs-lookup"><span data-stu-id="8d391-340">To determine which resources the script created before it stopped, use the following cmdlets:</span></span>

- `Get-AzureWebsite`
- `Get-AzureSqlDatabaseServer`
- <span data-ttu-id="8d391-341">`Get-AzureSqlDatabase`: Aby uruchomić to polecenie cmdlet, należy przekazać nazwę serwera bazy danych, aby `Get-AzureSqlDatabase`:   `Get-AzureSqlDatabaseServer | Get-AzureSqlDatabase.`</span><span class="sxs-lookup"><span data-stu-id="8d391-341">`Get-AzureSqlDatabase`: To run this cmdlet, pipe the database server name to `Get-AzureSqlDatabase`:   `Get-AzureSqlDatabaseServer | Get-AzureSqlDatabase.`</span></span>

<span data-ttu-id="8d391-342">Aby usunąć te zasoby, użyj następujących poleceń.</span><span class="sxs-lookup"><span data-stu-id="8d391-342">To delete these resources, use the following commands.</span></span> <span data-ttu-id="8d391-343">Należy pamiętać o tym, po usunięciu serwera bazy danych, automatyczne usunięcie bazy danych skojarzonej z serwerem.</span><span class="sxs-lookup"><span data-stu-id="8d391-343">Note that if you delete the database server, you automatically delete the databases associated with the server.</span></span>

- `Get-AzureWebsite -Name <WebsiteName> | Remove-AzureWebsite`
- `Get-AzureSqlDatabase -Name <DatabaseName> -ServerName <DatabaseServerName> | Remove-SqlAzureDatabase`
- `Get-AzureSqlDatabaseServer | Remove-AzureSqlDatabaseServer`

<a id="deployqueues"></a>
## <a name="how-to-deploy-the-app-with-queue-processing-to-azure-app-service-web-apps-and-an-azure-cloud-service"></a><span data-ttu-id="8d391-344">Jak wdrożyć aplikację za pomocą kolejki przetwarzania do usługi Azure App Service Web Apps i usługi w chmurze platformy Azure</span><span class="sxs-lookup"><span data-stu-id="8d391-344">How to deploy the app with queue processing to Azure App Service Web Apps and an Azure Cloud Service</span></span>

<span data-ttu-id="8d391-345">Aby włączyć kolejek, wprowadź następującą zmianę w pliku MyFixIt\Web.config.</span><span class="sxs-lookup"><span data-stu-id="8d391-345">To enable queues, make the following change in the MyFixIt\Web.config file.</span></span> <span data-ttu-id="8d391-346">W obszarze `appSettings`, zmień wartość właściwości `UseQueues` na wartość "true":</span><span class="sxs-lookup"><span data-stu-id="8d391-346">Under `appSettings`, change the value of `UseQueues` to "true":</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample31.xml)]

<span data-ttu-id="8d391-347">Wdrożenia aplikacji MVC w aplikacji sieci web w usłudze Azure App Service, zgodnie z opisem [wcześniej](#deploybase).</span><span class="sxs-lookup"><span data-stu-id="8d391-347">Then deploy the MVC application to an web app in Azure App Service, as described [earlier](#deploybase).</span></span>

<span data-ttu-id="8d391-348">Następnie należy utworzyć nową usługę w chmurze platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8d391-348">Next, create a new Azure cloud service.</span></span> <span data-ttu-id="8d391-349">Skryptach dołączonych za pomocą aplikacji naprawić nie tworzą ani nie wdrożyć usługę w chmurze, więc należy użyć witryny Azure portal, w tym.</span><span class="sxs-lookup"><span data-stu-id="8d391-349">The scripts included with the Fix It app do not create or deploy the cloud service, so you must use Azure portal for this.</span></span> <span data-ttu-id="8d391-350">W portalu, kliknij przycisk **nowy** -- **obliczenia** — **usługi w chmurze** -- **szybkie tworzenie**, a następnie wprowadź adres URL i lokalizację centrum danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-350">In the portal, click **New** -- **Compute** – **Cloud Service** -- **Quick Create**, and then enter a URL and a data center location.</span></span> <span data-ttu-id="8d391-351">Użyj tego samego centrum danych, w której została wdrożona w aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="8d391-351">Use the same data center where you deployed the web app.</span></span>

![](the-fix-it-sample-application/_static/image1.png)

<span data-ttu-id="8d391-352">Zanim będzie można wdrożyć usługę w chmurze, musisz zaktualizować niektóre pliki konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="8d391-352">Before you can deploy the cloud service, you need to update some of the configuration files.</span></span>

<span data-ttu-id="8d391-353">W MyFixIt.WorkerRoler\app.config w obszarze `connectionStrings`, zastąp wartość `appdb` parametrów połączenia parametrami połączenia dla bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="8d391-353">In MyFixIt.WorkerRoler\app.config, under `connectionStrings`, replace the value of the `appdb` connection string with the actual connection string for the SQL Database.</span></span> <span data-ttu-id="8d391-354">Parametry połączenia można uzyskać z portalu.</span><span class="sxs-lookup"><span data-stu-id="8d391-354">You can get the connection string from the portal.</span></span> <span data-ttu-id="8d391-355">W portalu, kliknij przycisk **baz danych SQL** - **appdb** - **parametry połączenia bazy danych SQL w widoku na potrzeby ADO .net, ODBC i PHP oraz JDBC**.</span><span class="sxs-lookup"><span data-stu-id="8d391-355">In the portal, click **SQL Databases** - **appdb** - **View SQL Database connection strings for ADO .Net, ODBC, PHP, and JDBC**.</span></span> <span data-ttu-id="8d391-356">Skopiuj parametry połączenia ADO.NET i wklej tę wartość do pliku app.config.</span><span class="sxs-lookup"><span data-stu-id="8d391-356">Copy the ADO.NET connection string and paste the value into the app.config file.</span></span> <span data-ttu-id="8d391-357">Zastąp "{Twoja\_hasło\_tutaj}" za pomocą hasła bazy danych.</span><span class="sxs-lookup"><span data-stu-id="8d391-357">Replace "{your\_password\_here}" with your database password.</span></span> <span data-ttu-id="8d391-358">(Zakładając, że skrypty są używane do wdrażania aplikacji MVC, określone hasło bazy danych w `SqlDatabasePassword` skryptu parametru.)</span><span class="sxs-lookup"><span data-stu-id="8d391-358">(Assuming you used the scripts to deploy the MVC app, you specified the database password in the `SqlDatabasePassword` script parameter.)</span></span>

<span data-ttu-id="8d391-359">Wynik powinien wyglądać następująco:</span><span class="sxs-lookup"><span data-stu-id="8d391-359">The result should look like the following:</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample32.xml)]

<span data-ttu-id="8d391-360">W tym samym pliku MyFixIt.WorkerRoler\app.config w obszarze `appSettings`, Zastąp dwie wartości symboli zastępczych dla konta usługi Azure storage.</span><span class="sxs-lookup"><span data-stu-id="8d391-360">In the same MyFixIt.WorkerRoler\app.config file, under `appSettings`, replace the two placeholder values for the Azure storage account.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample33.xml?highlight=2-3)]

<span data-ttu-id="8d391-361">Z poziomu portalu można uzyskać klucz dostępu.</span><span class="sxs-lookup"><span data-stu-id="8d391-361">You can get the access key from the portal.</span></span> <span data-ttu-id="8d391-362">Zobacz [sposób zarządzania kontami magazynu](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account).</span><span class="sxs-lookup"><span data-stu-id="8d391-362">See [How To Manage Storage Accounts](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account).</span></span>

<span data-ttu-id="8d391-363">W MyFixItCloudService\ServiceConfiguration.Cloud.cscfg Zastąp ten sam dwie wartości symboli zastępczych dla konta usługi Azure storage.</span><span class="sxs-lookup"><span data-stu-id="8d391-363">In MyFixItCloudService\ServiceConfiguration.Cloud.cscfg, replace the same two placeholders values for the Azure storage account.</span></span>

[!code-xml[Main](the-fix-it-sample-application/samples/sample34.xml?highlight=3)]

<span data-ttu-id="8d391-364">Teraz możesz przystąpić do wdrażania usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="8d391-364">Now you are ready to deploy the cloud service.</span></span> <span data-ttu-id="8d391-365">W Eksploratorze rozwiązań, kliknij prawym przyciskiem myszy projekt MyFixItCloudService, a następnie wybierz **Publikuj**.</span><span class="sxs-lookup"><span data-stu-id="8d391-365">In Solution Explore, right-click the MyFixItCloudService project and select **Publish**.</span></span> <span data-ttu-id="8d391-366">Aby uzyskać więcej informacji, zobacz "[wdrażanie aplikacji na platformie Azure](https://www.windowsazure.com/develop/net/tutorials/multi-tier-web-site/2-download-and-run/#deployAz)", która znajduje się w części 2 [w tym samouczku](https://code.msdn.microsoft.com/Windows-Azure-Multi-Tier-eadceb36).</span><span class="sxs-lookup"><span data-stu-id="8d391-366">For more information, see "[Deploy the Application to Azure](https://www.windowsazure.com/develop/net/tutorials/multi-tier-web-site/2-download-and-run/#deployAz)", which is in part 2 of [this tutorial](https://code.msdn.microsoft.com/Windows-Azure-Multi-Tier-eadceb36).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8d391-367">Poprzednie</span><span class="sxs-lookup"><span data-stu-id="8d391-367">Previous</span></span>](more-patterns-and-guidance.md)
