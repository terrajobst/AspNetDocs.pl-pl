---
uid: aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline
title: OWIN oprogramowanie pośredniczące w zintegrowanym potoku usług IIS | Microsoft Docs
author: Praburaj
description: W tym artykule pokazano, jak uruchamiać składniki pośredniczące OWIN (OMCs) w zintegrowanym potoku usług IIS oraz jak ustawić zdarzenie potoku, w którym jest uruchamiane OMC. Należy...
ms.author: riande
ms.date: 11/07/2013
ms.assetid: d031c021-33c2-45a5-bf9f-98f8fa78c2ab
msc.legacyurl: /aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline
msc.type: authoredcontent
ms.openlocfilehash: 7d157fb6bd9e2ae9b55af41ef06c1eb5e6310ce1
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/19/2020
ms.locfileid: "77456715"
---
# <a name="owin-middleware-in-the-iis-integrated-pipeline"></a><span data-ttu-id="cfd42-104">OWIN oprogramowanie pośredniczące w zintegrowanym potoku usług IIS</span><span class="sxs-lookup"><span data-stu-id="cfd42-104">OWIN Middleware in the IIS integrated pipeline</span></span>

<span data-ttu-id="cfd42-105">Autor [Praburaj Thiagarajan](https://github.com/Praburaj), [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="cfd42-105">by [Praburaj Thiagarajan](https://github.com/Praburaj), [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="cfd42-106">W tym artykule pokazano, jak uruchamiać składniki pośredniczące OWIN (OMCs) w zintegrowanym potoku usług IIS oraz jak ustawić zdarzenie potoku, w którym jest uruchamiane OMC.</span><span class="sxs-lookup"><span data-stu-id="cfd42-106">This article shows how to run OWIN middleware Components (OMCs) in the IIS integrated pipeline, and how to set the pipeline event an OMC runs on.</span></span> <span data-ttu-id="cfd42-107">Przed przeczytaniem tego samouczka należy zapoznać [się z omówieniem](an-overview-of-project-katana.md) [wykrywania klasy](owin-startup-class-detection.md) projektu Katana i Owin.</span><span class="sxs-lookup"><span data-stu-id="cfd42-107">You should review [An Overview of Project Katana](an-overview-of-project-katana.md) and [OWIN Startup Class Detection](owin-startup-class-detection.md) before reading this tutorial.</span></span> <span data-ttu-id="cfd42-108">Ten samouczek został utworzony przez Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ), Krzysztof Ross, Praburaj Thiagarajan i Howard Dierking ( [@howard\_Dierking](https://twitter.com/howard_dierking) ).</span><span class="sxs-lookup"><span data-stu-id="cfd42-108">This tutorial was written by Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ), Chris Ross, Praburaj Thiagarajan, and Howard Dierking ( [@howard\_dierking](https://twitter.com/howard_dierking) ).</span></span>

<span data-ttu-id="cfd42-109">Chociaż składniki pośredniczące [Owin](an-overview-of-project-katana.md) (OMCs) są przeznaczone głównie do uruchamiania w potoku serwer-niezależny od, można również uruchomić OMC w zintegrowanym potoku usług IIS (**Tryb klasyczny *nie* jest obsługiwany**).</span><span class="sxs-lookup"><span data-stu-id="cfd42-109">Although [OWIN](an-overview-of-project-katana.md) middleware components (OMCs) are primarily designed to run in a server-agnostic pipeline, it is possible to run an OMC in the IIS integrated pipeline as well (**classic mode is *not* supported**).</span></span> <span data-ttu-id="cfd42-110">OMC można wykonać w celu pracy w zintegrowanym potoku usług IIS, instalując następujący pakiet z konsoli Menedżera pakietów (PMC):</span><span class="sxs-lookup"><span data-stu-id="cfd42-110">An OMC can be made to work in the IIS integrated pipeline by installing the following package from the Package Manager Console (PMC):</span></span>

[!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample1.cmd)]

<span data-ttu-id="cfd42-111">Oznacza to, że wszystkie struktury aplikacji, nawet te, które nie są jeszcze uruchomione poza usługami IIS i system. Web, mogą korzystać z istniejących składników oprogramowania pośredniczącego OWIN.</span><span class="sxs-lookup"><span data-stu-id="cfd42-111">This means that all application frameworks, even those that are not yet able to run outside of IIS and System.Web, can benefit from existing OWIN middleware components.</span></span> 

> [!NOTE]
> <span data-ttu-id="cfd42-112">Wszystkie pakiety `Microsoft.Owin.Security.*` wysyłki przy użyciu nowego systemu tożsamości w Visual Studio 2013 (na przykład: pliki cookie, konta Microsoft, Google, Facebook, Twitter, [token](http://self-issued.info/docs/draft-ietf-oauth-v2-bearer.html)osoby podpisującej, uwierzytelniania OAuth, serwera autoryzacji, tokenu JWT, usługi Azure Active Directory i usług federacyjnych Active Directory) są tworzone jako OMCs i mogą być używane w scenariuszach hostowanych przez aplikacje samodzielne i IIS.</span><span class="sxs-lookup"><span data-stu-id="cfd42-112">All of the `Microsoft.Owin.Security.*` packages shipping with the new Identity System in Visual Studio 2013 (for example: Cookies, Microsoft Account, Google, Facebook, Twitter, [Bearer Token](http://self-issued.info/docs/draft-ietf-oauth-v2-bearer.html), OAuth, Authorization server, JWT, Azure Active directory, and Active directory federation services) are authored as OMCs, and can be used in both self-hosted and IIS-hosted scenarios.</span></span>

## <a name="how-owin-middleware-executes-in-the-iis-integrated-pipeline"></a><span data-ttu-id="cfd42-113">Jak działa oprogramowanie pośredniczące OWIN w zintegrowanym potoku usług IIS</span><span class="sxs-lookup"><span data-stu-id="cfd42-113">How OWIN Middleware Executes in the IIS Integrated Pipeline</span></span>

<span data-ttu-id="cfd42-114">W przypadku aplikacji konsolowych OWIN potok aplikacji zbudowany przy użyciu [konfiguracji uruchamiania](owin-startup-class-detection.md) jest ustawiany w kolejności, w jakiej składniki są dodawane za pomocą metody `IAppBuilder.Use`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-114">For OWIN console applications, the application pipeline built using the [startup configuration](owin-startup-class-detection.md) is set by the order the components are added using the `IAppBuilder.Use` method.</span></span> <span data-ttu-id="cfd42-115">Oznacza to, że potok OWIN w środowisku uruchomieniowym [Katana](an-overview-of-project-katana.md) przetwarza OMCs w kolejności, w jakiej zostały zarejestrowane przy użyciu `IAppBuilder.Use`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-115">That is, the OWIN pipeline in the [Katana](an-overview-of-project-katana.md) runtime will process OMCs in the order they were registered using `IAppBuilder.Use`.</span></span> <span data-ttu-id="cfd42-116">W zintegrowanym potoku usług IIS potok żądań składa się z elementu [HttpModules](https://msdn.microsoft.com/library/ms178468(v=vs.85).aspx) subskrybowanego ze wstępnie zdefiniowanym zestawem zdarzeń potoku, takich jak [BeginRequest](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx), [AuthenticateRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx), [AuthorizeRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx)itd.</span><span class="sxs-lookup"><span data-stu-id="cfd42-116">In the IIS integrated pipeline the request pipeline consists of [HttpModules](https://msdn.microsoft.com/library/ms178468(v=vs.85).aspx) subscribed to a pre-defined set of the pipeline events such as [BeginRequest](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx), [AuthenticateRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx), [AuthorizeRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx), etc.</span></span>

<span data-ttu-id="cfd42-117">W przypadku porównania OMC z tym modułem [HttpModule](https://msdn.microsoft.com/library/zec9k340(v=vs.85).aspx) w świecie ASP.NET, OMC musi być zarejestrowany w poprawnym wstępnie zdefiniowanym zdarzeniu potoku.</span><span class="sxs-lookup"><span data-stu-id="cfd42-117">If we compare an OMC to that of an [HttpModule](https://msdn.microsoft.com/library/zec9k340(v=vs.85).aspx) in the ASP.NET world, an OMC must be registered to the correct pre-defined pipeline event.</span></span> <span data-ttu-id="cfd42-118">Na przykład `MyModule` HttpModule zostanie wywołane, gdy żądanie znajdzie się na etapie [AuthenticateRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) w potoku:</span><span class="sxs-lookup"><span data-stu-id="cfd42-118">For example, the HttpModule `MyModule` will get invoked when a request comes to the [AuthenticateRequest](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) stage in the pipeline:</span></span>

[!code-csharp[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample2.cs?highlight=10)]

<span data-ttu-id="cfd42-119">Aby OMC uczestniczył w tej samej kolejności wykonywania opartej na zdarzeniach, kod środowiska uruchomieniowego [Katana](an-overview-of-project-katana.md) skanuje się za pośrednictwem [konfiguracji uruchamiania](owin-startup-class-detection.md) i subskrybuje poszczególne składniki oprogramowania pośredniczącego w ramach zintegrowanego zdarzenia potoku.</span><span class="sxs-lookup"><span data-stu-id="cfd42-119">In order for an OMC to participate in this same, event-based execution ordering, the [Katana](an-overview-of-project-katana.md) runtime code scans through the [startup configuration](owin-startup-class-detection.md) and subscribes each of the middleware components to an integrated pipeline event.</span></span> <span data-ttu-id="cfd42-120">Na przykład poniższy kod rejestracyjny OMC i Registration umożliwia wyświetlenie domyślnej rejestracji zdarzeń komponentów oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="cfd42-120">For example, the following OMC and registration code enables you to see the default event registration of middleware components.</span></span> <span data-ttu-id="cfd42-121">(Aby uzyskać bardziej szczegółowe instrukcje dotyczące tworzenia klasy startowej OWIN, zobacz [wykrywanie klasy początkowej Owin](owin-startup-class-detection.md)).</span><span class="sxs-lookup"><span data-stu-id="cfd42-121">(For more detailed instructions on creating an OWIN startup class, see [OWIN Startup Class Detection](owin-startup-class-detection.md).)</span></span>

1. <span data-ttu-id="cfd42-122">Utwórz pusty projekt aplikacji sieci Web i nadaj mu nazwę **owin2**.</span><span class="sxs-lookup"><span data-stu-id="cfd42-122">Create an empty web application project and name it **owin2**.</span></span>
2. <span data-ttu-id="cfd42-123">W konsoli Menedżera pakietów (PMC) Uruchom następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="cfd42-123">From the Package Manager Console (PMC), run the following command:</span></span> 

    [!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample3.cmd)]
3. <span data-ttu-id="cfd42-124">Dodaj `OWIN Startup Class` i nadaj jej nazwę `Startup`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-124">Add an `OWIN Startup Class` and name it `Startup`.</span></span> <span data-ttu-id="cfd42-125">Zamień wygenerowany kod na następujący (zmiany są wyróżnione):</span><span class="sxs-lookup"><span data-stu-id="cfd42-125">Replace the generated code with the following (the changes are highlighted):</span></span>  

    [!code-csharp[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample4.cs?highlight=5-7,15-36)]
4. <span data-ttu-id="cfd42-126">Naciśnij klawisz F5, aby uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="cfd42-126">Hit F5 to run the app.</span></span>

<span data-ttu-id="cfd42-127">Konfiguracja uruchamiania konfiguruje potok z trzema składnikami pośredniczącymi, pierwsze dwa wyświetlania informacji diagnostycznych i ostatnią odpowiedzią na zdarzenia (a także wyświetlaniem informacji diagnostycznych).</span><span class="sxs-lookup"><span data-stu-id="cfd42-127">The Startup configuration sets up a pipeline with three middleware components, the first two displaying diagnostic information and the last one responding to events (and also displaying diagnostic information).</span></span> <span data-ttu-id="cfd42-128">Metoda `PrintCurrentIntegratedPipelineStage` wyświetla zintegrowane zdarzenie potoku, w którym jest wywoływana oprogramowanie pośredniczące i komunikat.</span><span class="sxs-lookup"><span data-stu-id="cfd42-128">The `PrintCurrentIntegratedPipelineStage` method displays the integrated pipeline event this middleware is invoked on and a message.</span></span> <span data-ttu-id="cfd42-129">W oknach danych wyjściowych są wyświetlane następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="cfd42-129">The output windows displays the following:</span></span>

[!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample5.cmd)]

<span data-ttu-id="cfd42-130">Środowisko uruchomieniowe Katana zamapować każdy składnik oprogramowania pośredniczącego OWIN na [PreExecuteRequestHandler](https://msdn.microsoft.com/library/system.web.httpapplication.prerequesthandlerexecute.aspx) domyślnie, który odpowiada [PreRequestHandlerExecute](https://msdn.microsoft.com/library/system.web.httpapplication.prerequesthandlerexecute.aspx)zdarzeń potoku usług IIS.</span><span class="sxs-lookup"><span data-stu-id="cfd42-130">The Katana runtime mapped each of the OWIN middleware components to [PreExecuteRequestHandler](https://msdn.microsoft.com/library/system.web.httpapplication.prerequesthandlerexecute.aspx) by default, which corresponds to the IIS pipeline event [PreRequestHandlerExecute](https://msdn.microsoft.com/library/system.web.httpapplication.prerequesthandlerexecute.aspx).</span></span>

## <a name="stage-markers"></a><span data-ttu-id="cfd42-131">Znaczniki etapu</span><span class="sxs-lookup"><span data-stu-id="cfd42-131">Stage Markers</span></span>

<span data-ttu-id="cfd42-132">Można oznaczyć OMCs do wykonania na określonych etapach potoku przy użyciu metody rozszerzenia `IAppBuilder UseStageMarker()`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-132">You can mark OMCs to execute at specific stages of the pipeline by using the `IAppBuilder UseStageMarker()` extension method.</span></span> <span data-ttu-id="cfd42-133">Aby uruchomić zestaw komponentów oprogramowania pośredniczącego na określonym etapie, Wstaw znacznik etapu bezpośrednio po ostatnim składniku jest ustawiony podczas rejestracji.</span><span class="sxs-lookup"><span data-stu-id="cfd42-133">To run a set of middleware components during a particular stage, insert a stage marker right after the last component is the set during registration.</span></span> <span data-ttu-id="cfd42-134">Istnieją reguły, na których etapie potoku można wykonywać oprogramowanie pośredniczące, a składniki zamówienia muszą zostać uruchomione (reguły są wyjaśnione w dalszej części tego samouczka).</span><span class="sxs-lookup"><span data-stu-id="cfd42-134">There are rules on which stage of the pipeline you can execute middleware and the order components must run (The rules are explained later in the tutorial).</span></span> <span data-ttu-id="cfd42-135">Dodaj metodę `UseStageMarker` do kodu `Configuration`, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="cfd42-135">Add the `UseStageMarker` method to the `Configuration` code as shown below:</span></span>

[!code-csharp[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample6.cs?highlight=13,19)]

<span data-ttu-id="cfd42-136">Wywołanie `app.UseStageMarker(PipelineStage.Authenticate)` konfiguruje wszystkie zarejestrowane wcześniej składniki pośredniczące (w tym przypadku nasze dwa składniki diagnostyczne) do uruchomienia na etapie uwierzytelniania potoku.</span><span class="sxs-lookup"><span data-stu-id="cfd42-136">The `app.UseStageMarker(PipelineStage.Authenticate)` call configures all the previously registered middleware components (in this case, our two diagnostic components) to run on the authentication stage of the pipeline.</span></span> <span data-ttu-id="cfd42-137">Ostatni składnik pośredniczący (który wyświetla diagnostykę i reaguje na żądania) zostanie uruchomiony na etapie `ResolveCache` (zdarzenie [ResolveRequestCache](https://msdn.microsoft.com/library/system.web.httpapplication.resolverequestcache.aspx) ).</span><span class="sxs-lookup"><span data-stu-id="cfd42-137">The last middleware component (which displays diagnostics and responds to requests) will run on the `ResolveCache` stage (the [ResolveRequestCache](https://msdn.microsoft.com/library/system.web.httpapplication.resolverequestcache.aspx) event).</span></span>

<span data-ttu-id="cfd42-138">Naciśnij klawisz F5, aby uruchomić aplikację. W oknie dane wyjściowe są wyświetlane następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="cfd42-138">Hit F5 to run the app.The output window shows the following:</span></span>

[!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample7.cmd)]

## <a name="stage-marker-rules"></a><span data-ttu-id="cfd42-139">Reguły znaczników etapu</span><span class="sxs-lookup"><span data-stu-id="cfd42-139">Stage Marker Rules</span></span>

<span data-ttu-id="cfd42-140">Składniki pośredniczące Owin (OMC) można skonfigurować tak, aby były uruchamiane w następujących zdarzeniach etapów potoku OWIN:</span><span class="sxs-lookup"><span data-stu-id="cfd42-140">Owin middleware components (OMC) can be configured to run at the following OWIN pipeline stage events:</span></span>

[!code-csharp[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample8.cs)]

1. <span data-ttu-id="cfd42-141">Domyślnie OMCs jest uruchamiany przy ostatnim zdarzeniu (`PreHandlerExecute`).</span><span class="sxs-lookup"><span data-stu-id="cfd42-141">By default, OMCs run at the last event (`PreHandlerExecute`).</span></span> <span data-ttu-id="cfd42-142">Dlatego nasz pierwszy przykładowy kod jest wyświetlany jako "PreExecuteRequestHandler".</span><span class="sxs-lookup"><span data-stu-id="cfd42-142">That's why our first example code displayed "PreExecuteRequestHandler".</span></span>
2. <span data-ttu-id="cfd42-143">Można użyć metody `app.UseStageMarker`, aby zarejestrować OMC do uruchamiania wcześniej, na dowolnym etapie potoku OWIN na liście `PipelineStage` enum.</span><span class="sxs-lookup"><span data-stu-id="cfd42-143">You can use the a `app.UseStageMarker` method to register a OMC to run earlier, at any stage of the OWIN pipeline listed in the `PipelineStage` enum.</span></span>
3. <span data-ttu-id="cfd42-144">Potok OWIN i potok usług IIS są uporządkowane, dlatego wywołania do `app.UseStageMarker` muszą być w kolejności.</span><span class="sxs-lookup"><span data-stu-id="cfd42-144">The OWIN pipeline and the IIS pipeline is ordered, therefore calls to `app.UseStageMarker` must be in order.</span></span> <span data-ttu-id="cfd42-145">Nie można ustawić obsługi zdarzeń przed ostatnim zdarzeniem zarejestrowanym w usłudze do `app.UseStageMarker`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-145">You cannot set the event handler to an event that precedes the last event registered with to `app.UseStageMarker`.</span></span> <span data-ttu-id="cfd42-146">Na przykład *po* wywołaniu:</span><span class="sxs-lookup"><span data-stu-id="cfd42-146">For example, *after* calling:</span></span>

    [!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample9.cmd)]

   <span data-ttu-id="cfd42-147">wywołania `app.UseStageMarker` przekazywanie `Authenticate` lub `PostAuthenticate` nie będą honorowane i żaden wyjątek nie zostanie wygenerowany.</span><span class="sxs-lookup"><span data-stu-id="cfd42-147">calls to `app.UseStageMarker` passing `Authenticate` or `PostAuthenticate` will not be honored, and no exception will be thrown.</span></span> <span data-ttu-id="cfd42-148">OMCs jest uruchamiany na najnowszym etapie, który domyślnie jest `PreHandlerExecute`.</span><span class="sxs-lookup"><span data-stu-id="cfd42-148">OMCs run at the latest stage, which by default is `PreHandlerExecute`.</span></span> <span data-ttu-id="cfd42-149">Znaczniki etapów są używane do uruchamiania ich wcześniej.</span><span class="sxs-lookup"><span data-stu-id="cfd42-149">The stage markers are used to make them to run earlier.</span></span> <span data-ttu-id="cfd42-150">Jeśli określisz znaczniki etapu poza kolejnością, zaokrąglimy do wcześniejszego znacznika.</span><span class="sxs-lookup"><span data-stu-id="cfd42-150">If you specify stage markers out of order, we round to the earlier marker.</span></span> <span data-ttu-id="cfd42-151">Innymi słowy dodanie znacznika etapu ma wartość "Uruchom nie później niż etap X".</span><span class="sxs-lookup"><span data-stu-id="cfd42-151">In other words, adding a stage marker says "Run no later than stage X".</span></span> <span data-ttu-id="cfd42-152">OMC jest uruchamiany na najwcześniejszym znaczniku etapu dodanym po nim w potoku OWIN.</span><span class="sxs-lookup"><span data-stu-id="cfd42-152">OMC's run at the earliest stage marker added after them in the OWIN pipeline.</span></span>
4. <span data-ttu-id="cfd42-153">Najwcześniejszy etap wywołań do `app.UseStageMarker` usługi WINS.</span><span class="sxs-lookup"><span data-stu-id="cfd42-153">The earliest stage of calls to `app.UseStageMarker` wins.</span></span> <span data-ttu-id="cfd42-154">Jeśli na przykład przełączysz kolejność `app.UseStageMarker` wywołań z poprzedniego przykładu:</span><span class="sxs-lookup"><span data-stu-id="cfd42-154">For example, if you switch the order of `app.UseStageMarker` calls from our previous example:</span></span>

    [!code-csharp[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample10.cs?highlight=13,19)]

   <span data-ttu-id="cfd42-155">Zostanie wyświetlone okno dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="cfd42-155">The output window will display:</span></span> 

    [!code-console[Main](owin-middleware-in-the-iis-integrated-pipeline/samples/sample11.cmd)]

   <span data-ttu-id="cfd42-156">OMCs wszystkie uruchomione na etapie `AuthenticateRequest`, ponieważ ostatnie OMC zarejestrowane w zdarzeniu `Authenticate` i zdarzenie `Authenticate` poprzedza wszystkie inne zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="cfd42-156">The OMCs all run in the `AuthenticateRequest` stage, because the last OMC registered with the `Authenticate` event, and the `Authenticate` event precedes all other events.</span></span>
