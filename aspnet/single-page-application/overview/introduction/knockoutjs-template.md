---
uid: single-page-application/overview/introduction/knockoutjs-template
title: 'Aplikacja jednostronicowa: szablon KnockoutJS | Microsoft Docs'
author: MikeWasson
description: Szablon odcinania
ms.author: riande
ms.date: 01/30/2013
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: 3a551db1caa9636eb7f2e04c287d3ef371263584
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/06/2020
ms.locfileid: "78578695"
---
# <a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="851b1-103">Aplikacja jednostronicowa: szablon KnockoutJS</span><span class="sxs-lookup"><span data-stu-id="851b1-103">Single Page Application: KnockoutJS template</span></span>

<span data-ttu-id="851b1-104">według [Jan Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="851b1-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="851b1-105">Odcinanie szablonu MVC jest częścią ASP.NET and Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="851b1-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="851b1-106">Pobierz ASP.NET and Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="851b1-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)

<span data-ttu-id="851b1-107">Aktualizacja ASP.NET and Web Tools 2012,2 obejmuje szablon aplikacji jednostronicowej (SPA) dla ASP.NET MVC 4.</span><span class="sxs-lookup"><span data-stu-id="851b1-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="851b1-108">Ten szablon został zaprojektowany, aby szybko rozpocząć tworzenie interaktywnych aplikacji sieci Web po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="851b1-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="851b1-109">"Aplikacja jednostronicowa" (SPA) to ogólny termin aplikacji sieci Web, który ładuje pojedynczą stronę HTML, a następnie automatycznie aktualizuje stronę, zamiast ładować nowe strony.</span><span class="sxs-lookup"><span data-stu-id="851b1-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="851b1-110">Po początkowym załadowaniu strony SPA komunikuje się z serwerem przez żądania AJAX.</span><span class="sxs-lookup"><span data-stu-id="851b1-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="851b1-111">Technologia AJAX nie ma nic nowego, ale dzisiaj istnieją struktury języka JavaScript, które ułatwiają tworzenie i konserwowanie dużej zaawansowanej aplikacji SPA.</span><span class="sxs-lookup"><span data-stu-id="851b1-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="851b1-112">Ponadto kod HTML 5 i CSS3 ułatwiają tworzenie bogatych interfejsów użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="851b1-113">Aby rozpocząć pracę, szablon SPA tworzy przykład aplikacji "Lista czynności do wykonania".</span><span class="sxs-lookup"><span data-stu-id="851b1-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="851b1-114">W tym samouczku zajmiemy się szablonem.</span><span class="sxs-lookup"><span data-stu-id="851b1-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="851b1-115">Najpierw przyjrzyjmy się aplikacji z listą zadań do wykonania, a następnie przeanalizować elementy technologii, które go działają.</span><span class="sxs-lookup"><span data-stu-id="851b1-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="851b1-116">Utwórz nowy projekt szablonu SPA</span><span class="sxs-lookup"><span data-stu-id="851b1-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="851b1-117">Wymagania:</span><span class="sxs-lookup"><span data-stu-id="851b1-117">Requirements:</span></span>

- <span data-ttu-id="851b1-118">Visual Studio 2012 lub Visual Studio Express 2012 dla sieci Web</span><span class="sxs-lookup"><span data-stu-id="851b1-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="851b1-119">ASP.NET Web Tools 2012,2 Update.</span><span class="sxs-lookup"><span data-stu-id="851b1-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="851b1-120">Tę aktualizację można zainstalować w [tym miejscu](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span><span class="sxs-lookup"><span data-stu-id="851b1-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="851b1-121">Uruchom program Visual Studio i wybierz pozycję **Nowy projekt** na stronie startowej.</span><span class="sxs-lookup"><span data-stu-id="851b1-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="851b1-122">Lub w menu **plik** wybierz polecenie **Nowy** , a następnie pozycję **projekt**.</span><span class="sxs-lookup"><span data-stu-id="851b1-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="851b1-123">W okienku **Szablony** wybierz pozycję **zainstalowane szablony** i rozwiń węzeł **Wizualizacja C#**  .</span><span class="sxs-lookup"><span data-stu-id="851b1-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="851b1-124">W **obszarze C#Wizualizacja** wybierz pozycję **Sieć Web**.</span><span class="sxs-lookup"><span data-stu-id="851b1-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="851b1-125">Na liście szablonów projektu wybierz pozycję **aplikacja sieci Web MVC 4 ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="851b1-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="851b1-126">Nazwij projekt, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="851b1-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="851b1-127">W kreatorze **nowego projektu** wybierz pozycję **aplikacja jednostronicowa**.</span><span class="sxs-lookup"><span data-stu-id="851b1-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="851b1-128">Naciśnij klawisz F5, aby skompilować i uruchomić aplikację.</span><span class="sxs-lookup"><span data-stu-id="851b1-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="851b1-129">Po pierwszym uruchomieniu aplikacji zostanie wyświetlony ekran logowania.</span><span class="sxs-lookup"><span data-stu-id="851b1-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="851b1-130">Kliknij link &quot;Utwórz konto&quot; i Utwórz nowego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="851b1-131">Po zalogowaniu aplikacja tworzy domyślną listę zadań do zrobienia z dwoma elementami.</span><span class="sxs-lookup"><span data-stu-id="851b1-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="851b1-132">Możesz kliknąć pozycję "Dodaj listę zadań do zrobienia", aby dodać nową listę.</span><span class="sxs-lookup"><span data-stu-id="851b1-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="851b1-133">Zmień nazwę listy, Dodaj elementy do listy i sprawdź je.</span><span class="sxs-lookup"><span data-stu-id="851b1-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="851b1-134">Możesz również usunąć elementy lub usunąć całą listę.</span><span class="sxs-lookup"><span data-stu-id="851b1-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="851b1-135">Zmiany są automatycznie utrwalane w bazie danych na serwerze (w rzeczywistości LocalDB w tym momencie, ponieważ aplikacja jest uruchamiana lokalnie).</span><span class="sxs-lookup"><span data-stu-id="851b1-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="851b1-136">Architektura szablonu SPA</span><span class="sxs-lookup"><span data-stu-id="851b1-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="851b1-137">Ten diagram przedstawia główne bloki konstrukcyjne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="851b1-138">Po stronie serwera ASP.NET MVC obsługuje kod HTML, a także obsługuje uwierzytelnianie oparte na formularzach.</span><span class="sxs-lookup"><span data-stu-id="851b1-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="851b1-139">Interfejs API sieci Web ASP.NET obsługuje wszystkie żądania, które odnoszą się do ToDoLists i ToDoItems, w tym pobieranie, tworzenie, aktualizowanie i usuwanie.</span><span class="sxs-lookup"><span data-stu-id="851b1-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="851b1-140">Klient wymienia dane z interfejsem API sieci Web w formacie JSON.</span><span class="sxs-lookup"><span data-stu-id="851b1-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="851b1-141">Entity Framework (EF) to warstwa O/RM.</span><span class="sxs-lookup"><span data-stu-id="851b1-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="851b1-142">Koryguje się między ASP.NET zorientowanym na obiekty a podstawową bazą danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="851b1-143">Baza danych używa LocalDB, ale można ją zmienić w pliku Web. config.</span><span class="sxs-lookup"><span data-stu-id="851b1-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="851b1-144">Zazwyczaj można używać LocalDB do lokalnego tworzenia oprogramowania, a następnie wdrażać je w bazie danych SQL na serwerze przy użyciu programu EF Code-First Migration.</span><span class="sxs-lookup"><span data-stu-id="851b1-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="851b1-145">Po stronie klienta Biblioteka odcinania. js obsługuje aktualizacje stron z żądań AJAX.</span><span class="sxs-lookup"><span data-stu-id="851b1-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="851b1-146">Odcinanie używa powiązania danych do synchronizowania strony z najnowszymi danymi.</span><span class="sxs-lookup"><span data-stu-id="851b1-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="851b1-147">Dzięki temu nie trzeba pisać żadnego kodu, który przegląda dane JSON i aktualizuje DOM.</span><span class="sxs-lookup"><span data-stu-id="851b1-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="851b1-148">Zamiast tego należy umieścić atrybuty deklaracyjne w kodzie HTML, które informują o odcinania sposobu prezentowania danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="851b1-149">Dużą zaletą tej architektury jest oddzielenie warstwy prezentacji od logiki aplikacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="851b1-150">Część internetowego interfejsu API można utworzyć bez znajomości informacji o tym, jak będzie wyglądać Strona sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="851b1-151">Po stronie klienta utworzysz "model widoku", aby reprezentować te dane, a model widoku używa odcinania do powiązania z kodem HTML.</span><span class="sxs-lookup"><span data-stu-id="851b1-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="851b1-152">Pozwala to łatwo zmieniać Kod HTML bez zmiany modelu widoku.</span><span class="sxs-lookup"><span data-stu-id="851b1-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="851b1-153">(Wyszukamy nieco odcinania później).</span><span class="sxs-lookup"><span data-stu-id="851b1-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="851b1-154">Modele</span><span class="sxs-lookup"><span data-stu-id="851b1-154">Models</span></span>

<span data-ttu-id="851b1-155">W projekcie programu Visual Studio folder modele zawiera modele, które są używane po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="851b1-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="851b1-156">(Na stronie klienta znajdują się również modele i są one dostępne).</span><span class="sxs-lookup"><span data-stu-id="851b1-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="851b1-157">**TodoItem, TodoList**</span><span class="sxs-lookup"><span data-stu-id="851b1-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="851b1-158">Są to modele baz danych dla Code First Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="851b1-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="851b1-159">Zwróć uwagę, że te modele mają właściwości wskazujące na siebie.</span><span class="sxs-lookup"><span data-stu-id="851b1-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="851b1-160">`ToDoList` zawiera kolekcję ToDoItems, a każda `ToDoItem` ma odwołanie z powrotem do jego nadrzędnej ToDoList.</span><span class="sxs-lookup"><span data-stu-id="851b1-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="851b1-161">Właściwości te są nazywane właściwościami nawigacji i reprezentują relację "jeden do wielu" i "do".</span><span class="sxs-lookup"><span data-stu-id="851b1-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="851b1-162">Klasa `ToDoItem` używa również atrybutu **[ForeignKey]** , aby określić, że `ToDoListId` jest kluczem obcym w tabeli `ToDoList`.</span><span class="sxs-lookup"><span data-stu-id="851b1-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="851b1-163">Oznacza to, że Dr dodaje do bazy danych ograniczenie klucza obcego.</span><span class="sxs-lookup"><span data-stu-id="851b1-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="851b1-164">**TodoItemDto, TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="851b1-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="851b1-165">Te klasy definiują dane, które zostaną wysłane do klienta.</span><span class="sxs-lookup"><span data-stu-id="851b1-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="851b1-166">"DTO" oznacza "obiekt transferu danych".</span><span class="sxs-lookup"><span data-stu-id="851b1-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="851b1-167">DTO definiuje sposób serializacji jednostek do formatu JSON.</span><span class="sxs-lookup"><span data-stu-id="851b1-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="851b1-168">Ogólnie rzecz biorąc, istnieje kilka powodów, dla których należy używać DTO:</span><span class="sxs-lookup"><span data-stu-id="851b1-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="851b1-169">Do kontrolowania, które właściwości są serializowane.</span><span class="sxs-lookup"><span data-stu-id="851b1-169">To control which properties are serialized.</span></span> <span data-ttu-id="851b1-170">DTO może zawierać podzestaw właściwości z modelu domeny.</span><span class="sxs-lookup"><span data-stu-id="851b1-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="851b1-171">Można to zrobić ze względów bezpieczeństwa (w celu ukrycia poufnych danych) lub po prostu zmniejszyć ilość wysyłanych danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="851b1-172">Aby zmienić kształt danych — na przykład, aby spłaszczyć bardziej złożoną strukturę danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="851b1-173">Aby zachować logikę biznesową z DTO (separacja problemów).</span><span class="sxs-lookup"><span data-stu-id="851b1-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="851b1-174">Jeśli z jakiegoś powodu nie można serializować modeli domeny.</span><span class="sxs-lookup"><span data-stu-id="851b1-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="851b1-175">Na przykład odwołania cykliczne mogą spowodować problemy podczas serializacji obiektu. Istnieją sposoby obsługi tego problemu w interfejsie API sieci Web (zobacz [Obsługa cyklicznych odwołań do obiektów](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); Jednak użycie DTO po prostu pozwala uniknąć całkowitego problemu.</span><span class="sxs-lookup"><span data-stu-id="851b1-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="851b1-176">W szablonie SPA DTO zawiera te same dane, co modele domen.</span><span class="sxs-lookup"><span data-stu-id="851b1-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="851b1-177">Jednak nadal są przydatne, ponieważ unikają odwołań cyklicznych ze wszystkich właściwości nawigacji i pokazują ogólny wzorzec DTO.</span><span class="sxs-lookup"><span data-stu-id="851b1-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="851b1-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="851b1-178">**AccountModels.cs**</span></span>

<span data-ttu-id="851b1-179">Ten plik zawiera modele przynależności do lokacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-179">This file contains models for site membership.</span></span> <span data-ttu-id="851b1-180">Klasa `UserProfile` definiuje schemat profilów użytkowników w bazie danych członkostwa.</span><span class="sxs-lookup"><span data-stu-id="851b1-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="851b1-181">(W tym przypadku jedyne informacje to identyfikator użytkownika i nazwa użytkownika). Inne klasy modelu w tym pliku są używane do tworzenia formularzy rejestracji i logowania użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="851b1-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="851b1-182">Entity Framework</span></span>

<span data-ttu-id="851b1-183">Szablon SPA używa EF Code First.</span><span class="sxs-lookup"><span data-stu-id="851b1-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="851b1-184">W programie Code First Development definiujemy modele najpierw w kodzie, a następnie w celu utworzenia bazy danych program EF korzysta z modelu.</span><span class="sxs-lookup"><span data-stu-id="851b1-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="851b1-185">Można również użyć EF z istniejącą bazą danych ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span><span class="sxs-lookup"><span data-stu-id="851b1-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="851b1-186">Klasa `TodoItemContext` w folderze models pochodzi z **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="851b1-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="851b1-187">Ta klasa zawiera "Glue" między modelami i EF.</span><span class="sxs-lookup"><span data-stu-id="851b1-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="851b1-188">`TodoItemContext` zawiera kolekcję `ToDoItem` i kolekcję `TodoList`.</span><span class="sxs-lookup"><span data-stu-id="851b1-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="851b1-189">Aby wysłać zapytanie do bazy danych, wystarczy napisać zapytanie LINQ względem tych kolekcji.</span><span class="sxs-lookup"><span data-stu-id="851b1-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="851b1-190">Na przykład Oto jak można wybrać wszystkie listy czynności do wykonania dla użytkownika "Alicja":</span><span class="sxs-lookup"><span data-stu-id="851b1-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="851b1-191">Możesz również dodać nowe elementy do kolekcji, zaktualizować elementy lub usunąć elementy z kolekcji i zachować zmiany w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="851b1-192">Kontrolery interfejsu API sieci Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="851b1-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="851b1-193">W interfejsie Web API ASP.NET kontrolery są obiektami, które obsługują żądania HTTP.</span><span class="sxs-lookup"><span data-stu-id="851b1-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="851b1-194">Jak wspomniano, szablon SPA używa interfejsu API sieci Web, aby włączyć operacje CRUD na wystąpieniach `ToDoList` i `ToDoItem`.</span><span class="sxs-lookup"><span data-stu-id="851b1-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="851b1-195">Kontrolery znajdują się w folderze controllers rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="851b1-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="851b1-196">`TodoController`: obsługuje żądania HTTP dla elementów do wykonania</span><span class="sxs-lookup"><span data-stu-id="851b1-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="851b1-197">`TodoListController`: obsługuje żądania HTTP dla list czynności do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="851b1-198">Te nazwy są istotne, ponieważ interfejs API sieci Web dopasowuje ścieżkę identyfikatora URI do nazwy kontrolera.</span><span class="sxs-lookup"><span data-stu-id="851b1-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="851b1-199">(Aby dowiedzieć się, jak interfejs API sieci Web kieruje żądania HTTP do kontrolerów, zobacz [Routing in Web api ASP.NET](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span><span class="sxs-lookup"><span data-stu-id="851b1-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="851b1-200">Przyjrzyjmy się klasie `ToDoListController`.</span><span class="sxs-lookup"><span data-stu-id="851b1-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="851b1-201">Zawiera pojedynczy element członkowski danych:</span><span class="sxs-lookup"><span data-stu-id="851b1-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="851b1-202">`TodoItemContext` jest używany do komunikowania się z EF zgodnie z wcześniejszym opisem.</span><span class="sxs-lookup"><span data-stu-id="851b1-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="851b1-203">Metody na kontrolerze implementują operacje CRUD.</span><span class="sxs-lookup"><span data-stu-id="851b1-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="851b1-204">Interfejs API sieci Web mapuje żądania HTTP z klienta na metody kontrolera w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="851b1-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="851b1-205">Żądanie HTTP</span><span class="sxs-lookup"><span data-stu-id="851b1-205">HTTP Request</span></span> | <span data-ttu-id="851b1-206">Controller — Metoda</span><span class="sxs-lookup"><span data-stu-id="851b1-206">Controller Method</span></span> | <span data-ttu-id="851b1-207">Opis</span><span class="sxs-lookup"><span data-stu-id="851b1-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="851b1-208">Pobierz /api/todo</span><span class="sxs-lookup"><span data-stu-id="851b1-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="851b1-209">Pobiera kolekcję list do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="851b1-210">Pobierz*Identyfikator* /API/TODO/</span><span class="sxs-lookup"><span data-stu-id="851b1-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="851b1-211">Pobiera listę czynności do wykonania według identyfikatora</span><span class="sxs-lookup"><span data-stu-id="851b1-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="851b1-212">WPROWADŹ*Identyfikator* /API/TODO/</span><span class="sxs-lookup"><span data-stu-id="851b1-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="851b1-213">Aktualizuje listę czynności do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="851b1-214">OPUBLIKUJ/api/zadań do wykonania</span><span class="sxs-lookup"><span data-stu-id="851b1-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="851b1-215">Tworzy nową listę do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="851b1-216">Usuń*Identyfikator* /API/TODO/</span><span class="sxs-lookup"><span data-stu-id="851b1-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="851b1-217">Usuwa listę zadań do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="851b1-218">Zwróć uwagę, że identyfikatory URI dla niektórych operacji zawierają symbole zastępcze dla wartości identyfikatora.</span><span class="sxs-lookup"><span data-stu-id="851b1-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="851b1-219">Na przykład aby usunąć listę z IDENTYFIKATORem 42, identyfikator URI jest `/api/todo/42`.</span><span class="sxs-lookup"><span data-stu-id="851b1-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="851b1-220">Aby dowiedzieć się więcej o korzystaniu z interfejsu API sieci Web dla operacji CRUD, zobacz [Tworzenie internetowego interfejsu API, który obsługuje operacje CRUD](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span><span class="sxs-lookup"><span data-stu-id="851b1-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="851b1-221">Kod dla tego kontrolera jest dość prosty.</span><span class="sxs-lookup"><span data-stu-id="851b1-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="851b1-222">Oto kilka interesujących punktów:</span><span class="sxs-lookup"><span data-stu-id="851b1-222">Here are some interesting points:</span></span>

- <span data-ttu-id="851b1-223">Metoda `GetTodoLists` używa zapytania LINQ do filtrowania wyników według identyfikatora zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="851b1-224">W ten sposób użytkownik widzi tylko te dane, które należą do niego.</span><span class="sxs-lookup"><span data-stu-id="851b1-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="851b1-225">Należy również zauważyć, że instrukcja SELECT służy do konwertowania wystąpień `ToDoList` na wystąpienia `TodoListDto`.</span><span class="sxs-lookup"><span data-stu-id="851b1-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="851b1-226">Metody PUT i POST sprawdzają stan modelu przed modyfikacją bazy danych.</span><span class="sxs-lookup"><span data-stu-id="851b1-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="851b1-227">Jeśli **ModelState. IsValid** ma wartość false, te metody zwracają http 400, złe żądanie.</span><span class="sxs-lookup"><span data-stu-id="851b1-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="851b1-228">Przeczytaj więcej na temat weryfikacji modelu w interfejsie Web API podczas [weryfikacji modelu](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="851b1-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="851b1-229">Klasa kontrolera również jest uzupełniona atrybutem **[autoryzuje]** .</span><span class="sxs-lookup"><span data-stu-id="851b1-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="851b1-230">Ten atrybut sprawdza, czy żądanie HTTP zostało uwierzytelnione.</span><span class="sxs-lookup"><span data-stu-id="851b1-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="851b1-231">Jeśli żądanie nie zostanie uwierzytelnione, klient odbiera protokół HTTP 401, Brak autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="851b1-232">Przeczytaj więcej na temat uwierzytelniania [i autoryzacji w usłudze ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="851b1-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="851b1-233">Klasa `TodoController` jest bardzo podobna do `TodoListController`.</span><span class="sxs-lookup"><span data-stu-id="851b1-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="851b1-234">Największą różnicą jest to, że nie definiuje żadnych metod GET, ponieważ klient uzyska elementy do wykonania wraz z każdą listą czynności do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="851b1-235">Kontrolery MVC i widoki</span><span class="sxs-lookup"><span data-stu-id="851b1-235">MVC Controllers and Views</span></span>

<span data-ttu-id="851b1-236">Kontrolery MVC znajdują się również w folderze controllers rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="851b1-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="851b1-237">`HomeController` renderuje główny kod HTML dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="851b1-238">Widok dla kontrolera głównego jest zdefiniowany w widokach/Home/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="851b1-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="851b1-239">Widok domu służy do renderowania różnej zawartości w zależności od tego, czy użytkownik jest zalogowany:</span><span class="sxs-lookup"><span data-stu-id="851b1-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="851b1-240">Gdy użytkownicy są zalogowani, zobaczą główny interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="851b1-241">W przeciwnym razie zobaczy panel logowania.</span><span class="sxs-lookup"><span data-stu-id="851b1-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="851b1-242">Zauważ, że to renderowanie warunkowe występuje po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="851b1-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="851b1-243">Nigdy nie należy próbować ukrywać poufnej zawartości po&#8212;stronie klienta, co jest widoczne w odpowiedzi HTTP, która jest widoczna dla kogoś, kto ogląda nieprzetworzone wiadomości HTTP.</span><span class="sxs-lookup"><span data-stu-id="851b1-243">Never try to hide sensitive content on the client side&#8212;anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="851b1-244">Kod JavaScript po stronie klienta i odcinanie. js</span><span class="sxs-lookup"><span data-stu-id="851b1-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="851b1-245">Teraz przejdźmy po stronie serwera aplikacji do klienta programu.</span><span class="sxs-lookup"><span data-stu-id="851b1-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="851b1-246">Szablon SPA używa kombinacji jQuery i separowania. js, aby utworzyć płynny, interaktywny interfejs użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="851b1-247">Separowanie. js to biblioteka języka JavaScript, która ułatwia powiązanie kodu HTML z danymi.</span><span class="sxs-lookup"><span data-stu-id="851b1-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="851b1-248">Separowanie. js używa wzorca o nazwie "Model-View-ViewModel".</span><span class="sxs-lookup"><span data-stu-id="851b1-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="851b1-249">Model to dane domeny (listy zadań do zrobienia i zadania do wykonania).</span><span class="sxs-lookup"><span data-stu-id="851b1-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="851b1-250">Widok jest dokumentem HTML.</span><span class="sxs-lookup"><span data-stu-id="851b1-250">The view is the HTML document.</span></span>
- <span data-ttu-id="851b1-251">Model widoku to obiekt JavaScript, który zawiera dane modelu.</span><span class="sxs-lookup"><span data-stu-id="851b1-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="851b1-252">Model widoku jest abstrakcją kodu interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="851b1-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="851b1-253">Nie ma informacji o reprezentacji HTML.</span><span class="sxs-lookup"><span data-stu-id="851b1-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="851b1-254">Zamiast tego reprezentuje funkcje abstrakcyjne widoku, takie jak "Lista elementów do wykonania".</span><span class="sxs-lookup"><span data-stu-id="851b1-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="851b1-255">Widok jest powiązany z danymi z modelem widoku.</span><span class="sxs-lookup"><span data-stu-id="851b1-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="851b1-256">Aktualizacje widoku-model są automatycznie odzwierciedlane w widoku.</span><span class="sxs-lookup"><span data-stu-id="851b1-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="851b1-257">Powiązania działają również w innym kierunku.</span><span class="sxs-lookup"><span data-stu-id="851b1-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="851b1-258">Zdarzenia w modelu DOM (takie jak kliknięcia) są powiązane z funkcjami w modelu widoku, które wyzwalają wywołania AJAX.</span><span class="sxs-lookup"><span data-stu-id="851b1-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="851b1-259">Szablon SPA organizuje kod JavaScript po stronie klienta w trzech warstwach:</span><span class="sxs-lookup"><span data-stu-id="851b1-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="851b1-260">zadanie do wykonania. DataContext. js: wysyła żądania AJAX.</span><span class="sxs-lookup"><span data-stu-id="851b1-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="851b1-261">do zrobienia. model. js: definiuje modele.</span><span class="sxs-lookup"><span data-stu-id="851b1-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="851b1-262">do zrobienia. ViewModel. js: definiuje model widoku.</span><span class="sxs-lookup"><span data-stu-id="851b1-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="851b1-263">Te pliki skryptów znajdują się w folderze skrypty/aplikacja rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="851b1-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="851b1-264">zadanie do **wykonania obsługuje wszystkie** wywołania AJAX do kontrolerów interfejsu API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="851b1-265">(Wywołanie AJAX do logowania jest zdefiniowane w innym miejscu w ajaxlogin. js).</span><span class="sxs-lookup"><span data-stu-id="851b1-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="851b1-266">do **zrobienia. model. js** definiuje modele po stronie klienta (przeglądarki) dla list zadań do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="851b1-267">Istnieją dwie klasy modelu: todoItem i todoList.</span><span class="sxs-lookup"><span data-stu-id="851b1-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="851b1-268">Wiele właściwości w klasach modelu jest typu "ko. dostrzegalne".</span><span class="sxs-lookup"><span data-stu-id="851b1-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="851b1-269">Observables to sposób odcinania.</span><span class="sxs-lookup"><span data-stu-id="851b1-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="851b1-270">Z [dokumentacji odcinania](http://knockoutjs.com/documentation/introduction.html): zauważalny jest "obiekt JavaScript, który może powiadamiać subskrybentów o zmianach".</span><span class="sxs-lookup"><span data-stu-id="851b1-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="851b1-271">Gdy wartość zauważalnych zmian, odcinanie aktualizuje wszystkie elementy HTML, które są powiązane z tymi observablesami.</span><span class="sxs-lookup"><span data-stu-id="851b1-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="851b1-272">Na przykład todoItem ma observables dla tytułu i właściwości isdone:</span><span class="sxs-lookup"><span data-stu-id="851b1-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="851b1-273">Możesz również subskrybować kod.</span><span class="sxs-lookup"><span data-stu-id="851b1-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="851b1-274">Na przykład Klasa todoItem subskrybuje zmiany we właściwościach "isdone" i "title":</span><span class="sxs-lookup"><span data-stu-id="851b1-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="851b1-275">**Wyświetl model**</span><span class="sxs-lookup"><span data-stu-id="851b1-275">**View Model**</span></span>

<span data-ttu-id="851b1-276">Model widoku jest zdefiniowany w ViewModel. js.</span><span class="sxs-lookup"><span data-stu-id="851b1-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="851b1-277">Model widoku jest punktem centralnym, w którym aplikacja powiąże elementy strony HTML z danymi domeny.</span><span class="sxs-lookup"><span data-stu-id="851b1-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="851b1-278">W szablonie SPA model widoku zawiera zauważalny tablicę todoLists.</span><span class="sxs-lookup"><span data-stu-id="851b1-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="851b1-279">Poniższy kod w modelu widoku mówi odcinanie, aby zastosować powiązania:</span><span class="sxs-lookup"><span data-stu-id="851b1-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="851b1-280">KOD HTML i powiązanie danych</span><span class="sxs-lookup"><span data-stu-id="851b1-280">HTML and Data Binding</span></span>

<span data-ttu-id="851b1-281">Główny kod HTML strony jest zdefiniowany w widokach/Home/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="851b1-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="851b1-282">Ze względu na to, że używamy powiązań danych, kod HTML jest tylko szablonem, co faktycznie jest renderowane.</span><span class="sxs-lookup"><span data-stu-id="851b1-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="851b1-283">Odcinanie używa powiązań *deklaratywnych* .</span><span class="sxs-lookup"><span data-stu-id="851b1-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="851b1-284">Elementy strony można powiązać z danymi, dodając do elementu atrybut "dane-powiązanie".</span><span class="sxs-lookup"><span data-stu-id="851b1-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="851b1-285">Oto bardzo prosty przykład pochodzący z dokumentacji odcinania:</span><span class="sxs-lookup"><span data-stu-id="851b1-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="851b1-286">W tym przykładzie odcinanie aktualizuje zawartość **&lt;span&gt;** elementu o wartości `myItems.count()`.</span><span class="sxs-lookup"><span data-stu-id="851b1-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="851b1-287">Za każdym razem, gdy ta wartość ulegnie zmianie, odcinanie dokumentu.</span><span class="sxs-lookup"><span data-stu-id="851b1-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="851b1-288">Odcinanie zawiera różne typy powiązań.</span><span class="sxs-lookup"><span data-stu-id="851b1-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="851b1-289">Poniżej przedstawiono niektóre powiązania używane w szablonie SPA:</span><span class="sxs-lookup"><span data-stu-id="851b1-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="851b1-290">**foreach**: umożliwia przechodzenie przez pętlę i zastosowanie tego samego znacznika do każdego elementu na liście.</span><span class="sxs-lookup"><span data-stu-id="851b1-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="851b1-291">Służy do renderowania list czynności do wykonania i elementów do wykonania.</span><span class="sxs-lookup"><span data-stu-id="851b1-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="851b1-292">W elemencie **foreach**powiązania są stosowane do elementów listy.</span><span class="sxs-lookup"><span data-stu-id="851b1-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="851b1-293">**widoczne**: służy do przełączania widoczności.</span><span class="sxs-lookup"><span data-stu-id="851b1-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="851b1-294">Ukryj znaczniki, gdy kolekcja jest pusta, lub wprowadź komunikat o błędzie jako widoczny.</span><span class="sxs-lookup"><span data-stu-id="851b1-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="851b1-295">**wartość**: służy do wypełniania wartości formularza.</span><span class="sxs-lookup"><span data-stu-id="851b1-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="851b1-296">**kliknięcie**: wiąże zdarzenie kliknięcia z funkcją w modelu widoku.</span><span class="sxs-lookup"><span data-stu-id="851b1-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="851b1-297">Ochrona przed CSRF</span><span class="sxs-lookup"><span data-stu-id="851b1-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="851b1-298">Fałszerstwo żądania między lokacjami (CSRF) to atak polegający na tym, że złośliwa witryna wysyła żądanie do zagrożonej lokacji, w której użytkownik jest aktualnie zalogowany.</span><span class="sxs-lookup"><span data-stu-id="851b1-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="851b1-299">Aby zapobiec atakom CSRF, ASP.NET MVC używa *tokenów chroniących przed fałszerstwem*, nazywanych również tokenami weryfikacji żądań.</span><span class="sxs-lookup"><span data-stu-id="851b1-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="851b1-300">Pomysłem jest to, że serwer umieszcza losowo wygenerowany token w stronie sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="851b1-301">Gdy klient przesyła dane do serwera, musi on zawierać tę wartość w komunikacie żądania.</span><span class="sxs-lookup"><span data-stu-id="851b1-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="851b1-302">Tokeny chroniące przed fałszerstwem działają, ponieważ złośliwa strona nie może odczytać tokenów użytkownika ze względu na zasady tego samego źródła.</span><span class="sxs-lookup"><span data-stu-id="851b1-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="851b1-303">(Zasady tego samego pochodzenia uniemożliwiają dokumentom obsługiwanym przez dwie różne lokacje uzyskiwanie dostępu do zawartości każdej z nich.)</span><span class="sxs-lookup"><span data-stu-id="851b1-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="851b1-304">ASP.NET MVC zapewnia wbudowaną obsługę tokenów chroniących przed fałszerstwem za pomocą klasy ochrony przed [fałszerstwem](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) i atrybutu [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) .</span><span class="sxs-lookup"><span data-stu-id="851b1-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="851b1-305">Obecnie ta funkcja nie jest wbudowana w interfejs API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="851b1-306">Jednak szablon SPA zawiera niestandardową implementację interfejsu API sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="851b1-307">Ten kod jest zdefiniowany w klasie `ValidateHttpAntiForgeryTokenAttribute`, która znajduje się w folderze filters rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="851b1-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="851b1-308">Aby dowiedzieć się więcej na temat programu Anti-CSRF w interfejsie Web API, zobacz [zapobieganie atakom w ramach żądań między witrynami (CSRF)](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span><span class="sxs-lookup"><span data-stu-id="851b1-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="851b1-309">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="851b1-309">Conclusion</span></span>

<span data-ttu-id="851b1-310">Szablon SPA został zaprojektowany tak, aby można było szybko pisać nowoczesne, interaktywne aplikacje sieci Web.</span><span class="sxs-lookup"><span data-stu-id="851b1-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="851b1-311">Używa biblioteki odcinania. js do oddzielenia prezentacji (znaczników HTML) z logiki danych i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="851b1-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="851b1-312">Natomiast odcinanie nie jest jedyną biblioteką JavaScript, której można użyć do utworzenia SPA.</span><span class="sxs-lookup"><span data-stu-id="851b1-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="851b1-313">Jeśli chcesz poznać inne opcje, zapoznaj się z [szablonami Spa utworzonymi przez społeczność](../templates/index.md).</span><span class="sxs-lookup"><span data-stu-id="851b1-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>
