---
title: Weryfikacja modelu w programie ASP.NET Core MVC
author: tdykstra
description: Więcej informacji o weryfikacji modelu w aplikacji ASP.NET Core MVC.
ms.author: riande
ms.custom: mvc
ms.date: 01/14/2019
uid: mvc/models/validation
ms.openlocfilehash: ca7ee54b8e6b6ae5091b0cb133e448ad9c04da8f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/01/2019
ms.locfileid: "57073364"
---
# <a name="model-validation-in-aspnet-core-mvc"></a><span data-ttu-id="4b56b-103">Weryfikacja modelu w programie ASP.NET Core MVC</span><span class="sxs-lookup"><span data-stu-id="4b56b-103">Model validation in ASP.NET Core MVC</span></span>

<span data-ttu-id="4b56b-104">Przez [Rachel Appel](https://github.com/rachelappel)</span><span class="sxs-lookup"><span data-stu-id="4b56b-104">By [Rachel Appel](https://github.com/rachelappel)</span></span>

## <a name="introduction-to-model-validation"></a><span data-ttu-id="4b56b-105">Wprowadzenie do sprawdzania poprawności modelu</span><span class="sxs-lookup"><span data-stu-id="4b56b-105">Introduction to model validation</span></span>

<span data-ttu-id="4b56b-106">Zanim aplikacja przechowuje dane w bazie danych, aplikacja musi sprawdzić poprawność danych.</span><span class="sxs-lookup"><span data-stu-id="4b56b-106">Before an app stores data in a database, the app must validate the data.</span></span> <span data-ttu-id="4b56b-107">Potencjalne zagrożenia bezpieczeństwa w celu weryfikacji, że jest prawidłowo sformatowany według typu i rozmiaru i musi stosować się do reguł, dane muszą zostać sprawdzone.</span><span class="sxs-lookup"><span data-stu-id="4b56b-107">Data must be checked for potential security threats, verified that it's appropriately formatted by type and size, and it must conform to your rules.</span></span> <span data-ttu-id="4b56b-108">Sprawdzanie poprawności jest niezbędne, chociaż może być nadmiarowy i żmudnym do zaimplementowania.</span><span class="sxs-lookup"><span data-stu-id="4b56b-108">Validation is necessary although it can be redundant and tedious to implement.</span></span> <span data-ttu-id="4b56b-109">W przypadku platformy MVC weryfikacji odbywa się na kliencie i serwerze.</span><span class="sxs-lookup"><span data-stu-id="4b56b-109">In MVC, validation happens on both the client and server.</span></span>

<span data-ttu-id="4b56b-110">Na szczęście platformy .NET ma wyodrębnione sprawdzania poprawności do atrybutów sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-110">Fortunately, .NET has abstracted validation into validation attributes.</span></span> <span data-ttu-id="4b56b-111">Te atrybuty zawierają kod sprawdzania poprawności, w tym samym zmniejsza ilość kodu, który trzeba napisać.</span><span class="sxs-lookup"><span data-stu-id="4b56b-111">These attributes contain validation code, thereby reducing the amount of code you must write.</span></span>

<span data-ttu-id="4b56b-112">W programie ASP.NET Core 2.2 i nowszych środowiska uruchomieniowego platformy ASP.NET Core short-circuits weryfikacji (pomija), jeśli można określić, że wykres podanego modelu nie wymaga weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-112">In ASP.NET Core 2.2 and later, the ASP.NET Core runtime short-circuits (skips) validation if it can determine that a given model graph doesn't require validation.</span></span> <span data-ttu-id="4b56b-113">Pomijanie sprawdzania poprawności może zapewnić znaczne ulepszenia wydajności, podczas sprawdzania poprawności modeli, które nie może lub nie ma żadnych skojarzonych modułów weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-113">Skipping validation can provide significant performance improvements when validating models that cannot or do not have any associated validators.</span></span> <span data-ttu-id="4b56b-114">Pominięto Walidacja obejmuje obiekty, takie jak kolekcje elementów podstawowych (`byte[]`, `string[]`, `Dictionary<string, string>`, itp.), lub wykresów złożonych obiektów bez żadnych modułów weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-114">The skipped validation includes objects such as collections of primitives (`byte[]`, `string[]`, `Dictionary<string, string>`, etc.), or complex object graphs without any validators.</span></span>

<span data-ttu-id="4b56b-115">[Wyświetlanie lub pobieranie przykładowy z serwisu GitHub](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span><span class="sxs-lookup"><span data-stu-id="4b56b-115">[View or download sample from GitHub](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span></span>

## <a name="validation-attributes"></a><span data-ttu-id="4b56b-116">Sprawdzanie poprawności atrybutów</span><span class="sxs-lookup"><span data-stu-id="4b56b-116">Validation Attributes</span></span>

<span data-ttu-id="4b56b-117">Atrybuty weryfikacji służą do konfigurowania weryfikacji modelu, więc podobne pod względem koncepcyjnym do sprawdzania poprawności w polach w tabelach bazy danych.</span><span class="sxs-lookup"><span data-stu-id="4b56b-117">Validation attributes are a way to configure model validation so it's similar conceptually to validation on fields in database tables.</span></span> <span data-ttu-id="4b56b-118">Obejmuje to ograniczenia, takie jak przypisywanie typów danych lub wymagane pola.</span><span class="sxs-lookup"><span data-stu-id="4b56b-118">This includes constraints such as assigning data types or required fields.</span></span> <span data-ttu-id="4b56b-119">Inne rodzaje weryfikacji obejmują stosowania wzorców do danych w celu wymuszania reguł biznesowych, takich jak karty kredytowej lub numer telefonu lub adres e-mail.</span><span class="sxs-lookup"><span data-stu-id="4b56b-119">Other types of validation include applying patterns to data to enforce business rules, such as a credit card, phone number, or email address.</span></span> <span data-ttu-id="4b56b-120">Atrybuty weryfikacji upewnij się, wymuszając te wymagania, znacznie prostsze i łatwiejsze w użyciu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-120">Validation attributes make enforcing these requirements much simpler and easier to use.</span></span>

<span data-ttu-id="4b56b-121">Sprawdzanie poprawności atrybutów są określony na poziomie właściwości:</span><span class="sxs-lookup"><span data-stu-id="4b56b-121">Validation attributes are specified at the property level:</span></span> 

```csharp
[Required]
public string MyProperty { get; set; }
```

<span data-ttu-id="4b56b-122">Poniżej znajduje się adnotacjami `Movie` modelu w aplikacji, która przechowuje informacje dotyczące filmów i programów telewizyjnych.</span><span class="sxs-lookup"><span data-stu-id="4b56b-122">Below is an annotated `Movie` model from an app that stores information about movies and TV shows.</span></span> <span data-ttu-id="4b56b-123">Większość właściwości są wymagane, i kilka właściwości ciągu mają wymagania dotyczące długości.</span><span class="sxs-lookup"><span data-stu-id="4b56b-123">Most of the properties are required and several string properties have length requirements.</span></span> <span data-ttu-id="4b56b-124">Ponadto ma ograniczenie zakresu liczbowego w miejscu, aby `Price` właściwości z zakresu od 0 do $999,99, wraz z atrybutu niestandardowego sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-124">Additionally, there's a numeric range restriction in place for the `Price` property from 0 to $999.99, along with a custom validation attribute.</span></span>

[!code-csharp[](validation/sample/Movie.cs?range=6-29)]

<span data-ttu-id="4b56b-125">Po prostu odczytywanie za pomocą modelu, co spowoduje wyświetlenie zasad dotyczących danych dla tej aplikacji, co ułatwia zachowania kodu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-125">Simply reading through the model reveals the rules about data for this app, making it easier to maintain the code.</span></span> <span data-ttu-id="4b56b-126">Poniżej przedstawiono kilka popularnych wbudowanych sprawdzania poprawności atrybutów:</span><span class="sxs-lookup"><span data-stu-id="4b56b-126">Below are several popular built-in validation attributes:</span></span>

* <span data-ttu-id="4b56b-127">`[CreditCard]`: Sprawdza poprawność właściwość ma format karty kredytowej.</span><span class="sxs-lookup"><span data-stu-id="4b56b-127">`[CreditCard]`: Validates the property has a credit card format.</span></span>

* <span data-ttu-id="4b56b-128">`[Compare]`: Sprawdza dwie właściwości w modelu są zgodne.</span><span class="sxs-lookup"><span data-stu-id="4b56b-128">`[Compare]`: Validates two properties in a model match.</span></span>

* <span data-ttu-id="4b56b-129">`[EmailAddress]`: Sprawdza poprawność właściwość ma format adresu e-mail.</span><span class="sxs-lookup"><span data-stu-id="4b56b-129">`[EmailAddress]`: Validates the property has an email format.</span></span>

* <span data-ttu-id="4b56b-130">`[Phone]`: Sprawdza poprawność właściwość ma format telefonu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-130">`[Phone]`: Validates the property has a telephone format.</span></span>

* <span data-ttu-id="4b56b-131">`[Range]`: Sprawdza poprawność właściwości wartość znajduje się w danym zakresie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-131">`[Range]`: Validates the property value falls within the given range.</span></span>

* <span data-ttu-id="4b56b-132">`[RegularExpression]`: Weryfikuje, że dane odpowiada określonemu wyrażeniu regularnemu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-132">`[RegularExpression]`: Validates that the data matches the specified regular expression.</span></span>

* <span data-ttu-id="4b56b-133">`[Required]`: Powoduje, że właściwość wymagane.</span><span class="sxs-lookup"><span data-stu-id="4b56b-133">`[Required]`: Makes a property required.</span></span>

* <span data-ttu-id="4b56b-134">`[StringLength]`: Sprawdza, czy właściwość ciągu ma co najwyżej podanej długości maksymalnej.</span><span class="sxs-lookup"><span data-stu-id="4b56b-134">`[StringLength]`: Validates that a string property has at most the given maximum length.</span></span>

* <span data-ttu-id="4b56b-135">`[Url]`: Sprawdza poprawność właściwość ma format adresu URL.</span><span class="sxs-lookup"><span data-stu-id="4b56b-135">`[Url]`: Validates the property has a URL format.</span></span>

<span data-ttu-id="4b56b-136">MVC obsługuje dowolnego atrybutu, która pochodzi od klasy `ValidationAttribute` do celów sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-136">MVC supports any attribute that derives from `ValidationAttribute` for validation purposes.</span></span> <span data-ttu-id="4b56b-137">Wiele atrybutów sprawdzania poprawności przydatne znajdują się w [System.ComponentModel.DataAnnotations](/dotnet/api/system.componentmodel.dataannotations) przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="4b56b-137">Many useful validation attributes can be found in the [System.ComponentModel.DataAnnotations](/dotnet/api/system.componentmodel.dataannotations) namespace.</span></span>

<span data-ttu-id="4b56b-138">Mogą wystąpić sytuacje, gdy potrzebujesz więcej funkcji niż wbudowanych atrybutów.</span><span class="sxs-lookup"><span data-stu-id="4b56b-138">There may be instances where you need more features than built-in attributes provide.</span></span> <span data-ttu-id="4b56b-139">W takich sytuacjach można utworzyć niestandardowego sprawdzania poprawności atrybutów pochodząca od `ValidationAttribute` lub zmiana modelu do zaimplementowania `IValidatableObject`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-139">For those times, you can create custom validation attributes by deriving from `ValidationAttribute` or changing your model to implement `IValidatableObject`.</span></span>

## <a name="notes-on-the-use-of-the-required-attribute"></a><span data-ttu-id="4b56b-140">Uwagi dotyczące użytkowania wymaganego atrybutu</span><span class="sxs-lookup"><span data-stu-id="4b56b-140">Notes on the use of the Required attribute</span></span>

<span data-ttu-id="4b56b-141">Nieprzyjmujące [typy wartości](/dotnet/csharp/language-reference/keywords/value-types) (takie jak `decimal`, `int`, `float`, i `DateTime`) są założenia wymagane i nie ma potrzeby `Required` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-141">Non-nullable [value types](/dotnet/csharp/language-reference/keywords/value-types) (such as `decimal`, `int`, `float`, and `DateTime`) are inherently required and don't need the `Required` attribute.</span></span> <span data-ttu-id="4b56b-142">Aplikacja wykonuje żadnych testów weryfikacji po stronie serwera dla typów innych niż null, które są oznaczone `Required`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-142">The app performs no server-side validation checks for non-nullable types that are marked `Required`.</span></span>

<span data-ttu-id="4b56b-143">Wiązanie modelu MVC, która nie jest rozpatrywany wraz z weryfikacji i atrybutów sprawdzania poprawności, odrzuca przesyłania pola formularza, zawierający brakujące wartości lub białe znaki dla typów innych niż null.</span><span class="sxs-lookup"><span data-stu-id="4b56b-143">MVC model binding, which isn't concerned with validation and validation attributes, rejects a form field submission containing a missing value or whitespace for a non-nullable type.</span></span> <span data-ttu-id="4b56b-144">W przypadku braku `BindRequired` atrybutu na właściwość target wiązania modelu ignoruje Brak danych dla typów innych niż null, gdy formularz nie ma pola ukrytego przychodzące dane formularza.</span><span class="sxs-lookup"><span data-stu-id="4b56b-144">In the absence of a `BindRequired` attribute on the target property, model binding ignores missing data for non-nullable types, where the form field is absent from the incoming form data.</span></span>

<span data-ttu-id="4b56b-145">[Atrybut BindRequired](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (Zobacz też <xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes>) jest przydatne do upewnij się formularz danych zostało zakończone.</span><span class="sxs-lookup"><span data-stu-id="4b56b-145">The [BindRequired attribute](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (also see <xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes>) is useful to ensure form data is complete.</span></span> <span data-ttu-id="4b56b-146">Gdy jest stosowany do właściwości, system powiązanie modelu wymaga podania wartości dla tej właściwości.</span><span class="sxs-lookup"><span data-stu-id="4b56b-146">When applied to a property, the model binding system requires a value for that property.</span></span> <span data-ttu-id="4b56b-147">Gdy jest stosowany do typu, system powiązanie modelu wymaga wartości wszystkich właściwości tego typu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-147">When applied to a type, the model binding system requires values for all of the properties of that type.</span></span>

<span data-ttu-id="4b56b-148">Kiedy używać [Nullable\<T > typu](/dotnet/csharp/programming-guide/nullable-types/) (na przykład `decimal?` lub `System.Nullable<decimal>`) i oznacz ją `Required`, sprawdzanie poprawności po stronie serwera odbywa się tak, jakby właściwości zostały standardowego typu dopuszczającego wartość null (na przykład `string`).</span><span class="sxs-lookup"><span data-stu-id="4b56b-148">When you use a [Nullable\<T> type](/dotnet/csharp/programming-guide/nullable-types/) (for example, `decimal?` or `System.Nullable<decimal>`) and mark it `Required`, a server-side validation check is performed as if the property were a standard nullable type (for example, a `string`).</span></span>

<span data-ttu-id="4b56b-149">Weryfikacja po stronie klienta wymaga podania wartości dla pola formularza, który odnosi się do właściwości modelu, który został oznaczony `Required` i dla właściwości typu innego niż dopuszczającego wartość null, która nie została oznaczona jako `Required`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-149">Client-side validation requires a value for a form field that corresponds to a model property that you've marked `Required` and for a non-nullable type property that you haven't marked `Required`.</span></span> <span data-ttu-id="4b56b-150">`Required` może służyć do kontrolowania komunikat o błędzie weryfikacji po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="4b56b-150">`Required` can be used to control the client-side validation error message.</span></span>

::: moniker range=">= aspnetcore-2.1"

## <a name="top-level-node-validation"></a><span data-ttu-id="4b56b-151">Sprawdzanie poprawności węzeł najwyższego poziomu</span><span class="sxs-lookup"><span data-stu-id="4b56b-151">Top-level node validation</span></span>

<span data-ttu-id="4b56b-152">Obejmują węzłów najwyższego poziomu:</span><span class="sxs-lookup"><span data-stu-id="4b56b-152">Top-level nodes include:</span></span>

* <span data-ttu-id="4b56b-153">Parametry akcji</span><span class="sxs-lookup"><span data-stu-id="4b56b-153">Action parameters</span></span>
* <span data-ttu-id="4b56b-154">Właściwości kontrolera</span><span class="sxs-lookup"><span data-stu-id="4b56b-154">Controller properties</span></span>
* <span data-ttu-id="4b56b-155">Parametry obsługi strony</span><span class="sxs-lookup"><span data-stu-id="4b56b-155">Page handler parameters</span></span>
* <span data-ttu-id="4b56b-156">Strona właściwości modelu</span><span class="sxs-lookup"><span data-stu-id="4b56b-156">Page model properties</span></span>

<span data-ttu-id="4b56b-157">Powiązane z modelu węzłów najwyższego poziomu są weryfikowane oprócz weryfikacji właściwości modelu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-157">Model-bound top-level nodes are validated in addition to validating model properties.</span></span> <span data-ttu-id="4b56b-158">W poniższym przykładzie z przykładowej aplikacji `VerifyPhone` metoda używa <xref:System.ComponentModel.DataAnnotations.RegularExpressionAttribute> do sprawdzania poprawności danych użytkownika w polu Telefon w postaci:</span><span class="sxs-lookup"><span data-stu-id="4b56b-158">In the following example from the sample app, the `VerifyPhone` method uses the <xref:System.ComponentModel.DataAnnotations.RegularExpressionAttribute> to validate the user data in the Phone field of a form:</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyPhone)]

<span data-ttu-id="4b56b-159">Można użyć węzłów najwyższego poziomu <xref:Microsoft.AspNetCore.Mvc.ModelBinding.BindRequiredAttribute> za pomocą atrybutów sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-159">Top-level nodes can use <xref:Microsoft.AspNetCore.Mvc.ModelBinding.BindRequiredAttribute> with validation attributes.</span></span> <span data-ttu-id="4b56b-160">W poniższym przykładzie z przykładowej aplikacji `CheckAge` Metoda określa, że `age` parametru musi być powiązana z ciągu zapytania po przesłaniu formularza:</span><span class="sxs-lookup"><span data-stu-id="4b56b-160">In the following example from the sample app, the `CheckAge` method specifies that the `age` parameter must be bound from the query string when the form is submitted:</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_CheckAge)]

<span data-ttu-id="4b56b-161">Na stronie Sprawdzanie wiekowa (*CheckAge.cshtml*), istnieją dwie formy.</span><span class="sxs-lookup"><span data-stu-id="4b56b-161">In the Check Age page (*CheckAge.cshtml*), there are two forms.</span></span> <span data-ttu-id="4b56b-162">Pierwszy formularz przesyła `Age` wartość `99` jako ciąg zapytania: `https://localhost:5001/Users/CheckAge?Age=99`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-162">The first form submits an `Age` value of `99` as a query string: `https://localhost:5001/Users/CheckAge?Age=99`.</span></span>

<span data-ttu-id="4b56b-163">Gdy jest to poprawnie sformatowany `age` jest przesyłany przez parametr ciągu zapytania, sprawdza poprawność formularza.</span><span class="sxs-lookup"><span data-stu-id="4b56b-163">When a properly formatted `age` parameter from the query string is submitted, the form validates.</span></span>

<span data-ttu-id="4b56b-164">Drugi formularz na stronie Sprawdzanie wiekowa przesyła `Age` wartością w treści żądania, a weryfikacja zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="4b56b-164">The second form on the Check Age page submits the `Age` value in the body of the request, and validation fails.</span></span> <span data-ttu-id="4b56b-165">Powiązanie kończy się niepowodzeniem, ponieważ `age` parametru muszą pochodzić z ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="4b56b-165">Binding fails because the `age` parameter must come from a query string.</span></span>

<span data-ttu-id="4b56b-166">Sprawdzanie poprawności jest domyślnie włączona i kontrolowane przez <xref:Microsoft.AspNetCore.Mvc.MvcOptions.AllowValidatingTopLevelNodes*> właściwość <xref:Microsoft.AspNetCore.Mvc.MvcOptions>.</span><span class="sxs-lookup"><span data-stu-id="4b56b-166">Validation is enabled by default and controlled by the <xref:Microsoft.AspNetCore.Mvc.MvcOptions.AllowValidatingTopLevelNodes*> property of <xref:Microsoft.AspNetCore.Mvc.MvcOptions>.</span></span> <span data-ttu-id="4b56b-167">Aby wyłączyć sprawdzanie poprawności węzeł najwyższego poziomu, należy ustawić `AllowValidatingTopLevelNodes` do `false` w opcjach MVC (`Startup.ConfigureServices`):</span><span class="sxs-lookup"><span data-stu-id="4b56b-167">To disable top-level node validation, set `AllowValidatingTopLevelNodes` to `false` in MVC options (`Startup.ConfigureServices`):</span></span>

[!code-csharp[](validation/sample_snapshot/Startup.cs?name=snippet_AddMvc&highlight=4)]

::: moniker-end

## <a name="model-state"></a><span data-ttu-id="4b56b-168">Stan modelu</span><span class="sxs-lookup"><span data-stu-id="4b56b-168">Model State</span></span>

<span data-ttu-id="4b56b-169">Stan modelu reprezentuje błędy sprawdzania poprawności w przesłanych wartości z formularza HTML.</span><span class="sxs-lookup"><span data-stu-id="4b56b-169">Model state represents validation errors in submitted HTML form values.</span></span>

<span data-ttu-id="4b56b-170">MVC będzie, sprawdzanie poprawności pól, dopóki nie osiągnie maksymalną liczbę błędów (200 domyślnie).</span><span class="sxs-lookup"><span data-stu-id="4b56b-170">MVC will continue validating fields until it reaches the maximum number of errors (200 by default).</span></span> <span data-ttu-id="4b56b-171">Tę liczbę można skonfigurować w następującym kodem `Startup.ConfigureServices`:</span><span class="sxs-lookup"><span data-stu-id="4b56b-171">You can configure this number with the following code in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](validation/sample/Startup.cs?name=snippet_MaxModelValidationErrors)]

## <a name="handle-model-state-errors"></a><span data-ttu-id="4b56b-172">Błędy stanu modelu uchwytu</span><span class="sxs-lookup"><span data-stu-id="4b56b-172">Handle Model State errors</span></span>

<span data-ttu-id="4b56b-173">Sprawdzanie poprawności modelu występuje przed wykonaniem tej akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="4b56b-173">Model validation occurs before the execution of a controller action.</span></span> <span data-ttu-id="4b56b-174">Jest odpowiedzialny za akcji, aby sprawdzić `ModelState.IsValid` i odpowiednio reagują.</span><span class="sxs-lookup"><span data-stu-id="4b56b-174">It's the action's responsibility to inspect `ModelState.IsValid` and react appropriately.</span></span> <span data-ttu-id="4b56b-175">W wielu przypadkach odpowiednie reakcji ma zwracać odpowiedź o błędzie, najlepiej szczegółowych informacji na temat przyczyny niepowodzenia weryfikacji modelu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-175">In many cases, the appropriate reaction is to return an error response, ideally detailing the reason why model validation failed.</span></span>

::: moniker range=">= aspnetcore-2.1"

<span data-ttu-id="4b56b-176">Gdy `ModelState.IsValid` daje w wyniku `false` kontrolery interfejsu API sieci web przy użyciu `[ApiController]` atrybutu, zwracana jest automatyczne odpowiedź HTTP 400 zawierający szczegółowe informacje o problemie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-176">When `ModelState.IsValid` evaluates to `false` in web API controllers using the `[ApiController]` attribute, an automatic HTTP 400 response containing issue details is returned.</span></span> <span data-ttu-id="4b56b-177">Aby uzyskać więcej informacji, zobacz [odpowiedzi automatyczne HTTP 400](xref:web-api/index#automatic-http-400-responses).</span><span class="sxs-lookup"><span data-stu-id="4b56b-177">For more information, see [Automatic HTTP 400 responses](xref:web-api/index#automatic-http-400-responses).</span></span>

::: moniker-end

<span data-ttu-id="4b56b-178">Niektóre aplikacje wybierze wykonać standardowej Konwencji za zajmowanie się błędy sprawdzania poprawności modelu, w których filtr przypadku odpowiednim miejscu, aby zaimplementować takie zasady.</span><span class="sxs-lookup"><span data-stu-id="4b56b-178">Some apps will choose to follow a standard convention for dealing with model validation errors, in which case a filter may be an appropriate place to implement such a policy.</span></span> <span data-ttu-id="4b56b-179">Należy przetestować zachowaniem akcji ze Stanami prawidłowe oraz nieprawidłowe modelu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-179">You should test how your actions behave with valid and invalid model states.</span></span>

## <a name="manual-validation"></a><span data-ttu-id="4b56b-180">Weryfikowanie ręczne</span><span class="sxs-lookup"><span data-stu-id="4b56b-180">Manual validation</span></span>

<span data-ttu-id="4b56b-181">Po zakończeniu wiązania modelu i sprawdzanie poprawności można powtórzyć jej części.</span><span class="sxs-lookup"><span data-stu-id="4b56b-181">After model binding and validation are complete, you may want to repeat parts of it.</span></span> <span data-ttu-id="4b56b-182">Na przykład użytkownik mógł zostać wprowadzony tekst w polu, oczekiwano typu integer lub może być konieczne do obliczenia wartości dla właściwości modelu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-182">For example, a user may have entered text in a field expecting an integer, or you may need to compute a value for a model's property.</span></span>

<span data-ttu-id="4b56b-183">Może być konieczne ręczne uruchomienie sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-183">You may need to run validation manually.</span></span> <span data-ttu-id="4b56b-184">Aby to zrobić, należy wywołać `TryValidateModel` metody, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="4b56b-184">To do so, call the `TryValidateModel` method, as shown here:</span></span>

[!code-csharp[](validation/sample/MoviesController.cs?name=snippet_TryValidateModel)]

## <a name="custom-validation"></a><span data-ttu-id="4b56b-185">Niestandardowego sprawdzania poprawności</span><span class="sxs-lookup"><span data-stu-id="4b56b-185">Custom validation</span></span>

<span data-ttu-id="4b56b-186">Atrybutów sprawdzania poprawności działa w wielu zastosowaniach sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-186">Validation attributes work for most validation needs.</span></span> <span data-ttu-id="4b56b-187">Jednak niektóre reguły sprawdzania poprawności są specyficzne dla Twojej firmy.</span><span class="sxs-lookup"><span data-stu-id="4b56b-187">However, some validation rules are specific to your business.</span></span> <span data-ttu-id="4b56b-188">Reguły mogą nie być typowe metody sprawdzania poprawności danych, takich jak zapewnienie pole jest wymagane, lub że spełnia on zakres wartości.</span><span class="sxs-lookup"><span data-stu-id="4b56b-188">Your rules might not be common data validation techniques such as ensuring a field is required or that it conforms to a range of values.</span></span> <span data-ttu-id="4b56b-189">Dla tych scenariuszy atrybuty niestandardowe sprawdzanie poprawności są doskonałe rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-189">For these scenarios, custom validation attributes are a great solution.</span></span> <span data-ttu-id="4b56b-190">Tworzenie własnego niestandardowego sprawdzania poprawności atrybutów w MVC jest łatwe.</span><span class="sxs-lookup"><span data-stu-id="4b56b-190">Creating your own custom validation attributes in MVC is easy.</span></span> <span data-ttu-id="4b56b-191">Tylko dziedziczyć `ValidationAttribute`i zastępowania `IsValid` metody.</span><span class="sxs-lookup"><span data-stu-id="4b56b-191">Just inherit from the `ValidationAttribute`, and override the `IsValid` method.</span></span> <span data-ttu-id="4b56b-192">`IsValid` Metoda przyjmuje dwa parametry pierwszy jest obiekt o nazwie *wartość* , a drugim `ValidationContext` obiektu o nazwie *validationContext*.</span><span class="sxs-lookup"><span data-stu-id="4b56b-192">The `IsValid` method accepts two parameters, the first is an object named *value* and the second is a `ValidationContext` object named *validationContext*.</span></span> <span data-ttu-id="4b56b-193">*Wartość* odwołuje się do rzeczywistej wartości z pól, z niestandardowego modułu sprawdzania poprawności jest sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-193">*Value* refers to the actual value from the field that your custom validator is validating.</span></span>

<span data-ttu-id="4b56b-194">W następującym przykładzie reguła biznesowa stwierdzający, że użytkownicy mogą nie ustawiono tego gatunku *klasycznego* wydana po roku 1960 filmu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-194">In the following sample, a business rule states that users may not set the genre to *Classic* for a movie released after 1960.</span></span> <span data-ttu-id="4b56b-195">`[ClassicMovie]` Atrybut tego gatunku sprawdza, czy w przypadku klasycznej go następnie sprawdzi daty wydania, aby zobaczyć, że jest późniejsza niż 1960.</span><span class="sxs-lookup"><span data-stu-id="4b56b-195">The `[ClassicMovie]` attribute checks the genre first, and if it's a classic, then it checks the release date to see that it's later than 1960.</span></span> <span data-ttu-id="4b56b-196">Jest on zwalniany po roku 1960, sprawdzanie poprawności nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="4b56b-196">If it's released after 1960, validation fails.</span></span> <span data-ttu-id="4b56b-197">Ten atrybut akceptuje parametr z liczbą całkowitą reprezentującą rok, który służy do sprawdzania poprawności danych.</span><span class="sxs-lookup"><span data-stu-id="4b56b-197">The attribute accepts an integer parameter representing the year that you can use to validate data.</span></span> <span data-ttu-id="4b56b-198">Wartość parametru w Konstruktorze ten atrybut można przechwycić, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="4b56b-198">You can capture the value of the parameter in the attribute's constructor, as shown here:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_ClassicMovieAttribute)]

<span data-ttu-id="4b56b-199">`movie` Zmiennej powyżej reprezentuje `Movie` obiekt, który zawiera dane z przesyłania formularza do sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-199">The `movie` variable above represents a `Movie` object that contains the data from the form submission to validate.</span></span> <span data-ttu-id="4b56b-200">W tym przypadku kod sprawdzania poprawności sprawdza, czy data i gatunku w `IsValid` metody `ClassicMovieAttribute` klasy zgodnie z zasadami.</span><span class="sxs-lookup"><span data-stu-id="4b56b-200">In this case, the validation code checks the date and genre in the `IsValid` method of the `ClassicMovieAttribute` class as per the rules.</span></span> <span data-ttu-id="4b56b-201">Po pomyślnej weryfikacji`IsValid` zwraca `ValidationResult.Success` kodu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-201">Upon successful validation ,`IsValid` returns a `ValidationResult.Success` code.</span></span> <span data-ttu-id="4b56b-202">Podczas sprawdzania poprawności zakończy się niepowodzeniem, `ValidationResult` z powodu błędu zwrócony komunikat:</span><span class="sxs-lookup"><span data-stu-id="4b56b-202">When validation fails, a `ValidationResult` with an error message is returned:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_GetErrorMessage)]

<span data-ttu-id="4b56b-203">Gdy użytkownik modyfikuje `Genre` pola, a następnie przesyła formularz, `IsValid` metody `ClassicMovieAttribute` sprawdzi, czy jest klasycznej.</span><span class="sxs-lookup"><span data-stu-id="4b56b-203">When a user modifies the `Genre` field and submits the form, the `IsValid` method of the `ClassicMovieAttribute` will verify whether the movie is a classic.</span></span> <span data-ttu-id="4b56b-204">Podobnie jak dowolny atrybut wbudowanych, należy zastosować `ClassicMovieAttribute` do właściwości, takie jak `ReleaseDate` aby zapewnić miejsce sprawdzania poprawności, jak pokazano w poprzednim przykładzie kodu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-204">Like any built-in attribute, apply the `ClassicMovieAttribute` to a property such as `ReleaseDate` to ensure validation happens, as shown in the previous code sample.</span></span> <span data-ttu-id="4b56b-205">Ponieważ przykład działa tylko w przypadku `Movie` typów, lepszym rozwiązaniem jest użycie `IValidatableObject` jak pokazano w poniższym akapitu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-205">Since the example works only with `Movie` types, a better option is to use `IValidatableObject` as shown in the following paragraph.</span></span>

<span data-ttu-id="4b56b-206">Alternatywnie można umieścić ten sam kod w modelu implementując `Validate` metody `IValidatableObject` interfejsu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-206">Alternatively, this same code could be placed in the model by implementing the `Validate` method on the `IValidatableObject` interface.</span></span> <span data-ttu-id="4b56b-207">Gdy niestandardowego sprawdzania poprawności atrybutów działa dobrze w przypadku sprawdzania poprawności poszczególnych właściwości, implementowanie `IValidatableObject` może służyć do implementowania weryfikacji na poziomie klasy:</span><span class="sxs-lookup"><span data-stu-id="4b56b-207">While custom validation attributes work well for validating individual properties, implementing `IValidatableObject` can be used to implement class-level validation:</span></span>

[!code-csharp[](validation/sample/MovieIValidatable.cs?name=snippet&highlight=1,26-34)]

## <a name="client-side-validation"></a><span data-ttu-id="4b56b-208">Weryfikacja po stronie klienta</span><span class="sxs-lookup"><span data-stu-id="4b56b-208">Client side validation</span></span>

<span data-ttu-id="4b56b-209">Weryfikacja po stronie klienta jest doskonałym wygodę dla użytkowników.</span><span class="sxs-lookup"><span data-stu-id="4b56b-209">Client side validation is a great convenience for users.</span></span> <span data-ttu-id="4b56b-210">Zaoszczędzić czas, który one byłby przeznaczany na oczekiwanie na komunikację dwustronną z serwerem.</span><span class="sxs-lookup"><span data-stu-id="4b56b-210">It saves time they would otherwise spend waiting for a round trip to the server.</span></span> <span data-ttu-id="4b56b-211">W terminologii biznesowej nawet kilka użycie ułamkowych części sekundy pomnożone setki razy każdego dnia są dodaje do być dużo czasu i pieniędzy oraz Rozczarowanie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-211">In business terms, even a few fractions of seconds multiplied hundreds of times each day adds up to be a lot of time, expense, and frustration.</span></span> <span data-ttu-id="4b56b-212">Proste i natychmiastowe sprawdzanie poprawności umożliwia użytkownikom bardziej wydajną pracę i wygenerować lepszą jakość danych wejściowych i wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="4b56b-212">Straightforward and immediate validation enables users to work more efficiently and produce better quality input and output.</span></span>

<span data-ttu-id="4b56b-213">Konieczne jest posiadanie widoku przy użyciu prawidłowego odwołania do skryptu JavaScript w miejscu na potrzeby weryfikacji po stronie klienta do pracy, jak widać w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-213">You must have a view with the proper JavaScript script references in place for client-side validation to work as you see here.</span></span>

[!code-cshtml[](validation/sample/Views/Shared/_Layout.cshtml?name=snippet_ScriptTag)]

[!code-cshtml[](validation/sample/Views/Shared/_ValidationScriptsPartial.cshtml)]

<span data-ttu-id="4b56b-214">[JQuery sprawdzania poprawności dyskretnego kodu](https://github.com/aspnet/jquery-validation-unobtrusive) skrypt jest niestandardową biblioteką frontonu firmy Microsoft, która jest oparta na popularnej [jQuery weryfikacji](https://jqueryvalidation.org/) wtyczki.</span><span class="sxs-lookup"><span data-stu-id="4b56b-214">The [jQuery Unobtrusive Validation](https://github.com/aspnet/jquery-validation-unobtrusive) script is a custom Microsoft front-end library that builds on the popular [jQuery Validate](https://jqueryvalidation.org/) plugin.</span></span> <span data-ttu-id="4b56b-215">Bez sprawdzania poprawności dyskretnego kodu jQuery, trzeba by code tę samą logikę weryfikacji w dwóch miejscach: jeden raz w atrybuty weryfikacji po stronie serwera we właściwościach modelu, a następnie ponownie w skryptach po stronie klienta (przykłady jQuery weryfikacji [ `validate()` ](https://jqueryvalidation.org/validate/) metoda ma pokazać, jak złożone to może stać się).</span><span class="sxs-lookup"><span data-stu-id="4b56b-215">Without jQuery Unobtrusive Validation, you would have to code the same validation logic in two places: once in the server side validation attributes on model properties, and then again in client side scripts (the examples for jQuery Validate's [`validate()`](https://jqueryvalidation.org/validate/) method shows how complex this could become).</span></span> <span data-ttu-id="4b56b-216">Zamiast tego MVC [pomocników tagów](xref:mvc/views/tag-helpers/intro) i [pomocników HTML](xref:mvc/views/overview) będą mogli używać atrybutów sprawdzania poprawności, a następnie wpisz metadane z właściwości modelu do renderowania kodu HTML 5 [atrybuty danych](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) w elementy formularza, wymagające weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-216">Instead, MVC's [Tag Helpers](xref:mvc/views/tag-helpers/intro) and [HTML helpers](xref:mvc/views/overview) are able to use the validation attributes and type metadata from model properties to render HTML 5 [data- attributes](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) in the form elements that need validation.</span></span> <span data-ttu-id="4b56b-217">Generuje MVC `data-` atrybutów dla atrybutów niestandardowe i wbudowane.</span><span class="sxs-lookup"><span data-stu-id="4b56b-217">MVC generates the `data-` attributes for both built-in and custom attributes.</span></span> <span data-ttu-id="4b56b-218">następnie analizuje jQuery sprawdzania poprawności dyskretnego kodu `data-` atrybutów, a następnie przekazuje logikę do technologii jQuery sprawdzania poprawności, efektywnie "kopiowanie" logiki weryfikacji po stronie serwera do klienta.</span><span class="sxs-lookup"><span data-stu-id="4b56b-218">jQuery Unobtrusive Validation then parses the `data-` attributes and passes the logic to jQuery Validate, effectively "copying" the server side validation logic to the client.</span></span> <span data-ttu-id="4b56b-219">Błędy sprawdzania poprawności można wyświetlać na kliencie, używanie pomocników tagów istotne, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="4b56b-219">You can display validation errors on the client using the relevant tag helpers as shown here:</span></span>

[!code-cshtml[](validation/sample/Views/Movies/Create.cshtml?name=snippet_ReleaseDate&highlight=4-5)]

<span data-ttu-id="4b56b-220">Pomocnicy tagów powyżej renderować HTML poniżej.</span><span class="sxs-lookup"><span data-stu-id="4b56b-220">The tag helpers above render the HTML below.</span></span> <span data-ttu-id="4b56b-221">Należy zauważyć, że `data-` atrybuty w kodzie HTML dane wyjściowe odnoszą się do atrybutów weryfikacji `ReleaseDate` właściwości.</span><span class="sxs-lookup"><span data-stu-id="4b56b-221">Notice that the `data-` attributes in the HTML output correspond to the validation attributes for the `ReleaseDate` property.</span></span> <span data-ttu-id="4b56b-222">`data-val-required` Poniższego atrybutu zawiera komunikat o błędzie wyświetlany w sytuacji, gdy użytkownik nie wypełnić pole daty wydania.</span><span class="sxs-lookup"><span data-stu-id="4b56b-222">The `data-val-required` attribute below contains an error message to display if the user doesn't fill in the release date field.</span></span> <span data-ttu-id="4b56b-223">jQuery sprawdzania poprawności dyskretnego kodu przekazuje tę wartość do weryfikacji jQuery [ `required()` ](https://jqueryvalidation.org/required-method/) metody, która wyświetla ten komunikat w towarzyszącego  **\<span >** elementu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-223">jQuery Unobtrusive Validation passes this value to the jQuery Validate [`required()`](https://jqueryvalidation.org/required-method/) method, which then displays that message in the accompanying **\<span>** element.</span></span>

```html
<form action="/Movies/Create" method="post">
    <div class="form-horizontal">
        <h4>Movie</h4>
        <div class="text-danger"></div>
        <div class="form-group">
            <label class="col-md-2 control-label" for="ReleaseDate">ReleaseDate</label>
            <div class="col-md-10">
                <input class="form-control" type="datetime"
                data-val="true" data-val-required="The ReleaseDate field is required."
                id="ReleaseDate" name="ReleaseDate" value="" />
                <span class="text-danger field-validation-valid"
                data-valmsg-for="ReleaseDate" data-valmsg-replace="true"></span>
            </div>
        </div>
    </div>
</form>
```

<span data-ttu-id="4b56b-224">Weryfikacji po stronie klienta zapobiega przesyłanie, aż formularz jest nieprawidłowy.</span><span class="sxs-lookup"><span data-stu-id="4b56b-224">Client-side validation prevents submission until the form is valid.</span></span> <span data-ttu-id="4b56b-225">Przycisk Zatwierdź uruchamia JavaScript, która przesyła formularz lub wyświetla komunikaty o błędach.</span><span class="sxs-lookup"><span data-stu-id="4b56b-225">The Submit button runs JavaScript that either submits the form or displays error messages.</span></span>

<span data-ttu-id="4b56b-226">MVC określa na podstawie typu danych .NET właściwości, prawdopodobnie przesłonić przy użyciu wartości atrybutu typu `[DataType]` atrybutów.</span><span class="sxs-lookup"><span data-stu-id="4b56b-226">MVC determines type attribute values based on the .NET data type of a property, possibly overridden using `[DataType]` attributes.</span></span> <span data-ttu-id="4b56b-227">Podstawa `[DataType]` atrybut zapewnia nie nastąpi sprawdzanie poprawności liczby rzeczywistej po stronie serwera.</span><span class="sxs-lookup"><span data-stu-id="4b56b-227">The base `[DataType]` attribute does no real server-side validation.</span></span> <span data-ttu-id="4b56b-228">Przeglądarki wybierz ich własnych komunikatów o błędach i wyświetlania tych błędów, jak mają być, jednak pakietu sprawdzania poprawności dyskretnego kodu jQuery można zastąpić komunikaty i wyświetlać je stale innym osobom.</span><span class="sxs-lookup"><span data-stu-id="4b56b-228">Browsers choose their own error messages and display those errors as they wish, however the jQuery Validation Unobtrusive package can override the messages and display them consistently with others.</span></span> <span data-ttu-id="4b56b-229">Dzieje się to najbardziej oczywiste, gdy użytkownicy zastosują `[DataType]` podklasy, takie jak `[EmailAddress]`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-229">This happens most obviously when users apply `[DataType]` subclasses such as `[EmailAddress]`.</span></span>

### <a name="add-validation-to-dynamic-forms"></a><span data-ttu-id="4b56b-230">Dodawanie walidacji do formularzy dynamicznych</span><span class="sxs-lookup"><span data-stu-id="4b56b-230">Add Validation to Dynamic Forms</span></span>

<span data-ttu-id="4b56b-231">Ponieważ jQuery sprawdzania poprawności dyskretnego kodu przekazuje logikę weryfikacji i parametry do technologii jQuery sprawdzania poprawności, gdy strona ładuje się najpierw, dynamicznie generowanych formularzy nie będzie automatycznie następującej liczby etapów stwierdzono sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-231">Because jQuery Unobtrusive Validation passes validation logic and parameters to jQuery Validate when the page first loads, dynamically generated forms won't automatically exhibit validation.</span></span> <span data-ttu-id="4b56b-232">Zamiast tego musisz poinformować jQuery dyskretny kod sprawdzania poprawności, aby przeanalizować dynamiczny formularz bezpośrednio po jej utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-232">Instead, you must tell jQuery Unobtrusive Validation to parse the dynamic form immediately after creating it.</span></span> <span data-ttu-id="4b56b-233">Na przykład poniższy kod pokazuje, jak można skonfigurować weryfikacji po stronie klienta w formularzu dodane za pośrednictwem technologii AJAX.</span><span class="sxs-lookup"><span data-stu-id="4b56b-233">For example, the code below shows how you might set up client side validation on a form added via AJAX.</span></span>

```js
$.get({
    url: "https://url/that/returns/a/form",
    dataType: "html",
    error: function(jqXHR, textStatus, errorThrown) {
        alert(textStatus + ": Couldn't add form. " + errorThrown);
    },
    success: function(newFormHTML) {
        var container = document.getElementById("form-container");
        container.insertAdjacentHTML("beforeend", newFormHTML);
        var forms = container.getElementsByTagName("form");
        var newForm = forms[forms.length - 1];
        $.validator.unobtrusive.parse(newForm);
    }
})
```

<span data-ttu-id="4b56b-234">`$.validator.unobtrusive.parse()` Metoda przyjmuje selektor jQuery, jego jednego argumentu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-234">The `$.validator.unobtrusive.parse()` method accepts a jQuery selector for its one argument.</span></span> <span data-ttu-id="4b56b-235">Ta metoda informuje jQuery dyskretny kod sprawdzania poprawności, aby przeanalizować `data-` atrybuty odeśle selektora.</span><span class="sxs-lookup"><span data-stu-id="4b56b-235">This method tells jQuery Unobtrusive Validation to parse the `data-` attributes of forms within that selector.</span></span> <span data-ttu-id="4b56b-236">Wartości tych atrybutów są następnie przekazywane do wtyczki weryfikacji jQuery, tak, aby formularz wykazuje reguł weryfikacji po stronie klienta żądaną.</span><span class="sxs-lookup"><span data-stu-id="4b56b-236">The values of those attributes are then passed to the jQuery Validate plugin so that the form exhibits the desired client side validation rules.</span></span>

### <a name="add-validation-to-dynamic-controls"></a><span data-ttu-id="4b56b-237">Dodawanie walidacji do kontrolek dynamicznych</span><span class="sxs-lookup"><span data-stu-id="4b56b-237">Add Validation to Dynamic Controls</span></span>

<span data-ttu-id="4b56b-238">Możesz także zaktualizować reguły sprawdzania poprawności w formularzu, gdy osoba pod kontrolą, takich jak `<input/>`s i `<select/>`s, są generowane dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-238">You can also update the validation rules on a form when individual controls, such as `<input/>`s and `<select/>`s, are dynamically generated.</span></span> <span data-ttu-id="4b56b-239">Nie można przekazać selektory te elementy, aby `parse()` bezpośrednio metody ponieważ otaczającego formularz już został przeanalizowany i nie będzie aktualizować.</span><span class="sxs-lookup"><span data-stu-id="4b56b-239">You cannot pass selectors for these elements to the `parse()` method directly because the surrounding form has already been parsed and won't update.</span></span> <span data-ttu-id="4b56b-240">Zamiast tego należy najpierw usunąć istniejące dane sprawdzania poprawności, a następnie ponownej analizy całego formularza, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="4b56b-240">Instead, you first remove the existing validation data, then reparse the entire form, as shown below:</span></span>

```js
$.get({
    url: "https://url/that/returns/a/control",
    dataType: "html",
    error: function(jqXHR, textStatus, errorThrown) {
        alert(textStatus + ": Couldn't add control. " + errorThrown);
    },
    success: function(newInputHTML) {
        var form = document.getElementById("my-form");
        form.insertAdjacentHTML("beforeend", newInputHTML);
        $(form).removeData("validator")    // Added by jQuery Validate
               .removeData("unobtrusiveValidation");   // Added by jQuery Unobtrusive Validation
        $.validator.unobtrusive.parse(form);
    }
})
```

## <a name="iclientmodelvalidator"></a><span data-ttu-id="4b56b-241">IClientModelValidator</span><span class="sxs-lookup"><span data-stu-id="4b56b-241">IClientModelValidator</span></span>

<span data-ttu-id="4b56b-242">Możesz utworzyć logikę po stronie klienta dla Twojego niestandardowego atrybutu i [sprawdzania poprawności dyskretnego kodu](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html) tworzy adapter w celu [dotyczącą weryfikacji jquery](http://jqueryvalidation.org/documentation/) będą wykonywane na kliencie dla Ciebie automatycznie jako część Sprawdzanie poprawności.</span><span class="sxs-lookup"><span data-stu-id="4b56b-242">You may create client side logic for your custom attribute, and [unobtrusive validation](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html) which creates an adapter to [jquery validation](http://jqueryvalidation.org/documentation/) will execute it on the client for you automatically as part of validation.</span></span> <span data-ttu-id="4b56b-243">Pierwszym krokiem jest kontrolować, jakie atrybuty danych są dodawane przez zaimplementowanie `IClientModelValidator` interfejsu, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="4b56b-243">The first step is to control what data- attributes are added by implementing the `IClientModelValidator` interface as shown here:</span></span>

[!code-csharp[](validation/sample/ClassicMovieAttribute.cs?name=snippet_AddValidation)]

<span data-ttu-id="4b56b-244">Atrybuty, które implementują ten interfejs, można dodać atrybuty HTML do wygenerowanego pola.</span><span class="sxs-lookup"><span data-stu-id="4b56b-244">Attributes that implement this interface can add HTML attributes to generated fields.</span></span> <span data-ttu-id="4b56b-245">Badanie danych wyjściowych dla `ReleaseDate` element, co spowoduje wyświetlenie kodu HTML, który jest podobny do poprzedniego przykładu, ale teraz ma `data-val-classicmovie` atrybut, który został zdefiniowany w `AddValidation` metody `IClientModelValidator`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-245">Examining the output for the `ReleaseDate` element reveals HTML that's similar to the previous example, except now there's a `data-val-classicmovie` attribute that was defined in the `AddValidation` method of `IClientModelValidator`.</span></span>

```html
<input class="form-control" type="datetime"
    data-val="true"
    data-val-classicmovie="Classic movies must have a release year earlier than 1960."
    data-val-classicmovie-year="1960"
    data-val-required="The ReleaseDate field is required."
    id="ReleaseDate" name="ReleaseDate" value="" />
```

<span data-ttu-id="4b56b-246">Sprawdzania poprawności dyskretnego kodu używa tych danych w `data-` atrybutów, które mają być wyświetlane komunikaty o błędach.</span><span class="sxs-lookup"><span data-stu-id="4b56b-246">Unobtrusive validation uses the data in the `data-` attributes to display error messages.</span></span> <span data-ttu-id="4b56b-247">Jednak jQuery nie wie o regułach lub wiadomości do momentu dodania do technologii jQuery firmy `validator` obiektu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-247">However, jQuery doesn't know about rules or messages until you add them to jQuery's `validator` object.</span></span> <span data-ttu-id="4b56b-248">Jest to pokazane w poniższym przykładzie, który dodaje niestandardową `classicmovie` metody sprawdzania poprawności klienta jQuery `validator` obiektu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-248">This is shown in the following example, which adds a custom `classicmovie` client validation method to the jQuery `validator` object.</span></span> <span data-ttu-id="4b56b-249">Wyjaśnienie `unobtrusive.adapters.add` metody, zobacz [dyskretny kod weryfikacji klienta we wzorcu ASP.NET MVC](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html).</span><span class="sxs-lookup"><span data-stu-id="4b56b-249">For an explanation of the `unobtrusive.adapters.add` method, see [Unobtrusive Client Validation in ASP.NET MVC](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html).</span></span>

[!code-javascript[](validation/sample/Views/Movies/Create.cshtml?name=snippet_UnobtrusiveValidation)]

<span data-ttu-id="4b56b-250">Poprzedni kod `classicmovie` metoda przeprowadza weryfikację po stronie klienta filmu daty wydania.</span><span class="sxs-lookup"><span data-stu-id="4b56b-250">With the preceding code, the `classicmovie` method performs client-side validation on the movie release date.</span></span> <span data-ttu-id="4b56b-251">Wyświetla komunikat o błędzie, jeśli metoda zwraca `false`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-251">The error message displays if the method returns `false`.</span></span>

## <a name="remote-validation"></a><span data-ttu-id="4b56b-252">Zdalnej weryfikacji</span><span class="sxs-lookup"><span data-stu-id="4b56b-252">Remote validation</span></span>

<span data-ttu-id="4b56b-253">Zdalnej weryfikacji to doskonałe funkcja do użycia, gdy trzeba wykonać walidację danych na komputerze klienckim względem danych na serwerze.</span><span class="sxs-lookup"><span data-stu-id="4b56b-253">Remote validation is a great feature to use when you need to validate data on the client against data on the server.</span></span> <span data-ttu-id="4b56b-254">Na przykład aplikacja może być konieczne Sprawdź, czy nazwa użytkownika lub adres e-mail jest już używana, a musi wykonać zapytanie dużej ilości danych, aby to zrobić.</span><span class="sxs-lookup"><span data-stu-id="4b56b-254">For example, your app may need to verify whether an email or user name is already in use, and it must query a large amount of data to do so.</span></span> <span data-ttu-id="4b56b-255">Pobieranie dużych zestawów danych sprawdzania poprawności jeden lub kilka pól zużywa zbyt dużo zasobów.</span><span class="sxs-lookup"><span data-stu-id="4b56b-255">Downloading large sets of data for validating one or a few fields consumes too many resources.</span></span> <span data-ttu-id="4b56b-256">Może również spowodować ujawnienie poufnych informacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-256">It may also expose sensitive information.</span></span> <span data-ttu-id="4b56b-257">Alternatywą jest żądanie Rundy, aby sprawdzić poprawność pola.</span><span class="sxs-lookup"><span data-stu-id="4b56b-257">An alternative is to make a round-trip request to validate a field.</span></span>

<span data-ttu-id="4b56b-258">W procesie dwóch kroków można zaimplementować weryfikację zdalną.</span><span class="sxs-lookup"><span data-stu-id="4b56b-258">You can implement remote validation in a two step process.</span></span> <span data-ttu-id="4b56b-259">Najpierw należy dodać adnotacje modelu za pomocą `[Remote]` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-259">First, you must annotate your model with the `[Remote]` attribute.</span></span> <span data-ttu-id="4b56b-260">`[Remote]` Atrybut akceptuje wiele przeciążeń, które można użyć do kierowania JavaScript po stronie klienta do odpowiedniego kodu do wywołania.</span><span class="sxs-lookup"><span data-stu-id="4b56b-260">The `[Remote]` attribute accepts multiple overloads you can use to direct client side JavaScript to the appropriate code to call.</span></span> <span data-ttu-id="4b56b-261">W poniższym przykładzie wskazuje `VerifyEmail` metody akcji `Users` kontrolera.</span><span class="sxs-lookup"><span data-stu-id="4b56b-261">The example below points to the `VerifyEmail` action method of the `Users` controller.</span></span>

[!code-csharp[](validation/sample/User.cs?name=snippet_UserEmailProperty)]

<span data-ttu-id="4b56b-262">Drugim krokiem jest umieszczenie kodu sprawdzania poprawności w odpowiedniej metody akcji, zgodnie z definicją w `[Remote]` atrybutu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-262">The second step is putting the validation code in the corresponding action method as defined in the `[Remote]` attribute.</span></span> <span data-ttu-id="4b56b-263">Zgodnie z jQuery weryfikacji [zdalnego](https://jqueryvalidation.org/remote-method/) dokumentacji metoda odpowiedź serwera musi być ciąg JSON, który jest albo:</span><span class="sxs-lookup"><span data-stu-id="4b56b-263">According to the jQuery Validate [remote](https://jqueryvalidation.org/remote-method/) method documentation, the server response must be a JSON string that's either:</span></span>

* <span data-ttu-id="4b56b-264">`"true"` Aby uzyskać prawidłowe elementy.</span><span class="sxs-lookup"><span data-stu-id="4b56b-264">`"true"` for valid elements.</span></span>
* <span data-ttu-id="4b56b-265">`"false"`, `undefined`, lub `null` dla nieprawidłowe elementy przy użyciu domyślnego komunikatu o błędzie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-265">`"false"`, `undefined`, or `null` for invalid elements, using the default error message.</span></span>

<span data-ttu-id="4b56b-266">Jeśli odpowiedź serwera to ciąg (na przykład `"That name is already taken, try peter123 instead"`), ciąg jest wyświetlany jako niestandardowy komunikat o błędzie zamiast domyślnego ciągu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-266">If the server response is a string (for example, `"That name is already taken, try peter123 instead"`), the string is displayed as a custom error message in place of the default string.</span></span>

<span data-ttu-id="4b56b-267">Definicja `VerifyEmail` metoda obowiązują następujące reguły, jak pokazano poniżej.</span><span class="sxs-lookup"><span data-stu-id="4b56b-267">The definition of the `VerifyEmail` method follows these rules, as shown below.</span></span> <span data-ttu-id="4b56b-268">Zwraca błąd sprawdzania poprawności komunikat, jeśli jest pobierana w wiadomości e-mail lub `true` Jeśli wiadomość e-mail jest bezpłatny i otacza wynik w `JsonResult` obiektu.</span><span class="sxs-lookup"><span data-stu-id="4b56b-268">It returns a validation error message if the email is taken, or `true` if the email is free, and wraps the result in a `JsonResult` object.</span></span> <span data-ttu-id="4b56b-269">Następnie po stronie klienta można użyć zwracanej wartości, aby kontynuować, lub wyświetla błąd, jeśli to konieczne.</span><span class="sxs-lookup"><span data-stu-id="4b56b-269">The client side can then use the returned value to proceed or display the error if needed.</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyEmail)]

<span data-ttu-id="4b56b-270">Teraz gdy użytkownicy wprowadzają wiadomość e-mail, JavaScript, w widoku wywołuje zdalnego czy tego adresu e-mail jest już zajęta, a jeśli tak, wyświetla komunikat o błędzie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-270">Now when users enter an email, JavaScript in the view makes a remote call to see if that email has been taken and, if so, displays the error message.</span></span> <span data-ttu-id="4b56b-271">W przeciwnym razie użytkownik może przesłać formularza, w zwykły sposób.</span><span class="sxs-lookup"><span data-stu-id="4b56b-271">Otherwise, the user can submit the form as usual.</span></span>

<span data-ttu-id="4b56b-272">`AdditionalFields` Właściwość `[Remote]` atrybut jest przydatna do zweryfikowania kombinacje pól w odniesieniu do danych na serwerze.</span><span class="sxs-lookup"><span data-stu-id="4b56b-272">The `AdditionalFields` property of the `[Remote]` attribute is useful for validating combinations of fields against data on the server.</span></span> <span data-ttu-id="4b56b-273">Na przykład jeśli `User` modelu z powyższych ma dwa dodatkowe właściwości o nazwie `FirstName` i `LastName`, warto sprawdzić, czy nie istniejący użytkownicy mają już tej pary nazw.</span><span class="sxs-lookup"><span data-stu-id="4b56b-273">For example, if the `User` model from above had two additional properties called `FirstName` and `LastName`, you might want to verify that no existing users already have that pair of names.</span></span> <span data-ttu-id="4b56b-274">Możesz zdefiniować nowe właściwości, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="4b56b-274">You define the new properties as shown in the following code:</span></span>

[!code-csharp[](validation/sample/User.cs?name=snippet_UserNameProperties)]

<span data-ttu-id="4b56b-275">`AdditionalFields` może ustawiono jawnie ciągi `"FirstName"` i `"LastName"`, ale przy użyciu [ `nameof` ](/dotnet/csharp/language-reference/keywords/nameof) operator następująco upraszcza później refaktoryzacji.</span><span class="sxs-lookup"><span data-stu-id="4b56b-275">`AdditionalFields` could've been set explicitly to the strings `"FirstName"` and `"LastName"`, but using the [`nameof`](/dotnet/csharp/language-reference/keywords/nameof) operator like this simplifies later refactoring.</span></span> <span data-ttu-id="4b56b-276">Metody akcji, aby wykonać sprawdzanie poprawności następnie musi zaakceptować dwa argumenty, jeden dla wartości `FirstName` i jeden dla wartości `LastName`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-276">The action method to perform the validation must then accept two arguments, one for the value of `FirstName` and one for the value of `LastName`.</span></span>

[!code-csharp[](validation/sample/UsersController.cs?name=snippet_VerifyName)]

<span data-ttu-id="4b56b-277">Teraz gdy użytkownicy wprowadzają imię i nazwisko JavaScript:</span><span class="sxs-lookup"><span data-stu-id="4b56b-277">Now when users enter a first and last name, JavaScript:</span></span>

* <span data-ttu-id="4b56b-278">Umożliwia zdalne wywołanie, aby zobaczyć, że pary nazw jest już zajęta.</span><span class="sxs-lookup"><span data-stu-id="4b56b-278">Makes a remote call to see if that pair of names has been taken.</span></span>
* <span data-ttu-id="4b56b-279">Jeśli zostanie podjęta pary, jest wyświetlany komunikat o błędzie.</span><span class="sxs-lookup"><span data-stu-id="4b56b-279">If the pair has been taken, an error message is displayed.</span></span>
* <span data-ttu-id="4b56b-280">Jeśli nie zostanie podjęte, użytkownik może przesłać formularza.</span><span class="sxs-lookup"><span data-stu-id="4b56b-280">If not taken, the user can submit the form.</span></span>

<span data-ttu-id="4b56b-281">Jeśli musisz zweryfikować co najmniej dwa dodatkowe pola z `[Remote]` atrybutu one podawane jako listę rozdzielonych przecinkami.</span><span class="sxs-lookup"><span data-stu-id="4b56b-281">If you need to validate two or more additional fields with the `[Remote]` attribute, you provide them as a comma-delimited list.</span></span> <span data-ttu-id="4b56b-282">Na przykład, aby dodać `MiddleName` właściwością modelu, `[Remote]` atrybutu, jak pokazano w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="4b56b-282">For example, to add a `MiddleName` property to the model, set the `[Remote]` attribute as shown in the following code:</span></span>

```cs
[Remote(action: "VerifyName", controller: "Users", AdditionalFields = nameof(FirstName) + "," + nameof(LastName))]
public string MiddleName { get; set; }
```

<span data-ttu-id="4b56b-283">`AdditionalFields`, podobnie jak wszystkie argumenty atrybutu, musi być wyrażeniem stałym.</span><span class="sxs-lookup"><span data-stu-id="4b56b-283">`AdditionalFields`, like all attribute arguments, must be a constant expression.</span></span> <span data-ttu-id="4b56b-284">W związku z tym, nie można używać [ciągiem interpolowanym](/dotnet/csharp/language-reference/keywords/interpolated-strings) lub zadzwoń <xref:System.String.Join*> zainicjować `AdditionalFields`.</span><span class="sxs-lookup"><span data-stu-id="4b56b-284">Therefore, you must not use an [interpolated string](/dotnet/csharp/language-reference/keywords/interpolated-strings) or call <xref:System.String.Join*> to initialize `AdditionalFields`.</span></span> <span data-ttu-id="4b56b-285">Dla każdego dodatkowego pola, które możesz dodać do `[Remote]` atrybutu, należy dodać kolejny argument do odpowiedniej metody akcji kontrolera.</span><span class="sxs-lookup"><span data-stu-id="4b56b-285">For every additional field that you add to the `[Remote]` attribute, you must add another argument to the corresponding controller action method.</span></span>
